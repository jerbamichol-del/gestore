(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))n(a);new MutationObserver(a=>{for(const i of a)if(i.type==="childList")for(const s of i.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&n(s)}).observe(document,{childList:!0,subtree:!0});function r(a){const i={};return a.integrity&&(i.integrity=a.integrity),a.referrerPolicy&&(i.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?i.credentials="include":a.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function n(a){if(a.ep)return;a.ep=!0;const i=r(a);fetch(a.href,i)}})();var dd=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function rr(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var C1={exports:{}},tu={},O1={exports:{}},Lt={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var _E;function TR(){if(_E)return Lt;_E=1;var e=Symbol.for("react.element"),t=Symbol.for("react.portal"),r=Symbol.for("react.fragment"),n=Symbol.for("react.strict_mode"),a=Symbol.for("react.profiler"),i=Symbol.for("react.provider"),s=Symbol.for("react.context"),o=Symbol.for("react.forward_ref"),c=Symbol.for("react.suspense"),u=Symbol.for("react.memo"),d=Symbol.for("react.lazy"),h=Symbol.iterator;function p(Z){return Z===null||typeof Z!="object"?null:(Z=h&&Z[h]||Z["@@iterator"],typeof Z=="function"?Z:null)}var v={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},x=Object.assign,w={};function y(Z,ee,ce){this.props=Z,this.context=ee,this.refs=w,this.updater=ce||v}y.prototype.isReactComponent={},y.prototype.setState=function(Z,ee){if(typeof Z!="object"&&typeof Z!="function"&&Z!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,Z,ee,"setState")},y.prototype.forceUpdate=function(Z){this.updater.enqueueForceUpdate(this,Z,"forceUpdate")};function _(){}_.prototype=y.prototype;function S(Z,ee,ce){this.props=Z,this.context=ee,this.refs=w,this.updater=ce||v}var k=S.prototype=new _;k.constructor=S,x(k,y.prototype),k.isPureReactComponent=!0;var E=Array.isArray,T=Object.prototype.hasOwnProperty,N={current:null},C={key:!0,ref:!0,__self:!0,__source:!0};function P(Z,ee,ce){var de,Te={},Ie=null,Ne=null;if(ee!=null)for(de in ee.ref!==void 0&&(Ne=ee.ref),ee.key!==void 0&&(Ie=""+ee.key),ee)T.call(ee,de)&&!C.hasOwnProperty(de)&&(Te[de]=ee[de]);var W=arguments.length-2;if(W===1)Te.children=ce;else if(1<W){for(var z=Array(W),G=0;G<W;G++)z[G]=arguments[G+2];Te.children=z}if(Z&&Z.defaultProps)for(de in W=Z.defaultProps,W)Te[de]===void 0&&(Te[de]=W[de]);return{$$typeof:e,type:Z,key:Ie,ref:Ne,props:Te,_owner:N.current}}function j(Z,ee){return{$$typeof:e,type:Z.type,key:ee,ref:Z.ref,props:Z.props,_owner:Z._owner}}function R(Z){return typeof Z=="object"&&Z!==null&&Z.$$typeof===e}function I(Z){var ee={"=":"=0",":":"=2"};return"$"+Z.replace(/[=:]/g,function(ce){return ee[ce]})}var F=/\/+/g;function L(Z,ee){return typeof Z=="object"&&Z!==null&&Z.key!=null?I(""+Z.key):ee.toString(36)}function H(Z,ee,ce,de,Te){var Ie=typeof Z;(Ie==="undefined"||Ie==="boolean")&&(Z=null);var Ne=!1;if(Z===null)Ne=!0;else switch(Ie){case"string":case"number":Ne=!0;break;case"object":switch(Z.$$typeof){case e:case t:Ne=!0}}if(Ne)return Ne=Z,Te=Te(Ne),Z=de===""?"."+L(Ne,0):de,E(Te)?(ce="",Z!=null&&(ce=Z.replace(F,"$&/")+"/"),H(Te,ee,ce,"",function(G){return G})):Te!=null&&(R(Te)&&(Te=j(Te,ce+(!Te.key||Ne&&Ne.key===Te.key?"":(""+Te.key).replace(F,"$&/")+"/")+Z)),ee.push(Te)),1;if(Ne=0,de=de===""?".":de+":",E(Z))for(var W=0;W<Z.length;W++){Ie=Z[W];var z=de+L(Ie,W);Ne+=H(Ie,ee,ce,z,Te)}else if(z=p(Z),typeof z=="function")for(Z=z.call(Z),W=0;!(Ie=Z.next()).done;)Ie=Ie.value,z=de+L(Ie,W++),Ne+=H(Ie,ee,ce,z,Te);else if(Ie==="object")throw ee=String(Z),Error("Objects are not valid as a React child (found: "+(ee==="[object Object]"?"object with keys {"+Object.keys(Z).join(", ")+"}":ee)+"). If you meant to render a collection of children, use an array instead.");return Ne}function V(Z,ee,ce){if(Z==null)return Z;var de=[],Te=0;return H(Z,de,"","",function(Ie){return ee.call(ce,Ie,Te++)}),de}function J(Z){if(Z._status===-1){var ee=Z._result;ee=ee(),ee.then(function(ce){(Z._status===0||Z._status===-1)&&(Z._status=1,Z._result=ce)},function(ce){(Z._status===0||Z._status===-1)&&(Z._status=2,Z._result=ce)}),Z._status===-1&&(Z._status=0,Z._result=ee)}if(Z._status===1)return Z._result.default;throw Z._result}var te={current:null},q={transition:null},oe={ReactCurrentDispatcher:te,ReactCurrentBatchConfig:q,ReactCurrentOwner:N};function Q(){throw Error("act(...) is not supported in production builds of React.")}return Lt.Children={map:V,forEach:function(Z,ee,ce){V(Z,function(){ee.apply(this,arguments)},ce)},count:function(Z){var ee=0;return V(Z,function(){ee++}),ee},toArray:function(Z){return V(Z,function(ee){return ee})||[]},only:function(Z){if(!R(Z))throw Error("React.Children.only expected to receive a single React element child.");return Z}},Lt.Component=y,Lt.Fragment=r,Lt.Profiler=a,Lt.PureComponent=S,Lt.StrictMode=n,Lt.Suspense=c,Lt.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=oe,Lt.act=Q,Lt.cloneElement=function(Z,ee,ce){if(Z==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+Z+".");var de=x({},Z.props),Te=Z.key,Ie=Z.ref,Ne=Z._owner;if(ee!=null){if(ee.ref!==void 0&&(Ie=ee.ref,Ne=N.current),ee.key!==void 0&&(Te=""+ee.key),Z.type&&Z.type.defaultProps)var W=Z.type.defaultProps;for(z in ee)T.call(ee,z)&&!C.hasOwnProperty(z)&&(de[z]=ee[z]===void 0&&W!==void 0?W[z]:ee[z])}var z=arguments.length-2;if(z===1)de.children=ce;else if(1<z){W=Array(z);for(var G=0;G<z;G++)W[G]=arguments[G+2];de.children=W}return{$$typeof:e,type:Z.type,key:Te,ref:Ie,props:de,_owner:Ne}},Lt.createContext=function(Z){return Z={$$typeof:s,_currentValue:Z,_currentValue2:Z,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},Z.Provider={$$typeof:i,_context:Z},Z.Consumer=Z},Lt.createElement=P,Lt.createFactory=function(Z){var ee=P.bind(null,Z);return ee.type=Z,ee},Lt.createRef=function(){return{current:null}},Lt.forwardRef=function(Z){return{$$typeof:o,render:Z}},Lt.isValidElement=R,Lt.lazy=function(Z){return{$$typeof:d,_payload:{_status:-1,_result:Z},_init:J}},Lt.memo=function(Z,ee){return{$$typeof:u,type:Z,compare:ee===void 0?null:ee}},Lt.startTransition=function(Z){var ee=q.transition;q.transition={};try{Z()}finally{q.transition=ee}},Lt.unstable_act=Q,Lt.useCallback=function(Z,ee){return te.current.useCallback(Z,ee)},Lt.useContext=function(Z){return te.current.useContext(Z)},Lt.useDebugValue=function(){},Lt.useDeferredValue=function(Z){return te.current.useDeferredValue(Z)},Lt.useEffect=function(Z,ee){return te.current.useEffect(Z,ee)},Lt.useId=function(){return te.current.useId()},Lt.useImperativeHandle=function(Z,ee,ce){return te.current.useImperativeHandle(Z,ee,ce)},Lt.useInsertionEffect=function(Z,ee){return te.current.useInsertionEffect(Z,ee)},Lt.useLayoutEffect=function(Z,ee){return te.current.useLayoutEffect(Z,ee)},Lt.useMemo=function(Z,ee){return te.current.useMemo(Z,ee)},Lt.useReducer=function(Z,ee,ce){return te.current.useReducer(Z,ee,ce)},Lt.useRef=function(Z){return te.current.useRef(Z)},Lt.useState=function(Z){return te.current.useState(Z)},Lt.useSyncExternalStore=function(Z,ee,ce){return te.current.useSyncExternalStore(Z,ee,ce)},Lt.useTransition=function(){return te.current.useTransition()},Lt.version="18.3.1",Lt}var SE;function $f(){return SE||(SE=1,O1.exports=TR()),O1.exports}/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var kE;function AR(){if(kE)return tu;kE=1;var e=$f(),t=Symbol.for("react.element"),r=Symbol.for("react.fragment"),n=Object.prototype.hasOwnProperty,a=e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,i={key:!0,ref:!0,__self:!0,__source:!0};function s(o,c,u){var d,h={},p=null,v=null;u!==void 0&&(p=""+u),c.key!==void 0&&(p=""+c.key),c.ref!==void 0&&(v=c.ref);for(d in c)n.call(c,d)&&!i.hasOwnProperty(d)&&(h[d]=c[d]);if(o&&o.defaultProps)for(d in c=o.defaultProps,c)h[d]===void 0&&(h[d]=c[d]);return{$$typeof:t,type:o,key:p,ref:v,props:h,_owner:a.current}}return tu.Fragment=r,tu.jsx=s,tu.jsxs=s,tu}var EE;function CR(){return EE||(EE=1,C1.exports=AR()),C1.exports}var g=CR(),D=$f();const me=rr(D);var hd={},N1={exports:{}},Yn={},P1={exports:{}},I1={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var TE;function OR(){return TE||(TE=1,(function(e){function t(q,oe){var Q=q.length;q.push(oe);e:for(;0<Q;){var Z=Q-1>>>1,ee=q[Z];if(0<a(ee,oe))q[Z]=oe,q[Q]=ee,Q=Z;else break e}}function r(q){return q.length===0?null:q[0]}function n(q){if(q.length===0)return null;var oe=q[0],Q=q.pop();if(Q!==oe){q[0]=Q;e:for(var Z=0,ee=q.length,ce=ee>>>1;Z<ce;){var de=2*(Z+1)-1,Te=q[de],Ie=de+1,Ne=q[Ie];if(0>a(Te,Q))Ie<ee&&0>a(Ne,Te)?(q[Z]=Ne,q[Ie]=Q,Z=Ie):(q[Z]=Te,q[de]=Q,Z=de);else if(Ie<ee&&0>a(Ne,Q))q[Z]=Ne,q[Ie]=Q,Z=Ie;else break e}}return oe}function a(q,oe){var Q=q.sortIndex-oe.sortIndex;return Q!==0?Q:q.id-oe.id}if(typeof performance=="object"&&typeof performance.now=="function"){var i=performance;e.unstable_now=function(){return i.now()}}else{var s=Date,o=s.now();e.unstable_now=function(){return s.now()-o}}var c=[],u=[],d=1,h=null,p=3,v=!1,x=!1,w=!1,y=typeof setTimeout=="function"?setTimeout:null,_=typeof clearTimeout=="function"?clearTimeout:null,S=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function k(q){for(var oe=r(u);oe!==null;){if(oe.callback===null)n(u);else if(oe.startTime<=q)n(u),oe.sortIndex=oe.expirationTime,t(c,oe);else break;oe=r(u)}}function E(q){if(w=!1,k(q),!x)if(r(c)!==null)x=!0,J(T);else{var oe=r(u);oe!==null&&te(E,oe.startTime-q)}}function T(q,oe){x=!1,w&&(w=!1,_(P),P=-1),v=!0;var Q=p;try{for(k(oe),h=r(c);h!==null&&(!(h.expirationTime>oe)||q&&!I());){var Z=h.callback;if(typeof Z=="function"){h.callback=null,p=h.priorityLevel;var ee=Z(h.expirationTime<=oe);oe=e.unstable_now(),typeof ee=="function"?h.callback=ee:h===r(c)&&n(c),k(oe)}else n(c);h=r(c)}if(h!==null)var ce=!0;else{var de=r(u);de!==null&&te(E,de.startTime-oe),ce=!1}return ce}finally{h=null,p=Q,v=!1}}var N=!1,C=null,P=-1,j=5,R=-1;function I(){return!(e.unstable_now()-R<j)}function F(){if(C!==null){var q=e.unstable_now();R=q;var oe=!0;try{oe=C(!0,q)}finally{oe?L():(N=!1,C=null)}}else N=!1}var L;if(typeof S=="function")L=function(){S(F)};else if(typeof MessageChannel<"u"){var H=new MessageChannel,V=H.port2;H.port1.onmessage=F,L=function(){V.postMessage(null)}}else L=function(){y(F,0)};function J(q){C=q,N||(N=!0,L())}function te(q,oe){P=y(function(){q(e.unstable_now())},oe)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(q){q.callback=null},e.unstable_continueExecution=function(){x||v||(x=!0,J(T))},e.unstable_forceFrameRate=function(q){0>q||125<q?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):j=0<q?Math.floor(1e3/q):5},e.unstable_getCurrentPriorityLevel=function(){return p},e.unstable_getFirstCallbackNode=function(){return r(c)},e.unstable_next=function(q){switch(p){case 1:case 2:case 3:var oe=3;break;default:oe=p}var Q=p;p=oe;try{return q()}finally{p=Q}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(q,oe){switch(q){case 1:case 2:case 3:case 4:case 5:break;default:q=3}var Q=p;p=q;try{return oe()}finally{p=Q}},e.unstable_scheduleCallback=function(q,oe,Q){var Z=e.unstable_now();switch(typeof Q=="object"&&Q!==null?(Q=Q.delay,Q=typeof Q=="number"&&0<Q?Z+Q:Z):Q=Z,q){case 1:var ee=-1;break;case 2:ee=250;break;case 5:ee=1073741823;break;case 4:ee=1e4;break;default:ee=5e3}return ee=Q+ee,q={id:d++,callback:oe,priorityLevel:q,startTime:Q,expirationTime:ee,sortIndex:-1},Q>Z?(q.sortIndex=Q,t(u,q),r(c)===null&&q===r(u)&&(w?(_(P),P=-1):w=!0,te(E,Q-Z))):(q.sortIndex=ee,t(c,q),x||v||(x=!0,J(T))),q},e.unstable_shouldYield=I,e.unstable_wrapCallback=function(q){var oe=p;return function(){var Q=p;p=oe;try{return q.apply(this,arguments)}finally{p=Q}}}})(I1)),I1}var AE;function NR(){return AE||(AE=1,P1.exports=OR()),P1.exports}/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var CE;function PR(){if(CE)return Yn;CE=1;var e=$f(),t=NR();function r(l){for(var f="https://reactjs.org/docs/error-decoder.html?invariant="+l,m=1;m<arguments.length;m++)f+="&args[]="+encodeURIComponent(arguments[m]);return"Minified React error #"+l+"; visit "+f+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var n=new Set,a={};function i(l,f){s(l,f),s(l+"Capture",f)}function s(l,f){for(a[l]=f,l=0;l<f.length;l++)n.add(f[l])}var o=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),c=Object.prototype.hasOwnProperty,u=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,d={},h={};function p(l){return c.call(h,l)?!0:c.call(d,l)?!1:u.test(l)?h[l]=!0:(d[l]=!0,!1)}function v(l,f,m,b){if(m!==null&&m.type===0)return!1;switch(typeof f){case"function":case"symbol":return!0;case"boolean":return b?!1:m!==null?!m.acceptsBooleans:(l=l.toLowerCase().slice(0,5),l!=="data-"&&l!=="aria-");default:return!1}}function x(l,f,m,b){if(f===null||typeof f>"u"||v(l,f,m,b))return!0;if(b)return!1;if(m!==null)switch(m.type){case 3:return!f;case 4:return f===!1;case 5:return isNaN(f);case 6:return isNaN(f)||1>f}return!1}function w(l,f,m,b,A,O,B){this.acceptsBooleans=f===2||f===3||f===4,this.attributeName=b,this.attributeNamespace=A,this.mustUseProperty=m,this.propertyName=l,this.type=f,this.sanitizeURL=O,this.removeEmptyString=B}var y={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(l){y[l]=new w(l,0,!1,l,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(l){var f=l[0];y[f]=new w(f,1,!1,l[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(l){y[l]=new w(l,2,!1,l.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(l){y[l]=new w(l,2,!1,l,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(l){y[l]=new w(l,3,!1,l.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(l){y[l]=new w(l,3,!0,l,null,!1,!1)}),["capture","download"].forEach(function(l){y[l]=new w(l,4,!1,l,null,!1,!1)}),["cols","rows","size","span"].forEach(function(l){y[l]=new w(l,6,!1,l,null,!1,!1)}),["rowSpan","start"].forEach(function(l){y[l]=new w(l,5,!1,l.toLowerCase(),null,!1,!1)});var _=/[\-:]([a-z])/g;function S(l){return l[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(l){var f=l.replace(_,S);y[f]=new w(f,1,!1,l,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(l){var f=l.replace(_,S);y[f]=new w(f,1,!1,l,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(l){var f=l.replace(_,S);y[f]=new w(f,1,!1,l,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(l){y[l]=new w(l,1,!1,l.toLowerCase(),null,!1,!1)}),y.xlinkHref=new w("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(l){y[l]=new w(l,1,!1,l.toLowerCase(),null,!0,!0)});function k(l,f,m,b){var A=y.hasOwnProperty(f)?y[f]:null;(A!==null?A.type!==0:b||!(2<f.length)||f[0]!=="o"&&f[0]!=="O"||f[1]!=="n"&&f[1]!=="N")&&(x(f,m,A,b)&&(m=null),b||A===null?p(f)&&(m===null?l.removeAttribute(f):l.setAttribute(f,""+m)):A.mustUseProperty?l[A.propertyName]=m===null?A.type===3?!1:"":m:(f=A.attributeName,b=A.attributeNamespace,m===null?l.removeAttribute(f):(A=A.type,m=A===3||A===4&&m===!0?"":""+m,b?l.setAttributeNS(b,f,m):l.setAttribute(f,m))))}var E=e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,T=Symbol.for("react.element"),N=Symbol.for("react.portal"),C=Symbol.for("react.fragment"),P=Symbol.for("react.strict_mode"),j=Symbol.for("react.profiler"),R=Symbol.for("react.provider"),I=Symbol.for("react.context"),F=Symbol.for("react.forward_ref"),L=Symbol.for("react.suspense"),H=Symbol.for("react.suspense_list"),V=Symbol.for("react.memo"),J=Symbol.for("react.lazy"),te=Symbol.for("react.offscreen"),q=Symbol.iterator;function oe(l){return l===null||typeof l!="object"?null:(l=q&&l[q]||l["@@iterator"],typeof l=="function"?l:null)}var Q=Object.assign,Z;function ee(l){if(Z===void 0)try{throw Error()}catch(m){var f=m.stack.trim().match(/\n( *(at )?)/);Z=f&&f[1]||""}return`
`+Z+l}var ce=!1;function de(l,f){if(!l||ce)return"";ce=!0;var m=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(f)if(f=function(){throw Error()},Object.defineProperty(f.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(f,[])}catch(Ae){var b=Ae}Reflect.construct(l,[],f)}else{try{f.call()}catch(Ae){b=Ae}l.call(f.prototype)}else{try{throw Error()}catch(Ae){b=Ae}l()}}catch(Ae){if(Ae&&b&&typeof Ae.stack=="string"){for(var A=Ae.stack.split(`
`),O=b.stack.split(`
`),B=A.length-1,se=O.length-1;1<=B&&0<=se&&A[B]!==O[se];)se--;for(;1<=B&&0<=se;B--,se--)if(A[B]!==O[se]){if(B!==1||se!==1)do if(B--,se--,0>se||A[B]!==O[se]){var ue=`
`+A[B].replace(" at new "," at ");return l.displayName&&ue.includes("<anonymous>")&&(ue=ue.replace("<anonymous>",l.displayName)),ue}while(1<=B&&0<=se);break}}}finally{ce=!1,Error.prepareStackTrace=m}return(l=l?l.displayName||l.name:"")?ee(l):""}function Te(l){switch(l.tag){case 5:return ee(l.type);case 16:return ee("Lazy");case 13:return ee("Suspense");case 19:return ee("SuspenseList");case 0:case 2:case 15:return l=de(l.type,!1),l;case 11:return l=de(l.type.render,!1),l;case 1:return l=de(l.type,!0),l;default:return""}}function Ie(l){if(l==null)return null;if(typeof l=="function")return l.displayName||l.name||null;if(typeof l=="string")return l;switch(l){case C:return"Fragment";case N:return"Portal";case j:return"Profiler";case P:return"StrictMode";case L:return"Suspense";case H:return"SuspenseList"}if(typeof l=="object")switch(l.$$typeof){case I:return(l.displayName||"Context")+".Consumer";case R:return(l._context.displayName||"Context")+".Provider";case F:var f=l.render;return l=l.displayName,l||(l=f.displayName||f.name||"",l=l!==""?"ForwardRef("+l+")":"ForwardRef"),l;case V:return f=l.displayName||null,f!==null?f:Ie(l.type)||"Memo";case J:f=l._payload,l=l._init;try{return Ie(l(f))}catch{}}return null}function Ne(l){var f=l.type;switch(l.tag){case 24:return"Cache";case 9:return(f.displayName||"Context")+".Consumer";case 10:return(f._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return l=f.render,l=l.displayName||l.name||"",f.displayName||(l!==""?"ForwardRef("+l+")":"ForwardRef");case 7:return"Fragment";case 5:return f;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Ie(f);case 8:return f===P?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof f=="function")return f.displayName||f.name||null;if(typeof f=="string")return f}return null}function W(l){switch(typeof l){case"boolean":case"number":case"string":case"undefined":return l;case"object":return l;default:return""}}function z(l){var f=l.type;return(l=l.nodeName)&&l.toLowerCase()==="input"&&(f==="checkbox"||f==="radio")}function G(l){var f=z(l)?"checked":"value",m=Object.getOwnPropertyDescriptor(l.constructor.prototype,f),b=""+l[f];if(!l.hasOwnProperty(f)&&typeof m<"u"&&typeof m.get=="function"&&typeof m.set=="function"){var A=m.get,O=m.set;return Object.defineProperty(l,f,{configurable:!0,get:function(){return A.call(this)},set:function(B){b=""+B,O.call(this,B)}}),Object.defineProperty(l,f,{enumerable:m.enumerable}),{getValue:function(){return b},setValue:function(B){b=""+B},stopTracking:function(){l._valueTracker=null,delete l[f]}}}}function X(l){l._valueTracker||(l._valueTracker=G(l))}function ie(l){if(!l)return!1;var f=l._valueTracker;if(!f)return!0;var m=f.getValue(),b="";return l&&(b=z(l)?l.checked?"true":"false":l.value),l=b,l!==m?(f.setValue(l),!0):!1}function M(l){if(l=l||(typeof document<"u"?document:void 0),typeof l>"u")return null;try{return l.activeElement||l.body}catch{return l.body}}function le(l,f){var m=f.checked;return Q({},f,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:m??l._wrapperState.initialChecked})}function ye(l,f){var m=f.defaultValue==null?"":f.defaultValue,b=f.checked!=null?f.checked:f.defaultChecked;m=W(f.value!=null?f.value:m),l._wrapperState={initialChecked:b,initialValue:m,controlled:f.type==="checkbox"||f.type==="radio"?f.checked!=null:f.value!=null}}function Ce(l,f){f=f.checked,f!=null&&k(l,"checked",f,!1)}function ze(l,f){Ce(l,f);var m=W(f.value),b=f.type;if(m!=null)b==="number"?(m===0&&l.value===""||l.value!=m)&&(l.value=""+m):l.value!==""+m&&(l.value=""+m);else if(b==="submit"||b==="reset"){l.removeAttribute("value");return}f.hasOwnProperty("value")?rt(l,f.type,m):f.hasOwnProperty("defaultValue")&&rt(l,f.type,W(f.defaultValue)),f.checked==null&&f.defaultChecked!=null&&(l.defaultChecked=!!f.defaultChecked)}function Ze(l,f,m){if(f.hasOwnProperty("value")||f.hasOwnProperty("defaultValue")){var b=f.type;if(!(b!=="submit"&&b!=="reset"||f.value!==void 0&&f.value!==null))return;f=""+l._wrapperState.initialValue,m||f===l.value||(l.value=f),l.defaultValue=f}m=l.name,m!==""&&(l.name=""),l.defaultChecked=!!l._wrapperState.initialChecked,m!==""&&(l.name=m)}function rt(l,f,m){(f!=="number"||M(l.ownerDocument)!==l)&&(m==null?l.defaultValue=""+l._wrapperState.initialValue:l.defaultValue!==""+m&&(l.defaultValue=""+m))}var xt=Array.isArray;function mt(l,f,m,b){if(l=l.options,f){f={};for(var A=0;A<m.length;A++)f["$"+m[A]]=!0;for(m=0;m<l.length;m++)A=f.hasOwnProperty("$"+l[m].value),l[m].selected!==A&&(l[m].selected=A),A&&b&&(l[m].defaultSelected=!0)}else{for(m=""+W(m),f=null,A=0;A<l.length;A++){if(l[A].value===m){l[A].selected=!0,b&&(l[A].defaultSelected=!0);return}f!==null||l[A].disabled||(f=l[A])}f!==null&&(f.selected=!0)}}function Ee(l,f){if(f.dangerouslySetInnerHTML!=null)throw Error(r(91));return Q({},f,{value:void 0,defaultValue:void 0,children:""+l._wrapperState.initialValue})}function ve(l,f){var m=f.value;if(m==null){if(m=f.children,f=f.defaultValue,m!=null){if(f!=null)throw Error(r(92));if(xt(m)){if(1<m.length)throw Error(r(93));m=m[0]}f=m}f==null&&(f=""),m=f}l._wrapperState={initialValue:W(m)}}function fe(l,f){var m=W(f.value),b=W(f.defaultValue);m!=null&&(m=""+m,m!==l.value&&(l.value=m),f.defaultValue==null&&l.defaultValue!==m&&(l.defaultValue=m)),b!=null&&(l.defaultValue=""+b)}function pe(l){var f=l.textContent;f===l._wrapperState.initialValue&&f!==""&&f!==null&&(l.value=f)}function nt(l){switch(l){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function De(l,f){return l==null||l==="http://www.w3.org/1999/xhtml"?nt(f):l==="http://www.w3.org/2000/svg"&&f==="foreignObject"?"http://www.w3.org/1999/xhtml":l}var Oe,Qe=(function(l){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(f,m,b,A){MSApp.execUnsafeLocalFunction(function(){return l(f,m,b,A)})}:l})(function(l,f){if(l.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in l)l.innerHTML=f;else{for(Oe=Oe||document.createElement("div"),Oe.innerHTML="<svg>"+f.valueOf().toString()+"</svg>",f=Oe.firstChild;l.firstChild;)l.removeChild(l.firstChild);for(;f.firstChild;)l.appendChild(f.firstChild)}});function kt(l,f){if(f){var m=l.firstChild;if(m&&m===l.lastChild&&m.nodeType===3){m.nodeValue=f;return}}l.textContent=f}var Re={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},at=["Webkit","ms","Moz","O"];Object.keys(Re).forEach(function(l){at.forEach(function(f){f=f+l.charAt(0).toUpperCase()+l.substring(1),Re[f]=Re[l]})});function bt(l,f,m){return f==null||typeof f=="boolean"||f===""?"":m||typeof f!="number"||f===0||Re.hasOwnProperty(l)&&Re[l]?(""+f).trim():f+"px"}function Yt(l,f){l=l.style;for(var m in f)if(f.hasOwnProperty(m)){var b=m.indexOf("--")===0,A=bt(m,f[m],b);m==="float"&&(m="cssFloat"),b?l.setProperty(m,A):l[m]=A}}var mn=Q({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Mn(l,f){if(f){if(mn[l]&&(f.children!=null||f.dangerouslySetInnerHTML!=null))throw Error(r(137,l));if(f.dangerouslySetInnerHTML!=null){if(f.children!=null)throw Error(r(60));if(typeof f.dangerouslySetInnerHTML!="object"||!("__html"in f.dangerouslySetInnerHTML))throw Error(r(61))}if(f.style!=null&&typeof f.style!="object")throw Error(r(62))}}function va(l,f){if(l.indexOf("-")===-1)return typeof f.is=="string";switch(l){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var ga=null;function Vr(l){return l=l.target||l.srcElement||window,l.correspondingUseElement&&(l=l.correspondingUseElement),l.nodeType===3?l.parentNode:l}var xa=null,ya=null,wa=null;function ba(l){if(l=$c(l)){if(typeof xa!="function")throw Error(r(280));var f=l.stateNode;f&&(f=A0(f),xa(l.stateNode,l.type,f))}}function Me(l){ya?wa?wa.push(l):wa=[l]:ya=l}function et(){if(ya){var l=ya,f=wa;if(wa=ya=null,ba(l),f)for(l=0;l<f.length;l++)ba(f[l])}}function Fe(l,f){return l(f)}function Xe(){}var tt=!1;function pt(l,f,m){if(tt)return l(f,m);tt=!0;try{return Fe(l,f,m)}finally{tt=!1,(ya!==null||wa!==null)&&(Xe(),et())}}function Dt(l,f){var m=l.stateNode;if(m===null)return null;var b=A0(m);if(b===null)return null;m=b[f];e:switch(f){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(b=!b.disabled)||(l=l.type,b=!(l==="button"||l==="input"||l==="select"||l==="textarea")),l=!b;break e;default:l=!1}if(l)return null;if(m&&typeof m!="function")throw Error(r(231,f,typeof m));return m}var hr=!1;if(o)try{var Nr={};Object.defineProperty(Nr,"passive",{get:function(){hr=!0}}),window.addEventListener("test",Nr,Nr),window.removeEventListener("test",Nr,Nr)}catch{hr=!1}function Wt(l,f,m,b,A,O,B,se,ue){var Ae=Array.prototype.slice.call(arguments,3);try{f.apply(m,Ae)}catch(We){this.onError(We)}}var Ht=!1,or=null,U=!1,re=null,K={onError:function(l){Ht=!0,or=l}};function Y(l,f,m,b,A,O,B,se,ue){Ht=!1,or=null,Wt.apply(K,arguments)}function ne(l,f,m,b,A,O,B,se,ue){if(Y.apply(this,arguments),Ht){if(Ht){var Ae=or;Ht=!1,or=null}else throw Error(r(198));U||(U=!0,re=Ae)}}function ae(l){var f=l,m=l;if(l.alternate)for(;f.return;)f=f.return;else{l=f;do f=l,(f.flags&4098)!==0&&(m=f.return),l=f.return;while(l)}return f.tag===3?m:null}function ge(l){if(l.tag===13){var f=l.memoizedState;if(f===null&&(l=l.alternate,l!==null&&(f=l.memoizedState)),f!==null)return f.dehydrated}return null}function Pe(l){if(ae(l)!==l)throw Error(r(188))}function we(l){var f=l.alternate;if(!f){if(f=ae(l),f===null)throw Error(r(188));return f!==l?null:l}for(var m=l,b=f;;){var A=m.return;if(A===null)break;var O=A.alternate;if(O===null){if(b=A.return,b!==null){m=b;continue}break}if(A.child===O.child){for(O=A.child;O;){if(O===m)return Pe(A),l;if(O===b)return Pe(A),f;O=O.sibling}throw Error(r(188))}if(m.return!==b.return)m=A,b=O;else{for(var B=!1,se=A.child;se;){if(se===m){B=!0,m=A,b=O;break}if(se===b){B=!0,b=A,m=O;break}se=se.sibling}if(!B){for(se=O.child;se;){if(se===m){B=!0,m=O,b=A;break}if(se===b){B=!0,b=O,m=A;break}se=se.sibling}if(!B)throw Error(r(189))}}if(m.alternate!==b)throw Error(r(190))}if(m.tag!==3)throw Error(r(188));return m.stateNode.current===m?l:f}function _e(l){return l=we(l),l!==null?Se(l):null}function Se(l){if(l.tag===5||l.tag===6)return l;for(l=l.child;l!==null;){var f=Se(l);if(f!==null)return f;l=l.sibling}return null}var He=t.unstable_scheduleCallback,Je=t.unstable_cancelCallback,st=t.unstable_shouldYield,Ve=t.unstable_requestPaint,$e=t.unstable_now,At=t.unstable_getCurrentPriorityLevel,ur=t.unstable_ImmediatePriority,mr=t.unstable_UserBlockingPriority,Dr=t.unstable_NormalPriority,ro=t.unstable_LowPriority,gs=t.unstable_IdlePriority,hi=null,nn=null;function bc(l){if(nn&&typeof nn.onCommitFiberRoot=="function")try{nn.onCommitFiberRoot(hi,l,void 0,(l.current.flags&128)===128)}catch{}}var jr=Math.clz32?Math.clz32:HD,zD=Math.log,WD=Math.LN2;function HD(l){return l>>>=0,l===0?32:31-(zD(l)/WD|0)|0}var c0=64,u0=4194304;function _c(l){switch(l&-l){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return l&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return l&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return l}}function f0(l,f){var m=l.pendingLanes;if(m===0)return 0;var b=0,A=l.suspendedLanes,O=l.pingedLanes,B=m&268435455;if(B!==0){var se=B&~A;se!==0?b=_c(se):(O&=B,O!==0&&(b=_c(O)))}else B=m&~A,B!==0?b=_c(B):O!==0&&(b=_c(O));if(b===0)return 0;if(f!==0&&f!==b&&(f&A)===0&&(A=b&-b,O=f&-f,A>=O||A===16&&(O&4194240)!==0))return f;if((b&4)!==0&&(b|=m&16),f=l.entangledLanes,f!==0)for(l=l.entanglements,f&=b;0<f;)m=31-jr(f),A=1<<m,b|=l[m],f&=~A;return b}function qD(l,f){switch(l){case 1:case 2:case 4:return f+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return f+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function VD(l,f){for(var m=l.suspendedLanes,b=l.pingedLanes,A=l.expirationTimes,O=l.pendingLanes;0<O;){var B=31-jr(O),se=1<<B,ue=A[B];ue===-1?((se&m)===0||(se&b)!==0)&&(A[B]=qD(se,f)):ue<=f&&(l.expiredLanes|=se),O&=~se}}function Kp(l){return l=l.pendingLanes&-1073741825,l!==0?l:l&1073741824?1073741824:0}function J_(){var l=c0;return c0<<=1,(c0&4194240)===0&&(c0=64),l}function Yp(l){for(var f=[],m=0;31>m;m++)f.push(l);return f}function Sc(l,f,m){l.pendingLanes|=f,f!==536870912&&(l.suspendedLanes=0,l.pingedLanes=0),l=l.eventTimes,f=31-jr(f),l[f]=m}function XD(l,f){var m=l.pendingLanes&~f;l.pendingLanes=f,l.suspendedLanes=0,l.pingedLanes=0,l.expiredLanes&=f,l.mutableReadLanes&=f,l.entangledLanes&=f,f=l.entanglements;var b=l.eventTimes;for(l=l.expirationTimes;0<m;){var A=31-jr(m),O=1<<A;f[A]=0,b[A]=-1,l[A]=-1,m&=~O}}function Zp(l,f){var m=l.entangledLanes|=f;for(l=l.entanglements;m;){var b=31-jr(m),A=1<<b;A&f|l[b]&f&&(l[b]|=f),m&=~A}}var lr=0;function eS(l){return l&=-l,1<l?4<l?(l&268435455)!==0?16:536870912:4:1}var tS,Qp,rS,nS,aS,Jp=!1,d0=[],xs=null,ys=null,ws=null,kc=new Map,Ec=new Map,bs=[],GD="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function iS(l,f){switch(l){case"focusin":case"focusout":xs=null;break;case"dragenter":case"dragleave":ys=null;break;case"mouseover":case"mouseout":ws=null;break;case"pointerover":case"pointerout":kc.delete(f.pointerId);break;case"gotpointercapture":case"lostpointercapture":Ec.delete(f.pointerId)}}function Tc(l,f,m,b,A,O){return l===null||l.nativeEvent!==O?(l={blockedOn:f,domEventName:m,eventSystemFlags:b,nativeEvent:O,targetContainers:[A]},f!==null&&(f=$c(f),f!==null&&Qp(f)),l):(l.eventSystemFlags|=b,f=l.targetContainers,A!==null&&f.indexOf(A)===-1&&f.push(A),l)}function KD(l,f,m,b,A){switch(f){case"focusin":return xs=Tc(xs,l,f,m,b,A),!0;case"dragenter":return ys=Tc(ys,l,f,m,b,A),!0;case"mouseover":return ws=Tc(ws,l,f,m,b,A),!0;case"pointerover":var O=A.pointerId;return kc.set(O,Tc(kc.get(O)||null,l,f,m,b,A)),!0;case"gotpointercapture":return O=A.pointerId,Ec.set(O,Tc(Ec.get(O)||null,l,f,m,b,A)),!0}return!1}function sS(l){var f=no(l.target);if(f!==null){var m=ae(f);if(m!==null){if(f=m.tag,f===13){if(f=ge(m),f!==null){l.blockedOn=f,aS(l.priority,function(){rS(m)});return}}else if(f===3&&m.stateNode.current.memoizedState.isDehydrated){l.blockedOn=m.tag===3?m.stateNode.containerInfo:null;return}}}l.blockedOn=null}function h0(l){if(l.blockedOn!==null)return!1;for(var f=l.targetContainers;0<f.length;){var m=tm(l.domEventName,l.eventSystemFlags,f[0],l.nativeEvent);if(m===null){m=l.nativeEvent;var b=new m.constructor(m.type,m);ga=b,m.target.dispatchEvent(b),ga=null}else return f=$c(m),f!==null&&Qp(f),l.blockedOn=m,!1;f.shift()}return!0}function oS(l,f,m){h0(l)&&m.delete(f)}function YD(){Jp=!1,xs!==null&&h0(xs)&&(xs=null),ys!==null&&h0(ys)&&(ys=null),ws!==null&&h0(ws)&&(ws=null),kc.forEach(oS),Ec.forEach(oS)}function Ac(l,f){l.blockedOn===f&&(l.blockedOn=null,Jp||(Jp=!0,t.unstable_scheduleCallback(t.unstable_NormalPriority,YD)))}function Cc(l){function f(A){return Ac(A,l)}if(0<d0.length){Ac(d0[0],l);for(var m=1;m<d0.length;m++){var b=d0[m];b.blockedOn===l&&(b.blockedOn=null)}}for(xs!==null&&Ac(xs,l),ys!==null&&Ac(ys,l),ws!==null&&Ac(ws,l),kc.forEach(f),Ec.forEach(f),m=0;m<bs.length;m++)b=bs[m],b.blockedOn===l&&(b.blockedOn=null);for(;0<bs.length&&(m=bs[0],m.blockedOn===null);)sS(m),m.blockedOn===null&&bs.shift()}var tl=E.ReactCurrentBatchConfig,p0=!0;function ZD(l,f,m,b){var A=lr,O=tl.transition;tl.transition=null;try{lr=1,em(l,f,m,b)}finally{lr=A,tl.transition=O}}function QD(l,f,m,b){var A=lr,O=tl.transition;tl.transition=null;try{lr=4,em(l,f,m,b)}finally{lr=A,tl.transition=O}}function em(l,f,m,b){if(p0){var A=tm(l,f,m,b);if(A===null)xm(l,f,b,m0,m),iS(l,b);else if(KD(A,l,f,m,b))b.stopPropagation();else if(iS(l,b),f&4&&-1<GD.indexOf(l)){for(;A!==null;){var O=$c(A);if(O!==null&&tS(O),O=tm(l,f,m,b),O===null&&xm(l,f,b,m0,m),O===A)break;A=O}A!==null&&b.stopPropagation()}else xm(l,f,b,null,m)}}var m0=null;function tm(l,f,m,b){if(m0=null,l=Vr(b),l=no(l),l!==null)if(f=ae(l),f===null)l=null;else if(m=f.tag,m===13){if(l=ge(f),l!==null)return l;l=null}else if(m===3){if(f.stateNode.current.memoizedState.isDehydrated)return f.tag===3?f.stateNode.containerInfo:null;l=null}else f!==l&&(l=null);return m0=l,null}function lS(l){switch(l){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(At()){case ur:return 1;case mr:return 4;case Dr:case ro:return 16;case gs:return 536870912;default:return 16}default:return 16}}var _s=null,rm=null,v0=null;function cS(){if(v0)return v0;var l,f=rm,m=f.length,b,A="value"in _s?_s.value:_s.textContent,O=A.length;for(l=0;l<m&&f[l]===A[l];l++);var B=m-l;for(b=1;b<=B&&f[m-b]===A[O-b];b++);return v0=A.slice(l,1<b?1-b:void 0)}function g0(l){var f=l.keyCode;return"charCode"in l?(l=l.charCode,l===0&&f===13&&(l=13)):l=f,l===10&&(l=13),32<=l||l===13?l:0}function x0(){return!0}function uS(){return!1}function na(l){function f(m,b,A,O,B){this._reactName=m,this._targetInst=A,this.type=b,this.nativeEvent=O,this.target=B,this.currentTarget=null;for(var se in l)l.hasOwnProperty(se)&&(m=l[se],this[se]=m?m(O):O[se]);return this.isDefaultPrevented=(O.defaultPrevented!=null?O.defaultPrevented:O.returnValue===!1)?x0:uS,this.isPropagationStopped=uS,this}return Q(f.prototype,{preventDefault:function(){this.defaultPrevented=!0;var m=this.nativeEvent;m&&(m.preventDefault?m.preventDefault():typeof m.returnValue!="unknown"&&(m.returnValue=!1),this.isDefaultPrevented=x0)},stopPropagation:function(){var m=this.nativeEvent;m&&(m.stopPropagation?m.stopPropagation():typeof m.cancelBubble!="unknown"&&(m.cancelBubble=!0),this.isPropagationStopped=x0)},persist:function(){},isPersistent:x0}),f}var rl={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(l){return l.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},nm=na(rl),Oc=Q({},rl,{view:0,detail:0}),JD=na(Oc),am,im,Nc,y0=Q({},Oc,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:om,button:0,buttons:0,relatedTarget:function(l){return l.relatedTarget===void 0?l.fromElement===l.srcElement?l.toElement:l.fromElement:l.relatedTarget},movementX:function(l){return"movementX"in l?l.movementX:(l!==Nc&&(Nc&&l.type==="mousemove"?(am=l.screenX-Nc.screenX,im=l.screenY-Nc.screenY):im=am=0,Nc=l),am)},movementY:function(l){return"movementY"in l?l.movementY:im}}),fS=na(y0),ej=Q({},y0,{dataTransfer:0}),tj=na(ej),rj=Q({},Oc,{relatedTarget:0}),sm=na(rj),nj=Q({},rl,{animationName:0,elapsedTime:0,pseudoElement:0}),aj=na(nj),ij=Q({},rl,{clipboardData:function(l){return"clipboardData"in l?l.clipboardData:window.clipboardData}}),sj=na(ij),oj=Q({},rl,{data:0}),dS=na(oj),lj={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},cj={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},uj={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function fj(l){var f=this.nativeEvent;return f.getModifierState?f.getModifierState(l):(l=uj[l])?!!f[l]:!1}function om(){return fj}var dj=Q({},Oc,{key:function(l){if(l.key){var f=lj[l.key]||l.key;if(f!=="Unidentified")return f}return l.type==="keypress"?(l=g0(l),l===13?"Enter":String.fromCharCode(l)):l.type==="keydown"||l.type==="keyup"?cj[l.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:om,charCode:function(l){return l.type==="keypress"?g0(l):0},keyCode:function(l){return l.type==="keydown"||l.type==="keyup"?l.keyCode:0},which:function(l){return l.type==="keypress"?g0(l):l.type==="keydown"||l.type==="keyup"?l.keyCode:0}}),hj=na(dj),pj=Q({},y0,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),hS=na(pj),mj=Q({},Oc,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:om}),vj=na(mj),gj=Q({},rl,{propertyName:0,elapsedTime:0,pseudoElement:0}),xj=na(gj),yj=Q({},y0,{deltaX:function(l){return"deltaX"in l?l.deltaX:"wheelDeltaX"in l?-l.wheelDeltaX:0},deltaY:function(l){return"deltaY"in l?l.deltaY:"wheelDeltaY"in l?-l.wheelDeltaY:"wheelDelta"in l?-l.wheelDelta:0},deltaZ:0,deltaMode:0}),wj=na(yj),bj=[9,13,27,32],lm=o&&"CompositionEvent"in window,Pc=null;o&&"documentMode"in document&&(Pc=document.documentMode);var _j=o&&"TextEvent"in window&&!Pc,pS=o&&(!lm||Pc&&8<Pc&&11>=Pc),mS=" ",vS=!1;function gS(l,f){switch(l){case"keyup":return bj.indexOf(f.keyCode)!==-1;case"keydown":return f.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function xS(l){return l=l.detail,typeof l=="object"&&"data"in l?l.data:null}var nl=!1;function Sj(l,f){switch(l){case"compositionend":return xS(f);case"keypress":return f.which!==32?null:(vS=!0,mS);case"textInput":return l=f.data,l===mS&&vS?null:l;default:return null}}function kj(l,f){if(nl)return l==="compositionend"||!lm&&gS(l,f)?(l=cS(),v0=rm=_s=null,nl=!1,l):null;switch(l){case"paste":return null;case"keypress":if(!(f.ctrlKey||f.altKey||f.metaKey)||f.ctrlKey&&f.altKey){if(f.char&&1<f.char.length)return f.char;if(f.which)return String.fromCharCode(f.which)}return null;case"compositionend":return pS&&f.locale!=="ko"?null:f.data;default:return null}}var Ej={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function yS(l){var f=l&&l.nodeName&&l.nodeName.toLowerCase();return f==="input"?!!Ej[l.type]:f==="textarea"}function wS(l,f,m,b){Me(b),f=k0(f,"onChange"),0<f.length&&(m=new nm("onChange","change",null,m,b),l.push({event:m,listeners:f}))}var Ic=null,Fc=null;function Tj(l){LS(l,0)}function w0(l){var f=ll(l);if(ie(f))return l}function Aj(l,f){if(l==="change")return f}var bS=!1;if(o){var cm;if(o){var um="oninput"in document;if(!um){var _S=document.createElement("div");_S.setAttribute("oninput","return;"),um=typeof _S.oninput=="function"}cm=um}else cm=!1;bS=cm&&(!document.documentMode||9<document.documentMode)}function SS(){Ic&&(Ic.detachEvent("onpropertychange",kS),Fc=Ic=null)}function kS(l){if(l.propertyName==="value"&&w0(Fc)){var f=[];wS(f,Fc,l,Vr(l)),pt(Tj,f)}}function Cj(l,f,m){l==="focusin"?(SS(),Ic=f,Fc=m,Ic.attachEvent("onpropertychange",kS)):l==="focusout"&&SS()}function Oj(l){if(l==="selectionchange"||l==="keyup"||l==="keydown")return w0(Fc)}function Nj(l,f){if(l==="click")return w0(f)}function Pj(l,f){if(l==="input"||l==="change")return w0(f)}function Ij(l,f){return l===f&&(l!==0||1/l===1/f)||l!==l&&f!==f}var Ka=typeof Object.is=="function"?Object.is:Ij;function Dc(l,f){if(Ka(l,f))return!0;if(typeof l!="object"||l===null||typeof f!="object"||f===null)return!1;var m=Object.keys(l),b=Object.keys(f);if(m.length!==b.length)return!1;for(b=0;b<m.length;b++){var A=m[b];if(!c.call(f,A)||!Ka(l[A],f[A]))return!1}return!0}function ES(l){for(;l&&l.firstChild;)l=l.firstChild;return l}function TS(l,f){var m=ES(l);l=0;for(var b;m;){if(m.nodeType===3){if(b=l+m.textContent.length,l<=f&&b>=f)return{node:m,offset:f-l};l=b}e:{for(;m;){if(m.nextSibling){m=m.nextSibling;break e}m=m.parentNode}m=void 0}m=ES(m)}}function AS(l,f){return l&&f?l===f?!0:l&&l.nodeType===3?!1:f&&f.nodeType===3?AS(l,f.parentNode):"contains"in l?l.contains(f):l.compareDocumentPosition?!!(l.compareDocumentPosition(f)&16):!1:!1}function CS(){for(var l=window,f=M();f instanceof l.HTMLIFrameElement;){try{var m=typeof f.contentWindow.location.href=="string"}catch{m=!1}if(m)l=f.contentWindow;else break;f=M(l.document)}return f}function fm(l){var f=l&&l.nodeName&&l.nodeName.toLowerCase();return f&&(f==="input"&&(l.type==="text"||l.type==="search"||l.type==="tel"||l.type==="url"||l.type==="password")||f==="textarea"||l.contentEditable==="true")}function Fj(l){var f=CS(),m=l.focusedElem,b=l.selectionRange;if(f!==m&&m&&m.ownerDocument&&AS(m.ownerDocument.documentElement,m)){if(b!==null&&fm(m)){if(f=b.start,l=b.end,l===void 0&&(l=f),"selectionStart"in m)m.selectionStart=f,m.selectionEnd=Math.min(l,m.value.length);else if(l=(f=m.ownerDocument||document)&&f.defaultView||window,l.getSelection){l=l.getSelection();var A=m.textContent.length,O=Math.min(b.start,A);b=b.end===void 0?O:Math.min(b.end,A),!l.extend&&O>b&&(A=b,b=O,O=A),A=TS(m,O);var B=TS(m,b);A&&B&&(l.rangeCount!==1||l.anchorNode!==A.node||l.anchorOffset!==A.offset||l.focusNode!==B.node||l.focusOffset!==B.offset)&&(f=f.createRange(),f.setStart(A.node,A.offset),l.removeAllRanges(),O>b?(l.addRange(f),l.extend(B.node,B.offset)):(f.setEnd(B.node,B.offset),l.addRange(f)))}}for(f=[],l=m;l=l.parentNode;)l.nodeType===1&&f.push({element:l,left:l.scrollLeft,top:l.scrollTop});for(typeof m.focus=="function"&&m.focus(),m=0;m<f.length;m++)l=f[m],l.element.scrollLeft=l.left,l.element.scrollTop=l.top}}var Dj=o&&"documentMode"in document&&11>=document.documentMode,al=null,dm=null,jc=null,hm=!1;function OS(l,f,m){var b=m.window===m?m.document:m.nodeType===9?m:m.ownerDocument;hm||al==null||al!==M(b)||(b=al,"selectionStart"in b&&fm(b)?b={start:b.selectionStart,end:b.selectionEnd}:(b=(b.ownerDocument&&b.ownerDocument.defaultView||window).getSelection(),b={anchorNode:b.anchorNode,anchorOffset:b.anchorOffset,focusNode:b.focusNode,focusOffset:b.focusOffset}),jc&&Dc(jc,b)||(jc=b,b=k0(dm,"onSelect"),0<b.length&&(f=new nm("onSelect","select",null,f,m),l.push({event:f,listeners:b}),f.target=al)))}function b0(l,f){var m={};return m[l.toLowerCase()]=f.toLowerCase(),m["Webkit"+l]="webkit"+f,m["Moz"+l]="moz"+f,m}var il={animationend:b0("Animation","AnimationEnd"),animationiteration:b0("Animation","AnimationIteration"),animationstart:b0("Animation","AnimationStart"),transitionend:b0("Transition","TransitionEnd")},pm={},NS={};o&&(NS=document.createElement("div").style,"AnimationEvent"in window||(delete il.animationend.animation,delete il.animationiteration.animation,delete il.animationstart.animation),"TransitionEvent"in window||delete il.transitionend.transition);function _0(l){if(pm[l])return pm[l];if(!il[l])return l;var f=il[l],m;for(m in f)if(f.hasOwnProperty(m)&&m in NS)return pm[l]=f[m];return l}var PS=_0("animationend"),IS=_0("animationiteration"),FS=_0("animationstart"),DS=_0("transitionend"),jS=new Map,RS="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Ss(l,f){jS.set(l,f),i(f,[l])}for(var mm=0;mm<RS.length;mm++){var vm=RS[mm],jj=vm.toLowerCase(),Rj=vm[0].toUpperCase()+vm.slice(1);Ss(jj,"on"+Rj)}Ss(PS,"onAnimationEnd"),Ss(IS,"onAnimationIteration"),Ss(FS,"onAnimationStart"),Ss("dblclick","onDoubleClick"),Ss("focusin","onFocus"),Ss("focusout","onBlur"),Ss(DS,"onTransitionEnd"),s("onMouseEnter",["mouseout","mouseover"]),s("onMouseLeave",["mouseout","mouseover"]),s("onPointerEnter",["pointerout","pointerover"]),s("onPointerLeave",["pointerout","pointerover"]),i("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),i("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),i("onBeforeInput",["compositionend","keypress","textInput","paste"]),i("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),i("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),i("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Rc="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Mj=new Set("cancel close invalid load scroll toggle".split(" ").concat(Rc));function MS(l,f,m){var b=l.type||"unknown-event";l.currentTarget=m,ne(b,f,void 0,l),l.currentTarget=null}function LS(l,f){f=(f&4)!==0;for(var m=0;m<l.length;m++){var b=l[m],A=b.event;b=b.listeners;e:{var O=void 0;if(f)for(var B=b.length-1;0<=B;B--){var se=b[B],ue=se.instance,Ae=se.currentTarget;if(se=se.listener,ue!==O&&A.isPropagationStopped())break e;MS(A,se,Ae),O=ue}else for(B=0;B<b.length;B++){if(se=b[B],ue=se.instance,Ae=se.currentTarget,se=se.listener,ue!==O&&A.isPropagationStopped())break e;MS(A,se,Ae),O=ue}}}if(U)throw l=re,U=!1,re=null,l}function yr(l,f){var m=f[km];m===void 0&&(m=f[km]=new Set);var b=l+"__bubble";m.has(b)||(BS(f,l,2,!1),m.add(b))}function gm(l,f,m){var b=0;f&&(b|=4),BS(m,l,b,f)}var S0="_reactListening"+Math.random().toString(36).slice(2);function Mc(l){if(!l[S0]){l[S0]=!0,n.forEach(function(m){m!=="selectionchange"&&(Mj.has(m)||gm(m,!1,l),gm(m,!0,l))});var f=l.nodeType===9?l:l.ownerDocument;f===null||f[S0]||(f[S0]=!0,gm("selectionchange",!1,f))}}function BS(l,f,m,b){switch(lS(f)){case 1:var A=ZD;break;case 4:A=QD;break;default:A=em}m=A.bind(null,f,m,l),A=void 0,!hr||f!=="touchstart"&&f!=="touchmove"&&f!=="wheel"||(A=!0),b?A!==void 0?l.addEventListener(f,m,{capture:!0,passive:A}):l.addEventListener(f,m,!0):A!==void 0?l.addEventListener(f,m,{passive:A}):l.addEventListener(f,m,!1)}function xm(l,f,m,b,A){var O=b;if((f&1)===0&&(f&2)===0&&b!==null)e:for(;;){if(b===null)return;var B=b.tag;if(B===3||B===4){var se=b.stateNode.containerInfo;if(se===A||se.nodeType===8&&se.parentNode===A)break;if(B===4)for(B=b.return;B!==null;){var ue=B.tag;if((ue===3||ue===4)&&(ue=B.stateNode.containerInfo,ue===A||ue.nodeType===8&&ue.parentNode===A))return;B=B.return}for(;se!==null;){if(B=no(se),B===null)return;if(ue=B.tag,ue===5||ue===6){b=O=B;continue e}se=se.parentNode}}b=b.return}pt(function(){var Ae=O,We=Vr(m),qe=[];e:{var Ue=jS.get(l);if(Ue!==void 0){var it=nm,ft=l;switch(l){case"keypress":if(g0(m)===0)break e;case"keydown":case"keyup":it=hj;break;case"focusin":ft="focus",it=sm;break;case"focusout":ft="blur",it=sm;break;case"beforeblur":case"afterblur":it=sm;break;case"click":if(m.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":it=fS;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":it=tj;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":it=vj;break;case PS:case IS:case FS:it=aj;break;case DS:it=xj;break;case"scroll":it=JD;break;case"wheel":it=wj;break;case"copy":case"cut":case"paste":it=sj;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":it=hS}var dt=(f&4)!==0,Rr=!dt&&l==="scroll",xe=dt?Ue!==null?Ue+"Capture":null:Ue;dt=[];for(var he=Ae,ke;he!==null;){ke=he;var Ke=ke.stateNode;if(ke.tag===5&&Ke!==null&&(ke=Ke,xe!==null&&(Ke=Dt(he,xe),Ke!=null&&dt.push(Lc(he,Ke,ke)))),Rr)break;he=he.return}0<dt.length&&(Ue=new it(Ue,ft,null,m,We),qe.push({event:Ue,listeners:dt}))}}if((f&7)===0){e:{if(Ue=l==="mouseover"||l==="pointerover",it=l==="mouseout"||l==="pointerout",Ue&&m!==ga&&(ft=m.relatedTarget||m.fromElement)&&(no(ft)||ft[Ri]))break e;if((it||Ue)&&(Ue=We.window===We?We:(Ue=We.ownerDocument)?Ue.defaultView||Ue.parentWindow:window,it?(ft=m.relatedTarget||m.toElement,it=Ae,ft=ft?no(ft):null,ft!==null&&(Rr=ae(ft),ft!==Rr||ft.tag!==5&&ft.tag!==6)&&(ft=null)):(it=null,ft=Ae),it!==ft)){if(dt=fS,Ke="onMouseLeave",xe="onMouseEnter",he="mouse",(l==="pointerout"||l==="pointerover")&&(dt=hS,Ke="onPointerLeave",xe="onPointerEnter",he="pointer"),Rr=it==null?Ue:ll(it),ke=ft==null?Ue:ll(ft),Ue=new dt(Ke,he+"leave",it,m,We),Ue.target=Rr,Ue.relatedTarget=ke,Ke=null,no(We)===Ae&&(dt=new dt(xe,he+"enter",ft,m,We),dt.target=ke,dt.relatedTarget=Rr,Ke=dt),Rr=Ke,it&&ft)t:{for(dt=it,xe=ft,he=0,ke=dt;ke;ke=sl(ke))he++;for(ke=0,Ke=xe;Ke;Ke=sl(Ke))ke++;for(;0<he-ke;)dt=sl(dt),he--;for(;0<ke-he;)xe=sl(xe),ke--;for(;he--;){if(dt===xe||xe!==null&&dt===xe.alternate)break t;dt=sl(dt),xe=sl(xe)}dt=null}else dt=null;it!==null&&$S(qe,Ue,it,dt,!1),ft!==null&&Rr!==null&&$S(qe,Rr,ft,dt,!0)}}e:{if(Ue=Ae?ll(Ae):window,it=Ue.nodeName&&Ue.nodeName.toLowerCase(),it==="select"||it==="input"&&Ue.type==="file")var vt=Aj;else if(yS(Ue))if(bS)vt=Pj;else{vt=Oj;var _t=Cj}else(it=Ue.nodeName)&&it.toLowerCase()==="input"&&(Ue.type==="checkbox"||Ue.type==="radio")&&(vt=Nj);if(vt&&(vt=vt(l,Ae))){wS(qe,vt,m,We);break e}_t&&_t(l,Ue,Ae),l==="focusout"&&(_t=Ue._wrapperState)&&_t.controlled&&Ue.type==="number"&&rt(Ue,"number",Ue.value)}switch(_t=Ae?ll(Ae):window,l){case"focusin":(yS(_t)||_t.contentEditable==="true")&&(al=_t,dm=Ae,jc=null);break;case"focusout":jc=dm=al=null;break;case"mousedown":hm=!0;break;case"contextmenu":case"mouseup":case"dragend":hm=!1,OS(qe,m,We);break;case"selectionchange":if(Dj)break;case"keydown":case"keyup":OS(qe,m,We)}var St;if(lm)e:{switch(l){case"compositionstart":var Tt="onCompositionStart";break e;case"compositionend":Tt="onCompositionEnd";break e;case"compositionupdate":Tt="onCompositionUpdate";break e}Tt=void 0}else nl?gS(l,m)&&(Tt="onCompositionEnd"):l==="keydown"&&m.keyCode===229&&(Tt="onCompositionStart");Tt&&(pS&&m.locale!=="ko"&&(nl||Tt!=="onCompositionStart"?Tt==="onCompositionEnd"&&nl&&(St=cS()):(_s=We,rm="value"in _s?_s.value:_s.textContent,nl=!0)),_t=k0(Ae,Tt),0<_t.length&&(Tt=new dS(Tt,l,null,m,We),qe.push({event:Tt,listeners:_t}),St?Tt.data=St:(St=xS(m),St!==null&&(Tt.data=St)))),(St=_j?Sj(l,m):kj(l,m))&&(Ae=k0(Ae,"onBeforeInput"),0<Ae.length&&(We=new dS("onBeforeInput","beforeinput",null,m,We),qe.push({event:We,listeners:Ae}),We.data=St))}LS(qe,f)})}function Lc(l,f,m){return{instance:l,listener:f,currentTarget:m}}function k0(l,f){for(var m=f+"Capture",b=[];l!==null;){var A=l,O=A.stateNode;A.tag===5&&O!==null&&(A=O,O=Dt(l,m),O!=null&&b.unshift(Lc(l,O,A)),O=Dt(l,f),O!=null&&b.push(Lc(l,O,A))),l=l.return}return b}function sl(l){if(l===null)return null;do l=l.return;while(l&&l.tag!==5);return l||null}function $S(l,f,m,b,A){for(var O=f._reactName,B=[];m!==null&&m!==b;){var se=m,ue=se.alternate,Ae=se.stateNode;if(ue!==null&&ue===b)break;se.tag===5&&Ae!==null&&(se=Ae,A?(ue=Dt(m,O),ue!=null&&B.unshift(Lc(m,ue,se))):A||(ue=Dt(m,O),ue!=null&&B.push(Lc(m,ue,se)))),m=m.return}B.length!==0&&l.push({event:f,listeners:B})}var Lj=/\r\n?/g,Bj=/\u0000|\uFFFD/g;function US(l){return(typeof l=="string"?l:""+l).replace(Lj,`
`).replace(Bj,"")}function E0(l,f,m){if(f=US(f),US(l)!==f&&m)throw Error(r(425))}function T0(){}var ym=null,wm=null;function bm(l,f){return l==="textarea"||l==="noscript"||typeof f.children=="string"||typeof f.children=="number"||typeof f.dangerouslySetInnerHTML=="object"&&f.dangerouslySetInnerHTML!==null&&f.dangerouslySetInnerHTML.__html!=null}var _m=typeof setTimeout=="function"?setTimeout:void 0,$j=typeof clearTimeout=="function"?clearTimeout:void 0,zS=typeof Promise=="function"?Promise:void 0,Uj=typeof queueMicrotask=="function"?queueMicrotask:typeof zS<"u"?function(l){return zS.resolve(null).then(l).catch(zj)}:_m;function zj(l){setTimeout(function(){throw l})}function Sm(l,f){var m=f,b=0;do{var A=m.nextSibling;if(l.removeChild(m),A&&A.nodeType===8)if(m=A.data,m==="/$"){if(b===0){l.removeChild(A),Cc(f);return}b--}else m!=="$"&&m!=="$?"&&m!=="$!"||b++;m=A}while(m);Cc(f)}function ks(l){for(;l!=null;l=l.nextSibling){var f=l.nodeType;if(f===1||f===3)break;if(f===8){if(f=l.data,f==="$"||f==="$!"||f==="$?")break;if(f==="/$")return null}}return l}function WS(l){l=l.previousSibling;for(var f=0;l;){if(l.nodeType===8){var m=l.data;if(m==="$"||m==="$!"||m==="$?"){if(f===0)return l;f--}else m==="/$"&&f++}l=l.previousSibling}return null}var ol=Math.random().toString(36).slice(2),pi="__reactFiber$"+ol,Bc="__reactProps$"+ol,Ri="__reactContainer$"+ol,km="__reactEvents$"+ol,Wj="__reactListeners$"+ol,Hj="__reactHandles$"+ol;function no(l){var f=l[pi];if(f)return f;for(var m=l.parentNode;m;){if(f=m[Ri]||m[pi]){if(m=f.alternate,f.child!==null||m!==null&&m.child!==null)for(l=WS(l);l!==null;){if(m=l[pi])return m;l=WS(l)}return f}l=m,m=l.parentNode}return null}function $c(l){return l=l[pi]||l[Ri],!l||l.tag!==5&&l.tag!==6&&l.tag!==13&&l.tag!==3?null:l}function ll(l){if(l.tag===5||l.tag===6)return l.stateNode;throw Error(r(33))}function A0(l){return l[Bc]||null}var Em=[],cl=-1;function Es(l){return{current:l}}function wr(l){0>cl||(l.current=Em[cl],Em[cl]=null,cl--)}function vr(l,f){cl++,Em[cl]=l.current,l.current=f}var Ts={},_n=Es(Ts),qn=Es(!1),ao=Ts;function ul(l,f){var m=l.type.contextTypes;if(!m)return Ts;var b=l.stateNode;if(b&&b.__reactInternalMemoizedUnmaskedChildContext===f)return b.__reactInternalMemoizedMaskedChildContext;var A={},O;for(O in m)A[O]=f[O];return b&&(l=l.stateNode,l.__reactInternalMemoizedUnmaskedChildContext=f,l.__reactInternalMemoizedMaskedChildContext=A),A}function Vn(l){return l=l.childContextTypes,l!=null}function C0(){wr(qn),wr(_n)}function HS(l,f,m){if(_n.current!==Ts)throw Error(r(168));vr(_n,f),vr(qn,m)}function qS(l,f,m){var b=l.stateNode;if(f=f.childContextTypes,typeof b.getChildContext!="function")return m;b=b.getChildContext();for(var A in b)if(!(A in f))throw Error(r(108,Ne(l)||"Unknown",A));return Q({},m,b)}function O0(l){return l=(l=l.stateNode)&&l.__reactInternalMemoizedMergedChildContext||Ts,ao=_n.current,vr(_n,l),vr(qn,qn.current),!0}function VS(l,f,m){var b=l.stateNode;if(!b)throw Error(r(169));m?(l=qS(l,f,ao),b.__reactInternalMemoizedMergedChildContext=l,wr(qn),wr(_n),vr(_n,l)):wr(qn),vr(qn,m)}var Mi=null,N0=!1,Tm=!1;function XS(l){Mi===null?Mi=[l]:Mi.push(l)}function qj(l){N0=!0,XS(l)}function As(){if(!Tm&&Mi!==null){Tm=!0;var l=0,f=lr;try{var m=Mi;for(lr=1;l<m.length;l++){var b=m[l];do b=b(!0);while(b!==null)}Mi=null,N0=!1}catch(A){throw Mi!==null&&(Mi=Mi.slice(l+1)),He(ur,As),A}finally{lr=f,Tm=!1}}return null}var fl=[],dl=0,P0=null,I0=0,_a=[],Sa=0,io=null,Li=1,Bi="";function so(l,f){fl[dl++]=I0,fl[dl++]=P0,P0=l,I0=f}function GS(l,f,m){_a[Sa++]=Li,_a[Sa++]=Bi,_a[Sa++]=io,io=l;var b=Li;l=Bi;var A=32-jr(b)-1;b&=~(1<<A),m+=1;var O=32-jr(f)+A;if(30<O){var B=A-A%5;O=(b&(1<<B)-1).toString(32),b>>=B,A-=B,Li=1<<32-jr(f)+A|m<<A|b,Bi=O+l}else Li=1<<O|m<<A|b,Bi=l}function Am(l){l.return!==null&&(so(l,1),GS(l,1,0))}function Cm(l){for(;l===P0;)P0=fl[--dl],fl[dl]=null,I0=fl[--dl],fl[dl]=null;for(;l===io;)io=_a[--Sa],_a[Sa]=null,Bi=_a[--Sa],_a[Sa]=null,Li=_a[--Sa],_a[Sa]=null}var aa=null,ia=null,Sr=!1,Ya=null;function KS(l,f){var m=Aa(5,null,null,0);m.elementType="DELETED",m.stateNode=f,m.return=l,f=l.deletions,f===null?(l.deletions=[m],l.flags|=16):f.push(m)}function YS(l,f){switch(l.tag){case 5:var m=l.type;return f=f.nodeType!==1||m.toLowerCase()!==f.nodeName.toLowerCase()?null:f,f!==null?(l.stateNode=f,aa=l,ia=ks(f.firstChild),!0):!1;case 6:return f=l.pendingProps===""||f.nodeType!==3?null:f,f!==null?(l.stateNode=f,aa=l,ia=null,!0):!1;case 13:return f=f.nodeType!==8?null:f,f!==null?(m=io!==null?{id:Li,overflow:Bi}:null,l.memoizedState={dehydrated:f,treeContext:m,retryLane:1073741824},m=Aa(18,null,null,0),m.stateNode=f,m.return=l,l.child=m,aa=l,ia=null,!0):!1;default:return!1}}function Om(l){return(l.mode&1)!==0&&(l.flags&128)===0}function Nm(l){if(Sr){var f=ia;if(f){var m=f;if(!YS(l,f)){if(Om(l))throw Error(r(418));f=ks(m.nextSibling);var b=aa;f&&YS(l,f)?KS(b,m):(l.flags=l.flags&-4097|2,Sr=!1,aa=l)}}else{if(Om(l))throw Error(r(418));l.flags=l.flags&-4097|2,Sr=!1,aa=l}}}function ZS(l){for(l=l.return;l!==null&&l.tag!==5&&l.tag!==3&&l.tag!==13;)l=l.return;aa=l}function F0(l){if(l!==aa)return!1;if(!Sr)return ZS(l),Sr=!0,!1;var f;if((f=l.tag!==3)&&!(f=l.tag!==5)&&(f=l.type,f=f!=="head"&&f!=="body"&&!bm(l.type,l.memoizedProps)),f&&(f=ia)){if(Om(l))throw QS(),Error(r(418));for(;f;)KS(l,f),f=ks(f.nextSibling)}if(ZS(l),l.tag===13){if(l=l.memoizedState,l=l!==null?l.dehydrated:null,!l)throw Error(r(317));e:{for(l=l.nextSibling,f=0;l;){if(l.nodeType===8){var m=l.data;if(m==="/$"){if(f===0){ia=ks(l.nextSibling);break e}f--}else m!=="$"&&m!=="$!"&&m!=="$?"||f++}l=l.nextSibling}ia=null}}else ia=aa?ks(l.stateNode.nextSibling):null;return!0}function QS(){for(var l=ia;l;)l=ks(l.nextSibling)}function hl(){ia=aa=null,Sr=!1}function Pm(l){Ya===null?Ya=[l]:Ya.push(l)}var Vj=E.ReactCurrentBatchConfig;function Uc(l,f,m){if(l=m.ref,l!==null&&typeof l!="function"&&typeof l!="object"){if(m._owner){if(m=m._owner,m){if(m.tag!==1)throw Error(r(309));var b=m.stateNode}if(!b)throw Error(r(147,l));var A=b,O=""+l;return f!==null&&f.ref!==null&&typeof f.ref=="function"&&f.ref._stringRef===O?f.ref:(f=function(B){var se=A.refs;B===null?delete se[O]:se[O]=B},f._stringRef=O,f)}if(typeof l!="string")throw Error(r(284));if(!m._owner)throw Error(r(290,l))}return l}function D0(l,f){throw l=Object.prototype.toString.call(f),Error(r(31,l==="[object Object]"?"object with keys {"+Object.keys(f).join(", ")+"}":l))}function JS(l){var f=l._init;return f(l._payload)}function ek(l){function f(xe,he){if(l){var ke=xe.deletions;ke===null?(xe.deletions=[he],xe.flags|=16):ke.push(he)}}function m(xe,he){if(!l)return null;for(;he!==null;)f(xe,he),he=he.sibling;return null}function b(xe,he){for(xe=new Map;he!==null;)he.key!==null?xe.set(he.key,he):xe.set(he.index,he),he=he.sibling;return xe}function A(xe,he){return xe=js(xe,he),xe.index=0,xe.sibling=null,xe}function O(xe,he,ke){return xe.index=ke,l?(ke=xe.alternate,ke!==null?(ke=ke.index,ke<he?(xe.flags|=2,he):ke):(xe.flags|=2,he)):(xe.flags|=1048576,he)}function B(xe){return l&&xe.alternate===null&&(xe.flags|=2),xe}function se(xe,he,ke,Ke){return he===null||he.tag!==6?(he=_1(ke,xe.mode,Ke),he.return=xe,he):(he=A(he,ke),he.return=xe,he)}function ue(xe,he,ke,Ke){var vt=ke.type;return vt===C?We(xe,he,ke.props.children,Ke,ke.key):he!==null&&(he.elementType===vt||typeof vt=="object"&&vt!==null&&vt.$$typeof===J&&JS(vt)===he.type)?(Ke=A(he,ke.props),Ke.ref=Uc(xe,he,ke),Ke.return=xe,Ke):(Ke=ad(ke.type,ke.key,ke.props,null,xe.mode,Ke),Ke.ref=Uc(xe,he,ke),Ke.return=xe,Ke)}function Ae(xe,he,ke,Ke){return he===null||he.tag!==4||he.stateNode.containerInfo!==ke.containerInfo||he.stateNode.implementation!==ke.implementation?(he=S1(ke,xe.mode,Ke),he.return=xe,he):(he=A(he,ke.children||[]),he.return=xe,he)}function We(xe,he,ke,Ke,vt){return he===null||he.tag!==7?(he=mo(ke,xe.mode,Ke,vt),he.return=xe,he):(he=A(he,ke),he.return=xe,he)}function qe(xe,he,ke){if(typeof he=="string"&&he!==""||typeof he=="number")return he=_1(""+he,xe.mode,ke),he.return=xe,he;if(typeof he=="object"&&he!==null){switch(he.$$typeof){case T:return ke=ad(he.type,he.key,he.props,null,xe.mode,ke),ke.ref=Uc(xe,null,he),ke.return=xe,ke;case N:return he=S1(he,xe.mode,ke),he.return=xe,he;case J:var Ke=he._init;return qe(xe,Ke(he._payload),ke)}if(xt(he)||oe(he))return he=mo(he,xe.mode,ke,null),he.return=xe,he;D0(xe,he)}return null}function Ue(xe,he,ke,Ke){var vt=he!==null?he.key:null;if(typeof ke=="string"&&ke!==""||typeof ke=="number")return vt!==null?null:se(xe,he,""+ke,Ke);if(typeof ke=="object"&&ke!==null){switch(ke.$$typeof){case T:return ke.key===vt?ue(xe,he,ke,Ke):null;case N:return ke.key===vt?Ae(xe,he,ke,Ke):null;case J:return vt=ke._init,Ue(xe,he,vt(ke._payload),Ke)}if(xt(ke)||oe(ke))return vt!==null?null:We(xe,he,ke,Ke,null);D0(xe,ke)}return null}function it(xe,he,ke,Ke,vt){if(typeof Ke=="string"&&Ke!==""||typeof Ke=="number")return xe=xe.get(ke)||null,se(he,xe,""+Ke,vt);if(typeof Ke=="object"&&Ke!==null){switch(Ke.$$typeof){case T:return xe=xe.get(Ke.key===null?ke:Ke.key)||null,ue(he,xe,Ke,vt);case N:return xe=xe.get(Ke.key===null?ke:Ke.key)||null,Ae(he,xe,Ke,vt);case J:var _t=Ke._init;return it(xe,he,ke,_t(Ke._payload),vt)}if(xt(Ke)||oe(Ke))return xe=xe.get(ke)||null,We(he,xe,Ke,vt,null);D0(he,Ke)}return null}function ft(xe,he,ke,Ke){for(var vt=null,_t=null,St=he,Tt=he=0,on=null;St!==null&&Tt<ke.length;Tt++){St.index>Tt?(on=St,St=null):on=St.sibling;var Zt=Ue(xe,St,ke[Tt],Ke);if(Zt===null){St===null&&(St=on);break}l&&St&&Zt.alternate===null&&f(xe,St),he=O(Zt,he,Tt),_t===null?vt=Zt:_t.sibling=Zt,_t=Zt,St=on}if(Tt===ke.length)return m(xe,St),Sr&&so(xe,Tt),vt;if(St===null){for(;Tt<ke.length;Tt++)St=qe(xe,ke[Tt],Ke),St!==null&&(he=O(St,he,Tt),_t===null?vt=St:_t.sibling=St,_t=St);return Sr&&so(xe,Tt),vt}for(St=b(xe,St);Tt<ke.length;Tt++)on=it(St,xe,Tt,ke[Tt],Ke),on!==null&&(l&&on.alternate!==null&&St.delete(on.key===null?Tt:on.key),he=O(on,he,Tt),_t===null?vt=on:_t.sibling=on,_t=on);return l&&St.forEach(function(Rs){return f(xe,Rs)}),Sr&&so(xe,Tt),vt}function dt(xe,he,ke,Ke){var vt=oe(ke);if(typeof vt!="function")throw Error(r(150));if(ke=vt.call(ke),ke==null)throw Error(r(151));for(var _t=vt=null,St=he,Tt=he=0,on=null,Zt=ke.next();St!==null&&!Zt.done;Tt++,Zt=ke.next()){St.index>Tt?(on=St,St=null):on=St.sibling;var Rs=Ue(xe,St,Zt.value,Ke);if(Rs===null){St===null&&(St=on);break}l&&St&&Rs.alternate===null&&f(xe,St),he=O(Rs,he,Tt),_t===null?vt=Rs:_t.sibling=Rs,_t=Rs,St=on}if(Zt.done)return m(xe,St),Sr&&so(xe,Tt),vt;if(St===null){for(;!Zt.done;Tt++,Zt=ke.next())Zt=qe(xe,Zt.value,Ke),Zt!==null&&(he=O(Zt,he,Tt),_t===null?vt=Zt:_t.sibling=Zt,_t=Zt);return Sr&&so(xe,Tt),vt}for(St=b(xe,St);!Zt.done;Tt++,Zt=ke.next())Zt=it(St,xe,Tt,Zt.value,Ke),Zt!==null&&(l&&Zt.alternate!==null&&St.delete(Zt.key===null?Tt:Zt.key),he=O(Zt,he,Tt),_t===null?vt=Zt:_t.sibling=Zt,_t=Zt);return l&&St.forEach(function(ER){return f(xe,ER)}),Sr&&so(xe,Tt),vt}function Rr(xe,he,ke,Ke){if(typeof ke=="object"&&ke!==null&&ke.type===C&&ke.key===null&&(ke=ke.props.children),typeof ke=="object"&&ke!==null){switch(ke.$$typeof){case T:e:{for(var vt=ke.key,_t=he;_t!==null;){if(_t.key===vt){if(vt=ke.type,vt===C){if(_t.tag===7){m(xe,_t.sibling),he=A(_t,ke.props.children),he.return=xe,xe=he;break e}}else if(_t.elementType===vt||typeof vt=="object"&&vt!==null&&vt.$$typeof===J&&JS(vt)===_t.type){m(xe,_t.sibling),he=A(_t,ke.props),he.ref=Uc(xe,_t,ke),he.return=xe,xe=he;break e}m(xe,_t);break}else f(xe,_t);_t=_t.sibling}ke.type===C?(he=mo(ke.props.children,xe.mode,Ke,ke.key),he.return=xe,xe=he):(Ke=ad(ke.type,ke.key,ke.props,null,xe.mode,Ke),Ke.ref=Uc(xe,he,ke),Ke.return=xe,xe=Ke)}return B(xe);case N:e:{for(_t=ke.key;he!==null;){if(he.key===_t)if(he.tag===4&&he.stateNode.containerInfo===ke.containerInfo&&he.stateNode.implementation===ke.implementation){m(xe,he.sibling),he=A(he,ke.children||[]),he.return=xe,xe=he;break e}else{m(xe,he);break}else f(xe,he);he=he.sibling}he=S1(ke,xe.mode,Ke),he.return=xe,xe=he}return B(xe);case J:return _t=ke._init,Rr(xe,he,_t(ke._payload),Ke)}if(xt(ke))return ft(xe,he,ke,Ke);if(oe(ke))return dt(xe,he,ke,Ke);D0(xe,ke)}return typeof ke=="string"&&ke!==""||typeof ke=="number"?(ke=""+ke,he!==null&&he.tag===6?(m(xe,he.sibling),he=A(he,ke),he.return=xe,xe=he):(m(xe,he),he=_1(ke,xe.mode,Ke),he.return=xe,xe=he),B(xe)):m(xe,he)}return Rr}var pl=ek(!0),tk=ek(!1),j0=Es(null),R0=null,ml=null,Im=null;function Fm(){Im=ml=R0=null}function Dm(l){var f=j0.current;wr(j0),l._currentValue=f}function jm(l,f,m){for(;l!==null;){var b=l.alternate;if((l.childLanes&f)!==f?(l.childLanes|=f,b!==null&&(b.childLanes|=f)):b!==null&&(b.childLanes&f)!==f&&(b.childLanes|=f),l===m)break;l=l.return}}function vl(l,f){R0=l,Im=ml=null,l=l.dependencies,l!==null&&l.firstContext!==null&&((l.lanes&f)!==0&&(Xn=!0),l.firstContext=null)}function ka(l){var f=l._currentValue;if(Im!==l)if(l={context:l,memoizedValue:f,next:null},ml===null){if(R0===null)throw Error(r(308));ml=l,R0.dependencies={lanes:0,firstContext:l}}else ml=ml.next=l;return f}var oo=null;function Rm(l){oo===null?oo=[l]:oo.push(l)}function rk(l,f,m,b){var A=f.interleaved;return A===null?(m.next=m,Rm(f)):(m.next=A.next,A.next=m),f.interleaved=m,$i(l,b)}function $i(l,f){l.lanes|=f;var m=l.alternate;for(m!==null&&(m.lanes|=f),m=l,l=l.return;l!==null;)l.childLanes|=f,m=l.alternate,m!==null&&(m.childLanes|=f),m=l,l=l.return;return m.tag===3?m.stateNode:null}var Cs=!1;function Mm(l){l.updateQueue={baseState:l.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function nk(l,f){l=l.updateQueue,f.updateQueue===l&&(f.updateQueue={baseState:l.baseState,firstBaseUpdate:l.firstBaseUpdate,lastBaseUpdate:l.lastBaseUpdate,shared:l.shared,effects:l.effects})}function Ui(l,f){return{eventTime:l,lane:f,tag:0,payload:null,callback:null,next:null}}function Os(l,f,m){var b=l.updateQueue;if(b===null)return null;if(b=b.shared,(Xt&2)!==0){var A=b.pending;return A===null?f.next=f:(f.next=A.next,A.next=f),b.pending=f,$i(l,m)}return A=b.interleaved,A===null?(f.next=f,Rm(b)):(f.next=A.next,A.next=f),b.interleaved=f,$i(l,m)}function M0(l,f,m){if(f=f.updateQueue,f!==null&&(f=f.shared,(m&4194240)!==0)){var b=f.lanes;b&=l.pendingLanes,m|=b,f.lanes=m,Zp(l,m)}}function ak(l,f){var m=l.updateQueue,b=l.alternate;if(b!==null&&(b=b.updateQueue,m===b)){var A=null,O=null;if(m=m.firstBaseUpdate,m!==null){do{var B={eventTime:m.eventTime,lane:m.lane,tag:m.tag,payload:m.payload,callback:m.callback,next:null};O===null?A=O=B:O=O.next=B,m=m.next}while(m!==null);O===null?A=O=f:O=O.next=f}else A=O=f;m={baseState:b.baseState,firstBaseUpdate:A,lastBaseUpdate:O,shared:b.shared,effects:b.effects},l.updateQueue=m;return}l=m.lastBaseUpdate,l===null?m.firstBaseUpdate=f:l.next=f,m.lastBaseUpdate=f}function L0(l,f,m,b){var A=l.updateQueue;Cs=!1;var O=A.firstBaseUpdate,B=A.lastBaseUpdate,se=A.shared.pending;if(se!==null){A.shared.pending=null;var ue=se,Ae=ue.next;ue.next=null,B===null?O=Ae:B.next=Ae,B=ue;var We=l.alternate;We!==null&&(We=We.updateQueue,se=We.lastBaseUpdate,se!==B&&(se===null?We.firstBaseUpdate=Ae:se.next=Ae,We.lastBaseUpdate=ue))}if(O!==null){var qe=A.baseState;B=0,We=Ae=ue=null,se=O;do{var Ue=se.lane,it=se.eventTime;if((b&Ue)===Ue){We!==null&&(We=We.next={eventTime:it,lane:0,tag:se.tag,payload:se.payload,callback:se.callback,next:null});e:{var ft=l,dt=se;switch(Ue=f,it=m,dt.tag){case 1:if(ft=dt.payload,typeof ft=="function"){qe=ft.call(it,qe,Ue);break e}qe=ft;break e;case 3:ft.flags=ft.flags&-65537|128;case 0:if(ft=dt.payload,Ue=typeof ft=="function"?ft.call(it,qe,Ue):ft,Ue==null)break e;qe=Q({},qe,Ue);break e;case 2:Cs=!0}}se.callback!==null&&se.lane!==0&&(l.flags|=64,Ue=A.effects,Ue===null?A.effects=[se]:Ue.push(se))}else it={eventTime:it,lane:Ue,tag:se.tag,payload:se.payload,callback:se.callback,next:null},We===null?(Ae=We=it,ue=qe):We=We.next=it,B|=Ue;if(se=se.next,se===null){if(se=A.shared.pending,se===null)break;Ue=se,se=Ue.next,Ue.next=null,A.lastBaseUpdate=Ue,A.shared.pending=null}}while(!0);if(We===null&&(ue=qe),A.baseState=ue,A.firstBaseUpdate=Ae,A.lastBaseUpdate=We,f=A.shared.interleaved,f!==null){A=f;do B|=A.lane,A=A.next;while(A!==f)}else O===null&&(A.shared.lanes=0);uo|=B,l.lanes=B,l.memoizedState=qe}}function ik(l,f,m){if(l=f.effects,f.effects=null,l!==null)for(f=0;f<l.length;f++){var b=l[f],A=b.callback;if(A!==null){if(b.callback=null,b=m,typeof A!="function")throw Error(r(191,A));A.call(b)}}}var zc={},mi=Es(zc),Wc=Es(zc),Hc=Es(zc);function lo(l){if(l===zc)throw Error(r(174));return l}function Lm(l,f){switch(vr(Hc,f),vr(Wc,l),vr(mi,zc),l=f.nodeType,l){case 9:case 11:f=(f=f.documentElement)?f.namespaceURI:De(null,"");break;default:l=l===8?f.parentNode:f,f=l.namespaceURI||null,l=l.tagName,f=De(f,l)}wr(mi),vr(mi,f)}function gl(){wr(mi),wr(Wc),wr(Hc)}function sk(l){lo(Hc.current);var f=lo(mi.current),m=De(f,l.type);f!==m&&(vr(Wc,l),vr(mi,m))}function Bm(l){Wc.current===l&&(wr(mi),wr(Wc))}var Ar=Es(0);function B0(l){for(var f=l;f!==null;){if(f.tag===13){var m=f.memoizedState;if(m!==null&&(m=m.dehydrated,m===null||m.data==="$?"||m.data==="$!"))return f}else if(f.tag===19&&f.memoizedProps.revealOrder!==void 0){if((f.flags&128)!==0)return f}else if(f.child!==null){f.child.return=f,f=f.child;continue}if(f===l)break;for(;f.sibling===null;){if(f.return===null||f.return===l)return null;f=f.return}f.sibling.return=f.return,f=f.sibling}return null}var $m=[];function Um(){for(var l=0;l<$m.length;l++)$m[l]._workInProgressVersionPrimary=null;$m.length=0}var $0=E.ReactCurrentDispatcher,zm=E.ReactCurrentBatchConfig,co=0,Cr=null,Xr=null,an=null,U0=!1,qc=!1,Vc=0,Xj=0;function Sn(){throw Error(r(321))}function Wm(l,f){if(f===null)return!1;for(var m=0;m<f.length&&m<l.length;m++)if(!Ka(l[m],f[m]))return!1;return!0}function Hm(l,f,m,b,A,O){if(co=O,Cr=f,f.memoizedState=null,f.updateQueue=null,f.lanes=0,$0.current=l===null||l.memoizedState===null?Zj:Qj,l=m(b,A),qc){O=0;do{if(qc=!1,Vc=0,25<=O)throw Error(r(301));O+=1,an=Xr=null,f.updateQueue=null,$0.current=Jj,l=m(b,A)}while(qc)}if($0.current=H0,f=Xr!==null&&Xr.next!==null,co=0,an=Xr=Cr=null,U0=!1,f)throw Error(r(300));return l}function qm(){var l=Vc!==0;return Vc=0,l}function vi(){var l={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return an===null?Cr.memoizedState=an=l:an=an.next=l,an}function Ea(){if(Xr===null){var l=Cr.alternate;l=l!==null?l.memoizedState:null}else l=Xr.next;var f=an===null?Cr.memoizedState:an.next;if(f!==null)an=f,Xr=l;else{if(l===null)throw Error(r(310));Xr=l,l={memoizedState:Xr.memoizedState,baseState:Xr.baseState,baseQueue:Xr.baseQueue,queue:Xr.queue,next:null},an===null?Cr.memoizedState=an=l:an=an.next=l}return an}function Xc(l,f){return typeof f=="function"?f(l):f}function Vm(l){var f=Ea(),m=f.queue;if(m===null)throw Error(r(311));m.lastRenderedReducer=l;var b=Xr,A=b.baseQueue,O=m.pending;if(O!==null){if(A!==null){var B=A.next;A.next=O.next,O.next=B}b.baseQueue=A=O,m.pending=null}if(A!==null){O=A.next,b=b.baseState;var se=B=null,ue=null,Ae=O;do{var We=Ae.lane;if((co&We)===We)ue!==null&&(ue=ue.next={lane:0,action:Ae.action,hasEagerState:Ae.hasEagerState,eagerState:Ae.eagerState,next:null}),b=Ae.hasEagerState?Ae.eagerState:l(b,Ae.action);else{var qe={lane:We,action:Ae.action,hasEagerState:Ae.hasEagerState,eagerState:Ae.eagerState,next:null};ue===null?(se=ue=qe,B=b):ue=ue.next=qe,Cr.lanes|=We,uo|=We}Ae=Ae.next}while(Ae!==null&&Ae!==O);ue===null?B=b:ue.next=se,Ka(b,f.memoizedState)||(Xn=!0),f.memoizedState=b,f.baseState=B,f.baseQueue=ue,m.lastRenderedState=b}if(l=m.interleaved,l!==null){A=l;do O=A.lane,Cr.lanes|=O,uo|=O,A=A.next;while(A!==l)}else A===null&&(m.lanes=0);return[f.memoizedState,m.dispatch]}function Xm(l){var f=Ea(),m=f.queue;if(m===null)throw Error(r(311));m.lastRenderedReducer=l;var b=m.dispatch,A=m.pending,O=f.memoizedState;if(A!==null){m.pending=null;var B=A=A.next;do O=l(O,B.action),B=B.next;while(B!==A);Ka(O,f.memoizedState)||(Xn=!0),f.memoizedState=O,f.baseQueue===null&&(f.baseState=O),m.lastRenderedState=O}return[O,b]}function ok(){}function lk(l,f){var m=Cr,b=Ea(),A=f(),O=!Ka(b.memoizedState,A);if(O&&(b.memoizedState=A,Xn=!0),b=b.queue,Gm(fk.bind(null,m,b,l),[l]),b.getSnapshot!==f||O||an!==null&&an.memoizedState.tag&1){if(m.flags|=2048,Gc(9,uk.bind(null,m,b,A,f),void 0,null),sn===null)throw Error(r(349));(co&30)!==0||ck(m,f,A)}return A}function ck(l,f,m){l.flags|=16384,l={getSnapshot:f,value:m},f=Cr.updateQueue,f===null?(f={lastEffect:null,stores:null},Cr.updateQueue=f,f.stores=[l]):(m=f.stores,m===null?f.stores=[l]:m.push(l))}function uk(l,f,m,b){f.value=m,f.getSnapshot=b,dk(f)&&hk(l)}function fk(l,f,m){return m(function(){dk(f)&&hk(l)})}function dk(l){var f=l.getSnapshot;l=l.value;try{var m=f();return!Ka(l,m)}catch{return!0}}function hk(l){var f=$i(l,1);f!==null&&ei(f,l,1,-1)}function pk(l){var f=vi();return typeof l=="function"&&(l=l()),f.memoizedState=f.baseState=l,l={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Xc,lastRenderedState:l},f.queue=l,l=l.dispatch=Yj.bind(null,Cr,l),[f.memoizedState,l]}function Gc(l,f,m,b){return l={tag:l,create:f,destroy:m,deps:b,next:null},f=Cr.updateQueue,f===null?(f={lastEffect:null,stores:null},Cr.updateQueue=f,f.lastEffect=l.next=l):(m=f.lastEffect,m===null?f.lastEffect=l.next=l:(b=m.next,m.next=l,l.next=b,f.lastEffect=l)),l}function mk(){return Ea().memoizedState}function z0(l,f,m,b){var A=vi();Cr.flags|=l,A.memoizedState=Gc(1|f,m,void 0,b===void 0?null:b)}function W0(l,f,m,b){var A=Ea();b=b===void 0?null:b;var O=void 0;if(Xr!==null){var B=Xr.memoizedState;if(O=B.destroy,b!==null&&Wm(b,B.deps)){A.memoizedState=Gc(f,m,O,b);return}}Cr.flags|=l,A.memoizedState=Gc(1|f,m,O,b)}function vk(l,f){return z0(8390656,8,l,f)}function Gm(l,f){return W0(2048,8,l,f)}function gk(l,f){return W0(4,2,l,f)}function xk(l,f){return W0(4,4,l,f)}function yk(l,f){if(typeof f=="function")return l=l(),f(l),function(){f(null)};if(f!=null)return l=l(),f.current=l,function(){f.current=null}}function wk(l,f,m){return m=m!=null?m.concat([l]):null,W0(4,4,yk.bind(null,f,l),m)}function Km(){}function bk(l,f){var m=Ea();f=f===void 0?null:f;var b=m.memoizedState;return b!==null&&f!==null&&Wm(f,b[1])?b[0]:(m.memoizedState=[l,f],l)}function _k(l,f){var m=Ea();f=f===void 0?null:f;var b=m.memoizedState;return b!==null&&f!==null&&Wm(f,b[1])?b[0]:(l=l(),m.memoizedState=[l,f],l)}function Sk(l,f,m){return(co&21)===0?(l.baseState&&(l.baseState=!1,Xn=!0),l.memoizedState=m):(Ka(m,f)||(m=J_(),Cr.lanes|=m,uo|=m,l.baseState=!0),f)}function Gj(l,f){var m=lr;lr=m!==0&&4>m?m:4,l(!0);var b=zm.transition;zm.transition={};try{l(!1),f()}finally{lr=m,zm.transition=b}}function kk(){return Ea().memoizedState}function Kj(l,f,m){var b=Fs(l);if(m={lane:b,action:m,hasEagerState:!1,eagerState:null,next:null},Ek(l))Tk(f,m);else if(m=rk(l,f,m,b),m!==null){var A=Bn();ei(m,l,b,A),Ak(m,f,b)}}function Yj(l,f,m){var b=Fs(l),A={lane:b,action:m,hasEagerState:!1,eagerState:null,next:null};if(Ek(l))Tk(f,A);else{var O=l.alternate;if(l.lanes===0&&(O===null||O.lanes===0)&&(O=f.lastRenderedReducer,O!==null))try{var B=f.lastRenderedState,se=O(B,m);if(A.hasEagerState=!0,A.eagerState=se,Ka(se,B)){var ue=f.interleaved;ue===null?(A.next=A,Rm(f)):(A.next=ue.next,ue.next=A),f.interleaved=A;return}}catch{}finally{}m=rk(l,f,A,b),m!==null&&(A=Bn(),ei(m,l,b,A),Ak(m,f,b))}}function Ek(l){var f=l.alternate;return l===Cr||f!==null&&f===Cr}function Tk(l,f){qc=U0=!0;var m=l.pending;m===null?f.next=f:(f.next=m.next,m.next=f),l.pending=f}function Ak(l,f,m){if((m&4194240)!==0){var b=f.lanes;b&=l.pendingLanes,m|=b,f.lanes=m,Zp(l,m)}}var H0={readContext:ka,useCallback:Sn,useContext:Sn,useEffect:Sn,useImperativeHandle:Sn,useInsertionEffect:Sn,useLayoutEffect:Sn,useMemo:Sn,useReducer:Sn,useRef:Sn,useState:Sn,useDebugValue:Sn,useDeferredValue:Sn,useTransition:Sn,useMutableSource:Sn,useSyncExternalStore:Sn,useId:Sn,unstable_isNewReconciler:!1},Zj={readContext:ka,useCallback:function(l,f){return vi().memoizedState=[l,f===void 0?null:f],l},useContext:ka,useEffect:vk,useImperativeHandle:function(l,f,m){return m=m!=null?m.concat([l]):null,z0(4194308,4,yk.bind(null,f,l),m)},useLayoutEffect:function(l,f){return z0(4194308,4,l,f)},useInsertionEffect:function(l,f){return z0(4,2,l,f)},useMemo:function(l,f){var m=vi();return f=f===void 0?null:f,l=l(),m.memoizedState=[l,f],l},useReducer:function(l,f,m){var b=vi();return f=m!==void 0?m(f):f,b.memoizedState=b.baseState=f,l={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:l,lastRenderedState:f},b.queue=l,l=l.dispatch=Kj.bind(null,Cr,l),[b.memoizedState,l]},useRef:function(l){var f=vi();return l={current:l},f.memoizedState=l},useState:pk,useDebugValue:Km,useDeferredValue:function(l){return vi().memoizedState=l},useTransition:function(){var l=pk(!1),f=l[0];return l=Gj.bind(null,l[1]),vi().memoizedState=l,[f,l]},useMutableSource:function(){},useSyncExternalStore:function(l,f,m){var b=Cr,A=vi();if(Sr){if(m===void 0)throw Error(r(407));m=m()}else{if(m=f(),sn===null)throw Error(r(349));(co&30)!==0||ck(b,f,m)}A.memoizedState=m;var O={value:m,getSnapshot:f};return A.queue=O,vk(fk.bind(null,b,O,l),[l]),b.flags|=2048,Gc(9,uk.bind(null,b,O,m,f),void 0,null),m},useId:function(){var l=vi(),f=sn.identifierPrefix;if(Sr){var m=Bi,b=Li;m=(b&~(1<<32-jr(b)-1)).toString(32)+m,f=":"+f+"R"+m,m=Vc++,0<m&&(f+="H"+m.toString(32)),f+=":"}else m=Xj++,f=":"+f+"r"+m.toString(32)+":";return l.memoizedState=f},unstable_isNewReconciler:!1},Qj={readContext:ka,useCallback:bk,useContext:ka,useEffect:Gm,useImperativeHandle:wk,useInsertionEffect:gk,useLayoutEffect:xk,useMemo:_k,useReducer:Vm,useRef:mk,useState:function(){return Vm(Xc)},useDebugValue:Km,useDeferredValue:function(l){var f=Ea();return Sk(f,Xr.memoizedState,l)},useTransition:function(){var l=Vm(Xc)[0],f=Ea().memoizedState;return[l,f]},useMutableSource:ok,useSyncExternalStore:lk,useId:kk,unstable_isNewReconciler:!1},Jj={readContext:ka,useCallback:bk,useContext:ka,useEffect:Gm,useImperativeHandle:wk,useInsertionEffect:gk,useLayoutEffect:xk,useMemo:_k,useReducer:Xm,useRef:mk,useState:function(){return Xm(Xc)},useDebugValue:Km,useDeferredValue:function(l){var f=Ea();return Xr===null?f.memoizedState=l:Sk(f,Xr.memoizedState,l)},useTransition:function(){var l=Xm(Xc)[0],f=Ea().memoizedState;return[l,f]},useMutableSource:ok,useSyncExternalStore:lk,useId:kk,unstable_isNewReconciler:!1};function Za(l,f){if(l&&l.defaultProps){f=Q({},f),l=l.defaultProps;for(var m in l)f[m]===void 0&&(f[m]=l[m]);return f}return f}function Ym(l,f,m,b){f=l.memoizedState,m=m(b,f),m=m==null?f:Q({},f,m),l.memoizedState=m,l.lanes===0&&(l.updateQueue.baseState=m)}var q0={isMounted:function(l){return(l=l._reactInternals)?ae(l)===l:!1},enqueueSetState:function(l,f,m){l=l._reactInternals;var b=Bn(),A=Fs(l),O=Ui(b,A);O.payload=f,m!=null&&(O.callback=m),f=Os(l,O,A),f!==null&&(ei(f,l,A,b),M0(f,l,A))},enqueueReplaceState:function(l,f,m){l=l._reactInternals;var b=Bn(),A=Fs(l),O=Ui(b,A);O.tag=1,O.payload=f,m!=null&&(O.callback=m),f=Os(l,O,A),f!==null&&(ei(f,l,A,b),M0(f,l,A))},enqueueForceUpdate:function(l,f){l=l._reactInternals;var m=Bn(),b=Fs(l),A=Ui(m,b);A.tag=2,f!=null&&(A.callback=f),f=Os(l,A,b),f!==null&&(ei(f,l,b,m),M0(f,l,b))}};function Ck(l,f,m,b,A,O,B){return l=l.stateNode,typeof l.shouldComponentUpdate=="function"?l.shouldComponentUpdate(b,O,B):f.prototype&&f.prototype.isPureReactComponent?!Dc(m,b)||!Dc(A,O):!0}function Ok(l,f,m){var b=!1,A=Ts,O=f.contextType;return typeof O=="object"&&O!==null?O=ka(O):(A=Vn(f)?ao:_n.current,b=f.contextTypes,O=(b=b!=null)?ul(l,A):Ts),f=new f(m,O),l.memoizedState=f.state!==null&&f.state!==void 0?f.state:null,f.updater=q0,l.stateNode=f,f._reactInternals=l,b&&(l=l.stateNode,l.__reactInternalMemoizedUnmaskedChildContext=A,l.__reactInternalMemoizedMaskedChildContext=O),f}function Nk(l,f,m,b){l=f.state,typeof f.componentWillReceiveProps=="function"&&f.componentWillReceiveProps(m,b),typeof f.UNSAFE_componentWillReceiveProps=="function"&&f.UNSAFE_componentWillReceiveProps(m,b),f.state!==l&&q0.enqueueReplaceState(f,f.state,null)}function Zm(l,f,m,b){var A=l.stateNode;A.props=m,A.state=l.memoizedState,A.refs={},Mm(l);var O=f.contextType;typeof O=="object"&&O!==null?A.context=ka(O):(O=Vn(f)?ao:_n.current,A.context=ul(l,O)),A.state=l.memoizedState,O=f.getDerivedStateFromProps,typeof O=="function"&&(Ym(l,f,O,m),A.state=l.memoizedState),typeof f.getDerivedStateFromProps=="function"||typeof A.getSnapshotBeforeUpdate=="function"||typeof A.UNSAFE_componentWillMount!="function"&&typeof A.componentWillMount!="function"||(f=A.state,typeof A.componentWillMount=="function"&&A.componentWillMount(),typeof A.UNSAFE_componentWillMount=="function"&&A.UNSAFE_componentWillMount(),f!==A.state&&q0.enqueueReplaceState(A,A.state,null),L0(l,m,A,b),A.state=l.memoizedState),typeof A.componentDidMount=="function"&&(l.flags|=4194308)}function xl(l,f){try{var m="",b=f;do m+=Te(b),b=b.return;while(b);var A=m}catch(O){A=`
Error generating stack: `+O.message+`
`+O.stack}return{value:l,source:f,stack:A,digest:null}}function Qm(l,f,m){return{value:l,source:null,stack:m??null,digest:f??null}}function Jm(l,f){try{console.error(f.value)}catch(m){setTimeout(function(){throw m})}}var eR=typeof WeakMap=="function"?WeakMap:Map;function Pk(l,f,m){m=Ui(-1,m),m.tag=3,m.payload={element:null};var b=f.value;return m.callback=function(){Q0||(Q0=!0,p1=b),Jm(l,f)},m}function Ik(l,f,m){m=Ui(-1,m),m.tag=3;var b=l.type.getDerivedStateFromError;if(typeof b=="function"){var A=f.value;m.payload=function(){return b(A)},m.callback=function(){Jm(l,f)}}var O=l.stateNode;return O!==null&&typeof O.componentDidCatch=="function"&&(m.callback=function(){Jm(l,f),typeof b!="function"&&(Ps===null?Ps=new Set([this]):Ps.add(this));var B=f.stack;this.componentDidCatch(f.value,{componentStack:B!==null?B:""})}),m}function Fk(l,f,m){var b=l.pingCache;if(b===null){b=l.pingCache=new eR;var A=new Set;b.set(f,A)}else A=b.get(f),A===void 0&&(A=new Set,b.set(f,A));A.has(m)||(A.add(m),l=pR.bind(null,l,f,m),f.then(l,l))}function Dk(l){do{var f;if((f=l.tag===13)&&(f=l.memoizedState,f=f!==null?f.dehydrated!==null:!0),f)return l;l=l.return}while(l!==null);return null}function jk(l,f,m,b,A){return(l.mode&1)===0?(l===f?l.flags|=65536:(l.flags|=128,m.flags|=131072,m.flags&=-52805,m.tag===1&&(m.alternate===null?m.tag=17:(f=Ui(-1,1),f.tag=2,Os(m,f,1))),m.lanes|=1),l):(l.flags|=65536,l.lanes=A,l)}var tR=E.ReactCurrentOwner,Xn=!1;function Ln(l,f,m,b){f.child=l===null?tk(f,null,m,b):pl(f,l.child,m,b)}function Rk(l,f,m,b,A){m=m.render;var O=f.ref;return vl(f,A),b=Hm(l,f,m,b,O,A),m=qm(),l!==null&&!Xn?(f.updateQueue=l.updateQueue,f.flags&=-2053,l.lanes&=~A,zi(l,f,A)):(Sr&&m&&Am(f),f.flags|=1,Ln(l,f,b,A),f.child)}function Mk(l,f,m,b,A){if(l===null){var O=m.type;return typeof O=="function"&&!b1(O)&&O.defaultProps===void 0&&m.compare===null&&m.defaultProps===void 0?(f.tag=15,f.type=O,Lk(l,f,O,b,A)):(l=ad(m.type,null,b,f,f.mode,A),l.ref=f.ref,l.return=f,f.child=l)}if(O=l.child,(l.lanes&A)===0){var B=O.memoizedProps;if(m=m.compare,m=m!==null?m:Dc,m(B,b)&&l.ref===f.ref)return zi(l,f,A)}return f.flags|=1,l=js(O,b),l.ref=f.ref,l.return=f,f.child=l}function Lk(l,f,m,b,A){if(l!==null){var O=l.memoizedProps;if(Dc(O,b)&&l.ref===f.ref)if(Xn=!1,f.pendingProps=b=O,(l.lanes&A)!==0)(l.flags&131072)!==0&&(Xn=!0);else return f.lanes=l.lanes,zi(l,f,A)}return e1(l,f,m,b,A)}function Bk(l,f,m){var b=f.pendingProps,A=b.children,O=l!==null?l.memoizedState:null;if(b.mode==="hidden")if((f.mode&1)===0)f.memoizedState={baseLanes:0,cachePool:null,transitions:null},vr(wl,sa),sa|=m;else{if((m&1073741824)===0)return l=O!==null?O.baseLanes|m:m,f.lanes=f.childLanes=1073741824,f.memoizedState={baseLanes:l,cachePool:null,transitions:null},f.updateQueue=null,vr(wl,sa),sa|=l,null;f.memoizedState={baseLanes:0,cachePool:null,transitions:null},b=O!==null?O.baseLanes:m,vr(wl,sa),sa|=b}else O!==null?(b=O.baseLanes|m,f.memoizedState=null):b=m,vr(wl,sa),sa|=b;return Ln(l,f,A,m),f.child}function $k(l,f){var m=f.ref;(l===null&&m!==null||l!==null&&l.ref!==m)&&(f.flags|=512,f.flags|=2097152)}function e1(l,f,m,b,A){var O=Vn(m)?ao:_n.current;return O=ul(f,O),vl(f,A),m=Hm(l,f,m,b,O,A),b=qm(),l!==null&&!Xn?(f.updateQueue=l.updateQueue,f.flags&=-2053,l.lanes&=~A,zi(l,f,A)):(Sr&&b&&Am(f),f.flags|=1,Ln(l,f,m,A),f.child)}function Uk(l,f,m,b,A){if(Vn(m)){var O=!0;O0(f)}else O=!1;if(vl(f,A),f.stateNode===null)X0(l,f),Ok(f,m,b),Zm(f,m,b,A),b=!0;else if(l===null){var B=f.stateNode,se=f.memoizedProps;B.props=se;var ue=B.context,Ae=m.contextType;typeof Ae=="object"&&Ae!==null?Ae=ka(Ae):(Ae=Vn(m)?ao:_n.current,Ae=ul(f,Ae));var We=m.getDerivedStateFromProps,qe=typeof We=="function"||typeof B.getSnapshotBeforeUpdate=="function";qe||typeof B.UNSAFE_componentWillReceiveProps!="function"&&typeof B.componentWillReceiveProps!="function"||(se!==b||ue!==Ae)&&Nk(f,B,b,Ae),Cs=!1;var Ue=f.memoizedState;B.state=Ue,L0(f,b,B,A),ue=f.memoizedState,se!==b||Ue!==ue||qn.current||Cs?(typeof We=="function"&&(Ym(f,m,We,b),ue=f.memoizedState),(se=Cs||Ck(f,m,se,b,Ue,ue,Ae))?(qe||typeof B.UNSAFE_componentWillMount!="function"&&typeof B.componentWillMount!="function"||(typeof B.componentWillMount=="function"&&B.componentWillMount(),typeof B.UNSAFE_componentWillMount=="function"&&B.UNSAFE_componentWillMount()),typeof B.componentDidMount=="function"&&(f.flags|=4194308)):(typeof B.componentDidMount=="function"&&(f.flags|=4194308),f.memoizedProps=b,f.memoizedState=ue),B.props=b,B.state=ue,B.context=Ae,b=se):(typeof B.componentDidMount=="function"&&(f.flags|=4194308),b=!1)}else{B=f.stateNode,nk(l,f),se=f.memoizedProps,Ae=f.type===f.elementType?se:Za(f.type,se),B.props=Ae,qe=f.pendingProps,Ue=B.context,ue=m.contextType,typeof ue=="object"&&ue!==null?ue=ka(ue):(ue=Vn(m)?ao:_n.current,ue=ul(f,ue));var it=m.getDerivedStateFromProps;(We=typeof it=="function"||typeof B.getSnapshotBeforeUpdate=="function")||typeof B.UNSAFE_componentWillReceiveProps!="function"&&typeof B.componentWillReceiveProps!="function"||(se!==qe||Ue!==ue)&&Nk(f,B,b,ue),Cs=!1,Ue=f.memoizedState,B.state=Ue,L0(f,b,B,A);var ft=f.memoizedState;se!==qe||Ue!==ft||qn.current||Cs?(typeof it=="function"&&(Ym(f,m,it,b),ft=f.memoizedState),(Ae=Cs||Ck(f,m,Ae,b,Ue,ft,ue)||!1)?(We||typeof B.UNSAFE_componentWillUpdate!="function"&&typeof B.componentWillUpdate!="function"||(typeof B.componentWillUpdate=="function"&&B.componentWillUpdate(b,ft,ue),typeof B.UNSAFE_componentWillUpdate=="function"&&B.UNSAFE_componentWillUpdate(b,ft,ue)),typeof B.componentDidUpdate=="function"&&(f.flags|=4),typeof B.getSnapshotBeforeUpdate=="function"&&(f.flags|=1024)):(typeof B.componentDidUpdate!="function"||se===l.memoizedProps&&Ue===l.memoizedState||(f.flags|=4),typeof B.getSnapshotBeforeUpdate!="function"||se===l.memoizedProps&&Ue===l.memoizedState||(f.flags|=1024),f.memoizedProps=b,f.memoizedState=ft),B.props=b,B.state=ft,B.context=ue,b=Ae):(typeof B.componentDidUpdate!="function"||se===l.memoizedProps&&Ue===l.memoizedState||(f.flags|=4),typeof B.getSnapshotBeforeUpdate!="function"||se===l.memoizedProps&&Ue===l.memoizedState||(f.flags|=1024),b=!1)}return t1(l,f,m,b,O,A)}function t1(l,f,m,b,A,O){$k(l,f);var B=(f.flags&128)!==0;if(!b&&!B)return A&&VS(f,m,!1),zi(l,f,O);b=f.stateNode,tR.current=f;var se=B&&typeof m.getDerivedStateFromError!="function"?null:b.render();return f.flags|=1,l!==null&&B?(f.child=pl(f,l.child,null,O),f.child=pl(f,null,se,O)):Ln(l,f,se,O),f.memoizedState=b.state,A&&VS(f,m,!0),f.child}function zk(l){var f=l.stateNode;f.pendingContext?HS(l,f.pendingContext,f.pendingContext!==f.context):f.context&&HS(l,f.context,!1),Lm(l,f.containerInfo)}function Wk(l,f,m,b,A){return hl(),Pm(A),f.flags|=256,Ln(l,f,m,b),f.child}var r1={dehydrated:null,treeContext:null,retryLane:0};function n1(l){return{baseLanes:l,cachePool:null,transitions:null}}function Hk(l,f,m){var b=f.pendingProps,A=Ar.current,O=!1,B=(f.flags&128)!==0,se;if((se=B)||(se=l!==null&&l.memoizedState===null?!1:(A&2)!==0),se?(O=!0,f.flags&=-129):(l===null||l.memoizedState!==null)&&(A|=1),vr(Ar,A&1),l===null)return Nm(f),l=f.memoizedState,l!==null&&(l=l.dehydrated,l!==null)?((f.mode&1)===0?f.lanes=1:l.data==="$!"?f.lanes=8:f.lanes=1073741824,null):(B=b.children,l=b.fallback,O?(b=f.mode,O=f.child,B={mode:"hidden",children:B},(b&1)===0&&O!==null?(O.childLanes=0,O.pendingProps=B):O=id(B,b,0,null),l=mo(l,b,m,null),O.return=f,l.return=f,O.sibling=l,f.child=O,f.child.memoizedState=n1(m),f.memoizedState=r1,l):a1(f,B));if(A=l.memoizedState,A!==null&&(se=A.dehydrated,se!==null))return rR(l,f,B,b,se,A,m);if(O){O=b.fallback,B=f.mode,A=l.child,se=A.sibling;var ue={mode:"hidden",children:b.children};return(B&1)===0&&f.child!==A?(b=f.child,b.childLanes=0,b.pendingProps=ue,f.deletions=null):(b=js(A,ue),b.subtreeFlags=A.subtreeFlags&14680064),se!==null?O=js(se,O):(O=mo(O,B,m,null),O.flags|=2),O.return=f,b.return=f,b.sibling=O,f.child=b,b=O,O=f.child,B=l.child.memoizedState,B=B===null?n1(m):{baseLanes:B.baseLanes|m,cachePool:null,transitions:B.transitions},O.memoizedState=B,O.childLanes=l.childLanes&~m,f.memoizedState=r1,b}return O=l.child,l=O.sibling,b=js(O,{mode:"visible",children:b.children}),(f.mode&1)===0&&(b.lanes=m),b.return=f,b.sibling=null,l!==null&&(m=f.deletions,m===null?(f.deletions=[l],f.flags|=16):m.push(l)),f.child=b,f.memoizedState=null,b}function a1(l,f){return f=id({mode:"visible",children:f},l.mode,0,null),f.return=l,l.child=f}function V0(l,f,m,b){return b!==null&&Pm(b),pl(f,l.child,null,m),l=a1(f,f.pendingProps.children),l.flags|=2,f.memoizedState=null,l}function rR(l,f,m,b,A,O,B){if(m)return f.flags&256?(f.flags&=-257,b=Qm(Error(r(422))),V0(l,f,B,b)):f.memoizedState!==null?(f.child=l.child,f.flags|=128,null):(O=b.fallback,A=f.mode,b=id({mode:"visible",children:b.children},A,0,null),O=mo(O,A,B,null),O.flags|=2,b.return=f,O.return=f,b.sibling=O,f.child=b,(f.mode&1)!==0&&pl(f,l.child,null,B),f.child.memoizedState=n1(B),f.memoizedState=r1,O);if((f.mode&1)===0)return V0(l,f,B,null);if(A.data==="$!"){if(b=A.nextSibling&&A.nextSibling.dataset,b)var se=b.dgst;return b=se,O=Error(r(419)),b=Qm(O,b,void 0),V0(l,f,B,b)}if(se=(B&l.childLanes)!==0,Xn||se){if(b=sn,b!==null){switch(B&-B){case 4:A=2;break;case 16:A=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:A=32;break;case 536870912:A=268435456;break;default:A=0}A=(A&(b.suspendedLanes|B))!==0?0:A,A!==0&&A!==O.retryLane&&(O.retryLane=A,$i(l,A),ei(b,l,A,-1))}return w1(),b=Qm(Error(r(421))),V0(l,f,B,b)}return A.data==="$?"?(f.flags|=128,f.child=l.child,f=mR.bind(null,l),A._reactRetry=f,null):(l=O.treeContext,ia=ks(A.nextSibling),aa=f,Sr=!0,Ya=null,l!==null&&(_a[Sa++]=Li,_a[Sa++]=Bi,_a[Sa++]=io,Li=l.id,Bi=l.overflow,io=f),f=a1(f,b.children),f.flags|=4096,f)}function qk(l,f,m){l.lanes|=f;var b=l.alternate;b!==null&&(b.lanes|=f),jm(l.return,f,m)}function i1(l,f,m,b,A){var O=l.memoizedState;O===null?l.memoizedState={isBackwards:f,rendering:null,renderingStartTime:0,last:b,tail:m,tailMode:A}:(O.isBackwards=f,O.rendering=null,O.renderingStartTime=0,O.last=b,O.tail=m,O.tailMode=A)}function Vk(l,f,m){var b=f.pendingProps,A=b.revealOrder,O=b.tail;if(Ln(l,f,b.children,m),b=Ar.current,(b&2)!==0)b=b&1|2,f.flags|=128;else{if(l!==null&&(l.flags&128)!==0)e:for(l=f.child;l!==null;){if(l.tag===13)l.memoizedState!==null&&qk(l,m,f);else if(l.tag===19)qk(l,m,f);else if(l.child!==null){l.child.return=l,l=l.child;continue}if(l===f)break e;for(;l.sibling===null;){if(l.return===null||l.return===f)break e;l=l.return}l.sibling.return=l.return,l=l.sibling}b&=1}if(vr(Ar,b),(f.mode&1)===0)f.memoizedState=null;else switch(A){case"forwards":for(m=f.child,A=null;m!==null;)l=m.alternate,l!==null&&B0(l)===null&&(A=m),m=m.sibling;m=A,m===null?(A=f.child,f.child=null):(A=m.sibling,m.sibling=null),i1(f,!1,A,m,O);break;case"backwards":for(m=null,A=f.child,f.child=null;A!==null;){if(l=A.alternate,l!==null&&B0(l)===null){f.child=A;break}l=A.sibling,A.sibling=m,m=A,A=l}i1(f,!0,m,null,O);break;case"together":i1(f,!1,null,null,void 0);break;default:f.memoizedState=null}return f.child}function X0(l,f){(f.mode&1)===0&&l!==null&&(l.alternate=null,f.alternate=null,f.flags|=2)}function zi(l,f,m){if(l!==null&&(f.dependencies=l.dependencies),uo|=f.lanes,(m&f.childLanes)===0)return null;if(l!==null&&f.child!==l.child)throw Error(r(153));if(f.child!==null){for(l=f.child,m=js(l,l.pendingProps),f.child=m,m.return=f;l.sibling!==null;)l=l.sibling,m=m.sibling=js(l,l.pendingProps),m.return=f;m.sibling=null}return f.child}function nR(l,f,m){switch(f.tag){case 3:zk(f),hl();break;case 5:sk(f);break;case 1:Vn(f.type)&&O0(f);break;case 4:Lm(f,f.stateNode.containerInfo);break;case 10:var b=f.type._context,A=f.memoizedProps.value;vr(j0,b._currentValue),b._currentValue=A;break;case 13:if(b=f.memoizedState,b!==null)return b.dehydrated!==null?(vr(Ar,Ar.current&1),f.flags|=128,null):(m&f.child.childLanes)!==0?Hk(l,f,m):(vr(Ar,Ar.current&1),l=zi(l,f,m),l!==null?l.sibling:null);vr(Ar,Ar.current&1);break;case 19:if(b=(m&f.childLanes)!==0,(l.flags&128)!==0){if(b)return Vk(l,f,m);f.flags|=128}if(A=f.memoizedState,A!==null&&(A.rendering=null,A.tail=null,A.lastEffect=null),vr(Ar,Ar.current),b)break;return null;case 22:case 23:return f.lanes=0,Bk(l,f,m)}return zi(l,f,m)}var Xk,s1,Gk,Kk;Xk=function(l,f){for(var m=f.child;m!==null;){if(m.tag===5||m.tag===6)l.appendChild(m.stateNode);else if(m.tag!==4&&m.child!==null){m.child.return=m,m=m.child;continue}if(m===f)break;for(;m.sibling===null;){if(m.return===null||m.return===f)return;m=m.return}m.sibling.return=m.return,m=m.sibling}},s1=function(){},Gk=function(l,f,m,b){var A=l.memoizedProps;if(A!==b){l=f.stateNode,lo(mi.current);var O=null;switch(m){case"input":A=le(l,A),b=le(l,b),O=[];break;case"select":A=Q({},A,{value:void 0}),b=Q({},b,{value:void 0}),O=[];break;case"textarea":A=Ee(l,A),b=Ee(l,b),O=[];break;default:typeof A.onClick!="function"&&typeof b.onClick=="function"&&(l.onclick=T0)}Mn(m,b);var B;m=null;for(Ae in A)if(!b.hasOwnProperty(Ae)&&A.hasOwnProperty(Ae)&&A[Ae]!=null)if(Ae==="style"){var se=A[Ae];for(B in se)se.hasOwnProperty(B)&&(m||(m={}),m[B]="")}else Ae!=="dangerouslySetInnerHTML"&&Ae!=="children"&&Ae!=="suppressContentEditableWarning"&&Ae!=="suppressHydrationWarning"&&Ae!=="autoFocus"&&(a.hasOwnProperty(Ae)?O||(O=[]):(O=O||[]).push(Ae,null));for(Ae in b){var ue=b[Ae];if(se=A!=null?A[Ae]:void 0,b.hasOwnProperty(Ae)&&ue!==se&&(ue!=null||se!=null))if(Ae==="style")if(se){for(B in se)!se.hasOwnProperty(B)||ue&&ue.hasOwnProperty(B)||(m||(m={}),m[B]="");for(B in ue)ue.hasOwnProperty(B)&&se[B]!==ue[B]&&(m||(m={}),m[B]=ue[B])}else m||(O||(O=[]),O.push(Ae,m)),m=ue;else Ae==="dangerouslySetInnerHTML"?(ue=ue?ue.__html:void 0,se=se?se.__html:void 0,ue!=null&&se!==ue&&(O=O||[]).push(Ae,ue)):Ae==="children"?typeof ue!="string"&&typeof ue!="number"||(O=O||[]).push(Ae,""+ue):Ae!=="suppressContentEditableWarning"&&Ae!=="suppressHydrationWarning"&&(a.hasOwnProperty(Ae)?(ue!=null&&Ae==="onScroll"&&yr("scroll",l),O||se===ue||(O=[])):(O=O||[]).push(Ae,ue))}m&&(O=O||[]).push("style",m);var Ae=O;(f.updateQueue=Ae)&&(f.flags|=4)}},Kk=function(l,f,m,b){m!==b&&(f.flags|=4)};function Kc(l,f){if(!Sr)switch(l.tailMode){case"hidden":f=l.tail;for(var m=null;f!==null;)f.alternate!==null&&(m=f),f=f.sibling;m===null?l.tail=null:m.sibling=null;break;case"collapsed":m=l.tail;for(var b=null;m!==null;)m.alternate!==null&&(b=m),m=m.sibling;b===null?f||l.tail===null?l.tail=null:l.tail.sibling=null:b.sibling=null}}function kn(l){var f=l.alternate!==null&&l.alternate.child===l.child,m=0,b=0;if(f)for(var A=l.child;A!==null;)m|=A.lanes|A.childLanes,b|=A.subtreeFlags&14680064,b|=A.flags&14680064,A.return=l,A=A.sibling;else for(A=l.child;A!==null;)m|=A.lanes|A.childLanes,b|=A.subtreeFlags,b|=A.flags,A.return=l,A=A.sibling;return l.subtreeFlags|=b,l.childLanes=m,f}function aR(l,f,m){var b=f.pendingProps;switch(Cm(f),f.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return kn(f),null;case 1:return Vn(f.type)&&C0(),kn(f),null;case 3:return b=f.stateNode,gl(),wr(qn),wr(_n),Um(),b.pendingContext&&(b.context=b.pendingContext,b.pendingContext=null),(l===null||l.child===null)&&(F0(f)?f.flags|=4:l===null||l.memoizedState.isDehydrated&&(f.flags&256)===0||(f.flags|=1024,Ya!==null&&(g1(Ya),Ya=null))),s1(l,f),kn(f),null;case 5:Bm(f);var A=lo(Hc.current);if(m=f.type,l!==null&&f.stateNode!=null)Gk(l,f,m,b,A),l.ref!==f.ref&&(f.flags|=512,f.flags|=2097152);else{if(!b){if(f.stateNode===null)throw Error(r(166));return kn(f),null}if(l=lo(mi.current),F0(f)){b=f.stateNode,m=f.type;var O=f.memoizedProps;switch(b[pi]=f,b[Bc]=O,l=(f.mode&1)!==0,m){case"dialog":yr("cancel",b),yr("close",b);break;case"iframe":case"object":case"embed":yr("load",b);break;case"video":case"audio":for(A=0;A<Rc.length;A++)yr(Rc[A],b);break;case"source":yr("error",b);break;case"img":case"image":case"link":yr("error",b),yr("load",b);break;case"details":yr("toggle",b);break;case"input":ye(b,O),yr("invalid",b);break;case"select":b._wrapperState={wasMultiple:!!O.multiple},yr("invalid",b);break;case"textarea":ve(b,O),yr("invalid",b)}Mn(m,O),A=null;for(var B in O)if(O.hasOwnProperty(B)){var se=O[B];B==="children"?typeof se=="string"?b.textContent!==se&&(O.suppressHydrationWarning!==!0&&E0(b.textContent,se,l),A=["children",se]):typeof se=="number"&&b.textContent!==""+se&&(O.suppressHydrationWarning!==!0&&E0(b.textContent,se,l),A=["children",""+se]):a.hasOwnProperty(B)&&se!=null&&B==="onScroll"&&yr("scroll",b)}switch(m){case"input":X(b),Ze(b,O,!0);break;case"textarea":X(b),pe(b);break;case"select":case"option":break;default:typeof O.onClick=="function"&&(b.onclick=T0)}b=A,f.updateQueue=b,b!==null&&(f.flags|=4)}else{B=A.nodeType===9?A:A.ownerDocument,l==="http://www.w3.org/1999/xhtml"&&(l=nt(m)),l==="http://www.w3.org/1999/xhtml"?m==="script"?(l=B.createElement("div"),l.innerHTML="<script><\/script>",l=l.removeChild(l.firstChild)):typeof b.is=="string"?l=B.createElement(m,{is:b.is}):(l=B.createElement(m),m==="select"&&(B=l,b.multiple?B.multiple=!0:b.size&&(B.size=b.size))):l=B.createElementNS(l,m),l[pi]=f,l[Bc]=b,Xk(l,f,!1,!1),f.stateNode=l;e:{switch(B=va(m,b),m){case"dialog":yr("cancel",l),yr("close",l),A=b;break;case"iframe":case"object":case"embed":yr("load",l),A=b;break;case"video":case"audio":for(A=0;A<Rc.length;A++)yr(Rc[A],l);A=b;break;case"source":yr("error",l),A=b;break;case"img":case"image":case"link":yr("error",l),yr("load",l),A=b;break;case"details":yr("toggle",l),A=b;break;case"input":ye(l,b),A=le(l,b),yr("invalid",l);break;case"option":A=b;break;case"select":l._wrapperState={wasMultiple:!!b.multiple},A=Q({},b,{value:void 0}),yr("invalid",l);break;case"textarea":ve(l,b),A=Ee(l,b),yr("invalid",l);break;default:A=b}Mn(m,A),se=A;for(O in se)if(se.hasOwnProperty(O)){var ue=se[O];O==="style"?Yt(l,ue):O==="dangerouslySetInnerHTML"?(ue=ue?ue.__html:void 0,ue!=null&&Qe(l,ue)):O==="children"?typeof ue=="string"?(m!=="textarea"||ue!=="")&&kt(l,ue):typeof ue=="number"&&kt(l,""+ue):O!=="suppressContentEditableWarning"&&O!=="suppressHydrationWarning"&&O!=="autoFocus"&&(a.hasOwnProperty(O)?ue!=null&&O==="onScroll"&&yr("scroll",l):ue!=null&&k(l,O,ue,B))}switch(m){case"input":X(l),Ze(l,b,!1);break;case"textarea":X(l),pe(l);break;case"option":b.value!=null&&l.setAttribute("value",""+W(b.value));break;case"select":l.multiple=!!b.multiple,O=b.value,O!=null?mt(l,!!b.multiple,O,!1):b.defaultValue!=null&&mt(l,!!b.multiple,b.defaultValue,!0);break;default:typeof A.onClick=="function"&&(l.onclick=T0)}switch(m){case"button":case"input":case"select":case"textarea":b=!!b.autoFocus;break e;case"img":b=!0;break e;default:b=!1}}b&&(f.flags|=4)}f.ref!==null&&(f.flags|=512,f.flags|=2097152)}return kn(f),null;case 6:if(l&&f.stateNode!=null)Kk(l,f,l.memoizedProps,b);else{if(typeof b!="string"&&f.stateNode===null)throw Error(r(166));if(m=lo(Hc.current),lo(mi.current),F0(f)){if(b=f.stateNode,m=f.memoizedProps,b[pi]=f,(O=b.nodeValue!==m)&&(l=aa,l!==null))switch(l.tag){case 3:E0(b.nodeValue,m,(l.mode&1)!==0);break;case 5:l.memoizedProps.suppressHydrationWarning!==!0&&E0(b.nodeValue,m,(l.mode&1)!==0)}O&&(f.flags|=4)}else b=(m.nodeType===9?m:m.ownerDocument).createTextNode(b),b[pi]=f,f.stateNode=b}return kn(f),null;case 13:if(wr(Ar),b=f.memoizedState,l===null||l.memoizedState!==null&&l.memoizedState.dehydrated!==null){if(Sr&&ia!==null&&(f.mode&1)!==0&&(f.flags&128)===0)QS(),hl(),f.flags|=98560,O=!1;else if(O=F0(f),b!==null&&b.dehydrated!==null){if(l===null){if(!O)throw Error(r(318));if(O=f.memoizedState,O=O!==null?O.dehydrated:null,!O)throw Error(r(317));O[pi]=f}else hl(),(f.flags&128)===0&&(f.memoizedState=null),f.flags|=4;kn(f),O=!1}else Ya!==null&&(g1(Ya),Ya=null),O=!0;if(!O)return f.flags&65536?f:null}return(f.flags&128)!==0?(f.lanes=m,f):(b=b!==null,b!==(l!==null&&l.memoizedState!==null)&&b&&(f.child.flags|=8192,(f.mode&1)!==0&&(l===null||(Ar.current&1)!==0?Gr===0&&(Gr=3):w1())),f.updateQueue!==null&&(f.flags|=4),kn(f),null);case 4:return gl(),s1(l,f),l===null&&Mc(f.stateNode.containerInfo),kn(f),null;case 10:return Dm(f.type._context),kn(f),null;case 17:return Vn(f.type)&&C0(),kn(f),null;case 19:if(wr(Ar),O=f.memoizedState,O===null)return kn(f),null;if(b=(f.flags&128)!==0,B=O.rendering,B===null)if(b)Kc(O,!1);else{if(Gr!==0||l!==null&&(l.flags&128)!==0)for(l=f.child;l!==null;){if(B=B0(l),B!==null){for(f.flags|=128,Kc(O,!1),b=B.updateQueue,b!==null&&(f.updateQueue=b,f.flags|=4),f.subtreeFlags=0,b=m,m=f.child;m!==null;)O=m,l=b,O.flags&=14680066,B=O.alternate,B===null?(O.childLanes=0,O.lanes=l,O.child=null,O.subtreeFlags=0,O.memoizedProps=null,O.memoizedState=null,O.updateQueue=null,O.dependencies=null,O.stateNode=null):(O.childLanes=B.childLanes,O.lanes=B.lanes,O.child=B.child,O.subtreeFlags=0,O.deletions=null,O.memoizedProps=B.memoizedProps,O.memoizedState=B.memoizedState,O.updateQueue=B.updateQueue,O.type=B.type,l=B.dependencies,O.dependencies=l===null?null:{lanes:l.lanes,firstContext:l.firstContext}),m=m.sibling;return vr(Ar,Ar.current&1|2),f.child}l=l.sibling}O.tail!==null&&$e()>bl&&(f.flags|=128,b=!0,Kc(O,!1),f.lanes=4194304)}else{if(!b)if(l=B0(B),l!==null){if(f.flags|=128,b=!0,m=l.updateQueue,m!==null&&(f.updateQueue=m,f.flags|=4),Kc(O,!0),O.tail===null&&O.tailMode==="hidden"&&!B.alternate&&!Sr)return kn(f),null}else 2*$e()-O.renderingStartTime>bl&&m!==1073741824&&(f.flags|=128,b=!0,Kc(O,!1),f.lanes=4194304);O.isBackwards?(B.sibling=f.child,f.child=B):(m=O.last,m!==null?m.sibling=B:f.child=B,O.last=B)}return O.tail!==null?(f=O.tail,O.rendering=f,O.tail=f.sibling,O.renderingStartTime=$e(),f.sibling=null,m=Ar.current,vr(Ar,b?m&1|2:m&1),f):(kn(f),null);case 22:case 23:return y1(),b=f.memoizedState!==null,l!==null&&l.memoizedState!==null!==b&&(f.flags|=8192),b&&(f.mode&1)!==0?(sa&1073741824)!==0&&(kn(f),f.subtreeFlags&6&&(f.flags|=8192)):kn(f),null;case 24:return null;case 25:return null}throw Error(r(156,f.tag))}function iR(l,f){switch(Cm(f),f.tag){case 1:return Vn(f.type)&&C0(),l=f.flags,l&65536?(f.flags=l&-65537|128,f):null;case 3:return gl(),wr(qn),wr(_n),Um(),l=f.flags,(l&65536)!==0&&(l&128)===0?(f.flags=l&-65537|128,f):null;case 5:return Bm(f),null;case 13:if(wr(Ar),l=f.memoizedState,l!==null&&l.dehydrated!==null){if(f.alternate===null)throw Error(r(340));hl()}return l=f.flags,l&65536?(f.flags=l&-65537|128,f):null;case 19:return wr(Ar),null;case 4:return gl(),null;case 10:return Dm(f.type._context),null;case 22:case 23:return y1(),null;case 24:return null;default:return null}}var G0=!1,En=!1,sR=typeof WeakSet=="function"?WeakSet:Set,ct=null;function yl(l,f){var m=l.ref;if(m!==null)if(typeof m=="function")try{m(null)}catch(b){Pr(l,f,b)}else m.current=null}function o1(l,f,m){try{m()}catch(b){Pr(l,f,b)}}var Yk=!1;function oR(l,f){if(ym=p0,l=CS(),fm(l)){if("selectionStart"in l)var m={start:l.selectionStart,end:l.selectionEnd};else e:{m=(m=l.ownerDocument)&&m.defaultView||window;var b=m.getSelection&&m.getSelection();if(b&&b.rangeCount!==0){m=b.anchorNode;var A=b.anchorOffset,O=b.focusNode;b=b.focusOffset;try{m.nodeType,O.nodeType}catch{m=null;break e}var B=0,se=-1,ue=-1,Ae=0,We=0,qe=l,Ue=null;t:for(;;){for(var it;qe!==m||A!==0&&qe.nodeType!==3||(se=B+A),qe!==O||b!==0&&qe.nodeType!==3||(ue=B+b),qe.nodeType===3&&(B+=qe.nodeValue.length),(it=qe.firstChild)!==null;)Ue=qe,qe=it;for(;;){if(qe===l)break t;if(Ue===m&&++Ae===A&&(se=B),Ue===O&&++We===b&&(ue=B),(it=qe.nextSibling)!==null)break;qe=Ue,Ue=qe.parentNode}qe=it}m=se===-1||ue===-1?null:{start:se,end:ue}}else m=null}m=m||{start:0,end:0}}else m=null;for(wm={focusedElem:l,selectionRange:m},p0=!1,ct=f;ct!==null;)if(f=ct,l=f.child,(f.subtreeFlags&1028)!==0&&l!==null)l.return=f,ct=l;else for(;ct!==null;){f=ct;try{var ft=f.alternate;if((f.flags&1024)!==0)switch(f.tag){case 0:case 11:case 15:break;case 1:if(ft!==null){var dt=ft.memoizedProps,Rr=ft.memoizedState,xe=f.stateNode,he=xe.getSnapshotBeforeUpdate(f.elementType===f.type?dt:Za(f.type,dt),Rr);xe.__reactInternalSnapshotBeforeUpdate=he}break;case 3:var ke=f.stateNode.containerInfo;ke.nodeType===1?ke.textContent="":ke.nodeType===9&&ke.documentElement&&ke.removeChild(ke.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(r(163))}}catch(Ke){Pr(f,f.return,Ke)}if(l=f.sibling,l!==null){l.return=f.return,ct=l;break}ct=f.return}return ft=Yk,Yk=!1,ft}function Yc(l,f,m){var b=f.updateQueue;if(b=b!==null?b.lastEffect:null,b!==null){var A=b=b.next;do{if((A.tag&l)===l){var O=A.destroy;A.destroy=void 0,O!==void 0&&o1(f,m,O)}A=A.next}while(A!==b)}}function K0(l,f){if(f=f.updateQueue,f=f!==null?f.lastEffect:null,f!==null){var m=f=f.next;do{if((m.tag&l)===l){var b=m.create;m.destroy=b()}m=m.next}while(m!==f)}}function l1(l){var f=l.ref;if(f!==null){var m=l.stateNode;switch(l.tag){case 5:l=m;break;default:l=m}typeof f=="function"?f(l):f.current=l}}function Zk(l){var f=l.alternate;f!==null&&(l.alternate=null,Zk(f)),l.child=null,l.deletions=null,l.sibling=null,l.tag===5&&(f=l.stateNode,f!==null&&(delete f[pi],delete f[Bc],delete f[km],delete f[Wj],delete f[Hj])),l.stateNode=null,l.return=null,l.dependencies=null,l.memoizedProps=null,l.memoizedState=null,l.pendingProps=null,l.stateNode=null,l.updateQueue=null}function Qk(l){return l.tag===5||l.tag===3||l.tag===4}function Jk(l){e:for(;;){for(;l.sibling===null;){if(l.return===null||Qk(l.return))return null;l=l.return}for(l.sibling.return=l.return,l=l.sibling;l.tag!==5&&l.tag!==6&&l.tag!==18;){if(l.flags&2||l.child===null||l.tag===4)continue e;l.child.return=l,l=l.child}if(!(l.flags&2))return l.stateNode}}function c1(l,f,m){var b=l.tag;if(b===5||b===6)l=l.stateNode,f?m.nodeType===8?m.parentNode.insertBefore(l,f):m.insertBefore(l,f):(m.nodeType===8?(f=m.parentNode,f.insertBefore(l,m)):(f=m,f.appendChild(l)),m=m._reactRootContainer,m!=null||f.onclick!==null||(f.onclick=T0));else if(b!==4&&(l=l.child,l!==null))for(c1(l,f,m),l=l.sibling;l!==null;)c1(l,f,m),l=l.sibling}function u1(l,f,m){var b=l.tag;if(b===5||b===6)l=l.stateNode,f?m.insertBefore(l,f):m.appendChild(l);else if(b!==4&&(l=l.child,l!==null))for(u1(l,f,m),l=l.sibling;l!==null;)u1(l,f,m),l=l.sibling}var vn=null,Qa=!1;function Ns(l,f,m){for(m=m.child;m!==null;)eE(l,f,m),m=m.sibling}function eE(l,f,m){if(nn&&typeof nn.onCommitFiberUnmount=="function")try{nn.onCommitFiberUnmount(hi,m)}catch{}switch(m.tag){case 5:En||yl(m,f);case 6:var b=vn,A=Qa;vn=null,Ns(l,f,m),vn=b,Qa=A,vn!==null&&(Qa?(l=vn,m=m.stateNode,l.nodeType===8?l.parentNode.removeChild(m):l.removeChild(m)):vn.removeChild(m.stateNode));break;case 18:vn!==null&&(Qa?(l=vn,m=m.stateNode,l.nodeType===8?Sm(l.parentNode,m):l.nodeType===1&&Sm(l,m),Cc(l)):Sm(vn,m.stateNode));break;case 4:b=vn,A=Qa,vn=m.stateNode.containerInfo,Qa=!0,Ns(l,f,m),vn=b,Qa=A;break;case 0:case 11:case 14:case 15:if(!En&&(b=m.updateQueue,b!==null&&(b=b.lastEffect,b!==null))){A=b=b.next;do{var O=A,B=O.destroy;O=O.tag,B!==void 0&&((O&2)!==0||(O&4)!==0)&&o1(m,f,B),A=A.next}while(A!==b)}Ns(l,f,m);break;case 1:if(!En&&(yl(m,f),b=m.stateNode,typeof b.componentWillUnmount=="function"))try{b.props=m.memoizedProps,b.state=m.memoizedState,b.componentWillUnmount()}catch(se){Pr(m,f,se)}Ns(l,f,m);break;case 21:Ns(l,f,m);break;case 22:m.mode&1?(En=(b=En)||m.memoizedState!==null,Ns(l,f,m),En=b):Ns(l,f,m);break;default:Ns(l,f,m)}}function tE(l){var f=l.updateQueue;if(f!==null){l.updateQueue=null;var m=l.stateNode;m===null&&(m=l.stateNode=new sR),f.forEach(function(b){var A=vR.bind(null,l,b);m.has(b)||(m.add(b),b.then(A,A))})}}function Ja(l,f){var m=f.deletions;if(m!==null)for(var b=0;b<m.length;b++){var A=m[b];try{var O=l,B=f,se=B;e:for(;se!==null;){switch(se.tag){case 5:vn=se.stateNode,Qa=!1;break e;case 3:vn=se.stateNode.containerInfo,Qa=!0;break e;case 4:vn=se.stateNode.containerInfo,Qa=!0;break e}se=se.return}if(vn===null)throw Error(r(160));eE(O,B,A),vn=null,Qa=!1;var ue=A.alternate;ue!==null&&(ue.return=null),A.return=null}catch(Ae){Pr(A,f,Ae)}}if(f.subtreeFlags&12854)for(f=f.child;f!==null;)rE(f,l),f=f.sibling}function rE(l,f){var m=l.alternate,b=l.flags;switch(l.tag){case 0:case 11:case 14:case 15:if(Ja(f,l),gi(l),b&4){try{Yc(3,l,l.return),K0(3,l)}catch(dt){Pr(l,l.return,dt)}try{Yc(5,l,l.return)}catch(dt){Pr(l,l.return,dt)}}break;case 1:Ja(f,l),gi(l),b&512&&m!==null&&yl(m,m.return);break;case 5:if(Ja(f,l),gi(l),b&512&&m!==null&&yl(m,m.return),l.flags&32){var A=l.stateNode;try{kt(A,"")}catch(dt){Pr(l,l.return,dt)}}if(b&4&&(A=l.stateNode,A!=null)){var O=l.memoizedProps,B=m!==null?m.memoizedProps:O,se=l.type,ue=l.updateQueue;if(l.updateQueue=null,ue!==null)try{se==="input"&&O.type==="radio"&&O.name!=null&&Ce(A,O),va(se,B);var Ae=va(se,O);for(B=0;B<ue.length;B+=2){var We=ue[B],qe=ue[B+1];We==="style"?Yt(A,qe):We==="dangerouslySetInnerHTML"?Qe(A,qe):We==="children"?kt(A,qe):k(A,We,qe,Ae)}switch(se){case"input":ze(A,O);break;case"textarea":fe(A,O);break;case"select":var Ue=A._wrapperState.wasMultiple;A._wrapperState.wasMultiple=!!O.multiple;var it=O.value;it!=null?mt(A,!!O.multiple,it,!1):Ue!==!!O.multiple&&(O.defaultValue!=null?mt(A,!!O.multiple,O.defaultValue,!0):mt(A,!!O.multiple,O.multiple?[]:"",!1))}A[Bc]=O}catch(dt){Pr(l,l.return,dt)}}break;case 6:if(Ja(f,l),gi(l),b&4){if(l.stateNode===null)throw Error(r(162));A=l.stateNode,O=l.memoizedProps;try{A.nodeValue=O}catch(dt){Pr(l,l.return,dt)}}break;case 3:if(Ja(f,l),gi(l),b&4&&m!==null&&m.memoizedState.isDehydrated)try{Cc(f.containerInfo)}catch(dt){Pr(l,l.return,dt)}break;case 4:Ja(f,l),gi(l);break;case 13:Ja(f,l),gi(l),A=l.child,A.flags&8192&&(O=A.memoizedState!==null,A.stateNode.isHidden=O,!O||A.alternate!==null&&A.alternate.memoizedState!==null||(h1=$e())),b&4&&tE(l);break;case 22:if(We=m!==null&&m.memoizedState!==null,l.mode&1?(En=(Ae=En)||We,Ja(f,l),En=Ae):Ja(f,l),gi(l),b&8192){if(Ae=l.memoizedState!==null,(l.stateNode.isHidden=Ae)&&!We&&(l.mode&1)!==0)for(ct=l,We=l.child;We!==null;){for(qe=ct=We;ct!==null;){switch(Ue=ct,it=Ue.child,Ue.tag){case 0:case 11:case 14:case 15:Yc(4,Ue,Ue.return);break;case 1:yl(Ue,Ue.return);var ft=Ue.stateNode;if(typeof ft.componentWillUnmount=="function"){b=Ue,m=Ue.return;try{f=b,ft.props=f.memoizedProps,ft.state=f.memoizedState,ft.componentWillUnmount()}catch(dt){Pr(b,m,dt)}}break;case 5:yl(Ue,Ue.return);break;case 22:if(Ue.memoizedState!==null){iE(qe);continue}}it!==null?(it.return=Ue,ct=it):iE(qe)}We=We.sibling}e:for(We=null,qe=l;;){if(qe.tag===5){if(We===null){We=qe;try{A=qe.stateNode,Ae?(O=A.style,typeof O.setProperty=="function"?O.setProperty("display","none","important"):O.display="none"):(se=qe.stateNode,ue=qe.memoizedProps.style,B=ue!=null&&ue.hasOwnProperty("display")?ue.display:null,se.style.display=bt("display",B))}catch(dt){Pr(l,l.return,dt)}}}else if(qe.tag===6){if(We===null)try{qe.stateNode.nodeValue=Ae?"":qe.memoizedProps}catch(dt){Pr(l,l.return,dt)}}else if((qe.tag!==22&&qe.tag!==23||qe.memoizedState===null||qe===l)&&qe.child!==null){qe.child.return=qe,qe=qe.child;continue}if(qe===l)break e;for(;qe.sibling===null;){if(qe.return===null||qe.return===l)break e;We===qe&&(We=null),qe=qe.return}We===qe&&(We=null),qe.sibling.return=qe.return,qe=qe.sibling}}break;case 19:Ja(f,l),gi(l),b&4&&tE(l);break;case 21:break;default:Ja(f,l),gi(l)}}function gi(l){var f=l.flags;if(f&2){try{e:{for(var m=l.return;m!==null;){if(Qk(m)){var b=m;break e}m=m.return}throw Error(r(160))}switch(b.tag){case 5:var A=b.stateNode;b.flags&32&&(kt(A,""),b.flags&=-33);var O=Jk(l);u1(l,O,A);break;case 3:case 4:var B=b.stateNode.containerInfo,se=Jk(l);c1(l,se,B);break;default:throw Error(r(161))}}catch(ue){Pr(l,l.return,ue)}l.flags&=-3}f&4096&&(l.flags&=-4097)}function lR(l,f,m){ct=l,nE(l)}function nE(l,f,m){for(var b=(l.mode&1)!==0;ct!==null;){var A=ct,O=A.child;if(A.tag===22&&b){var B=A.memoizedState!==null||G0;if(!B){var se=A.alternate,ue=se!==null&&se.memoizedState!==null||En;se=G0;var Ae=En;if(G0=B,(En=ue)&&!Ae)for(ct=A;ct!==null;)B=ct,ue=B.child,B.tag===22&&B.memoizedState!==null?sE(A):ue!==null?(ue.return=B,ct=ue):sE(A);for(;O!==null;)ct=O,nE(O),O=O.sibling;ct=A,G0=se,En=Ae}aE(l)}else(A.subtreeFlags&8772)!==0&&O!==null?(O.return=A,ct=O):aE(l)}}function aE(l){for(;ct!==null;){var f=ct;if((f.flags&8772)!==0){var m=f.alternate;try{if((f.flags&8772)!==0)switch(f.tag){case 0:case 11:case 15:En||K0(5,f);break;case 1:var b=f.stateNode;if(f.flags&4&&!En)if(m===null)b.componentDidMount();else{var A=f.elementType===f.type?m.memoizedProps:Za(f.type,m.memoizedProps);b.componentDidUpdate(A,m.memoizedState,b.__reactInternalSnapshotBeforeUpdate)}var O=f.updateQueue;O!==null&&ik(f,O,b);break;case 3:var B=f.updateQueue;if(B!==null){if(m=null,f.child!==null)switch(f.child.tag){case 5:m=f.child.stateNode;break;case 1:m=f.child.stateNode}ik(f,B,m)}break;case 5:var se=f.stateNode;if(m===null&&f.flags&4){m=se;var ue=f.memoizedProps;switch(f.type){case"button":case"input":case"select":case"textarea":ue.autoFocus&&m.focus();break;case"img":ue.src&&(m.src=ue.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(f.memoizedState===null){var Ae=f.alternate;if(Ae!==null){var We=Ae.memoizedState;if(We!==null){var qe=We.dehydrated;qe!==null&&Cc(qe)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(r(163))}En||f.flags&512&&l1(f)}catch(Ue){Pr(f,f.return,Ue)}}if(f===l){ct=null;break}if(m=f.sibling,m!==null){m.return=f.return,ct=m;break}ct=f.return}}function iE(l){for(;ct!==null;){var f=ct;if(f===l){ct=null;break}var m=f.sibling;if(m!==null){m.return=f.return,ct=m;break}ct=f.return}}function sE(l){for(;ct!==null;){var f=ct;try{switch(f.tag){case 0:case 11:case 15:var m=f.return;try{K0(4,f)}catch(ue){Pr(f,m,ue)}break;case 1:var b=f.stateNode;if(typeof b.componentDidMount=="function"){var A=f.return;try{b.componentDidMount()}catch(ue){Pr(f,A,ue)}}var O=f.return;try{l1(f)}catch(ue){Pr(f,O,ue)}break;case 5:var B=f.return;try{l1(f)}catch(ue){Pr(f,B,ue)}}}catch(ue){Pr(f,f.return,ue)}if(f===l){ct=null;break}var se=f.sibling;if(se!==null){se.return=f.return,ct=se;break}ct=f.return}}var cR=Math.ceil,Y0=E.ReactCurrentDispatcher,f1=E.ReactCurrentOwner,Ta=E.ReactCurrentBatchConfig,Xt=0,sn=null,Ur=null,gn=0,sa=0,wl=Es(0),Gr=0,Zc=null,uo=0,Z0=0,d1=0,Qc=null,Gn=null,h1=0,bl=1/0,Wi=null,Q0=!1,p1=null,Ps=null,J0=!1,Is=null,ed=0,Jc=0,m1=null,td=-1,rd=0;function Bn(){return(Xt&6)!==0?$e():td!==-1?td:td=$e()}function Fs(l){return(l.mode&1)===0?1:(Xt&2)!==0&&gn!==0?gn&-gn:Vj.transition!==null?(rd===0&&(rd=J_()),rd):(l=lr,l!==0||(l=window.event,l=l===void 0?16:lS(l.type)),l)}function ei(l,f,m,b){if(50<Jc)throw Jc=0,m1=null,Error(r(185));Sc(l,m,b),((Xt&2)===0||l!==sn)&&(l===sn&&((Xt&2)===0&&(Z0|=m),Gr===4&&Ds(l,gn)),Kn(l,b),m===1&&Xt===0&&(f.mode&1)===0&&(bl=$e()+500,N0&&As()))}function Kn(l,f){var m=l.callbackNode;VD(l,f);var b=f0(l,l===sn?gn:0);if(b===0)m!==null&&Je(m),l.callbackNode=null,l.callbackPriority=0;else if(f=b&-b,l.callbackPriority!==f){if(m!=null&&Je(m),f===1)l.tag===0?qj(lE.bind(null,l)):XS(lE.bind(null,l)),Uj(function(){(Xt&6)===0&&As()}),m=null;else{switch(eS(b)){case 1:m=ur;break;case 4:m=mr;break;case 16:m=Dr;break;case 536870912:m=gs;break;default:m=Dr}m=vE(m,oE.bind(null,l))}l.callbackPriority=f,l.callbackNode=m}}function oE(l,f){if(td=-1,rd=0,(Xt&6)!==0)throw Error(r(327));var m=l.callbackNode;if(_l()&&l.callbackNode!==m)return null;var b=f0(l,l===sn?gn:0);if(b===0)return null;if((b&30)!==0||(b&l.expiredLanes)!==0||f)f=nd(l,b);else{f=b;var A=Xt;Xt|=2;var O=uE();(sn!==l||gn!==f)&&(Wi=null,bl=$e()+500,ho(l,f));do try{dR();break}catch(se){cE(l,se)}while(!0);Fm(),Y0.current=O,Xt=A,Ur!==null?f=0:(sn=null,gn=0,f=Gr)}if(f!==0){if(f===2&&(A=Kp(l),A!==0&&(b=A,f=v1(l,A))),f===1)throw m=Zc,ho(l,0),Ds(l,b),Kn(l,$e()),m;if(f===6)Ds(l,b);else{if(A=l.current.alternate,(b&30)===0&&!uR(A)&&(f=nd(l,b),f===2&&(O=Kp(l),O!==0&&(b=O,f=v1(l,O))),f===1))throw m=Zc,ho(l,0),Ds(l,b),Kn(l,$e()),m;switch(l.finishedWork=A,l.finishedLanes=b,f){case 0:case 1:throw Error(r(345));case 2:po(l,Gn,Wi);break;case 3:if(Ds(l,b),(b&130023424)===b&&(f=h1+500-$e(),10<f)){if(f0(l,0)!==0)break;if(A=l.suspendedLanes,(A&b)!==b){Bn(),l.pingedLanes|=l.suspendedLanes&A;break}l.timeoutHandle=_m(po.bind(null,l,Gn,Wi),f);break}po(l,Gn,Wi);break;case 4:if(Ds(l,b),(b&4194240)===b)break;for(f=l.eventTimes,A=-1;0<b;){var B=31-jr(b);O=1<<B,B=f[B],B>A&&(A=B),b&=~O}if(b=A,b=$e()-b,b=(120>b?120:480>b?480:1080>b?1080:1920>b?1920:3e3>b?3e3:4320>b?4320:1960*cR(b/1960))-b,10<b){l.timeoutHandle=_m(po.bind(null,l,Gn,Wi),b);break}po(l,Gn,Wi);break;case 5:po(l,Gn,Wi);break;default:throw Error(r(329))}}}return Kn(l,$e()),l.callbackNode===m?oE.bind(null,l):null}function v1(l,f){var m=Qc;return l.current.memoizedState.isDehydrated&&(ho(l,f).flags|=256),l=nd(l,f),l!==2&&(f=Gn,Gn=m,f!==null&&g1(f)),l}function g1(l){Gn===null?Gn=l:Gn.push.apply(Gn,l)}function uR(l){for(var f=l;;){if(f.flags&16384){var m=f.updateQueue;if(m!==null&&(m=m.stores,m!==null))for(var b=0;b<m.length;b++){var A=m[b],O=A.getSnapshot;A=A.value;try{if(!Ka(O(),A))return!1}catch{return!1}}}if(m=f.child,f.subtreeFlags&16384&&m!==null)m.return=f,f=m;else{if(f===l)break;for(;f.sibling===null;){if(f.return===null||f.return===l)return!0;f=f.return}f.sibling.return=f.return,f=f.sibling}}return!0}function Ds(l,f){for(f&=~d1,f&=~Z0,l.suspendedLanes|=f,l.pingedLanes&=~f,l=l.expirationTimes;0<f;){var m=31-jr(f),b=1<<m;l[m]=-1,f&=~b}}function lE(l){if((Xt&6)!==0)throw Error(r(327));_l();var f=f0(l,0);if((f&1)===0)return Kn(l,$e()),null;var m=nd(l,f);if(l.tag!==0&&m===2){var b=Kp(l);b!==0&&(f=b,m=v1(l,b))}if(m===1)throw m=Zc,ho(l,0),Ds(l,f),Kn(l,$e()),m;if(m===6)throw Error(r(345));return l.finishedWork=l.current.alternate,l.finishedLanes=f,po(l,Gn,Wi),Kn(l,$e()),null}function x1(l,f){var m=Xt;Xt|=1;try{return l(f)}finally{Xt=m,Xt===0&&(bl=$e()+500,N0&&As())}}function fo(l){Is!==null&&Is.tag===0&&(Xt&6)===0&&_l();var f=Xt;Xt|=1;var m=Ta.transition,b=lr;try{if(Ta.transition=null,lr=1,l)return l()}finally{lr=b,Ta.transition=m,Xt=f,(Xt&6)===0&&As()}}function y1(){sa=wl.current,wr(wl)}function ho(l,f){l.finishedWork=null,l.finishedLanes=0;var m=l.timeoutHandle;if(m!==-1&&(l.timeoutHandle=-1,$j(m)),Ur!==null)for(m=Ur.return;m!==null;){var b=m;switch(Cm(b),b.tag){case 1:b=b.type.childContextTypes,b!=null&&C0();break;case 3:gl(),wr(qn),wr(_n),Um();break;case 5:Bm(b);break;case 4:gl();break;case 13:wr(Ar);break;case 19:wr(Ar);break;case 10:Dm(b.type._context);break;case 22:case 23:y1()}m=m.return}if(sn=l,Ur=l=js(l.current,null),gn=sa=f,Gr=0,Zc=null,d1=Z0=uo=0,Gn=Qc=null,oo!==null){for(f=0;f<oo.length;f++)if(m=oo[f],b=m.interleaved,b!==null){m.interleaved=null;var A=b.next,O=m.pending;if(O!==null){var B=O.next;O.next=A,b.next=B}m.pending=b}oo=null}return l}function cE(l,f){do{var m=Ur;try{if(Fm(),$0.current=H0,U0){for(var b=Cr.memoizedState;b!==null;){var A=b.queue;A!==null&&(A.pending=null),b=b.next}U0=!1}if(co=0,an=Xr=Cr=null,qc=!1,Vc=0,f1.current=null,m===null||m.return===null){Gr=1,Zc=f,Ur=null;break}e:{var O=l,B=m.return,se=m,ue=f;if(f=gn,se.flags|=32768,ue!==null&&typeof ue=="object"&&typeof ue.then=="function"){var Ae=ue,We=se,qe=We.tag;if((We.mode&1)===0&&(qe===0||qe===11||qe===15)){var Ue=We.alternate;Ue?(We.updateQueue=Ue.updateQueue,We.memoizedState=Ue.memoizedState,We.lanes=Ue.lanes):(We.updateQueue=null,We.memoizedState=null)}var it=Dk(B);if(it!==null){it.flags&=-257,jk(it,B,se,O,f),it.mode&1&&Fk(O,Ae,f),f=it,ue=Ae;var ft=f.updateQueue;if(ft===null){var dt=new Set;dt.add(ue),f.updateQueue=dt}else ft.add(ue);break e}else{if((f&1)===0){Fk(O,Ae,f),w1();break e}ue=Error(r(426))}}else if(Sr&&se.mode&1){var Rr=Dk(B);if(Rr!==null){(Rr.flags&65536)===0&&(Rr.flags|=256),jk(Rr,B,se,O,f),Pm(xl(ue,se));break e}}O=ue=xl(ue,se),Gr!==4&&(Gr=2),Qc===null?Qc=[O]:Qc.push(O),O=B;do{switch(O.tag){case 3:O.flags|=65536,f&=-f,O.lanes|=f;var xe=Pk(O,ue,f);ak(O,xe);break e;case 1:se=ue;var he=O.type,ke=O.stateNode;if((O.flags&128)===0&&(typeof he.getDerivedStateFromError=="function"||ke!==null&&typeof ke.componentDidCatch=="function"&&(Ps===null||!Ps.has(ke)))){O.flags|=65536,f&=-f,O.lanes|=f;var Ke=Ik(O,se,f);ak(O,Ke);break e}}O=O.return}while(O!==null)}dE(m)}catch(vt){f=vt,Ur===m&&m!==null&&(Ur=m=m.return);continue}break}while(!0)}function uE(){var l=Y0.current;return Y0.current=H0,l===null?H0:l}function w1(){(Gr===0||Gr===3||Gr===2)&&(Gr=4),sn===null||(uo&268435455)===0&&(Z0&268435455)===0||Ds(sn,gn)}function nd(l,f){var m=Xt;Xt|=2;var b=uE();(sn!==l||gn!==f)&&(Wi=null,ho(l,f));do try{fR();break}catch(A){cE(l,A)}while(!0);if(Fm(),Xt=m,Y0.current=b,Ur!==null)throw Error(r(261));return sn=null,gn=0,Gr}function fR(){for(;Ur!==null;)fE(Ur)}function dR(){for(;Ur!==null&&!st();)fE(Ur)}function fE(l){var f=mE(l.alternate,l,sa);l.memoizedProps=l.pendingProps,f===null?dE(l):Ur=f,f1.current=null}function dE(l){var f=l;do{var m=f.alternate;if(l=f.return,(f.flags&32768)===0){if(m=aR(m,f,sa),m!==null){Ur=m;return}}else{if(m=iR(m,f),m!==null){m.flags&=32767,Ur=m;return}if(l!==null)l.flags|=32768,l.subtreeFlags=0,l.deletions=null;else{Gr=6,Ur=null;return}}if(f=f.sibling,f!==null){Ur=f;return}Ur=f=l}while(f!==null);Gr===0&&(Gr=5)}function po(l,f,m){var b=lr,A=Ta.transition;try{Ta.transition=null,lr=1,hR(l,f,m,b)}finally{Ta.transition=A,lr=b}return null}function hR(l,f,m,b){do _l();while(Is!==null);if((Xt&6)!==0)throw Error(r(327));m=l.finishedWork;var A=l.finishedLanes;if(m===null)return null;if(l.finishedWork=null,l.finishedLanes=0,m===l.current)throw Error(r(177));l.callbackNode=null,l.callbackPriority=0;var O=m.lanes|m.childLanes;if(XD(l,O),l===sn&&(Ur=sn=null,gn=0),(m.subtreeFlags&2064)===0&&(m.flags&2064)===0||J0||(J0=!0,vE(Dr,function(){return _l(),null})),O=(m.flags&15990)!==0,(m.subtreeFlags&15990)!==0||O){O=Ta.transition,Ta.transition=null;var B=lr;lr=1;var se=Xt;Xt|=4,f1.current=null,oR(l,m),rE(m,l),Fj(wm),p0=!!ym,wm=ym=null,l.current=m,lR(m),Ve(),Xt=se,lr=B,Ta.transition=O}else l.current=m;if(J0&&(J0=!1,Is=l,ed=A),O=l.pendingLanes,O===0&&(Ps=null),bc(m.stateNode),Kn(l,$e()),f!==null)for(b=l.onRecoverableError,m=0;m<f.length;m++)A=f[m],b(A.value,{componentStack:A.stack,digest:A.digest});if(Q0)throw Q0=!1,l=p1,p1=null,l;return(ed&1)!==0&&l.tag!==0&&_l(),O=l.pendingLanes,(O&1)!==0?l===m1?Jc++:(Jc=0,m1=l):Jc=0,As(),null}function _l(){if(Is!==null){var l=eS(ed),f=Ta.transition,m=lr;try{if(Ta.transition=null,lr=16>l?16:l,Is===null)var b=!1;else{if(l=Is,Is=null,ed=0,(Xt&6)!==0)throw Error(r(331));var A=Xt;for(Xt|=4,ct=l.current;ct!==null;){var O=ct,B=O.child;if((ct.flags&16)!==0){var se=O.deletions;if(se!==null){for(var ue=0;ue<se.length;ue++){var Ae=se[ue];for(ct=Ae;ct!==null;){var We=ct;switch(We.tag){case 0:case 11:case 15:Yc(8,We,O)}var qe=We.child;if(qe!==null)qe.return=We,ct=qe;else for(;ct!==null;){We=ct;var Ue=We.sibling,it=We.return;if(Zk(We),We===Ae){ct=null;break}if(Ue!==null){Ue.return=it,ct=Ue;break}ct=it}}}var ft=O.alternate;if(ft!==null){var dt=ft.child;if(dt!==null){ft.child=null;do{var Rr=dt.sibling;dt.sibling=null,dt=Rr}while(dt!==null)}}ct=O}}if((O.subtreeFlags&2064)!==0&&B!==null)B.return=O,ct=B;else e:for(;ct!==null;){if(O=ct,(O.flags&2048)!==0)switch(O.tag){case 0:case 11:case 15:Yc(9,O,O.return)}var xe=O.sibling;if(xe!==null){xe.return=O.return,ct=xe;break e}ct=O.return}}var he=l.current;for(ct=he;ct!==null;){B=ct;var ke=B.child;if((B.subtreeFlags&2064)!==0&&ke!==null)ke.return=B,ct=ke;else e:for(B=he;ct!==null;){if(se=ct,(se.flags&2048)!==0)try{switch(se.tag){case 0:case 11:case 15:K0(9,se)}}catch(vt){Pr(se,se.return,vt)}if(se===B){ct=null;break e}var Ke=se.sibling;if(Ke!==null){Ke.return=se.return,ct=Ke;break e}ct=se.return}}if(Xt=A,As(),nn&&typeof nn.onPostCommitFiberRoot=="function")try{nn.onPostCommitFiberRoot(hi,l)}catch{}b=!0}return b}finally{lr=m,Ta.transition=f}}return!1}function hE(l,f,m){f=xl(m,f),f=Pk(l,f,1),l=Os(l,f,1),f=Bn(),l!==null&&(Sc(l,1,f),Kn(l,f))}function Pr(l,f,m){if(l.tag===3)hE(l,l,m);else for(;f!==null;){if(f.tag===3){hE(f,l,m);break}else if(f.tag===1){var b=f.stateNode;if(typeof f.type.getDerivedStateFromError=="function"||typeof b.componentDidCatch=="function"&&(Ps===null||!Ps.has(b))){l=xl(m,l),l=Ik(f,l,1),f=Os(f,l,1),l=Bn(),f!==null&&(Sc(f,1,l),Kn(f,l));break}}f=f.return}}function pR(l,f,m){var b=l.pingCache;b!==null&&b.delete(f),f=Bn(),l.pingedLanes|=l.suspendedLanes&m,sn===l&&(gn&m)===m&&(Gr===4||Gr===3&&(gn&130023424)===gn&&500>$e()-h1?ho(l,0):d1|=m),Kn(l,f)}function pE(l,f){f===0&&((l.mode&1)===0?f=1:(f=u0,u0<<=1,(u0&130023424)===0&&(u0=4194304)));var m=Bn();l=$i(l,f),l!==null&&(Sc(l,f,m),Kn(l,m))}function mR(l){var f=l.memoizedState,m=0;f!==null&&(m=f.retryLane),pE(l,m)}function vR(l,f){var m=0;switch(l.tag){case 13:var b=l.stateNode,A=l.memoizedState;A!==null&&(m=A.retryLane);break;case 19:b=l.stateNode;break;default:throw Error(r(314))}b!==null&&b.delete(f),pE(l,m)}var mE;mE=function(l,f,m){if(l!==null)if(l.memoizedProps!==f.pendingProps||qn.current)Xn=!0;else{if((l.lanes&m)===0&&(f.flags&128)===0)return Xn=!1,nR(l,f,m);Xn=(l.flags&131072)!==0}else Xn=!1,Sr&&(f.flags&1048576)!==0&&GS(f,I0,f.index);switch(f.lanes=0,f.tag){case 2:var b=f.type;X0(l,f),l=f.pendingProps;var A=ul(f,_n.current);vl(f,m),A=Hm(null,f,b,l,A,m);var O=qm();return f.flags|=1,typeof A=="object"&&A!==null&&typeof A.render=="function"&&A.$$typeof===void 0?(f.tag=1,f.memoizedState=null,f.updateQueue=null,Vn(b)?(O=!0,O0(f)):O=!1,f.memoizedState=A.state!==null&&A.state!==void 0?A.state:null,Mm(f),A.updater=q0,f.stateNode=A,A._reactInternals=f,Zm(f,b,l,m),f=t1(null,f,b,!0,O,m)):(f.tag=0,Sr&&O&&Am(f),Ln(null,f,A,m),f=f.child),f;case 16:b=f.elementType;e:{switch(X0(l,f),l=f.pendingProps,A=b._init,b=A(b._payload),f.type=b,A=f.tag=xR(b),l=Za(b,l),A){case 0:f=e1(null,f,b,l,m);break e;case 1:f=Uk(null,f,b,l,m);break e;case 11:f=Rk(null,f,b,l,m);break e;case 14:f=Mk(null,f,b,Za(b.type,l),m);break e}throw Error(r(306,b,""))}return f;case 0:return b=f.type,A=f.pendingProps,A=f.elementType===b?A:Za(b,A),e1(l,f,b,A,m);case 1:return b=f.type,A=f.pendingProps,A=f.elementType===b?A:Za(b,A),Uk(l,f,b,A,m);case 3:e:{if(zk(f),l===null)throw Error(r(387));b=f.pendingProps,O=f.memoizedState,A=O.element,nk(l,f),L0(f,b,null,m);var B=f.memoizedState;if(b=B.element,O.isDehydrated)if(O={element:b,isDehydrated:!1,cache:B.cache,pendingSuspenseBoundaries:B.pendingSuspenseBoundaries,transitions:B.transitions},f.updateQueue.baseState=O,f.memoizedState=O,f.flags&256){A=xl(Error(r(423)),f),f=Wk(l,f,b,m,A);break e}else if(b!==A){A=xl(Error(r(424)),f),f=Wk(l,f,b,m,A);break e}else for(ia=ks(f.stateNode.containerInfo.firstChild),aa=f,Sr=!0,Ya=null,m=tk(f,null,b,m),f.child=m;m;)m.flags=m.flags&-3|4096,m=m.sibling;else{if(hl(),b===A){f=zi(l,f,m);break e}Ln(l,f,b,m)}f=f.child}return f;case 5:return sk(f),l===null&&Nm(f),b=f.type,A=f.pendingProps,O=l!==null?l.memoizedProps:null,B=A.children,bm(b,A)?B=null:O!==null&&bm(b,O)&&(f.flags|=32),$k(l,f),Ln(l,f,B,m),f.child;case 6:return l===null&&Nm(f),null;case 13:return Hk(l,f,m);case 4:return Lm(f,f.stateNode.containerInfo),b=f.pendingProps,l===null?f.child=pl(f,null,b,m):Ln(l,f,b,m),f.child;case 11:return b=f.type,A=f.pendingProps,A=f.elementType===b?A:Za(b,A),Rk(l,f,b,A,m);case 7:return Ln(l,f,f.pendingProps,m),f.child;case 8:return Ln(l,f,f.pendingProps.children,m),f.child;case 12:return Ln(l,f,f.pendingProps.children,m),f.child;case 10:e:{if(b=f.type._context,A=f.pendingProps,O=f.memoizedProps,B=A.value,vr(j0,b._currentValue),b._currentValue=B,O!==null)if(Ka(O.value,B)){if(O.children===A.children&&!qn.current){f=zi(l,f,m);break e}}else for(O=f.child,O!==null&&(O.return=f);O!==null;){var se=O.dependencies;if(se!==null){B=O.child;for(var ue=se.firstContext;ue!==null;){if(ue.context===b){if(O.tag===1){ue=Ui(-1,m&-m),ue.tag=2;var Ae=O.updateQueue;if(Ae!==null){Ae=Ae.shared;var We=Ae.pending;We===null?ue.next=ue:(ue.next=We.next,We.next=ue),Ae.pending=ue}}O.lanes|=m,ue=O.alternate,ue!==null&&(ue.lanes|=m),jm(O.return,m,f),se.lanes|=m;break}ue=ue.next}}else if(O.tag===10)B=O.type===f.type?null:O.child;else if(O.tag===18){if(B=O.return,B===null)throw Error(r(341));B.lanes|=m,se=B.alternate,se!==null&&(se.lanes|=m),jm(B,m,f),B=O.sibling}else B=O.child;if(B!==null)B.return=O;else for(B=O;B!==null;){if(B===f){B=null;break}if(O=B.sibling,O!==null){O.return=B.return,B=O;break}B=B.return}O=B}Ln(l,f,A.children,m),f=f.child}return f;case 9:return A=f.type,b=f.pendingProps.children,vl(f,m),A=ka(A),b=b(A),f.flags|=1,Ln(l,f,b,m),f.child;case 14:return b=f.type,A=Za(b,f.pendingProps),A=Za(b.type,A),Mk(l,f,b,A,m);case 15:return Lk(l,f,f.type,f.pendingProps,m);case 17:return b=f.type,A=f.pendingProps,A=f.elementType===b?A:Za(b,A),X0(l,f),f.tag=1,Vn(b)?(l=!0,O0(f)):l=!1,vl(f,m),Ok(f,b,A),Zm(f,b,A,m),t1(null,f,b,!0,l,m);case 19:return Vk(l,f,m);case 22:return Bk(l,f,m)}throw Error(r(156,f.tag))};function vE(l,f){return He(l,f)}function gR(l,f,m,b){this.tag=l,this.key=m,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=f,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=b,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Aa(l,f,m,b){return new gR(l,f,m,b)}function b1(l){return l=l.prototype,!(!l||!l.isReactComponent)}function xR(l){if(typeof l=="function")return b1(l)?1:0;if(l!=null){if(l=l.$$typeof,l===F)return 11;if(l===V)return 14}return 2}function js(l,f){var m=l.alternate;return m===null?(m=Aa(l.tag,f,l.key,l.mode),m.elementType=l.elementType,m.type=l.type,m.stateNode=l.stateNode,m.alternate=l,l.alternate=m):(m.pendingProps=f,m.type=l.type,m.flags=0,m.subtreeFlags=0,m.deletions=null),m.flags=l.flags&14680064,m.childLanes=l.childLanes,m.lanes=l.lanes,m.child=l.child,m.memoizedProps=l.memoizedProps,m.memoizedState=l.memoizedState,m.updateQueue=l.updateQueue,f=l.dependencies,m.dependencies=f===null?null:{lanes:f.lanes,firstContext:f.firstContext},m.sibling=l.sibling,m.index=l.index,m.ref=l.ref,m}function ad(l,f,m,b,A,O){var B=2;if(b=l,typeof l=="function")b1(l)&&(B=1);else if(typeof l=="string")B=5;else e:switch(l){case C:return mo(m.children,A,O,f);case P:B=8,A|=8;break;case j:return l=Aa(12,m,f,A|2),l.elementType=j,l.lanes=O,l;case L:return l=Aa(13,m,f,A),l.elementType=L,l.lanes=O,l;case H:return l=Aa(19,m,f,A),l.elementType=H,l.lanes=O,l;case te:return id(m,A,O,f);default:if(typeof l=="object"&&l!==null)switch(l.$$typeof){case R:B=10;break e;case I:B=9;break e;case F:B=11;break e;case V:B=14;break e;case J:B=16,b=null;break e}throw Error(r(130,l==null?l:typeof l,""))}return f=Aa(B,m,f,A),f.elementType=l,f.type=b,f.lanes=O,f}function mo(l,f,m,b){return l=Aa(7,l,b,f),l.lanes=m,l}function id(l,f,m,b){return l=Aa(22,l,b,f),l.elementType=te,l.lanes=m,l.stateNode={isHidden:!1},l}function _1(l,f,m){return l=Aa(6,l,null,f),l.lanes=m,l}function S1(l,f,m){return f=Aa(4,l.children!==null?l.children:[],l.key,f),f.lanes=m,f.stateNode={containerInfo:l.containerInfo,pendingChildren:null,implementation:l.implementation},f}function yR(l,f,m,b,A){this.tag=f,this.containerInfo=l,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Yp(0),this.expirationTimes=Yp(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Yp(0),this.identifierPrefix=b,this.onRecoverableError=A,this.mutableSourceEagerHydrationData=null}function k1(l,f,m,b,A,O,B,se,ue){return l=new yR(l,f,m,se,ue),f===1?(f=1,O===!0&&(f|=8)):f=0,O=Aa(3,null,null,f),l.current=O,O.stateNode=l,O.memoizedState={element:b,isDehydrated:m,cache:null,transitions:null,pendingSuspenseBoundaries:null},Mm(O),l}function wR(l,f,m){var b=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:N,key:b==null?null:""+b,children:l,containerInfo:f,implementation:m}}function gE(l){if(!l)return Ts;l=l._reactInternals;e:{if(ae(l)!==l||l.tag!==1)throw Error(r(170));var f=l;do{switch(f.tag){case 3:f=f.stateNode.context;break e;case 1:if(Vn(f.type)){f=f.stateNode.__reactInternalMemoizedMergedChildContext;break e}}f=f.return}while(f!==null);throw Error(r(171))}if(l.tag===1){var m=l.type;if(Vn(m))return qS(l,m,f)}return f}function xE(l,f,m,b,A,O,B,se,ue){return l=k1(m,b,!0,l,A,O,B,se,ue),l.context=gE(null),m=l.current,b=Bn(),A=Fs(m),O=Ui(b,A),O.callback=f??null,Os(m,O,A),l.current.lanes=A,Sc(l,A,b),Kn(l,b),l}function sd(l,f,m,b){var A=f.current,O=Bn(),B=Fs(A);return m=gE(m),f.context===null?f.context=m:f.pendingContext=m,f=Ui(O,B),f.payload={element:l},b=b===void 0?null:b,b!==null&&(f.callback=b),l=Os(A,f,B),l!==null&&(ei(l,A,B,O),M0(l,A,B)),B}function od(l){if(l=l.current,!l.child)return null;switch(l.child.tag){case 5:return l.child.stateNode;default:return l.child.stateNode}}function yE(l,f){if(l=l.memoizedState,l!==null&&l.dehydrated!==null){var m=l.retryLane;l.retryLane=m!==0&&m<f?m:f}}function E1(l,f){yE(l,f),(l=l.alternate)&&yE(l,f)}function bR(){return null}var wE=typeof reportError=="function"?reportError:function(l){console.error(l)};function T1(l){this._internalRoot=l}ld.prototype.render=T1.prototype.render=function(l){var f=this._internalRoot;if(f===null)throw Error(r(409));sd(l,f,null,null)},ld.prototype.unmount=T1.prototype.unmount=function(){var l=this._internalRoot;if(l!==null){this._internalRoot=null;var f=l.containerInfo;fo(function(){sd(null,l,null,null)}),f[Ri]=null}};function ld(l){this._internalRoot=l}ld.prototype.unstable_scheduleHydration=function(l){if(l){var f=nS();l={blockedOn:null,target:l,priority:f};for(var m=0;m<bs.length&&f!==0&&f<bs[m].priority;m++);bs.splice(m,0,l),m===0&&sS(l)}};function A1(l){return!(!l||l.nodeType!==1&&l.nodeType!==9&&l.nodeType!==11)}function cd(l){return!(!l||l.nodeType!==1&&l.nodeType!==9&&l.nodeType!==11&&(l.nodeType!==8||l.nodeValue!==" react-mount-point-unstable "))}function bE(){}function _R(l,f,m,b,A){if(A){if(typeof b=="function"){var O=b;b=function(){var Ae=od(B);O.call(Ae)}}var B=xE(f,b,l,0,null,!1,!1,"",bE);return l._reactRootContainer=B,l[Ri]=B.current,Mc(l.nodeType===8?l.parentNode:l),fo(),B}for(;A=l.lastChild;)l.removeChild(A);if(typeof b=="function"){var se=b;b=function(){var Ae=od(ue);se.call(Ae)}}var ue=k1(l,0,!1,null,null,!1,!1,"",bE);return l._reactRootContainer=ue,l[Ri]=ue.current,Mc(l.nodeType===8?l.parentNode:l),fo(function(){sd(f,ue,m,b)}),ue}function ud(l,f,m,b,A){var O=m._reactRootContainer;if(O){var B=O;if(typeof A=="function"){var se=A;A=function(){var ue=od(B);se.call(ue)}}sd(f,B,l,A)}else B=_R(m,f,l,A,b);return od(B)}tS=function(l){switch(l.tag){case 3:var f=l.stateNode;if(f.current.memoizedState.isDehydrated){var m=_c(f.pendingLanes);m!==0&&(Zp(f,m|1),Kn(f,$e()),(Xt&6)===0&&(bl=$e()+500,As()))}break;case 13:fo(function(){var b=$i(l,1);if(b!==null){var A=Bn();ei(b,l,1,A)}}),E1(l,1)}},Qp=function(l){if(l.tag===13){var f=$i(l,134217728);if(f!==null){var m=Bn();ei(f,l,134217728,m)}E1(l,134217728)}},rS=function(l){if(l.tag===13){var f=Fs(l),m=$i(l,f);if(m!==null){var b=Bn();ei(m,l,f,b)}E1(l,f)}},nS=function(){return lr},aS=function(l,f){var m=lr;try{return lr=l,f()}finally{lr=m}},xa=function(l,f,m){switch(f){case"input":if(ze(l,m),f=m.name,m.type==="radio"&&f!=null){for(m=l;m.parentNode;)m=m.parentNode;for(m=m.querySelectorAll("input[name="+JSON.stringify(""+f)+'][type="radio"]'),f=0;f<m.length;f++){var b=m[f];if(b!==l&&b.form===l.form){var A=A0(b);if(!A)throw Error(r(90));ie(b),ze(b,A)}}}break;case"textarea":fe(l,m);break;case"select":f=m.value,f!=null&&mt(l,!!m.multiple,f,!1)}},Fe=x1,Xe=fo;var SR={usingClientEntryPoint:!1,Events:[$c,ll,A0,Me,et,x1]},eu={findFiberByHostInstance:no,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},kR={bundleType:eu.bundleType,version:eu.version,rendererPackageName:eu.rendererPackageName,rendererConfig:eu.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:E.ReactCurrentDispatcher,findHostInstanceByFiber:function(l){return l=_e(l),l===null?null:l.stateNode},findFiberByHostInstance:eu.findFiberByHostInstance||bR,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var fd=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!fd.isDisabled&&fd.supportsFiber)try{hi=fd.inject(kR),nn=fd}catch{}}return Yn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=SR,Yn.createPortal=function(l,f){var m=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!A1(f))throw Error(r(200));return wR(l,f,null,m)},Yn.createRoot=function(l,f){if(!A1(l))throw Error(r(299));var m=!1,b="",A=wE;return f!=null&&(f.unstable_strictMode===!0&&(m=!0),f.identifierPrefix!==void 0&&(b=f.identifierPrefix),f.onRecoverableError!==void 0&&(A=f.onRecoverableError)),f=k1(l,1,!1,null,null,m,!1,b,A),l[Ri]=f.current,Mc(l.nodeType===8?l.parentNode:l),new T1(f)},Yn.findDOMNode=function(l){if(l==null)return null;if(l.nodeType===1)return l;var f=l._reactInternals;if(f===void 0)throw typeof l.render=="function"?Error(r(188)):(l=Object.keys(l).join(","),Error(r(268,l)));return l=_e(f),l=l===null?null:l.stateNode,l},Yn.flushSync=function(l){return fo(l)},Yn.hydrate=function(l,f,m){if(!cd(f))throw Error(r(200));return ud(null,l,f,!0,m)},Yn.hydrateRoot=function(l,f,m){if(!A1(l))throw Error(r(405));var b=m!=null&&m.hydratedSources||null,A=!1,O="",B=wE;if(m!=null&&(m.unstable_strictMode===!0&&(A=!0),m.identifierPrefix!==void 0&&(O=m.identifierPrefix),m.onRecoverableError!==void 0&&(B=m.onRecoverableError)),f=xE(f,null,l,1,m??null,A,!1,O,B),l[Ri]=f.current,Mc(l),b)for(l=0;l<b.length;l++)m=b[l],A=m._getVersion,A=A(m._source),f.mutableSourceEagerHydrationData==null?f.mutableSourceEagerHydrationData=[m,A]:f.mutableSourceEagerHydrationData.push(m,A);return new ld(f)},Yn.render=function(l,f,m){if(!cd(f))throw Error(r(200));return ud(null,l,f,!1,m)},Yn.unmountComponentAtNode=function(l){if(!cd(l))throw Error(r(40));return l._reactRootContainer?(fo(function(){ud(null,null,l,!1,function(){l._reactRootContainer=null,l[Ri]=null})}),!0):!1},Yn.unstable_batchedUpdates=x1,Yn.unstable_renderSubtreeIntoContainer=function(l,f,m,b){if(!cd(m))throw Error(r(200));if(l==null||l._reactInternals===void 0)throw Error(r(38));return ud(l,f,m,!1,b)},Yn.version="18.3.1-next-f1338f8080-20240426",Yn}var OE;function i6(){if(OE)return N1.exports;OE=1;function e(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}return e(),N1.exports=PR(),N1.exports}var NE;function IR(){if(NE)return hd;NE=1;var e=i6();return hd.createRoot=e.createRoot,hd.hydrateRoot=e.hydrateRoot,hd}var FR=IR();const DR=rr(FR),jR="modulepreload",RR=function(e){return"/gestore/"+e},PE={},xu=function(t,r,n){let a=Promise.resolve();if(r&&r.length>0){let s=function(u){return Promise.all(u.map(d=>Promise.resolve(d).then(h=>({status:"fulfilled",value:h}),h=>({status:"rejected",reason:h}))))};document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),c=(o==null?void 0:o.nonce)||(o==null?void 0:o.getAttribute("nonce"));a=s(r.map(u=>{if(u=RR(u),u in PE)return;PE[u]=!0;const d=u.endsWith(".css"),h=d?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${u}"]${h}`))return;const p=document.createElement("link");if(p.rel=d?"stylesheet":jR,d||(p.as="script"),p.crossOrigin="",p.href=u,c&&p.setAttribute("nonce",c),document.head.appendChild(p),d)return new Promise((v,x)=>{p.addEventListener("load",v),p.addEventListener("error",()=>x(new Error(`Unable to preload CSS for ${u}`)))})}))}function i(s){const o=new Event("vite:preloadError",{cancelable:!0});if(o.payload=s,window.dispatchEvent(o),!o.defaultPrevented)throw s}return a.then(s=>{for(const o of s||[])o.status==="rejected"&&i(o.reason);return t().catch(i)})},da={Alimentari:["Supermercato","Ristorante","Bar","Caff"],Trasporti:["Mezzi Pubblici","Benzina","Taxi","Manutenzione Auto","Pedaggio"],Casa:["Affitto/Mutuo","Bollette","Manutenzione","Arredamento"],Shopping:["Abbigliamento","Elettronica","Libri","Regali"],"Tempo Libero":["Cinema","Concerti","Sport","Viaggi"],Salute:["Farmacia","Visite Mediche","Assicurazione"],Istruzione:["Corsi","Libri","Tasse Scolastiche"],Lavoro:["Pranzi","Materiale Ufficio"],Altro:[]};function yu(e,t){const[r,n]=D.useState(()=>{try{const a=window.localStorage.getItem(e);if(a==null)return t;const i=JSON.parse(a);return i==null&&t!==null?t:i}catch(a){return console.error(a),t}});return D.useEffect(()=>{try{r===void 0?window.localStorage.removeItem(e):window.localStorage.setItem(e,JSON.stringify(r))}catch(a){console.error(a)}},[e,r]),[r,n]}const MR=()=>{const[e,t]=D.useState(navigator.onLine);return D.useEffect(()=>{const r=()=>t(!0),n=()=>t(!1);return window.addEventListener("online",r),window.addEventListener("offline",n),()=>{window.removeEventListener("online",r),window.removeEventListener("offline",n)}},[]),e},v2=(e,t)=>t.some(r=>e instanceof r);let IE,FE;function LR(){return IE||(IE=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function BR(){return FE||(FE=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const g2=new WeakMap,F1=new WeakMap,Kh=new WeakMap;function $R(e){const t=new Promise((r,n)=>{const a=()=>{e.removeEventListener("success",i),e.removeEventListener("error",s)},i=()=>{r(Co(e.result)),a()},s=()=>{n(e.error),a()};e.addEventListener("success",i),e.addEventListener("error",s)});return Kh.set(t,e),t}function UR(e){if(g2.has(e))return;const t=new Promise((r,n)=>{const a=()=>{e.removeEventListener("complete",i),e.removeEventListener("error",s),e.removeEventListener("abort",s)},i=()=>{r(),a()},s=()=>{n(e.error||new DOMException("AbortError","AbortError")),a()};e.addEventListener("complete",i),e.addEventListener("error",s),e.addEventListener("abort",s)});g2.set(e,t)}let x2={get(e,t,r){if(e instanceof IDBTransaction){if(t==="done")return g2.get(e);if(t==="store")return r.objectStoreNames[1]?void 0:r.objectStore(r.objectStoreNames[0])}return Co(e[t])},set(e,t,r){return e[t]=r,!0},has(e,t){return e instanceof IDBTransaction&&(t==="done"||t==="store")?!0:t in e}};function s6(e){x2=e(x2)}function zR(e){return BR().includes(e)?function(...t){return e.apply(y2(this),t),Co(this.request)}:function(...t){return Co(e.apply(y2(this),t))}}function WR(e){return typeof e=="function"?zR(e):(e instanceof IDBTransaction&&UR(e),v2(e,LR())?new Proxy(e,x2):e)}function Co(e){if(e instanceof IDBRequest)return $R(e);if(F1.has(e))return F1.get(e);const t=WR(e);return t!==e&&(F1.set(e,t),Kh.set(t,e)),t}const y2=e=>Kh.get(e);function HR(e,t,{blocked:r,upgrade:n,blocking:a,terminated:i}={}){const s=indexedDB.open(e,t),o=Co(s);return n&&s.addEventListener("upgradeneeded",c=>{n(Co(s.result),c.oldVersion,c.newVersion,Co(s.transaction),c)}),r&&s.addEventListener("blocked",c=>r(c.oldVersion,c.newVersion,c)),o.then(c=>{i&&c.addEventListener("close",()=>i()),a&&c.addEventListener("versionchange",u=>a(u.oldVersion,u.newVersion,u))}).catch(()=>{}),o}const qR=["get","getKey","getAll","getAllKeys","count"],VR=["put","add","delete","clear"],D1=new Map;function DE(e,t){if(!(e instanceof IDBDatabase&&!(t in e)&&typeof t=="string"))return;if(D1.get(t))return D1.get(t);const r=t.replace(/FromIndex$/,""),n=t!==r,a=VR.includes(r);if(!(r in(n?IDBIndex:IDBObjectStore).prototype)||!(a||qR.includes(r)))return;const i=async function(s,...o){const c=this.transaction(s,a?"readwrite":"readonly");let u=c.store;return n&&(u=u.index(o.shift())),(await Promise.all([u[r](...o),a&&c.done]))[0]};return D1.set(t,i),i}s6(e=>({...e,get:(t,r,n)=>DE(t,r)||e.get(t,r,n),has:(t,r)=>!!DE(t,r)||e.has(t,r)}));const XR=["continue","continuePrimaryKey","advance"],jE={},w2=new WeakMap,o6=new WeakMap,GR={get(e,t){if(!XR.includes(t))return e[t];let r=jE[t];return r||(r=jE[t]=function(...n){w2.set(this,o6.get(this)[t](...n))}),r}};async function*KR(...e){let t=this;if(t instanceof IDBCursor||(t=await t.openCursor(...e)),!t)return;t=t;const r=new Proxy(t,GR);for(o6.set(r,t),Kh.set(r,y2(t));t;)yield r,t=await(w2.get(r)||t.continue()),w2.delete(r)}function RE(e,t){return t===Symbol.asyncIterator&&v2(e,[IDBIndex,IDBObjectStore,IDBCursor])||t==="iterate"&&v2(e,[IDBIndex,IDBObjectStore])}s6(e=>({...e,get(t,r,n){return RE(t,r)?KR:e.get(t,r,n)},has(t,r){return RE(t,r)||e.has(t,r)}}));const YR="expense-manager-db",Mu="offline-images",ZR=1;let $s=null;const ME=()=>($s||($s=HR(YR,ZR,{upgrade(e){e.objectStoreNames.contains(Mu)||e.createObjectStore(Mu,{keyPath:"id"})},blocked(){console.warn("Database blocked")},blocking(){$s&&($s.then(e=>e.close()),$s=null)},terminated(){$s=null}})),$s);async function Jw(e){try{const t=await ME();return await e(t)}catch(t){if(t&&(t.message&&(t.message.includes("closing")||t.message.includes("closed"))||t.name==="InvalidStateError")){console.warn("Database connection issue, retrying...",t),$s=null;const r=await ME();return await e(r)}throw t}}const pd=async e=>{await Jw(async t=>{await t.put(Mu,e)})},j1=async()=>await Jw(async e=>await e.getAll(Mu)),LE=async e=>{await Jw(async t=>{await t.delete(Mu,e)})},QR=[{id:"cash",name:"Contanti"},{id:"credit-card",name:"Carta di Credito"},{id:"bank-account",name:"Conto Bancario"},{id:"paypal",name:"PayPal"},{id:"revolut",name:"Revolut"},{id:"poste",name:"PostePay"},{id:"crypto",name:"Cripto"}];/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var Qd={};Qd.version="0.20.3";var Ba=1200,JR=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],eb={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},tb=function(e){JR.indexOf(e)!=-1&&(eb[0]=e)};function eM(){tb(1252)}var ii=function(e){Ba=e,tb(e)};function rb(){ii(1200),eM()}function BE(e){for(var t=[],r=0,n=e.length;r<n;++r)t[r]=e.charCodeAt(r);return t}function l6(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r)+(e.charCodeAt(2*r+1)<<8));return t.join("")}function tM(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e[2*r]+(e[2*r+1]<<8));return t.join("")}function c6(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r+1)+(e.charCodeAt(2*r)<<8));return t.join("")}var du=function(e){var t=e.charCodeAt(0),r=e.charCodeAt(1);return t==255&&r==254?l6(e.slice(2)):t==254&&r==255?c6(e.slice(2)):t==65279?e.slice(1):e},md=function(t){return String.fromCharCode(t)},$E=function(t){return String.fromCharCode(t)},rM=null,Fn="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function Jd(e){for(var t="",r=0,n=0,a=0,i=0,s=0,o=0,c=0,u=0;u<e.length;)r=e.charCodeAt(u++),i=r>>2,n=e.charCodeAt(u++),s=(r&3)<<4|n>>4,a=e.charCodeAt(u++),o=(n&15)<<2|a>>6,c=a&63,isNaN(n)?o=c=64:isNaN(a)&&(c=64),t+=Fn.charAt(i)+Fn.charAt(s)+Fn.charAt(o)+Fn.charAt(c);return t}function nM(e){for(var t="",r=0,n=0,a=0,i=0,s=0,o=0,c=0,u=0;u<e.length;)r=e.charCodeAt(u++),r>255&&(r=95),i=r>>2,n=e.charCodeAt(u++),n>255&&(n=95),s=(r&3)<<4|n>>4,a=e.charCodeAt(u++),a>255&&(a=95),o=(n&15)<<2|a>>6,c=a&63,isNaN(n)?o=c=64:isNaN(a)&&(c=64),t+=Fn.charAt(i)+Fn.charAt(s)+Fn.charAt(o)+Fn.charAt(c);return t}function aM(e){for(var t="",r=0,n=0,a=0,i=0,s=0,o=0,c=0,u=0;u<e.length;)r=e[u++],i=r>>2,n=e[u++],s=(r&3)<<4|n>>4,a=e[u++],o=(n&15)<<2|a>>6,c=a&63,isNaN(n)?o=c=64:isNaN(a)&&(c=64),t+=Fn.charAt(i)+Fn.charAt(s)+Fn.charAt(o)+Fn.charAt(c);return t}function pa(e){var t="",r=0,n=0,a=0,i=0,s=0,o=0,c=0;if(e.slice(0,5)=="data:"){var u=e.slice(0,1024).indexOf(";base64,");u>-1&&(e=e.slice(u+8))}e=e.replace(/[^\w\+\/\=]/g,"");for(var u=0;u<e.length;)i=Fn.indexOf(e.charAt(u++)),s=Fn.indexOf(e.charAt(u++)),r=i<<2|s>>4,t+=String.fromCharCode(r),o=Fn.indexOf(e.charAt(u++)),n=(s&15)<<4|o>>2,o!==64&&(t+=String.fromCharCode(n)),c=Fn.indexOf(e.charAt(u++)),a=(o&3)<<6|c,c!==64&&(t+=String.fromCharCode(a));return t}var It=(function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node})(),Fi=(function(){if(typeof Buffer<"u"){var e=!Buffer.from;if(!e)try{Buffer.from("foo","utf8")}catch{e=!0}return e?function(t,r){return r?new Buffer(t,r):new Buffer(t)}:Buffer.from.bind(Buffer)}return function(){}})(),Lu=(function(){if(typeof Buffer>"u")return!1;var e=Fi([65,0]);if(!e)return!1;var t=e.toString("utf16le");return t.length==1})();function Hs(e){return It?Buffer.alloc?Buffer.alloc(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}function UE(e){return It?Buffer.allocUnsafe?Buffer.allocUnsafe(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}var zn=function(t){return It?Fi(t,"binary"):t.split("").map(function(r){return r.charCodeAt(0)&255})};function Yh(e){if(typeof ArrayBuffer>"u")return zn(e);for(var t=new ArrayBuffer(e.length),r=new Uint8Array(t),n=0;n!=e.length;++n)r[n]=e.charCodeAt(n)&255;return t}function Pi(e){if(Array.isArray(e))return e.map(function(n){return String.fromCharCode(n)}).join("");for(var t=[],r=0;r<e.length;++r)t[r]=String.fromCharCode(e[r]);return t.join("")}function iM(e){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(e)}function nb(e){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(e instanceof ArrayBuffer)return nb(new Uint8Array(e));for(var t=new Array(e.length),r=0;r<e.length;++r)t[r]=e[r];return t}var Lr=It?function(e){return Buffer.concat(e.map(function(t){return Buffer.isBuffer(t)?t:Fi(t)}))}:function(e){if(typeof Uint8Array<"u"){var t=0,r=0;for(t=0;t<e.length;++t)r+=e[t].length;var n=new Uint8Array(r),a=0;for(t=0,r=0;t<e.length;r+=a,++t)a=e[t].length,e[t]instanceof Uint8Array?n.set(e[t],r):typeof e[t]=="string"?n.set(new Uint8Array(zn(e[t])),r):n.set(new Uint8Array(e[t]),r);return n}return[].concat.apply([],e.map(function(i){return Array.isArray(i)?i:[].slice.call(i)}))};function sM(e){for(var t=[],r=0,n=e.length+250,a=Hs(e.length+255),i=0;i<e.length;++i){var s=e.charCodeAt(i);if(s<128)a[r++]=s;else if(s<2048)a[r++]=192|s>>6&31,a[r++]=128|s&63;else if(s>=55296&&s<57344){s=(s&1023)+64;var o=e.charCodeAt(++i)&1023;a[r++]=240|s>>8&7,a[r++]=128|s>>2&63,a[r++]=128|o>>6&15|(s&3)<<4,a[r++]=128|o&63}else a[r++]=224|s>>12&15,a[r++]=128|s>>6&63,a[r++]=128|s&63;r>n&&(t.push(a.slice(0,r)),r=0,a=Hs(65535),n=65530)}return t.push(a.slice(0,r)),Lr(t)}var ta=/\u0000/g,hu=/[\u0001-\u0006]/g;function Dl(e){for(var t="",r=e.length-1;r>=0;)t+=e.charAt(r--);return t}function si(e,t){var r=""+e;return r.length>=t?r:qt("0",t-r.length)+r}function ab(e,t){var r=""+e;return r.length>=t?r:qt(" ",t-r.length)+r}function eh(e,t){var r=""+e;return r.length>=t?r:r+qt(" ",t-r.length)}function oM(e,t){var r=""+Math.round(e);return r.length>=t?r:qt("0",t-r.length)+r}function lM(e,t){var r=""+e;return r.length>=t?r:qt("0",t-r.length)+r}var zE=Math.pow(2,32);function Sl(e,t){if(e>zE||e<-zE)return oM(e,t);var r=Math.round(e);return lM(r,t)}function th(e,t){return t=t||0,e.length>=7+t&&(e.charCodeAt(t)|32)===103&&(e.charCodeAt(t+1)|32)===101&&(e.charCodeAt(t+2)|32)===110&&(e.charCodeAt(t+3)|32)===101&&(e.charCodeAt(t+4)|32)===114&&(e.charCodeAt(t+5)|32)===97&&(e.charCodeAt(t+6)|32)===108}var WE=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],R1=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function cM(e){return e||(e={}),e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"/ "hh""mm""ss" "',e}var yt={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},HE={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},uM={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function rh(e,t,r){for(var n=e<0?-1:1,a=e*n,i=0,s=1,o=0,c=1,u=0,d=0,h=Math.floor(a);u<t&&(h=Math.floor(a),o=h*s+i,d=h*u+c,!(a-h<5e-8));)a=1/(a-h),i=s,s=o,c=u,u=d;if(d>t&&(u>t?(d=c,o=i):(d=u,o=s)),!r)return[0,n*o,d];var p=Math.floor(n*o/d);return[p,n*o-p*d,d]}function fM(e){var t=e.toPrecision(16);if(t.indexOf("e")>-1){var r=t.slice(0,t.indexOf("e"));return r=r.indexOf(".")>-1?r.slice(0,r.slice(0,2)=="0."?17:16):r.slice(0,15)+qt("0",r.length-15),r+t.slice(t.indexOf("e"))}var n=t.indexOf(".")>-1?t.slice(0,t.slice(0,2)=="0."?17:16):t.slice(0,15)+qt("0",t.length-15);return Number(n)}function Xi(e,t,r){if(e>2958465||e<0)return null;e=fM(e);var n=e|0,a=Math.floor(86400*(e-n)),i=0,s=[],o={D:n,T:a,u:86400*(e-n)-a,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(o.u)<1e-6&&(o.u=0),t&&t.date1904&&(n+=1462),o.u>.9999&&(o.u=0,++a==86400&&(o.T=a=0,++n,++o.D)),n===60)s=r?[1317,10,29]:[1900,2,29],i=3;else if(n===0)s=r?[1317,8,29]:[1900,1,0],i=6;else{n>60&&--n;var c=new Date(1900,0,1);c.setDate(c.getDate()+n-1),s=[c.getFullYear(),c.getMonth()+1,c.getDate()],i=c.getDay(),n<60&&(i=(i+6)%7),r&&(i=mM(c,s))}return o.y=s[0],o.m=s[1],o.d=s[2],o.S=a%60,a=Math.floor(a/60),o.M=a%60,a=Math.floor(a/60),o.H=a,o.q=i,o}function ib(e){return e.indexOf(".")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function dM(e){return e.indexOf("E")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function hM(e){var t=e<0?12:11,r=ib(e.toFixed(12));return r.length<=t||(r=e.toPrecision(10),r.length<=t)?r:e.toExponential(5)}function pM(e){var t=ib(e.toFixed(11));return t.length>(e<0?12:11)||t==="0"||t==="-0"?e.toPrecision(6):t}function Bu(e){if(!isFinite(e))return isNaN(e)?"#NUM!":"#DIV/0!";var t=Math.floor(Math.log(Math.abs(e))*Math.LOG10E),r;return t>=-4&&t<=-1?r=e.toPrecision(10+t):Math.abs(t)<=9?r=hM(e):t===10?r=e.toFixed(10).substr(0,12):r=pM(e),ib(dM(r.toUpperCase()))}function Lo(e,t){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(e|0)===e?e.toString(10):Bu(e);case"undefined":return"";case"object":if(e==null)return"";if(e instanceof Date)return ma(14,Or(e,t&&t.date1904),t)}throw new Error("unsupported value in General format: "+e)}function mM(e,t){t[0]-=581;var r=e.getDay();return e<60&&(r=(r+6)%7),r}function vM(e,t,r,n){var a="",i=0,s=0,o=r.y,c,u=0;switch(e){case 98:o=r.y+543;case 121:switch(t.length){case 1:case 2:c=o%100,u=2;break;default:c=o%1e4,u=4;break}break;case 109:switch(t.length){case 1:case 2:c=r.m,u=t.length;break;case 3:return R1[r.m-1][1];case 5:return R1[r.m-1][0];default:return R1[r.m-1][2]}break;case 100:switch(t.length){case 1:case 2:c=r.d,u=t.length;break;case 3:return WE[r.q][0];default:return WE[r.q][1]}break;case 104:switch(t.length){case 1:case 2:c=1+(r.H+11)%12,u=t.length;break;default:throw"bad hour format: "+t}break;case 72:switch(t.length){case 1:case 2:c=r.H,u=t.length;break;default:throw"bad hour format: "+t}break;case 77:switch(t.length){case 1:case 2:c=r.M,u=t.length;break;default:throw"bad minute format: "+t}break;case 115:if(t!="s"&&t!="ss"&&t!=".0"&&t!=".00"&&t!=".000")throw"bad second format: "+t;return r.u===0&&(t=="s"||t=="ss")?si(r.S,t.length):(n>=2?s=n===3?1e3:100:s=n===1?10:1,i=Math.round(s*(r.S+r.u)),i>=60*s&&(i=0),t==="s"?i===0?"0":""+i/s:(a=si(i,2+n),t==="ss"?a.substr(0,2):"."+a.substr(2,t.length-1)));case 90:switch(t){case"[h]":case"[hh]":c=r.D*24+r.H;break;case"[m]":case"[mm]":c=(r.D*24+r.H)*60+r.M;break;case"[s]":case"[ss]":c=((r.D*24+r.H)*60+r.M)*60+(n==0?Math.round(r.S+r.u):r.S);break;default:throw"bad abstime format: "+t}u=t.length===3?1:2;break;case 101:c=o,u=1;break}var d=u>0?si(c,u):"";return d}function Gi(e){var t=3;if(e.length<=t)return e;for(var r=e.length%t,n=e.substr(0,r);r!=e.length;r+=t)n+=(n.length>0?",":"")+e.substr(r,t);return n}var u6=/%/g;function gM(e,t,r){var n=t.replace(u6,""),a=t.length-n.length;return Qi(e,n,r*Math.pow(10,2*a))+qt("%",a)}function xM(e,t,r){for(var n=t.length-1;t.charCodeAt(n-1)===44;)--n;return Qi(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}function f6(e,t){var r,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+f6(e,-t);var a=e.indexOf(".");a===-1&&(a=e.indexOf("E"));var i=Math.floor(Math.log(t)*Math.LOG10E)%a;if(i<0&&(i+=a),r=(t/Math.pow(10,i)).toPrecision(n+1+(a+i)%a),r.indexOf("e")===-1){var s=Math.floor(Math.log(t)*Math.LOG10E);for(r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(s-r.length+i):r+="E+"+(s-i);r.substr(0,2)==="0.";)r=r.charAt(0)+r.substr(2,a)+"."+r.substr(2+a),r=r.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,c,u,d){return c+u+d.substr(0,(a+i)%a)+"."+d.substr(i)+"E"})}else r=t.toExponential(n);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}var d6=/# (\?+)( ?)\/( ?)(\d+)/;function yM(e,t,r){var n=parseInt(e[4],10),a=Math.round(t*n),i=Math.floor(a/n),s=a-i*n,o=n;return r+(i===0?"":""+i)+" "+(s===0?qt(" ",e[1].length+1+e[4].length):ab(s,e[1].length)+e[2]+"/"+e[3]+si(o,e[4].length))}function wM(e,t,r){return r+(t===0?"":""+t)+qt(" ",e[1].length+2+e[4].length)}var h6=/^#*0*\.([0#]+)/,p6=/\)[^)]*[0#]/,m6=/\(###\) ###\\?-####/;function Un(e){for(var t="",r,n=0;n!=e.length;++n)switch(r=e.charCodeAt(n)){case 35:break;case 63:t+=" ";break;case 48:t+="0";break;default:t+=String.fromCharCode(r)}return t}function qE(e,t){var r=Math.pow(10,t);return""+Math.round(e*r)/r}function VE(e,t){var r=e-Math.floor(e),n=Math.pow(10,t);return t<(""+Math.round(r*n)).length?0:Math.round(r*n)}function bM(e,t){return t<(""+Math.round((e-Math.floor(e))*Math.pow(10,t))).length?1:0}function _M(e){return e<2147483647&&e>-2147483648?""+(e>=0?e|0:e-1|0):""+Math.floor(e)}function Fa(e,t,r){if(e.charCodeAt(0)===40&&!t.match(p6)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?Fa("n",n,r):"("+Fa("n",n,-r)+")"}if(t.charCodeAt(t.length-1)===44)return xM(e,t,r);if(t.indexOf("%")!==-1)return gM(e,t,r);if(t.indexOf("E")!==-1)return f6(t,r);if(t.charCodeAt(0)===36)return"$"+Fa(e,t.substr(t.charAt(1)==" "?2:1),r);var a,i,s,o,c=Math.abs(r),u=r<0?"-":"";if(t.match(/^00+$/))return u+Sl(c,t.length);if(t.match(/^[#?]+$/))return a=Sl(r,0),a==="0"&&(a=""),a.length>t.length?a:Un(t.substr(0,t.length-a.length))+a;if(i=t.match(d6))return yM(i,c,u);if(t.match(/^#+0+$/))return u+Sl(c,t.length-t.indexOf("0"));if(i=t.match(h6))return a=qE(r,i[1].length).replace(/^([^\.]+)$/,"$1."+Un(i[1])).replace(/\.$/,"."+Un(i[1])).replace(/\.(\d*)$/,function(x,w){return"."+w+qt("0",Un(i[1]).length-w.length)}),t.indexOf("0.")!==-1?a:a.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),i=t.match(/^(0*)\.(#*)$/))return u+qE(c,i[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,i[1].length?"0.":".");if(i=t.match(/^#{1,3},##0(\.?)$/))return u+Gi(Sl(c,0));if(i=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+Fa(e,t,-r):Gi(""+(Math.floor(r)+bM(r,i[1].length)))+"."+si(VE(r,i[1].length),i[1].length);if(i=t.match(/^#,#*,#0/))return Fa(e,t.replace(/^#,#*,/,""),r);if(i=t.match(/^([0#]+)(\\?-([0#]+))+$/))return a=Dl(Fa(e,t.replace(/[\\-]/g,""),r)),s=0,Dl(Dl(t.replace(/\\/g,"")).replace(/[0#]/g,function(x){return s<a.length?a.charAt(s++):x==="0"?"0":""}));if(t.match(m6))return a=Fa(e,"##########",r),"("+a.substr(0,3)+") "+a.substr(3,3)+"-"+a.substr(6);var d="";if(i=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return s=Math.min(i[4].length,7),o=rh(c,Math.pow(10,s)-1,!1),a=""+u,d=Qi("n",i[1],o[1]),d.charAt(d.length-1)==" "&&(d=d.substr(0,d.length-1)+"0"),a+=d+i[2]+"/"+i[3],d=eh(o[2],s),d.length<i[4].length&&(d=Un(i[4].substr(i[4].length-d.length))+d),a+=d,a;if(i=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return s=Math.min(Math.max(i[1].length,i[4].length),7),o=rh(c,Math.pow(10,s)-1,!0),u+(o[0]||(o[1]?"":"0"))+" "+(o[1]?ab(o[1],s)+i[2]+"/"+i[3]+eh(o[2],s):qt(" ",2*s+1+i[2].length+i[3].length));if(i=t.match(/^[#0?]+$/))return a=Sl(r,0),t.length<=a.length?a:Un(t.substr(0,t.length-a.length))+a;if(i=t.match(/^([#0?]+)\.([#0]+)$/)){a=""+r.toFixed(Math.min(i[2].length,10)).replace(/([^0])0+$/,"$1"),s=a.indexOf(".");var h=t.indexOf(".")-s,p=t.length-a.length-h;return Un(t.substr(0,h)+a+t.substr(t.length-p))}if(i=t.match(/^00,000\.([#0]*0)$/))return s=VE(r,i[1].length),r<0?"-"+Fa(e,t,-r):Gi(_M(r)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(x){return"00,"+(x.length<3?si(0,3-x.length):"")+x})+"."+si(s,i[1].length);switch(t){case"###,##0.00":return Fa(e,"#,##0.00",r);case"###,###":case"##,###":case"#,###":var v=Gi(Sl(c,0));return v!=="0"?u+v:"";case"###,###.00":return Fa(e,"###,##0.00",r).replace(/^0\./,".");case"#,###.00":return Fa(e,"#,##0.00",r).replace(/^0\./,".")}throw new Error("unsupported format |"+t+"|")}function SM(e,t,r){for(var n=t.length-1;t.charCodeAt(n-1)===44;)--n;return Qi(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}function kM(e,t,r){var n=t.replace(u6,""),a=t.length-n.length;return Qi(e,n,r*Math.pow(10,2*a))+qt("%",a)}function v6(e,t){var r,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+v6(e,-t);var a=e.indexOf(".");a===-1&&(a=e.indexOf("E"));var i=Math.floor(Math.log(t)*Math.LOG10E)%a;if(i<0&&(i+=a),r=(t/Math.pow(10,i)).toPrecision(n+1+(a+i)%a),!r.match(/[Ee]/)){var s=Math.floor(Math.log(t)*Math.LOG10E);r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(s-r.length+i):r+="E+"+(s-i),r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,c,u,d){return c+u+d.substr(0,(a+i)%a)+"."+d.substr(i)+"E"})}else r=t.toExponential(n);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}function yi(e,t,r){if(e.charCodeAt(0)===40&&!t.match(p6)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?yi("n",n,r):"("+yi("n",n,-r)+")"}if(t.charCodeAt(t.length-1)===44)return SM(e,t,r);if(t.indexOf("%")!==-1)return kM(e,t,r);if(t.indexOf("E")!==-1)return v6(t,r);if(t.charCodeAt(0)===36)return"$"+yi(e,t.substr(t.charAt(1)==" "?2:1),r);var a,i,s,o,c=Math.abs(r),u=r<0?"-":"";if(t.match(/^00+$/))return u+si(c,t.length);if(t.match(/^[#?]+$/))return a=""+r,r===0&&(a=""),a.length>t.length?a:Un(t.substr(0,t.length-a.length))+a;if(i=t.match(d6))return wM(i,c,u);if(t.match(/^#+0+$/))return u+si(c,t.length-t.indexOf("0"));if(i=t.match(h6))return a=(""+r).replace(/^([^\.]+)$/,"$1."+Un(i[1])).replace(/\.$/,"."+Un(i[1])),a=a.replace(/\.(\d*)$/,function(x,w){return"."+w+qt("0",Un(i[1]).length-w.length)}),t.indexOf("0.")!==-1?a:a.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),i=t.match(/^(0*)\.(#*)$/))return u+(""+c).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,i[1].length?"0.":".");if(i=t.match(/^#{1,3},##0(\.?)$/))return u+Gi(""+c);if(i=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+yi(e,t,-r):Gi(""+r)+"."+qt("0",i[1].length);if(i=t.match(/^#,#*,#0/))return yi(e,t.replace(/^#,#*,/,""),r);if(i=t.match(/^([0#]+)(\\?-([0#]+))+$/))return a=Dl(yi(e,t.replace(/[\\-]/g,""),r)),s=0,Dl(Dl(t.replace(/\\/g,"")).replace(/[0#]/g,function(x){return s<a.length?a.charAt(s++):x==="0"?"0":""}));if(t.match(m6))return a=yi(e,"##########",r),"("+a.substr(0,3)+") "+a.substr(3,3)+"-"+a.substr(6);var d="";if(i=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return s=Math.min(i[4].length,7),o=rh(c,Math.pow(10,s)-1,!1),a=""+u,d=Qi("n",i[1],o[1]),d.charAt(d.length-1)==" "&&(d=d.substr(0,d.length-1)+"0"),a+=d+i[2]+"/"+i[3],d=eh(o[2],s),d.length<i[4].length&&(d=Un(i[4].substr(i[4].length-d.length))+d),a+=d,a;if(i=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return s=Math.min(Math.max(i[1].length,i[4].length),7),o=rh(c,Math.pow(10,s)-1,!0),u+(o[0]||(o[1]?"":"0"))+" "+(o[1]?ab(o[1],s)+i[2]+"/"+i[3]+eh(o[2],s):qt(" ",2*s+1+i[2].length+i[3].length));if(i=t.match(/^[#0?]+$/))return a=""+r,t.length<=a.length?a:Un(t.substr(0,t.length-a.length))+a;if(i=t.match(/^([#0]+)\.([#0]+)$/)){a=""+r.toFixed(Math.min(i[2].length,10)).replace(/([^0])0+$/,"$1"),s=a.indexOf(".");var h=t.indexOf(".")-s,p=t.length-a.length-h;return Un(t.substr(0,h)+a+t.substr(t.length-p))}if(i=t.match(/^00,000\.([#0]*0)$/))return r<0?"-"+yi(e,t,-r):Gi(""+r).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(x){return"00,"+(x.length<3?si(0,3-x.length):"")+x})+"."+si(0,i[1].length);switch(t){case"###,###":case"##,###":case"#,###":var v=Gi(""+c);return v!=="0"?u+v:"";default:if(t.match(/\.[0#?]*$/))return yi(e,t.slice(0,t.lastIndexOf(".")),r)+Un(t.slice(t.lastIndexOf(".")))}throw new Error("unsupported format |"+t+"|")}function Qi(e,t,r){return(r|0)===r?yi(e,t,r):Fa(e,t,r)}function EM(e){for(var t=[],r=!1,n=0,a=0;n<e.length;++n)switch(e.charCodeAt(n)){case 34:r=!r;break;case 95:case 42:case 92:++n;break;case 59:t[t.length]=e.substr(a,n-a),a=n+1}if(t[t.length]=e.substr(a),r===!0)throw new Error("Format |"+e+"| unterminated string ");return t}var g6=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function Ha(e){for(var t=0,r="",n="";t<e.length;)switch(r=e.charAt(t)){case"G":th(e,t)&&(t+=6),t++;break;case'"':for(;e.charCodeAt(++t)!==34&&t<e.length;);++t;break;case"\\":t+=2;break;case"_":t+=2;break;case"@":++t;break;case"B":case"b":if(e.charAt(t+1)==="1"||e.charAt(t+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(e.substr(t,3).toUpperCase()==="A/P"||e.substr(t,5).toUpperCase()==="AM/PM"||e.substr(t,5).toUpperCase()==="/")return!0;++t;break;case"[":for(n=r;e.charAt(t++)!=="]"&&t<e.length;)n+=e.charAt(t);if(n.match(g6))return!0;break;case".":case"0":case"#":for(;t<e.length&&("0#?.,E+-%".indexOf(r=e.charAt(++t))>-1||r=="\\"&&e.charAt(t+1)=="-"&&"0#".indexOf(e.charAt(t+2))>-1););break;case"?":for(;e.charAt(++t)===r;);break;case"*":++t,(e.charAt(t)==" "||e.charAt(t)=="*")&&++t;break;case"(":case")":++t;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;t<e.length&&"0123456789".indexOf(e.charAt(++t))>-1;);break;case" ":++t;break;default:++t;break}return!1}function TM(e,t,r,n){for(var a=[],i="",s=0,o="",c="t",u,d,h,p="H";s<e.length;)switch(o=e.charAt(s)){case"G":if(!th(e,s))throw new Error("unrecognized character "+o+" in "+e);a[a.length]={t:"G",v:"General"},s+=7;break;case'"':for(i="";(h=e.charCodeAt(++s))!==34&&s<e.length;)i+=String.fromCharCode(h);a[a.length]={t:"t",v:i},++s;break;case"\\":var v=e.charAt(++s),x=v==="("||v===")"?v:"t";a[a.length]={t:x,v},++s;break;case"_":a[a.length]={t:"t",v:" "},s+=2;break;case"@":a[a.length]={t:"T",v:t},++s;break;case"B":case"b":if(e.charAt(s+1)==="1"||e.charAt(s+1)==="2"){if(u==null&&(u=Xi(t,r,e.charAt(s+1)==="2"),u==null))return"";a[a.length]={t:"X",v:e.substr(s,2)},c=o,s+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":o=o.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(t<0||u==null&&(u=Xi(t,r),u==null))return"";for(i=o;++s<e.length&&e.charAt(s).toLowerCase()===o;)i+=o;o==="m"&&c.toLowerCase()==="h"&&(o="M"),o==="h"&&(o=p),a[a.length]={t:o,v:i},c=o;break;case"A":case"a":case"":var w={t:o,v:o};if(u==null&&(u=Xi(t,r)),e.substr(s,3).toUpperCase()==="A/P"?(u!=null&&(w.v=u.H>=12?e.charAt(s+2):o),w.t="T",p="h",s+=3):e.substr(s,5).toUpperCase()==="AM/PM"?(u!=null&&(w.v=u.H>=12?"PM":"AM"),w.t="T",s+=5,p="h"):e.substr(s,5).toUpperCase()==="/"?(u!=null&&(w.v=u.H>=12?"":""),w.t="T",s+=5,p="h"):(w.t="t",++s),u==null&&w.t==="T")return"";a[a.length]=w,c=o;break;case"[":for(i=o;e.charAt(s++)!=="]"&&s<e.length;)i+=e.charAt(s);if(i.slice(-1)!=="]")throw'unterminated "[" block: |'+i+"|";if(i.match(g6)){if(u==null&&(u=Xi(t,r),u==null))return"";a[a.length]={t:"Z",v:i.toLowerCase()},c=i.charAt(1)}else i.indexOf("$")>-1&&(i=(i.match(/\$([^-\[\]]*)/)||[])[1]||"$",Ha(e)||(a[a.length]={t:"t",v:i}));break;case".":if(u!=null){for(i=o;++s<e.length&&(o=e.charAt(s))==="0";)i+=o;a[a.length]={t:"s",v:i};break}case"0":case"#":for(i=o;++s<e.length&&"0#?.,E+-%".indexOf(o=e.charAt(s))>-1;)i+=o;a[a.length]={t:"n",v:i};break;case"?":for(i=o;e.charAt(++s)===o;)i+=o;a[a.length]={t:o,v:i},c=o;break;case"*":++s,(e.charAt(s)==" "||e.charAt(s)=="*")&&++s;break;case"(":case")":a[a.length]={t:n===1?"t":o,v:o},++s;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(i=o;s<e.length&&"0123456789".indexOf(e.charAt(++s))>-1;)i+=e.charAt(s);a[a.length]={t:"D",v:i};break;case" ":a[a.length]={t:o,v:o},++s;break;case"$":a[a.length]={t:"t",v:"$"},++s;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(o)===-1)throw new Error("unrecognized character "+o+" in "+e);a[a.length]={t:"t",v:o},++s;break}var y=0,_=0,S;for(s=a.length-1,c="t";s>=0;--s)switch(a[s].t){case"h":case"H":a[s].t=p,c="h",y<1&&(y=1);break;case"s":(S=a[s].v.match(/\.0+$/))&&(_=Math.max(_,S[0].length-1),y=4),y<3&&(y=3);case"d":case"y":case"e":c=a[s].t;break;case"M":c=a[s].t,y<2&&(y=2);break;case"m":c==="s"&&(a[s].t="M",y<2&&(y=2));break;case"X":break;case"Z":y<1&&a[s].v.match(/[Hh]/)&&(y=1),y<2&&a[s].v.match(/[Mm]/)&&(y=2),y<3&&a[s].v.match(/[Ss]/)&&(y=3)}var k;switch(y){case 0:break;case 1:case 2:case 3:u.u>=.5&&(u.u=0,++u.S),u.S>=60&&(u.S=0,++u.M),u.M>=60&&(u.M=0,++u.H),u.H>=24&&(u.H=0,++u.D,k=Xi(u.D),k.u=u.u,k.S=u.S,k.M=u.M,k.H=u.H,u=k);break;case 4:switch(_){case 1:u.u=Math.round(u.u*10)/10;break;case 2:u.u=Math.round(u.u*100)/100;break;case 3:u.u=Math.round(u.u*1e3)/1e3;break}u.u>=1&&(u.u=0,++u.S),u.S>=60&&(u.S=0,++u.M),u.M>=60&&(u.M=0,++u.H),u.H>=24&&(u.H=0,++u.D,k=Xi(u.D),k.u=u.u,k.S=u.S,k.M=u.M,k.H=u.H,u=k);break}var E="",T;for(s=0;s<a.length;++s)switch(a[s].t){case"t":case"T":case" ":case"D":break;case"X":a[s].v="",a[s].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":a[s].v=vM(a[s].t.charCodeAt(0),a[s].v,u,_),a[s].t="t";break;case"n":case"?":for(T=s+1;a[T]!=null&&((o=a[T].t)==="?"||o==="D"||(o===" "||o==="t")&&a[T+1]!=null&&(a[T+1].t==="?"||a[T+1].t==="t"&&a[T+1].v==="/")||a[s].t==="("&&(o===" "||o==="n"||o===")")||o==="t"&&(a[T].v==="/"||a[T].v===" "&&a[T+1]!=null&&a[T+1].t=="?"));)a[s].v+=a[T].v,a[T]={v:"",t:";"},++T;E+=a[s].v,s=T-1;break;case"G":a[s].t="t",a[s].v=Lo(t,r);break}var N="",C,P;if(E.length>0){E.charCodeAt(0)==40?(C=t<0&&E.charCodeAt(0)===45?-t:t,P=Qi("n",E,C)):(C=t<0&&n>1?-t:t,P=Qi("n",E,C),C<0&&a[0]&&a[0].t=="t"&&(P=P.substr(1),a[0].v="-"+a[0].v)),T=P.length-1;var j=a.length;for(s=0;s<a.length;++s)if(a[s]!=null&&a[s].t!="t"&&a[s].v.indexOf(".")>-1){j=s;break}var R=a.length;if(j===a.length&&P.indexOf("E")===-1){for(s=a.length-1;s>=0;--s)a[s]==null||"n?".indexOf(a[s].t)===-1||(T>=a[s].v.length-1?(T-=a[s].v.length,a[s].v=P.substr(T+1,a[s].v.length)):T<0?a[s].v="":(a[s].v=P.substr(0,T+1),T=-1),a[s].t="t",R=s);T>=0&&R<a.length&&(a[R].v=P.substr(0,T+1)+a[R].v)}else if(j!==a.length&&P.indexOf("E")===-1){for(T=P.indexOf(".")-1,s=j;s>=0;--s)if(!(a[s]==null||"n?".indexOf(a[s].t)===-1)){for(d=a[s].v.indexOf(".")>-1&&s===j?a[s].v.indexOf(".")-1:a[s].v.length-1,N=a[s].v.substr(d+1);d>=0;--d)T>=0&&(a[s].v.charAt(d)==="0"||a[s].v.charAt(d)==="#")&&(N=P.charAt(T--)+N);a[s].v=N,a[s].t="t",R=s}for(T>=0&&R<a.length&&(a[R].v=P.substr(0,T+1)+a[R].v),T=P.indexOf(".")+1,s=j;s<a.length;++s)if(!(a[s]==null||"n?(".indexOf(a[s].t)===-1&&s!==j)){for(d=a[s].v.indexOf(".")>-1&&s===j?a[s].v.indexOf(".")+1:0,N=a[s].v.substr(0,d);d<a[s].v.length;++d)T<P.length&&(N+=P.charAt(T++));a[s].v=N,a[s].t="t",R=s}}}for(s=0;s<a.length;++s)a[s]!=null&&"n?".indexOf(a[s].t)>-1&&(C=n>1&&t<0&&s>0&&a[s-1].v==="-"?-t:t,a[s].v=Qi(a[s].t,a[s].v,C),a[s].t="t");var I="";for(s=0;s!==a.length;++s)a[s]!=null&&(I+=a[s].v);return I}var XE=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function GE(e,t){if(t==null)return!1;var r=parseFloat(t[2]);switch(t[1]){case"=":if(e==r)return!0;break;case">":if(e>r)return!0;break;case"<":if(e<r)return!0;break;case"<>":if(e!=r)return!0;break;case">=":if(e>=r)return!0;break;case"<=":if(e<=r)return!0;break}return!1}function AM(e,t){var r=EM(e),n=r.length,a=r[n-1].indexOf("@");if(n<4&&a>-1&&--n,r.length>4)throw new Error("cannot find right format for |"+r.join("|")+"|");if(typeof t!="number")return[4,r.length===4||a>-1?r[r.length-1]:"@"];switch(typeof t=="number"&&!isFinite(t)&&(t=0),r.length){case 1:r=a>-1?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=a>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=a>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"];break}var i=t>0?r[0]:t<0?r[1]:r[2];if(r[0].indexOf("[")===-1&&r[1].indexOf("[")===-1)return[n,i];if(r[0].match(/\[[=<>]/)!=null||r[1].match(/\[[=<>]/)!=null){var s=r[0].match(XE),o=r[1].match(XE);return GE(t,s)?[n,r[0]]:GE(t,o)?[n,r[1]]:[n,r[s!=null&&o!=null?2:1]]}return[n,i]}function ma(e,t,r){r==null&&(r={});var n="";switch(typeof e){case"string":e=="m/d/yy"&&r.dateNF?n=r.dateNF:n=e;break;case"number":e==14&&r.dateNF?n=r.dateNF:n=(r.table!=null?r.table:yt)[e],n==null&&(n=r.table&&r.table[HE[e]]||yt[HE[e]]),n==null&&(n=uM[e]||"General");break}if(th(n,0))return Lo(t,r);t instanceof Date&&(t=Or(t,r.date1904));var a=AM(n,t);if(th(a[1]))return Lo(t,r);if(t===!0)t="TRUE";else if(t===!1)t="FALSE";else{if(t===""||t==null)return"";if(isNaN(t)&&a[1].indexOf("0")>-1)return"#NUM!";if(!isFinite(t)&&a[1].indexOf("0")>-1)return"#DIV/0!"}return TM(a[1],t,r,a[0])}function x6(e,t){if(typeof t!="number"){t=+t||-1;for(var r=0;r<392;++r){if(yt[r]==null){t<0&&(t=r);continue}if(yt[r]==e){t=r;break}}t<0&&(t=391)}return yt[t]=e,t}function Zh(e){for(var t=0;t!=392;++t)e[t]!==void 0&&x6(e[t],t)}function dc(){yt=cM()}var CM={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},nh=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function OM(e){var t=typeof e=="number"?yt[e]:e;return t=t.replace(nh,"(\\d+)"),nh.lastIndex=0,new RegExp("^"+t+"$")}function NM(e,t,r){var n=-1,a=-1,i=-1,s=-1,o=-1,c=-1;(t.match(nh)||[]).forEach(function(h,p){var v=parseInt(r[p+1],10);switch(h.toLowerCase().charAt(0)){case"y":n=v;break;case"d":i=v;break;case"h":s=v;break;case"s":c=v;break;case"m":s>=0?o=v:a=v;break}}),nh.lastIndex=0,c>=0&&o==-1&&a>=0&&(o=a,a=-1);var u=(""+(n>=0?n:new Date().getFullYear())).slice(-4)+"-"+("00"+(a>=1?a:1)).slice(-2)+"-"+("00"+(i>=1?i:1)).slice(-2);u.length==7&&(u="0"+u),u.length==8&&(u="20"+u);var d=("00"+(s>=0?s:0)).slice(-2)+":"+("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(c>=0?c:0)).slice(-2);return s==-1&&o==-1&&c==-1?u:n==-1&&a==-1&&i==-1?d:u+"T"+d}var PM={"d.m":"d\\.m"};function zs(e,t){return x6(PM[e]||e,t)}var KE=(function(){var e={};e.version="1.2.0";function t(){for(var C=0,P=new Array(256),j=0;j!=256;++j)C=j,C=C&1?-306674912^C>>>1:C>>>1,C=C&1?-306674912^C>>>1:C>>>1,C=C&1?-306674912^C>>>1:C>>>1,C=C&1?-306674912^C>>>1:C>>>1,C=C&1?-306674912^C>>>1:C>>>1,C=C&1?-306674912^C>>>1:C>>>1,C=C&1?-306674912^C>>>1:C>>>1,C=C&1?-306674912^C>>>1:C>>>1,P[j]=C;return typeof Int32Array<"u"?new Int32Array(P):P}var r=t();function n(C){var P=0,j=0,R=0,I=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(R=0;R!=256;++R)I[R]=C[R];for(R=0;R!=256;++R)for(j=C[R],P=256+R;P<4096;P+=256)j=I[P]=j>>>8^C[j&255];var F=[];for(R=1;R!=16;++R)F[R-1]=typeof Int32Array<"u"&&typeof I.subarray=="function"?I.subarray(R*256,R*256+256):I.slice(R*256,R*256+256);return F}var a=n(r),i=a[0],s=a[1],o=a[2],c=a[3],u=a[4],d=a[5],h=a[6],p=a[7],v=a[8],x=a[9],w=a[10],y=a[11],_=a[12],S=a[13],k=a[14];function E(C,P){for(var j=P^-1,R=0,I=C.length;R<I;)j=j>>>8^r[(j^C.charCodeAt(R++))&255];return~j}function T(C,P){for(var j=P^-1,R=C.length-15,I=0;I<R;)j=k[C[I++]^j&255]^S[C[I++]^j>>8&255]^_[C[I++]^j>>16&255]^y[C[I++]^j>>>24]^w[C[I++]]^x[C[I++]]^v[C[I++]]^p[C[I++]]^h[C[I++]]^d[C[I++]]^u[C[I++]]^c[C[I++]]^o[C[I++]]^s[C[I++]]^i[C[I++]]^r[C[I++]];for(R+=15;I<R;)j=j>>>8^r[(j^C[I++])&255];return~j}function N(C,P){for(var j=P^-1,R=0,I=C.length,F=0,L=0;R<I;)F=C.charCodeAt(R++),F<128?j=j>>>8^r[(j^F)&255]:F<2048?(j=j>>>8^r[(j^(192|F>>6&31))&255],j=j>>>8^r[(j^(128|F&63))&255]):F>=55296&&F<57344?(F=(F&1023)+64,L=C.charCodeAt(R++)&1023,j=j>>>8^r[(j^(240|F>>8&7))&255],j=j>>>8^r[(j^(128|F>>2&63))&255],j=j>>>8^r[(j^(128|L>>6&15|(F&3)<<4))&255],j=j>>>8^r[(j^(128|L&63))&255]):(j=j>>>8^r[(j^(224|F>>12&15))&255],j=j>>>8^r[(j^(128|F>>6&63))&255],j=j>>>8^r[(j^(128|F&63))&255]);return~j}return e.table=r,e.bstr=E,e.buf=T,e.str=N,e})(),wt=(function(){var t={};t.version="1.2.2";function r(U,re){for(var K=U.split("/"),Y=re.split("/"),ne=0,ae=0,ge=Math.min(K.length,Y.length);ne<ge;++ne){if(ae=K[ne].length-Y[ne].length)return ae;if(K[ne]!=Y[ne])return K[ne]<Y[ne]?-1:1}return K.length-Y.length}function n(U){if(U.charAt(U.length-1)=="/")return U.slice(0,-1).indexOf("/")===-1?U:n(U.slice(0,-1));var re=U.lastIndexOf("/");return re===-1?U:U.slice(0,re+1)}function a(U){if(U.charAt(U.length-1)=="/")return a(U.slice(0,-1));var re=U.lastIndexOf("/");return re===-1?U:U.slice(re+1)}function i(U,re){typeof re=="string"&&(re=new Date(re));var K=re.getHours();K=K<<6|re.getMinutes(),K=K<<5|re.getSeconds()>>>1,U.write_shift(2,K);var Y=re.getFullYear()-1980;Y=Y<<4|re.getMonth()+1,Y=Y<<5|re.getDate(),U.write_shift(2,Y)}function s(U){var re=U.read_shift(2)&65535,K=U.read_shift(2)&65535,Y=new Date,ne=K&31;K>>>=5;var ae=K&15;K>>>=4,Y.setMilliseconds(0),Y.setFullYear(K+1980),Y.setMonth(ae-1),Y.setDate(ne);var ge=re&31;re>>>=5;var Pe=re&63;return re>>>=6,Y.setHours(re),Y.setMinutes(Pe),Y.setSeconds(ge<<1),Y}function o(U){Yr(U,0);for(var re={},K=0;U.l<=U.length-4;){var Y=U.read_shift(2),ne=U.read_shift(2),ae=U.l+ne,ge={};switch(Y){case 21589:K=U.read_shift(1),K&1&&(ge.mtime=U.read_shift(4)),ne>5&&(K&2&&(ge.atime=U.read_shift(4)),K&4&&(ge.ctime=U.read_shift(4))),ge.mtime&&(ge.mt=new Date(ge.mtime*1e3));break;case 1:{var Pe=U.read_shift(4),we=U.read_shift(4);ge.usz=we*Math.pow(2,32)+Pe,Pe=U.read_shift(4),we=U.read_shift(4),ge.csz=we*Math.pow(2,32)+Pe}break}U.l=ae,re[Y]=ge}return re}var c;function u(){return c||(c=IM)}function d(U,re){if(U[0]==80&&U[1]==75)return xa(U,re);if((U[0]|32)==109&&(U[1]|32)==105)return pt(U,re);if(U.length<512)throw new Error("CFB file size "+U.length+" < 512");var K=3,Y=512,ne=0,ae=0,ge=0,Pe=0,we=0,_e=[],Se=U.slice(0,512);Yr(Se,0);var He=h(Se);switch(K=He[0],K){case 3:Y=512;break;case 4:Y=4096;break;case 0:if(He[1]==0)return xa(U,re);default:throw new Error("Major Version: Expected 3 or 4 saw "+K)}Y!==512&&(Se=U.slice(0,Y),Yr(Se,28));var Je=U.slice(0,Y);p(Se,K);var st=Se.read_shift(4,"i");if(K===3&&st!==0)throw new Error("# Directory Sectors: Expected 0 saw "+st);Se.l+=4,ge=Se.read_shift(4,"i"),Se.l+=4,Se.chk("00100000","Mini Stream Cutoff Size: "),Pe=Se.read_shift(4,"i"),ne=Se.read_shift(4,"i"),we=Se.read_shift(4,"i"),ae=Se.read_shift(4,"i");for(var Ve=-1,$e=0;$e<109&&(Ve=Se.read_shift(4,"i"),!(Ve<0));++$e)_e[$e]=Ve;var At=v(U,Y);y(we,ae,At,Y,_e);var ur=S(At,ge,_e,Y);ge<ur.length&&(ur[ge].name="!Directory"),ne>0&&Pe!==L&&(ur[Pe].name="!MiniFAT"),ur[_e[0]].name="!FAT",ur.fat_addrs=_e,ur.ssz=Y;var mr={},Dr=[],ro=[],gs=[];k(ge,ur,At,Dr,ne,mr,ro,Pe),x(ro,gs,Dr),Dr.shift();var hi={FileIndex:ro,FullPaths:gs};return re&&re.raw&&(hi.raw={header:Je,sectors:At}),hi}function h(U){if(U[U.l]==80&&U[U.l+1]==75)return[0,0];U.chk(H,"Header Signature: "),U.l+=16;var re=U.read_shift(2,"u");return[U.read_shift(2,"u"),re]}function p(U,re){var K=9;switch(U.l+=2,K=U.read_shift(2)){case 9:if(re!=3)throw new Error("Sector Shift: Expected 9 saw "+K);break;case 12:if(re!=4)throw new Error("Sector Shift: Expected 12 saw "+K);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+K)}U.chk("0600","Mini Sector Shift: "),U.chk("000000000000","Reserved: ")}function v(U,re){for(var K=Math.ceil(U.length/re)-1,Y=[],ne=1;ne<K;++ne)Y[ne-1]=U.slice(ne*re,(ne+1)*re);return Y[K-1]=U.slice(K*re),Y}function x(U,re,K){for(var Y=0,ne=0,ae=0,ge=0,Pe=0,we=K.length,_e=[],Se=[];Y<we;++Y)_e[Y]=Se[Y]=Y,re[Y]=K[Y];for(;Pe<Se.length;++Pe)Y=Se[Pe],ne=U[Y].L,ae=U[Y].R,ge=U[Y].C,_e[Y]===Y&&(ne!==-1&&_e[ne]!==ne&&(_e[Y]=_e[ne]),ae!==-1&&_e[ae]!==ae&&(_e[Y]=_e[ae])),ge!==-1&&(_e[ge]=Y),ne!==-1&&Y!=_e[Y]&&(_e[ne]=_e[Y],Se.lastIndexOf(ne)<Pe&&Se.push(ne)),ae!==-1&&Y!=_e[Y]&&(_e[ae]=_e[Y],Se.lastIndexOf(ae)<Pe&&Se.push(ae));for(Y=1;Y<we;++Y)_e[Y]===Y&&(ae!==-1&&_e[ae]!==ae?_e[Y]=_e[ae]:ne!==-1&&_e[ne]!==ne&&(_e[Y]=_e[ne]));for(Y=1;Y<we;++Y)if(U[Y].type!==0){if(Pe=Y,Pe!=_e[Pe])do Pe=_e[Pe],re[Y]=re[Pe]+"/"+re[Y];while(Pe!==0&&_e[Pe]!==-1&&Pe!=_e[Pe]);_e[Y]=-1}for(re[0]+="/",Y=1;Y<we;++Y)U[Y].type!==2&&(re[Y]+="/")}function w(U,re,K){for(var Y=U.start,ne=U.size,ae=[],ge=Y;K&&ne>0&&ge>=0;)ae.push(re.slice(ge*F,ge*F+F)),ne-=F,ge=So(K,ge*4);return ae.length===0?be(0):Lr(ae).slice(0,U.size)}function y(U,re,K,Y,ne){var ae=L;if(U===L){if(re!==0)throw new Error("DIFAT chain shorter than expected")}else if(U!==-1){var ge=K[U],Pe=(Y>>>2)-1;if(!ge)return;for(var we=0;we<Pe&&(ae=So(ge,we*4))!==L;++we)ne.push(ae);re>=1&&y(So(ge,Y-4),re-1,K,Y,ne)}}function _(U,re,K,Y,ne){var ae=[],ge=[];ne||(ne=[]);var Pe=Y-1,we=0,_e=0;for(we=re;we>=0;){ne[we]=!0,ae[ae.length]=we,ge.push(U[we]);var Se=K[Math.floor(we*4/Y)];if(_e=we*4&Pe,Y<4+_e)throw new Error("FAT boundary crossed: "+we+" 4 "+Y);if(!U[Se])break;we=So(U[Se],_e)}return{nodes:ae,data:s4([ge])}}function S(U,re,K,Y){var ne=U.length,ae=[],ge=[],Pe=[],we=[],_e=Y-1,Se=0,He=0,Je=0,st=0;for(Se=0;Se<ne;++Se)if(Pe=[],Je=Se+re,Je>=ne&&(Je-=ne),!ge[Je]){we=[];var Ve=[];for(He=Je;He>=0;){Ve[He]=!0,ge[He]=!0,Pe[Pe.length]=He,we.push(U[He]);var $e=K[Math.floor(He*4/Y)];if(st=He*4&_e,Y<4+st)throw new Error("FAT boundary crossed: "+He+" 4 "+Y);if(!U[$e]||(He=So(U[$e],st),Ve[He]))break}ae[Je]={nodes:Pe,data:s4([we])}}return ae}function k(U,re,K,Y,ne,ae,ge,Pe){for(var we=0,_e=Y.length?2:0,Se=re[U].data,He=0,Je=0,st;He<Se.length;He+=128){var Ve=Se.slice(He,He+128);Yr(Ve,64),Je=Ve.read_shift(2),st=db(Ve,0,Je-_e),Y.push(st);var $e={name:st,type:Ve.read_shift(1),color:Ve.read_shift(1),L:Ve.read_shift(4,"i"),R:Ve.read_shift(4,"i"),C:Ve.read_shift(4,"i"),clsid:Ve.read_shift(16),state:Ve.read_shift(4,"i"),start:0,size:0},At=Ve.read_shift(2)+Ve.read_shift(2)+Ve.read_shift(2)+Ve.read_shift(2);At!==0&&($e.ct=E(Ve,Ve.l-8));var ur=Ve.read_shift(2)+Ve.read_shift(2)+Ve.read_shift(2)+Ve.read_shift(2);ur!==0&&($e.mt=E(Ve,Ve.l-8)),$e.start=Ve.read_shift(4,"i"),$e.size=Ve.read_shift(4,"i"),$e.size<0&&$e.start<0&&($e.size=$e.type=0,$e.start=L,$e.name=""),$e.type===5?(we=$e.start,ne>0&&we!==L&&(re[we].name="!StreamData")):$e.size>=4096?($e.storage="fat",re[$e.start]===void 0&&(re[$e.start]=_(K,$e.start,re.fat_addrs,re.ssz)),re[$e.start].name=$e.name,$e.content=re[$e.start].data.slice(0,$e.size)):($e.storage="minifat",$e.size<0?$e.size=0:we!==L&&$e.start!==L&&re[we]&&($e.content=w($e,re[we].data,(re[Pe]||{}).data))),$e.content&&Yr($e.content,0),ae[st]=$e,ge.push($e)}}function E(U,re){return new Date((ca(U,re+4)/1e7*Math.pow(2,32)+ca(U,re)/1e7-11644473600)*1e3)}function T(U,re){return u(),d(c.readFileSync(U),re)}function N(U,re){var K=re&&re.type;switch(K||It&&Buffer.isBuffer(U)&&(K="buffer"),K||"base64"){case"file":return T(U,re);case"base64":return d(zn(pa(U)),re);case"binary":return d(zn(U),re)}return d(U,re)}function C(U,re){var K=re||{},Y=K.root||"Root Entry";if(U.FullPaths||(U.FullPaths=[]),U.FileIndex||(U.FileIndex=[]),U.FullPaths.length!==U.FileIndex.length)throw new Error("inconsistent CFB structure");U.FullPaths.length===0&&(U.FullPaths[0]=Y+"/",U.FileIndex[0]={name:Y,type:5}),K.CLSID&&(U.FileIndex[0].clsid=K.CLSID),P(U)}function P(U){var re="Sh33tJ5";if(!wt.find(U,"/"+re)){var K=be(4);K[0]=55,K[1]=K[3]=50,K[2]=54,U.FileIndex.push({name:re,type:2,content:K,size:4,L:69,R:69,C:69}),U.FullPaths.push(U.FullPaths[0]+re),j(U)}}function j(U,re){C(U);for(var K=!1,Y=!1,ne=U.FullPaths.length-1;ne>=0;--ne){var ae=U.FileIndex[ne];switch(ae.type){case 0:Y?K=!0:(U.FileIndex.pop(),U.FullPaths.pop());break;case 1:case 2:case 5:Y=!0,isNaN(ae.R*ae.L*ae.C)&&(K=!0),ae.R>-1&&ae.L>-1&&ae.R==ae.L&&(K=!0);break;default:K=!0;break}}if(!(!K&&!re)){var ge=new Date(1987,1,19),Pe=0,we=Object.create?Object.create(null):{},_e=[];for(ne=0;ne<U.FullPaths.length;++ne)we[U.FullPaths[ne]]=!0,U.FileIndex[ne].type!==0&&_e.push([U.FullPaths[ne],U.FileIndex[ne]]);for(ne=0;ne<_e.length;++ne){var Se=n(_e[ne][0]);for(Y=we[Se];!Y;){for(;n(Se)&&!we[n(Se)];)Se=n(Se);_e.push([Se,{name:a(Se).replace("/",""),type:1,clsid:J,ct:ge,mt:ge,content:null}]),we[Se]=!0,Se=n(_e[ne][0]),Y=we[Se]}}for(_e.sort(function(st,Ve){return r(st[0],Ve[0])}),U.FullPaths=[],U.FileIndex=[],ne=0;ne<_e.length;++ne)U.FullPaths[ne]=_e[ne][0],U.FileIndex[ne]=_e[ne][1];for(ne=0;ne<_e.length;++ne){var He=U.FileIndex[ne],Je=U.FullPaths[ne];if(He.name=a(Je).replace("/",""),He.L=He.R=He.C=-(He.color=1),He.size=He.content?He.content.length:0,He.start=0,He.clsid=He.clsid||J,ne===0)He.C=_e.length>1?1:-1,He.size=0,He.type=5;else if(Je.slice(-1)=="/"){for(Pe=ne+1;Pe<_e.length&&n(U.FullPaths[Pe])!=Je;++Pe);for(He.C=Pe>=_e.length?-1:Pe,Pe=ne+1;Pe<_e.length&&n(U.FullPaths[Pe])!=n(Je);++Pe);He.R=Pe>=_e.length?-1:Pe,He.type=1}else n(U.FullPaths[ne+1]||"")==n(Je)&&(He.R=ne+1),He.type=2}}}function R(U,re){var K=re||{};if(K.fileType=="mad")return Dt(U,K);switch(j(U),K.fileType){case"zip":return wa(U,K)}var Y=(function(st){for(var Ve=0,$e=0,At=0;At<st.FileIndex.length;++At){var ur=st.FileIndex[At];if(ur.content){var mr=ur.content.length;mr>0&&(mr<4096?Ve+=mr+63>>6:$e+=mr+511>>9)}}for(var Dr=st.FullPaths.length+3>>2,ro=Ve+7>>3,gs=Ve+127>>7,hi=ro+$e+Dr+gs,nn=hi+127>>7,bc=nn<=109?0:Math.ceil((nn-109)/127);hi+nn+bc+127>>7>nn;)bc=++nn<=109?0:Math.ceil((nn-109)/127);var jr=[1,bc,nn,gs,Dr,$e,Ve,0];return st.FileIndex[0].size=Ve<<6,jr[7]=(st.FileIndex[0].start=jr[0]+jr[1]+jr[2]+jr[3]+jr[4]+jr[5])+(jr[6]+7>>3),jr})(U),ne=be(Y[7]<<9),ae=0,ge=0;{for(ae=0;ae<8;++ae)ne.write_shift(1,V[ae]);for(ae=0;ae<8;++ae)ne.write_shift(2,0);for(ne.write_shift(2,62),ne.write_shift(2,3),ne.write_shift(2,65534),ne.write_shift(2,9),ne.write_shift(2,6),ae=0;ae<3;++ae)ne.write_shift(2,0);for(ne.write_shift(4,0),ne.write_shift(4,Y[2]),ne.write_shift(4,Y[0]+Y[1]+Y[2]+Y[3]-1),ne.write_shift(4,0),ne.write_shift(4,4096),ne.write_shift(4,Y[3]?Y[0]+Y[1]+Y[2]-1:L),ne.write_shift(4,Y[3]),ne.write_shift(-4,Y[1]?Y[0]-1:L),ne.write_shift(4,Y[1]),ae=0;ae<109;++ae)ne.write_shift(-4,ae<Y[2]?Y[1]+ae:-1)}if(Y[1])for(ge=0;ge<Y[1];++ge){for(;ae<236+ge*127;++ae)ne.write_shift(-4,ae<Y[2]?Y[1]+ae:-1);ne.write_shift(-4,ge===Y[1]-1?L:ge+1)}var Pe=function(st){for(ge+=st;ae<ge-1;++ae)ne.write_shift(-4,ae+1);st&&(++ae,ne.write_shift(-4,L))};for(ge=ae=0,ge+=Y[1];ae<ge;++ae)ne.write_shift(-4,te.DIFSECT);for(ge+=Y[2];ae<ge;++ae)ne.write_shift(-4,te.FATSECT);Pe(Y[3]),Pe(Y[4]);for(var we=0,_e=0,Se=U.FileIndex[0];we<U.FileIndex.length;++we)Se=U.FileIndex[we],Se.content&&(_e=Se.content.length,!(_e<4096)&&(Se.start=ge,Pe(_e+511>>9)));for(Pe(Y[6]+7>>3);ne.l&511;)ne.write_shift(-4,te.ENDOFCHAIN);for(ge=ae=0,we=0;we<U.FileIndex.length;++we)Se=U.FileIndex[we],Se.content&&(_e=Se.content.length,!(!_e||_e>=4096)&&(Se.start=ge,Pe(_e+63>>6)));for(;ne.l&511;)ne.write_shift(-4,te.ENDOFCHAIN);for(ae=0;ae<Y[4]<<2;++ae){var He=U.FullPaths[ae];if(!He||He.length===0){for(we=0;we<17;++we)ne.write_shift(4,0);for(we=0;we<3;++we)ne.write_shift(4,-1);for(we=0;we<12;++we)ne.write_shift(4,0);continue}Se=U.FileIndex[ae],ae===0&&(Se.start=Se.size?Se.start-1:L);var Je=ae===0&&K.root||Se.name;if(Je.length>31&&(console.error("Name "+Je+" will be truncated to "+Je.slice(0,31)),Je=Je.slice(0,31)),_e=2*(Je.length+1),ne.write_shift(64,Je,"utf16le"),ne.write_shift(2,_e),ne.write_shift(1,Se.type),ne.write_shift(1,Se.color),ne.write_shift(-4,Se.L),ne.write_shift(-4,Se.R),ne.write_shift(-4,Se.C),Se.clsid)ne.write_shift(16,Se.clsid,"hex");else for(we=0;we<4;++we)ne.write_shift(4,0);ne.write_shift(4,Se.state||0),ne.write_shift(4,0),ne.write_shift(4,0),ne.write_shift(4,0),ne.write_shift(4,0),ne.write_shift(4,Se.start),ne.write_shift(4,Se.size),ne.write_shift(4,0)}for(ae=1;ae<U.FileIndex.length;++ae)if(Se=U.FileIndex[ae],Se.size>=4096)if(ne.l=Se.start+1<<9,It&&Buffer.isBuffer(Se.content))Se.content.copy(ne,ne.l,0,Se.size),ne.l+=Se.size+511&-512;else{for(we=0;we<Se.size;++we)ne.write_shift(1,Se.content[we]);for(;we&511;++we)ne.write_shift(1,0)}for(ae=1;ae<U.FileIndex.length;++ae)if(Se=U.FileIndex[ae],Se.size>0&&Se.size<4096)if(It&&Buffer.isBuffer(Se.content))Se.content.copy(ne,ne.l,0,Se.size),ne.l+=Se.size+63&-64;else{for(we=0;we<Se.size;++we)ne.write_shift(1,Se.content[we]);for(;we&63;++we)ne.write_shift(1,0)}if(It)ne.l=ne.length;else for(;ne.l<ne.length;)ne.write_shift(1,0);return ne}function I(U,re){var K=U.FullPaths.map(function(we){return we.toUpperCase()}),Y=K.map(function(we){var _e=we.split("/");return _e[_e.length-(we.slice(-1)=="/"?2:1)]}),ne=!1;re.charCodeAt(0)===47?(ne=!0,re=K[0].slice(0,-1)+re):ne=re.indexOf("/")!==-1;var ae=re.toUpperCase(),ge=ne===!0?K.indexOf(ae):Y.indexOf(ae);if(ge!==-1)return U.FileIndex[ge];var Pe=!ae.match(hu);for(ae=ae.replace(ta,""),Pe&&(ae=ae.replace(hu,"!")),ge=0;ge<K.length;++ge)if((Pe?K[ge].replace(hu,"!"):K[ge]).replace(ta,"")==ae||(Pe?Y[ge].replace(hu,"!"):Y[ge]).replace(ta,"")==ae)return U.FileIndex[ge];return null}var F=64,L=-2,H="d0cf11e0a1b11ae1",V=[208,207,17,224,161,177,26,225],J="00000000000000000000000000000000",te={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:L,FREESECT:-1,HEADER_SIGNATURE:H,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:J,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function q(U,re,K){u();var Y=R(U,K);c.writeFileSync(re,Y)}function oe(U){for(var re=new Array(U.length),K=0;K<U.length;++K)re[K]=String.fromCharCode(U[K]);return re.join("")}function Q(U,re){var K=R(U,re);switch(re&&re.type||"buffer"){case"file":return u(),c.writeFileSync(re.filename,K),K;case"binary":return typeof K=="string"?K:oe(K);case"base64":return Jd(typeof K=="string"?K:oe(K));case"buffer":if(It)return Buffer.isBuffer(K)?K:Fi(K);case"array":return typeof K=="string"?zn(K):K}return K}var Z;function ee(U){try{var re=U.InflateRaw,K=new re;if(K._processChunk(new Uint8Array([3,0]),K._finishFlushFlag),K.bytesRead)Z=U;else throw new Error("zlib does not expose bytesRead")}catch(Y){console.error("cannot use native zlib: "+(Y.message||Y))}}function ce(U,re){if(!Z)return ga(U,re);var K=Z.InflateRaw,Y=new K,ne=Y._processChunk(U.slice(U.l),Y._finishFlushFlag);return U.l+=Y.bytesRead,ne}function de(U){return Z?Z.deflateRawSync(U):kt(U)}var Te=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],Ie=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],Ne=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function W(U){var re=(U<<1|U<<11)&139536|(U<<5|U<<15)&558144;return(re>>16|re>>8|re)&255}for(var z=typeof Uint8Array<"u",G=z?new Uint8Array(256):[],X=0;X<256;++X)G[X]=W(X);function ie(U,re){var K=G[U&255];return re<=8?K>>>8-re:(K=K<<8|G[U>>8&255],re<=16?K>>>16-re:(K=K<<8|G[U>>16&255],K>>>24-re))}function M(U,re){var K=re&7,Y=re>>>3;return(U[Y]|(K<=6?0:U[Y+1]<<8))>>>K&3}function le(U,re){var K=re&7,Y=re>>>3;return(U[Y]|(K<=5?0:U[Y+1]<<8))>>>K&7}function ye(U,re){var K=re&7,Y=re>>>3;return(U[Y]|(K<=4?0:U[Y+1]<<8))>>>K&15}function Ce(U,re){var K=re&7,Y=re>>>3;return(U[Y]|(K<=3?0:U[Y+1]<<8))>>>K&31}function ze(U,re){var K=re&7,Y=re>>>3;return(U[Y]|(K<=1?0:U[Y+1]<<8))>>>K&127}function Ze(U,re,K){var Y=re&7,ne=re>>>3,ae=(1<<K)-1,ge=U[ne]>>>Y;return K<8-Y||(ge|=U[ne+1]<<8-Y,K<16-Y)||(ge|=U[ne+2]<<16-Y,K<24-Y)||(ge|=U[ne+3]<<24-Y),ge&ae}function rt(U,re,K){var Y=re&7,ne=re>>>3;return Y<=5?U[ne]|=(K&7)<<Y:(U[ne]|=K<<Y&255,U[ne+1]=(K&7)>>8-Y),re+3}function xt(U,re,K){var Y=re&7,ne=re>>>3;return K=(K&1)<<Y,U[ne]|=K,re+1}function mt(U,re,K){var Y=re&7,ne=re>>>3;return K<<=Y,U[ne]|=K&255,K>>>=8,U[ne+1]=K,re+8}function Ee(U,re,K){var Y=re&7,ne=re>>>3;return K<<=Y,U[ne]|=K&255,K>>>=8,U[ne+1]=K&255,U[ne+2]=K>>>8,re+16}function ve(U,re){var K=U.length,Y=2*K>re?2*K:re+5,ne=0;if(K>=re)return U;if(It){var ae=UE(Y);if(U.copy)U.copy(ae);else for(;ne<U.length;++ne)ae[ne]=U[ne];return ae}else if(z){var ge=new Uint8Array(Y);if(ge.set)ge.set(U);else for(;ne<K;++ne)ge[ne]=U[ne];return ge}return U.length=Y,U}function fe(U){for(var re=new Array(U),K=0;K<U;++K)re[K]=0;return re}function pe(U,re,K){var Y=1,ne=0,ae=0,ge=0,Pe=0,we=U.length,_e=z?new Uint16Array(32):fe(32);for(ae=0;ae<32;++ae)_e[ae]=0;for(ae=we;ae<K;++ae)U[ae]=0;we=U.length;var Se=z?new Uint16Array(we):fe(we);for(ae=0;ae<we;++ae)_e[ne=U[ae]]++,Y<ne&&(Y=ne),Se[ae]=0;for(_e[0]=0,ae=1;ae<=Y;++ae)_e[ae+16]=Pe=Pe+_e[ae-1]<<1;for(ae=0;ae<we;++ae)Pe=U[ae],Pe!=0&&(Se[ae]=_e[Pe+16]++);var He=0;for(ae=0;ae<we;++ae)if(He=U[ae],He!=0)for(Pe=ie(Se[ae],Y)>>Y-He,ge=(1<<Y+4-He)-1;ge>=0;--ge)re[Pe|ge<<He]=He&15|ae<<4;return Y}var nt=z?new Uint16Array(512):fe(512),De=z?new Uint16Array(32):fe(32);if(!z){for(var Oe=0;Oe<512;++Oe)nt[Oe]=0;for(Oe=0;Oe<32;++Oe)De[Oe]=0}(function(){for(var U=[],re=0;re<32;re++)U.push(5);pe(U,De,32);var K=[];for(re=0;re<=143;re++)K.push(8);for(;re<=255;re++)K.push(9);for(;re<=279;re++)K.push(7);for(;re<=287;re++)K.push(8);pe(K,nt,288)})();var Qe=(function(){for(var re=z?new Uint8Array(32768):[],K=0,Y=0;K<Ne.length-1;++K)for(;Y<Ne[K+1];++Y)re[Y]=K;for(;Y<32768;++Y)re[Y]=29;var ne=z?new Uint8Array(259):[];for(K=0,Y=0;K<Ie.length-1;++K)for(;Y<Ie[K+1];++Y)ne[Y]=K;function ae(Pe,we){for(var _e=0;_e<Pe.length;){var Se=Math.min(65535,Pe.length-_e),He=_e+Se==Pe.length;for(we.write_shift(1,+He),we.write_shift(2,Se),we.write_shift(2,~Se&65535);Se-- >0;)we[we.l++]=Pe[_e++]}return we.l}function ge(Pe,we){for(var _e=0,Se=0,He=z?new Uint16Array(32768):[];Se<Pe.length;){var Je=Math.min(65535,Pe.length-Se);if(Je<10){for(_e=rt(we,_e,+(Se+Je==Pe.length)),_e&7&&(_e+=8-(_e&7)),we.l=_e/8|0,we.write_shift(2,Je),we.write_shift(2,~Je&65535);Je-- >0;)we[we.l++]=Pe[Se++];_e=we.l*8;continue}_e=rt(we,_e,+(Se+Je==Pe.length)+2);for(var st=0;Je-- >0;){var Ve=Pe[Se];st=(st<<5^Ve)&32767;var $e=-1,At=0;if(($e=He[st])&&($e|=Se&-32768,$e>Se&&($e-=32768),$e<Se))for(;Pe[$e+At]==Pe[Se+At]&&At<250;)++At;if(At>2){Ve=ne[At],Ve<=22?_e=mt(we,_e,G[Ve+1]>>1)-1:(mt(we,_e,3),_e+=5,mt(we,_e,G[Ve-23]>>5),_e+=3);var ur=Ve<8?0:Ve-4>>2;ur>0&&(Ee(we,_e,At-Ie[Ve]),_e+=ur),Ve=re[Se-$e],_e=mt(we,_e,G[Ve]>>3),_e-=3;var mr=Ve<4?0:Ve-2>>1;mr>0&&(Ee(we,_e,Se-$e-Ne[Ve]),_e+=mr);for(var Dr=0;Dr<At;++Dr)He[st]=Se&32767,st=(st<<5^Pe[Se])&32767,++Se;Je-=At-1}else Ve<=143?Ve=Ve+48:_e=xt(we,_e,1),_e=mt(we,_e,G[Ve]),He[st]=Se&32767,++Se}_e=mt(we,_e,0)-1}return we.l=(_e+7)/8|0,we.l}return function(we,_e){return we.length<8?ae(we,_e):ge(we,_e)}})();function kt(U){var re=be(50+Math.floor(U.length*1.1)),K=Qe(U,re);return re.slice(0,K)}var Re=z?new Uint16Array(32768):fe(32768),at=z?new Uint16Array(32768):fe(32768),bt=z?new Uint16Array(128):fe(128),Yt=1,mn=1;function Mn(U,re){var K=Ce(U,re)+257;re+=5;var Y=Ce(U,re)+1;re+=5;var ne=ye(U,re)+4;re+=4;for(var ae=0,ge=z?new Uint8Array(19):fe(19),Pe=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],we=1,_e=z?new Uint8Array(8):fe(8),Se=z?new Uint8Array(8):fe(8),He=ge.length,Je=0;Je<ne;++Je)ge[Te[Je]]=ae=le(U,re),we<ae&&(we=ae),_e[ae]++,re+=3;var st=0;for(_e[0]=0,Je=1;Je<=we;++Je)Se[Je]=st=st+_e[Je-1]<<1;for(Je=0;Je<He;++Je)(st=ge[Je])!=0&&(Pe[Je]=Se[st]++);var Ve=0;for(Je=0;Je<He;++Je)if(Ve=ge[Je],Ve!=0){st=G[Pe[Je]]>>8-Ve;for(var $e=(1<<7-Ve)-1;$e>=0;--$e)bt[st|$e<<Ve]=Ve&7|Je<<3}var At=[];for(we=1;At.length<K+Y;)switch(st=bt[ze(U,re)],re+=st&7,st>>>=3){case 16:for(ae=3+M(U,re),re+=2,st=At[At.length-1];ae-- >0;)At.push(st);break;case 17:for(ae=3+le(U,re),re+=3;ae-- >0;)At.push(0);break;case 18:for(ae=11+ze(U,re),re+=7;ae-- >0;)At.push(0);break;default:At.push(st),we<st&&(we=st);break}var ur=At.slice(0,K),mr=At.slice(K);for(Je=K;Je<286;++Je)ur[Je]=0;for(Je=Y;Je<30;++Je)mr[Je]=0;return Yt=pe(ur,Re,286),mn=pe(mr,at,30),re}function va(U,re){if(U[0]==3&&!(U[1]&3))return[Hs(re),2];for(var K=0,Y=0,ne=UE(re||1<<18),ae=0,ge=ne.length>>>0,Pe=0,we=0;(Y&1)==0;){if(Y=le(U,K),K+=3,Y>>>1)Y>>1==1?(Pe=9,we=5):(K=Mn(U,K),Pe=Yt,we=mn);else{K&7&&(K+=8-(K&7));var _e=U[K>>>3]|U[(K>>>3)+1]<<8;if(K+=32,_e>0)for(!re&&ge<ae+_e&&(ne=ve(ne,ae+_e),ge=ne.length);_e-- >0;)ne[ae++]=U[K>>>3],K+=8;continue}for(;;){!re&&ge<ae+32767&&(ne=ve(ne,ae+32767),ge=ne.length);var Se=Ze(U,K,Pe),He=Y>>>1==1?nt[Se]:Re[Se];if(K+=He&15,He>>>=4,(He>>>8&255)===0)ne[ae++]=He;else{if(He==256)break;He-=257;var Je=He<8?0:He-4>>2;Je>5&&(Je=0);var st=ae+Ie[He];Je>0&&(st+=Ze(U,K,Je),K+=Je),Se=Ze(U,K,we),He=Y>>>1==1?De[Se]:at[Se],K+=He&15,He>>>=4;var Ve=He<4?0:He-2>>1,$e=Ne[He];for(Ve>0&&($e+=Ze(U,K,Ve),K+=Ve),!re&&ge<st&&(ne=ve(ne,st+100),ge=ne.length);ae<st;)ne[ae]=ne[ae-$e],++ae}}}return re?[ne,K+7>>>3]:[ne.slice(0,ae),K+7>>>3]}function ga(U,re){var K=U.slice(U.l||0),Y=va(K,re);return U.l+=Y[1],Y[0]}function Vr(U,re){if(U)typeof console<"u"&&console.error(re);else throw new Error(re)}function xa(U,re){var K=U;Yr(K,0);var Y=[],ne=[],ae={FileIndex:Y,FullPaths:ne};C(ae,{root:re.root});for(var ge=K.length-4;(K[ge]!=80||K[ge+1]!=75||K[ge+2]!=5||K[ge+3]!=6)&&ge>=0;)--ge;K.l=ge+4,K.l+=4;var Pe=K.read_shift(2);K.l+=6;var we=K.read_shift(4);for(K.l=we,ge=0;ge<Pe;++ge){K.l+=20;var _e=K.read_shift(4),Se=K.read_shift(4),He=K.read_shift(2),Je=K.read_shift(2),st=K.read_shift(2);K.l+=8;var Ve=K.read_shift(4),$e=o(K.slice(K.l+He,K.l+He+Je));K.l+=He+Je+st;var At=K.l;K.l=Ve+4,$e&&$e[1]&&(($e[1]||{}).usz&&(Se=$e[1].usz),($e[1]||{}).csz&&(_e=$e[1].csz)),ya(K,_e,Se,ae,$e),K.l=At}return ae}function ya(U,re,K,Y,ne){U.l+=2;var ae=U.read_shift(2),ge=U.read_shift(2),Pe=s(U);if(ae&8257)throw new Error("Unsupported ZIP encryption");for(var we=U.read_shift(4),_e=U.read_shift(4),Se=U.read_shift(4),He=U.read_shift(2),Je=U.read_shift(2),st="",Ve=0;Ve<He;++Ve)st+=String.fromCharCode(U[U.l++]);if(Je){var $e=o(U.slice(U.l,U.l+Je));($e[21589]||{}).mt&&(Pe=$e[21589].mt),($e[1]||{}).usz&&(Se=$e[1].usz),($e[1]||{}).csz&&(_e=$e[1].csz),ne&&((ne[21589]||{}).mt&&(Pe=ne[21589].mt),(ne[1]||{}).usz&&(Se=ne[1].usz),(ne[1]||{}).csz&&(_e=ne[1].csz))}U.l+=Je;var At=U.slice(U.l,U.l+_e);switch(ge){case 8:At=ce(U,Se);break;case 0:U.l+=_e;break;default:throw new Error("Unsupported ZIP Compression method "+ge)}var ur=!1;ae&8&&(we=U.read_shift(4),we==134695760&&(we=U.read_shift(4),ur=!0),_e=U.read_shift(4),Se=U.read_shift(4)),_e!=re&&Vr(ur,"Bad compressed size: "+re+" != "+_e),Se!=K&&Vr(ur,"Bad uncompressed size: "+K+" != "+Se),Nr(Y,st,At,{unsafe:!0,mt:Pe})}function wa(U,re){var K=re||{},Y=[],ne=[],ae=be(1),ge=K.compression?8:0,Pe=0,we=0,_e=0,Se=0,He=0,Je=U.FullPaths[0],st=Je,Ve=U.FileIndex[0],$e=[],At=0;for(we=1;we<U.FullPaths.length;++we)if(st=U.FullPaths[we].slice(Je.length),Ve=U.FileIndex[we],!(!Ve.size||!Ve.content||Array.isArray(Ve.content)&&Ve.content.length==0||st=="Sh33tJ5")){var ur=Se,mr=be(st.length);for(_e=0;_e<st.length;++_e)mr.write_shift(1,st.charCodeAt(_e)&127);mr=mr.slice(0,mr.l),$e[He]=typeof Ve.content=="string"?KE.bstr(Ve.content,0):KE.buf(Ve.content,0);var Dr=typeof Ve.content=="string"?zn(Ve.content):Ve.content;ge==8&&(Dr=de(Dr)),ae=be(30),ae.write_shift(4,67324752),ae.write_shift(2,20),ae.write_shift(2,Pe),ae.write_shift(2,ge),Ve.mt?i(ae,Ve.mt):ae.write_shift(4,0),ae.write_shift(-4,$e[He]),ae.write_shift(4,Dr.length),ae.write_shift(4,Ve.content.length),ae.write_shift(2,mr.length),ae.write_shift(2,0),Se+=ae.length,Y.push(ae),Se+=mr.length,Y.push(mr),Se+=Dr.length,Y.push(Dr),ae=be(46),ae.write_shift(4,33639248),ae.write_shift(2,0),ae.write_shift(2,20),ae.write_shift(2,Pe),ae.write_shift(2,ge),ae.write_shift(4,0),ae.write_shift(-4,$e[He]),ae.write_shift(4,Dr.length),ae.write_shift(4,Ve.content.length),ae.write_shift(2,mr.length),ae.write_shift(2,0),ae.write_shift(2,0),ae.write_shift(2,0),ae.write_shift(2,0),ae.write_shift(4,0),ae.write_shift(4,ur),At+=ae.l,ne.push(ae),At+=mr.length,ne.push(mr),++He}return ae=be(22),ae.write_shift(4,101010256),ae.write_shift(2,0),ae.write_shift(2,0),ae.write_shift(2,He),ae.write_shift(2,He),ae.write_shift(4,At),ae.write_shift(4,Se),ae.write_shift(2,0),Lr([Lr(Y),Lr(ne),ae])}var ba={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function Me(U,re){if(U.ctype)return U.ctype;var K=U.name||"",Y=K.match(/\.([^\.]+)$/);return Y&&ba[Y[1]]||re&&(Y=(K=re).match(/[\.\\]([^\.\\])+$/),Y&&ba[Y[1]])?ba[Y[1]]:"application/octet-stream"}function et(U){for(var re=Jd(U),K=[],Y=0;Y<re.length;Y+=76)K.push(re.slice(Y,Y+76));return K.join(`\r
`)+`\r
`}function Fe(U){var re=U.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(_e){var Se=_e.charCodeAt(0).toString(16).toUpperCase();return"="+(Se.length==1?"0"+Se:Se)});re=re.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),re.charAt(0)==`
`&&(re="=0D"+re.slice(1)),re=re.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var K=[],Y=re.split(`\r
`),ne=0;ne<Y.length;++ne){var ae=Y[ne];if(ae.length==0){K.push("");continue}for(var ge=0;ge<ae.length;){var Pe=76,we=ae.slice(ge,ge+Pe);we.charAt(Pe-1)=="="?Pe--:we.charAt(Pe-2)=="="?Pe-=2:we.charAt(Pe-3)=="="&&(Pe-=3),we=ae.slice(ge,ge+Pe),ge+=Pe,ge<ae.length&&(we+="="),K.push(we)}}return K.join(`\r
`)}function Xe(U){for(var re=[],K=0;K<U.length;++K){for(var Y=U[K];K<=U.length&&Y.charAt(Y.length-1)=="=";)Y=Y.slice(0,Y.length-1)+U[++K];re.push(Y)}for(var ne=0;ne<re.length;++ne)re[ne]=re[ne].replace(/[=][0-9A-Fa-f]{2}/g,function(ae){return String.fromCharCode(parseInt(ae.slice(1),16))});return zn(re.join(`\r
`))}function tt(U,re,K){for(var Y="",ne="",ae="",ge,Pe=0;Pe<10;++Pe){var we=re[Pe];if(!we||we.match(/^\s*$/))break;var _e=we.match(/^([^:]*?):\s*([^\s].*)$/);if(_e)switch(_e[1].toLowerCase()){case"content-location":Y=_e[2].trim();break;case"content-type":ae=_e[2].trim();break;case"content-transfer-encoding":ne=_e[2].trim();break}}switch(++Pe,ne.toLowerCase()){case"base64":ge=zn(pa(re.slice(Pe).join("")));break;case"quoted-printable":ge=Xe(re.slice(Pe));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+ne)}var Se=Nr(U,Y.slice(K.length),ge,{unsafe:!0});ae&&(Se.ctype=ae)}function pt(U,re){if(oe(U.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var K=re&&re.root||"",Y=(It&&Buffer.isBuffer(U)?U.toString("binary"):oe(U)).split(`\r
`),ne=0,ae="";for(ne=0;ne<Y.length;++ne)if(ae=Y[ne],!!/^Content-Location:/i.test(ae)&&(ae=ae.slice(ae.indexOf("file")),K||(K=ae.slice(0,ae.lastIndexOf("/")+1)),ae.slice(0,K.length)!=K))for(;K.length>0&&(K=K.slice(0,K.length-1),K=K.slice(0,K.lastIndexOf("/")+1),ae.slice(0,K.length)!=K););var ge=(Y[1]||"").match(/boundary="(.*?)"/);if(!ge)throw new Error("MAD cannot find boundary");var Pe="--"+(ge[1]||""),we=[],_e=[],Se={FileIndex:we,FullPaths:_e};C(Se);var He,Je=0;for(ne=0;ne<Y.length;++ne){var st=Y[ne];st!==Pe&&st!==Pe+"--"||(Je++&&tt(Se,Y.slice(He,ne),K),He=ne)}return Se}function Dt(U,re){var K=re||{},Y=K.boundary||"SheetJS";Y="------="+Y;for(var ne=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+Y.slice(2)+'"',"","",""],ae=U.FullPaths[0],ge=ae,Pe=U.FileIndex[0],we=1;we<U.FullPaths.length;++we)if(ge=U.FullPaths[we].slice(ae.length),Pe=U.FileIndex[we],!(!Pe.size||!Pe.content||ge=="Sh33tJ5")){ge=ge.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(At){return"_x"+At.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(At){return"_u"+At.charCodeAt(0).toString(16)+"_"});for(var _e=Pe.content,Se=It&&Buffer.isBuffer(_e)?_e.toString("binary"):oe(_e),He=0,Je=Math.min(1024,Se.length),st=0,Ve=0;Ve<=Je;++Ve)(st=Se.charCodeAt(Ve))>=32&&st<128&&++He;var $e=He>=Je*4/5;ne.push(Y),ne.push("Content-Location: "+(K.root||"file:///C:/SheetJS/")+ge),ne.push("Content-Transfer-Encoding: "+($e?"quoted-printable":"base64")),ne.push("Content-Type: "+Me(Pe,ge)),ne.push(""),ne.push($e?Fe(Se):et(Se))}return ne.push(Y+`--\r
`),ne.join(`\r
`)}function hr(U){var re={};return C(re,U),re}function Nr(U,re,K,Y){var ne=Y&&Y.unsafe;ne||C(U);var ae=!ne&&wt.find(U,re);if(!ae){var ge=U.FullPaths[0];re.slice(0,ge.length)==ge?ge=re:(ge.slice(-1)!="/"&&(ge+="/"),ge=(ge+re).replace("//","/")),ae={name:a(re),type:2},U.FileIndex.push(ae),U.FullPaths.push(ge),ne||wt.utils.cfb_gc(U)}return ae.content=K,ae.size=K?K.length:0,Y&&(Y.CLSID&&(ae.clsid=Y.CLSID),Y.mt&&(ae.mt=Y.mt),Y.ct&&(ae.ct=Y.ct)),ae}function Wt(U,re){C(U);var K=wt.find(U,re);if(K){for(var Y=0;Y<U.FileIndex.length;++Y)if(U.FileIndex[Y]==K)return U.FileIndex.splice(Y,1),U.FullPaths.splice(Y,1),!0}return!1}function Ht(U,re,K){C(U);var Y=wt.find(U,re);if(Y){for(var ne=0;ne<U.FileIndex.length;++ne)if(U.FileIndex[ne]==Y)return U.FileIndex[ne].name=a(K),U.FullPaths[ne]=K,!0}return!1}function or(U){j(U,!0)}return t.find=I,t.read=N,t.parse=d,t.write=Q,t.writeFile=q,t.utils={cfb_new:hr,cfb_add:Nr,cfb_del:Wt,cfb_mov:Ht,cfb_gc:or,ReadShift:bu,CheckField:z6,prep_blob:Yr,bconcat:Lr,use_zlib:ee,_deflateRaw:kt,_inflateRaw:ga,consts:te},t})(),IM;function YE(e){return typeof e=="string"?Yh(e):Array.isArray(e)?iM(e):e}function Uf(e,t,r){if(typeof Deno<"u"){if(r&&typeof t=="string")switch(r){case"utf8":t=new TextEncoder(r).encode(t);break;case"binary":t=Yh(t);break;default:throw new Error("Unsupported encoding "+r)}return Deno.writeFileSync(e,t)}var n=r=="utf8"?ki(t):t;if(typeof IE_SaveFile<"u")return IE_SaveFile(n,e);if(typeof Blob<"u"){var a=new Blob([YE(n)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(a,e);if(typeof saveAs<"u")return saveAs(a,e);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var i=URL.createObjectURL(a);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(i)},6e4),chrome.downloads.download({url:i,filename:e,saveAs:!0});var s=document.createElement("a");if(s.download!=null)return s.download=e,s.href=i,document.body.appendChild(s),s.click(),document.body.removeChild(s),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(i)},6e4),i}else if(typeof URL<"u"&&!URL.createObjectURL&&typeof chrome=="object"){var o="data:application/octet-stream;base64,"+aM(new Uint8Array(YE(n)));return chrome.downloads.download({url:o,filename:e,saveAs:!0})}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var c=File(e);return c.open("w"),c.encoding="binary",Array.isArray(t)&&(t=Pi(t)),c.write(t),c.close(),t}catch(u){if(!u.message||u.message.indexOf("onstruct")==-1)throw u}throw new Error("cannot save file "+e)}function FM(e){if(typeof Deno<"u")return Deno.readFileSync(e);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var t=File(e);t.open("r"),t.encoding="binary";var r=t.read();return t.close(),r}catch(n){if(!n.message||n.message.indexOf("onstruct")==-1)throw n}throw new Error("Cannot access file "+e)}function _r(e){for(var t=Object.keys(e),r=[],n=0;n<t.length;++n)Object.prototype.hasOwnProperty.call(e,t[n])&&r.push(t[n]);return r}function ZE(e,t){for(var r=[],n=_r(e),a=0;a!==n.length;++a)r[e[n[a]][t]]==null&&(r[e[n[a]][t]]=n[a]);return r}function Qh(e){for(var t=[],r=_r(e),n=0;n!==r.length;++n)t[e[r[n]]]=r[n];return t}function Jh(e){for(var t=[],r=_r(e),n=0;n!==r.length;++n)t[e[r[n]]]=parseInt(r[n],10);return t}function DM(e){for(var t=[],r=_r(e),n=0;n!==r.length;++n)t[e[r[n]]]==null&&(t[e[r[n]]]=[]),t[e[r[n]]].push(r[n]);return t}var y6=Date.UTC(1899,11,30,0,0,0),jM=Date.UTC(1899,11,31,0,0,0),RM=Date.UTC(1904,0,1,0,0,0);function Or(e,t){var r=e.getTime(),n=(r-y6)/(1440*60*1e3);return t?(n-=1462,n<-1402?n-1:n):n<60?n-1:n}function Ji(e){if(e>=60&&e<61)return e;var t=new Date;return t.setTime((e>60?e:e+1)*24*60*60*1e3+y6),t}function MM(e){var t=0,r=0,n=!1,a=e.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!a)throw new Error("|"+e+"| is not an ISO8601 Duration");for(var i=1;i!=a.length;++i)if(a[i]){switch(r=1,i>3&&(n=!0),a[i].slice(a[i].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+a[i].slice(a[i].length-1));case"D":r*=24;case"H":r*=60;case"M":if(n)r*=60;else throw new Error("Unsupported ISO Duration Field: M")}t+=r*parseInt(a[i],10)}return t}var LM=/^(\d+):(\d+)(:\d+)?(\.\d+)?$/,BM=/^(\d+)-(\d+)-(\d+)$/,w6=/^(\d+)-(\d+)-(\d+)[T ](\d+):(\d+)(:\d+)?(\.\d+)?$/;function Tr(e,t){if(e instanceof Date)return e;var r=e.match(LM);if(r)return new Date((t?RM:jM)+((parseInt(r[1],10)*60+parseInt(r[2],10))*60+(r[3]?parseInt(r[3].slice(1),10):0))*1e3+(r[4]?parseInt((r[4]+"000").slice(1,4),10):0));if(r=e.match(BM),r)return new Date(Date.UTC(+r[1],+r[2]-1,+r[3],0,0,0,0));if(r=e.match(w6),r)return new Date(Date.UTC(+r[1],+r[2]-1,+r[3],+r[4],+r[5],r[6]&&parseInt(r[6].slice(1),10)||0,r[7]&&parseInt((r[7]+"0000").slice(1,4),10)||0));var n=new Date(e);return n}function Bo(e,t){if(It&&Buffer.isBuffer(e)){if(t&&Lu){if(e[0]==255&&e[1]==254)return ki(e.slice(2).toString("utf16le"));if(e[1]==254&&e[2]==255)return ki(c6(e.slice(2).toString("binary")))}return e.toString("binary")}if(typeof TextDecoder<"u")try{if(t){if(e[0]==255&&e[1]==254)return ki(new TextDecoder("utf-16le").decode(e.slice(2)));if(e[0]==254&&e[1]==255)return ki(new TextDecoder("utf-16be").decode(e.slice(2)))}var r={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(e)&&(e=new Uint8Array(e)),new TextDecoder("latin1").decode(e).replace(/[]/g,function(i){return r[i]||i})}catch{}var n=[],a=0;try{for(a=0;a<e.length-65536;a+=65536)n.push(String.fromCharCode.apply(0,e.slice(a,a+65536)));n.push(String.fromCharCode.apply(0,e.slice(a)))}catch{try{for(;a<e.length-16384;a+=16384)n.push(String.fromCharCode.apply(0,e.slice(a,a+16384)));n.push(String.fromCharCode.apply(0,e.slice(a)))}catch{for(;a!=e.length;++a)n.push(String.fromCharCode(e[a]))}}return n.join("")}function dr(e){if(typeof JSON<"u"&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if(typeof e!="object"||e==null)return e;if(e instanceof Date)return new Date(e.getTime());var t={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=dr(e[r]));return t}function qt(e,t){for(var r="";r.length<t;)r+=e;return r}function ha(e){var t=Number(e);if(!isNaN(t))return isFinite(t)?t:NaN;if(!/\d/.test(e))return t;var r=1,n=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return r*=100,""});return!isNaN(t=Number(n))||(n=n.replace(/[(]([^()]*)[)]/,function(a,i){return r=-r,i}),!isNaN(t=Number(n)))?t/r:t}var $M=/^(0?\d|1[0-2])(?:|:([0-5]?\d)(?:|(\.\d+)(?:|:([0-5]?\d))|:([0-5]?\d)(|\.\d+)))\s+([ap])m?$/,UM=/^([01]?\d|2[0-3])(?:|:([0-5]?\d)(?:|(\.\d+)(?:|:([0-5]?\d))|:([0-5]?\d)(|\.\d+)))$/,zM=/^(\d+)-(\d+)-(\d+)[T ](\d+):(\d+)(:\d+)(\.\d+)?[Z]?$/,WM=new Date("6/9/69 00:00 UTC").valueOf()==-177984e5;function HM(e){return e[2]?e[3]?e[4]?new Date(Date.UTC(1899,11,31,+e[1]%12+(e[7]=="p"?12:0),+e[2],+e[4],parseFloat(e[3])*1e3)):new Date(Date.UTC(1899,11,31,e[7]=="p"?12:0,+e[1],+e[2],parseFloat(e[3])*1e3)):e[5]?new Date(Date.UTC(1899,11,31,+e[1]%12+(e[7]=="p"?12:0),+e[2],+e[5],e[6]?parseFloat(e[6])*1e3:0)):new Date(Date.UTC(1899,11,31,+e[1]%12+(e[7]=="p"?12:0),+e[2],0,0)):new Date(Date.UTC(1899,11,31,+e[1]%12+(e[7]=="p"?12:0),0,0,0))}function qM(e){return e[2]?e[3]?e[4]?new Date(Date.UTC(1899,11,31,+e[1],+e[2],+e[4],parseFloat(e[3])*1e3)):new Date(Date.UTC(1899,11,31,0,+e[1],+e[2],parseFloat(e[3])*1e3)):e[5]?new Date(Date.UTC(1899,11,31,+e[1],+e[2],+e[5],e[6]?parseFloat(e[6])*1e3:0)):new Date(Date.UTC(1899,11,31,+e[1],+e[2],0,0)):new Date(Date.UTC(1899,11,31,+e[1],0,0,0))}var VM=["january","february","march","april","may","june","july","august","september","october","november","december"];function $u(e){if(zM.test(e))return e.indexOf("Z")==-1?ep(new Date(e)):new Date(e);var t=e.toLowerCase(),r=t.replace(/\s+/g," ").trim(),n=r.match($M);if(n)return HM(n);if(n=r.match(UM),n)return qM(n);if(n=r.match(w6),n)return new Date(Date.UTC(+n[1],+n[2]-1,+n[3],+n[4],+n[5],n[6]&&parseInt(n[6].slice(1),10)||0,n[7]&&parseInt((n[7]+"0000").slice(1,4),10)||0));var a=new Date(WM&&e.indexOf("UTC")==-1?e+" UTC":e),i=new Date(NaN),s=a.getYear();a.getMonth();var o=a.getDate();if(isNaN(o))return i;if(t.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(t=t.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),t.length>3&&VM.indexOf(t)==-1)return i}else if(t.replace(/[ap]m?/,"").match(/[a-z]/))return i;return s<0||s>8099||e.match(/[^-0-9:,\/\\\ ]/)?i:a}var XM=(function(){var e="abacaba".split(/(:?b)/i).length==5;return function(r,n,a){if(e||typeof n=="string")return r.split(n);for(var i=r.split(n),s=[i[0]],o=1;o<i.length;++o)s.push(a),s.push(i[o]);return s}})();function $o(e){return new Date(e.getUTCFullYear(),e.getUTCMonth(),e.getUTCDate(),e.getUTCHours(),e.getUTCMinutes(),e.getUTCSeconds(),e.getUTCMilliseconds())}function ep(e){return new Date(Date.UTC(e.getFullYear(),e.getMonth(),e.getDate(),e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds()))}function sb(e){var t=e.slice(0,1024),r=t.indexOf("<!DOCTYPE");if(r==-1)return e;var n=e.match(/<[\w]/);return n?e.slice(0,r)+e.slice(n.index):e}function ob(e,t,r){for(var n=[],a=e.indexOf(t);a>-1;){var i=e.indexOf(r,a+t.length);if(i==-1)break;n.push(e.slice(a,i+r.length)),a=e.indexOf(t,i+r.length)}return n.length>0?n:null}function zf(e,t,r){var n=[],a=0,i=e.indexOf(t);if(i==-1)return e;for(;i>-1;){n.push(e.slice(a,i));var s=e.indexOf(r,i+t.length);if(s==-1)break;(i=e.indexOf(t,a=s+r.length))==-1&&n.push(e.slice(a))}return n.join("")}var GM={" ":1,"	":1,"\r":1,"\n":1,">":1};function Oo(e,t){for(var r=e.indexOf("<"+t),n=t.length+1,a=e.length;r>=0&&r<=a-n&&!GM[e.charAt(r+n)];)r=e.indexOf("<"+t,r+1);if(r===-1)return null;var i=e.indexOf(">",r+t.length);if(i===-1)return null;var s="</"+t+">",o=e.indexOf(s,i);return o==-1?null:[e.slice(r,o+s.length),e.slice(i+1,o)]}var un=(function(){var e={};return function(r,n){var a=e[n];a||(e[n]=a=[new RegExp("<(?:\\w+:)?"+n+"\\b[^<>]*>","g"),new RegExp("</(?:\\w+:)?"+n+">","g")]),a[0].lastIndex=a[1].lastIndex=0;var i=a[0].exec(r);if(!i)return null;var s=i.index,o=a[0].lastIndex;if(a[1].lastIndex=a[0].lastIndex,i=a[1].exec(r),!i)return null;var c=i.index,u=a[1].lastIndex;return[r.slice(s,u),r.slice(o,c)]}})(),b6=(function(){var e={};return function(r,n){var a=[],i=e[n];i||(e[n]=i=[new RegExp("<(?:\\w+:)?"+n+"\\b[^<>]*>","g"),new RegExp("</(?:\\w+:)?"+n+">","g")]),i[0].lastIndex=i[1].lastIndex=0;for(var s;s=i[0].exec(r);){var o=s.index;if(i[1].lastIndex=i[0].lastIndex,s=i[1].exec(r),!s)return null;var c=i[1].lastIndex;a.push(r.slice(o,c)),i[0].lastIndex=i[1].lastIndex}return a.length==0?null:a}})(),KM=(function(){var e={};return function(r,n){var a=[],i=e[n];i||(e[n]=i=[new RegExp("<(?:\\w+:)?"+n+"\\b[^<>]*>","g"),new RegExp("</(?:\\w+:)?"+n+">","g")]),i[0].lastIndex=i[1].lastIndex=0;for(var s,o=0,c=0;s=i[0].exec(r);){if(o=s.index,a.push(r.slice(c,o)),c=o,i[1].lastIndex=i[0].lastIndex,s=i[1].exec(r),!s)return null;c=i[1].lastIndex,i[0].lastIndex=i[1].lastIndex}return a.push(r.slice(c)),a.length==0?"":a.join("")}})(),YM=(function(){var e={};return function(r,n){var a=[],i=e[n];i||(e[n]=i=[new RegExp("<"+n+"\\b[^<>]*>","ig"),new RegExp("</"+n+">","ig")]),i[0].lastIndex=i[1].lastIndex=0;for(var s;s=i[0].exec(r);){var o=s.index;if(i[1].lastIndex=i[0].lastIndex,s=i[1].exec(r),!s)return null;var c=i[1].lastIndex;a.push(r.slice(o,c)),i[0].lastIndex=i[1].lastIndex}return a.length==0?null:a}})();function _6(e){return e?e.content&&e.type?Bo(e.content,!0):e.data?du(e.data):e.asNodeBuffer&&It?du(e.asNodeBuffer().toString("binary")):e.asBinary?du(e.asBinary()):e._data&&e._data.getContent?du(Bo(Array.prototype.slice.call(e._data.getContent(),0))):null:null}function S6(e){if(!e)return null;if(e.data)return BE(e.data);if(e.asNodeBuffer&&It)return e.asNodeBuffer();if(e._data&&e._data.getContent){var t=e._data.getContent();return typeof t=="string"?BE(t):Array.prototype.slice.call(t)}return e.content&&e.type?e.content:null}function ZM(e){return e&&e.name.slice(-4)===".bin"?S6(e):_6(e)}function Da(e,t){for(var r=e.FullPaths||_r(e.files),n=t.toLowerCase().replace(/[\/]/g,"\\"),a=n.replace(/\\/g,"/"),i=0;i<r.length;++i){var s=r[i].replace(/^Root Entry[\/]/,"").toLowerCase();if(n==s||a==s)return e.files?e.files[r[i]]:e.FileIndex[i]}return null}function lb(e,t){var r=Da(e,t);if(r==null)throw new Error("Cannot find file "+t+" in zip");return r}function Wr(e,t,r){if(!r)return ZM(lb(e,t));if(!t)return null;try{return Wr(e,t)}catch{return null}}function Wn(e,t,r){if(!r)return _6(lb(e,t));if(!t)return null;try{return Wn(e,t)}catch{return null}}function QM(e,t,r){return S6(lb(e,t))}function QE(e){for(var t=e.FullPaths||_r(e.files),r=[],n=0;n<t.length;++n)t[n].slice(-1)!="/"&&r.push(t[n].replace(/^Root Entry[\/]/,""));return r.sort()}function Ct(e,t,r){if(e.FullPaths){if(Array.isArray(r)&&typeof r[0]=="string"&&(r=r.join("")),typeof r=="string"){var n;return It?n=Fi(r):n=sM(r),wt.utils.cfb_add(e,t,n)}wt.utils.cfb_add(e,t,r)}else e.file(t,r)}function cb(){return wt.utils.cfb_new()}function k6(e,t){switch(t.type){case"base64":return wt.read(e,{type:"base64"});case"binary":return wt.read(e,{type:"binary"});case"buffer":case"array":return wt.read(e,{type:"buffer"})}throw new Error("Unrecognized type "+t.type)}function Nl(e,t){if(e.charAt(0)=="/")return e.slice(1);var r=t.split("/");t.slice(-1)!="/"&&r.pop();for(var n=e.split("/");n.length!==0;){var a=n.shift();a===".."?r.pop():a!=="."&&r.push(a)}return r.join("/")}var $r=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,E6=/\s([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,JE=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?<>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'"<>\s=]+))*\s*[\/\?]?>/mg,JM=/<[^<>]*>/g,bn=$r.match(JE)?JE:JM,eL=/<\w*:/,tL=/<(\/?)\w+:/;function lt(e,t,r){for(var n={},a=0,i=0;a!==e.length&&!((i=e.charCodeAt(a))===32||i===10||i===13);++a);if(t||(n[0]=e.slice(0,a)),a===e.length)return n;var s=e.match(E6),o=0,c="",u=0,d="",h="",p=1;if(s)for(u=0;u!=s.length;++u){for(h=s[u].slice(1),i=0;i!=h.length&&h.charCodeAt(i)!==61;++i);for(d=h.slice(0,i).trim();h.charCodeAt(i+1)==32;)++i;for(p=(a=h.charCodeAt(i+1))==34||a==39?1:0,c=h.slice(i+1+p,h.length-p),o=0;o!=d.length&&d.charCodeAt(o)!==58;++o);if(o===d.length)d.indexOf("_")>0&&(d=d.slice(0,d.indexOf("_"))),n[d]=c,n[d.toLowerCase()]=c;else{var v=(o===5&&d.slice(0,5)==="xmlns"?"xmlns":"")+d.slice(o+1);if(n[v]&&d.slice(o-3,o)=="ext")continue;n[v]=c,n[v.toLowerCase()]=c}}return n}function rL(e,t,r){for(var n={},a=0,i=0;a!==e.length&&!((i=e.charCodeAt(a))===32||i===10||i===13);++a);if(a===e.length)return n;var s=e.match(E6),o="",c=0,u="",d="",h=1;if(s)for(c=0;c!=s.length;++c){for(d=s[c].slice(1),i=0;i!=d.length&&d.charCodeAt(i)!==61;++i);for(u=d.slice(0,i).trim();d.charCodeAt(i+1)==32;)++i;h=(a=d.charCodeAt(i+1))==34||a==39?1:0,o=d.slice(i+1+h,d.length-h),u.indexOf("_")>0&&(u=u.slice(0,u.indexOf("_"))),n[u]=o,n[u.toLowerCase()]=o}return n}function Va(e){return e.replace(tL,"<$1")}var T6={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},ub=Qh(T6),zt=(function(){var e=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,t=/_x([\da-fA-F]{4})_/ig;function r(n){var a=n+"",i=a.indexOf("<![CDATA[");if(i==-1)return a.replace(e,function(o,c){return T6[o]||String.fromCharCode(parseInt(c,o.indexOf("x")>-1?16:10))||o}).replace(t,function(o,c){return String.fromCharCode(parseInt(c,16))});var s=a.indexOf("]]>");return r(a.slice(0,i))+a.slice(i+9,s)+r(a.slice(s+3))}return function(a,i){var s=r(a);return i?s.replace(/\r\n/g,`
`):s}})(),fb=/[&<>'"]/g,nL=/[\u0000-\u0008\u000b-\u001f\uFFFE-\uFFFF]/g;function Pt(e){var t=e+"";return t.replace(fb,function(r){return ub[r]}).replace(nL,function(r){return"_x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+"_"})}function e4(e){return Pt(e).replace(/ /g,"_x0020_")}var A6=/[\u0000-\u001f]/g;function wu(e){var t=e+"";return t.replace(fb,function(r){return ub[r]}).replace(/\n/g,"<br/>").replace(A6,function(r){return"&#x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+";"})}function aL(e){var t=e+"";return t.replace(fb,function(r){return ub[r]}).replace(A6,function(r){return"&#x"+r.charCodeAt(0).toString(16).toUpperCase()+";"})}var t4=(function(){var e=/&#(\d+);/g;function t(r,n){return String.fromCharCode(parseInt(n,10))}return function(n){return n.replace(e,t)}})();function iL(e){return e.replace(/(\r\n|[\r\n])/g,"&#10;")}function tr(e){switch(e){case 1:case!0:case"1":case"true":return!0;case 0:case!1:case"0":case"false":return!1}return!1}function M1(e){for(var t="",r=0,n=0,a=0,i=0,s=0,o=0;r<e.length;){if(n=e.charCodeAt(r++),n<128){t+=String.fromCharCode(n);continue}if(a=e.charCodeAt(r++),n>191&&n<224){s=(n&31)<<6,s|=a&63,t+=String.fromCharCode(s);continue}if(i=e.charCodeAt(r++),n<240){t+=String.fromCharCode((n&15)<<12|(a&63)<<6|i&63);continue}s=e.charCodeAt(r++),o=((n&7)<<18|(a&63)<<12|(i&63)<<6|s&63)-65536,t+=String.fromCharCode(55296+(o>>>10&1023)),t+=String.fromCharCode(56320+(o&1023))}return t}function r4(e){var t=Hs(2*e.length),r,n,a=1,i=0,s=0,o;for(n=0;n<e.length;n+=a)a=1,(o=e.charCodeAt(n))<128?r=o:o<224?(r=(o&31)*64+(e.charCodeAt(n+1)&63),a=2):o<240?(r=(o&15)*4096+(e.charCodeAt(n+1)&63)*64+(e.charCodeAt(n+2)&63),a=3):(a=4,r=(o&7)*262144+(e.charCodeAt(n+1)&63)*4096+(e.charCodeAt(n+2)&63)*64+(e.charCodeAt(n+3)&63),r-=65536,s=55296+(r>>>10&1023),r=56320+(r&1023)),s!==0&&(t[i++]=s&255,t[i++]=s>>>8,s=0),t[i++]=r%256,t[i++]=r>>>8;return t.slice(0,i).toString("ucs2")}function n4(e){return Fi(e,"binary").toString("utf8")}var vd="foo bar baz",ir=It&&(n4(vd)==M1(vd)&&n4||r4(vd)==M1(vd)&&r4)||M1,ki=It?function(e){return Fi(e,"utf8").toString("binary")}:function(e){for(var t=[],r=0,n=0,a=0;r<e.length;)switch(n=e.charCodeAt(r++),!0){case n<128:t.push(String.fromCharCode(n));break;case n<2048:t.push(String.fromCharCode(192+(n>>6))),t.push(String.fromCharCode(128+(n&63)));break;case(n>=55296&&n<57344):n-=55296,a=e.charCodeAt(r++)-56320+(n<<10),t.push(String.fromCharCode(240+(a>>18&7))),t.push(String.fromCharCode(144+(a>>12&63))),t.push(String.fromCharCode(128+(a>>6&63))),t.push(String.fromCharCode(128+(a&63)));break;default:t.push(String.fromCharCode(224+(n>>12))),t.push(String.fromCharCode(128+(n>>6&63))),t.push(String.fromCharCode(128+(n&63)))}return t.join("")},C6=(function(){var e=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(t){return[new RegExp("&"+t[0]+";","ig"),t[1]]});return function(r){for(var n=r.replace(/^[\t\n\r ]+/,"").replace(/(^|[^\t\n\r ])[\t\n\r ]+$/,"$1").replace(/>\s+/g,">").replace(/\b\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^<>]*>/g,""),a=0;a<e.length;++a)n=n.replace(e[a][0],e[a][1]);return n}})(),sL=/<\/?(?:vt:)?variant>/g,oL=/<(?:vt:)([^<"'>]*)>([\s\S]*)</;function a4(e,t){var r=lt(e),n=b6(e,r.baseType)||[],a=[];if(n.length!=r.size){if(t.WTF)throw new Error("unexpected vector length "+n.length+" != "+r.size);return a}return n.forEach(function(i){var s=i.replace(sL,"").match(oL);s&&a.push({v:ir(s[2]),t:s[1]})}),a}var O6=/(^\s|\s$|\n)/;function wn(e,t){return"<"+e+(t.match(O6)?' xml:space="preserve"':"")+">"+t+"</"+e+">"}function Uu(e){return _r(e).map(function(t){return" "+t+'="'+e[t]+'"'}).join("")}function Ge(e,t,r){return"<"+e+(r!=null?Uu(r):"")+(t!=null?(t.match(O6)?' xml:space="preserve"':"")+">"+t+"</"+e:"/")+">"}function b2(e,t){try{return e.toISOString().replace(/\.\d*/,"")}catch(r){if(t)throw r}return""}function lL(e,t){switch(typeof e){case"string":var r=Ge("vt:lpwstr",Pt(e));return r=r.replace(/&quot;/g,"_x0022_"),r;case"number":return Ge((e|0)==e?"vt:i4":"vt:r8",Pt(String(e)));case"boolean":return Ge("vt:bool",e?"true":"false")}if(e instanceof Date)return Ge("vt:filetime",b2(e));throw new Error("Unable to serialize "+e)}function tp(e){if(It&&Buffer.isBuffer(e))return e.toString("utf8");if(typeof e=="string")return e;if(typeof Uint8Array<"u"&&e instanceof Uint8Array)return ir(Pi(nb(e)));throw new Error("Bad input format: expected Buffer or string")}var Hr=/<([\/]?)([^\s?><!\/:"]*:|)([^\s?<>:\/"]+)(?:\s+[^<>=?"'\s]+="[^"]*?")*\s*[\/]?>/mg,Zr={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},qo=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],la={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function cL(e,t){for(var r=1-2*(e[t+7]>>>7),n=((e[t+7]&127)<<4)+(e[t+6]>>>4&15),a=e[t+6]&15,i=5;i>=0;--i)a=a*256+e[t+i];return n==2047?a==0?r*(1/0):NaN:(n==0?n=-1022:(n-=1023,a+=Math.pow(2,52)),r*Math.pow(2,n-52)*a)}function uL(e,t,r){var n=(t<0||1/t==-1/0?1:0)<<7,a=0,i=0,s=n?-t:t;isFinite(s)?s==0?a=i=0:(a=Math.floor(Math.log(s)/Math.LN2),i=s*Math.pow(2,52-a),a<=-1023&&(!isFinite(i)||i<Math.pow(2,52))?a=-1022:(i-=Math.pow(2,52),a+=1023)):(a=2047,i=isNaN(t)?26985:0);for(var o=0;o<=5;++o,i/=256)e[r+o]=i&255;e[r+6]=(a&15)<<4|i&15,e[r+7]=a>>4|n}var i4=function(e){for(var t=[],r=10240,n=0;n<e[0].length;++n)if(e[0][n])for(var a=0,i=e[0][n].length;a<i;a+=r)t.push.apply(t,e[0][n].slice(a,a+r));return t},s4=It?function(e){return e[0].length>0&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0].map(function(t){return Buffer.isBuffer(t)?t:Fi(t)})):i4(e)}:i4,o4=function(e,t,r){for(var n=[],a=t;a<r;a+=2)n.push(String.fromCharCode(Ki(e,a)));return n.join("").replace(ta,"")},db=It?function(e,t,r){return!Buffer.isBuffer(e)||!Lu?o4(e,t,r):e.toString("utf16le",t,r).replace(ta,"")}:o4,l4=function(e,t,r){for(var n=[],a=t;a<t+r;++a)n.push(("0"+e[a].toString(16)).slice(-2));return n.join("")},N6=It?function(e,t,r){return Buffer.isBuffer(e)?e.toString("hex",t,t+r):l4(e,t,r)}:l4,c4=function(e,t,r){for(var n=[],a=t;a<r;a++)n.push(String.fromCharCode(Al(e,a)));return n.join("")},Wf=It?function(t,r,n){return Buffer.isBuffer(t)?t.toString("utf8",r,n):c4(t,r,n)}:c4,P6=function(e,t){var r=ca(e,t);return r>0?Wf(e,t+4,t+4+r-1):""},I6=P6,F6=function(e,t){var r=ca(e,t);return r>0?Wf(e,t+4,t+4+r-1):""},D6=F6,j6=function(e,t){var r=2*ca(e,t);return r>0?Wf(e,t+4,t+4+r-1):""},R6=j6,M6=function(t,r){var n=ca(t,r);return n>0?db(t,r+4,r+4+n):""},L6=M6,B6=function(e,t){var r=ca(e,t);return r>0?Wf(e,t+4,t+4+r):""},$6=B6,U6=function(e,t){return cL(e,t)},ah=U6,hb=function(t){return Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array};It&&(I6=function(t,r){if(!Buffer.isBuffer(t))return P6(t,r);var n=t.readUInt32LE(r);return n>0?t.toString("utf8",r+4,r+4+n-1):""},D6=function(t,r){if(!Buffer.isBuffer(t))return F6(t,r);var n=t.readUInt32LE(r);return n>0?t.toString("utf8",r+4,r+4+n-1):""},R6=function(t,r){if(!Buffer.isBuffer(t)||!Lu)return j6(t,r);var n=2*t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+n-1)},L6=function(t,r){if(!Buffer.isBuffer(t)||!Lu)return M6(t,r);var n=t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+n)},$6=function(t,r){if(!Buffer.isBuffer(t))return B6(t,r);var n=t.readUInt32LE(r);return t.toString("utf8",r+4,r+4+n)},ah=function(t,r){return Buffer.isBuffer(t)?t.readDoubleLE(r):U6(t,r)},hb=function(t){return Buffer.isBuffer(t)||Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array});var Al=function(e,t){return e[t]},Ki=function(e,t){return e[t+1]*256+e[t]},fL=function(e,t){var r=e[t+1]*256+e[t];return r<32768?r:(65535-r+1)*-1},ca=function(e,t){return e[t+3]*(1<<24)+(e[t+2]<<16)+(e[t+1]<<8)+e[t]},So=function(e,t){return e[t+3]<<24|e[t+2]<<16|e[t+1]<<8|e[t]},dL=function(e,t){return e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3]};function bu(e,t){var r="",n,a,i=[],s,o,c,u;switch(t){case"dbcs":if(u=this.l,It&&Buffer.isBuffer(this)&&Lu)r=this.slice(this.l,this.l+2*e).toString("utf16le");else for(c=0;c<e;++c)r+=String.fromCharCode(Ki(this,u)),u+=2;e*=2;break;case"utf8":r=Wf(this,this.l,this.l+e);break;case"utf16le":e*=2,r=db(this,this.l,this.l+e);break;case"wstr":return bu.call(this,e,"dbcs");case"lpstr-ansi":r=I6(this,this.l),e=4+ca(this,this.l);break;case"lpstr-cp":r=D6(this,this.l),e=4+ca(this,this.l);break;case"lpwstr":r=R6(this,this.l),e=4+2*ca(this,this.l);break;case"lpp4":e=4+ca(this,this.l),r=L6(this,this.l),e&2&&(e+=2);break;case"8lpp4":e=4+ca(this,this.l),r=$6(this,this.l),e&3&&(e+=4-(e&3));break;case"cstr":for(e=0,r="";(s=Al(this,this.l+e++))!==0;)i.push(md(s));r=i.join("");break;case"_wstr":for(e=0,r="";(s=Ki(this,this.l+e))!==0;)i.push(md(s)),e+=2;e+=2,r=i.join("");break;case"dbcs-cont":for(r="",u=this.l,c=0;c<e;++c){if(this.lens&&this.lens.indexOf(u)!==-1)return s=Al(this,u),this.l=u+1,o=bu.call(this,e-c,s?"dbcs-cont":"sbcs-cont"),i.join("")+o;i.push(md(Ki(this,u))),u+=2}r=i.join(""),e*=2;break;case"cpstr":case"sbcs-cont":for(r="",u=this.l,c=0;c!=e;++c){if(this.lens&&this.lens.indexOf(u)!==-1)return s=Al(this,u),this.l=u+1,o=bu.call(this,e-c,s?"dbcs-cont":"sbcs-cont"),i.join("")+o;i.push(md(Al(this,u))),u+=1}r=i.join("");break;default:switch(e){case 1:return n=Al(this,this.l),this.l++,n;case 2:return n=(t==="i"?fL:Ki)(this,this.l),this.l+=2,n;case 4:case-4:return t==="i"||(this[this.l+3]&128)===0?(n=(e>0?So:dL)(this,this.l),this.l+=4,n):(a=ca(this,this.l),this.l+=4,a);case 8:case-8:if(t==="f")return e==8?a=ah(this,this.l):a=ah([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,a;e=8;case 16:r=N6(this,this.l,e);break}}return this.l+=e,r}var hL=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255,e[r+2]=t>>>16&255,e[r+3]=t>>>24&255},pL=function(e,t,r){e[r]=t&255,e[r+1]=t>>8&255,e[r+2]=t>>16&255,e[r+3]=t>>24&255},mL=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255};function vL(e,t,r){var n=0,a=0;if(r==="dbcs"){for(a=0;a!=t.length;++a)mL(this,t.charCodeAt(a),this.l+2*a);n=2*t.length}else if(r==="sbcs"||r=="cpstr"){for(t=t.replace(/[^\x00-\x7F]/g,"_"),a=0;a!=t.length;++a)this[this.l+a]=t.charCodeAt(a)&255;n=t.length}else if(r==="hex"){for(;a<e;++a)this[this.l++]=parseInt(t.slice(2*a,2*a+2),16)||0;return this}else if(r==="utf16le"){var i=Math.min(this.l+e,this.length);for(a=0;a<Math.min(t.length,e);++a){var s=t.charCodeAt(a);this[this.l++]=s&255,this[this.l++]=s>>8}for(;this.l<i;)this[this.l++]=0;return this}else switch(e){case 1:n=1,this[this.l]=t&255;break;case 2:n=2,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255;break;case 3:n=3,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255,t>>>=8,this[this.l+2]=t&255;break;case 4:n=4,hL(this,t,this.l);break;case 8:if(n=8,r==="f"){uL(this,t,this.l);break}case 16:break;case-4:n=4,pL(this,t,this.l);break}return this.l+=n,this}function z6(e,t){var r=N6(this,this.l,e.length>>1);if(r!==e)throw new Error(t+"Expected "+e+" saw "+r);this.l+=e.length>>1}function Yr(e,t){e.l=t,e.read_shift=bu,e.chk=z6,e.write_shift=vL}function Rn(e,t){e.l+=t}function be(e){var t=Hs(e);return Yr(t,0),t}function fs(e,t,r){if(e){var n,a,i;Yr(e,e.l||0);for(var s=e.length,o=0,c=0;e.l<s;){o=e.read_shift(1),o&128&&(o=(o&127)+((e.read_shift(1)&127)<<7));var u=Yu[o]||Yu[65535];for(n=e.read_shift(1),i=n&127,a=1;a<4&&n&128;++a)i+=((n=e.read_shift(1))&127)<<7*a;c=e.l+i;var d=u.f&&u.f(e,i,r);if(e.l=c,t(d,u,o))return}}}function Dn(){var e=[],t=It?16384:2048;It&&be(t).copy;var r=function(d){var h=be(d);return Yr(h,0),h},n=r(t),a=function(){n&&(n.l&&(n.length>n.l&&(n=n.slice(0,n.l),n.l=n.length),n.length>0&&e.push(n)),n=null)},i=function(d){return n&&d<n.length-n.l?n:(a(),n=r(Math.max(d+1,t)))},s=function(){return a(),Lr(e)},o=function(){return a(),e},c=function(d){a(),n=d,n.l==null&&(n.l=n.length),i(t)};return{next:i,push:c,end:s,_bufs:e,end2:o}}function je(e,t,r,n){var a=+t,i;if(!isNaN(a)){n||(n=Yu[a].p||(r||[]).length||0),i=1+(a>=128?1:0)+1,n>=128&&++i,n>=16384&&++i,n>=2097152&&++i;var s=e.next(i);a<=127?s.write_shift(1,a):(s.write_shift(1,(a&127)+128),s.write_shift(1,a>>7));for(var o=0;o!=4;++o)if(n>=128)s.write_shift(1,(n&127)+128),n>>=7;else{s.write_shift(1,n);break}n>0&&hb(r)&&e.push(r)}}function _u(e,t,r){var n=dr(e);if(t.s?(n.cRel&&(n.c+=t.s.c),n.rRel&&(n.r+=t.s.r)):(n.cRel&&(n.c+=t.c),n.rRel&&(n.r+=t.r)),!r||r.biff<12){for(;n.c>=256;)n.c-=256;for(;n.r>=65536;)n.r-=65536}return n}function u4(e,t,r){var n=dr(e);return n.s=_u(n.s,t.s,r),n.e=_u(n.e,t.s,r),n}function Su(e,t){if(e.cRel&&e.c<0)for(e=dr(e);e.c<0;)e.c+=t>8?16384:256;if(e.rRel&&e.r<0)for(e=dr(e);e.r<0;)e.r+=t>8?1048576:t>5?65536:16384;var r=Rt(e);return!e.cRel&&e.cRel!=null&&(r=yL(r)),!e.rRel&&e.rRel!=null&&(r=gL(r)),r}function L1(e,t){return e.s.r==0&&!e.s.rRel&&e.e.r==(t.biff>=12?1048575:t.biff>=8?65536:16384)&&!e.e.rRel?(e.s.cRel?"":"$")+Ft(e.s.c)+":"+(e.e.cRel?"":"$")+Ft(e.e.c):e.s.c==0&&!e.s.cRel&&e.e.c==(t.biff>=12?16383:255)&&!e.e.cRel?(e.s.rRel?"":"$")+Ut(e.s.r)+":"+(e.e.rRel?"":"$")+Ut(e.e.r):Su(e.s,t.biff)+":"+Su(e.e,t.biff)}function pb(e){return parseInt(xL(e),10)-1}function Ut(e){return""+(e+1)}function gL(e){return e.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function xL(e){return e.replace(/\$(\d+)$/,"$1")}function mb(e){for(var t=wL(e),r=0,n=0;n!==t.length;++n)r=26*r+t.charCodeAt(n)-64;return r-1}function Ft(e){if(e<0)throw new Error("invalid column "+e);var t="";for(++e;e;e=Math.floor((e-1)/26))t=String.fromCharCode((e-1)%26+65)+t;return t}function yL(e){return e.replace(/^([A-Z])/,"$$$1")}function wL(e){return e.replace(/^\$([A-Z])/,"$1")}function bL(e){return e.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function sr(e){for(var t=0,r=0,n=0;n<e.length;++n){var a=e.charCodeAt(n);a>=48&&a<=57?t=10*t+(a-48):a>=65&&a<=90&&(r=26*r+(a-64))}return{c:r-1,r:t-1}}function Rt(e){for(var t=e.c+1,r="";t;t=(t-1)/26|0)r=String.fromCharCode((t-1)%26+65)+r;return r+(e.r+1)}function hn(e){var t=e.indexOf(":");return t==-1?{s:sr(e),e:sr(e)}:{s:sr(e.slice(0,t)),e:sr(e.slice(t+1))}}function Nt(e,t){return typeof t>"u"||typeof t=="number"?Nt(e.s,e.e):(typeof e!="string"&&(e=Rt(e)),typeof t!="string"&&(t=Rt(t)),e==t?e:e+":"+t)}function zu(e){var t=hn(e);return"$"+Ft(t.s.c)+"$"+Ut(t.s.r)+":$"+Ft(t.e.c)+"$"+Ut(t.e.r)}function Wu(e,t){if(!e&&!(t&&t.biff<=5&&t.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(e)?"'"+e.replace(/'/g,"''")+"'":e}function Kt(e){var t={s:{c:0,r:0},e:{c:0,r:0}},r=0,n=0,a=0,i=e.length;for(r=0;n<i&&!((a=e.charCodeAt(n)-64)<1||a>26);++n)r=26*r+a;for(t.s.c=--r,r=0;n<i&&!((a=e.charCodeAt(n)-48)<0||a>9);++n)r=10*r+a;if(t.s.r=--r,n===i||a!=10)return t.e.c=t.s.c,t.e.r=t.s.r,t;for(++n,r=0;n!=i&&!((a=e.charCodeAt(n)-64)<1||a>26);++n)r=26*r+a;for(t.e.c=--r,r=0;n!=i&&!((a=e.charCodeAt(n)-48)<0||a>9);++n)r=10*r+a;return t.e.r=--r,t}function f4(e,t){var r=e.t=="d"&&t instanceof Date;if(e.z!=null)try{return e.w=ma(e.z,r?Or(t):t)}catch{}try{return e.w=ma((e.XF||{}).numFmtId||(r?14:0),r?Or(t):t)}catch{return""+t}}function is(e,t,r){return e==null||e.t==null||e.t=="z"?"":e.w!==void 0?e.w:(e.t=="d"&&!e.z&&r&&r.dateNF&&(e.z=r.dateNF),e.t=="e"?tn[e.v]||e.v:t==null?f4(e,e.v):f4(e,t))}function Ys(e,t){var r=t&&t.sheet?t.sheet:"Sheet1",n={};return n[r]=e,{SheetNames:[r],Sheets:n}}function _L(e){var t={},r=e||{};return r.dense&&(t["!data"]=[]),t}function W6(e,t,r){var n=r||{},a=e?e["!data"]!=null:n.dense,i=e||(a?{"!data":[]}:{});a&&!i["!data"]&&(i["!data"]=[]);var s=0,o=0;if(i&&n.origin!=null)if(typeof n.origin=="number")s=n.origin;else{var c=typeof n.origin=="string"?sr(n.origin):n.origin;s=c.r,o=c.c}var u={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(i["!ref"]){var d=Kt(i["!ref"]);u.s.c=d.s.c,u.s.r=d.s.r,u.e.c=Math.max(u.e.c,d.e.c),u.e.r=Math.max(u.e.r,d.e.r),s==-1&&(u.e.r=s=i["!ref"]?d.e.r+1:0)}else u.s.c=u.e.c=u.s.r=u.e.r=0;for(var h=[],p=!1,v=0;v!=t.length;++v)if(t[v]){if(!Array.isArray(t[v]))throw new Error("aoa_to_sheet expects an array of arrays");var x=s+v;a&&(i["!data"][x]||(i["!data"][x]=[]),h=i["!data"][x]);for(var w=t[v],y=0;y!=w.length;++y)if(!(typeof w[y]>"u")){var _={v:w[y],t:""},S=o+y;if(u.s.r>x&&(u.s.r=x),u.s.c>S&&(u.s.c=S),u.e.r<x&&(u.e.r=x),u.e.c<S&&(u.e.c=S),p=!0,w[y]&&typeof w[y]=="object"&&!Array.isArray(w[y])&&!(w[y]instanceof Date))_=w[y];else if(Array.isArray(_.v)&&(_.f=w[y][1],_.v=_.v[0]),_.v===null)if(_.f)_.t="n";else if(n.nullError)_.t="e",_.v=0;else if(n.sheetStubs)_.t="z";else continue;else typeof _.v=="number"?isFinite(_.v)?_.t="n":isNaN(_.v)?(_.t="e",_.v=15):(_.t="e",_.v=7):typeof _.v=="boolean"?_.t="b":_.v instanceof Date?(_.z=n.dateNF||yt[14],n.UTC||(_.v=ep(_.v)),n.cellDates?(_.t="d",_.w=ma(_.z,Or(_.v,n.date1904))):(_.t="n",_.v=Or(_.v,n.date1904),_.w=ma(_.z,_.v))):_.t="s";if(a)h[S]&&h[S].z&&(_.z=h[S].z),h[S]=_;else{var k=Ft(S)+(x+1);i[k]&&i[k].z&&(_.z=i[k].z),i[k]=_}}}return p&&u.s.c<104e5&&(i["!ref"]=Nt(u)),i}function hc(e,t){return W6(null,e,t)}function SL(e){return e.read_shift(4,"i")}function li(e,t){return t||(t=be(4)),t.write_shift(4,e),t}function jn(e){var t=e.read_shift(4);return t===0?"":e.read_shift(t,"dbcs")}function Jr(e,t){var r=!1;return t==null&&(r=!0,t=be(4+2*e.length)),t.write_shift(4,e.length),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}function kL(e){return{ich:e.read_shift(2),ifnt:e.read_shift(2)}}function EL(e,t){return t||(t=be(4)),t.write_shift(2,0),t.write_shift(2,0),t}function vb(e,t){var r=e.l,n=e.read_shift(1),a=jn(e),i=[],s={t:a,h:a};if((n&1)!==0){for(var o=e.read_shift(4),c=0;c!=o;++c)i.push(kL(e));s.r=i}else s.r=[{ich:0,ifnt:0}];return e.l=r+t,s}function TL(e,t){var r=!1;return t==null&&(r=!0,t=be(15+4*e.t.length)),t.write_shift(1,0),Jr(e.t,t),r?t.slice(0,t.l):t}var AL=vb;function CL(e,t){var r=!1;return t==null&&(r=!0,t=be(23+4*e.t.length)),t.write_shift(1,1),Jr(e.t,t),t.write_shift(4,1),EL({},t),r?t.slice(0,t.l):t}function Xa(e){var t=e.read_shift(4),r=e.read_shift(2);return r+=e.read_shift(1)<<16,e.l++,{c:t,iStyleRef:r}}function Vo(e,t){return t==null&&(t=be(8)),t.write_shift(-4,e.c),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}function Xo(e){var t=e.read_shift(2);return t+=e.read_shift(1)<<16,e.l++,{c:-1,iStyleRef:t}}function Go(e,t){return t==null&&(t=be(4)),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}var OL=jn,H6=Jr;function rp(e){var t=e.read_shift(4);return t===0||t===4294967295?"":e.read_shift(t,"dbcs")}function Hu(e,t){var r=!1;return t==null&&(r=!0,t=be(127)),t.write_shift(4,e.length>0?e.length:4294967295),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}var NL=jn,_2=rp,gb=Hu;function np(e){var t=e.slice(e.l,e.l+4),r=t[0]&1,n=t[0]&2;e.l+=4;var a=n===0?ah([0,0,0,0,t[0]&252,t[1],t[2],t[3]],0):So(t,0)>>2;return r?a/100:a}function q6(e,t){t==null&&(t=be(4));var r=0,n=0,a=e*100;if(e==(e|0)&&e>=-536870912&&e<1<<29?n=1:a==(a|0)&&a>=-536870912&&a<1<<29&&(n=1,r=1),n)t.write_shift(-4,((r?a:e)<<2)+(r+2));else throw new Error("unsupported RkNumber "+e)}function V6(e){var t={s:{},e:{}};return t.s.r=e.read_shift(4),t.e.r=e.read_shift(4),t.s.c=e.read_shift(4),t.e.c=e.read_shift(4),t}function PL(e,t){return t||(t=be(16)),t.write_shift(4,e.s.r),t.write_shift(4,e.e.r),t.write_shift(4,e.s.c),t.write_shift(4,e.e.c),t}var Ko=V6,pc=PL;function In(e){if(e.length-e.l<8)throw"XLS Xnum Buffer underflow";return e.read_shift(8,"f")}function Uo(e,t){return(t||be(8)).write_shift(8,e,"f")}function IL(e){var t={},r=e.read_shift(1),n=r>>>1,a=e.read_shift(1),i=e.read_shift(2,"i"),s=e.read_shift(1),o=e.read_shift(1),c=e.read_shift(1);switch(e.l++,n){case 0:t.auto=1;break;case 1:t.index=a;var u=No[a];u&&(t.rgb=Vu(u));break;case 2:t.rgb=Vu([s,o,c]);break;case 3:t.theme=a;break}return i!=0&&(t.tint=i>0?i/32767:i/32768),t}function ih(e,t){if(t||(t=be(8)),!e||e.auto)return t.write_shift(4,0),t.write_shift(4,0),t;e.index!=null?(t.write_shift(1,2),t.write_shift(1,e.index)):e.theme!=null?(t.write_shift(1,6),t.write_shift(1,e.theme)):(t.write_shift(1,5),t.write_shift(1,0));var r=e.tint||0;if(r>0?r*=32767:r<0&&(r*=32768),t.write_shift(2,r),!e.rgb||e.theme!=null)t.write_shift(2,0),t.write_shift(1,0),t.write_shift(1,0);else{var n=e.rgb||"FFFFFF";typeof n=="number"&&(n=("000000"+n.toString(16)).slice(-6)),t.write_shift(1,parseInt(n.slice(0,2),16)),t.write_shift(1,parseInt(n.slice(2,4),16)),t.write_shift(1,parseInt(n.slice(4,6),16)),t.write_shift(1,255)}return t}function FL(e){var t=e.read_shift(1);e.l++;var r={fBold:t&1,fItalic:t&2,fUnderline:t&4,fStrikeout:t&8,fOutline:t&16,fShadow:t&32,fCondense:t&64,fExtend:t&128};return r}function DL(e,t){t||(t=be(2));var r=(e.italic?2:0)|(e.strike?8:0)|(e.outline?16:0)|(e.shadow?32:0)|(e.condense?64:0)|(e.extend?128:0);return t.write_shift(1,r),t.write_shift(1,0),t}function X6(e,t){var r={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},n=e.read_shift(4);switch(n){case 0:return"";case 4294967295:case 4294967294:return r[e.read_shift(4)]||""}if(n>400)throw new Error("Unsupported Clipboard: "+n.toString(16));return e.l-=4,e.read_shift(0,t==1?"lpstr":"lpwstr")}function jL(e){return X6(e,1)}function RL(e){return X6(e,2)}var xb=2,Qn=3,gd=11,d4=12,sh=19,xd=64,ML=65,LL=71,BL=4108,$L=4126,ln=80,G6=81,UL=[ln,G6],S2={1:{n:"CodePage",t:xb},2:{n:"Category",t:ln},3:{n:"PresentationFormat",t:ln},4:{n:"ByteCount",t:Qn},5:{n:"LineCount",t:Qn},6:{n:"ParagraphCount",t:Qn},7:{n:"SlideCount",t:Qn},8:{n:"NoteCount",t:Qn},9:{n:"HiddenCount",t:Qn},10:{n:"MultimediaClipCount",t:Qn},11:{n:"ScaleCrop",t:gd},12:{n:"HeadingPairs",t:BL},13:{n:"TitlesOfParts",t:$L},14:{n:"Manager",t:ln},15:{n:"Company",t:ln},16:{n:"LinksUpToDate",t:gd},17:{n:"CharacterCount",t:Qn},19:{n:"SharedDoc",t:gd},22:{n:"HyperlinksChanged",t:gd},23:{n:"AppVersion",t:Qn,p:"version"},24:{n:"DigSig",t:ML},26:{n:"ContentType",t:ln},27:{n:"ContentStatus",t:ln},28:{n:"Language",t:ln},29:{n:"Version",t:ln},255:{},2147483648:{n:"Locale",t:sh},2147483651:{n:"Behavior",t:sh},1919054434:{}},k2={1:{n:"CodePage",t:xb},2:{n:"Title",t:ln},3:{n:"Subject",t:ln},4:{n:"Author",t:ln},5:{n:"Keywords",t:ln},6:{n:"Comments",t:ln},7:{n:"Template",t:ln},8:{n:"LastAuthor",t:ln},9:{n:"RevNumber",t:ln},10:{n:"EditTime",t:xd},11:{n:"LastPrinted",t:xd},12:{n:"CreatedDate",t:xd},13:{n:"ModifiedDate",t:xd},14:{n:"PageCount",t:Qn},15:{n:"WordCount",t:Qn},16:{n:"CharCount",t:Qn},17:{n:"Thumbnail",t:LL},18:{n:"Application",t:ln},19:{n:"DocSecurity",t:Qn},255:{},2147483648:{n:"Locale",t:sh},2147483651:{n:"Behavior",t:sh},1919054434:{}},h4={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},zL=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function WL(e){return e.map(function(t){return[t>>16&255,t>>8&255,t&255]})}var HL=WL([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,0,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),No=dr(HL),tn={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},dn={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},yb=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"],E2={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},yd={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function wb(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function qL(e){var t=wb();if(!e||!e.match)return t;var r={};if((e.match(bn)||[]).forEach(function(n){var a=lt(n);switch(a[0].replace(eL,"<")){case"<?xml":break;case"<Types":t.xmlns=a["xmlns"+(a[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":r[a.Extension.toLowerCase()]=a.ContentType;break;case"<Override":t[E2[a.ContentType]]!==void 0&&t[E2[a.ContentType]].push(a.PartName);break}}),t.xmlns!==Zr.CT)throw new Error("Unknown Namespace: "+t.xmlns);return t.calcchain=t.calcchains.length>0?t.calcchains[0]:"",t.sst=t.strs.length>0?t.strs[0]:"",t.style=t.styles.length>0?t.styles[0]:"",t.defaults=r,delete t.calcchains,t}function K6(e,t,r){var n=DM(E2),a=[],i;a[a.length]=$r,a[a.length]=Ge("Types",null,{xmlns:Zr.CT,"xmlns:xsd":Zr.xsd,"xmlns:xsi":Zr.xsi}),a=a.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(u){return Ge("Default",null,{Extension:u[0],ContentType:u[1]})}));var s=function(u){e[u]&&e[u].length>0&&(i=e[u][0],a[a.length]=Ge("Override",null,{PartName:(i[0]=="/"?"":"/")+i,ContentType:yd[u][t.bookType]||yd[u].xlsx}))},o=function(u){(e[u]||[]).forEach(function(d){a[a.length]=Ge("Override",null,{PartName:(d[0]=="/"?"":"/")+d,ContentType:yd[u][t.bookType]||yd[u].xlsx})})},c=function(u){(e[u]||[]).forEach(function(d){a[a.length]=Ge("Override",null,{PartName:(d[0]=="/"?"":"/")+d,ContentType:n[u][0]})})};return s("workbooks"),o("sheets"),o("charts"),c("themes"),["strs","styles"].forEach(s),["coreprops","extprops","custprops"].forEach(c),c("vba"),c("comments"),c("threadedcomments"),c("drawings"),o("metadata"),c("people"),a.length>2&&(a[a.length]="</Types>",a[1]=a[1].replace("/>",">")),a.join("")}var jt={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",CONN:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/connections",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function qu(e){var t=e.lastIndexOf("/");return e.slice(0,t+1)+"_rels/"+e.slice(t+1)+".rels"}function ku(e,t){var r={"!id":{}};if(!e)return r;t.charAt(0)!=="/"&&(t="/"+t);var n={};return(e.match(bn)||[]).forEach(function(a){var i=lt(a);if(i[0]==="<Relationship"){var s={};s.Type=i.Type,s.Target=zt(i.Target),s.Id=i.Id,i.TargetMode&&(s.TargetMode=i.TargetMode);var o=i.TargetMode==="External"?i.Target:Nl(i.Target,t);r[o]=s,n[i.Id]=s}}),r["!id"]=n,r}function jl(e){var t=[$r,Ge("Relationships",null,{xmlns:Zr.RELS})];return _r(e["!id"]).forEach(function(r){t[t.length]=Ge("Relationship",null,e["!id"][r])}),t.length>2&&(t[t.length]="</Relationships>",t[1]=t[1].replace("/>",">")),t.join("")}function er(e,t,r,n,a,i){if(a||(a={}),e["!id"]||(e["!id"]={}),e["!idx"]||(e["!idx"]=1),t<0)for(t=e["!idx"];e["!id"]["rId"+t];++t);if(e["!idx"]=t+1,a.Id="rId"+t,a.Type=n,a.Target=r,[jt.HLINK,jt.XPATH,jt.XMISS].indexOf(a.Type)>-1&&(a.TargetMode="External"),e["!id"][a.Id])throw new Error("Cannot rewrite rId "+t);return e["!id"][a.Id]=a,e[("/"+a.Target).replace("//","/")]=a,t}var VL="application/vnd.oasis.opendocument.spreadsheet";function XL(e,t){for(var r=tp(e),n,a;n=Hr.exec(r);)switch(n[3]){case"manifest":break;case"file-entry":if(a=lt(n[0],!1),a.path=="/"&&a.type!==VL)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(t&&t.WTF)throw n}}function GL(e){var t=[$r];t.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),t.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var r=0;r<e.length;++r)t.push('  <manifest:file-entry manifest:full-path="'+e[r][0]+'" manifest:media-type="'+e[r][1]+`"/>
`);return t.push("</manifest:manifest>"),t.join("")}function p4(e,t,r){return['  <rdf:Description rdf:about="'+e+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(r||"odf")+"#"+t+`"/>
`,`  </rdf:Description>
`].join("")}function KL(e,t){return['  <rdf:Description rdf:about="'+e+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+t+`"/>
`,`  </rdf:Description>
`].join("")}function YL(e){var t=[$r];t.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var r=0;r!=e.length;++r)t.push(p4(e[r][0],e[r][1])),t.push(KL("",e[r][0]));return t.push(p4("","Document","pkg")),t.push("</rdf:RDF>"),t.join("")}function Y6(e,t){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+Qd.version+"</meta:generator></office:meta></office:document-meta>"}var es=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]];function Z6(e){var t={};e=ir(e);for(var r=0;r<es.length;++r){var n=es[r],a=Oo(e,n[0]);a!=null&&a.length>0&&(t[n[1]]=zt(a[1])),n[2]==="date"&&t[n[1]]&&(t[n[1]]=Tr(t[n[1]]))}return t}function B1(e,t,r,n,a){a[e]!=null||t==null||t===""||(a[e]=t,t=Pt(t),n[n.length]=r?Ge(e,t,r):wn(e,t))}function Q6(e,t){var r=t||{},n=[$r,Ge("cp:coreProperties",null,{"xmlns:cp":Zr.CORE_PROPS,"xmlns:dc":Zr.dc,"xmlns:dcterms":Zr.dcterms,"xmlns:dcmitype":Zr.dcmitype,"xmlns:xsi":Zr.xsi})],a={};if(!e&&!r.Props)return n.join("");e&&(e.CreatedDate!=null&&B1("dcterms:created",typeof e.CreatedDate=="string"?e.CreatedDate:b2(e.CreatedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,a),e.ModifiedDate!=null&&B1("dcterms:modified",typeof e.ModifiedDate=="string"?e.ModifiedDate:b2(e.ModifiedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,a));for(var i=0;i!=es.length;++i){var s=es[i],o=r.Props&&r.Props[s[1]]!=null?r.Props[s[1]]:e?e[s[1]]:null;o===!0?o="1":o===!1?o="0":typeof o=="number"&&(o=String(o)),o!=null&&B1(s[0],o,null,n,a)}return n.length>2&&(n[n.length]="</cp:coreProperties>",n[1]=n[1].replace("/>",">")),n.join("")}var Po=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],J6=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function eP(e,t,r,n){var a=[];if(typeof e=="string")a=a4(e,n);else for(var i=0;i<e.length;++i)a=a.concat(e[i].map(function(d){return{v:d}}));var s=typeof t=="string"?a4(t,n).map(function(d){return d.v}):t,o=0,c=0;if(s.length>0)for(var u=0;u!==a.length;u+=2){switch(c=+a[u+1].v,a[u].v){case"Worksheets":case"":case"":case" ":case"":case" ":case"Arbeitsbltter":case"alma Sayfalar":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de clculo":case"Planilhas":case"Regneark":case"Hojas de clculo":case"Werkbladen":r.Worksheets=c,r.SheetNames=s.slice(o,o+c);break;case"Named Ranges":case"Rangos con nombre":case"":case"Benannte Bereiche":case"Navngivne omrder":r.NamedRanges=c,r.DefinedNames=s.slice(o,o+c);break;case"Charts":case"Diagramme":r.Chartsheets=c,r.ChartNames=s.slice(o,o+c);break}o+=c}}function ZL(e,t,r){var n={};return t||(t={}),e=ir(e),Po.forEach(function(a){var i=(un(e,a[0])||[])[1];switch(a[2]){case"string":i&&(t[a[1]]=zt(i));break;case"bool":t[a[1]]=i==="true";break;case"raw":var s=Oo(e,a[0]);s&&s.length>0&&(n[a[1]]=s[1]);break}}),n.HeadingPairs&&n.TitlesOfParts&&eP(n.HeadingPairs,n.TitlesOfParts,t,r),t}function tP(e){var t=[],r=Ge;return e||(e={}),e.Application="SheetJS",t[t.length]=$r,t[t.length]=Ge("Properties",null,{xmlns:Zr.EXT_PROPS,"xmlns:vt":Zr.vt}),Po.forEach(function(n){if(e[n[1]]!==void 0){var a;switch(n[2]){case"string":a=Pt(String(e[n[1]]));break;case"bool":a=e[n[1]]?"true":"false";break}a!==void 0&&(t[t.length]=r(n[0],a))}}),t[t.length]=r("HeadingPairs",r("vt:vector",r("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+r("vt:variant",r("vt:i4",String(e.Worksheets))),{size:2,baseType:"variant"})),t[t.length]=r("TitlesOfParts",r("vt:vector",e.SheetNames.map(function(n){return"<vt:lpstr>"+Pt(n)+"</vt:lpstr>"}).join(""),{size:e.Worksheets,baseType:"lpstr"})),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}var QL=/<[^<>]+>[^<]*/g;function JL(e,t){var r={},n="",a=e.match(QL);if(a)for(var i=0;i!=a.length;++i){var s=a[i],o=lt(s);switch(Va(o[0])){case"<?xml":break;case"<Properties":break;case"<property":n=zt(o.name);break;case"</property>":n=null;break;default:if(s.indexOf("<vt:")===0){var c=s.split(">"),u=c[0].slice(4),d=c[1];switch(u){case"lpstr":case"bstr":case"lpwstr":r[n]=zt(d);break;case"bool":r[n]=tr(d);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":r[n]=parseInt(d,10);break;case"r4":case"r8":case"decimal":r[n]=parseFloat(d);break;case"filetime":case"date":r[n]=Tr(d);break;case"cy":case"error":r[n]=zt(d);break;default:if(u.slice(-1)=="/")break;t.WTF&&typeof console<"u"&&console.warn("Unexpected",s,u,c)}}else if(s.slice(0,2)!=="</"){if(t.WTF)throw new Error(s)}}}return r}function rP(e){var t=[$r,Ge("Properties",null,{xmlns:Zr.CUST_PROPS,"xmlns:vt":Zr.vt})];if(!e)return t.join("");var r=1;return _r(e).forEach(function(a){++r,t[t.length]=Ge("property",lL(e[a]),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:r,name:Pt(a)})}),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}var T2={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},$1;function e7(e,t,r){$1||($1=Qh(T2)),t=$1[t]||t,e[t]=r}function t7(e,t){var r=[];return _r(T2).map(function(n){for(var a=0;a<es.length;++a)if(es[a][1]==n)return es[a];for(a=0;a<Po.length;++a)if(Po[a][1]==n)return Po[a];throw n}).forEach(function(n){if(e[n[1]]!=null){var a=t&&t.Props&&t.Props[n[1]]!=null?t.Props[n[1]]:e[n[1]];switch(n[2]){case"date":a=new Date(a).toISOString().replace(/\.\d*Z/,"Z");break}typeof a=="number"?a=String(a):a===!0||a===!1?a=a?"1":"0":a instanceof Date&&(a=new Date(a).toISOString().replace(/\.\d*Z/,"")),r.push(wn(T2[n[1]]||n[1],a))}}),Ge("DocumentProperties",r.join(""),{xmlns:la.o})}function r7(e,t){var r=["Worksheets","SheetNames"],n="CustomDocumentProperties",a=[];return e&&_r(e).forEach(function(i){if(Object.prototype.hasOwnProperty.call(e,i)){for(var s=0;s<es.length;++s)if(i==es[s][1])return;for(s=0;s<Po.length;++s)if(i==Po[s][1])return;for(s=0;s<r.length;++s)if(i==r[s])return;var o=e[i],c="string";typeof o=="number"?(c="float",o=String(o)):o===!0||o===!1?(c="boolean",o=o?"1":"0"):o=String(o),a.push(Ge(e4(i),o,{"dt:dt":c}))}}),t&&_r(t).forEach(function(i){if(Object.prototype.hasOwnProperty.call(t,i)&&!(e&&Object.prototype.hasOwnProperty.call(e,i))){var s=t[i],o="string";typeof s=="number"?(o="float",s=String(s)):s===!0||s===!1?(o="boolean",s=s?"1":"0"):s instanceof Date?(o="dateTime.tz",s=s.toISOString()):s=String(s),a.push(Ge(e4(i),s,{"dt:dt":o}))}}),"<"+n+' xmlns="'+la.o+'">'+a.join("")+"</"+n+">"}function bb(e){var t=e.read_shift(4),r=e.read_shift(4);return new Date((r/1e7*Math.pow(2,32)+t/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function n7(e){var t=typeof e=="string"?new Date(Date.parse(e)):e,r=t.getTime()/1e3+11644473600,n=r%Math.pow(2,32),a=(r-n)/Math.pow(2,32);n*=1e7,a*=1e7;var i=n/Math.pow(2,32)|0;i>0&&(n=n%Math.pow(2,32),a+=i);var s=be(8);return s.write_shift(4,n),s.write_shift(4,a),s}function a7(e,t,r){var n=e.l,a=e.read_shift(0,"lpstr-cp");if(r)for(;e.l-n&3;)++e.l;return a}function i7(e,t,r){var n=e.read_shift(0,"lpwstr");return n}function nP(e,t,r){return t===31?i7(e):a7(e,t,r)}function Eu(e,t,r){return nP(e,t,r===!1?0:4)}function s7(e,t){if(!t)throw new Error("VtUnalignedString must have positive length");return nP(e,t,0)}function o7(e){for(var t=e.read_shift(4),r=[],n=0;n!=t;++n){var a=e.l;r[n]=e.read_shift(0,"lpwstr").replace(ta,""),e.l-a&2&&(e.l+=2)}return r}function l7(e){for(var t=e.read_shift(4),r=[],n=0;n!=t;++n)r[n]=e.read_shift(0,"lpstr-cp").replace(ta,"");return r}function c7(e){var t=e.l,r=oh(e,G6);e[e.l]==0&&e[e.l+1]==0&&e.l-t&2&&(e.l+=2);var n=oh(e,Qn);return[r,n]}function u7(e){for(var t=e.read_shift(4),r=[],n=0;n<t/2;++n)r.push(c7(e));return r}function m4(e,t){for(var r=e.read_shift(4),n={},a=0;a!=r;++a){var i=e.read_shift(4),s=e.read_shift(4);n[i]=e.read_shift(s,t===1200?"utf16le":"utf8").replace(ta,"").replace(hu,"!"),t===1200&&s%2&&(e.l+=2)}return e.l&3&&(e.l=e.l>>3<<2),n}function aP(e){var t=e.read_shift(4),r=e.slice(e.l,e.l+t);return e.l+=t,(t&3)>0&&(e.l+=4-(t&3)&3),r}function f7(e){var t={};return t.Size=e.read_shift(4),e.l+=t.Size+3-(t.Size-1)%4,t}function oh(e,t,r){var n=e.read_shift(2),a,i=r||{};if(e.l+=2,t!==d4&&n!==t&&UL.indexOf(t)===-1&&!((t&65534)==4126&&(n&65534)==4126))throw new Error("Expected type "+t+" saw "+n);switch(t===d4?n:t){case 2:return a=e.read_shift(2,"i"),i.raw||(e.l+=2),a;case 3:return a=e.read_shift(4,"i"),a;case 11:return e.read_shift(4)!==0;case 19:return a=e.read_shift(4),a;case 30:e.l+=4,val=Eu(e,e[e.l-4]).replace(/(^|[^\u0000])\u0000+$/,"$1");break;case 31:e.l+=4,val=Eu(e,e[e.l-4]).replace(/(^|[^\u0000])\u0000+$/,"$1");break;case 64:return bb(e);case 65:return aP(e);case 71:return f7(e);case 80:return Eu(e,n,!i.raw).replace(ta,"");case 81:return s7(e,n).replace(ta,"");case 4108:return u7(e);case 4126:case 4127:return n==4127?o7(e):l7(e);default:throw new Error("TypedPropertyValue unrecognized type "+t+" "+n)}}function v4(e,t){var r=be(4),n=be(4);switch(r.write_shift(4,e==80?31:e),e){case 3:n.write_shift(-4,t);break;case 5:n=be(8),n.write_shift(8,t,"f");break;case 11:n.write_shift(4,t?1:0);break;case 64:n=n7(t);break;case 31:case 80:for(n=be(4+2*(t.length+1)+(t.length%2?0:2)),n.write_shift(4,t.length+1),n.write_shift(0,t,"dbcs");n.l!=n.length;)n.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+t)}return Lr([r,n])}function g4(e,t){var r=e.l,n=e.read_shift(4),a=e.read_shift(4),i=[],s=0,o=0,c=-1,u={};for(s=0;s!=a;++s){var d=e.read_shift(4),h=e.read_shift(4);i[s]=[d,h+r]}i.sort(function(S,k){return S[1]-k[1]});var p={};for(s=0;s!=a;++s){if(e.l!==i[s][1]){var v=!0;if(s>0&&t)switch(t[i[s-1][0]].t){case 2:e.l+2===i[s][1]&&(e.l+=2,v=!1);break;case 80:e.l<=i[s][1]&&(e.l=i[s][1],v=!1);break;case 4108:e.l<=i[s][1]&&(e.l=i[s][1],v=!1);break}if((!t||s==0)&&e.l<=i[s][1]&&(v=!1,e.l=i[s][1]),v)throw new Error("Read Error: Expected address "+i[s][1]+" at "+e.l+" :"+s)}if(t){if(i[s][0]==0&&i.length>s+1&&i[s][1]==i[s+1][1])continue;var x=t[i[s][0]];if(p[x.n]=oh(e,x.t,{raw:!0}),x.p==="version"&&(p[x.n]=String(p[x.n]>>16)+"."+("0000"+String(p[x.n]&65535)).slice(-4)),x.n=="CodePage")switch(p[x.n]){case 0:p[x.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:ii(o=p[x.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+p[x.n])}}else if(i[s][0]===1){if(o=p.CodePage=oh(e,xb),ii(o),c!==-1){var w=e.l;e.l=i[c][1],u=m4(e,o),e.l=w}}else if(i[s][0]===0){if(o===0){c=s,e.l=i[s+1][1];continue}u=m4(e,o)}else{var y=u[i[s][0]],_;switch(e[e.l]){case 65:e.l+=4,_=aP(e);break;case 30:e.l+=4,_=Eu(e,e[e.l-4]).replace(/(^|[^\u0000])\u0000+$/,"$1");break;case 31:e.l+=4,_=Eu(e,e[e.l-4]).replace(/(^|[^\u0000])\u0000+$/,"$1");break;case 3:e.l+=4,_=e.read_shift(4,"i");break;case 19:e.l+=4,_=e.read_shift(4);break;case 5:e.l+=4,_=e.read_shift(8,"f");break;case 11:e.l+=4,_=Mr(e,4);break;case 64:e.l+=4,_=Tr(bb(e));break;default:throw new Error("unparsed value: "+e[e.l])}p[y]=_}}return e.l=r+n,p}var iP=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function d7(e){switch(typeof e){case"boolean":return 11;case"number":return(e|0)==e?3:5;case"string":return 31;case"object":if(e instanceof Date)return 64;break}return-1}function x4(e,t,r){var n=be(8),a=[],i=[],s=8,o=0,c=be(8),u=be(8);if(c.write_shift(4,2),c.write_shift(4,1200),u.write_shift(4,1),i.push(c),a.push(u),s+=8+c.length,!t){u=be(8),u.write_shift(4,0),a.unshift(u);var d=[be(4)];for(d[0].write_shift(4,e.length),o=0;o<e.length;++o){var h=e[o][0];for(c=be(8+2*(h.length+1)+(h.length%2?0:2)),c.write_shift(4,o+2),c.write_shift(4,h.length+1),c.write_shift(0,h,"dbcs");c.l!=c.length;)c.write_shift(1,0);d.push(c)}c=Lr(d),i.unshift(c),s+=8+c.length}for(o=0;o<e.length;++o)if(!(t&&!t[e[o][0]])&&!(iP.indexOf(e[o][0])>-1||J6.indexOf(e[o][0])>-1)&&e[o][1]!=null){var p=e[o][1],v=0;if(t){v=+t[e[o][0]];var x=r[v];if(x.p=="version"&&typeof p=="string"){var w=p.split(".");p=(+w[0]<<16)+(+w[1]||0)}c=v4(x.t,p)}else{var y=d7(p);y==-1&&(y=31,p=String(p)),c=v4(y,p)}i.push(c),u=be(8),u.write_shift(4,t?v:2+o),a.push(u),s+=8+c.length}var _=8*(i.length+1);for(o=0;o<i.length;++o)a[o].write_shift(4,_),_+=i[o].length;return n.write_shift(4,s),n.write_shift(4,i.length),Lr([n].concat(a).concat(i))}function y4(e,t,r){var n=e.content;if(!n)return{};Yr(n,0);var a,i,s,o,c=0;n.chk("feff","Byte Order: "),n.read_shift(2);var u=n.read_shift(4),d=n.read_shift(16);if(d!==wt.utils.consts.HEADER_CLSID&&d!==r)throw new Error("Bad PropertySet CLSID "+d);if(a=n.read_shift(4),a!==1&&a!==2)throw new Error("Unrecognized #Sets: "+a);if(i=n.read_shift(16),o=n.read_shift(4),a===1&&o!==n.l)throw new Error("Length mismatch: "+o+" !== "+n.l);a===2&&(s=n.read_shift(16),c=n.read_shift(4));var h=g4(n,t),p={SystemIdentifier:u};for(var v in h)p[v]=h[v];if(p.FMTID=i,a===1)return p;if(c-n.l==2&&(n.l+=2),n.l!==c)throw new Error("Length mismatch 2: "+n.l+" !== "+c);var x;try{x=g4(n,null)}catch{}for(v in x)p[v]=x[v];return p.FMTID=[i,s],p}function w4(e,t,r,n,a,i){var s=be(a?68:48),o=[s];s.write_shift(2,65534),s.write_shift(2,0),s.write_shift(4,842412599),s.write_shift(16,wt.utils.consts.HEADER_CLSID,"hex"),s.write_shift(4,a?2:1),s.write_shift(16,t,"hex"),s.write_shift(4,a?68:48);var c=x4(e,r,n);if(o.push(c),a){var u=x4(a,null,null);s.write_shift(16,i,"hex"),s.write_shift(4,68+c.length),o.push(u)}return Lr(o)}function Ms(e,t){return e.read_shift(t),null}function h7(e,t){t||(t=be(e));for(var r=0;r<e;++r)t.write_shift(1,0);return t}function p7(e,t,r){for(var n=[],a=e.l+t;e.l<a;)n.push(r(e,a-e.l));if(a!==e.l)throw new Error("Slurp error");return n}function Mr(e,t){return e.read_shift(t)===1}function On(e,t){return t||(t=be(2)),t.write_shift(2,+!!e),t}function Ir(e){return e.read_shift(2,"u")}function Ra(e,t){return t||(t=be(2)),t.write_shift(2,e),t}function sP(e,t){return p7(e,t,Ir)}function oP(e){var t=e.read_shift(1),r=e.read_shift(1);return r===1?t:t===1}function lP(e,t,r){return r||(r=be(2)),r.write_shift(1,t=="e"?+e:+!!e),r.write_shift(1,t=="e"?1:0),r}function zl(e,t,r){var n=e.read_shift(r&&r.biff>=12?2:1),a="sbcs-cont",i=Ba;if(r&&r.biff>=8&&(Ba=1200),!r||r.biff==8){var s=e.read_shift(1);s&&(a="dbcs-cont")}else r.biff==12&&(a="wstr");r.biff>=2&&r.biff<=5&&(a="cpstr");var o=n?e.read_shift(n,a):"";return Ba=i,o}function m7(e){var t=Ba;Ba=1200;var r=e.read_shift(2),n=e.read_shift(1),a=n&4,i=n&8,s=1+(n&1),o=0,c,u={};i&&(o=e.read_shift(2)),a&&(c=e.read_shift(4));var d=s==2?"dbcs-cont":"sbcs-cont",h=r===0?"":e.read_shift(r,d);return i&&(e.l+=4*o),a&&(e.l+=c),u.t=h,i||(u.raw="<t>"+u.t+"</t>",u.r=u.t),Ba=t,u}function v7(e){var t=e.t||"",r=be(3);r.write_shift(2,t.length),r.write_shift(1,1);var n=be(2*t.length);n.write_shift(2*t.length,t,"utf16le");var a=[r,n];return Lr(a)}function zo(e,t,r){var n;if(r){if(r.biff>=2&&r.biff<=5)return e.read_shift(t,"cpstr");if(r.biff>=12)return e.read_shift(t,"dbcs-cont")}var a=e.read_shift(1);return a===0?n=e.read_shift(t,"sbcs-cont"):n=e.read_shift(t,"dbcs-cont"),n}function Hf(e,t,r){var n=e.read_shift(r&&r.biff==2?1:2);return n===0?(e.l++,""):zo(e,n,r)}function Yo(e,t,r){if(r.biff>5)return Hf(e,t,r);var n=e.read_shift(1);return n===0?(e.l++,""):e.read_shift(n,r.biff<=4||!e.lens?"cpstr":"sbcs-cont")}function cP(e,t,r){return r||(r=be(3+2*e.length)),r.write_shift(2,e.length),r.write_shift(1,1),r.write_shift(31,e,"utf16le"),r}function g7(e){var t=e.read_shift(1);e.l++;var r=e.read_shift(2);return e.l+=2,[t,r]}function x7(e){var t=e.read_shift(4),r=e.l,n=!1;t>24&&(e.l+=t-24,e.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(n=!0),e.l=r);var a=e.read_shift((n?t-24:t)>>1,"utf16le").replace(ta,"");return n&&(e.l+=24),a}function y7(e){for(var t=e.read_shift(2),r="";t-- >0;)r+="../";var n=e.read_shift(0,"lpstr-ansi");if(e.l+=2,e.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var a=e.read_shift(4);if(a===0)return r+n.replace(/\\/g,"/");var i=e.read_shift(4);if(e.read_shift(2)!=3)throw new Error("Bad FileMoniker");var s=e.read_shift(i>>1,"utf16le").replace(ta,"");return r+s}function w7(e,t){var r=e.read_shift(16);switch(r){case"e0c9ea79f9bace118c8200aa004ba90b":return x7(e);case"0303000000000000c000000000000046":return y7(e);default:throw new Error("Unsupported Moniker "+r)}}function wd(e){var t=e.read_shift(4),r=t>0?e.read_shift(t,"utf16le").replace(ta,""):"";return r}function b4(e,t){t||(t=be(6+e.length*2)),t.write_shift(4,1+e.length);for(var r=0;r<e.length;++r)t.write_shift(2,e.charCodeAt(r));return t.write_shift(2,0),t}function b7(e,t){var r=e.l+t,n=e.read_shift(4);if(n!==2)throw new Error("Unrecognized streamVersion: "+n);var a=e.read_shift(2);e.l+=2;var i,s,o,c,u="",d,h;a&16&&(i=wd(e,r-e.l)),a&128&&(s=wd(e,r-e.l)),(a&257)===257&&(o=wd(e,r-e.l)),(a&257)===1&&(c=w7(e,r-e.l)),a&8&&(u=wd(e,r-e.l)),a&32&&(d=e.read_shift(16)),a&64&&(h=bb(e)),e.l=r;var p=s||o||c||"";p&&u&&(p+="#"+u),p||(p="#"+u),a&2&&p.charAt(0)=="/"&&p.charAt(1)!="/"&&(p="file://"+p);var v={Target:p};return d&&(v.guid=d),h&&(v.time=h),i&&(v.Tooltip=i),v}function _7(e){var t=be(512),r=0,n=e.Target;n.slice(0,7)=="file://"&&(n=n.slice(7));var a=n.indexOf("#"),i=a>-1?31:23;switch(n.charAt(0)){case"#":i=28;break;case".":i&=-3;break}t.write_shift(4,2),t.write_shift(4,i);var s=[8,6815827,6619237,4849780,83];for(r=0;r<s.length;++r)t.write_shift(4,s[r]);if(i==28)n=n.slice(1),b4(n,t);else if(i&2){for(s="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),r=0;r<s.length;++r)t.write_shift(1,parseInt(s[r],16));var o=a>-1?n.slice(0,a):n;for(t.write_shift(4,2*(o.length+1)),r=0;r<o.length;++r)t.write_shift(2,o.charCodeAt(r));t.write_shift(2,0),i&8&&b4(a>-1?n.slice(a+1):"",t)}else{for(s="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),r=0;r<s.length;++r)t.write_shift(1,parseInt(s[r],16));for(var c=0;n.slice(c*3,c*3+3)=="../"||n.slice(c*3,c*3+3)=="..\\";)++c;for(t.write_shift(2,c),t.write_shift(4,n.length-3*c+1),r=0;r<n.length-3*c;++r)t.write_shift(1,n.charCodeAt(r+3*c)&255);for(t.write_shift(1,0),t.write_shift(2,65535),t.write_shift(2,57005),r=0;r<6;++r)t.write_shift(4,0)}return t.slice(0,t.l)}function uP(e){var t=e.read_shift(1),r=e.read_shift(1),n=e.read_shift(1),a=e.read_shift(1);return[t,r,n,a]}function fP(e,t){var r=uP(e);return r[3]=0,r}function fi(e,t,r){var n=e.read_shift(2),a=e.read_shift(2),i={r:n,c:a,ixfe:0};if(r&&r.biff==2||t==7){var s=e.read_shift(1);i.ixfe=s&63,e.l+=2}else i.ixfe=e.read_shift(2);return i}function Wo(e,t,r,n){return n||(n=be(6)),n.write_shift(2,e),n.write_shift(2,t),n.write_shift(2,r||0),n}function S7(e){var t=e.read_shift(2),r=e.read_shift(2);return e.l+=8,{type:t,flags:r}}function k7(e,t,r){return t===0?"":Yo(e,t,r)}function E7(e,t,r){var n=r.biff>8?4:2,a=e.read_shift(n),i=e.read_shift(n,"i"),s=e.read_shift(n,"i");return[a,i,s]}function dP(e){var t=e.read_shift(2),r=np(e);return[t,r]}function T7(e,t,r){e.l+=4,t-=4;var n=e.l+t,a=zl(e,t,r),i=e.read_shift(2);if(n-=e.l,i!==n)throw new Error("Malformed AddinUdf: padding = "+n+" != "+i);return e.l+=i,a}function ap(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2),a=e.read_shift(2);return{s:{c:n,r:t},e:{c:a,r}}}function hP(e,t){return t||(t=be(8)),t.write_shift(2,e.s.r),t.write_shift(2,e.e.r),t.write_shift(2,e.s.c),t.write_shift(2,e.e.c),t}function pP(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(1),a=e.read_shift(1);return{s:{c:n,r:t},e:{c:a,r}}}var A7=pP;function mP(e){e.l+=4;var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2);return e.l+=12,[r,t,n]}function C7(e){var t={};return e.l+=4,e.l+=16,t.fSharedNote=e.read_shift(2),e.l+=4,t}function O7(e){var t={};return e.l+=4,e.cf=e.read_shift(2),t}function Tn(e){e.l+=2,e.l+=e.read_shift(2)}var N7={0:Tn,4:Tn,5:Tn,6:Tn,7:O7,8:Tn,9:Tn,10:Tn,11:Tn,12:Tn,13:C7,14:Tn,15:Tn,16:Tn,17:Tn,18:Tn,19:Tn,20:Tn,21:mP};function P7(e,t){for(var r=e.l+t,n=[];e.l<r;){var a=e.read_shift(2);e.l-=2;try{n[a]=N7[a](e,r-e.l)}catch{return e.l=r,n}}return e.l!=r&&(e.l=r),n}function bd(e,t){var r={BIFFVer:0,dt:0};switch(r.BIFFVer=e.read_shift(2),t-=2,t>=2&&(r.dt=e.read_shift(2),e.l-=2),r.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(t>6)throw new Error("Unexpected BIFF Ver "+r.BIFFVer)}return e.read_shift(t),r}function _b(e,t,r){var n=1536,a=16;switch(r.bookType){case"biff8":break;case"biff5":n=1280,a=8;break;case"biff4":n=4,a=6;break;case"biff3":n=3,a=6;break;case"biff2":n=2,a=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var i=be(a);return i.write_shift(2,n),i.write_shift(2,t),a>4&&i.write_shift(2,29282),a>6&&i.write_shift(2,1997),a>8&&(i.write_shift(2,49161),i.write_shift(2,1),i.write_shift(2,1798),i.write_shift(2,0)),i}function I7(e,t){return t===0||e.read_shift(2),1200}function F7(e,t,r){if(r.enc)return e.l+=t,"";var n=e.l,a=Yo(e,0,r);return e.read_shift(t+n-e.l),a}function D7(e,t){var r=!t||t.biff==8,n=be(r?112:54);for(n.write_shift(t.biff==8?2:1,7),r&&n.write_shift(1,0),n.write_shift(4,859007059),n.write_shift(4,5458548|(r?0:536870912));n.l<n.length;)n.write_shift(1,r?0:32);return n}function j7(e,t,r){var n=r&&r.biff==8||t==2?e.read_shift(2):(e.l+=t,0);return{fDialog:n&16,fBelow:n&64,fRight:n&128}}function R7(e,t,r){var n="";if(r.biff==4)return n=zl(e,0,r),n.length===0&&(n="Sheet1"),{name:n};var a=e.read_shift(4),i=e.read_shift(1)&3,s=e.read_shift(1);switch(s){case 0:s="Worksheet";break;case 1:s="Macrosheet";break;case 2:s="Chartsheet";break;case 6:s="VBAModule";break}return n=zl(e,0,r),n.length===0&&(n="Sheet1"),{pos:a,hs:i,dt:s,name:n}}function M7(e,t){var r=!t||t.biff>=8?2:1,n=be(8+r*e.name.length);n.write_shift(4,e.pos),n.write_shift(1,e.hs||0),n.write_shift(1,e.dt),n.write_shift(1,e.name.length),t.biff>=8&&n.write_shift(1,1),n.write_shift(r*e.name.length,e.name,t.biff<8?"sbcs":"utf16le");var a=n.slice(0,n.l);return a.l=n.l,a}function L7(e,t){for(var r=e.l+t,n=e.read_shift(4),a=e.read_shift(4),i=[],s=0;s!=a&&e.l<r;++s)i.push(m7(e));return i.Count=n,i.Unique=a,i}function B7(e,t){var r=be(8);r.write_shift(4,e.Count),r.write_shift(4,e.Unique);for(var n=[],a=0;a<e.length;++a)n[a]=v7(e[a]);var i=Lr([r].concat(n));return i.parts=[r.length].concat(n.map(function(s){return s.length})),i}function $7(e,t){var r={};return r.dsst=e.read_shift(2),e.l+=t-2,r}function U7(e){var t={};t.r=e.read_shift(2),t.c=e.read_shift(2),t.cnt=e.read_shift(2)-t.c;var r=e.read_shift(2);e.l+=4;var n=e.read_shift(1);return e.l+=3,n&7&&(t.level=n&7),n&32&&(t.hidden=!0),n&64&&(t.hpt=r/20),t}function z7(e){var t=S7(e);if(t.type!=2211)throw new Error("Invalid Future Record "+t.type);var r=e.read_shift(4);return r!==0}function W7(e){return e.read_shift(2),e.read_shift(4)}function _4(e,t,r){var n=0;r&&r.biff==2||(n=e.read_shift(2));var a=e.read_shift(2);r&&r.biff==2&&(n=1-(a>>15),a&=32767);var i={Unsynced:n&1,DyZero:(n&2)>>1,ExAsc:(n&4)>>2,ExDsc:(n&8)>>3};return[i,a]}function H7(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2),a=e.read_shift(2),i=e.read_shift(2),s=e.read_shift(2),o=e.read_shift(2),c=e.read_shift(2),u=e.read_shift(2);return{Pos:[t,r],Dim:[n,a],Flags:i,CurTab:s,FirstTab:o,Selected:c,TabRatio:u}}function q7(){var e=be(18);return e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,29280),e.write_shift(2,17600),e.write_shift(2,56),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,1),e.write_shift(2,500),e}function V7(e,t,r){if(r&&r.biff>=2&&r.biff<5)return{};var n=e.read_shift(2);return{RTL:n&64}}function X7(e){var t=be(18),r=1718;return e&&e.RTL&&(r|=64),t.write_shift(2,r),t.write_shift(4,0),t.write_shift(4,64),t.write_shift(4,0),t.write_shift(4,0),t}function G7(){}function K7(e,t,r){var n={dyHeight:e.read_shift(2),fl:e.read_shift(2)};switch(r&&r.biff||8){case 2:break;case 3:case 4:e.l+=2;break;default:e.l+=10;break}return n.name=zl(e,0,r),n}function Y7(e,t){var r=e.name||"Arial",n=t&&t.biff==5,a=n?15+r.length:16+2*r.length,i=be(a);return i.write_shift(2,e.sz*20),i.write_shift(4,0),i.write_shift(2,400),i.write_shift(4,0),i.write_shift(2,0),i.write_shift(1,r.length),n||i.write_shift(1,1),i.write_shift((n?1:2)*r.length,r,n?"sbcs":"utf16le"),i}function Z7(e,t,r){var n=fi(e,t,r);return n.isst=e.read_shift(4),n}function Q7(e,t,r,n){var a=be(10);return Wo(e,t,n,a),a.write_shift(4,r),a}function J7(e,t,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=e.l+t,a=fi(e,t,r),i=Hf(e,n-e.l,r);return a.val=i,a}function e9(e,t,r,n,a){var i=!a||a.biff==8,s=be(8+ +i+(1+i)*r.length);return Wo(e,t,n,s),s.write_shift(2,r.length),i&&s.write_shift(1,1),s.write_shift((1+i)*r.length,r,i?"utf16le":"sbcs"),s}function t9(e,t,r){var n=e.read_shift(2),a=Yo(e,0,r);return[n,a]}function r9(e,t,r,n){var a=r&&r.biff==5;n||(n=be(a?3+t.length:5+2*t.length)),n.write_shift(2,e),n.write_shift(a?1:2,t.length),a||n.write_shift(1,1),n.write_shift((a?1:2)*t.length,t,a?"sbcs":"utf16le");var i=n.length>n.l?n.slice(0,n.l):n;return i.l==null&&(i.l=i.length),i}var n9=Yo;function a9(e){var t=be(1+e.length);return t.write_shift(1,e.length),t.write_shift(e.length,e,"sbcs"),t}function i9(e){var t=be(3+e.length);return t.l+=2,t.write_shift(1,e.length),t.write_shift(e.length,e,"sbcs"),t}function S4(e,t,r){var n=e.l+t,a=r.biff==8||!r.biff?4:2,i=e.read_shift(a),s=e.read_shift(a),o=e.read_shift(2),c=e.read_shift(2);return e.l=n,{s:{r:i,c:o},e:{r:s,c}}}function s9(e,t){var r=t.biff==8||!t.biff?4:2,n=be(2*r+6);return n.write_shift(r,e.s.r),n.write_shift(r,e.e.r+1),n.write_shift(2,e.s.c),n.write_shift(2,e.e.c+1),n.write_shift(2,0),n}function o9(e){var t=e.read_shift(2),r=e.read_shift(2),n=dP(e);return{r:t,c:r,ixfe:n[0],rknum:n[1]}}function l9(e,t){for(var r=e.l+t-2,n=e.read_shift(2),a=e.read_shift(2),i=[];e.l<r;)i.push(dP(e));if(e.l!==r)throw new Error("MulRK read error");var s=e.read_shift(2);if(i.length!=s-a+1)throw new Error("MulRK length mismatch");return{r:n,c:a,C:s,rkrec:i}}function c9(e,t){for(var r=e.l+t-2,n=e.read_shift(2),a=e.read_shift(2),i=[];e.l<r;)i.push(e.read_shift(2));if(e.l!==r)throw new Error("MulBlank read error");var s=e.read_shift(2);if(i.length!=s-a+1)throw new Error("MulBlank length mismatch");return{r:n,c:a,C:s,ixfe:i}}function u9(e,t,r,n){var a={},i=e.read_shift(4),s=e.read_shift(4),o=e.read_shift(4),c=e.read_shift(2);return a.patternType=zL[o>>26],n.cellStyles&&(a.alc=i&7,a.fWrap=i>>3&1,a.alcV=i>>4&7,a.fJustLast=i>>7&1,a.trot=i>>8&255,a.cIndent=i>>16&15,a.fShrinkToFit=i>>20&1,a.iReadOrder=i>>22&2,a.fAtrNum=i>>26&1,a.fAtrFnt=i>>27&1,a.fAtrAlc=i>>28&1,a.fAtrBdr=i>>29&1,a.fAtrPat=i>>30&1,a.fAtrProt=i>>31&1,a.dgLeft=s&15,a.dgRight=s>>4&15,a.dgTop=s>>8&15,a.dgBottom=s>>12&15,a.icvLeft=s>>16&127,a.icvRight=s>>23&127,a.grbitDiag=s>>30&3,a.icvTop=o&127,a.icvBottom=o>>7&127,a.icvDiag=o>>14&127,a.dgDiag=o>>21&15,a.icvFore=c&127,a.icvBack=c>>7&127,a.fsxButton=c>>14&1),a}function f9(e,t,r){var n={};return n.ifnt=e.read_shift(2),n.numFmtId=e.read_shift(2),n.flags=e.read_shift(2),n.fStyle=n.flags>>2&1,t-=6,n.data=u9(e,t,n.fStyle,r),n}function k4(e,t,r,n){var a=r&&r.biff==5;n||(n=be(a?16:20)),n.write_shift(2,0),e.style?(n.write_shift(2,e.numFmtId||0),n.write_shift(2,65524)):(n.write_shift(2,e.numFmtId||0),n.write_shift(2,t<<4));var i=0;return e.numFmtId>0&&a&&(i|=1024),n.write_shift(4,i),n.write_shift(4,0),a||n.write_shift(4,0),n.write_shift(2,0),n}function d9(e){var t={};return t.ifnt=e.read_shift(1),e.l++,t.flags=e.read_shift(1),t.numFmtId=t.flags&63,t.flags>>=6,t.fStyle=0,t.data={},t}function h9(e){var t=be(4);return t.l+=2,t.write_shift(1,e.numFmtId),t.l++,t}function vP(e){var t=be(12);return t.l++,t.write_shift(1,e.numFmtId),t.l+=10,t}var p9=vP;function m9(e){var t={};return t.ifnt=e.read_shift(1),t.numFmtId=e.read_shift(1),t.flags=e.read_shift(2),t.fStyle=t.flags>>2&1,t.data={},t}function v9(e){var t={};return t.ifnt=e.read_shift(1),t.numFmtId=e.read_shift(1),t.flags=e.read_shift(2),t.fStyle=t.flags>>2&1,t.data={},t}function g9(e){e.l+=4;var t=[e.read_shift(2),e.read_shift(2)];if(t[0]!==0&&t[0]--,t[1]!==0&&t[1]--,t[0]>7||t[1]>7)throw new Error("Bad Gutters: "+t.join("|"));return t}function x9(e){var t=be(8);return t.write_shift(4,0),t.write_shift(2,0),t.write_shift(2,0),t}function y9(e,t,r){var n=fi(e,6,r),a=oP(e);return n.val=a,n.t=a===!0||a===!1?"b":"e",n}function U1(e,t,r,n,a,i){var s=be(8);return Wo(e,t,n,s),lP(r,i,s),s}function w9(e,t,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=fi(e,6,r),a=In(e);return n.val=a,n}function b9(e,t,r,n){var a=be(14);return Wo(e,t,n,a),Uo(r,a),a}var E4=k7;function _9(e,t,r){var n=e.l+t,a=e.read_shift(2),i=e.read_shift(2);if(r.sbcch=i,i==1025||i==14849)return[i,a];if(i<1||i>255)throw new Error("Unexpected SupBook type: "+i);for(var s=zo(e,i),o=[];n>e.l;)o.push(Hf(e));return[i,a,s,o]}function T4(e,t,r){var n=e.read_shift(2),a,i={fBuiltIn:n&1,fWantAdvise:n>>>1&1,fWantPict:n>>>2&1,fOle:n>>>3&1,fOleLink:n>>>4&1,cf:n>>>5&1023,fIcon:n>>>15&1};return r.sbcch===14849&&(a=T7(e,t-2,r)),i.body=a||e.read_shift(t-2),typeof a=="string"&&(i.Name=a),i}function A4(e,t,r){var n=e.l+t,a=e.read_shift(2),i=e.read_shift(1),s=e.read_shift(1),o=e.read_shift(r&&r.biff==2?1:2),c=0;(!r||r.biff>=5)&&(r.biff!=5&&(e.l+=2),c=e.read_shift(2),r.biff==5&&(e.l+=2),e.l+=4);var u=zo(e,s,r);a&32&&(u=yb[u.charCodeAt(0)]);var d=n-e.l;r&&r.biff==2&&--d;var h=n==e.l||o===0||!(d>0)?[]:Rz(e,d,r,o);return{chKey:i,Name:u,itab:c,rgce:h}}function gP(e,t,r){if(r.biff<8||!(r.biff>8)&&t==e[e.l]+(e[e.l+1]==3?1:0)+1)return C4(e,t,r);for(var n=[],a=e.l+t,i=e.read_shift(r.biff>8?4:2);i--!==0;)n.push(E7(e,r.biff>8?12:6,r));if(e.l!=a)throw new Error("Bad ExternSheet: "+e.l+" != "+a);return n}function C4(e,t,r){e[e.l+1]==3&&e[e.l]++;var n=zl(e,t,r);return n.charCodeAt(0)==3?n.slice(1):n}function S9(e,t,r){if(r.biff<8){e.l+=t;return}var n=e.read_shift(2),a=e.read_shift(2),i=zo(e,n,r),s=zo(e,a,r);return[i,s]}function k9(e,t,r){var n=pP(e);e.l++;var a=e.read_shift(1);return t-=8,[Mz(e,t,r),a,n]}function O4(e,t,r){var n=A7(e);switch(r.biff){case 2:e.l++,t-=7;break;case 3:case 4:e.l+=2,t-=8;break;default:e.l+=6,t-=12}return[n,Dz(e,t,r)]}function E9(e){var t=e.read_shift(4)!==0,r=e.read_shift(4)!==0,n=e.read_shift(4);return[t,r,n]}function T9(e,t,r){var n=e.read_shift(2),a=e.read_shift(2),i=e.read_shift(2),s=e.read_shift(2),o=Yo(e,0,r);return[{r:n,c:a},o,s,i]}function A9(e,t,r){if(r&&r.biff<8){var n=e.read_shift(2),a=e.read_shift(2);if(n==65535||n==-1)return;var i=e.read_shift(2),s=e.read_shift(Math.min(i,2048),"cpstr");return[{r:n,c:a},s]}return T9(e,t,r)}function z1(e,t,r,n){var a=be(6+(n||e.length));return a.write_shift(2,t),a.write_shift(2,r),a.write_shift(2,n||e.length),a.write_shift(e.length,e,"sbcs"),a}function C9(e,t){for(var r=[],n=e.read_shift(2);n--;)r.push(ap(e));return r}function O9(e){var t=be(2+e.length*8);t.write_shift(2,e.length);for(var r=0;r<e.length;++r)hP(e[r],t);return t}function N9(e,t,r){if(r&&r.biff<8)return I9(e,t,r);var n=mP(e),a=P7(e,t-22,n[1]);return{cmo:n,ft:a}}var P9={8:function(e,t){var r=e.l+t;e.l+=10;var n=e.read_shift(2);e.l+=4,e.l+=2,e.l+=2,e.l+=2,e.l+=4;var a=e.read_shift(1);return e.l+=a,e.l=r,{fmt:n}}};function I9(e,t,r){e.l+=4;var n=e.read_shift(2),a=e.read_shift(2),i=e.read_shift(2);e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=6,t-=36;var s=[];return s.push((P9[n]||Rn)(e,t,r)),{cmo:[a,n,i],ft:s}}function F9(e,t,r){var n=e.l,a="";try{e.l+=4;var i=(r.lastobj||{cmo:[0,0]}).cmo[1],s;[0,5,7,11,12,14].indexOf(i)==-1?e.l+=6:s=g7(e,6,r);var o=e.read_shift(2);e.read_shift(2),Ir(e,2);var c=e.read_shift(2);e.l+=c;for(var u=1;u<e.lens.length-1;++u){if(e.l-n!=e.lens[u])throw new Error("TxO: bad continue record");var d=e[e.l],h=zo(e,e.lens[u+1]-e.lens[u]-1);if(a+=h,a.length>=(d?o:2*o))break}if(a.length!==o&&a.length!==o*2)throw new Error("cchText: "+o+" != "+a.length);return e.l=n+t,{t:a}}catch{return e.l=n+t,{t:a}}}function D9(e,t){var r=ap(e);e.l+=16;var n=b7(e,t-24);return[r,n]}function j9(e){var t=be(24),r=sr(e[0]);t.write_shift(2,r.r),t.write_shift(2,r.r),t.write_shift(2,r.c),t.write_shift(2,r.c);for(var n="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),a=0;a<16;++a)t.write_shift(1,parseInt(n[a],16));return Lr([t,_7(e[1])])}function R9(e,t){e.read_shift(2);var r=ap(e),n=e.read_shift((t-10)/2,"dbcs-cont");return n=n.replace(ta,""),[r,n]}function M9(e){var t=e[1].Tooltip,r=be(10+2*(t.length+1));r.write_shift(2,2048);var n=sr(e[0]);r.write_shift(2,n.r),r.write_shift(2,n.r),r.write_shift(2,n.c),r.write_shift(2,n.c);for(var a=0;a<t.length;++a)r.write_shift(2,t.charCodeAt(a));return r.write_shift(2,0),r}function L9(e){var t=[0,0],r;return r=e.read_shift(2),t[0]=h4[r]||r,r=e.read_shift(2),t[1]=h4[r]||r,t}function B9(e){return e||(e=be(4)),e.write_shift(2,1),e.write_shift(2,1),e}function $9(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(fP(e));return r}function U9(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(fP(e));return r}function z9(e){e.l+=2;var t={cxfs:0,crc:0};return t.cxfs=e.read_shift(2),t.crc=e.read_shift(4),t}function xP(e,t,r){if(!r.cellStyles)return Rn(e,t);var n=r&&r.biff>=12?4:2,a=e.read_shift(n),i=e.read_shift(n),s=e.read_shift(n),o=e.read_shift(n),c=e.read_shift(2);n==2&&(e.l+=2);var u={s:a,e:i,w:s,ixfe:o,flags:c};return(r.biff>=5||!r.biff)&&(u.level=c>>8&7),u}function W9(e,t){var r=be(12);r.write_shift(2,t),r.write_shift(2,t),r.write_shift(2,e.width*256),r.write_shift(2,0);var n=0;return e.hidden&&(n|=1),r.write_shift(1,n),n=e.level||0,r.write_shift(1,n),r.write_shift(2,0),r}function H9(e,t){var r={};return t<32||(e.l+=16,r.header=In(e),r.footer=In(e),e.l+=2),r}function q9(e,t,r){var n={area:!1};if(r.biff!=5)return e.l+=t,n;var a=e.read_shift(1);return e.l+=3,a&16&&(n.area=!0),n}function V9(e){for(var t=be(2*e),r=0;r<e;++r)t.write_shift(2,r+1);return t}var X9=fi,G9=sP,K9=Hf;function Y9(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(4),a={fmt:t,env:r,len:n,data:e.slice(e.l,e.l+n)};return e.l+=n,a}function qf(e,t,r,n,a){return e||(e=be(7)),e.write_shift(2,t),e.write_shift(2,r),e.write_shift(1,n||0),e.write_shift(1,a||0),e.write_shift(1,0),e}function Z9(e,t,r){r.biffguess&&r.biff==5&&(r.biff=2);var n=fi(e,7,r),a=Yo(e,t-7,r);return n.t="str",n.val=a,n}function Q9(e,t,r){var n=fi(e,7,r),a=In(e);return n.t="n",n.val=a,n}function J9(e,t,r,n,a){var i=be(15);return qf(i,e,t,n||0,a||0),i.write_shift(8,r,"f"),i}function eB(e,t,r){var n=fi(e,7,r),a=e.read_shift(2);return n.t="n",n.val=a,n}function tB(e,t,r,n,a){var i=be(9);return qf(i,e,t,n||0,a||0),i.write_shift(2,r),i}function rB(e){var t=e.read_shift(1);return t===0?(e.l++,""):e.read_shift(t,"sbcs-cont")}function nB(e,t,r){var n=e.l+7,a=fi(e,6,r);e.l=n;var i=oP(e);return a.val=i,a.t=i===!0||i===!1?"b":"e",a}function aB(e,t){e.l+=6,e.l+=2,e.l+=1,e.l+=3,e.l+=1,e.l+=t-13}function iB(e,t,r){var n=e.l+t,a=fi(e,6,r),i=e.read_shift(2),s=zo(e,i,r);return e.l=n,a.t="str",a.val=s,a}function sB(e){var t=e.read_shift(4),r=e.read_shift(1),n=e.read_shift(r,"sbcs");return n.length===0&&(n="Sheet1"),{flags:t,name:n}}var oB=[2,3,48,49,131,139,140,245],A2=(function(){var e={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},t=Qh({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function r(o,c){var u=[],d=Hs(1);switch(c.type){case"base64":d=zn(pa(o));break;case"binary":d=zn(o);break;case"buffer":case"array":d=o;break}Yr(d,0);var h=d.read_shift(1),p=!!(h&136),v=!1,x=!1;switch(h){case 2:break;case 3:break;case 48:v=!0,p=!0;break;case 49:v=!0,p=!0;break;case 131:break;case 139:break;case 140:x=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+h.toString(16))}var w=0,y=521;h==2&&(w=d.read_shift(2)),d.l+=3,h!=2&&(w=d.read_shift(4)),w>1048576&&(w=1e6),h!=2&&(y=d.read_shift(2));var _=d.read_shift(2);c.codepage,h!=2&&(d.l+=16,d.read_shift(1),d[d.l]!==0&&e[d[d.l]],d.l+=1,d.l+=2),x&&(d.l+=36);for(var S=[],k={},E=Math.min(d.length,h==2?521:y-10-(v?264:0)),T=x?32:11;d.l<E&&d[d.l]!=13;)switch(k={},k.name=Pi(d.slice(d.l,d.l+T)).replace(/[\u0000\r\n][\S\s]*$/g,""),d.l+=T,k.type=String.fromCharCode(d.read_shift(1)),h!=2&&!x&&(k.offset=d.read_shift(4)),k.len=d.read_shift(1),h==2&&(k.offset=d.read_shift(2)),k.dec=d.read_shift(1),k.name.length&&S.push(k),h!=2&&(d.l+=x?13:14),k.type){case"B":(!v||k.len!=8)&&c.WTF&&console.log("Skipping "+k.name+":"+k.type);break;case"G":case"P":c.WTF&&console.log("Skipping "+k.name+":"+k.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+k.type)}if(d[d.l]!==13&&(d.l=y-1),d.read_shift(1)!==13)throw new Error("DBF Terminator not found "+d.l+" "+d[d.l]);d.l=y;var N=0,C=0;for(u[0]=[],C=0;C!=S.length;++C)u[0][C]=S[C].name;for(;w-- >0;){if(d[d.l]===42){d.l+=_;continue}for(++d.l,u[++N]=[],C=0,C=0;C!=S.length;++C){var P=d.slice(d.l,d.l+S[C].len);d.l+=S[C].len,Yr(P,0);var j=Pi(P);switch(S[C].type){case"C":j.trim().length&&(u[N][C]=j.replace(/([^\s])\s+$/,"$1"));break;case"D":j.length===8?(u[N][C]=new Date(Date.UTC(+j.slice(0,4),+j.slice(4,6)-1,+j.slice(6,8),0,0,0,0)),c&&c.UTC||(u[N][C]=$o(u[N][C]))):u[N][C]=j;break;case"F":u[N][C]=parseFloat(j.trim());break;case"+":case"I":u[N][C]=x?P.read_shift(-4,"i")^2147483648:P.read_shift(4,"i");break;case"L":switch(j.trim().toUpperCase()){case"Y":case"T":u[N][C]=!0;break;case"N":case"F":u[N][C]=!1;break;case"":case"\0":case"?":break;default:throw new Error("DBF Unrecognized L:|"+j+"|")}break;case"M":if(!p)throw new Error("DBF Unexpected MEMO for type "+h.toString(16));u[N][C]="##MEMO##"+(x?parseInt(j.trim(),10):P.read_shift(4));break;case"N":j=j.replace(/\u0000/g,"").trim(),j&&j!="."&&(u[N][C]=+j||0);break;case"@":u[N][C]=new Date(P.read_shift(-8,"f")-621356832e5);break;case"T":{var R=P.read_shift(4),I=P.read_shift(4);if(R==0&&I==0)break;u[N][C]=new Date((R-2440588)*864e5+I),c&&c.UTC||(u[N][C]=$o(u[N][C]))}break;case"Y":u[N][C]=P.read_shift(4,"i")/1e4+P.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":u[N][C]=-P.read_shift(-8,"f");break;case"B":if(v&&S[C].len==8){u[N][C]=P.read_shift(8,"f");break}case"G":case"P":P.l+=S[C].len;break;case"0":if(S[C].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+S[C].type)}}}if(h!=2&&d.l<d.length&&d[d.l++]!=26)throw new Error("DBF EOF Marker missing "+(d.l-1)+" of "+d.length+" "+d[d.l-1].toString(16));return c&&c.sheetRows&&(u=u.slice(0,c.sheetRows)),c.DBF=S,u}function n(o,c){var u=c||{};u.dateNF||(u.dateNF="yyyymmdd");var d=hc(r(o,u),u);return d["!cols"]=u.DBF.map(function(h){return{wch:h.len,DBF:h}}),delete u.DBF,d}function a(o,c){try{var u=Ys(n(o,c),c);return u.bookType="dbf",u}catch(d){if(c&&c.WTF)throw d}return{SheetNames:[],Sheets:{}}}var i={B:8,C:250,L:1,D:8,"?":0,"":0};function s(o,c){if(!o["!ref"])throw new Error("Cannot export empty sheet to DBF");var u=c||{},d=Ba;if(+u.codepage>=0&&ii(+u.codepage),u.type=="string")throw new Error("Cannot write DBF to JS string");var h=Dn(),p=I2(o,{header:1,raw:!0,cellDates:!0}),v=p[0],x=p.slice(1),w=o["!cols"]||[],y=0,_=0,S=0,k=1;for(y=0;y<v.length;++y){if(((w[y]||{}).DBF||{}).name){v[y]=w[y].DBF.name,++S;continue}if(v[y]!=null){if(++S,typeof v[y]=="number"&&(v[y]=v[y].toString(10)),typeof v[y]!="string")throw new Error("DBF Invalid column name "+v[y]+" |"+typeof v[y]+"|");if(v.indexOf(v[y])!==y){for(_=0;_<1024;++_)if(v.indexOf(v[y]+"_"+_)==-1){v[y]+="_"+_;break}}}}var E=Kt(o["!ref"]),T=[],N=[],C=[];for(y=0;y<=E.e.c-E.s.c;++y){var P="",j="",R=0,I=[];for(_=0;_<x.length;++_)x[_][y]!=null&&I.push(x[_][y]);if(I.length==0||v[y]==null){T[y]="?";continue}for(_=0;_<I.length;++_){switch(typeof I[_]){case"number":j="B";break;case"string":j="C";break;case"boolean":j="L";break;case"object":j=I[_]instanceof Date?"D":"C";break;default:j="C"}R=Math.max(R,String(I[_]).length),P=P&&P!=j?"C":j}R>250&&(R=250),j=((w[y]||{}).DBF||{}).type,j=="C"&&w[y].DBF.len>R&&(R=w[y].DBF.len),P=="B"&&j=="N"&&(P="N",C[y]=w[y].DBF.dec,R=w[y].DBF.len),N[y]=P=="C"||j=="N"?R:i[P]||0,k+=N[y],T[y]=P}var F=h.next(32);for(F.write_shift(4,318902576),F.write_shift(4,x.length),F.write_shift(2,296+32*S),F.write_shift(2,k),y=0;y<4;++y)F.write_shift(4,0);var L=+t[Ba]||3;for(F.write_shift(4,0|L<<8),e[L]!=+u.codepage&&(u.codepage&&console.error("DBF Unsupported codepage "+Ba+", using 1252"),Ba=1252),y=0,_=0;y<v.length;++y)if(v[y]!=null){var H=h.next(32),V=(v[y].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);H.write_shift(1,V,"sbcs"),H.write_shift(1,T[y]=="?"?"C":T[y],"sbcs"),H.write_shift(4,_),H.write_shift(1,N[y]||i[T[y]]||0),H.write_shift(1,C[y]||0),H.write_shift(1,2),H.write_shift(4,0),H.write_shift(1,0),H.write_shift(4,0),H.write_shift(4,0),_+=N[y]||i[T[y]]||0}var J=h.next(264);for(J.write_shift(4,13),y=0;y<65;++y)J.write_shift(4,0);for(y=0;y<x.length;++y){var te=h.next(k);for(te.write_shift(1,0),_=0;_<v.length;++_)if(v[_]!=null)switch(T[_]){case"L":te.write_shift(1,x[y][_]==null?63:x[y][_]?84:70);break;case"B":te.write_shift(8,x[y][_]||0,"f");break;case"N":var q="0";for(typeof x[y][_]=="number"&&(q=x[y][_].toFixed(C[_]||0)),q.length>N[_]&&(q=q.slice(0,N[_])),S=0;S<N[_]-q.length;++S)te.write_shift(1,32);te.write_shift(1,q,"sbcs");break;case"D":x[y][_]?(te.write_shift(4,("0000"+x[y][_].getFullYear()).slice(-4),"sbcs"),te.write_shift(2,("00"+(x[y][_].getMonth()+1)).slice(-2),"sbcs"),te.write_shift(2,("00"+x[y][_].getDate()).slice(-2),"sbcs")):te.write_shift(8,"00000000","sbcs");break;case"C":var oe=te.l,Q=String(x[y][_]!=null?x[y][_]:"").slice(0,N[_]);for(te.write_shift(1,Q,"cpstr"),oe+=N[_]-te.l,S=0;S<oe;++S)te.write_shift(1,32);break}}return Ba=d,h.next(1).write_shift(1,26),h.end()}return{to_workbook:a,to_sheet:n,from_sheet:s}})(),yP=(function(){var e={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},t=new RegExp("\x1BN("+_r(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1").replace("{","\\{")+"|\\|)","gm");try{t=new RegExp("\x1BN("+_r(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm")}catch{}var r=function(v,x){var w=e[x];return typeof w=="number"?$E(w):w},n=function(v,x,w){var y=x.charCodeAt(0)-32<<4|w.charCodeAt(0)-48;return y==59?v:$E(y)};e["|"]=254;var a=function(v){return v.replace(/\n/g,"\x1B :").replace(/\r/g,"\x1B =")};function i(v,x){switch(x.type){case"base64":return s(pa(v),x);case"binary":return s(v,x);case"buffer":return s(It&&Buffer.isBuffer(v)?v.toString("binary"):Pi(v),x);case"array":return s(Bo(v),x)}throw new Error("Unrecognized type "+x.type)}function s(v,x){var w=v.split(/[\n\r]+/),y=-1,_=-1,S=0,k=0,E=[],T=[],N=null,C={},P=[],j=[],R=[],I=0,F,L={Workbook:{WBProps:{},Names:[]}};for(+x.codepage>=0&&ii(+x.codepage);S!==w.length;++S){I=0;var H=w[S].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,n).replace(t,r),V=H.replace(/;;/g,"\0").split(";").map(function(X){return X.replace(/\u0000/g,";")}),J=V[0],te;if(H.length>0)switch(J){case"ID":break;case"E":break;case"B":break;case"O":for(k=1;k<V.length;++k)switch(V[k].charAt(0)){case"V":{var q=parseInt(V[k].slice(1),10);q>=1&&q<=4&&(L.Workbook.WBProps.date1904=!0)}break}break;case"W":break;case"P":switch(V[1].charAt(0)){case"P":T.push(H.slice(3).replace(/;;/g,";"));break}break;case"NN":{var oe={Sheet:0};for(k=1;k<V.length;++k)switch(V[k].charAt(0)){case"N":oe.Name=V[k].slice(1);break;case"E":oe.Ref=(x&&x.sheet||"Sheet1")+"!"+Fo(V[k].slice(1));break}L.Workbook.Names.push(oe)}break;case"C":var Q=!1,Z=!1,ee=!1,ce=!1,de=-1,Te=-1,Ie="",Ne="z",W="";for(k=1;k<V.length;++k)switch(V[k].charAt(0)){case"A":W=V[k].slice(1);break;case"X":_=parseInt(V[k].slice(1),10)-1,Z=!0;break;case"Y":for(y=parseInt(V[k].slice(1),10)-1,Z||(_=0),F=E.length;F<=y;++F)E[F]=[];break;case"K":te=V[k].slice(1),te.charAt(0)==='"'?(te=te.slice(1,te.length-1),Ne="s"):te==="TRUE"||te==="FALSE"?(te=te==="TRUE",Ne="b"):te.charAt(0)=="#"&&dn[te]!=null?(Ne="e",te=dn[te]):isNaN(ha(te))||(te=ha(te),Ne="n",N!==null&&Ha(N)&&x.cellDates&&(te=Ji(L.Workbook.WBProps.date1904?te+1462:te),Ne=typeof te=="number"?"n":"d")),Q=!0;break;case"E":ce=!0,Ie=Fo(V[k].slice(1),{r:y,c:_});break;case"S":ee=!0;break;case"G":break;case"R":de=parseInt(V[k].slice(1),10)-1;break;case"C":Te=parseInt(V[k].slice(1),10)-1;break;default:if(x&&x.WTF)throw new Error("SYLK bad record "+H)}if(Q&&(E[y][_]?(E[y][_].t=Ne,E[y][_].v=te):E[y][_]={t:Ne,v:te},N&&(E[y][_].z=N),x.cellText!==!1&&N&&(E[y][_].w=ma(E[y][_].z,E[y][_].v,{date1904:L.Workbook.WBProps.date1904})),N=null),ee){if(ce)throw new Error("SYLK shared formula cannot have own formula");var z=de>-1&&E[de][Te];if(!z||!z[1])throw new Error("SYLK shared formula cannot find base");Ie=FP(z[1],{r:y-de,c:_-Te})}Ie&&(E[y][_]?E[y][_].f=Ie:E[y][_]={t:"n",f:Ie}),W&&(E[y][_]||(E[y][_]={t:"z"}),E[y][_].c=[{a:"SheetJSYLK",t:W}]);break;case"F":var G=0;for(k=1;k<V.length;++k)switch(V[k].charAt(0)){case"X":_=parseInt(V[k].slice(1),10)-1,++G;break;case"Y":for(y=parseInt(V[k].slice(1),10)-1,F=E.length;F<=y;++F)E[F]=[];break;case"M":I=parseInt(V[k].slice(1),10)/20;break;case"F":break;case"G":break;case"P":N=T[parseInt(V[k].slice(1),10)];break;case"S":break;case"D":break;case"N":break;case"W":for(R=V[k].slice(1).split(" "),F=parseInt(R[0],10);F<=parseInt(R[1],10);++F)I=parseInt(R[2],10),j[F-1]=I===0?{hidden:!0}:{wch:I};break;case"C":_=parseInt(V[k].slice(1),10)-1,j[_]||(j[_]={});break;case"R":y=parseInt(V[k].slice(1),10)-1,P[y]||(P[y]={}),I>0?(P[y].hpt=I,P[y].hpx=Hl(I)):I===0&&(P[y].hidden=!0);break;default:if(x&&x.WTF)throw new Error("SYLK bad record "+H)}G<1&&(N=null);break;default:if(x&&x.WTF)throw new Error("SYLK bad record "+H)}}return P.length>0&&(C["!rows"]=P),j.length>0&&(C["!cols"]=j),j.forEach(function(X){qs(X)}),x&&x.sheetRows&&(E=E.slice(0,x.sheetRows)),[E,C,L]}function o(v,x){var w=i(v,x),y=w[0],_=w[1],S=w[2],k=dr(x);k.date1904=(((S||{}).Workbook||{}).WBProps||{}).date1904;var E=hc(y,k);_r(_).forEach(function(N){E[N]=_[N]});var T=Ys(E,x);return _r(S).forEach(function(N){T[N]=S[N]}),T.bookType="sylk",T}function c(v,x,w,y,_,S){var k="C;Y"+(w+1)+";X"+(y+1)+";K";switch(v.t){case"n":k+=isFinite(v.v)?v.v||0:tn[isNaN(v.v)?36:7],v.f&&!v.F&&(k+=";E"+sp(v.f,{r:w,c:y}));break;case"b":k+=v.v?"TRUE":"FALSE";break;case"e":k+=v.w||tn[v.v]||v.v;break;case"d":k+=Or(Tr(v.v,S),S);break;case"s":k+='"'+(v.v==null?"":String(v.v)).replace(/"/g,"").replace(/;/g,";;")+'"';break}return k}function u(v,x,w){var y="C;Y"+(x+1)+";X"+(w+1)+";A";return y+=a(v.map(function(_){return _.t}).join("")),y}function d(v,x){x.forEach(function(w,y){var _="F;W"+(y+1)+" "+(y+1)+" ";w.hidden?_+="0":(typeof w.width=="number"&&!w.wpx&&(w.wpx=Xu(w.width)),typeof w.wpx=="number"&&!w.wch&&(w.wch=Gu(w.wpx)),typeof w.wch=="number"&&(_+=Math.round(w.wch))),_.charAt(_.length-1)!=" "&&v.push(_)})}function h(v,x){x.forEach(function(w,y){var _="F;";w.hidden?_+="M0;":w.hpt?_+="M"+20*w.hpt+";":w.hpx&&(_+="M"+20*Ku(w.hpx)+";"),_.length>2&&v.push(_+"R"+(y+1))})}function p(v,x,w){x||(x={}),x._formats=["General"];var y=["ID;PSheetJS;N;E"],_=[],S=Kt(v["!ref"]||"A1"),k,E=v["!data"]!=null,T=`\r
`,N=(((w||{}).Workbook||{}).WBProps||{}).date1904,C="General";y.push("P;PGeneral");var P=S.s.r,j=S.s.c,R=[];if(v["!ref"]){for(P=S.s.r;P<=S.e.r;++P)if(!(E&&!v["!data"][P])){for(R=[],j=S.s.c;j<=S.e.c;++j)k=E?v["!data"][P][j]:v[Ft(j)+Ut(P)],!(!k||!k.c)&&R.push(u(k.c,P,j));R.length&&_.push(R.join(T))}}if(v["!ref"]){for(P=S.s.r;P<=S.e.r;++P)if(!(E&&!v["!data"][P])){for(R=[],j=S.s.c;j<=S.e.c;++j)if(k=E?v["!data"][P][j]:v[Ft(j)+Ut(P)],!(!k||k.v==null&&(!k.f||k.F))){if((k.z||(k.t=="d"?yt[14]:"General"))!=C){var I=x._formats.indexOf(k.z);I==-1&&(x._formats.push(k.z),I=x._formats.length-1,y.push("P;P"+k.z.replace(/;/g,";;"))),R.push("F;P"+I+";Y"+(P+1)+";X"+(j+1))}R.push(c(k,v,P,j,x,N))}_.push(R.join(T))}}return y.push("F;P0;DG0G8;M255"),v["!cols"]&&d(y,v["!cols"]),v["!rows"]&&h(y,v["!rows"]),v["!ref"]&&y.push("B;Y"+(S.e.r-S.s.r+1)+";X"+(S.e.c-S.s.c+1)+";D"+[S.s.c,S.s.r,S.e.c,S.e.r].join(" ")),y.push("O;L;D;B"+(N?";V4":"")+";K47;G100 0.001"),delete x._formats,y.join(T)+T+_.join(T)+T+"E"+T}return{to_workbook:o,from_sheet:p}})(),wP=(function(){function e(o,c){switch(c.type){case"base64":return t(pa(o),c);case"binary":return t(o,c);case"buffer":return t(It&&Buffer.isBuffer(o)?o.toString("binary"):Pi(o),c);case"array":return t(Bo(o),c)}throw new Error("Unrecognized type "+c.type)}function t(o,c){for(var u=o.split(`
`),d=-1,h=-1,p=0,v=[];p!==u.length;++p){if(u[p].trim()==="BOT"){v[++d]=[],h=0;continue}if(!(d<0)){var x=u[p].trim().split(","),w=x[0],y=x[1];++p;for(var _=u[p]||"";(_.match(/["]/g)||[]).length&1&&p<u.length-1;)_+=`
`+u[++p];switch(_=_.trim(),+w){case-1:if(_==="BOT"){v[++d]=[],h=0;continue}else if(_!=="EOD")throw new Error("Unrecognized DIF special command "+_);break;case 0:_==="TRUE"?v[d][h]=!0:_==="FALSE"?v[d][h]=!1:isNaN(ha(y))?isNaN($u(y).getDate())?v[d][h]=y:(v[d][h]=Tr(y),c&&c.UTC||(v[d][h]=$o(v[d][h]))):v[d][h]=ha(y),++h;break;case 1:_=_.slice(1,_.length-1),_=_.replace(/""/g,'"'),_&&_.match(/^=".*"$/)&&(_=_.slice(2,-1)),v[d][h++]=_!==""?_:null;break}if(_==="EOD")break}}return c&&c.sheetRows&&(v=v.slice(0,c.sheetRows)),v}function r(o,c){return hc(e(o,c),c)}function n(o,c){var u=Ys(r(o,c),c);return u.bookType="dif",u}function a(o,c){return"0,"+String(o)+`\r
`+c}function i(o){return`1,0\r
"`+o.replace(/"/g,'""')+'"'}function s(o){if(!o["!ref"])throw new Error("Cannot export empty sheet to DIF");for(var c=Kt(o["!ref"]),u=o["!data"]!=null,d=[`TABLE\r
0,1\r
"sheetjs"\r
`,`VECTORS\r
0,`+(c.e.r-c.s.r+1)+`\r
""\r
`,`TUPLES\r
0,`+(c.e.c-c.s.c+1)+`\r
""\r
`,`DATA\r
0,0\r
""\r
`],h=c.s.r;h<=c.e.r;++h){for(var p=u?o["!data"][h]:[],v=`-1,0\r
BOT\r
`,x=c.s.c;x<=c.e.c;++x){var w=u?p&&p[x]:o[Rt({r:h,c:x})];if(w==null){v+=`1,0\r
""\r
`;continue}switch(w.t){case"n":w.w!=null?v+="0,"+w.w+`\r
V`:w.v!=null?v+=a(w.v,"V"):w.f!=null&&!w.F?v+=i("="+w.f):v+=`1,0\r
""`;break;case"b":v+=w.v?a(1,"TRUE"):a(0,"FALSE");break;case"s":v+=i(isNaN(+w.v)?w.v:'="'+w.v+'"');break;case"d":w.w||(w.w=ma(w.z||yt[14],Or(Tr(w.v)))),v+=a(w.w,"V");break;default:v+=`1,0\r
""`}v+=`\r
`}d.push(v)}return d.join("")+`-1,0\r
EOD`}return{to_workbook:n,to_sheet:r,from_sheet:s}})(),bP=(function(){function e(h){return h.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function t(h){return h.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function r(h,p){for(var v=h.split(`
`),x=-1,w=-1,y=0,_=[];y!==v.length;++y){var S=v[y].trim().split(":");if(S[0]==="cell"){var k=sr(S[1]);if(_.length<=k.r)for(x=_.length;x<=k.r;++x)_[x]||(_[x]=[]);switch(x=k.r,w=k.c,S[2]){case"t":_[x][w]=e(S[3]);break;case"v":_[x][w]=+S[3];break;case"vtf":var E=S[S.length-1];case"vtc":switch(S[3]){case"nl":_[x][w]=!!+S[4];break;default:_[x][w]=S[S.length-1].charAt(0)=="#"?{t:"e",v:dn[S[S.length-1]]}:+S[4];break}S[2]=="vtf"&&(_[x][w]=[_[x][w],E])}}}return p&&p.sheetRows&&(_=_.slice(0,p.sheetRows)),_}function n(h,p){return hc(r(h,p),p)}function a(h,p){return Ys(n(h,p),p)}var i=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),s=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,o=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),c="--SocialCalcSpreadsheetControlSave--";function u(h){if(!h||!h["!ref"])return"";for(var p=[],v=[],x,w="",y=hn(h["!ref"]),_=h["!data"]!=null,S=y.s.r;S<=y.e.r;++S)for(var k=y.s.c;k<=y.e.c;++k)if(w=Rt({r:S,c:k}),x=_?(h["!data"][S]||[])[k]:h[w],!(!x||x.v==null||x.t==="z")){switch(v=["cell",w,"t"],x.t){case"s":v.push(t(x.v));break;case"b":v[2]="vt"+(x.f?"f":"c"),v[3]="nl",v[4]=x.v?"1":"0",v[5]=t(x.f||(x.v?"TRUE":"FALSE"));break;case"d":var E=Or(Tr(x.v));v[2]="vtc",v[3]="nd",v[4]=""+E,v[5]=x.w||ma(x.z||yt[14],E);break;case"n":isFinite(x.v)?x.f?(v[2]="vtf",v[3]="n",v[4]=x.v,v[5]=t(x.f)):(v[2]="v",v[3]=x.v):(v[2]="vt"+(x.f?"f":"c"),v[3]="e"+tn[isNaN(x.v)?36:7],v[4]="0",v[5]=x.f||v[3].slice(1),v[6]="e",v[7]=v[3].slice(1));break;case"e":continue}p.push(v.join(":"))}return p.push("sheet:c:"+(y.e.c-y.s.c+1)+":r:"+(y.e.r-y.s.r+1)+":tvf:1"),p.push("valueformat:1:text-wiki"),p.join(`
`)}function d(h){return[i,s,o,s,u(h),c].join(`
`)}return{to_workbook:a,to_sheet:n,from_sheet:d}})(),Wl=(function(){function e(d,h,p,v,x){x.raw?h[p][v]=d:d===""||(d==="TRUE"?h[p][v]=!0:d==="FALSE"?h[p][v]=!1:isNaN(ha(d))?isNaN($u(d).getDate())?d.charCodeAt(0)==35&&dn[d]!=null?h[p][v]={t:"e",v:dn[d],w:d}:h[p][v]=d:h[p][v]=Tr(d):h[p][v]=ha(d))}function t(d,h){var p=h||{},v=[];if(!d||d.length===0)return v;for(var x=d.split(/[\r\n]/),w=x.length-1;w>=0&&x[w].length===0;)--w;for(var y=10,_=0,S=0;S<=w;++S)_=x[S].indexOf(" "),_==-1?_=x[S].length:_++,y=Math.max(y,_);for(S=0;S<=w;++S){v[S]=[];var k=0;for(e(x[S].slice(0,y).trim(),v,S,k,p),k=1;k<=(x[S].length-y)/10+1;++k)e(x[S].slice(y+(k-1)*10,y+k*10).trim(),v,S,k,p)}return p.sheetRows&&(v=v.slice(0,p.sheetRows)),v}var r={44:",",9:"	",59:";",124:"|"},n={44:3,9:2,59:1,124:0};function a(d){for(var h={},p=!1,v=0,x=0;v<d.length;++v)(x=d.charCodeAt(v))==34?p=!p:!p&&x in r&&(h[x]=(h[x]||0)+1);x=[];for(v in h)Object.prototype.hasOwnProperty.call(h,v)&&x.push([h[v],v]);if(!x.length){h=n;for(v in h)Object.prototype.hasOwnProperty.call(h,v)&&x.push([h[v],v])}return x.sort(function(w,y){return w[0]-y[0]||n[w[1]]-n[y[1]]}),r[x.pop()[1]]||44}function i(d,h){var p=h||{},v="",x={};p.dense&&(x["!data"]=[]);var w={s:{c:0,r:0},e:{c:0,r:0}};d.slice(0,4)=="sep="?d.charCodeAt(5)==13&&d.charCodeAt(6)==10?(v=d.charAt(4),d=d.slice(7)):d.charCodeAt(5)==13||d.charCodeAt(5)==10?(v=d.charAt(4),d=d.slice(6)):v=a(d.slice(0,1024)):p&&p.FS?v=p.FS:v=a(d.slice(0,1024));var y=0,_=0,S=0,k=0,E=0,T=v.charCodeAt(0),N=!1,C=0,P=d.charCodeAt(0),j=p.dateNF!=null?OM(p.dateNF):null;function R(){var I=d.slice(k,E);I.slice(-1)=="\r"&&(I=I.slice(0,-1));var F={};if(I.charAt(0)=='"'&&I.charAt(I.length-1)=='"'&&(I=I.slice(1,-1).replace(/""/g,'"')),p.cellText!==!1&&(F.w=I),I.length===0)F.t="z";else if(p.raw)F.t="s",F.v=I;else if(I.trim().length===0)F.t="s",F.v=I;else if(I.charCodeAt(0)==61)I.charCodeAt(1)==34&&I.charCodeAt(I.length-1)==34?(F.t="s",F.v=I.slice(2,-1).replace(/""/g,'"')):wU(I)?(F.t="s",F.f=I.slice(1),F.v=I):(F.t="s",F.v=I);else if(I=="TRUE")F.t="b",F.v=!0;else if(I=="FALSE")F.t="b",F.v=!1;else if(!isNaN(S=ha(I)))F.t="n",F.v=S;else if(!isNaN((S=$u(I)).getDate())||j&&I.match(j)){if(F.z=p.dateNF||yt[14],j&&I.match(j)){var L=NM(I,p.dateNF,I.match(j)||[]);S=Tr(L),p&&p.UTC===!1&&(S=$o(S))}else p&&p.UTC===!1?S=$o(S):p.cellText!==!1&&p.dateNF&&(F.w=ma(F.z,S));p.cellDates?(F.t="d",F.v=S):(F.t="n",F.v=Or(S)),p.cellNF||delete F.z}else I.charCodeAt(0)==35&&dn[I]!=null?(F.t="e",F.w=I,F.v=dn[I]):(F.t="s",F.v=I);if(F.t=="z"||(p.dense?(x["!data"][y]||(x["!data"][y]=[]),x["!data"][y][_]=F):x[Rt({c:_,r:y})]=F),k=E+1,P=d.charCodeAt(k),w.e.c<_&&(w.e.c=_),w.e.r<y&&(w.e.r=y),C==T)++_;else if(_=0,++y,p.sheetRows&&p.sheetRows<=y)return!0}e:for(;E<d.length;++E)switch(C=d.charCodeAt(E)){case 34:P===34&&(N=!N);break;case 13:if(N)break;d.charCodeAt(E+1)==10&&++E;case T:case 10:if(!N&&R())break e;break}return E-k>0&&R(),x["!ref"]=Nt(w),x}function s(d,h){return!(h&&h.PRN)||h.FS||d.slice(0,4)=="sep="||d.indexOf("	")>=0||d.indexOf(",")>=0||d.indexOf(";")>=0?i(d,h):hc(t(d,h),h)}function o(d,h){var p="",v=h.type=="string"?[0,0,0,0]:Fb(d,h);switch(h.type){case"base64":p=pa(d);break;case"binary":p=d;break;case"buffer":h.codepage==65001?p=d.toString("utf8"):(h.codepage,p=It&&Buffer.isBuffer(d)?d.toString("binary"):Pi(d));break;case"array":p=Bo(d);break;case"string":p=d;break;default:throw new Error("Unrecognized type "+h.type)}return v[0]==239&&v[1]==187&&v[2]==191?p=ir(p.slice(3)):h.type!="string"&&h.type!="buffer"&&h.codepage==65001?p=ir(p):h.type=="binary",p.slice(0,19)=="socialcalc:version:"?bP.to_sheet(h.type=="string"?p:ir(p),h):s(p,h)}function c(d,h){return Ys(o(d,h),h)}function u(d){var h=[];if(!d["!ref"])return"";for(var p=Kt(d["!ref"]),v,x=d["!data"]!=null,w=p.s.r;w<=p.e.r;++w){for(var y=[],_=p.s.c;_<=p.e.c;++_){var S=Rt({r:w,c:_});if(v=x?(d["!data"][w]||[])[_]:d[S],!v||v.v==null){y.push("          ");continue}for(var k=(v.w||(is(v),v.w)||"").slice(0,10);k.length<10;)k+=" ";y.push(k+(_===0?" ":""))}h.push(y.join(""))}return h.join(`
`)}return{to_workbook:c,to_sheet:o,from_sheet:u}})();function lB(e,t){var r=t||{},n=!!r.WTF;r.WTF=!0;try{var a=yP.to_workbook(e,r);return r.WTF=n,a}catch(i){if(r.WTF=n,i.message.indexOf("SYLK bad record ID")==-1&&n)throw i;return Wl.to_workbook(e,t)}}var Io=(function(){function e(W,z,G){if(W){Yr(W,W.l||0);for(var X=G.Enum||ce;W.l<W.length;){var ie=W.read_shift(2),M=X[ie]||X[65535],le=W.read_shift(2),ye=W.l+le,Ce=M.f&&M.f(W,le,G);if(W.l=ye,z(Ce,M,ie))return}}}function t(W,z){switch(z.type){case"base64":return n(zn(pa(W)),z);case"binary":return n(zn(W),z);case"buffer":case"array":return n(W,z)}throw"Unsupported type "+z.type}var r=["mmmm","dd-mmm-yyyy","dd-mmm","mmm-yyyy","@","mm/dd","hh:mm:ss AM/PM","hh:mm AM/PM","mm/dd/yyyy","mm/dd","hh:mm:ss","hh:mm"];function n(W,z){if(!W)return W;var G=z||{},X={},ie="Sheet1",M="",le=0,ye={},Ce=[],ze=[],Ze=[];G.dense&&(Ze=X["!data"]=[]);var rt={s:{r:0,c:0},e:{r:0,c:0}},xt=G.sheetRows||0,mt={};if(W[4]==81&&W[5]==80&&W[6]==87)return Ne(W,z);if(W[2]==0&&(W[3]==8||W[3]==9)&&W.length>=16&&W[14]==5&&W[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(W[2]==2)G.Enum=ce,e(W,function(pe,nt,De){switch(De){case 0:G.vers=pe,pe>=4096&&(G.qpro=!0);break;case 255:G.vers=pe,G.works=!0;break;case 6:rt=pe;break;case 204:pe&&(M=pe);break;case 222:M=pe;break;case 15:case 51:(!G.qpro&&!G.works||De==51)&&pe[1].v.charCodeAt(0)<48&&(pe[1].v=pe[1].v.slice(1)),(G.works||G.works2)&&(pe[1].v=pe[1].v.replace(/\r\n/g,`
`));case 13:case 14:case 16:(pe[2]&112)==112&&(pe[2]&15)>1&&(pe[2]&15)<15&&(pe[1].z=G.dateNF||r[(pe[2]&15)-1]||yt[14],G.cellDates&&(pe[1].v=Ji(pe[1].v),pe[1].t=typeof pe[1].v=="number"?"n":"d")),G.qpro&&pe[3]>le&&(X["!ref"]=Nt(rt),ye[ie]=X,Ce.push(ie),X={},G.dense&&(Ze=X["!data"]=[]),rt={s:{r:0,c:0},e:{r:0,c:0}},le=pe[3],ie=M||"Sheet"+(le+1),M="");var Oe=G.dense?(Ze[pe[0].r]||[])[pe[0].c]:X[Rt(pe[0])];if(Oe){Oe.t=pe[1].t,Oe.v=pe[1].v,pe[1].z!=null&&(Oe.z=pe[1].z),pe[1].f!=null&&(Oe.f=pe[1].f),mt=Oe;break}G.dense?(Ze[pe[0].r]||(Ze[pe[0].r]=[]),Ze[pe[0].r][pe[0].c]=pe[1]):X[Rt(pe[0])]=pe[1],mt=pe[1];break;case 21509:G.works2=!0;break;case 21506:pe==5281&&(mt.z="hh:mm:ss",G.cellDates&&mt.t=="n"&&(mt.v=Ji(mt.v),mt.t=typeof mt.v=="number"?"n":"d"));break}},G);else if(W[2]==26||W[2]==14)G.Enum=de,W[2]==14&&(G.qpro=!0,W.l=0),e(W,function(pe,nt,De){switch(De){case 204:ie=pe;break;case 22:pe[1].v.charCodeAt(0)<48&&(pe[1].v=pe[1].v.slice(1)),pe[1].v=pe[1].v.replace(/\x0F./g,function(Oe){return String.fromCharCode(Oe.charCodeAt(1)-32)}).replace(/\r\n/g,`
`);case 23:case 24:case 25:case 37:case 39:case 40:if(pe[3]>le&&(X["!ref"]=Nt(rt),ye[ie]=X,Ce.push(ie),X={},G.dense&&(Ze=X["!data"]=[]),rt={s:{r:0,c:0},e:{r:0,c:0}},le=pe[3],ie="Sheet"+(le+1)),xt>0&&pe[0].r>=xt)break;G.dense?(Ze[pe[0].r]||(Ze[pe[0].r]=[]),Ze[pe[0].r][pe[0].c]=pe[1]):X[Rt(pe[0])]=pe[1],rt.e.c<pe[0].c&&(rt.e.c=pe[0].c),rt.e.r<pe[0].r&&(rt.e.r=pe[0].r);break;case 27:pe[14e3]&&(ze[pe[14e3][0]]=pe[14e3][1]);break;case 1537:ze[pe[0]]=pe[1],pe[0]==le&&(ie=pe[1]);break}},G);else throw new Error("Unrecognized LOTUS BOF "+W[2]);if(X["!ref"]=Nt(rt),ye[M||ie]=X,Ce.push(M||ie),!ze.length)return{SheetNames:Ce,Sheets:ye};for(var Ee={},ve=[],fe=0;fe<ze.length;++fe)ye[Ce[fe]]?(ve.push(ze[fe]||Ce[fe]),Ee[ze[fe]]=ye[ze[fe]]||ye[Ce[fe]]):(ve.push(ze[fe]),Ee[ze[fe]]={"!ref":"A1"});return{SheetNames:ve,Sheets:Ee}}function a(W,z){var G=z||{};if(+G.codepage>=0&&ii(+G.codepage),G.type=="string")throw new Error("Cannot write WK1 to JS string");var X=Dn();if(!W["!ref"])throw new Error("Cannot export empty sheet to WK1");var ie=Kt(W["!ref"]),M=W["!data"]!=null,le=[];Be(X,0,s(1030)),Be(X,6,u(ie));for(var ye=Math.min(ie.e.r,8191),Ce=ie.s.c;Ce<=ie.e.c;++Ce)le[Ce]=Ft(Ce);for(var ze=ie.s.r;ze<=ye;++ze){var Ze=Ut(ze);for(Ce=ie.s.c;Ce<=ie.e.c;++Ce){var rt=M?(W["!data"][ze]||[])[Ce]:W[le[Ce]+Ze];if(!(!rt||rt.t=="z"))switch(rt.t){case"n":(rt.v|0)==rt.v&&rt.v>=-32768&&rt.v<=32767?Be(X,13,y(ze,Ce,rt)):Be(X,14,S(ze,Ce,rt));break;case"d":var xt=Or(rt.v);(xt|0)==xt&&xt>=-32768&&xt<=32767?Be(X,13,y(ze,Ce,{v:xt,z:rt.z||yt[14]})):Be(X,14,S(ze,Ce,{v:xt,z:rt.z||yt[14]}));break;default:var mt=is(rt);Be(X,15,v(ze,Ce,mt.slice(0,239)))}}}return Be(X,1),X.end()}function i(W,z){var G=z||{};if(+G.codepage>=0&&ii(+G.codepage),G.type=="string")throw new Error("Cannot write WK3 to JS string");var X=Dn();Be(X,0,o(W));for(var ie=0,M=0;ie<W.SheetNames.length;++ie)(W.Sheets[W.SheetNames[ie]]||{})["!ref"]&&Be(X,27,ee(W.SheetNames[ie],M++));var le=0;for(ie=0;ie<W.SheetNames.length;++ie){var ye=W.Sheets[W.SheetNames[ie]];if(!(!ye||!ye["!ref"])){for(var Ce=Kt(ye["!ref"]),ze=ye["!data"]!=null,Ze=[],rt=Math.min(Ce.e.r,8191),xt=Ce.s.r;xt<=rt;++xt)for(var mt=Ut(xt),Ee=Ce.s.c;Ee<=Ce.e.c;++Ee){xt===Ce.s.r&&(Ze[Ee]=Ft(Ee));var ve=Ze[Ee]+mt,fe=ze?(ye["!data"][xt]||[])[Ee]:ye[ve];if(!(!fe||fe.t=="z"))if(fe.t=="n")Be(X,23,L(xt,Ee,le,fe.v));else{var pe=is(fe);Be(X,22,R(xt,Ee,le,pe.slice(0,239)))}}++le}}return Be(X,1),X.end()}function s(W){var z=be(2);return z.write_shift(2,W),z}function o(W){var z=be(26);z.write_shift(2,4096),z.write_shift(2,4),z.write_shift(4,0);for(var G=0,X=0,ie=0,M=0;M<W.SheetNames.length;++M){var le=W.SheetNames[M],ye=W.Sheets[le];if(!(!ye||!ye["!ref"])){++ie;var Ce=hn(ye["!ref"]);G<Ce.e.r&&(G=Ce.e.r),X<Ce.e.c&&(X=Ce.e.c)}}return G>8191&&(G=8191),z.write_shift(2,G),z.write_shift(1,ie),z.write_shift(1,X),z.write_shift(2,0),z.write_shift(2,0),z.write_shift(1,1),z.write_shift(1,2),z.write_shift(4,0),z.write_shift(4,0),z}function c(W,z,G){var X={s:{c:0,r:0},e:{c:0,r:0}};return z==8&&G.qpro?(X.s.c=W.read_shift(1),W.l++,X.s.r=W.read_shift(2),X.e.c=W.read_shift(1),W.l++,X.e.r=W.read_shift(2),X):(X.s.c=W.read_shift(2),X.s.r=W.read_shift(2),z==12&&G.qpro&&(W.l+=2),X.e.c=W.read_shift(2),X.e.r=W.read_shift(2),z==12&&G.qpro&&(W.l+=2),X.s.c==65535&&(X.s.c=X.e.c=X.s.r=X.e.r=0),X)}function u(W){var z=be(8);return z.write_shift(2,W.s.c),z.write_shift(2,W.s.r),z.write_shift(2,W.e.c),z.write_shift(2,W.e.r),z}function d(W,z,G){var X=[{c:0,r:0},{t:"n",v:0},0,0];return G.qpro&&G.vers!=20768?(X[0].c=W.read_shift(1),X[3]=W.read_shift(1),X[0].r=W.read_shift(2),W.l+=2):G.works?(X[0].c=W.read_shift(2),X[0].r=W.read_shift(2),X[2]=W.read_shift(2)):(X[2]=W.read_shift(1),X[0].c=W.read_shift(2),X[0].r=W.read_shift(2)),X}function h(W){return W.z&&Ha(W.z)?240|(r.indexOf(W.z)+1||2):255}function p(W,z,G){var X=W.l+z,ie=d(W,z,G);if(ie[1].t="s",(G.vers&65534)==20768){W.l++;var M=W.read_shift(1);return ie[1].v=W.read_shift(M,"utf8"),ie}return G.qpro&&W.l++,ie[1].v=W.read_shift(X-W.l,"cstr"),ie}function v(W,z,G){var X=be(7+G.length);X.write_shift(1,255),X.write_shift(2,z),X.write_shift(2,W),X.write_shift(1,39);for(var ie=0;ie<X.length;++ie){var M=G.charCodeAt(ie);X.write_shift(1,M>=128?95:M)}return X.write_shift(1,0),X}function x(W,z,G){var X=W.l+z,ie=d(W,z,G);if(ie[1].t="s",G.vers==20768){var M=W.read_shift(1);return ie[1].v=W.read_shift(M,"utf8"),ie}return ie[1].v=W.read_shift(X-W.l,"cstr"),ie}function w(W,z,G){var X=d(W,z,G);return X[1].v=W.read_shift(2,"i"),X}function y(W,z,G){var X=be(7);return X.write_shift(1,h(G)),X.write_shift(2,z),X.write_shift(2,W),X.write_shift(2,G.v,"i"),X}function _(W,z,G){var X=d(W,z,G);return X[1].v=W.read_shift(8,"f"),X}function S(W,z,G){var X=be(13);return X.write_shift(1,h(G)),X.write_shift(2,z),X.write_shift(2,W),X.write_shift(8,G.v,"f"),X}function k(W,z,G){var X=W.l+z,ie=d(W,z,G);if(ie[1].v=W.read_shift(8,"f"),G.qpro)W.l=X;else{var M=W.read_shift(2);C(W.slice(W.l,W.l+M),ie),W.l+=M}return ie}function E(W,z,G){var X=z&32768;return z&=-32769,z=(X?W:0)+(z>=8192?z-16384:z),(X?"":"$")+(G?Ft(z):Ut(z))}var T={31:["NA",0],33:["ABS",1],34:["TRUNC",1],35:["SQRT",1],36:["LOG",1],37:["LN",1],38:["PI",0],39:["SIN",1],40:["COS",1],41:["TAN",1],42:["ATAN2",2],43:["ATAN",1],44:["ASIN",1],45:["ACOS",1],46:["EXP",1],47:["MOD",2],49:["ISNA",1],50:["ISERR",1],51:["FALSE",0],52:["TRUE",0],53:["RAND",0],54:["DATE",3],63:["ROUND",2],64:["TIME",3],68:["ISNUMBER",1],69:["ISTEXT",1],70:["LEN",1],71:["VALUE",1],73:["MID",3],74:["CHAR",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],102:["UPPER",1],103:["LOWER",1],107:["PROPER",1],109:["TRIM",1],111:["T",1]},N=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function C(W,z){Yr(W,0);for(var G=[],X=0,ie="",M="",le="",ye="";W.l<W.length;){var Ce=W[W.l++];switch(Ce){case 0:G.push(W.read_shift(8,"f"));break;case 1:M=E(z[0].c,W.read_shift(2),!0),ie=E(z[0].r,W.read_shift(2),!1),G.push(M+ie);break;case 2:{var ze=E(z[0].c,W.read_shift(2),!0),Ze=E(z[0].r,W.read_shift(2),!1);M=E(z[0].c,W.read_shift(2),!0),ie=E(z[0].r,W.read_shift(2),!1),G.push(ze+Ze+":"+M+ie)}break;case 3:if(W.l<W.length){console.error("WK1 premature formula end");return}break;case 4:G.push("("+G.pop()+")");break;case 5:G.push(W.read_shift(2));break;case 6:{for(var rt="";Ce=W[W.l++];)rt+=String.fromCharCode(Ce);G.push('"'+rt.replace(/"/g,'""')+'"')}break;case 8:G.push("-"+G.pop());break;case 23:G.push("+"+G.pop());break;case 22:G.push("NOT("+G.pop()+")");break;case 20:case 21:ye=G.pop(),le=G.pop(),G.push(["AND","OR"][Ce-20]+"("+le+","+ye+")");break;default:if(Ce<32&&N[Ce])ye=G.pop(),le=G.pop(),G.push(le+N[Ce]+ye);else if(T[Ce]){if(X=T[Ce][1],X==69&&(X=W[W.l++]),X>G.length){console.error("WK1 bad formula parse 0x"+Ce.toString(16)+":|"+G.join("|")+"|");return}var xt=G.slice(-X);G.length-=X,G.push(T[Ce][0]+"("+xt.join(",")+")")}else return Ce<=7?console.error("WK1 invalid opcode "+Ce.toString(16)):Ce<=24?console.error("WK1 unsupported op "+Ce.toString(16)):Ce<=30?console.error("WK1 invalid opcode "+Ce.toString(16)):Ce<=115?console.error("WK1 unsupported function opcode "+Ce.toString(16)):console.error("WK1 unrecognized opcode "+Ce.toString(16))}}G.length==1?z[1].f=""+G[0]:console.error("WK1 bad formula parse |"+G.join("|")+"|")}function P(W){var z=[{c:0,r:0},{t:"n",v:0},0];return z[0].r=W.read_shift(2),z[3]=W[W.l++],z[0].c=W[W.l++],z}function j(W,z){var G=P(W);return G[1].t="s",G[1].v=W.read_shift(z-4,"cstr"),G}function R(W,z,G,X){var ie=be(6+X.length);ie.write_shift(2,W),ie.write_shift(1,G),ie.write_shift(1,z),ie.write_shift(1,39);for(var M=0;M<X.length;++M){var le=X.charCodeAt(M);ie.write_shift(1,le>=128?95:le)}return ie.write_shift(1,0),ie}function I(W,z){var G=P(W);G[1].v=W.read_shift(2);var X=G[1].v>>1;if(G[1].v&1)switch(X&7){case 0:X=(X>>3)*5e3;break;case 1:X=(X>>3)*500;break;case 2:X=(X>>3)/20;break;case 3:X=(X>>3)/200;break;case 4:X=(X>>3)/2e3;break;case 5:X=(X>>3)/2e4;break;case 6:X=(X>>3)/16;break;case 7:X=(X>>3)/64;break}return G[1].v=X,G}function F(W,z){var G=P(W),X=W.read_shift(4),ie=W.read_shift(4),M=W.read_shift(2);if(M==65535)return X===0&&ie===3221225472?(G[1].t="e",G[1].v=15):X===0&&ie===3489660928?(G[1].t="e",G[1].v=42):G[1].v=0,G;var le=M&32768;return M=(M&32767)-16446,G[1].v=(1-le*2)*(ie*Math.pow(2,M+32)+X*Math.pow(2,M)),G}function L(W,z,G,X){var ie=be(14);if(ie.write_shift(2,W),ie.write_shift(1,G),ie.write_shift(1,z),X==0)return ie.write_shift(4,0),ie.write_shift(4,0),ie.write_shift(2,65535),ie;var M=0,le=0,ye=0,Ce=0;return X<0&&(M=1,X=-X),le=Math.log2(X)|0,X/=Math.pow(2,le-31),Ce=X>>>0,(Ce&2147483648)==0&&(X/=2,++le,Ce=X>>>0),X-=Ce,Ce|=2147483648,Ce>>>=0,X*=Math.pow(2,32),ye=X>>>0,ie.write_shift(4,ye),ie.write_shift(4,Ce),le+=16383+(M?32768:0),ie.write_shift(2,le),ie}function H(W,z){var G=F(W);return W.l+=z-14,G}function V(W,z){var G=P(W),X=W.read_shift(4);return G[1].v=X>>6,G}function J(W,z){var G=P(W),X=W.read_shift(8,"f");return G[1].v=X,G}function te(W,z){var G=J(W);return W.l+=z-12,G}function q(W,z){return W[W.l+z-1]==0?W.read_shift(z,"cstr"):""}function oe(W,z){var G=W[W.l++];G>z-1&&(G=z-1);for(var X="";X.length<G;)X+=String.fromCharCode(W[W.l++]);return X}function Q(W,z,G){if(!(!G.qpro||z<21)){var X=W.read_shift(1);W.l+=17,W.l+=1,W.l+=2;var ie=W.read_shift(z-21,"cstr");return[X,ie]}}function Z(W,z){for(var G={},X=W.l+z;W.l<X;){var ie=W.read_shift(2);if(ie==14e3){for(G[ie]=[0,""],G[ie][0]=W.read_shift(2);W[W.l];)G[ie][1]+=String.fromCharCode(W[W.l]),W.l++;W.l++}}return G}function ee(W,z){var G=be(5+W.length);G.write_shift(2,14e3),G.write_shift(2,z);for(var X=0;X<W.length;++X){var ie=W.charCodeAt(X);G[G.l++]=ie>127?95:ie}return G[G.l++]=0,G}var ce={0:{n:"BOF",f:Ir},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:c},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:w},14:{n:"NUMBER",f:_},15:{n:"LABEL",f:p},16:{n:"FORMULA",f:k},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:x},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:q},222:{n:"SHEETNAMELP",f:oe},255:{n:"BOF",f:Ir},21506:{n:"WKSNF",f:Ir},65535:{n:""}},de={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:j},23:{n:"NUMBER17",f:F},24:{n:"NUMBER18",f:I},25:{n:"FORMULA19",f:H},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:Z},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:V},38:{n:"??"},39:{n:"NUMBER27",f:J},40:{n:"FORMULA28",f:te},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:q},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:Q},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}},Te={5:"dd-mmm-yy",6:"dd-mmm",7:"mmm-yy",8:"mm/dd/yy",10:"hh:mm:ss AM/PM",11:"hh:mm AM/PM",14:"dd-mmm-yyyy",15:"mmm-yyyy",34:"0.00",50:"0.00;[Red]0.00",66:"0.00;(0.00)",82:"0.00;[Red](0.00)",162:'"$"#,##0.00;\\("$"#,##0.00\\)',288:"0%",304:"0E+00",320:"# ?/?"};function Ie(W){var z=W.read_shift(2),G=W.read_shift(1);if(G!=0)throw"unsupported QPW string type "+G.toString(16);return W.read_shift(z,"sbcs-cont")}function Ne(W,z){Yr(W,0);var G=z||{},X={};G.dense&&(X["!data"]=[]);var ie=[],M="",le={s:{r:-1,c:-1},e:{r:-1,c:-1}},ye=0,Ce=0,ze=0,Ze=0,rt={SheetNames:[],Sheets:{}},xt=[];e:for(;W.l<W.length;){var mt=W.read_shift(2),Ee=W.read_shift(2),ve=W.slice(W.l,W.l+Ee);switch(Yr(ve,0),mt){case 1:if(ve.read_shift(4)!=962023505)throw"Bad QPW9 BOF!";break;case 2:break e;case 8:break;case 10:for(var fe=ve.read_shift(4),pe=(ve.length-ve.l)/fe|0,nt=0;nt<fe;++nt){var De=ve.l+pe,Oe={};ve.l+=2,Oe.numFmtId=ve.read_shift(2),Te[Oe.numFmtId]&&(Oe.z=Te[Oe.numFmtId]),ve.l=De,xt.push(Oe)}break;case 1025:break;case 1026:break;case 1031:for(ve.l+=12;ve.l<ve.length;)ye=ve.read_shift(2),Ce=ve.read_shift(1),ie.push(ve.read_shift(ye,"cstr"));break;case 1032:break;case 1537:{var Qe=ve.read_shift(2);X={},G.dense&&(X["!data"]=[]),le.s.c=ve.read_shift(2),le.e.c=ve.read_shift(2),le.s.r=ve.read_shift(4),le.e.r=ve.read_shift(4),ve.l+=4,ve.l+2<ve.length&&(ye=ve.read_shift(2),Ce=ve.read_shift(1),M=ye==0?"":ve.read_shift(ye,"cstr")),M||(M=Ft(Qe))}break;case 1538:{if(le.s.c>255||le.s.r>999999)break;le.e.c<le.s.c&&(le.e.c=le.s.c),le.e.r<le.s.r&&(le.e.r=le.s.r),X["!ref"]=Nt(le),Kf(rt,X,M)}break;case 2561:ze=ve.read_shift(2),le.e.c<ze&&(le.e.c=ze),le.s.c>ze&&(le.s.c=ze),Ze=ve.read_shift(4),le.s.r>Ze&&(le.s.r=Ze),Ze=ve.read_shift(4),le.e.r<Ze&&(le.e.r=Ze);break;case 3073:{Ze=ve.read_shift(4),ye=ve.read_shift(4),le.s.r>Ze&&(le.s.r=Ze),le.e.r<Ze+ye-1&&(le.e.r=Ze+ye-1);for(var kt=Ft(ze);ve.l<ve.length;){var Re={t:"z"},at=ve.read_shift(1),bt=-1;at&128&&(bt=ve.read_shift(2));var Yt=at&64?ve.read_shift(2)-1:0;switch(at&31){case 0:break;case 1:break;case 2:Re={t:"n",v:ve.read_shift(2)};break;case 3:Re={t:"n",v:ve.read_shift(2,"i")};break;case 4:Re={t:"n",v:np(ve)};break;case 5:Re={t:"n",v:ve.read_shift(8,"f")};break;case 7:Re={t:"s",v:ie[Ce=ve.read_shift(4)-1]};break;case 8:Re={t:"n",v:ve.read_shift(8,"f")},ve.l+=2,ve.l+=4,isNaN(Re.v)&&(Re={t:"e",v:15});break;default:throw"Unrecognized QPW cell type "+(at&31)}bt!=-1&&(xt[bt-1]||{}).z&&(Re.z=xt[bt-1].z);var mn=0;if(at&32)switch(at&31){case 2:mn=ve.read_shift(2);break;case 3:mn=ve.read_shift(2,"i");break;case 7:mn=ve.read_shift(2);break;default:throw"Unsupported delta for QPW cell type "+(at&31)}if(!(!G.sheetStubs&&Re.t=="z")){var Mn=dr(Re);Re.t=="n"&&Re.z&&Ha(Re.z)&&G.cellDates&&(Mn.v=Ji(Re.v),Mn.t=typeof Mn.v=="number"?"n":"d"),X["!data"]!=null?(X["!data"][Ze]||(X["!data"][Ze]=[]),X["!data"][Ze][ze]=Mn):X[kt+Ut(Ze)]=Mn}for(++Ze,--ye;Yt-- >0&&ye>=0;){if(at&32)switch(at&31){case 2:Re={t:"n",v:Re.v+mn&65535};break;case 3:Re={t:"n",v:Re.v+mn&65535},Re.v>32767&&(Re.v-=65536);break;case 7:Re={t:"s",v:ie[Ce=Ce+mn>>>0]};break;default:throw"Cannot apply delta for QPW cell type "+(at&31)}else switch(at&31){case 1:Re={t:"z"};break;case 2:Re={t:"n",v:ve.read_shift(2)};break;case 7:Re={t:"s",v:ie[Ce=ve.read_shift(4)-1]};break;default:throw"Cannot apply repeat for QPW cell type "+(at&31)}!G.sheetStubs&&Re.t=="z"||(X["!data"]!=null?(X["!data"][Ze]||(X["!data"][Ze]=[]),X["!data"][Ze][ze]=Re):X[kt+Ut(Ze)]=Re),++Ze,--ye}}}break;case 3074:{ze=ve.read_shift(2),Ze=ve.read_shift(4);var va=Ie(ve);X["!data"]!=null?(X["!data"][Ze]||(X["!data"][Ze]=[]),X["!data"][Ze][ze]={t:"s",v:va}):X[Ft(ze)+Ut(Ze)]={t:"s",v:va}}break}W.l+=Ee}return rt}return{sheet_to_wk1:a,book_to_wk3:i,to_workbook:t}})();function cB(e){var t={},r=e.match(bn),n=0,a=!1;if(r)for(;n!=r.length;++n){var i=lt(r[n]);switch(i[0].replace(/<\w*:/g,"<")){case"<condense":break;case"<extend":break;case"<shadow":if(!i.val)break;case"<shadow>":case"<shadow/>":t.shadow=1;break;case"</shadow>":break;case"<charset":if(i.val=="1")break;t.cp=eb[parseInt(i.val,10)];break;case"<outline":if(!i.val)break;case"<outline>":case"<outline/>":t.outline=1;break;case"</outline>":break;case"<rFont":t.name=i.val;break;case"<sz":t.sz=i.val;break;case"<strike":if(!i.val)break;case"<strike>":case"<strike/>":t.strike=1;break;case"</strike>":break;case"<u":if(!i.val)break;switch(i.val){case"double":t.uval="double";break;case"singleAccounting":t.uval="single-accounting";break;case"doubleAccounting":t.uval="double-accounting";break}case"<u>":case"<u/>":t.u=1;break;case"</u>":break;case"<b":if(i.val=="0")break;case"<b>":case"<b/>":t.b=1;break;case"</b>":break;case"<i":if(i.val=="0")break;case"<i>":case"<i/>":t.i=1;break;case"</i>":break;case"<color":i.rgb&&(t.color=i.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":t.family=i.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":t.valign=i.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(i[0].charCodeAt(1)!==47&&!a)throw new Error("Unrecognized rich format "+i[0])}}return t}var uB=(function(){function e(n){var a=un(n,"t");if(!a)return{t:"s",v:""};var i={t:"s",v:zt(a[1])},s=un(n,"rPr");return s&&(i.s=cB(s[1])),i}var t=/<(?:\w+:)?r>/g,r=/<\/(?:\w+:)?r>/;return function(a){return a.replace(t,"").split(r).map(e).filter(function(i){return i.v})}})(),fB=(function(){var t=/(\r\n|\n)/g;function r(a,i,s){var o=[];a.u&&o.push("text-decoration: underline;"),a.uval&&o.push("text-underline-style:"+a.uval+";"),a.sz&&o.push("font-size:"+a.sz+"pt;"),a.outline&&o.push("text-effect: outline;"),a.shadow&&o.push("text-shadow: auto;"),i.push('<span style="'+o.join("")+'">'),a.b&&(i.push("<b>"),s.push("</b>")),a.i&&(i.push("<i>"),s.push("</i>")),a.strike&&(i.push("<s>"),s.push("</s>"));var c=a.valign||"";return c=="superscript"||c=="super"?c="sup":c=="subscript"&&(c="sub"),c!=""&&(i.push("<"+c+">"),s.push("</"+c+">")),s.push("</span>"),a}function n(a){var i=[[],a.v,[]];return a.v?(a.s&&r(a.s,i[0],i[2]),i[0].join("")+i[1].replace(t,"<br/>")+i[2].join("")):""}return function(i){return i.map(n).join("")}})(),dB=/<(?:\w+:)?t\b[^<>]*>([^<]*)<\/(?:\w+:)?t>/g,hB=/<(?:\w+:)?r\b[^<>]*>/;function Sb(e,t){var r=t?t.cellHTML:!0,n={};return e?(e.match(/^\s*<(?:\w+:)?t[^>]*>/)?(n.t=zt(ir(e.slice(e.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||""),!0),n.r=ir(e),r&&(n.h=wu(n.t))):e.match(hB)&&(n.r=ir(e),n.t=zt(ir((KM(e,"rPh").match(dB)||[]).join("").replace(bn,"")),!0),r&&(n.h=fB(uB(n.r)))),n):{t:""}}var pB=/<(?:\w+:)?(?:si|sstItem)>/g,mB=/<\/(?:\w+:)?(?:si|sstItem)>/;function vB(e,t){var r=[],n="";if(!e)return r;var a=un(e,"sst");if(a){n=a[1].replace(pB,"").split(mB);for(var i=0;i!=n.length;++i){var s=Sb(n[i].trim(),t);s!=null&&(r[r.length]=s)}a=lt(a[0].slice(0,a[0].indexOf(">"))),r.Count=a.count,r.Unique=a.uniqueCount}return r}var gB=/^\s|\s$|[\t\n\r]/;function xB(e,t){if(!t.bookSST)return"";var r=[$r];r[r.length]=Ge("sst",null,{xmlns:qo[0],count:e.Count,uniqueCount:e.Unique});for(var n=0;n!=e.length;++n)if(e[n]!=null){var a=e[n],i="<si>";a.r?i+=a.r:(i+="<t",a.t||(a.t=""),typeof a.t!="string"&&(a.t=String(a.t)),a.t.match(gB)&&(i+=' xml:space="preserve"'),i+=">"+Pt(a.t)+"</t>"),i+="</si>",r[r.length]=i}return r.length>2&&(r[r.length]="</sst>",r[1]=r[1].replace("/>",">")),r.join("")}function yB(e){return[e.read_shift(4),e.read_shift(4)]}function wB(e,t){var r=[],n=!1;return fs(e,function(i,s,o){switch(o){case 159:r.Count=i[0],r.Unique=i[1];break;case 19:r.push(i);break;case 160:return!0;case 35:n=!0;break;case 36:n=!1;break;default:if(s.T,!n||t.WTF)throw new Error("Unexpected record 0x"+o.toString(16))}}),r}function bB(e,t){return t||(t=be(8)),t.write_shift(4,e.Count),t.write_shift(4,e.Unique),t}var _B=TL;function SB(e){var t=Dn();je(t,159,bB(e));for(var r=0;r<e.length;++r)je(t,19,_B(e[r]));return je(t,160),t.end()}function _P(e){for(var t=[],r=e.split(""),n=0;n<r.length;++n)t[n]=r[n].charCodeAt(0);return t}function ts(e,t){var r={};return r.Major=e.read_shift(2),r.Minor=e.read_shift(2),t>=4&&(e.l+=t-4),r}function kB(e){var t={};return t.id=e.read_shift(0,"lpp4"),t.R=ts(e,4),t.U=ts(e,4),t.W=ts(e,4),t}function EB(e){for(var t=e.read_shift(4),r=e.l+t-4,n={},a=e.read_shift(4),i=[];a-- >0;)i.push({t:e.read_shift(4),v:e.read_shift(0,"lpp4")});if(n.name=e.read_shift(0,"lpp4"),n.comps=i,e.l!=r)throw new Error("Bad DataSpaceMapEntry: "+e.l+" != "+r);return n}function TB(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(EB(e));return t}function AB(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(e.read_shift(0,"lpp4"));return t}function CB(e){var t={};return e.read_shift(4),e.l+=4,t.id=e.read_shift(0,"lpp4"),t.name=e.read_shift(0,"lpp4"),t.R=ts(e,4),t.U=ts(e,4),t.W=ts(e,4),t}function OB(e){var t=CB(e);if(t.ename=e.read_shift(0,"8lpp4"),t.blksz=e.read_shift(4),t.cmode=e.read_shift(4),e.read_shift(4)!=4)throw new Error("Bad !Primary record");return t}function SP(e,t){var r=e.l+t,n={};n.Flags=e.read_shift(4)&63,e.l+=4,n.AlgID=e.read_shift(4);var a=!1;switch(n.AlgID){case 26126:case 26127:case 26128:a=n.Flags==36;break;case 26625:a=n.Flags==4;break;case 0:a=n.Flags==16||n.Flags==4||n.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+n.AlgID}if(!a)throw new Error("Encryption Flags/AlgID mismatch");return n.AlgIDHash=e.read_shift(4),n.KeySize=e.read_shift(4),n.ProviderType=e.read_shift(4),e.l+=8,n.CSPName=e.read_shift(r-e.l>>1,"utf16le"),e.l=r,n}function kP(e,t){var r={},n=e.l+t;return e.l+=4,r.Salt=e.slice(e.l,e.l+16),e.l+=16,r.Verifier=e.slice(e.l,e.l+16),e.l+=16,e.read_shift(4),r.VerifierHash=e.slice(e.l,n),e.l=n,r}function NB(e){var t=ts(e);switch(t.Minor){case 2:return[t.Minor,PB(e)];case 3:return[t.Minor,IB()];case 4:return[t.Minor,FB(e)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+t.Minor)}function PB(e){var t=e.read_shift(4);if((t&63)!=36)throw new Error("EncryptionInfo mismatch");var r=e.read_shift(4),n=SP(e,r),a=kP(e,e.length-e.l);return{t:"Std",h:n,v:a}}function IB(){throw new Error("File is password-protected: ECMA-376 Extensible")}function FB(e){var t=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];e.l+=4;var r=e.read_shift(e.length-e.l,"utf8"),n={};return r.replace(bn,function(i){var s=lt(i);switch(Va(s[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":t.forEach(function(o){n[o]=s[o]});break;case"<dataIntegrity":n.encryptedHmacKey=s.encryptedHmacKey,n.encryptedHmacValue=s.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":n.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":n.uri=s.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":n.encs.push(s);break;default:throw s[0]}}),n}function DB(e,t){var r={},n=r.EncryptionVersionInfo=ts(e,4);if(t-=4,n.Minor!=2)throw new Error("unrecognized minor version code: "+n.Minor);if(n.Major>4||n.Major<2)throw new Error("unrecognized major version code: "+n.Major);r.Flags=e.read_shift(4),t-=4;var a=e.read_shift(4);return t-=4,r.EncryptionHeader=SP(e,a),t-=a,r.EncryptionVerifier=kP(e,t),r}function jB(e){var t={},r=t.EncryptionVersionInfo=ts(e,4);if(r.Major!=1||r.Minor!=1)throw"unrecognized version code "+r.Major+" : "+r.Minor;return t.Salt=e.read_shift(16),t.EncryptedVerifier=e.read_shift(16),t.EncryptedVerifierHash=e.read_shift(16),t}function kb(e){var t=0,r,n=_P(e),a=n.length+1,i,s,o,c,u;for(r=Hs(a),r[0]=n.length,i=1;i!=a;++i)r[i]=n[i-1];for(i=a-1;i>=0;--i)s=r[i],o=(t&16384)===0?0:1,c=t<<1&32767,u=o|c,t=u^s;return t^52811}var EP=(function(){var e=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],t=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],r=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],n=function(s){return(s/2|s*128)&255},a=function(s,o){return n(s^o)},i=function(s){for(var o=t[s.length-1],c=104,u=s.length-1;u>=0;--u)for(var d=s[u],h=0;h!=7;++h)d&64&&(o^=r[c]),d*=2,--c;return o};return function(s){for(var o=_P(s),c=i(o),u=o.length,d=Hs(16),h=0;h!=16;++h)d[h]=0;var p,v,x;for((u&1)===1&&(p=c>>8,d[u]=a(e[0],p),--u,p=c&255,v=o[o.length-1],d[u]=a(v,p));u>0;)--u,p=c>>8,d[u]=a(o[u],p),--u,p=c&255,d[u]=a(o[u],p);for(u=15,x=15-o.length;x>0;)p=c>>8,d[u]=a(e[x],p),--u,--x,p=c&255,d[u]=a(o[u],p),--u,--x;return d}})(),RB=function(e,t,r,n,a){a||(a=t),n||(n=EP(e));var i,s;for(i=0;i!=t.length;++i)s=t[i],s^=n[r],s=(s>>5|s<<3)&255,a[i]=s,++r;return[a,r,n]},MB=function(e){var t=0,r=EP(e);return function(n){var a=RB("",n,t,r);return t=a[1],a[0]}};function LB(e,t,r,n){var a={key:Ir(e),verificationBytes:Ir(e)};return r.password&&(a.verifier=kb(r.password)),n.valid=a.verificationBytes===a.verifier,n.valid&&(n.insitu=MB(r.password)),a}function BB(e,t,r){var n=r||{};return n.Info=e.read_shift(2),e.l-=2,n.Info===1?n.Data=jB(e):n.Data=DB(e,t),n}function $B(e,t,r){var n={Type:r.biff>=8?e.read_shift(2):0};return n.Type?BB(e,t-2,n):LB(e,r.biff>=8?t:t-2,r,n),n}function UB(e,t){switch(t.type){case"base64":return _d(pa(e),t);case"binary":return _d(e,t);case"buffer":return _d(It&&Buffer.isBuffer(e)?e.toString("binary"):Pi(e),t);case"array":return _d(Bo(e),t)}throw new Error("Unrecognized type "+t.type)}function _d(e,t){var r=t||{},n={},a=r.dense;a&&(n["!data"]=[]);var i=ob(e,"\\trowd","\\row");if(!i)throw new Error("RTF missing table");var s={s:{c:0,r:0},e:{c:0,r:i.length-1}},o=[];return i.forEach(function(c,u){a&&(o=n["!data"][u]=[]);for(var d=/\\[\w\-]+\b/g,h=0,p,v=-1,x=[];(p=d.exec(c))!=null;){var w=c.slice(h,d.lastIndex-p[0].length);switch(w.charCodeAt(0)==32&&(w=w.slice(1)),w.length&&x.push(w),p[0]){case"\\cell":if(++v,x.length){var y={v:x.join(""),t:"s"};y.v=="TRUE"||y.v=="FALSE"?(y.v=y.v=="TRUE",y.t="b"):isNaN(ha(y.v))?dn[y.v]!=null&&(y.t="e",y.w=y.v,y.v=dn[y.v]):(y.t="n",r.cellText!==!1&&(y.w=y.v),y.v=ha(y.v)),a?o[v]=y:n[Rt({r:u,c:v})]=y}x=[];break;case"\\par":x.push(`
`);break}h=d.lastIndex}v>s.e.c&&(s.e.c=v)}),n["!ref"]=Nt(s),n}function zB(e,t){var r=Ys(UB(e,t),t);return r.bookType="rtf",r}function WB(e,t){var r=["{\\rtf1\\ansi"];if(!e["!ref"])return r[0]+"}";for(var n=Kt(e["!ref"]),a,i=e["!data"]!=null,s=[],o=n.s.r;o<=n.e.r;++o){r.push("\\trowd\\trautofit1");for(var c=n.s.c;c<=n.e.c;++c)r.push("\\cellx"+(c+1));for(r.push("\\pard\\intbl"),i&&(s=e["!data"][o]||[]),c=n.s.c;c<=n.e.c;++c){var u=Rt({r:o,c});if(a=i?s[c]:e[u],!a||a.v==null&&(!a.f||a.F)){r.push(" \\cell");continue}r.push(" "+(a.w||(is(a),a.w)||"").replace(/[\r\n]/g,"\\par ")),r.push("\\cell")}r.push("\\pard\\intbl\\row")}return r.join("")+"}"}function HB(e){var t=e.slice(e[0]==="#"?1:0).slice(0,6);return[parseInt(t.slice(0,2),16),parseInt(t.slice(2,4),16),parseInt(t.slice(4,6),16)]}function Vu(e){for(var t=0,r=1;t!=3;++t)r=r*256+(e[t]>255?255:e[t]<0?0:e[t]);return r.toString(16).toUpperCase().slice(1)}function qB(e){var t=e[0]/255,r=e[1]/255,n=e[2]/255,a=Math.max(t,r,n),i=Math.min(t,r,n),s=a-i;if(s===0)return[0,0,t];var o=0,c=0,u=a+i;switch(c=s/(u>1?2-u:u),a){case t:o=((r-n)/s+6)%6;break;case r:o=(n-t)/s+2;break;case n:o=(t-r)/s+4;break}return[o/6,c,u/2]}function VB(e){var t=e[0],r=e[1],n=e[2],a=r*2*(n<.5?n:1-n),i=n-a/2,s=[i,i,i],o=6*t,c;if(r!==0)switch(o|0){case 0:case 6:c=a*o,s[0]+=a,s[1]+=c;break;case 1:c=a*(2-o),s[0]+=c,s[1]+=a;break;case 2:c=a*(o-2),s[1]+=a,s[2]+=c;break;case 3:c=a*(4-o),s[1]+=c,s[2]+=a;break;case 4:c=a*(o-4),s[2]+=a,s[0]+=c;break;case 5:c=a*(6-o),s[2]+=c,s[0]+=a;break}for(var u=0;u!=3;++u)s[u]=Math.round(s[u]*255);return s}function lh(e,t){if(t===0)return e;var r=qB(HB(e));return t<0?r[2]=r[2]*(1+t):r[2]=1-(1-r[2])*(1-t),Vu(VB(r))}var TP=6,XB=15,GB=1,Pn=TP;function Xu(e){return Math.floor((e+Math.round(128/Pn)/256)*Pn)}function Gu(e){return Math.floor((e-5)/Pn*100+.5)/100}function ch(e){return Math.round((e*Pn+5)/Pn*256)/256}function W1(e){return ch(Gu(Xu(e)))}function Eb(e){var t=Math.abs(e-W1(e)),r=Pn;if(t>.005)for(Pn=GB;Pn<XB;++Pn)Math.abs(e-W1(e))<=t&&(t=Math.abs(e-W1(e)),r=Pn);Pn=r}function qs(e){e.width?(e.wpx=Xu(e.width),e.wch=Gu(e.wpx),e.MDW=Pn):e.wpx?(e.wch=Gu(e.wpx),e.width=ch(e.wch),e.MDW=Pn):typeof e.wch=="number"&&(e.width=ch(e.wch),e.wpx=Xu(e.width),e.MDW=Pn),e.customWidth&&delete e.customWidth}var KB=96,AP=KB;function Ku(e){return e*96/AP}function Hl(e){return e*AP/96}var YB={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function ZB(e,t,r,n){t.Borders=[];var a={},i=!1;(e.match(bn)||[]).forEach(function(s){var o=lt(s);switch(Va(o[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":a={},o.diagonalUp&&(a.diagonalUp=tr(o.diagonalUp)),o.diagonalDown&&(a.diagonalDown=tr(o.diagonalDown)),t.Borders.push(a);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(n&&n.WTF&&!i)throw new Error("unrecognized "+o[0]+" in borders")}})}function QB(e,t,r,n){t.Fills=[];var a={},i=!1;(e.match(bn)||[]).forEach(function(s){var o=lt(s);switch(Va(o[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":a={},t.Fills.push(a);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":t.Fills.push(a),a={};break;case"<patternFill":case"<patternFill>":o.patternType&&(a.patternType=o.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":a.bgColor||(a.bgColor={}),o.indexed&&(a.bgColor.indexed=parseInt(o.indexed,10)),o.theme&&(a.bgColor.theme=parseInt(o.theme,10)),o.tint&&(a.bgColor.tint=parseFloat(o.tint)),o.rgb&&(a.bgColor.rgb=o.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":a.fgColor||(a.fgColor={}),o.theme&&(a.fgColor.theme=parseInt(o.theme,10)),o.tint&&(a.fgColor.tint=parseFloat(o.tint)),o.rgb!=null&&(a.fgColor.rgb=o.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(n&&n.WTF&&!i)throw new Error("unrecognized "+o[0]+" in fills")}})}function JB(e,t,r,n){t.Fonts=[];var a={},i=!1;(e.match(bn)||[]).forEach(function(s){var o=lt(s);switch(Va(o[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":t.Fonts.push(a),a={};break;case"<name":o.val&&(a.name=ir(o.val));break;case"<name/>":case"</name>":break;case"<b":a.bold=o.val?tr(o.val):1;break;case"<b/>":a.bold=1;break;case"</b>":case"</b":break;case"<i":a.italic=o.val?tr(o.val):1;break;case"<i/>":a.italic=1;break;case"</i>":case"</i":break;case"<u":switch(o.val){case"none":a.underline=0;break;case"single":a.underline=1;break;case"double":a.underline=2;break;case"singleAccounting":a.underline=33;break;case"doubleAccounting":a.underline=34;break}break;case"<u/>":a.underline=1;break;case"</u>":case"</u":break;case"<strike":a.strike=o.val?tr(o.val):1;break;case"<strike/>":a.strike=1;break;case"</strike>":case"</strike":break;case"<outline":a.outline=o.val?tr(o.val):1;break;case"<outline/>":a.outline=1;break;case"</outline>":case"</outline":break;case"<shadow":a.shadow=o.val?tr(o.val):1;break;case"<shadow/>":a.shadow=1;break;case"</shadow>":case"</shadow":break;case"<condense":a.condense=o.val?tr(o.val):1;break;case"<condense/>":a.condense=1;break;case"</condense>":case"</condense":break;case"<extend":a.extend=o.val?tr(o.val):1;break;case"<extend/>":a.extend=1;break;case"</extend>":case"</extend":break;case"<sz":o.val&&(a.sz=+o.val);break;case"<sz/>":case"</sz>":case"</sz":break;case"<vertAlign":o.val&&(a.vertAlign=o.val);break;case"<vertAlign/>":case"</vertAlign>":case"</vertAlign":break;case"<family":o.val&&(a.family=parseInt(o.val,10));break;case"<family/>":case"</family>":case"</family":break;case"<scheme":o.val&&(a.scheme=o.val);break;case"<scheme/>":case"</scheme>":case"</scheme":break;case"<charset":if(o.val=="1")break;o.codepage=eb[parseInt(o.val,10)];break;case"<charset/>":case"</charset>":case"</charset":break;case"<color":if(a.color||(a.color={}),o.auto&&(a.color.auto=tr(o.auto)),o.rgb)a.color.rgb=o.rgb.slice(-6);else if(o.indexed){a.color.index=parseInt(o.indexed,10);var c=No[a.color.index];a.color.index==81&&(c=No[1]),c||(c=No[1]),a.color.rgb=c[0].toString(16)+c[1].toString(16)+c[2].toString(16)}else o.theme&&(a.color.theme=parseInt(o.theme,10),o.tint&&(a.color.tint=parseFloat(o.tint)),o.theme&&r.themeElements&&r.themeElements.clrScheme&&(a.color.rgb=lh(r.themeElements.clrScheme[a.color.theme].rgb,a.color.tint||0)));break;case"<color/>":case"</color>":case"</color":break;case"<AlternateContent":i=!0;break;case"</AlternateContent>":case"</AlternateContent":i=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(n&&n.WTF&&!i)throw new Error("unrecognized "+o[0]+" in fonts")}})}function e$(e,t,r){t.NumberFmt=[];for(var n=_r(yt),a=0;a<n.length;++a)t.NumberFmt[n[a]]=yt[n[a]];var i=e.match(bn);if(i)for(a=0;a<i.length;++a){var s=lt(i[a]);switch(Va(s[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var o=zt(ir(s.formatCode)),c=parseInt(s.numFmtId,10);if(t.NumberFmt[c]=o,c>0){if(c>392){for(c=392;c>60&&t.NumberFmt[c]!=null;--c);t.NumberFmt[c]=o}zs(o,c)}}break;case"</numFmt>":break;default:if(r.WTF)throw new Error("unrecognized "+s[0]+" in numFmts")}}}function t$(e){var t=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var n=r[0];n<=r[1];++n)e[n]!=null&&(t[t.length]=Ge("numFmt",null,{numFmtId:n,formatCode:Pt(e[n])}))}),t.length===1?"":(t[t.length]="</numFmts>",t[0]=Ge("numFmts",null,{count:t.length-2}).replace("/>",">"),t.join(""))}var Sd=["numFmtId","fillId","fontId","borderId","xfId"],kd=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function r$(e,t,r){t.CellXf=[];var n,a=!1;(e.match(bn)||[]).forEach(function(i){var s=lt(i),o=0;switch(Va(s[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":case"<xf>":for(n=s,delete n[0],o=0;o<Sd.length;++o)n[Sd[o]]&&(n[Sd[o]]=parseInt(n[Sd[o]],10));for(o=0;o<kd.length;++o)n[kd[o]]&&(n[kd[o]]=tr(n[kd[o]]));if(t.NumberFmt&&n.numFmtId>392){for(o=392;o>60;--o)if(t.NumberFmt[n.numFmtId]==t.NumberFmt[o]){n.numFmtId=o;break}}t.CellXf.push(n);break;case"</xf>":break;case"<alignment":case"<alignment/>":case"<alignment>":var c={};s.vertical&&(c.vertical=s.vertical),s.horizontal&&(c.horizontal=s.horizontal),s.textRotation!=null&&(c.textRotation=s.textRotation),s.indent&&(c.indent=s.indent),s.wrapText&&(c.wrapText=tr(s.wrapText)),n.alignment=c;break;case"</alignment>":break;case"<protection":case"<protection>":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":case"<AlternateContent>":a=!0;break;case"</AlternateContent>":a=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(r&&r.WTF&&!a)throw new Error("unrecognized "+s[0]+" in cellXfs")}})}function n$(e){var t=[];return t[t.length]=Ge("cellXfs",null),e.forEach(function(r){t[t.length]=Ge("xf",null,r)}),t[t.length]="</cellXfs>",t.length===2?"":(t[0]=Ge("cellXfs",null,{count:t.length-2}).replace("/>",">"),t.join(""))}var a$=(function(){return function(r,n,a){var i={};if(!r)return i;r=sb(zf(r,"<!--","-->"));var s;return(s=un(r,"numFmts"))&&e$(s[0],i,a),(s=un(r,"fonts"))&&JB(s[0],i,n,a),(s=un(r,"fills"))&&QB(s[0],i,n,a),(s=un(r,"borders"))&&ZB(s[0],i,n,a),(s=un(r,"cellXfs"))&&r$(s[0],i,a),i}})();function i$(e,t){var r=[$r,Ge("styleSheet",null,{xmlns:qo[0],"xmlns:vt":Zr.vt})],n;return e.SSF&&(n=t$(e.SSF))!=null&&(r[r.length]=n),r[r.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',r[r.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',r[r.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',r[r.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(n=n$(t.cellXfs))&&(r[r.length]=n),r[r.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',r[r.length]='<dxfs count="0"/>',r[r.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',r.length>2&&(r[r.length]="</styleSheet>",r[1]=r[1].replace("/>",">")),r.join("")}function s$(e,t){var r=e.read_shift(2),n=jn(e);return[r,n]}function o$(e,t,r){r||(r=be(6+4*t.length)),r.write_shift(2,e),Jr(t,r);var n=r.length>r.l?r.slice(0,r.l):r;return r.l==null&&(r.l=r.length),n}function l$(e,t,r){var n={};n.sz=e.read_shift(2)/20;var a=FL(e);a.fItalic&&(n.italic=1),a.fCondense&&(n.condense=1),a.fExtend&&(n.extend=1),a.fShadow&&(n.shadow=1),a.fOutline&&(n.outline=1),a.fStrikeout&&(n.strike=1);var i=e.read_shift(2);switch(i===700&&(n.bold=1),e.read_shift(2)){case 1:n.vertAlign="superscript";break;case 2:n.vertAlign="subscript";break}var s=e.read_shift(1);s!=0&&(n.underline=s);var o=e.read_shift(1);o>0&&(n.family=o);var c=e.read_shift(1);switch(c>0&&(n.charset=c),e.l++,n.color=IL(e),e.read_shift(1)){case 1:n.scheme="major";break;case 2:n.scheme="minor";break}return n.name=jn(e),n}function c$(e,t){t||(t=be(153)),t.write_shift(2,e.sz*20),DL(e,t),t.write_shift(2,e.bold?700:400);var r=0;e.vertAlign=="superscript"?r=1:e.vertAlign=="subscript"&&(r=2),t.write_shift(2,r),t.write_shift(1,e.underline||0),t.write_shift(1,e.family||0),t.write_shift(1,e.charset||0),t.write_shift(1,0),ih(e.color,t);var n=0;return n=2,t.write_shift(1,n),Jr(e.name,t),t.length>t.l?t.slice(0,t.l):t}var u$=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],H1,f$=Rn;function N4(e,t){t||(t=be(84)),H1||(H1=Qh(u$));var r=H1[e.patternType];r==null&&(r=40),t.write_shift(4,r);var n=0;if(r!=40)for(ih({auto:1},t),ih({auto:1},t);n<12;++n)t.write_shift(4,0);else{for(;n<4;++n)t.write_shift(4,0);for(;n<12;++n)t.write_shift(4,0)}return t.length>t.l?t.slice(0,t.l):t}function d$(e,t){var r=e.l+t,n=e.read_shift(2),a=e.read_shift(2);return e.l=r,{ixfe:n,numFmtId:a}}function CP(e,t,r){r||(r=be(16)),r.write_shift(2,t||0),r.write_shift(2,e.numFmtId||0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(1,0),r.write_shift(1,0);var n=0;return r.write_shift(1,n),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(1,0),r}function ru(e,t){return t||(t=be(10)),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(4,0),t.write_shift(4,0),t}var h$=Rn;function p$(e,t){return t||(t=be(51)),t.write_shift(1,0),ru(null,t),ru(null,t),ru(null,t),ru(null,t),ru(null,t),t.length>t.l?t.slice(0,t.l):t}function m$(e,t){return t||(t=be(52)),t.write_shift(4,e.xfId),t.write_shift(2,1),t.write_shift(1,0),t.write_shift(1,0),Hu(e.name||"",t),t.length>t.l?t.slice(0,t.l):t}function v$(e,t,r){var n=be(2052);return n.write_shift(4,e),Hu(t,n),Hu(r,n),n.length>n.l?n.slice(0,n.l):n}function g$(e,t,r){var n={};n.NumberFmt=[];for(var a in yt)n.NumberFmt[a]=yt[a];n.CellXf=[],n.Fonts=[];var i=[],s=!1;return fs(e,function(c,u,d){switch(d){case 44:n.NumberFmt[c[0]]=c[1],zs(c[1],c[0]);break;case 43:n.Fonts.push(c),c.color.theme!=null&&t&&t.themeElements&&t.themeElements.clrScheme&&(c.color.rgb=lh(t.themeElements.clrScheme[c.color.theme].rgb,c.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:i[i.length-1]==617&&n.CellXf.push(c);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:s=!0;break;case 36:s=!1;break;case 37:i.push(d),s=!0;break;case 38:i.pop(),s=!1;break;default:if(u.T>0)i.push(d);else if(u.T<0)i.pop();else if(!s||r.WTF&&i[i.length-1]!=37)throw new Error("Unexpected record 0x"+d.toString(16))}}),n}function x$(e,t){if(t){var r=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var a=n[0];a<=n[1];++a)t[a]!=null&&++r}),r!=0&&(je(e,615,li(r)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var a=n[0];a<=n[1];++a)t[a]!=null&&je(e,44,o$(a,t[a]))}),je(e,616))}}function y$(e){var t=1;je(e,611,li(t)),je(e,43,c$({sz:12,color:{theme:1},name:"Calibri",family:2})),je(e,612)}function w$(e){var t=2;je(e,603,li(t)),je(e,45,N4({patternType:"none"})),je(e,45,N4({patternType:"gray125"})),je(e,604)}function b$(e){var t=1;je(e,613,li(t)),je(e,46,p$()),je(e,614)}function _$(e){var t=1;je(e,626,li(t)),je(e,47,CP({numFmtId:0},65535)),je(e,627)}function S$(e,t){je(e,617,li(t.length)),t.forEach(function(r){je(e,47,CP(r,0))}),je(e,618)}function k$(e){var t=1;je(e,619,li(t)),je(e,48,m$({xfId:0,name:"Normal"})),je(e,620)}function E$(e){var t=0;je(e,505,li(t)),je(e,506)}function T$(e){var t=0;je(e,508,v$(t,"TableStyleMedium9","PivotStyleMedium4")),je(e,509)}function A$(e,t){var r=Dn();return je(r,278),x$(r,e.SSF),y$(r),w$(r),b$(r),_$(r),S$(r,t.cellXfs),k$(r),E$(r),T$(r),je(r,279),r.end()}var C$=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function O$(e,t,r){t.themeElements.clrScheme=[];var n={};(e[0].match(bn)||[]).forEach(function(a){var i=lt(a);switch(i[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":n.rgb=i.val;break;case"</a:srgbClr>":break;case"<a:sysClr":n.rgb=i.lastClr;break;case"</a:sysClr>":break;case"</a:dk1>":case"</a:lt1>":case"<a:dk1>":case"<a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":i[0].charAt(1)==="/"?(t.themeElements.clrScheme[C$.indexOf(i[0])]=n,n={}):n.name=i[0].slice(3,i[0].length-1);break;default:if(r&&r.WTF)throw new Error("Unrecognized "+i[0]+" in clrScheme")}})}function N$(e,t,r){t.themeElements={};var n;if(!(n=Oo(e,"a:clrScheme")))throw new Error("clrScheme not found in themeElements");if(O$(n,t,r),!(n=Oo(e,"a:fontScheme")))throw new Error("fontScheme not found in themeElements");if(!(n=Oo(e,"a:fmtScheme")))throw new Error("fmtScheme not found in themeElements")}function OP(e,t){(!e||e.length===0)&&(e=Tb());var r,n={};if(!(r=Oo(e,"a:themeElements")))throw new Error("themeElements not found in theme");return N$(r[0],n,t),n.raw=e,n}function Tb(e,t){if(t&&t.themeXLSX)return t.themeXLSX;if(e&&typeof e.raw=="string")return e.raw;var r=[$r];return r[r.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',r[r.length]="<a:themeElements>",r[r.length]='<a:clrScheme name="Office">',r[r.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',r[r.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',r[r.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',r[r.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',r[r.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',r[r.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',r[r.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',r[r.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',r[r.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',r[r.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',r[r.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',r[r.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',r[r.length]="</a:clrScheme>",r[r.length]='<a:fontScheme name="Office">',r[r.length]="<a:majorFont>",r[r.length]='<a:latin typeface="Cambria"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Times New Roman"/>',r[r.length]='<a:font script="Hebr" typeface="Times New Roman"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="MoolBoran"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Times New Roman"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:majorFont>",r[r.length]="<a:minorFont>",r[r.length]='<a:latin typeface="Calibri"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Arial"/>',r[r.length]='<a:font script="Hebr" typeface="Arial"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="DaunPenh"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Arial"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:minorFont>",r[r.length]="</a:fontScheme>",r[r.length]='<a:fmtScheme name="Office">',r[r.length]="<a:fillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="1"/>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="0"/>',r[r.length]="</a:gradFill>",r[r.length]="</a:fillStyleLst>",r[r.length]="<a:lnStyleLst>",r[r.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]="</a:lnStyleLst>",r[r.length]="<a:effectStyleLst>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',r[r.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',r[r.length]="</a:effectStyle>",r[r.length]="</a:effectStyleLst>",r[r.length]="<a:bgFillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]="</a:bgFillStyleLst>",r[r.length]="</a:fmtScheme>",r[r.length]="</a:themeElements>",r[r.length]="<a:objectDefaults>",r[r.length]="<a:spDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',r[r.length]="</a:spDef>",r[r.length]="<a:lnDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',r[r.length]="</a:lnDef>",r[r.length]="</a:objectDefaults>",r[r.length]="<a:extraClrSchemeLst/>",r[r.length]="</a:theme>",r.join("")}function P$(e,t,r){var n=e.l+t,a=e.read_shift(4);if(a!==124226){if(!r.cellStyles){e.l=n;return}var i=e.slice(e.l);e.l=n;var s;try{s=k6(i,{type:"array"})}catch{return}var o=Wn(s,"theme/theme/theme1.xml",!0);if(o)return OP(o,r)}}function I$(e){return e.read_shift(4)}function F$(e){var t={};switch(t.xclrType=e.read_shift(2),t.nTintShade=e.read_shift(2),t.xclrType){case 0:e.l+=4;break;case 1:t.xclrValue=D$(e,4);break;case 2:t.xclrValue=uP(e);break;case 3:t.xclrValue=I$(e);break;case 4:e.l+=4;break}return e.l+=8,t}function D$(e,t){return Rn(e,t)}function j$(e,t){return Rn(e,t)}function R$(e){var t=e.read_shift(2),r=e.read_shift(2)-4,n=[t];switch(t){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:n[1]=F$(e);break;case 6:n[1]=j$(e,r);break;case 14:case 15:n[1]=e.read_shift(r===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+t+" "+r)}return n}function M$(e,t){var r=e.l+t;e.l+=2;var n=e.read_shift(2);e.l+=2;for(var a=e.read_shift(2),i=[];a-- >0;)i.push(R$(e,r-e.l));return{ixfe:n,ext:i}}function L$(e,t){t.forEach(function(r){r[0]})}function B$(e,t){return{flags:e.read_shift(4),version:e.read_shift(4),name:jn(e)}}function $$(e){var t=be(12+2*e.name.length);return t.write_shift(4,e.flags),t.write_shift(4,e.version),Jr(e.name,t),t.slice(0,t.l)}function U$(e){for(var t=[],r=e.read_shift(4);r-- >0;)t.push([e.read_shift(4),e.read_shift(4)]);return t}function z$(e){var t=be(4+8*e.length);t.write_shift(4,e.length);for(var r=0;r<e.length;++r)t.write_shift(4,e[r][0]),t.write_shift(4,e[r][1]);return t}function W$(e,t){var r=be(8+2*t.length);return r.write_shift(4,e),Jr(t,r),r.slice(0,r.l)}function H$(e){return e.l+=4,e.read_shift(4)!=0}function q$(e,t){var r=be(8);return r.write_shift(4,e),r.write_shift(4,1),r}function V$(e,t,r){var n={Types:[],Cell:[],Value:[]},a=r||{},i=[],s=!1,o=2;return fs(e,function(c,u,d){switch(d){case 335:n.Types.push({name:c.name});break;case 51:c.forEach(function(h){o==1?n.Cell.push({type:n.Types[h[0]-1].name,index:h[1]}):o==0&&n.Value.push({type:n.Types[h[0]-1].name,index:h[1]})});break;case 337:o=c?1:0;break;case 338:o=2;break;case 35:i.push(d),s=!0;break;case 36:i.pop(),s=!1;break;default:if(!u.T){if(!s||a.WTF&&i[i.length-1]!=35)throw new Error("Unexpected record 0x"+d.toString(16))}}}),n}function X$(){var e=Dn();return je(e,332),je(e,334,li(1)),je(e,335,$$({name:"XLDAPR",version:12e4,flags:3496657072})),je(e,336),je(e,339,W$(1,"XLDAPR")),je(e,52),je(e,35,li(514)),je(e,4096,li(0)),je(e,4097,Ra(1)),je(e,36),je(e,53),je(e,340),je(e,337,q$(1)),je(e,51,z$([[1,0]])),je(e,338),je(e,333),e.end()}function G$(e,t,r){var n={Types:[],Cell:[],Value:[]};if(!e)return n;var a=!1,i=2,s;return e.replace(bn,function(o){var c=lt(o);switch(Va(c[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":n.Types.push({name:c.name});break;case"</metadataType>":break;case"<futureMetadata":for(var u=0;u<n.Types.length;++u)n.Types[u].name==c.name&&(s=n.Types[u]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":i==1?n.Cell.push({type:n.Types[c.t-1].name,index:+c.v}):i==0&&n.Value.push({type:n.Types[c.t-1].name,index:+c.v});break;case"</rc>":break;case"<cellMetadata":i=1;break;case"</cellMetadata>":i=2;break;case"<valueMetadata":i=0;break;case"</valueMetadata>":i=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;case"<rvb":if(!s)break;s.offsets||(s.offsets=[]),s.offsets.push(+c.i);break;default:if(!a&&(r!=null&&r.WTF))throw new Error("unrecognized "+c[0]+" in metadata")}return o}),n}function K$(){var e=[$r];return e.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),e.join("")}function Y$(e){var t=[];if(!e)return t;var r=1;return(e.match(bn)||[]).forEach(function(n){var a=lt(n);switch(a[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete a[0],a.i?r=a.i:a.i=r,t.push(a);break}}),t}function Z$(e){var t={};t.i=e.read_shift(4);var r={};r.r=e.read_shift(4),r.c=e.read_shift(4),t.r=Rt(r);var n=e.read_shift(1);return n&2&&(t.l="1"),n&8&&(t.a="1"),t}function Q$(e,t,r){var n=[];return fs(e,function(i,s,o){switch(o){case 63:n.push(i);break;default:if(!s.T)throw new Error("Unexpected record 0x"+o.toString(16))}}),n}function J$(e,t,r,n){if(!e)return e;var a=n||{},i=!1;fs(e,function(o,c,u){switch(u){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:i=!0;break;case 36:i=!1;break;default:if(!c.T){if(!i||a.WTF)throw new Error("Unexpected record 0x"+u.toString(16))}}},a)}function eU(e,t){if(!e)return"??";var r=(e.match(/<c:chart [^<>]*r:id="([^<>"]*)"/)||["",""])[1];return t["!id"][r].Target}function tU(e,t,r){var n=0;(b6(e,"shape")||[]).forEach(function(a){var i="",s=!0,o=-1,c=-1,u=-1;switch(a.replace(bn,function(h,p){var v=lt(h);switch(Va(v[0])){case"<ClientData":v.ObjectType&&(i=v.ObjectType);break;case"<Visible":case"<Visible/>":s=!1;break;case"<Row":case"<Row>":o=p+h.length;break;case"</Row>":c=+a.slice(o,p).trim();break;case"<Column":case"<Column>":o=p+h.length;break;case"</Column>":u=+a.slice(o,p).trim();break}return""}),i){case"Note":var d=ef(t,c>=0&&u>=0?Rt({r:c,c:u}):r[n].ref);d.c&&(d.c.hidden=s),++n;break}})}function NP(e,t,r){var n=[21600,21600],a=["m0,0l0",n[1],n[0],n[1],n[0],"0xe"].join(","),i=[Ge("xml",null,{"xmlns:v":la.v,"xmlns:o":la.o,"xmlns:x":la.x,"xmlns:mv":la.mv}).replace(/\/>/,">"),Ge("o:shapelayout",Ge("o:idmap",null,{"v:ext":"edit",data:e}),{"v:ext":"edit"})],s=65536*e,o=t||[];return o.length>0&&i.push(Ge("v:shapetype",[Ge("v:stroke",null,{joinstyle:"miter"}),Ge("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202",coordsize:n.join(","),"o:spt":202,path:a})),o.forEach(function(c){++s,i.push(rU(c,s))}),i.push("</xml>"),i.join("")}function rU(e,t,r){var n=sr(e[0]),a={color2:"#BEFF82",type:"gradient"};a.type=="gradient"&&(a.angle="-180");var i=a.type=="gradient"?Ge("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,s=Ge("v:fill",i,a),o={on:"t",obscured:"t"};return["<v:shape"+Uu({id:"_x0000_s"+t,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(e[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",s,Ge("v:shadow",null,o),Ge("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",wn("x:Anchor",[n.c+1,0,n.r+1,0,n.c+3,20,n.r+5,20].join(",")),wn("x:AutoFill","False"),wn("x:Row",String(n.r)),wn("x:Column",String(n.c)),e[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"].join("")}function P4(e,t,r,n){var a=e["!data"]!=null,i;t.forEach(function(s){var o=sr(s.ref);if(!(o.r<0||o.c<0)){if(a?(e["!data"][o.r]||(e["!data"][o.r]=[]),i=e["!data"][o.r][o.c]):i=e[s.ref],!i){i={t:"z"},a?e["!data"][o.r][o.c]=i:e[s.ref]=i;var c=Kt(e["!ref"]||"BDWGO1000001:A1");c.s.r>o.r&&(c.s.r=o.r),c.e.r<o.r&&(c.e.r=o.r),c.s.c>o.c&&(c.s.c=o.c),c.e.c<o.c&&(c.e.c=o.c);var u=Nt(c);e["!ref"]=u}i.c||(i.c=[]);var d={a:s.author,t:s.t,r:s.r,T:r};s.h&&(d.h=s.h);for(var h=i.c.length-1;h>=0;--h){if(!r&&i.c[h].T)return;r&&!i.c[h].T&&i.c.splice(h,1)}if(r&&n){for(h=0;h<n.length;++h)if(d.a==n[h].id){d.a=n[h].name||d.a;break}}i.c.push(d)}})}function nU(e,t){if(e.match(/<(?:\w+:)?comments *\/>/))return[];var r=[],n=[],a=un(e,"authors");a&&a[1]&&a[1].split(/<\/\w*:?author>/).forEach(function(s){if(!(s===""||s.trim()==="")){var o=s.match(/<(?:\w+:)?author[^<>]*>(.*)/);o&&r.push(o[1])}});var i=un(e,"commentList");return i&&i[1]&&i[1].split(/<\/\w*:?comment>/).forEach(function(s){if(!(s===""||s.trim()==="")){var o=s.match(/<(?:\w+:)?comment[^<>]*>/);if(o){var c=lt(o[0]),u={author:c.authorId&&r[c.authorId]||"sheetjsghost",ref:c.ref,guid:c.guid},d=sr(c.ref);if(!(t.sheetRows&&t.sheetRows<=d.r)){var h=un(s,"text"),p=!!h&&!!h[1]&&Sb(h[1])||{r:"",t:"",h:""};u.r=p.r,p.r=="<t></t>"&&(p.t=p.h=""),u.t=(p.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),t.cellHTML&&(u.h=p.h),n.push(u)}}}}),n}function aU(e){var t=[$r,Ge("comments",null,{xmlns:qo[0]})],r=[];return t.push("<authors>"),e.forEach(function(n){n[1].forEach(function(a){var i=Pt(a.a);r.indexOf(i)==-1&&(r.push(i),t.push("<author>"+i+"</author>")),a.T&&a.ID&&r.indexOf("tc="+a.ID)==-1&&(r.push("tc="+a.ID),t.push("<author>tc="+a.ID+"</author>"))})}),r.length==0&&(r.push("SheetJ5"),t.push("<author>SheetJ5</author>")),t.push("</authors>"),t.push("<commentList>"),e.forEach(function(n){var a=0,i=[],s=0;if(n[1][0]&&n[1][0].T&&n[1][0].ID&&(a=r.indexOf("tc="+n[1][0].ID)),n[1].forEach(function(u){u.a&&(a=r.indexOf(Pt(u.a))),u.T&&++s,i.push(u.t==null?"":Pt(u.t))}),s===0)n[1].forEach(function(u){t.push('<comment ref="'+n[0]+'" authorId="'+r.indexOf(Pt(u.a))+'"><text>'),t.push(wn("t",u.t==null?"":Pt(u.t))),t.push("</text></comment>")});else{n[1][0]&&n[1][0].T&&n[1][0].ID&&(a=r.indexOf("tc="+n[1][0].ID)),t.push('<comment ref="'+n[0]+'" authorId="'+a+'"><text>');for(var o=`Comment:
    `+i[0]+`
`,c=1;c<i.length;++c)o+=`Reply:
    `+i[c]+`
`;t.push(wn("t",Pt(o))),t.push("</text></comment>")}}),t.push("</commentList>"),t.length>2&&(t[t.length]="</comments>",t[1]=t[1].replace("/>",">")),t.join("")}function iU(e,t){var r=[],n=!1,a={},i=0;return e.replace(bn,function(o,c){var u=lt(o);switch(Va(u[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":a={author:u.personId,guid:u.id,ref:u.ref,T:1};break;case"</threadedComment>":a.t!=null&&r.push(a);break;case"<text>":case"<text":i=c+o.length;break;case"</text>":a.t=e.slice(i,c).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":n=!0;break;case"</mentions>":n=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&t.WTF)throw new Error("unrecognized "+u[0]+" in threaded comments")}return o}),r}function PP(e,t,r){var n=[$r,Ge("ThreadedComments",null,{xmlns:Zr.TCMNT}).replace(/[\/]>/,">")];return e.forEach(function(a){var i="";(a[1]||[]).forEach(function(s,o){if(!s.T){delete s.ID;return}s.a&&t.indexOf(s.a)==-1&&t.push(s.a);var c={ref:a[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+r.tcid++).slice(-12)+"}"};o==0?i=c.id:c.parentId=i,s.ID=c.id,s.a&&(c.personId="{54EE7950-7262-4200-6969-"+("000000000000"+t.indexOf(s.a)).slice(-12)+"}"),n.push(Ge("threadedComment",wn("text",s.t||""),c))})}),n.push("</ThreadedComments>"),n.join("")}function sU(e,t){var r=[],n=!1;return e.replace(bn,function(i){var s=lt(i);switch(Va(s[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":r.push({name:s.displayname,id:s.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&t.WTF)throw new Error("unrecognized "+s[0]+" in threaded comments")}return i}),r}function IP(e){var t=[$r,Ge("personList",null,{xmlns:Zr.TCMNT,"xmlns:x":qo[0]}).replace(/[\/]>/,">")];return e.forEach(function(r,n){t.push(Ge("person",null,{displayName:r,id:"{54EE7950-7262-4200-6969-"+("000000000000"+n).slice(-12)+"}",userId:r,providerId:"None"}))}),t.push("</personList>"),t.join("")}function oU(e){var t={};t.iauthor=e.read_shift(4);var r=Ko(e);return t.rfx=r.s,t.ref=Rt(r.s),e.l+=16,t}function lU(e,t){return t==null&&(t=be(36)),t.write_shift(4,e[1].iauthor),pc(e[0],t),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t}var cU=jn;function I4(e){return Jr(e.slice(0,54))}function uU(e,t){var r=[],n=[],a={},i=!1;return fs(e,function(o,c,u){switch(u){case 632:n.push(o);break;case 635:a=o;break;case 637:a.t=o.t,a.h=o.h,a.r=o.r;break;case 636:if(a.author=n[a.iauthor],delete a.iauthor,t.sheetRows&&a.rfx&&t.sheetRows<=a.rfx.r)break;a.t||(a.t=""),delete a.rfx,r.push(a);break;case 3072:break;case 35:i=!0;break;case 36:i=!1;break;case 37:break;case 38:break;default:if(!c.T){if(!i||t.WTF)throw new Error("Unexpected record 0x"+u.toString(16))}}}),r}function fU(e){var t=Dn(),r=[];return je(t,628),je(t,630),e.forEach(function(n){n[1].forEach(function(a){r.indexOf(a.a)>-1||(r.push(a.a.slice(0,54)),je(t,632,I4(a.a)),a.T&&a.ID&&r.indexOf("tc="+a.ID)==-1&&(r.push("tc="+a.ID),je(t,632,I4("tc="+a.ID))))})}),je(t,631),je(t,633),e.forEach(function(n){n[1].forEach(function(a){var i=-1;a.ID&&(i=r.indexOf("tc="+a.ID)),i==-1&&n[1][0].T&&n[1][0].ID&&(i=r.indexOf("tc="+n[1][0].ID)),i==-1&&(i=r.indexOf(a.a)),a.iauthor=i;var s={s:sr(n[0]),e:sr(n[0])};je(t,635,lU([s,a])),a.t&&a.t.length>0&&je(t,637,CL(a)),je(t,636),delete a.iauthor})}),je(t,634),je(t,629),t.end()}var dU="application/vnd.ms-office.vbaProject";function hU(e){var t=wt.utils.cfb_new({root:"R"});return e.FullPaths.forEach(function(r,n){if(!(r.slice(-1)==="/"||!r.match(/_VBA_PROJECT_CUR/))){var a=r.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");wt.utils.cfb_add(t,a,e.FileIndex[n].content)}}),wt.write(t)}function pU(e,t){t.FullPaths.forEach(function(r,n){if(n!=0){var a=r.replace(/^[\/]*[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");a.slice(-1)!=="/"&&wt.utils.cfb_add(e,a,t.FileIndex[n].content)}})}var mU=["xlsb","xlsm","xlam","biff8","xla"];function vU(){return{"!type":"dialog"}}function gU(){return{"!type":"dialog"}}function xU(){return{"!type":"macro"}}function yU(){return{"!type":"macro"}}var Fo=(function(){var e=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,t={r:0,c:0};function r(n,a,i,s){var o=!1,c=!1;i.length==0?c=!0:i.charAt(0)=="["&&(c=!0,i=i.slice(1,-1)),s.length==0?o=!0:s.charAt(0)=="["&&(o=!0,s=s.slice(1,-1));var u=i.length>0?parseInt(i,10)|0:0,d=s.length>0?parseInt(s,10)|0:0;return o?d+=t.c:--d,c?u+=t.r:--u,a+(o?"":"$")+Ft(d)+(c?"":"$")+Ut(u)}return function(a,i){return t=i,a.replace(e,r)}})(),ip=/(^|[^._A-Z0-9])(\$?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])(\$?)(\d{1,7})(?![_.\(A-Za-z0-9])/g;try{ip=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g}catch{}var sp=(function(){return function(t,r){return t.replace(ip,function(n,a,i,s,o,c){var u=mb(s)-(i?0:r.c),d=pb(c)-(o?0:r.r),h=o=="$"?d+1:d==0?"":"["+d+"]",p=i=="$"?u+1:u==0?"":"["+u+"]";return a+"R"+h+"C"+p})}})();function FP(e,t){return e.replace(ip,function(r,n,a,i,s,o){return n+(a=="$"?a+i:Ft(mb(i)+t.c))+(s=="$"?s+o:Ut(pb(o)+t.r))})}function F4(e,t,r){var n=hn(t),a=n.s,i=sr(r),s={r:i.r-a.r,c:i.c-a.c};return FP(e,s)}function wU(e){return e.length!=1}function D4(e){return e.replace(/_xlfn\./g,"")}function zr(e){e.l+=1}function Vs(e,t){var r=e.read_shift(2);return[r&16383,r>>14&1,r>>15&1]}function DP(e,t,r){var n=2;if(r){if(r.biff>=2&&r.biff<=5)return jP(e);r.biff==12&&(n=4)}var a=e.read_shift(n),i=e.read_shift(n),s=Vs(e),o=Vs(e);return{s:{r:a,c:s[0],cRel:s[1],rRel:s[2]},e:{r:i,c:o[0],cRel:o[1],rRel:o[2]}}}function jP(e){var t=Vs(e),r=Vs(e),n=e.read_shift(1),a=e.read_shift(1);return{s:{r:t[0],c:n,cRel:t[1],rRel:t[2]},e:{r:r[0],c:a,cRel:r[1],rRel:r[2]}}}function bU(e,t,r){if(r.biff<8)return jP(e);var n=e.read_shift(r.biff==12?4:2),a=e.read_shift(r.biff==12?4:2),i=Vs(e),s=Vs(e);return{s:{r:n,c:i[0],cRel:i[1],rRel:i[2]},e:{r:a,c:s[0],cRel:s[1],rRel:s[2]}}}function RP(e,t,r){if(r&&r.biff>=2&&r.biff<=5)return _U(e);var n=e.read_shift(r&&r.biff==12?4:2),a=Vs(e);return{r:n,c:a[0],cRel:a[1],rRel:a[2]}}function _U(e){var t=Vs(e),r=e.read_shift(1);return{r:t[0],c:r,cRel:t[1],rRel:t[2]}}function SU(e){var t=e.read_shift(2),r=e.read_shift(2);return{r:t,c:r&255,fQuoted:!!(r&16384),cRel:r>>15,rRel:r>>15}}function kU(e,t,r){var n=r&&r.biff?r.biff:8;if(n>=2&&n<=5)return EU(e);var a=e.read_shift(n>=12?4:2),i=e.read_shift(2),s=(i&16384)>>14,o=(i&32768)>>15;if(i&=16383,o==1)for(;a>524287;)a-=1048576;if(s==1)for(;i>8191;)i=i-16384;return{r:a,c:i,cRel:s,rRel:o}}function EU(e){var t=e.read_shift(2),r=e.read_shift(1),n=(t&32768)>>15,a=(t&16384)>>14;return t&=16383,n==1&&t>=8192&&(t=t-16384),a==1&&r>=128&&(r=r-256),{r:t,c:r,cRel:a,rRel:n}}function TU(e,t,r){var n=(e[e.l++]&96)>>5,a=DP(e,r.biff>=2&&r.biff<=5?6:8,r);return[n,a]}function AU(e,t,r){var n=(e[e.l++]&96)>>5,a=e.read_shift(2,"i"),i=8;if(r)switch(r.biff){case 5:e.l+=12,i=6;break;case 12:i=12;break}var s=DP(e,i,r);return[n,a,s]}function CU(e,t,r){var n=(e[e.l++]&96)>>5;return e.l+=r&&r.biff>8?12:r.biff<8?6:8,[n]}function OU(e,t,r){var n=(e[e.l++]&96)>>5,a=e.read_shift(2),i=8;if(r)switch(r.biff){case 5:e.l+=12,i=6;break;case 12:i=12;break}return e.l+=i,[n,a]}function NU(e,t,r){var n=(e[e.l++]&96)>>5,a=bU(e,t-1,r);return[n,a]}function PU(e,t,r){var n=(e[e.l++]&96)>>5;return e.l+=r.biff==2?6:r.biff==12?14:7,[n]}function j4(e){var t=e[e.l+1]&1,r=1;return e.l+=4,[t,r]}function IU(e,t,r){e.l+=2;for(var n=e.read_shift(r&&r.biff==2?1:2),a=[],i=0;i<=n;++i)a.push(e.read_shift(r&&r.biff==2?1:2));return a}function FU(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(r&&r.biff==2?1:2)]}function DU(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(r&&r.biff==2?1:2)]}function jU(e){var t=e[e.l+1]&255?1:0;return e.l+=2,[t,e.read_shift(2)]}function RU(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=r&&r.biff==2?3:4,[n]}function MP(e){var t=e.read_shift(1),r=e.read_shift(1);return[t,r]}function MU(e){return e.read_shift(2),MP(e)}function LU(e){return e.read_shift(2),MP(e)}function BU(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var a=RP(e,0,r);return[n,a]}function $U(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var a=kU(e,0,r);return[n,a]}function UU(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var a=e.read_shift(2);r&&r.biff==5&&(e.l+=12);var i=RP(e,0,r);return[n,a,i]}function zU(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var a=e.read_shift(r&&r.biff<=3?1:2);return[rW[a],$P[a],n]}function WU(e,t,r){var n=e[e.l++],a=e.read_shift(1),i=r&&r.biff<=3?[n==88?-1:0,e.read_shift(1)]:HU(e);return[a,(i[0]===0?$P:tW)[i[1]]]}function HU(e){return[e[e.l+1]>>7,e.read_shift(2)&32767]}function qU(e,t,r){e.l+=r&&r.biff==2?3:4}function VU(e,t,r){if(e.l++,r&&r.biff==12)return[e.read_shift(4,"i"),0];var n=e.read_shift(2),a=e.read_shift(r&&r.biff==2?1:2);return[n,a]}function XU(e){return e.l++,tn[e.read_shift(1)]}function GU(e){return e.l++,e.read_shift(2)}function KU(e){return e.l++,e.read_shift(1)!==0}function YU(e){return e.l++,In(e)}function ZU(e,t,r){return e.l++,zl(e,t-1,r)}function QU(e,t){var r=[e.read_shift(1)];if(t==12)switch(r[0]){case 2:r[0]=4;break;case 4:r[0]=16;break;case 0:r[0]=1;break;case 1:r[0]=2;break}switch(r[0]){case 4:r[1]=Mr(e,1)?"TRUE":"FALSE",t!=12&&(e.l+=7);break;case 37:case 16:r[1]=tn[e[e.l]],e.l+=t==12?4:8;break;case 0:e.l+=8;break;case 1:r[1]=In(e);break;case 2:r[1]=Yo(e,0,{biff:t>0&&t<8?2:t});break;default:throw new Error("Bad SerAr: "+r[0])}return r}function JU(e,t,r){for(var n=e.read_shift(r.biff==12?4:2),a=[],i=0;i!=n;++i)a.push((r.biff==12?Ko:ap)(e));return a}function ez(e,t,r){var n=0,a=0;r.biff==12?(n=e.read_shift(4),a=e.read_shift(4)):(a=1+e.read_shift(1),n=1+e.read_shift(2)),r.biff>=2&&r.biff<8&&(--n,--a==0&&(a=256));for(var i=0,s=[];i!=n&&(s[i]=[]);++i)for(var o=0;o!=a;++o)s[i][o]=QU(e,r.biff);return s}function tz(e,t,r){var n=e.read_shift(1)>>>5&3,a=!r||r.biff>=8?4:2,i=e.read_shift(a);switch(r.biff){case 2:e.l+=5;break;case 3:case 4:e.l+=8;break;case 5:e.l+=12;break}return[n,0,i]}function rz(e,t,r){if(r.biff==5)return nz(e);var n=e.read_shift(1)>>>5&3,a=e.read_shift(2),i=e.read_shift(4);return[n,a,i]}function nz(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2,"i");e.l+=8;var n=e.read_shift(2);return e.l+=12,[t,r,n]}function az(e,t,r){var n=e.read_shift(1)>>>5&3;e.l+=r&&r.biff==2?3:4;var a=e.read_shift(r&&r.biff==2?1:2);return[n,a]}function iz(e,t,r){var n=e.read_shift(1)>>>5&3,a=e.read_shift(r&&r.biff==2?1:2);return[n,a]}function sz(e,t,r){var n=e.read_shift(1)>>>5&3;return e.l+=4,r.biff<8&&e.l--,r.biff==12&&(e.l+=2),[n]}function oz(e,t,r){var n=(e[e.l++]&96)>>5,a=e.read_shift(2),i=4;if(r)switch(r.biff){case 5:i=15;break;case 12:i=6;break}return e.l+=i,[n,a]}var lz=Rn,cz=Rn,uz=Rn;function Vf(e,t,r){return e.l+=2,[SU(e)]}function Ab(e){return e.l+=6,[]}var fz=Vf,dz=Ab,hz=Ab,pz=Vf;function LP(e){return e.l+=2,[Ir(e),e.read_shift(2)&1]}var mz=Vf,vz=LP,gz=Ab,xz=Vf,yz=Vf,wz=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function bz(e){e.l+=2;var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(4),a=e.read_shift(2),i=e.read_shift(2),s=wz[r>>2&31];return{ixti:t,coltype:r&3,rt:s,idx:n,c:a,C:i}}function _z(e){return e.l+=2,[e.read_shift(4)]}function Sz(e,t,r){return e.l+=5,e.l+=2,e.l+=r.biff==2?1:4,["PTGSHEET"]}function kz(e,t,r){return e.l+=r.biff==2?4:5,["PTGENDSHEET"]}function Ez(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function Tz(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function Az(e){return e.l+=4,[0,0]}var R4={1:{n:"PtgExp",f:VU},2:{n:"PtgTbl",f:uz},3:{n:"PtgAdd",f:zr},4:{n:"PtgSub",f:zr},5:{n:"PtgMul",f:zr},6:{n:"PtgDiv",f:zr},7:{n:"PtgPower",f:zr},8:{n:"PtgConcat",f:zr},9:{n:"PtgLt",f:zr},10:{n:"PtgLe",f:zr},11:{n:"PtgEq",f:zr},12:{n:"PtgGe",f:zr},13:{n:"PtgGt",f:zr},14:{n:"PtgNe",f:zr},15:{n:"PtgIsect",f:zr},16:{n:"PtgUnion",f:zr},17:{n:"PtgRange",f:zr},18:{n:"PtgUplus",f:zr},19:{n:"PtgUminus",f:zr},20:{n:"PtgPercent",f:zr},21:{n:"PtgParen",f:zr},22:{n:"PtgMissArg",f:zr},23:{n:"PtgStr",f:ZU},26:{n:"PtgSheet",f:Sz},27:{n:"PtgEndSheet",f:kz},28:{n:"PtgErr",f:XU},29:{n:"PtgBool",f:KU},30:{n:"PtgInt",f:GU},31:{n:"PtgNum",f:YU},32:{n:"PtgArray",f:PU},33:{n:"PtgFunc",f:zU},34:{n:"PtgFuncVar",f:WU},35:{n:"PtgName",f:tz},36:{n:"PtgRef",f:BU},37:{n:"PtgArea",f:TU},38:{n:"PtgMemArea",f:az},39:{n:"PtgMemErr",f:lz},40:{n:"PtgMemNoMem",f:cz},41:{n:"PtgMemFunc",f:iz},42:{n:"PtgRefErr",f:sz},43:{n:"PtgAreaErr",f:CU},44:{n:"PtgRefN",f:$U},45:{n:"PtgAreaN",f:NU},46:{n:"PtgMemAreaN",f:Ez},47:{n:"PtgMemNoMemN",f:Tz},57:{n:"PtgNameX",f:rz},58:{n:"PtgRef3d",f:UU},59:{n:"PtgArea3d",f:AU},60:{n:"PtgRefErr3d",f:oz},61:{n:"PtgAreaErr3d",f:OU},255:{}},Cz={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},Oz={1:{n:"PtgElfLel",f:LP},2:{n:"PtgElfRw",f:xz},3:{n:"PtgElfCol",f:fz},6:{n:"PtgElfRwV",f:yz},7:{n:"PtgElfColV",f:pz},10:{n:"PtgElfRadical",f:mz},11:{n:"PtgElfRadicalS",f:gz},13:{n:"PtgElfColS",f:dz},15:{n:"PtgElfColSV",f:hz},16:{n:"PtgElfRadicalLel",f:vz},25:{n:"PtgList",f:bz},29:{n:"PtgSxName",f:_z},255:{}},Nz={0:{n:"PtgAttrNoop",f:Az},1:{n:"PtgAttrSemi",f:RU},2:{n:"PtgAttrIf",f:DU},4:{n:"PtgAttrChoose",f:IU},8:{n:"PtgAttrGoto",f:FU},16:{n:"PtgAttrSum",f:qU},32:{n:"PtgAttrBaxcel",f:j4},33:{n:"PtgAttrBaxcel",f:j4},64:{n:"PtgAttrSpace",f:MU},65:{n:"PtgAttrSpaceSemi",f:LU},128:{n:"PtgAttrIfError",f:jU},255:{}};function Xf(e,t,r,n){if(n.biff<8)return Rn(e,t);for(var a=e.l+t,i=[],s=0;s!==r.length;++s)switch(r[s][0]){case"PtgArray":r[s][1]=ez(e,0,n),i.push(r[s][1]);break;case"PtgMemArea":r[s][2]=JU(e,r[s][1],n),i.push(r[s][2]);break;case"PtgExp":n&&n.biff==12&&(r[s][1][1]=e.read_shift(4),i.push(r[s][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+r[s][0]}return t=a-e.l,t!==0&&i.push(Rn(e,t)),i}function Gf(e,t,r){for(var n=e.l+t,a,i,s=[];n!=e.l;)t=n-e.l,i=e[e.l],a=R4[i]||R4[Cz[i]],(i===24||i===25)&&(a=(i===24?Oz:Nz)[e[e.l+1]]),!a||!a.f?Rn(e,t):s.push([a.n,a.f(e,t,r)]);return s}function Pz(e){for(var t=[],r=0;r<e.length;++r){for(var n=e[r],a=[],i=0;i<n.length;++i){var s=n[i];if(s)switch(s[0]){case 2:a.push('"'+s[1].replace(/"/g,'""')+'"');break;default:a.push(s[1])}else a.push("")}t.push(a.join(","))}return t.join(";")}var Iz={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function Fz(e,t){var r=e.lastIndexOf("!"),n=t.lastIndexOf("!");return r==-1&&n==-1?e+":"+t:r>0&&n>0&&e.slice(0,r).toLowerCase()==t.slice(0,n).toLowerCase()?e+":"+t.slice(n+1):(console.error("Cannot hydrate range",e,t),e+":"+t)}function BP(e,t,r){if(!e)return"SH33TJSERR0";if(r.biff>8&&(!e.XTI||!e.XTI[t]))return e.SheetNames[t];if(!e.XTI)return"SH33TJSERR6";var n=e.XTI[t];if(r.biff<8)return t>1e4&&(t-=65536),t<0&&(t=-t),t==0?"":e.XTI[t-1];if(!n)return"SH33TJSERR1";var a="";if(r.biff>8)switch(e[n[0]][0]){case 357:return a=n[1]==-1?"#REF":e.SheetNames[n[1]],n[1]==n[2]?a:a+":"+e.SheetNames[n[2]];case 358:return r.SID!=null?e.SheetNames[r.SID]:"SH33TJSSAME"+e[n[0]][0];case 355:default:return"SH33TJSSRC"+e[n[0]][0]}switch(e[n[0]][0][0]){case 1025:return a=n[1]==-1?"#REF":e.SheetNames[n[1]]||"SH33TJSERR3",n[1]==n[2]?a:a+":"+e.SheetNames[n[2]];case 14849:return e[n[0]].slice(1).map(function(i){return i.Name}).join(";;");default:return e[n[0]][0][3]?(a=n[1]==-1?"#REF":e[n[0]][0][3][n[1]]||"SH33TJSERR4",n[1]==n[2]?a:a+":"+e[n[0]][0][3][n[2]]):"SH33TJSERR2"}}function M4(e,t,r){var n=BP(e,t,r);return n=="#REF"?n:Wu(n,r)}function Nn(e,t,r,n,a){var i=a&&a.biff||8,s={s:{c:0,r:0}},o=[],c,u,d,h=0,p=0,v,x="";if(!e[0]||!e[0][0])return"";for(var w=-1,y="",_=0,S=e[0].length;_<S;++_){var k=e[0][_];switch(k[0]){case"PtgUminus":o.push("-"+o.pop());break;case"PtgUplus":o.push("+"+o.pop());break;case"PtgPercent":o.push(o.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(c=o.pop(),u=o.pop(),w>=0){switch(e[0][w][1][0]){case 0:y=qt(" ",e[0][w][1][1]);break;case 1:y=qt("\r",e[0][w][1][1]);break;default:if(y="",a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][w][1][0])}u=u+y,w=-1}o.push(u+Iz[k[0]]+c);break;case"PtgIsect":c=o.pop(),u=o.pop(),o.push(u+" "+c);break;case"PtgUnion":c=o.pop(),u=o.pop(),o.push(u+","+c);break;case"PtgRange":c=o.pop(),u=o.pop(),o.push(Fz(u,c));break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":d=_u(k[1][1],s,a),o.push(Su(d,i));break;case"PtgRefN":d=r?_u(k[1][1],r,a):k[1][1],o.push(Su(d,i));break;case"PtgRef3d":h=k[1][1],d=_u(k[1][2],s,a),x=M4(n,h,a),o.push(x+"!"+Su(d,i));break;case"PtgFunc":case"PtgFuncVar":var E=k[1][0],T=k[1][1];E||(E=0),E&=127;var N=E==0?[]:o.slice(-E);o.length-=E,T==="User"&&(T=N.shift()),o.push(T+"("+N.join(",")+")");break;case"PtgBool":o.push(k[1]?"TRUE":"FALSE");break;case"PtgInt":o.push(k[1]);break;case"PtgNum":o.push(String(k[1]));break;case"PtgStr":o.push('"'+k[1].replace(/"/g,'""')+'"');break;case"PtgErr":o.push(k[1]);break;case"PtgAreaN":v=u4(k[1][1],r?{s:r}:s,a),o.push(L1(v,a));break;case"PtgArea":v=u4(k[1][1],s,a),o.push(L1(v,a));break;case"PtgArea3d":h=k[1][1],v=k[1][2],x=M4(n,h,a),o.push(x+"!"+L1(v,a));break;case"PtgAttrSum":o.push("SUM("+o.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":p=k[1][2];var C=(n.names||[])[p-1]||(n[0]||[])[p],P=C?C.Name:"SH33TJSNAME"+String(p);P&&P.slice(0,6)=="_xlfn."&&!a.xlfn&&(P=P.slice(6)),o.push(P);break;case"PtgNameX":var j=k[1][1];p=k[1][2];var R;if(a.biff<=5)j<0&&(j=-j),n[j]&&(R=n[j][p]);else{var I="";if(((n[j]||[])[0]||[])[0]==14849||(((n[j]||[])[0]||[])[0]==1025?n[j][p]&&n[j][p].itab>0&&(I=n.SheetNames[n[j][p].itab-1]+"!"):I=n.SheetNames[p-1]+"!"),n[j]&&n[j][p])I+=n[j][p].Name;else if(n[0]&&n[0][p])I+=n[0][p].Name;else{var F=(BP(n,j,a)||"").split(";;");F[p-1]?I=F[p-1]:I+="SH33TJSERRX"}o.push(I);break}R||(R={Name:"SH33TJSERRY"}),o.push(R.Name);break;case"PtgParen":var L="(",H=")";if(w>=0){switch(y="",e[0][w][1][0]){case 2:L=qt(" ",e[0][w][1][1])+L;break;case 3:L=qt("\r",e[0][w][1][1])+L;break;case 4:H=qt(" ",e[0][w][1][1])+H;break;case 5:H=qt("\r",e[0][w][1][1])+H;break;default:if(a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][w][1][0])}w=-1}o.push(L+o.pop()+H);break;case"PtgRefErr":o.push("#REF!");break;case"PtgRefErr3d":o.push("#REF!");break;case"PtgExp":d={c:k[1][1],r:k[1][0]};var V={c:r.c,r:r.r};if(n.sharedf[Rt(d)]){var J=n.sharedf[Rt(d)];o.push(Nn(J,s,V,n,a))}else{var te=!1;for(c=0;c!=n.arrayf.length;++c)if(u=n.arrayf[c],!(d.c<u[0].s.c||d.c>u[0].e.c)&&!(d.r<u[0].s.r||d.r>u[0].e.r)){o.push(Nn(u[1],s,V,n,a)),te=!0;break}te||o.push(k[1])}break;case"PtgArray":o.push("{"+Pz(k[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":w=_;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":o.push("");break;case"PtgAreaErr":o.push("#REF!");break;case"PtgAreaErr3d":o.push("#REF!");break;case"PtgList":o.push("Table"+k[1].idx+"[#"+k[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(k));default:throw new Error("Unrecognized Formula Token: "+String(k))}var q=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(a.biff!=3&&w>=0&&q.indexOf(e[0][_][0])==-1){k=e[0][w];var oe=!0;switch(k[1][0]){case 4:oe=!1;case 0:y=qt(" ",k[1][1]);break;case 5:oe=!1;case 1:y=qt("\r",k[1][1]);break;default:if(y="",a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+k[1][0])}o.push((oe?y:"")+o.pop()+(oe?"":y)),w=-1}}if(o.length>1&&a.WTF)throw new Error("bad formula stack");return o[0]=="TRUE"?!0:o[0]=="FALSE"?!1:o[0]}function Dz(e,t,r){var n=e.l+t,a=r.biff==2?1:2,i,s=e.read_shift(a);if(s==65535)return[[],Rn(e,t-2)];var o=Gf(e,s,r);return t!==s+a&&(i=Xf(e,t-s-a,o,r)),e.l=n,[o,i]}function jz(e,t,r){var n=e.l+t,a=r.biff==2?1:2,i,s=e.read_shift(a);if(s==65535)return[[],Rn(e,t-2)];var o=Gf(e,s,r);return t!==s+a&&(i=Xf(e,t-s-a,o,r)),e.l=n,[o,i]}function Rz(e,t,r,n){var a=e.l+t,i=Gf(e,n,r),s;return a!==e.l&&(s=Xf(e,a-e.l,i,r)),[i,s]}function Mz(e,t,r){var n=e.l+t,a,i=e.read_shift(2),s=Gf(e,i,r);return i==65535?[[],Rn(e,t-2)]:(t!==i+2&&(a=Xf(e,n-i-2,s,r)),[s,a])}function Lz(e){var t;if(Ki(e,e.l+6)!==65535)return[In(e),"n"];switch(e[e.l]){case 0:return e.l+=8,["String","s"];case 1:return t=e[e.l+2]===1,e.l+=8,[t,"b"];case 2:return t=e[e.l+2],e.l+=8,[t,"e"];case 3:return e.l+=8,["","s"]}return[]}function Bz(e){if(e==null){var t=be(8);return t.write_shift(1,3),t.write_shift(1,0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,65535),t}else if(typeof e=="number")return Uo(e);return Uo(0)}function q1(e,t,r){var n=e.l+t,a=fi(e,6,r),i=Lz(e),s=e.read_shift(1);r.biff!=2&&(e.read_shift(1),r.biff>=5&&e.read_shift(4));var o=jz(e,n-e.l,r);return{cell:a,val:i[0],formula:o,shared:s>>3&1,tt:i[1]}}function $z(e,t,r,n,a){var i=Wo(t,r,a),s=Bz(e.v),o=be(6),c=33;o.write_shift(2,c),o.write_shift(4,0);for(var u=be(e.bf.length),d=0;d<e.bf.length;++d)u[d]=e.bf[d];var h=Lr([i,s,o,u]);return h}function op(e,t,r){var n=e.read_shift(4),a=Gf(e,n,r),i=e.read_shift(4),s=i>0?Xf(e,i,a,r):null;return[a,s]}var Uz=op,lp=op,zz=op,Wz=op;function L4(e){if((e|0)==e&&e<Math.pow(2,16)&&e>=0){var t=be(11);return t.write_shift(4,3),t.write_shift(1,30),t.write_shift(2,e),t.write_shift(4,0),t}var r=be(17);return r.write_shift(4,11),r.write_shift(1,31),r.write_shift(8,e),r.write_shift(4,0),r}function Hz(e){var t=be(10);return t.write_shift(4,2),t.write_shift(1,28),t.write_shift(1,e),t.write_shift(4,0),t}function qz(e){var t=be(10);return t.write_shift(4,2),t.write_shift(1,29),t.write_shift(1,e?1:0),t.write_shift(4,0),t}function Vz(e){var t=be(7);t.write_shift(4,3+2*e.length),t.write_shift(1,23),t.write_shift(2,e.length);var r=be(2*e.length);r.write_shift(2*e.length,e,"utf16le");var n=be(4);return n.write_shift(4,0),Lr([t,r,n])}function Xz(e){var t=sr(e),r=be(15);return r.write_shift(4,7),r.write_shift(1,36),r.write_shift(4,t.r),r.write_shift(2,t.c|(e.charAt(0)=="$"?0:1)<<14|(e.match(/\$\d/)?0:1)<<15),r.write_shift(4,0),r}function Gz(e,t){var r=e.lastIndexOf("!"),n=e.slice(0,r);e=e.slice(r+1);var a=sr(e);n.charAt(0)=="'"&&(n=n.slice(1,-1).replace(/''/g,"'"));var i=be(17);return i.write_shift(4,9),i.write_shift(1,58),i.write_shift(2,2+t.SheetNames.map(function(s){return s.toLowerCase()}).indexOf(n.toLowerCase())),i.write_shift(4,a.r),i.write_shift(2,a.c|(e.charAt(0)=="$"?0:1)<<14|(e.match(/\$\d/)?0:1)<<15),i.write_shift(4,0),i}function Kz(e,t){var r=e.lastIndexOf("!"),n=e.slice(0,r);e=e.slice(r+1),n.charAt(0)=="'"&&(n=n.slice(1,-1).replace(/''/g,"'"));var a=be(17);return a.write_shift(4,9),a.write_shift(1,60),a.write_shift(2,2+t.SheetNames.map(function(i){return i.toLowerCase()}).indexOf(n.toLowerCase())),a.write_shift(4,0),a.write_shift(2,0),a.write_shift(4,0),a}function Yz(e){var t=e.split(":"),r=t[0],n=be(23);n.write_shift(4,15),r=t[0];var a=sr(r);return n.write_shift(1,36),n.write_shift(4,a.r),n.write_shift(2,a.c|(r.charAt(0)=="$"?0:1)<<14|(r.match(/\$\d/)?0:1)<<15),n.write_shift(4,0),r=t[1],a=sr(r),n.write_shift(1,36),n.write_shift(4,a.r),n.write_shift(2,a.c|(r.charAt(0)=="$"?0:1)<<14|(r.match(/\$\d/)?0:1)<<15),n.write_shift(4,0),n.write_shift(1,17),n.write_shift(4,0),n}function Zz(e,t){var r=e.lastIndexOf("!"),n=e.slice(0,r);e=e.slice(r+1),n.charAt(0)=="'"&&(n=n.slice(1,-1).replace(/''/g,"'"));var a=e.split(":"),i=be(27);i.write_shift(4,19);var s=a[0],o=sr(s);return i.write_shift(1,58),i.write_shift(2,2+t.SheetNames.map(function(c){return c.toLowerCase()}).indexOf(n.toLowerCase())),i.write_shift(4,o.r),i.write_shift(2,o.c|(s.charAt(0)=="$"?0:1)<<14|(s.match(/\$\d/)?0:1)<<15),s=a[1],o=sr(s),i.write_shift(1,58),i.write_shift(2,2+t.SheetNames.map(function(c){return c.toLowerCase()}).indexOf(n.toLowerCase())),i.write_shift(4,o.r),i.write_shift(2,o.c|(s.charAt(0)=="$"?0:1)<<14|(s.match(/\$\d/)?0:1)<<15),i.write_shift(1,17),i.write_shift(4,0),i}function Qz(e,t){var r=e.lastIndexOf("!"),n=e.slice(0,r);e=e.slice(r+1),n.charAt(0)=="'"&&(n=n.slice(1,-1).replace(/''/g,"'"));var a=hn(e),i=be(23);return i.write_shift(4,15),i.write_shift(1,59),i.write_shift(2,2+t.SheetNames.map(function(s){return s.toLowerCase()}).indexOf(n.toLowerCase())),i.write_shift(4,a.s.r),i.write_shift(4,a.e.r),i.write_shift(2,a.s.c),i.write_shift(2,a.e.c),i.write_shift(4,0),i}function Jz(e,t){if(typeof e=="number")return L4(e);if(typeof e=="boolean")return qz(e);if(/^#(DIV\/0!|GETTING_DATA|N\/A|NAME\?|NULL!|NUM!|REF!|VALUE!)$/.test(e))return Hz(+dn[e]);if(e.match(/^\$?(?:[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D]|[A-Z]{1,2})\$?(?:10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})$/))return Xz(e);if(e.match(/^\$?(?:[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D]|[A-Z]{1,2})\$?(?:10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5}):\$?(?:[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D]|[A-Z]{1,2})\$?(?:10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})$/))return Yz(e);if(e.match(/^#REF!\$?(?:[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D]|[A-Z]{1,2})\$?(?:10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5}):\$?(?:[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D]|[A-Z]{1,2})\$?(?:10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})$/))return Qz(e,t);if(e.match(/^(?:'[^\\\/?*\[\]:]*'|[^'][^\\\/?*\[\]:'`~!@#$%^()\-=+{}|;,<.>]*)!\$?(?:[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D]|[A-Z]{1,2})\$?(?:10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})$/))return Gz(e,t);if(e.match(/^(?:'[^\\\/?*\[\]:]*'|[^'][^\\\/?*\[\]:'`~!@#$%^()\-=+{}|;,<.>]*)!\$?(?:[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D]|[A-Z]{1,2})\$?(?:10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5}):\$?(?:[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D]|[A-Z]{1,2})\$?(?:10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})$/))return Zz(e,t);if(/^(?:'[^\\\/?*\[\]:]*'|[^'][^\\\/?*\[\]:'`~!@#$%^()\-=+{}|;,<.>]*)!#REF!$/.test(e))return Kz(e,t);if(/^".*"$/.test(e))return Vz(e);if(/^[+-]\d+$/.test(e))return L4(parseInt(e,10));throw"Formula |"+e+"| not supported for XLSB"}var eW=Jz,tW={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},$P={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},rW={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function B4(e){return e.slice(0,3)=="of:"&&(e=e.slice(3)),e.charCodeAt(0)==61&&(e=e.slice(1),e.charCodeAt(0)==61&&(e=e.slice(1))),e=e.replace(/COM\.MICROSOFT\./g,""),e=e.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(t,r){return r.replace(/\./g,"")}),e=e.replace(/\$'([^']|'')+'/g,function(t){return t.slice(1)}),e=e.replace(/\$([^\]\. #$]+)/g,function(t,r){return r.match(/^([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])?(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})?$/)?t:r}),e=e.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),e.replace(/[;~]/g,",").replace(/\|/g,";")}function nW(e){var t="of:="+e.replace(ip,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return t.replace(/;/g,"|").replace(/,/g,";")}function V1(e){e=e.replace(/\$'([^']|'')+'/g,function(n){return n.slice(1)}),e=e.replace(/\$([^\]\. #$]+)/g,function(n,a){return a.match(/^([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])?(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})?$/)?n:a});var t=e.split(":"),r=t[0].split(".")[0];return[r,t[0].split(".")[1]+(t.length>1?":"+(t[1].split(".")[1]||t[1].split(".")[0]):"")]}function UP(e){return e.replace(/!/,".").replace(/:/,":.")}var Tu={},Rl={},Au=typeof Map<"u";function Cb(e,t,r){var n=0,a=e.length;if(r){if(Au?r.has(t):Object.prototype.hasOwnProperty.call(r,t)){for(var i=Au?r.get(t):r[t];n<i.length;++n)if(e[i[n]].t===t)return e.Count++,i[n]}}else for(;n<a;++n)if(e[n].t===t)return e.Count++,n;return e[a]={t},e.Count++,e.Unique++,r&&(Au?(r.has(t)||r.set(t,[]),r.get(t).push(a)):(Object.prototype.hasOwnProperty.call(r,t)||(r[t]=[]),r[t].push(a))),a}function cp(e,t){var r={min:e+1,max:e+1},n=-1;return t.MDW&&(Pn=t.MDW),t.width!=null?r.customWidth=1:t.wpx!=null?n=Gu(t.wpx):t.wch!=null&&(n=t.wch),n>-1?(r.width=ch(n),r.customWidth=1):t.width!=null&&(r.width=t.width),t.hidden&&(r.hidden=!0),t.level!=null&&(r.outlineLevel=r.level=t.level),r}function Do(e,t){if(e){var r=[.7,.7,.75,.75,.3,.3];t=="xlml"&&(r=[1,1,1,1,.5,.5]),e.left==null&&(e.left=r[0]),e.right==null&&(e.right=r[1]),e.top==null&&(e.top=r[2]),e.bottom==null&&(e.bottom=r[3]),e.header==null&&(e.header=r[4]),e.footer==null&&(e.footer=r[5])}}function Zs(e,t,r){var n=r.revssf[t.z!=null?t.z:"General"],a=60,i=e.length;if(n==null&&r.ssf){for(;a<392;++a)if(r.ssf[a]==null){zs(t.z,a),r.ssf[a]=t.z,r.revssf[t.z]=n=a;break}}for(a=0;a!=i;++a)if(e[a].numFmtId===n)return a;return e[i]={numFmtId:n,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},i}function zP(e,t,r,n,a,i,s){try{n.cellNF&&(e.z=yt[t])}catch(c){if(n.WTF)throw c}if(!(e.t==="z"&&!n.cellStyles)){if(e.t==="d"&&typeof e.v=="string"&&(e.v=Tr(e.v)),(!n||n.cellText!==!1)&&e.t!=="z")try{if(yt[t]==null&&zs(CM[t]||"General",t),e.t==="e")e.w=e.w||tn[e.v];else if(t===0)if(e.t==="n")(e.v|0)===e.v?e.w=e.v.toString(10):e.w=Bu(e.v);else if(e.t==="d"){var o=Or(e.v,!!s);(o|0)===o?e.w=o.toString(10):e.w=Bu(o)}else{if(e.v===void 0)return"";e.w=Lo(e.v,Rl)}else e.t==="d"?e.w=ma(t,Or(e.v,!!s),Rl):e.w=ma(t,e.v,Rl)}catch(c){if(n.WTF)throw c}if(n.cellStyles&&r!=null)try{e.s=i.Fills[r],e.s.fgColor&&e.s.fgColor.theme&&!e.s.fgColor.rgb&&(e.s.fgColor.rgb=lh(a.themeElements.clrScheme[e.s.fgColor.theme].rgb,e.s.fgColor.tint||0),n.WTF&&(e.s.fgColor.raw_rgb=a.themeElements.clrScheme[e.s.fgColor.theme].rgb)),e.s.bgColor&&e.s.bgColor.theme&&(e.s.bgColor.rgb=lh(a.themeElements.clrScheme[e.s.bgColor.theme].rgb,e.s.bgColor.tint||0),n.WTF&&(e.s.bgColor.raw_rgb=a.themeElements.clrScheme[e.s.bgColor.theme].rgb))}catch(c){if(n.WTF&&i.Fills)throw c}}}function aW(e,t,r){if(e&&e["!ref"]){var n=Kt(e["!ref"]);if(n.e.c<n.s.c||n.e.r<n.s.r)throw new Error("Bad range ("+r+"): "+e["!ref"])}}function iW(e,t){var r=Kt(t);r.s.r<=r.e.r&&r.s.c<=r.e.c&&r.s.r>=0&&r.s.c>=0&&(e["!ref"]=Nt(r))}var sW=/<(?:\w+:)?mergeCell ref=["'][A-Z0-9:]+['"]\s*[\/]?>/g,oW=/<(?:\w+:)?hyperlink [^<>]*>/mg,lW=/"(\w*:\w*)"/,cW=/<(?:\w+:)?col\b[^<>]*[\/]?>/g,uW=/<(?:\w+:)?autoFilter[^>]*/g,fW=/<(?:\w+:)?pageMargins[^<>]*\/>/g,WP=/<(?:\w+:)?sheetPr\b[^<>]*?\/>/;function dW(e,t,r,n,a,i,s){if(!e)return e;n||(n={"!id":{}});var o={};t.dense&&(o["!data"]=[]);var c={s:{r:2e6,c:2e6},e:{r:0,c:0}},u="",d="",h=un(e,"sheetData");h?(u=e.slice(0,h.index),d=e.slice(h.index+h[0].length)):u=d=e;var p=u.match(WP);p?Ob(p[0],o,a,r):(p=un(u,"sheetPr"))&&pW(p[0],p[1]||"",o,a,r);var v=(u.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(v>0){var x=u.slice(v,v+50).match(lW);x&&!(t&&t.nodim)&&iW(o,x[1])}var w=un(u,"sheetViews");w&&w[1]&&AW(w[1],a);var y=[];if(t.cellStyles){var _=u.match(cW);_&&_W(y,_)}h&&NW(h[1],o,t,c,i,s,a);var S=d.match(uW);S&&(o["!autofilter"]=kW(S[0]));var k=[],E=d.match(sW);if(E)for(v=0;v!=E.length;++v)k[v]=Kt(E[v].slice(E[v].indexOf("=")+2));var T=d.match(oW);T&&yW(o,T,n);var N=d.match(fW);N&&(o["!margins"]=wW(lt(N[0])));var C;if((C=d.match(/legacyDrawing r:id="(.*?)"/))&&(o["!legrel"]=C[1]),t&&t.nodim&&(c.s.c=c.s.r=0),!o["!ref"]&&c.e.c>=c.s.c&&c.e.r>=c.s.r&&(o["!ref"]=Nt(c)),t.sheetRows>0&&o["!ref"]){var P=Kt(o["!ref"]);t.sheetRows<=+P.e.r&&(P.e.r=t.sheetRows-1,P.e.r>c.e.r&&(P.e.r=c.e.r),P.e.r<P.s.r&&(P.s.r=P.e.r),P.e.c>c.e.c&&(P.e.c=c.e.c),P.e.c<P.s.c&&(P.s.c=P.e.c),o["!fullref"]=o["!ref"],o["!ref"]=Nt(P))}return y.length>0&&(o["!cols"]=y),k.length>0&&(o["!merges"]=k),n["!id"][o["!legrel"]]&&(o["!legdrawel"]=n["!id"][o["!legrel"]]),o}function hW(e){if(e.length===0)return"";for(var t='<mergeCells count="'+e.length+'">',r=0;r!=e.length;++r)t+='<mergeCell ref="'+Nt(e[r])+'"/>';return t+"</mergeCells>"}function Ob(e,t,r,n){var a=lt(e);r.Sheets[n]||(r.Sheets[n]={}),a.codeName&&(r.Sheets[n].CodeName=zt(ir(a.codeName)))}function pW(e,t,r,n,a){Ob(e.slice(0,e.indexOf(">")),r,n,a)}function mW(e,t,r,n,a){var i=!1,s={},o=null;if(n.bookType!=="xlsx"&&t.vbaraw){var c=t.SheetNames[r];try{t.Workbook&&(c=t.Workbook.Sheets[r].CodeName||c)}catch{}i=!0,s.codeName=ki(Pt(c))}if(e&&e["!outline"]){var u={summaryBelow:1,summaryRight:1};e["!outline"].above&&(u.summaryBelow=0),e["!outline"].left&&(u.summaryRight=0),o=(o||"")+Ge("outlinePr",null,u)}!i&&!o||(a[a.length]=Ge("sheetPr",o,s))}var vW=["objects","scenarios","selectLockedCells","selectUnlockedCells"],gW=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function xW(e){var t={sheet:1};return vW.forEach(function(r){e[r]!=null&&e[r]&&(t[r]="1")}),gW.forEach(function(r){e[r]!=null&&!e[r]&&(t[r]="0")}),e.password&&(t.password=kb(e.password).toString(16).toUpperCase()),Ge("sheetProtection",null,t)}function yW(e,t,r){for(var n=e["!data"]!=null,a=0;a!=t.length;++a){var i=lt(ir(t[a]),!0);if(!i.ref)return;var s=((r||{})["!id"]||[])[i.id];s?(i.Target=s.Target,i.location&&(i.Target+="#"+zt(i.location))):(i.Target="#"+zt(i.location),s={Target:i.Target,TargetMode:"Internal"}),i.Rel=s,i.tooltip&&(i.Tooltip=i.tooltip,delete i.tooltip);for(var o=Kt(i.ref),c=o.s.r;c<=o.e.r;++c)for(var u=o.s.c;u<=o.e.c;++u){var d=Ft(u)+Ut(c);n?(e["!data"][c]||(e["!data"][c]=[]),e["!data"][c][u]||(e["!data"][c][u]={t:"z",v:void 0}),e["!data"][c][u].l=i):(e[d]||(e[d]={t:"z",v:void 0}),e[d].l=i)}}}function wW(e){var t={};return["left","right","top","bottom","header","footer"].forEach(function(r){e[r]&&(t[r]=parseFloat(e[r]))}),t}function bW(e){return Do(e),Ge("pageMargins",null,e)}function _W(e,t){for(var r=!1,n=0;n!=t.length;++n){var a=lt(t[n],!0);a.hidden&&(a.hidden=tr(a.hidden));var i=parseInt(a.min,10)-1,s=parseInt(a.max,10)-1;for(a.outlineLevel&&(a.level=+a.outlineLevel||0),delete a.min,delete a.max,a.width=+a.width,!r&&a.width&&(r=!0,Eb(a.width)),qs(a);i<=s;)e[i++]=dr(a)}}function SW(e,t){for(var r=["<cols>"],n,a=0;a!=t.length;++a)(n=t[a])&&(r[r.length]=Ge("col",null,cp(a,n)));return r[r.length]="</cols>",r.join("")}function kW(e){var t={ref:(e.match(/ref="([^"]*)"/)||[])[1]};return t}function EW(e,t,r,n){var a=typeof e.ref=="string"?e.ref:Nt(e.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var i=r.Workbook.Names,s=hn(a);s.s.r==s.e.r&&(s.e.r=hn(t["!ref"]).e.r,a=Nt(s));for(var o=0;o<i.length;++o){var c=i[o];if(c.Name=="_xlnm._FilterDatabase"&&c.Sheet==n){c.Ref=Wu(r.SheetNames[n])+"!"+zu(a);break}}return o==i.length&&i.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+a}),Ge("autoFilter",null,{ref:a})}var TW=/<(?:\w:)?sheetView(?:[^<>a-z][^<>]*)?\/?>/g;function AW(e,t){t.Views||(t.Views=[{}]),(e.match(TW)||[]).forEach(function(r,n){var a=lt(r);t.Views[n]||(t.Views[n]={}),+a.zoomScale&&(t.Views[n].zoom=+a.zoomScale),a.rightToLeft&&tr(a.rightToLeft)&&(t.Views[n].RTL=!0)})}function CW(e,t,r,n){var a={workbookViewId:"0"};return(((n||{}).Workbook||{}).Views||[])[0]&&(a.rightToLeft=n.Workbook.Views[0].RTL?"1":"0"),Ge("sheetViews",Ge("sheetView",null,a),{})}function OW(e,t,r,n,a,i,s){if(e.c&&r["!comments"].push([t,e.c]),(e.v===void 0||e.t==="z"&&!(n||{}).sheetStubs)&&typeof e.f!="string"&&typeof e.z>"u")return"";var o="",c=e.t,u=e.v;if(e.t!=="z")switch(e.t){case"b":o=e.v?"1":"0";break;case"n":isNaN(e.v)?(e.t="e",o=tn[e.v=36]):isFinite(e.v)?o=""+e.v:(e.t="e",o=tn[e.v=7]);break;case"e":o=tn[e.v];break;case"d":if(n&&n.cellDates){var d=Tr(e.v,s);o=d.toISOString(),d.getUTCFullYear()<1900&&(o=o.slice(o.indexOf("T")+1).replace("Z",""))}else e=dr(e),e.t="n",o=""+(e.v=Or(Tr(e.v,s),s));typeof e.z>"u"&&(e.z=yt[14]);break;default:o=e.v;break}var h=e.t=="z"||e.v==null?"":wn("v",Pt(o)),p={r:t},v=Zs(n.cellXfs,e,n);switch(v!==0&&(p.s=v),e.t){case"n":break;case"d":p.t="d";break;case"b":p.t="b";break;case"e":p.t="e";break;case"z":break;default:if(e.v==null){delete e.t;break}if(e.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(n&&n.bookSST){h=wn("v",""+Cb(n.Strings,e.v,n.revStrings)),p.t="s";break}else p.t="str";break}if(e.t!=c&&(e.t=c,e.v=u),typeof e.f=="string"&&e.f){var x=e.F&&e.F.slice(0,t.length)==t?{t:"array",ref:e.F}:null;h=Ge("f",Pt(e.f),x)+(e.v!=null?h:"")}return e.l&&(e.l.display=Pt(o),r["!links"].push([t,e.l])),e.D&&(p.cm=1),Ge("c",h,p)}var NW=(function(){var e=/<(?:\w+:)?c[ \/>]/,t=/<\/(?:\w+:)?row>/,r=/r=["']([^"']*)["']/,n=/ref=["']([^"']*)["']/;return function(i,s,o,c,u,d,h){for(var p=0,v="",x=[],w=[],y=0,_=0,S=0,k="",E,T,N=0,C=0,P,j,R=0,I=0,F=Array.isArray(d.CellXf),L,H=[],V=[],J=s["!data"]!=null,te=[],q={},oe=!1,Q=!!o.sheetStubs,Z=!!((h||{}).WBProps||{}).date1904,ee=i.split(t),ce=0,de=ee.length;ce!=de;++ce){v=ee[ce].trim();var Te=v.length;if(Te!==0){var Ie=0;e:for(p=0;p<Te;++p)switch(v[p]){case">":if(v[p-1]!="/"){++p;break e}if(o&&o.cellStyles){if(T=lt(v.slice(Ie,p),!0),N=T.r!=null?parseInt(T.r,10):N+1,C=-1,o.sheetRows&&o.sheetRows<N)continue;q={},oe=!1,T.ht&&(oe=!0,q.hpt=parseFloat(T.ht),q.hpx=Hl(q.hpt)),T.hidden&&tr(T.hidden)&&(oe=!0,q.hidden=!0),T.outlineLevel!=null&&(oe=!0,q.level=+T.outlineLevel),oe&&(te[N-1]=q)}break;case"<":Ie=p;break}if(Ie>=p)break;if(T=lt(v.slice(Ie,p),!0),N=T.r!=null?parseInt(T.r,10):N+1,C=-1,!(o.sheetRows&&o.sheetRows<N)){o.nodim||(c.s.r>N-1&&(c.s.r=N-1),c.e.r<N-1&&(c.e.r=N-1)),o&&o.cellStyles&&(q={},oe=!1,T.ht&&(oe=!0,q.hpt=parseFloat(T.ht),q.hpx=Hl(q.hpt)),T.hidden&&tr(T.hidden)&&(oe=!0,q.hidden=!0),T.outlineLevel!=null&&(oe=!0,q.level=+T.outlineLevel),oe&&(te[N-1]=q)),x=v.slice(p).split(e);for(var Ne=0;Ne!=x.length&&x[Ne].trim().charAt(0)=="<";++Ne);for(x=x.slice(Ne),p=0;p!=x.length;++p)if(v=x[p].trim(),v.length!==0){if(w=v.match(r),y=p,_=0,S=0,v="<c "+(v.slice(0,1)=="<"?">":"")+v,w!=null&&w.length===2){for(y=0,k=w[1],_=0;_!=k.length&&!((S=k.charCodeAt(_)-64)<1||S>26);++_)y=26*y+S;--y,C=y}else++C;for(_=0;_!=v.length&&v.charCodeAt(_)!==62;++_);if(++_,T=lt(v.slice(0,_),!0),T.r||(T.r=Rt({r:N-1,c:C})),k=v.slice(_),E={t:""},(w=un(k,"v"))!=null&&w[1]!==""&&(E.v=zt(w[1])),o.cellFormula){if((w=un(k,"f"))!=null){if(w[1]=="")w[0].indexOf('t="shared"')>-1&&(j=lt(w[0]),V[j.si]&&(E.f=F4(V[j.si][1],V[j.si][2],T.r)));else if(E.f=zt(ir(w[1]),!0),o.xlfn||(E.f=D4(E.f)),w[0].indexOf('t="array"')>-1)E.F=(k.match(n)||[])[1],E.F.indexOf(":")>-1&&H.push([Kt(E.F),E.F]);else if(w[0].indexOf('t="shared"')>-1){j=lt(w[0]);var W=zt(ir(w[1]));o.xlfn||(W=D4(W)),V[parseInt(j.si,10)]=[j,W,T.r]}}else(w=k.match(/<f[^<>]*\/>/))&&(j=lt(w[0]),V[j.si]&&(E.f=F4(V[j.si][1],V[j.si][2],T.r)));var z=sr(T.r);for(_=0;_<H.length;++_)z.r>=H[_][0].s.r&&z.r<=H[_][0].e.r&&z.c>=H[_][0].s.c&&z.c<=H[_][0].e.c&&(E.F=H[_][1])}if(T.t==null&&E.v===void 0)if(E.f||E.F)E.v=0,E.t="n";else if(Q)E.t="z";else continue;else E.t=T.t||"n";switch(c.s.c>C&&(c.s.c=C),c.e.c<C&&(c.e.c=C),E.t){case"n":if(E.v==""||E.v==null){if(!Q)continue;E.t="z"}else E.v=parseFloat(E.v);break;case"s":if(typeof E.v>"u"){if(!Q)continue;E.t="z"}else P=Tu[parseInt(E.v,10)],E.v=P.t,E.r=P.r,o.cellHTML&&(E.h=P.h);break;case"str":E.t="s",E.v=E.v!=null?zt(ir(E.v),!0):"",o.cellHTML&&(E.h=wu(E.v));break;case"inlineStr":w=un(k,"is"),E.t="s",w!=null&&(P=Sb(w[1]))?(E.v=P.t,o.cellHTML&&(E.h=P.h)):E.v="";break;case"b":E.v=tr(E.v);break;case"d":o.cellDates?E.v=Tr(E.v,Z):(E.v=Or(Tr(E.v,Z),Z),E.t="n");break;case"e":(!o||o.cellText!==!1)&&(E.w=E.v),E.v=dn[E.v];break}if(R=I=0,L=null,F&&T.s!==void 0&&(L=d.CellXf[T.s],L!=null&&(L.numFmtId!=null&&(R=L.numFmtId),o.cellStyles&&L.fillId!=null&&(I=L.fillId))),zP(E,R,I,o,u,d,Z),o.cellDates&&F&&E.t=="n"&&Ha(yt[R])&&(E.v=Ji(E.v+(Z?1462:0)),E.t=typeof E.v=="number"?"n":"d"),T.cm&&o.xlmeta){var G=(o.xlmeta.Cell||[])[+T.cm-1];G&&G.type=="XLDAPR"&&(E.D=!0)}var X;o.nodim&&(X=sr(T.r),c.s.r>X.r&&(c.s.r=X.r),c.e.r<X.r&&(c.e.r=X.r)),J?(X=sr(T.r),s["!data"][X.r]||(s["!data"][X.r]=[]),s["!data"][X.r][X.c]=E):s[T.r]=E}}}}te.length>0&&(s["!rows"]=te)}})();function PW(e,t,r,n){var a=[],i=[],s=Kt(e["!ref"]),o="",c,u="",d=[],h=0,p=0,v=e["!rows"],x=e["!data"]!=null,w=x?e["!data"]:[],y={r:u},_,S=-1,k=(((n||{}).Workbook||{}).WBProps||{}).date1904;for(p=s.s.c;p<=s.e.c;++p)d[p]=Ft(p);for(h=s.s.r;h<=s.e.r;++h){i=[],u=Ut(h);var E=x?w[h]:[];for(p=s.s.c;p<=s.e.c;++p){c=d[p]+u;var T=x?E[p]:e[c];T!==void 0&&(o=OW(T,c,e,t,r,n,k))!=null&&i.push(o)}(i.length>0||v&&v[h])&&(y={r:u},v&&v[h]&&(_=v[h],_.hidden&&(y.hidden=1),S=-1,_.hpx?S=Ku(_.hpx):_.hpt&&(S=_.hpt),S>-1&&(y.ht=S,y.customHeight=1),_.level&&(y.outlineLevel=_.level)),a[a.length]=Ge("row",i.join(""),y))}if(v)for(;h<v.length;++h)v&&v[h]&&(y={r:h+1},_=v[h],_.hidden&&(y.hidden=1),S=-1,_.hpx?S=Ku(_.hpx):_.hpt&&(S=_.hpt),S>-1&&(y.ht=S,y.customHeight=1),_.level&&(y.outlineLevel=_.level),a[a.length]=Ge("row","",y));return a.join("")}function IW(e,t,r,n){var a=[$r,Ge("worksheet",null,{xmlns:qo[0],"xmlns:r":Zr.r})],i=r.SheetNames[e],s=0,o="",c=r.Sheets[i];c==null&&(c={});var u=c["!ref"]||"A1",d=Kt(u);if(d.e.c>16383||d.e.r>1048575){if(t.WTF)throw new Error("Range "+u+" exceeds format limit A1:XFD1048576");d.e.c=Math.min(d.e.c,16383),d.e.r=Math.min(d.e.c,1048575),u=Nt(d)}n||(n={}),c["!comments"]=[];var h=[];mW(c,r,e,t,a),a[a.length]=Ge("dimension",null,{ref:u}),a[a.length]=CW(c,t,e,r),t.sheetFormat&&(a[a.length]=Ge("sheetFormatPr",null,{defaultRowHeight:t.sheetFormat.defaultRowHeight||"16",baseColWidth:t.sheetFormat.baseColWidth||"10",outlineLevelRow:t.sheetFormat.outlineLevelRow||"7"})),c["!cols"]!=null&&c["!cols"].length>0&&(a[a.length]=SW(c,c["!cols"])),a[s=a.length]="<sheetData/>",c["!links"]=[],c["!ref"]!=null&&(o=PW(c,t,e,r),o.length>0&&(a[a.length]=o)),a.length>s+1&&(a[a.length]="</sheetData>",a[s]=a[s].replace("/>",">")),c["!protect"]&&(a[a.length]=xW(c["!protect"])),c["!autofilter"]!=null&&(a[a.length]=EW(c["!autofilter"],c,r,e)),c["!merges"]!=null&&c["!merges"].length>0&&(a[a.length]=hW(c["!merges"]));var p=-1,v,x=-1;return c["!links"].length>0&&(a[a.length]="<hyperlinks>",c["!links"].forEach(function(w){w[1].Target&&(v={ref:w[0]},w[1].Target.charAt(0)!="#"&&(x=er(n,-1,Pt(w[1].Target).replace(/#[\s\S]*$/,""),jt.HLINK),v["r:id"]="rId"+x),(p=w[1].Target.indexOf("#"))>-1&&(v.location=Pt(w[1].Target.slice(p+1))),w[1].Tooltip&&(v.tooltip=Pt(w[1].Tooltip)),v.display=w[1].display,a[a.length]=Ge("hyperlink",null,v))}),a[a.length]="</hyperlinks>"),delete c["!links"],c["!margins"]!=null&&(a[a.length]=bW(c["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&(a[a.length]=wn("ignoredErrors",Ge("ignoredError",null,{numberStoredAsText:1,sqref:u}))),h.length>0&&(x=er(n,-1,"../drawings/drawing"+(e+1)+".xml",jt.DRAW),a[a.length]=Ge("drawing",null,{"r:id":"rId"+x}),c["!drawing"]=h),c["!comments"].length>0&&(x=er(n,-1,"../drawings/vmlDrawing"+(e+1)+".vml",jt.VML),a[a.length]=Ge("legacyDrawing",null,{"r:id":"rId"+x}),c["!legacy"]=x),a.length>1&&(a[a.length]="</worksheet>",a[1]=a[1].replace("/>",">")),a.join("")}function FW(e,t){var r={},n=e.l+t;r.r=e.read_shift(4),e.l+=4;var a=e.read_shift(2);e.l+=1;var i=e.read_shift(1);return e.l=n,i&7&&(r.level=i&7),i&16&&(r.hidden=!0),i&32&&(r.hpt=a/20),r}function DW(e,t,r){var n=be(145),a=(r["!rows"]||[])[e]||{};n.write_shift(4,e),n.write_shift(4,0);var i=320;a.hpx?i=Ku(a.hpx)*20:a.hpt&&(i=a.hpt*20),n.write_shift(2,i),n.write_shift(1,0);var s=0;a.level&&(s|=a.level),a.hidden&&(s|=16),(a.hpx||a.hpt)&&(s|=32),n.write_shift(1,s),n.write_shift(1,0);var o=0,c=n.l;n.l+=4;for(var u={r:e,c:0},d=r["!data"]!=null,h=0;h<16;++h)if(!(t.s.c>h+1<<10||t.e.c<h<<10)){for(var p=-1,v=-1,x=h<<10;x<h+1<<10;++x){u.c=x;var w=d?(r["!data"][u.r]||[])[u.c]:r[Rt(u)];w&&(p<0&&(p=x),v=x)}p<0||(++o,n.write_shift(4,p),n.write_shift(4,v))}var y=n.l;return n.l=c,n.write_shift(4,o),n.l=y,n.length>n.l?n.slice(0,n.l):n}function jW(e,t,r,n){var a=DW(n,r,t);(a.length>17||(t["!rows"]||[])[n])&&je(e,0,a)}var RW=Ko,MW=pc;function LW(){}function BW(e,t){var r={},n=e[e.l];return++e.l,r.above=!(n&64),r.left=!(n&128),e.l+=18,r.name=OL(e),r}function $W(e,t,r){r==null&&(r=be(84+4*e.length));var n=192;t&&(t.above&&(n&=-65),t.left&&(n&=-129)),r.write_shift(1,n);for(var a=1;a<3;++a)r.write_shift(1,0);return ih({auto:1},r),r.write_shift(-4,-1),r.write_shift(-4,-1),H6(e,r),r.slice(0,r.l)}function UW(e){var t=Xa(e);return[t]}function zW(e,t,r){return r==null&&(r=be(8)),Vo(t,r)}function WW(e){var t=Xo(e);return[t]}function HW(e,t,r){return r==null&&(r=be(4)),Go(t,r)}function qW(e){var t=Xa(e),r=e.read_shift(1);return[t,r,"b"]}function VW(e,t,r){return r==null&&(r=be(9)),Vo(t,r),r.write_shift(1,e.v?1:0),r}function XW(e){var t=Xo(e),r=e.read_shift(1);return[t,r,"b"]}function GW(e,t,r){return r==null&&(r=be(5)),Go(t,r),r.write_shift(1,e.v?1:0),r}function KW(e){var t=Xa(e),r=e.read_shift(1);return[t,r,"e"]}function X1(e,t,r){return r==null&&(r=be(9)),Vo(t,r),r.write_shift(1,e.v),r}function YW(e){var t=Xo(e),r=e.read_shift(1);return[t,r,"e"]}function G1(e,t,r){return r==null&&(r=be(8)),Go(t,r),r.write_shift(1,e.v),r.write_shift(2,0),r.write_shift(1,0),r}function ZW(e){var t=Xa(e),r=e.read_shift(4);return[t,r,"s"]}function QW(e,t,r){return r==null&&(r=be(12)),Vo(t,r),r.write_shift(4,t.v),r}function JW(e){var t=Xo(e),r=e.read_shift(4);return[t,r,"s"]}function eH(e,t,r){return r==null&&(r=be(8)),Go(t,r),r.write_shift(4,t.v),r}function tH(e){var t=Xa(e),r=In(e);return[t,r,"n"]}function rH(e,t,r){return r==null&&(r=be(16)),Vo(t,r),Uo(e.v,r),r}function HP(e){var t=Xo(e),r=In(e);return[t,r,"n"]}function nH(e,t,r){return r==null&&(r=be(12)),Go(t,r),Uo(e.v,r),r}function aH(e){var t=Xa(e),r=np(e);return[t,r,"n"]}function iH(e,t,r){return r==null&&(r=be(12)),Vo(t,r),q6(e.v,r),r}function sH(e){var t=Xo(e),r=np(e);return[t,r,"n"]}function oH(e,t,r){return r==null&&(r=be(8)),Go(t,r),q6(e.v,r),r}function lH(e){var t=Xa(e),r=vb(e);return[t,r,"is"]}function cH(e){var t=Xa(e),r=jn(e);return[t,r,"str"]}function uH(e,t,r){var n=e.v==null?"":String(e.v);return r==null&&(r=be(12+4*e.v.length)),Vo(t,r),Jr(n,r),r.length>r.l?r.slice(0,r.l):r}function fH(e){var t=Xo(e),r=jn(e);return[t,r,"str"]}function dH(e,t,r){var n=e.v==null?"":String(e.v);return r==null&&(r=be(8+4*n.length)),Go(t,r),Jr(n,r),r.length>r.l?r.slice(0,r.l):r}function hH(e,t,r){var n=e.l+t,a=Xa(e);a.r=r["!row"];var i=e.read_shift(1),s=[a,i,"b"];if(r.cellFormula){e.l+=2;var o=lp(e,n-e.l,r);s[3]=Nn(o,null,a,r.supbooks,r)}else e.l=n;return s}function pH(e,t,r){var n=e.l+t,a=Xa(e);a.r=r["!row"];var i=e.read_shift(1),s=[a,i,"e"];if(r.cellFormula){e.l+=2;var o=lp(e,n-e.l,r);s[3]=Nn(o,null,a,r.supbooks,r)}else e.l=n;return s}function mH(e,t,r){var n=e.l+t,a=Xa(e);a.r=r["!row"];var i=In(e),s=[a,i,"n"];if(r.cellFormula){e.l+=2;var o=lp(e,n-e.l,r);s[3]=Nn(o,null,a,r.supbooks,r)}else e.l=n;return s}function vH(e,t,r){var n=e.l+t,a=Xa(e);a.r=r["!row"];var i=jn(e),s=[a,i,"str"];if(r.cellFormula){e.l+=2;var o=lp(e,n-e.l,r);s[3]=Nn(o,null,a,r.supbooks,r)}else e.l=n;return s}var gH=Ko,xH=pc;function yH(e,t){return t==null&&(t=be(4)),t.write_shift(4,e),t}function wH(e,t){var r=e.l+t,n=Ko(e),a=rp(e),i=jn(e),s=jn(e),o=jn(e);e.l=r;var c={rfx:n,relId:a,loc:i,display:o};return s&&(c.Tooltip=s),c}function bH(e,t){var r=be(50+4*(e[1].Target.length+(e[1].Tooltip||"").length));pc({s:sr(e[0]),e:sr(e[0])},r),gb("rId"+t,r);var n=e[1].Target.indexOf("#"),a=n==-1?"":e[1].Target.slice(n+1);return Jr(a||"",r),Jr(e[1].Tooltip||"",r),Jr("",r),r.slice(0,r.l)}function _H(){}function SH(e,t,r){var n=e.l+t,a=V6(e),i=e.read_shift(1),s=[a];if(s[2]=i,r.cellFormula){var o=Uz(e,n-e.l,r);s[1]=o}else e.l=n;return s}function kH(e,t,r){var n=e.l+t,a=Ko(e),i=[a];if(r.cellFormula){var s=Wz(e,n-e.l,r);i[1]=s,e.l=n}else e.l=n;return i}function EH(e,t,r){r==null&&(r=be(18));var n=cp(e,t);r.write_shift(-4,e),r.write_shift(-4,e),r.write_shift(4,(n.width||10)*256),r.write_shift(4,0);var a=0;return t.hidden&&(a|=1),typeof n.width=="number"&&(a|=2),t.level&&(a|=t.level<<8),r.write_shift(2,a),r}var qP=["left","right","top","bottom","header","footer"];function TH(e){var t={};return qP.forEach(function(r){t[r]=In(e)}),t}function AH(e,t){return t==null&&(t=be(48)),Do(e),qP.forEach(function(r){Uo(e[r],t)}),t}function CH(e){var t=e.read_shift(2);return e.l+=28,{RTL:t&32}}function OH(e,t,r){r==null&&(r=be(30));var n=924;return(((t||{}).Views||[])[0]||{}).RTL&&(n|=32),r.write_shift(2,n),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(2,0),r.write_shift(2,100),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(4,0),r}function NH(e){var t=be(24);return t.write_shift(4,4),t.write_shift(4,1),pc(e,t),t}function PH(e,t){return t==null&&(t=be(66)),t.write_shift(2,e.password?kb(e.password):0),t.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(r){r[1]?t.write_shift(4,e[r[0]]!=null&&!e[r[0]]?1:0):t.write_shift(4,e[r[0]]!=null&&e[r[0]]?0:1)}),t}function IH(){}function FH(){}function DH(e,t,r,n,a,i,s){if(!e)return e;var o=t||{};n||(n={"!id":{}});var c={};o.dense&&(c["!data"]=[]);var u,d={s:{r:2e6,c:2e6},e:{r:0,c:0}},h=!1,p=!1,v,x,w,y,_,S,k,E,T,N=[];o.biff=12,o["!row"]=0;var C=0,P=!1,j=[],R={},I=o.supbooks||a.supbooks||[[]];if(I.sharedf=R,I.arrayf=j,I.SheetNames=a.SheetNames||a.Sheets.map(function(oe){return oe.name}),!o.supbooks&&(o.supbooks=I,a.Names))for(var F=0;F<a.Names.length;++F)I[0][F+1]=a.Names[F];var L=[],H=[],V=!1;Yu[16]={n:"BrtShortReal",f:HP};var J,te=1462*+!!((a||{}).WBProps||{}).date1904;if(fs(e,function(Q,Z,ee){if(!p)switch(ee){case 148:u=Q;break;case 0:v=Q,o.sheetRows&&o.sheetRows<=v.r&&(p=!0),E=Ut(y=v.r),o["!row"]=v.r,(Q.hidden||Q.hpt||Q.level!=null)&&(Q.hpt&&(Q.hpx=Hl(Q.hpt)),H[Q.r]=Q);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(x={t:Q[2]},Q[2]){case"n":x.v=Q[1];break;case"s":k=Tu[Q[1]],x.v=k.t,x.r=k.r;break;case"b":x.v=!!Q[1];break;case"e":x.v=Q[1],o.cellText!==!1&&(x.w=tn[x.v]);break;case"str":x.t="s",x.v=Q[1];break;case"is":x.t="s",x.v=Q[1].t;break}if((w=s.CellXf[Q[0].iStyleRef])&&zP(x,w.numFmtId,null,o,i,s,te>0),_=Q[0].c==-1?_+1:Q[0].c,o.dense?(c["!data"][y]||(c["!data"][y]=[]),c["!data"][y][_]=x):c[Ft(_)+E]=x,o.cellFormula){for(P=!1,C=0;C<j.length;++C){var ce=j[C];v.r>=ce[0].s.r&&v.r<=ce[0].e.r&&_>=ce[0].s.c&&_<=ce[0].e.c&&(x.F=Nt(ce[0]),P=!0)}!P&&Q.length>3&&(x.f=Q[3])}if(d.s.r>v.r&&(d.s.r=v.r),d.s.c>_&&(d.s.c=_),d.e.r<v.r&&(d.e.r=v.r),d.e.c<_&&(d.e.c=_),o.cellDates&&w&&x.t=="n"&&Ha(yt[w.numFmtId])){var de=Xi(x.v+te);de&&(x.t="d",x.v=new Date(Date.UTC(de.y,de.m-1,de.d,de.H,de.M,de.S,de.u)))}J&&(J.type=="XLDAPR"&&(x.D=!0),J=void 0);break;case 1:case 12:if(!o.sheetStubs||h)break;x={t:"z",v:void 0},_=Q[0].c==-1?_+1:Q[0].c,o.dense?(c["!data"][y]||(c["!data"][y]=[]),c["!data"][y][_]=x):c[Ft(_)+E]=x,d.s.r>v.r&&(d.s.r=v.r),d.s.c>_&&(d.s.c=_),d.e.r<v.r&&(d.e.r=v.r),d.e.c<_&&(d.e.c=_),J&&(J.type=="XLDAPR"&&(x.D=!0),J=void 0);break;case 176:N.push(Q);break;case 49:J=((o.xlmeta||{}).Cell||[])[Q-1];break;case 494:var Te=n["!id"][Q.relId];for(Te?(Q.Target=Te.Target,Q.loc&&(Q.Target+="#"+Q.loc),Q.Rel=Te):Q.relId==""&&(Q.Target="#"+Q.loc),y=Q.rfx.s.r;y<=Q.rfx.e.r;++y)for(_=Q.rfx.s.c;_<=Q.rfx.e.c;++_)o.dense?(c["!data"][y]||(c["!data"][y]=[]),c["!data"][y][_]||(c["!data"][y][_]={t:"z",v:void 0}),c["!data"][y][_].l=Q):(S=Ft(_)+Ut(y),c[S]||(c[S]={t:"z",v:void 0}),c[S].l=Q);break;case 426:if(!o.cellFormula)break;j.push(Q),T=o.dense?c["!data"][y][_]:c[Ft(_)+E],T.f=Nn(Q[1],d,{r:v.r,c:_},I,o),T.F=Nt(Q[0]);break;case 427:if(!o.cellFormula)break;R[Rt(Q[0].s)]=Q[1],T=o.dense?c["!data"][y][_]:c[Ft(_)+E],T.f=Nn(Q[1],d,{r:v.r,c:_},I,o);break;case 60:if(!o.cellStyles)break;for(;Q.e>=Q.s;)L[Q.e--]={width:Q.w/256,hidden:!!(Q.flags&1),level:Q.level},V||(V=!0,Eb(Q.w/256)),qs(L[Q.e+1]);break;case 551:Q&&(c["!legrel"]=Q);break;case 161:c["!autofilter"]={ref:Nt(Q)};break;case 476:c["!margins"]=Q;break;case 147:a.Sheets[r]||(a.Sheets[r]={}),Q.name&&(a.Sheets[r].CodeName=Q.name),(Q.above||Q.left)&&(c["!outline"]={above:Q.above,left:Q.left});break;case 137:a.Views||(a.Views=[{}]),a.Views[0]||(a.Views[0]={}),Q.RTL&&(a.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:h=!0;break;case 36:h=!1;break;case 37:h=!0;break;case 38:h=!1;break;default:if(!Z.T){if(!h||o.WTF)throw new Error("Unexpected record 0x"+ee.toString(16))}}},o),delete o.supbooks,delete o["!row"],!c["!ref"]&&(d.s.r<2e6||u&&(u.e.r>0||u.e.c>0||u.s.r>0||u.s.c>0))&&(c["!ref"]=Nt(u||d)),o.sheetRows&&c["!ref"]){var q=Kt(c["!ref"]);o.sheetRows<=+q.e.r&&(q.e.r=o.sheetRows-1,q.e.r>d.e.r&&(q.e.r=d.e.r),q.e.r<q.s.r&&(q.s.r=q.e.r),q.e.c>d.e.c&&(q.e.c=d.e.c),q.e.c<q.s.c&&(q.s.c=q.e.c),c["!fullref"]=c["!ref"],c["!ref"]=Nt(q))}return N.length>0&&(c["!merges"]=N),L.length>0&&(c["!cols"]=L),H.length>0&&(c["!rows"]=H),n["!id"][c["!legrel"]]&&(c["!legdrawel"]=n["!id"][c["!legrel"]]),c}function jH(e,t,r,n,a,i,s,o){var c={r,c:n};if(t.c&&i["!comments"].push([Rt(c),t.c]),t.v===void 0)return!1;var u="";switch(t.t){case"b":u=t.v?"1":"0";break;case"d":t=dr(t),t.z=t.z||yt[14],t.v=Or(Tr(t.v,o),o),t.t="n";break;case"n":case"e":u=""+t.v;break;default:u=t.v;break}switch(c.s=Zs(a.cellXfs,t,a),t.l&&i["!links"].push([Rt(c),t.l]),t.t){case"s":case"str":return a.bookSST?(u=Cb(a.Strings,t.v==null?"":String(t.v),a.revStrings),c.t="s",c.v=u,s?je(e,18,eH(t,c)):je(e,7,QW(t,c))):(c.t="str",s?je(e,17,dH(t,c)):je(e,6,uH(t,c))),!0;case"n":return t.v==(t.v|0)&&t.v>-1e3&&t.v<1e3?s?je(e,13,oH(t,c)):je(e,2,iH(t,c)):isFinite(t.v)?s?je(e,16,nH(t,c)):je(e,5,rH(t,c)):(c.t="e",isNaN(t.v)?s?je(e,14,G1({v:36},c)):je(e,3,X1({v:36},c)):s?je(e,14,G1({v:7},c)):je(e,3,X1({v:7},c))),!0;case"b":return c.t="b",s?je(e,15,GW(t,c)):je(e,4,VW(t,c)),!0;case"e":return c.t="e",s?je(e,14,G1(t,c)):je(e,3,X1(t,c)),!0}return s?je(e,12,HW(t,c)):je(e,1,zW(t,c)),!0}function RH(e,t,r,n,a){var i=Kt(t["!ref"]||"A1"),s="",o=[],c=(((a||{}).Workbook||{}).WBProps||{}).date1904;je(e,145);var u=t["!data"]!=null,d=u?t["!data"][i.s.r]:[],h=i.e.r;t["!rows"]&&(h=Math.max(i.e.r,t["!rows"].length-1));for(var p=i.s.r;p<=h;++p)if(s=Ut(p),u&&(d=t["!data"][p]),jW(e,t,i,p),!(u&&!d)){var v=!1;if(p<=i.e.r)for(var x=i.s.c;x<=i.e.c;++x){p===i.s.r&&(o[x]=Ft(x));var w=u?d[x]:t[o[x]+s];if(!w){v=!1;continue}v=jH(e,w,p,x,n,t,v,c)}}je(e,146)}function MH(e,t){!t||!t["!merges"]||(je(e,177,yH(t["!merges"].length)),t["!merges"].forEach(function(r){je(e,176,xH(r))}),je(e,178))}function LH(e,t){!t||!t["!cols"]||(je(e,390),t["!cols"].forEach(function(r,n){r&&je(e,60,EH(n,r))}),je(e,391))}function BH(e,t){!t||!t["!ref"]||(je(e,648),je(e,649,NH(Kt(t["!ref"]))),je(e,650))}function $H(e,t,r){t["!links"].forEach(function(n){if(n[1].Target){var a=er(r,-1,n[1].Target.replace(/#[\s\S]*$/,""),jt.HLINK);je(e,494,bH(n,a))}}),delete t["!links"]}function UH(e,t,r,n){if(t["!comments"].length>0){var a=er(n,-1,"../drawings/vmlDrawing"+(r+1)+".vml",jt.VML);je(e,551,gb("rId"+a)),t["!legacy"]=a}}function zH(e,t,r,n){if(t["!autofilter"]){var a=t["!autofilter"],i=typeof a.ref=="string"?a.ref:Nt(a.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var s=r.Workbook.Names,o=hn(i);o.s.r==o.e.r&&(o.e.r=hn(t["!ref"]).e.r,i=Nt(o));for(var c=0;c<s.length;++c){var u=s[c];if(u.Name=="_xlnm._FilterDatabase"&&u.Sheet==n){u.Ref=Wu(r.SheetNames[n])+"!"+zu(i);break}}c==s.length&&s.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:Wu(r.SheetNames[n])+"!"+zu(i)}),je(e,161,pc(Kt(i))),je(e,162)}}function WH(e,t,r){je(e,133),je(e,137,OH(t,r)),je(e,138),je(e,134)}function HH(e,t){t["!protect"]&&je(e,535,PH(t["!protect"]))}function qH(e,t,r,n){var a=Dn(),i=r.SheetNames[e],s=r.Sheets[i]||{},o=i;try{r&&r.Workbook&&(o=r.Workbook.Sheets[e].CodeName||o)}catch{}var c=Kt(s["!ref"]||"A1");if(c.e.c>16383||c.e.r>1048575){if(t.WTF)throw new Error("Range "+(s["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");c.e.c=Math.min(c.e.c,16383),c.e.r=Math.min(c.e.c,1048575)}return s["!links"]=[],s["!comments"]=[],je(a,129),(r.vbaraw||s["!outline"])&&je(a,147,$W(o,s["!outline"])),je(a,148,MW(c)),WH(a,s,r.Workbook),LH(a,s),RH(a,s,e,t,r),HH(a,s),zH(a,s,r,e),MH(a,s),$H(a,s,n),s["!margins"]&&je(a,476,AH(s["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&BH(a,s),UH(a,s,e,n),je(a,130),a.end()}function VH(e){var t=[],r=e.match(/^<c:numCache>/),n;(e.match(/<c:pt idx="(\d*)"[^<>\/]*><c:v>([^<])<\/c:v><\/c:pt>/mg)||[]).forEach(function(i){var s=i.match(/<c:pt idx="(\d*)"[^<>\/]*><c:v>([^<]*)<\/c:v><\/c:pt>/);s&&(t[+s[1]]=r?+s[2]:s[2])});var a=zt((Oo(e,"c:formatCode")||["","General"])[1]);return(ob(e,"<c:f>","</c:f>")||[]).forEach(function(i){n=i.replace(/<[^<>]*>/g,"")}),[t,a,n]}function XH(e,t,r,n,a,i){var s=i||{"!type":"chart"};if(!e)return i;var o=0,c=0,u="A",d={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(ob(e,"<c:numCache>","</c:numCache>")||[]).forEach(function(h){var p=VH(h);d.s.r=d.s.c=0,d.e.c=o,u=Ft(o),p[0].forEach(function(v,x){s["!data"]?(s["!data"][x]||(s["!data"][x]=[]),s["!data"][x][o]={t:"n",v,z:p[1]}):s[u+Ut(x)]={t:"n",v,z:p[1]},c=x}),d.e.r<c&&(d.e.r=c),++o}),o>0&&(s["!ref"]=Nt(d)),s}function GH(e,t,r,n,a){if(!e)return e;n||(n={"!id":{}});var i={"!type":"chart","!drawel":null,"!rel":""},s,o=e.match(WP);return o&&Ob(o[0],i,a,r),(s=e.match(/drawing r:id="(.*?)"/))&&(i["!rel"]=s[1]),n["!id"][i["!rel"]]&&(i["!drawel"]=n["!id"][i["!rel"]]),i}function KH(e,t){e.l+=10;var r=jn(e);return{name:r}}function YH(e,t,r,n,a){if(!e)return e;n||(n={"!id":{}});var i={"!type":"chart","!drawel":null,"!rel":""},s=!1;return fs(e,function(c,u,d){switch(d){case 550:i["!rel"]=c;break;case 651:a.Sheets[r]||(a.Sheets[r]={}),c.name&&(a.Sheets[r].CodeName=c.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:s=!0;break;case 36:s=!1;break;case 37:break;case 38:break;default:if(!(u.T>0)){if(!(u.T<0)){if(!s||t.WTF)throw new Error("Unexpected record 0x"+d.toString(16))}}}},t),n["!id"][i["!rel"]]&&(i["!drawel"]=n["!id"][i["!rel"]]),i}var Nb=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],ZH=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],QH=[],JH=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function $4(e,t){for(var r=0;r!=e.length;++r)for(var n=e[r],a=0;a!=t.length;++a){var i=t[a];if(n[i[0]]==null)n[i[0]]=i[1];else switch(i[2]){case"bool":typeof n[i[0]]=="string"&&(n[i[0]]=tr(n[i[0]]));break;case"int":typeof n[i[0]]=="string"&&(n[i[0]]=parseInt(n[i[0]],10));break}}}function U4(e,t){for(var r=0;r!=t.length;++r){var n=t[r];if(e[n[0]]==null)e[n[0]]=n[1];else switch(n[2]){case"bool":typeof e[n[0]]=="string"&&(e[n[0]]=tr(e[n[0]]));break;case"int":typeof e[n[0]]=="string"&&(e[n[0]]=parseInt(e[n[0]],10));break}}}function VP(e){U4(e.WBProps,Nb),U4(e.CalcPr,JH),$4(e.WBView,ZH),$4(e.Sheets,QH),Rl.date1904=tr(e.WBProps.date1904)}function eq(e){return!e.Workbook||!e.Workbook.WBProps?"false":tr(e.Workbook.WBProps.date1904)?"true":"false"}var tq=":][*?/\\".split("");function XP(e,t){try{if(e=="")throw new Error("Sheet name cannot be blank");if(e.length>31)throw new Error("Sheet name cannot exceed 31 chars");if(e.charCodeAt(0)==39||e.charCodeAt(e.length-1)==39)throw new Error("Sheet name cannot start or end with apostrophe (')");if(e.toLowerCase()=="history")throw new Error("Sheet name cannot be 'History'");tq.forEach(function(r){if(e.indexOf(r)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")})}catch(r){throw r}return!0}function rq(e,t,r){e.forEach(function(n,a){XP(n);for(var i=0;i<a;++i)if(n==e[i])throw new Error("Duplicate Sheet Name: "+n);if(r){var s=t&&t[a]&&t[a].CodeName||n;if(s.charCodeAt(0)==95&&s.length>22)throw new Error("Bad Code Name: Worksheet"+s)}})}function nq(e){if(!e||!e.SheetNames||!e.Sheets)throw new Error("Invalid Workbook");if(!e.SheetNames.length)throw new Error("Workbook is empty");var t=e.Workbook&&e.Workbook.Sheets||[];rq(e.SheetNames,t,!!e.vbaraw);for(var r=0;r<e.SheetNames.length;++r)aW(e.Sheets[e.SheetNames[r]],e.SheetNames[r],r);e.SheetNames.forEach(function(n,a){var i=e.Sheets[n];if(!(!i||!i["!autofilter"])){var s;e.Workbook||(e.Workbook={}),e.Workbook.Names||(e.Workbook.Names=[]),e.Workbook.Names.forEach(function(c){c.Name=="_xlnm._FilterDatabase"&&c.Sheet==a&&(s=c)});var o=Wu(n)+"!"+zu(i["!autofilter"].ref);s?s.Ref=o:e.Workbook.Names.push({Name:"_xlnm._FilterDatabase",Sheet:a,Ref:o})}})}var aq=/<\w+:workbook/;function iq(e,t){if(!e)throw new Error("Could not find file");var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},n=!1,a="xmlns",i={},s=0;if(e.replace(bn,function(c,u){var d=lt(c);switch(Va(d[0])){case"<?xml":break;case"<workbook":c.match(aq)&&(a="xmlns"+c.match(/<(\w+):/)[1]),r.xmlns=d[a];break;case"</workbook>":break;case"<fileVersion":delete d[0],r.AppVersion=d;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":Nb.forEach(function(h){if(d[h[0]]!=null)switch(h[2]){case"bool":r.WBProps[h[0]]=tr(d[h[0]]);break;case"int":r.WBProps[h[0]]=parseInt(d[h[0]],10);break;default:r.WBProps[h[0]]=d[h[0]]}}),d.codeName&&(r.WBProps.CodeName=ir(d.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete d[0],r.WBView.push(d);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(d.state){case"hidden":d.Hidden=1;break;case"veryHidden":d.Hidden=2;break;default:d.Hidden=0}delete d.state,d.name=zt(ir(d.name)),delete d[0],r.Sheets.push(d);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":n=!0;break;case"</definedNames>":n=!1;break;case"<definedName":i={},i.Name=ir(d.name),d.comment&&(i.Comment=d.comment),d.localSheetId&&(i.Sheet=+d.localSheetId),tr(d.hidden||"0")&&(i.Hidden=!0),s=u+c.length;break;case"</definedName>":i.Ref=zt(ir(e.slice(s,u))),r.Names.push(i);break;case"<definedName/>":break;case"<calcPr":delete d[0],r.CalcPr=d;break;case"<calcPr/>":delete d[0],r.CalcPr=d;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":n=!0;break;case"</AlternateContent>":n=!1;break;case"<revisionPtr":break;default:if(!n&&t.WTF)throw new Error("unrecognized "+d[0]+" in workbook")}return c}),qo.indexOf(r.xmlns)===-1)throw new Error("Unknown Namespace: "+r.xmlns);return VP(r),r}function sq(e){var t=[$r];t[t.length]=Ge("workbook",null,{xmlns:qo[0],"xmlns:r":Zr.r});var r=e.Workbook&&(e.Workbook.Names||[]).length>0,n={codeName:"ThisWorkbook"};e.Workbook&&e.Workbook.WBProps&&(Nb.forEach(function(o){e.Workbook.WBProps[o[0]]!=null&&e.Workbook.WBProps[o[0]]!=o[1]&&(n[o[0]]=e.Workbook.WBProps[o[0]])}),e.Workbook.WBProps.CodeName&&(n.codeName=e.Workbook.WBProps.CodeName,delete n.CodeName)),t[t.length]=Ge("workbookPr",null,n);var a=e.Workbook&&e.Workbook.Sheets||[],i=0;if(a&&a[0]&&a[0].Hidden){for(t[t.length]="<bookViews>",i=0;i!=e.SheetNames.length&&!(!a[i]||!a[i].Hidden);++i);i==e.SheetNames.length&&(i=0),t[t.length]='<workbookView firstSheet="'+i+'" activeTab="'+i+'"/>',t[t.length]="</bookViews>"}for(t[t.length]="<sheets>",i=0;i!=e.SheetNames.length;++i){var s={name:Pt(e.SheetNames[i].slice(0,31))};if(s.sheetId=""+(i+1),s["r:id"]="rId"+(i+1),a[i])switch(a[i].Hidden){case 1:s.state="hidden";break;case 2:s.state="veryHidden";break}t[t.length]=Ge("sheet",null,s)}return t[t.length]="</sheets>",r&&(t[t.length]="<definedNames>",e.Workbook&&e.Workbook.Names&&e.Workbook.Names.forEach(function(o){var c={name:o.Name};o.Comment&&(c.comment=o.Comment),o.Sheet!=null&&(c.localSheetId=""+o.Sheet),o.Hidden&&(c.hidden="1"),o.Ref&&(t[t.length]=Ge("definedName",Pt(o.Ref),c))}),t[t.length]="</definedNames>"),t.length>2&&(t[t.length]="</workbook>",t[1]=t[1].replace("/>",">")),t.join("")}function oq(e,t){var r={};return r.Hidden=e.read_shift(4),r.iTabID=e.read_shift(4),r.strRelID=_2(e),r.name=jn(e),r}function lq(e,t){return t||(t=be(127)),t.write_shift(4,e.Hidden),t.write_shift(4,e.iTabID),gb(e.strRelID,t),Jr(e.name.slice(0,31),t),t.length>t.l?t.slice(0,t.l):t}function cq(e,t){var r={},n=e.read_shift(4);r.defaultThemeVersion=e.read_shift(4);var a=t>8?jn(e):"";return a.length>0&&(r.CodeName=a),r.autoCompressPictures=!!(n&65536),r.backupFile=!!(n&64),r.checkCompatibility=!!(n&4096),r.date1904=!!(n&1),r.filterPrivacy=!!(n&8),r.hidePivotFieldList=!!(n&1024),r.promptedSolutions=!!(n&16),r.publishItems=!!(n&2048),r.refreshAllConnections=!!(n&262144),r.saveExternalLinkValues=!!(n&128),r.showBorderUnselectedTables=!!(n&4),r.showInkAnnotation=!!(n&32),r.showObjects=["all","placeholders","none"][n>>13&3],r.showPivotChartFilter=!!(n&32768),r.updateLinks=["userSet","never","always"][n>>8&3],r}function uq(e,t){t||(t=be(72));var r=0;return e&&(e.date1904&&(r|=1),e.filterPrivacy&&(r|=8)),t.write_shift(4,r),t.write_shift(4,0),H6(e&&e.CodeName||"ThisWorkbook",t),t.slice(0,t.l)}function fq(e,t){var r={};return e.read_shift(4),r.ArchID=e.read_shift(4),e.l+=t-8,r}function dq(e,t,r){var n=e.l+t,a=e.read_shift(4);e.l+=1;var i=e.read_shift(4),s=NL(e),o,c="";try{o=zz(e,0,r);try{c=rp(e)}catch{}}catch{console.error("Could not parse defined name "+s)}a&32&&(s="_xlnm."+s),e.l=n;var u={Name:s,Ptg:o,Flags:a};return i<268435455&&(u.Sheet=i),c&&(u.Comment=c),u}function hq(e,t){var r=be(9),n=0,a=e.Name;yb.indexOf(a)>-1&&(n|=32,a=a.slice(6)),r.write_shift(4,n),r.write_shift(1,0),r.write_shift(4,e.Sheet==null?4294967295:e.Sheet);var i=[r,Jr(a),eW(e.Ref,t)];if(e.Comment)i.push(Hu(e.Comment));else{var s=be(4);s.write_shift(4,4294967295),i.push(s)}return Lr(i)}function pq(e,t){var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},n=[],a=!1;t||(t={}),t.biff=12;var i=[],s=[[]];return s.SheetNames=[],s.XTI=[],Yu[16]={n:"BrtFRTArchID$",f:fq},fs(e,function(c,u,d){switch(d){case 156:s.SheetNames.push(c.name),r.Sheets.push(c);break;case 153:r.WBProps=c;break;case 39:c.Sheet!=null&&(t.SID=c.Sheet),c.Ref=c.Ptg?Nn(c.Ptg,null,null,s,t):"#REF!",delete t.SID,delete c.Ptg,i.push(c);break;case 1036:break;case 357:case 358:case 355:case 667:s[0].length?s.push([d,c]):s[0]=[d,c],s[s.length-1].XTI=[];break;case 362:s.length===0&&(s[0]=[],s[0].XTI=[]),s[s.length-1].XTI=s[s.length-1].XTI.concat(c),s.XTI=s.XTI.concat(c);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:n.push(d),a=!0;break;case 36:n.pop(),a=!1;break;case 37:n.push(d),a=!0;break;case 38:n.pop(),a=!1;break;case 16:break;default:if(!u.T){if(!a||t.WTF&&n[n.length-1]!=37&&n[n.length-1]!=35)throw new Error("Unexpected record 0x"+d.toString(16))}}},t),VP(r),r.Names=i,r.supbooks=s,r}function mq(e,t){je(e,143);for(var r=0;r!=t.SheetNames.length;++r){var n=t.Workbook&&t.Workbook.Sheets&&t.Workbook.Sheets[r]&&t.Workbook.Sheets[r].Hidden||0,a={Hidden:n,iTabID:r+1,strRelID:"rId"+(r+1),name:t.SheetNames[r]};je(e,156,lq(a))}je(e,144)}function vq(e,t){t||(t=be(127));for(var r=0;r!=4;++r)t.write_shift(4,0);return Jr("SheetJS",t),Jr(Qd.version,t),Jr(Qd.version,t),Jr("7262",t),t.length>t.l?t.slice(0,t.l):t}function gq(e,t){t||(t=be(29)),t.write_shift(-4,0),t.write_shift(-4,460),t.write_shift(4,28800),t.write_shift(4,17600),t.write_shift(4,500),t.write_shift(4,e),t.write_shift(4,e);var r=120;return t.write_shift(1,r),t.length>t.l?t.slice(0,t.l):t}function xq(e,t){if(!(!t.Workbook||!t.Workbook.Sheets)){for(var r=t.Workbook.Sheets,n=0,a=-1,i=-1;n<r.length;++n)!r[n]||!r[n].Hidden&&a==-1?a=n:r[n].Hidden==1&&i==-1&&(i=n);i>a||(je(e,135),je(e,158,gq(a)),je(e,136))}}function yq(e,t){!t.Workbook||!t.Workbook.Names||t.Workbook.Names.forEach(function(r){try{if(r.Flags&14)return;je(e,39,hq(r,t))}catch{console.error("Could not serialize defined name "+JSON.stringify(r))}})}function wq(e){var t=e.SheetNames.length,r=be(12*t+28);r.write_shift(4,t+2),r.write_shift(4,0),r.write_shift(4,-2),r.write_shift(4,-2),r.write_shift(4,0),r.write_shift(4,-1),r.write_shift(4,-1);for(var n=0;n<t;++n)r.write_shift(4,0),r.write_shift(4,n),r.write_shift(4,n);return r}function bq(e,t){je(e,353),je(e,357),je(e,362,wq(t)),je(e,354)}function _q(e,t){var r=Dn();return je(r,131),je(r,128,vq()),je(r,153,uq(e.Workbook&&e.Workbook.WBProps||null)),xq(r,e),mq(r,e),bq(r,e),(e.Workbook||{}).Names&&yq(r,e),je(r,132),r.end()}function Sq(e,t,r){return t.slice(-4)===".bin"?pq(e,r):iq(e,r)}function kq(e,t,r,n,a,i,s,o){return t.slice(-4)===".bin"?DH(e,n,r,a,i,s,o):dW(e,n,r,a,i,s,o)}function Eq(e,t,r,n,a,i,s,o){return t.slice(-4)===".bin"?YH(e,n,r,a,i):GH(e,n,r,a,i)}function Tq(e,t,r,n,a,i,s,o){return t.slice(-4)===".bin"?xU():yU()}function Aq(e,t,r,n,a,i,s,o){return t.slice(-4)===".bin"?vU():gU()}function Cq(e,t,r,n){return t.slice(-4)===".bin"?g$(e,r,n):a$(e,r,n)}function Oq(e,t,r){return t.slice(-4)===".bin"?wB(e,r):vB(e,r)}function Nq(e,t,r){return t.slice(-4)===".bin"?uU(e,r):nU(e,r)}function Pq(e,t,r){return t.slice(-4)===".bin"?Q$(e):Y$(e)}function Iq(e,t,r,n){return r.slice(-4)===".bin"?J$(e,t,r,n):void 0}function Fq(e,t,r){return t.slice(-4)===".bin"?V$(e,t,r):G$(e,t,r)}var GP=/\b((?:\w+:)?[\w]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,KP=/\b((?:\w+:)?[\w]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function ti(e,t){var r=e.split(/\s+/),n=[];if(n[0]=r[0],r.length===1)return n;var a=e.match(GP),i,s,o,c;if(a)for(c=0;c!=a.length;++c)i=a[c].match(KP),(s=i[1].indexOf(":"))===-1?n[i[1]]=i[2].slice(1,i[2].length-1):(i[1].slice(0,6)==="xmlns:"?o="xmlns"+i[1].slice(6):o=i[1].slice(s+1),n[o]=i[2].slice(1,i[2].length-1));return n}function Dq(e){var t=e.split(/\s+/),r={};if(t.length===1)return r;var n=e.match(GP),a,i,s,o;if(n)for(o=0;o!=n.length;++o)a=n[o].match(KP),(i=a[1].indexOf(":"))===-1?r[a[1]]=a[2].slice(1,a[2].length-1):(a[1].slice(0,6)==="xmlns:"?s="xmlns"+a[1].slice(6):s=a[1].slice(i+1),r[s]=a[2].slice(1,a[2].length-1));return r}var Cu;function jq(e,t,r){var n=Cu[e]||zt(e);return n==="General"?Lo(t):ma(n,t,{date1904:!!r})}function Rq(e,t,r,n){var a=n;switch((r[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":a=tr(n);break;case"i2":case"int":a=parseInt(n,10);break;case"r4":case"float":a=parseFloat(n);break;case"date":case"dateTime.tz":a=Tr(n);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+r[0])}e[zt(t)]=a}function Mq(e,t,r,n){if(e.t!=="z"){if(!r||r.cellText!==!1)try{e.t==="e"?e.w=e.w||tn[e.v]:t==="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=Bu(e.v):e.w=Lo(e.v):e.w=jq(t||"General",e.v,n)}catch(s){if(r.WTF)throw s}try{var a=Cu[t]||t||"General";if(r.cellNF&&(e.z=a),r.cellDates&&e.t=="n"&&Ha(a)){var i=Xi(e.v+(n?1462:0));i&&(e.t="d",e.v=new Date(Date.UTC(i.y,i.m-1,i.d,i.H,i.M,i.S,i.u)))}}catch(s){if(r.WTF)throw s}}}function Lq(e,t,r){if(r.cellStyles&&t.Interior){var n=t.Interior;n.Pattern&&(n.patternType=YB[n.Pattern]||n.Pattern)}e[t.ID]=t}function Bq(e,t,r,n,a,i,s,o,c,u,d){var h="General",p=n.StyleID,v={};u=u||{};var x=[],w=0;for(p===void 0&&o&&(p=o.StyleID),p===void 0&&s&&(p=s.StyleID);i[p]!==void 0;){var y=i[p];if(y.nf&&(h=y.nf),y.Interior&&x.push(y.Interior),!y.Parent)break;p=y.Parent}switch(r.Type){case"Boolean":n.t="b",n.v=tr(e);break;case"String":n.t="s",n.r=t4(zt(e)),n.v=e.indexOf("<")>-1?zt(t||e).replace(/<[^<>]*>/g,""):n.r;break;case"DateTime":e.slice(-1)!="Z"&&(e+="Z"),n.v=Or(Tr(e,d),d),n.v!==n.v&&(n.v=zt(e)),(!h||h=="General")&&(h="yyyy-mm-dd");case"Number":n.v===void 0&&(n.v=+e),n.t||(n.t="n");break;case"Error":n.t="e",n.v=dn[e],u.cellText!==!1&&(n.w=e);break;default:e==""&&t==""?n.t="z":(n.t="s",n.v=t4(t||e));break}if(Mq(n,h,u,d),u.cellFormula!==!1)if(n.Formula){var _=zt(n.Formula);_.charCodeAt(0)==61&&(_=_.slice(1)),n.f=Fo(_,a),delete n.Formula,n.ArrayRange=="RC"?n.F=Fo("RC:RC",a):n.ArrayRange&&(n.F=Fo(n.ArrayRange,a),c.push([Kt(n.F),n.F]))}else for(w=0;w<c.length;++w)a.r>=c[w][0].s.r&&a.r<=c[w][0].e.r&&a.c>=c[w][0].s.c&&a.c<=c[w][0].e.c&&(n.F=c[w][1]);u.cellStyles&&(x.forEach(function(S){!v.patternType&&S.patternType&&(v.patternType=S.patternType)}),n.s=v),n.StyleID!==void 0&&(n.ixfe=n.StyleID)}function $q(e){return yb.indexOf("_xlnm."+e)>-1?"_xlnm."+e:e}function Uq(e){e.t=e.v||"",e.t=e.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),e.v=e.w=e.ixfe=void 0}function K1(e,t){var r=t||{};dc();var n=du(tp(e));(r.type=="binary"||r.type=="array"||r.type=="base64")&&(n=ir(n));var a=n.slice(0,1024).toLowerCase(),i=!1;if(a=a.replace(/".*?"/g,""),(a.indexOf(">")&1023)>Math.min(a.indexOf(",")&1023,a.indexOf(";")&1023)){var s=dr(r);return s.type="string",Wl.to_workbook(n,s)}if(a.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(Ze){a.indexOf("<"+Ze)>=0&&(i=!0)}),i)return AV(n,r);Cu={"General Number":"General","General Date":yt[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":yt[15],"Short Date":yt[14],"Long Time":yt[19],"Medium Time":yt[18],"Short Time":yt[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:yt[2],Standard:yt[4],Percent:yt[10],Scientific:yt[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var o,c=[],u,d={},h=[],p={},v="";r.dense&&(p["!data"]=[]);var x={},w={},y=ti('<Data ss:Type="String">'),_=0,S=0,k=0,E={s:{r:2e6,c:2e6},e:{r:0,c:0}},T={},N={},C="",P=0,j=[],R={},I={},F=0,L=[],H=[],V={},J=[],te,q=!1,oe=[],Q=[],Z={},ee=0,ce=0,de={Sheets:[],WBProps:{date1904:!1}},Te={};Hr.lastIndex=0,n=zf(n,"<!--","-->");for(var Ie="";o=Hr.exec(n);)switch(o[3]=(Ie=o[3]).toLowerCase()){case"data":if(Ie=="data"){if(o[1]==="/"){if((u=c.pop())[0]!==o[3])throw new Error("Bad state: "+u.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&c.push([o[3],!0]);break}if(c[c.length-1][1])break;o[1]==="/"?Bq(n.slice(_,o.index),C,y,c[c.length-1][0]=="comment"?V:x,{c:S,r:k},T,J[S],w,oe,r,de.WBProps.date1904):(C="",y=ti(o[0]),_=o.index+o[0].length);break;case"cell":if(o[1]==="/")if(H.length>0&&(x.c=H),(!r.sheetRows||r.sheetRows>k)&&x.v!==void 0&&(r.dense?(p["!data"][k]||(p["!data"][k]=[]),p["!data"][k][S]=x):p[Ft(S)+Ut(k)]=x),x.HRef&&(x.l={Target:zt(x.HRef)},x.HRefScreenTip&&(x.l.Tooltip=x.HRefScreenTip),delete x.HRef,delete x.HRefScreenTip),(x.MergeAcross||x.MergeDown)&&(ee=S+(parseInt(x.MergeAcross,10)|0),ce=k+(parseInt(x.MergeDown,10)|0),(ee>S||ce>k)&&j.push({s:{c:S,r:k},e:{c:ee,r:ce}})),!r.sheetStubs)x.MergeAcross?S=ee+1:++S;else if(x.MergeAcross||x.MergeDown){for(var Ne=S;Ne<=ee;++Ne)for(var W=k;W<=ce;++W)(Ne>S||W>k)&&(r.dense?(p["!data"][W]||(p["!data"][W]=[]),p["!data"][W][Ne]={t:"z"}):p[Ft(Ne)+Ut(W)]={t:"z"});S=ee+1}else++S;else x=Dq(o[0]),x.Index&&(S=+x.Index-1),S<E.s.c&&(E.s.c=S),S>E.e.c&&(E.e.c=S),o[0].slice(-2)==="/>"&&++S,H=[];break;case"row":o[1]==="/"||o[0].slice(-2)==="/>"?(k<E.s.r&&(E.s.r=k),k>E.e.r&&(E.e.r=k),o[0].slice(-2)==="/>"&&(w=ti(o[0]),w.Index&&(k=+w.Index-1)),S=0,++k):(w=ti(o[0]),w.Index&&(k=+w.Index-1),Z={},(w.AutoFitHeight=="0"||w.Height)&&(Z.hpx=parseInt(w.Height,10),Z.hpt=Ku(Z.hpx),Q[k]=Z),w.Hidden=="1"&&(Z.hidden=!0,Q[k]=Z));break;case"worksheet":if(o[1]==="/"){if((u=c.pop())[0]!==o[3])throw new Error("Bad state: "+u.join("|"));h.push(v),E.s.r<=E.e.r&&E.s.c<=E.e.c&&(p["!ref"]=Nt(E),r.sheetRows&&r.sheetRows<=E.e.r&&(p["!fullref"]=p["!ref"],E.e.r=r.sheetRows-1,p["!ref"]=Nt(E))),j.length&&(p["!merges"]=j),J.length>0&&(p["!cols"]=J),Q.length>0&&(p["!rows"]=Q),d[v]=p}else E={s:{r:2e6,c:2e6},e:{r:0,c:0}},k=S=0,c.push([o[3],!1]),u=ti(o[0]),v=zt(u.Name),p={},r.dense&&(p["!data"]=[]),j=[],oe=[],Q=[],Te={name:v,Hidden:0},de.Sheets.push(Te);break;case"table":if(o[1]==="/"){if((u=c.pop())[0]!==o[3])throw new Error("Bad state: "+u.join("|"))}else{if(o[0].slice(-2)=="/>")break;c.push([o[3],!1]),J=[],q=!1}break;case"style":o[1]==="/"?Lq(T,N,r):N=ti(o[0]);break;case"numberformat":N.nf=zt(ti(o[0]).Format||"General"),Cu[N.nf]&&(N.nf=Cu[N.nf]);for(var z=0;z!=392&&yt[z]!=N.nf;++z);if(z==392){for(z=57;z!=392;++z)if(yt[z]==null){zs(N.nf,z);break}}break;case"column":if(c[c.length-1][0]!=="table"||o[1]==="/")break;if(te=ti(o[0]),te.Hidden&&(te.hidden=!0,delete te.Hidden),te.Width&&(te.wpx=parseInt(te.Width,10)),!q&&te.wpx>10){q=!0,Pn=TP;for(var G=0;G<J.length;++G)J[G]&&qs(J[G])}q&&qs(te),J[te.Index-1||J.length]=te;for(var X=0;X<+te.Span;++X)J[J.length]=dr(te);break;case"namedrange":if(o[1]==="/")break;de.Names||(de.Names=[]);var ie=lt(o[0]),M={Name:$q(ie.Name),Ref:Fo(ie.RefersTo.slice(1),{r:0,c:0})};de.Sheets.length>0&&(M.Sheet=de.Sheets.length-1),de.Names.push(M);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(o[0].slice(-2)==="/>")break;o[1]==="/"?C+=n.slice(P,o.index):P=o.index+o[0].length;break;case"interior":if(!r.cellStyles)break;N.Interior=ti(o[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(o[0].slice(-2)==="/>")break;o[1]==="/"?e7(R,Ie,n.slice(F,o.index)):F=o.index+o[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(o[1]==="/"){if((u=c.pop())[0]!==o[3])throw new Error("Bad state: "+u.join("|"))}else c.push([o[3],!1]);break;case"comment":if(o[1]==="/"){if((u=c.pop())[0]!==o[3])throw new Error("Bad state: "+u.join("|"));Uq(V),H.push(V)}else c.push([o[3],!1]),u=ti(o[0]),tr(u.ShowAlways||"0")||(H.hidden=!0),V={a:u.Author};break;case"autofilter":if(o[1]==="/"){if((u=c.pop())[0]!==o[3])throw new Error("Bad state: "+u.join("|"))}else if(o[0].charAt(o[0].length-2)!=="/"){var le=ti(o[0]);p["!autofilter"]={ref:Fo(le.Range).replace(/\$/g,"")},c.push([o[3],!0])}break;case"name":break;case"datavalidation":if(o[1]==="/"){if((u=c.pop())[0]!==o[3])throw new Error("Bad state: "+u.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&c.push([o[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(o[1]==="/"){if((u=c.pop())[0]!==o[3])throw new Error("Bad state: "+u.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&c.push([o[3],!0]);break;case"null":break;default:if(c.length==0&&o[3]=="document"||c.length==0&&o[3]=="uof")return q4(n,r);var ye=!0;switch(c[c.length-1][0]){case"officedocumentsettings":switch(o[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:ye=!1}break;case"componentoptions":switch(o[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:ye=!1}break;case"excelworkbook":switch(o[3]){case"date1904":de.WBProps.date1904=!0;break;case"hidehorizontalscrollbar":break;case"hideverticalscrollbar":break;case"hideworkbooktabs":break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:ye=!1}break;case"workbookoptions":switch(o[3]){case"owcversion":break;case"height":break;case"width":break;default:ye=!1}break;case"worksheetoptions":switch(o[3]){case"visible":if(o[0].slice(-2)!=="/>")if(o[1]==="/")switch(n.slice(F,o.index)){case"SheetHidden":Te.Hidden=1;break;case"SheetVeryHidden":Te.Hidden=2;break}else F=o.index+o[0].length;break;case"header":p["!margins"]||Do(p["!margins"]={},"xlml"),isNaN(+lt(o[0]).Margin)||(p["!margins"].header=+lt(o[0]).Margin);break;case"footer":p["!margins"]||Do(p["!margins"]={},"xlml"),isNaN(+lt(o[0]).Margin)||(p["!margins"].footer=+lt(o[0]).Margin);break;case"pagemargins":var Ce=lt(o[0]);p["!margins"]||Do(p["!margins"]={},"xlml"),isNaN(+Ce.Top)||(p["!margins"].top=+Ce.Top),isNaN(+Ce.Left)||(p["!margins"].left=+Ce.Left),isNaN(+Ce.Right)||(p["!margins"].right=+Ce.Right),isNaN(+Ce.Bottom)||(p["!margins"].bottom=+Ce.Bottom);break;case"displayrighttoleft":de.Views||(de.Views=[]),de.Views[0]||(de.Views[0]={}),de.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":p["!outline"]||(p["!outline"]={}),p["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":p["!outline"]||(p["!outline"]={}),p["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:ye=!1}break;case"pivottable":case"pivotcache":switch(o[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:ye=!1}break;case"pagebreaks":switch(o[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:ye=!1}break;case"autofilter":switch(o[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:ye=!1}break;case"querytable":switch(o[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:ye=!1}break;case"datavalidation":switch(o[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:ye=!1}break;case"sorting":case"conditionalformatting":switch(o[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:ye=!1}break;case"mapinfo":case"schema":case"data":switch(o[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:ye=!1}break;case"smarttags":break;default:ye=!1;break}if(ye||o[3].match(/!\[CDATA/))break;if(!c[c.length-1][1])throw"Unrecognized tag: "+o[3]+"|"+c.join("|");if(c[c.length-1][0]==="customdocumentproperties"){if(o[0].slice(-2)==="/>")break;o[1]==="/"?Rq(I,Ie,L,n.slice(F,o.index)):(L=o,F=o.index+o[0].length);break}if(r.WTF)throw"Unrecognized tag: "+o[3]+"|"+c.join("|")}var ze={};return!r.bookSheets&&!r.bookProps&&(ze.Sheets=d),ze.SheetNames=h,ze.Workbook=de,ze.SSF=dr(yt),ze.Props=R,ze.Custprops=I,ze.bookType="xlml",ze}function C2(e,t){switch(Pb(t=t||{}),t.type||"base64"){case"base64":return K1(pa(e),t);case"binary":case"buffer":case"file":return K1(e,t);case"array":return K1(Pi(e),t)}}function zq(e,t){var r=[];return e.Props&&r.push(t7(e.Props,t)),e.Custprops&&r.push(r7(e.Props,e.Custprops)),r.join("")}function Wq(e){return(((e||{}).Workbook||{}).WBProps||{}).date1904?'<ExcelWorkbook xmlns="urn:schemas-microsoft-com:office:excel"><Date1904/></ExcelWorkbook>':""}function Hq(e,t){var r=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return t.cellXfs.forEach(function(n,a){var i=[];i.push(Ge("NumberFormat",null,{"ss:Format":Pt(yt[n.numFmtId])}));var s={"ss:ID":"s"+(21+a)};r.push(Ge("Style",i.join(""),s))}),Ge("Styles",r.join(""))}function YP(e){return Ge("NamedRange",null,{"ss:Name":e.Name.slice(0,6)=="_xlnm."?e.Name.slice(6):e.Name,"ss:RefersTo":"="+sp(e.Ref,{r:0,c:0})})}function qq(e){if(!((e||{}).Workbook||{}).Names)return"";for(var t=e.Workbook.Names,r=[],n=0;n<t.length;++n){var a=t[n];a.Sheet==null&&(a.Name.match(/^_xlfn\./)||r.push(YP(a)))}return Ge("Names",r.join(""))}function Vq(e,t,r,n){if(!e||!((n||{}).Workbook||{}).Names)return"";for(var a=n.Workbook.Names,i=[],s=0;s<a.length;++s){var o=a[s];o.Sheet==r&&(o.Name.match(/^_xlfn\./)||i.push(YP(o)))}return i.join("")}function Xq(e,t,r,n){if(!e)return"";var a=[];if(e["!margins"]&&(a.push("<PageSetup>"),e["!margins"].header&&a.push(Ge("Header",null,{"x:Margin":e["!margins"].header})),e["!margins"].footer&&a.push(Ge("Footer",null,{"x:Margin":e["!margins"].footer})),a.push(Ge("PageMargins",null,{"x:Bottom":e["!margins"].bottom||"0.75","x:Left":e["!margins"].left||"0.7","x:Right":e["!margins"].right||"0.7","x:Top":e["!margins"].top||"0.75"})),a.push("</PageSetup>")),n&&n.Workbook&&n.Workbook.Sheets&&n.Workbook.Sheets[r])if(n.Workbook.Sheets[r].Hidden)a.push(Ge("Visible",n.Workbook.Sheets[r].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var i=0;i<r&&!(n.Workbook.Sheets[i]&&!n.Workbook.Sheets[i].Hidden);++i);i==r&&a.push("<Selected/>")}return((((n||{}).Workbook||{}).Views||[])[0]||{}).RTL&&a.push("<DisplayRightToLeft/>"),e["!protect"]&&(a.push(wn("ProtectContents","True")),e["!protect"].objects&&a.push(wn("ProtectObjects","True")),e["!protect"].scenarios&&a.push(wn("ProtectScenarios","True")),e["!protect"].selectLockedCells!=null&&!e["!protect"].selectLockedCells?a.push(wn("EnableSelection","NoSelection")):e["!protect"].selectUnlockedCells!=null&&!e["!protect"].selectUnlockedCells&&a.push(wn("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(s){e["!protect"][s[0]]&&a.push("<"+s[1]+"/>")})),a.length==0?"":Ge("WorksheetOptions",a.join(""),{xmlns:la.x})}function Gq(e){return e.map(function(t){var r=iL(t.t||""),n=Ge("ss:Data",r,{xmlns:"http://www.w3.org/TR/REC-html40"}),a={};return t.a&&(a["ss:Author"]=t.a),e.hidden||(a["ss:ShowAlways"]="1"),Ge("Comment",n,a)}).join("")}function Kq(e,t,r,n,a,i,s){if(!e||e.v==null&&e.f==null)return"";var o={};if(e.f&&(o["ss:Formula"]="="+Pt(sp(e.f,s))),e.F&&e.F.slice(0,t.length)==t){var c=sr(e.F.slice(t.length+1));o["ss:ArrayRange"]="RC:R"+(c.r==s.r?"":"["+(c.r-s.r)+"]")+"C"+(c.c==s.c?"":"["+(c.c-s.c)+"]")}if(e.l&&e.l.Target&&(o["ss:HRef"]=Pt(e.l.Target),e.l.Tooltip&&(o["x:HRefScreenTip"]=Pt(e.l.Tooltip))),r["!merges"])for(var u=r["!merges"],d=0;d!=u.length;++d)u[d].s.c!=s.c||u[d].s.r!=s.r||(u[d].e.c>u[d].s.c&&(o["ss:MergeAcross"]=u[d].e.c-u[d].s.c),u[d].e.r>u[d].s.r&&(o["ss:MergeDown"]=u[d].e.r-u[d].s.r));var h="",p="";switch(e.t){case"z":if(!n.sheetStubs)return"";break;case"n":isFinite(e.v)?(h="Number",p=String(e.v)):(h="Error",p=tn[isNaN(e.v)?36:7]);break;case"b":h="Boolean",p=e.v?"1":"0";break;case"e":h="Error",p=tn[e.v];break;case"d":h="DateTime",p=new Date(e.v).toISOString(),e.z==null&&(e.z=e.z||yt[14]);break;case"s":h="String",p=aL(e.v||"");break}var v=Zs(n.cellXfs,e,n);o["ss:StyleID"]="s"+(21+v),o["ss:Index"]=s.c+1;var x=e.v!=null?p:"",w=e.t=="z"?"":'<Data ss:Type="'+h+'">'+x+"</Data>";return(e.c||[]).length>0&&(w+=Gq(e.c)),Ge("Cell",w,o)}function Yq(e,t){var r='<Row ss:Index="'+(e+1)+'"';return t&&(t.hpt&&!t.hpx&&(t.hpx=Hl(t.hpt)),t.hpx&&(r+=' ss:AutoFitHeight="0" ss:Height="'+t.hpx+'"'),t.hidden&&(r+=' ss:Hidden="1"')),r+">"}function Zq(e,t,r,n){if(!e["!ref"])return"";var a=Kt(e["!ref"]),i=e["!merges"]||[],s=0,o=[];e["!cols"]&&e["!cols"].forEach(function(y,_){qs(y);var S=!!y.width,k=cp(_,y),E={"ss:Index":_+1};S&&(E["ss:Width"]=Xu(k.width)),y.hidden&&(E["ss:Hidden"]="1"),o.push(Ge("Column",null,E))});for(var c=e["!data"]!=null,u={r:0,c:0},d=a.s.r;d<=a.e.r;++d){var h=[Yq(d,(e["!rows"]||[])[d])];u.r=d;for(var p=a.s.c;p<=a.e.c;++p){u.c=p;var v=!1;for(s=0;s!=i.length;++s)if(!(i[s].s.c>p)&&!(i[s].s.r>d)&&!(i[s].e.c<p)&&!(i[s].e.r<d)){(i[s].s.c!=p||i[s].s.r!=d)&&(v=!0);break}if(!v){var x=Ft(p)+Ut(d),w=c?(e["!data"][d]||[])[p]:e[x];h.push(Kq(w,x,e,t,r,n,u))}}h.push("</Row>"),h.length>2&&o.push(h.join(""))}return o.join("")}function Qq(e,t,r){var n=[],a=r.SheetNames[e],i=r.Sheets[a],s=i?Vq(i,t,e,r):"";return s.length>0&&n.push("<Names>"+s+"</Names>"),s=i?Zq(i,t,e,r):"",s.length>0&&n.push("<Table>"+s+"</Table>"),n.push(Xq(i,t,e,r)),i&&i["!autofilter"]&&n.push('<AutoFilter x:Range="'+sp(zu(i["!autofilter"].ref),{r:0,c:0})+'" xmlns="urn:schemas-microsoft-com:office:excel"></AutoFilter>'),n.join("")}function Jq(e,t){t||(t={}),e.SSF||(e.SSF=dr(yt)),e.SSF&&(dc(),Zh(e.SSF),t.revssf=Jh(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF,t.cellXfs=[],Zs(t.cellXfs,{},{revssf:{General:0}}));var r=[];r.push(zq(e,t)),r.push(Wq(e)),r.push(""),r.push(qq(e));for(var n=0;n<e.SheetNames.length;++n)r.push(Ge("Worksheet",Qq(n,t,e),{"ss:Name":Pt(e.SheetNames[n])}));return r[2]=Hq(e,t),$r+Ge("Workbook",r.join(""),{xmlns:la.ss,"xmlns:o":la.o,"xmlns:x":la.x,"xmlns:ss":la.ss,"xmlns:dt":la.dt,"xmlns:html":la.html})}function eV(e){var t={},r=e.content;if(r.l=28,t.AnsiUserType=r.read_shift(0,"lpstr-ansi"),t.AnsiClipboardFormat=jL(r),r.length-r.l<=4)return t;var n=r.read_shift(4);if(n==0||n>40||(r.l-=4,t.Reserved1=r.read_shift(0,"lpstr-ansi"),r.length-r.l<=4)||(n=r.read_shift(4),n!==1907505652)||(t.UnicodeClipboardFormat=RL(r),n=r.read_shift(4),n==0||n>40))return t;r.l-=4,t.Reserved2=r.read_shift(0,"lpwstr")}var tV=[60,1084,2066,2165,2175];function rV(e,t,r,n,a){var i=n,s=[],o=r.slice(r.l,r.l+i);if(a&&a.enc&&a.enc.insitu&&o.length>0)switch(e){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:a.enc.insitu(o)}s.push(o),r.l+=i;for(var c=Ki(r,r.l),u=O2[c],d=0;u!=null&&tV.indexOf(c)>-1;)i=Ki(r,r.l+2),d=r.l+4,c==2066?d+=4:(c==2165||c==2175)&&(d+=12),o=r.slice(d,r.l+4+i),s.push(o),r.l+=4+i,u=O2[c=Ki(r,r.l)];var h=Lr(s);Yr(h,0);var p=0;h.lens=[];for(var v=0;v<s.length;++v)h.lens.push(p),p+=s[v].length;if(h.length<n)throw"XLS Record 0x"+e.toString(16)+" Truncated: "+h.length+" < "+n;return t.f(h,h.length,a)}function xi(e,t,r){if(e.t!=="z"&&e.XF){var n=0;try{n=e.z||e.XF.numFmtId||0,t.cellNF&&e.z==null&&(e.z=yt[n])}catch(i){if(t.WTF)throw i}if(!t||t.cellText!==!1)try{e.t==="e"?e.w=e.w||tn[e.v]:n===0||n=="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=Bu(e.v):e.w=Lo(e.v):e.w=ma(n,e.v,{date1904:!!r,dateNF:t&&t.dateNF})}catch(i){if(t.WTF)throw i}if(t.cellDates&&n&&e.t=="n"&&Ha(yt[n]||String(n))){var a=Xi(e.v+(r?1462:0));a&&(e.t="d",e.v=new Date(Date.UTC(a.y,a.m-1,a.d,a.H,a.M,a.S,a.u)))}}}function Ed(e,t,r){return{v:e,ixfe:t,t:r}}function nV(e,t){var r={opts:{}},n={},a={};t.dense&&(a["!data"]=[]);var i={},s={},o=null,c=[],u="",d={},h,p="",v,x,w,y,_={},S=[],k,E,T=[],N=[],C={Sheets:[],WBProps:{date1904:!1},Views:[{}]},P={},j=!1,R=function(Re){return Re<8?No[Re]:Re<64&&N[Re-8]||No[Re]},I=function(Re,at){var bt=Re.XF.data;if(!(!bt||!bt.patternType||!at||!at.cellStyles)){Re.s={},Re.s.patternType=bt.patternType;var Yt;(Yt=Vu(R(bt.icvFore)))&&(Re.s.fgColor={rgb:Yt}),(Yt=Vu(R(bt.icvBack)))&&(Re.s.bgColor={rgb:Yt})}},F=function(Re,at,bt){if(!(!j&&ee>1)&&!(bt.sheetRows&&Re.r>=bt.sheetRows)){if(bt.cellStyles&&at.XF&&at.XF.data&&I(at,bt),delete at.ixfe,delete at.XF,h=Re,p=Rt(Re),(!s||!s.s||!s.e)&&(s={s:{r:0,c:0},e:{r:0,c:0}}),Re.r<s.s.r&&(s.s.r=Re.r),Re.c<s.s.c&&(s.s.c=Re.c),Re.r+1>s.e.r&&(s.e.r=Re.r+1),Re.c+1>s.e.c&&(s.e.c=Re.c+1),bt.cellFormula&&at.f){for(var Yt=0;Yt<S.length;++Yt)if(!(S[Yt][0].s.c>Re.c||S[Yt][0].s.r>Re.r)&&!(S[Yt][0].e.c<Re.c||S[Yt][0].e.r<Re.r)){at.F=Nt(S[Yt][0]),(S[Yt][0].s.c!=Re.c||S[Yt][0].s.r!=Re.r)&&delete at.f,at.f&&(at.f=""+Nn(S[Yt][1],s,Re,Q,L));break}}bt.dense?(a["!data"][Re.r]||(a["!data"][Re.r]=[]),a["!data"][Re.r][Re.c]=at):a[p]=at}},L={enc:!1,sbcch:0,snames:[],sharedf:_,arrayf:S,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!t&&!!t.cellStyles,WTF:!!t&&!!t.wtf};t.password&&(L.password=t.password);var H,V=[],J=[],te=[],q=[],oe=!1,Q=[];Q.SheetNames=L.snames,Q.sharedf=L.sharedf,Q.arrayf=L.arrayf,Q.names=[],Q.XTI=[];var Z=0,ee=0,ce=0,de=[],Te=[],Ie;L.codepage=1200,ii(1200);for(var Ne=!1;e.l<e.length-1;){var W=e.l,z=e.read_shift(2);if(z===0&&Z===10)break;var G=e.l===e.length?0:e.read_shift(2),X=O2[z];if(ee==0&&[9,521,1033,2057].indexOf(z)==-1)break;if(X&&X.f){if(t.bookSheets&&Z===133&&z!==133)break;if(Z=z,X.r===2||X.r==12){var ie=e.read_shift(2);if(G-=2,!L.enc&&ie!==z&&((ie&255)<<8|ie>>8)!==z)throw new Error("rt mismatch: "+ie+"!="+z);X.r==12&&(e.l+=10,G-=10)}var M={};if(z===10?M=X.f(e,G,L):M=rV(z,X,e,G,L),ee==0&&[9,521,1033,2057].indexOf(Z)===-1)continue;switch(z){case 34:r.opts.Date1904=C.WBProps.date1904=M;break;case 134:r.opts.WriteProtect=!0;break;case 47:if(L.enc||(e.l=0),L.enc=M,!t.password)throw new Error("File is password-protected");if(M.valid==null)throw new Error("Encryption scheme unsupported");if(!M.valid)throw new Error("Password is incorrect");break;case 92:L.lastuser=M;break;case 66:var le=Number(M);switch(le){case 21010:le=1200;break;case 32768:le=1e4;break;case 32769:le=1252;break}ii(L.codepage=le),Ne=!0;break;case 317:L.rrtabid=M;break;case 25:L.winlocked=M;break;case 439:r.opts.RefreshAll=M;break;case 12:r.opts.CalcCount=M;break;case 16:r.opts.CalcDelta=M;break;case 17:r.opts.CalcIter=M;break;case 13:r.opts.CalcMode=M;break;case 14:r.opts.CalcPrecision=M;break;case 95:r.opts.CalcSaveRecalc=M;break;case 15:L.CalcRefMode=M;break;case 2211:r.opts.FullCalc=M;break;case 129:M.fDialog&&(a["!type"]="dialog"),M.fBelow||((a["!outline"]||(a["!outline"]={})).above=!0),M.fRight||((a["!outline"]||(a["!outline"]={})).left=!0);break;case 67:case 579:case 1091:case 224:T.push(M);break;case 430:Q.push([M]),Q[Q.length-1].XTI=[];break;case 35:case 547:Q[Q.length-1].push(M);break;case 24:case 536:Ie={Name:M.Name,Ref:Nn(M.rgce,s,null,Q,L)},M.itab>0&&(Ie.Sheet=M.itab-1),Q.names.push(Ie),Q[0]||(Q[0]=[],Q[0].XTI=[]),Q[Q.length-1].push(M),M.Name=="_xlnm._FilterDatabase"&&M.itab>0&&M.rgce&&M.rgce[0]&&M.rgce[0][0]&&M.rgce[0][0][0]=="PtgArea3d"&&(Te[M.itab-1]={ref:Nt(M.rgce[0][0][1][2])});break;case 22:L.ExternCount=M;break;case 23:Q.length==0&&(Q[0]=[],Q[0].XTI=[]),Q[Q.length-1].XTI=Q[Q.length-1].XTI.concat(M),Q.XTI=Q.XTI.concat(M);break;case 2196:if(L.biff<8)break;Ie!=null&&(Ie.Comment=M[1]);break;case 18:a["!protect"]=M;break;case 19:M!==0&&L.WTF&&console.error("Password verifier: "+M);break;case 133:i[L.biff==4?L.snames.length:M.pos]=M,L.snames.push(M.name);break;case 10:{if(--ee?!j:j)break;if(s.e){if(s.e.r>0&&s.e.c>0){if(s.e.r--,s.e.c--,a["!ref"]=Nt(s),t.sheetRows&&t.sheetRows<=s.e.r){var ye=s.e.r;s.e.r=t.sheetRows-1,a["!fullref"]=a["!ref"],a["!ref"]=Nt(s),s.e.r=ye}s.e.r++,s.e.c++}V.length>0&&(a["!merges"]=V),J.length>0&&(a["!objects"]=J),te.length>0&&(a["!cols"]=te),q.length>0&&(a["!rows"]=q),C.Sheets.push(P)}u===""?d=a:n[u]=a,a={},t.dense&&(a["!data"]=[])}break;case 9:case 521:case 1033:case 2057:{if(L.biff===8&&(L.biff={9:2,521:3,1033:4}[z]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[M.BIFFVer]||8),L.biffguess=M.BIFFVer==0,M.BIFFVer==0&&M.dt==4096&&(L.biff=5,Ne=!0,ii(L.codepage=28591)),L.biff==4&&M.dt&256&&(j=!0),L.biff==8&&M.BIFFVer==0&&M.dt==16&&(L.biff=2),ee++&&!j)break;if(a={},t.dense&&(a["!data"]=[]),L.biff<8&&!Ne&&(Ne=!0,ii(L.codepage=t.codepage||1252)),L.biff==4&&j)u=(i[L.snames.indexOf(u)+1]||{name:""}).name;else if(L.biff<5||M.BIFFVer==0&&M.dt==4096){u===""&&(u="Sheet1"),s={s:{r:0,c:0},e:{r:0,c:0}};var Ce={pos:e.l-G,name:u};i[Ce.pos]=Ce,L.snames.push(u)}else u=(i[W]||{name:""}).name;M.dt==32&&(a["!type"]="chart"),M.dt==64&&(a["!type"]="macro"),V=[],J=[],L.arrayf=S=[],te=[],q=[],oe=!1,P={Hidden:(i[W]||{hs:0}).hs,name:u}}break;case 515:case 3:case 2:a["!type"]=="chart"&&(t.dense?(a["!data"][M.r]||[])[M.c]:a[Ft(M.c)+Ut(M.r)])&&++M.c,k={ixfe:M.ixfe,XF:T[M.ixfe]||{},v:M.val,t:"n"},ce>0&&(k.z=k.XF&&k.XF.numFmtId&&de[k.XF.numFmtId]||de[k.ixfe>>8&63]),xi(k,t,r.opts.Date1904),F({c:M.c,r:M.r},k,t);break;case 5:case 517:k={ixfe:M.ixfe,XF:T[M.ixfe],v:M.val,t:M.t},ce>0&&(k.z=k.XF&&k.XF.numFmtId&&de[k.XF.numFmtId]||de[k.ixfe>>8&63]),xi(k,t,r.opts.Date1904),F({c:M.c,r:M.r},k,t);break;case 638:k={ixfe:M.ixfe,XF:T[M.ixfe],v:M.rknum,t:"n"},ce>0&&(k.z=k.XF&&k.XF.numFmtId&&de[k.XF.numFmtId]||de[k.ixfe>>8&63]),xi(k,t,r.opts.Date1904),F({c:M.c,r:M.r},k,t);break;case 189:for(var ze=M.c;ze<=M.C;++ze){var Ze=M.rkrec[ze-M.c][0];k={ixfe:Ze,XF:T[Ze],v:M.rkrec[ze-M.c][1],t:"n"},ce>0&&(k.z=k.XF&&k.XF.numFmtId&&de[k.XF.numFmtId]||de[k.ixfe>>8&63]),xi(k,t,r.opts.Date1904),F({c:ze,r:M.r},k,t)}break;case 6:case 518:case 1030:{if(M.val=="String"){o=M;break}if(k=Ed(M.val,M.cell.ixfe,M.tt),k.XF=T[k.ixfe],t.cellFormula){var rt=M.formula;if(rt&&rt[0]&&rt[0][0]&&rt[0][0][0]=="PtgExp"){var xt=rt[0][0][1][0],mt=rt[0][0][1][1],Ee=Rt({r:xt,c:mt});_[Ee]?k.f=""+Nn(M.formula,s,M.cell,Q,L):k.F=((t.dense?(a["!data"][xt]||[])[mt]:a[Ee])||{}).F}else k.f=""+Nn(M.formula,s,M.cell,Q,L)}ce>0&&(k.z=k.XF&&k.XF.numFmtId&&de[k.XF.numFmtId]||de[k.ixfe>>8&63]),xi(k,t,r.opts.Date1904),F(M.cell,k,t),o=M}break;case 7:case 519:if(o)o.val=M,k=Ed(M,o.cell.ixfe,"s"),k.XF=T[k.ixfe],t.cellFormula&&(k.f=""+Nn(o.formula,s,o.cell,Q,L)),ce>0&&(k.z=k.XF&&k.XF.numFmtId&&de[k.XF.numFmtId]||de[k.ixfe>>8&63]),xi(k,t,r.opts.Date1904),F(o.cell,k,t),o=null;else throw new Error("String record expects Formula");break;case 33:case 545:{S.push(M);var ve=Rt(M[0].s);if(v=t.dense?(a["!data"][M[0].s.r]||[])[M[0].s.c]:a[ve],t.cellFormula&&v){if(!o||!ve||!v)break;v.f=""+Nn(M[1],s,M[0],Q,L),v.F=Nt(M[0])}}break;case 1212:{if(!t.cellFormula)break;if(p){if(!o)break;_[Rt(o.cell)]=M[0],v=t.dense?(a["!data"][o.cell.r]||[])[o.cell.c]:a[Rt(o.cell)],(v||{}).f=""+Nn(M[0],s,h,Q,L)}}break;case 253:k=Ed(c[M.isst].t,M.ixfe,"s"),c[M.isst].h&&(k.h=c[M.isst].h),k.XF=T[k.ixfe],ce>0&&(k.z=k.XF&&k.XF.numFmtId&&de[k.XF.numFmtId]||de[k.ixfe>>8&63]),xi(k,t,r.opts.Date1904),F({c:M.c,r:M.r},k,t);break;case 513:t.sheetStubs&&(k={ixfe:M.ixfe,XF:T[M.ixfe],t:"z"},ce>0&&(k.z=k.XF&&k.XF.numFmtId&&de[k.XF.numFmtId]||de[k.ixfe>>8&63]),xi(k,t,r.opts.Date1904),F({c:M.c,r:M.r},k,t));break;case 190:if(t.sheetStubs)for(var fe=M.c;fe<=M.C;++fe){var pe=M.ixfe[fe-M.c];k={ixfe:pe,XF:T[pe],t:"z"},ce>0&&(k.z=k.XF&&k.XF.numFmtId&&de[k.XF.numFmtId]||de[k.ixfe>>8&63]),xi(k,t,r.opts.Date1904),F({c:fe,r:M.r},k,t)}break;case 214:case 516:case 4:k=Ed(M.val,M.ixfe,"s"),k.XF=T[k.ixfe],ce>0&&(k.z=k.XF&&k.XF.numFmtId&&de[k.XF.numFmtId]||de[k.ixfe>>8&63]),xi(k,t,r.opts.Date1904),F({c:M.c,r:M.r},k,t);break;case 0:case 512:ee===1&&(s=M);break;case 252:c=M;break;case 1054:if(L.biff>=3&&L.biff<=4){de[ce++]=M[1];for(var nt=0;nt<ce+163&&yt[nt]!=M[1];++nt);nt>=163&&zs(M[1],ce+163)}else zs(M[1],M[0]);break;case 30:{de[ce++]=M;for(var De=0;De<ce+163&&yt[De]!=M;++De);De>=163&&zs(M,ce+163)}break;case 229:V=V.concat(M);break;case 93:J[M.cmo[0]]=L.lastobj=M;break;case 438:L.lastobj.TxO=M;break;case 127:L.lastobj.ImData=M;break;case 440:for(y=M[0].s.r;y<=M[0].e.r;++y)for(w=M[0].s.c;w<=M[0].e.c;++w)v=t.dense?(a["!data"][y]||[])[w]:a[Rt({c:w,r:y})],v&&(v.l=M[1]);break;case 2048:for(y=M[0].s.r;y<=M[0].e.r;++y)for(w=M[0].s.c;w<=M[0].e.c;++w)v=t.dense?(a["!data"][y]||[])[w]:a[Rt({c:w,r:y})],v&&v.l&&(v.l.Tooltip=M[1]);break;case 28:{if(v=t.dense?(a["!data"][M[0].r]||[])[M[0].c]:a[Rt(M[0])],v||(t.dense?(a["!data"][M[0].r]||(a["!data"][M[0].r]=[]),v=a["!data"][M[0].r][M[0].c]={t:"z"}):v=a[Rt(M[0])]={t:"z"},s.e.r=Math.max(s.e.r,M[0].r),s.s.r=Math.min(s.s.r,M[0].r),s.e.c=Math.max(s.e.c,M[0].c),s.s.c=Math.min(s.s.c,M[0].c)),v.c||(v.c=[]),L.biff<=5&&L.biff>=2)x={a:"SheetJ5",t:M[1]};else{var Oe=J[M[2]];x={a:M[1],t:Oe.TxO.t},M[3]!=null&&!(M[3]&2)&&(v.c.hidden=!0)}v.c.push(x)}break;case 2173:L$(T[M.ixfe],M.ext);break;case 125:{if(!L.cellStyles)break;for(;M.e>=M.s;)te[M.e--]={width:M.w/256,level:M.level||0,hidden:!!(M.flags&1)},oe||(oe=!0,Eb(M.w/256)),qs(te[M.e+1])}break;case 520:{var Qe={};M.level!=null&&(q[M.r]=Qe,Qe.level=M.level),M.hidden&&(q[M.r]=Qe,Qe.hidden=!0),M.hpt&&(q[M.r]=Qe,Qe.hpt=M.hpt,Qe.hpx=Hl(M.hpt))}break;case 38:case 39:case 40:case 41:a["!margins"]||Do(a["!margins"]={}),a["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[z]]=M;break;case 161:a["!margins"]||Do(a["!margins"]={}),a["!margins"].header=M.header,a["!margins"].footer=M.footer;break;case 574:M.RTL&&(C.Views[0].RTL=!0);break;case 146:N=M;break;case 2198:H=M;break;case 140:E=M;break;case 442:u?P.CodeName=M||P.name:C.WBProps.CodeName=M||"ThisWorkbook";break}}else X||console.error("Missing Info for XLS Record 0x"+z.toString(16)),e.l+=G}return r.SheetNames=_r(i).sort(function(kt,Re){return Number(kt)-Number(Re)}).map(function(kt){return i[kt].name}),t.bookSheets||(r.Sheets=n),!r.SheetNames.length&&d["!ref"]?(r.SheetNames.push("Sheet1"),r.Sheets&&(r.Sheets.Sheet1=d)):r.Preamble=d,r.Sheets&&Te.forEach(function(kt,Re){r.Sheets[r.SheetNames[Re]]["!autofilter"]=kt}),r.Strings=c,r.SSF=dr(yt),L.enc&&(r.Encryption=L.enc),H&&(r.Themes=H),r.Metadata={},E!==void 0&&(r.Metadata.Country=E),Q.names.length>0&&(C.Names=Q.names),r.Workbook=C,r}var Ou={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function aV(e,t,r){var n=wt.find(e,"/!DocumentSummaryInformation");if(n&&n.size>0)try{var a=y4(n,S2,Ou.DSI);for(var i in a)t[i]=a[i]}catch(u){if(r.WTF)throw u}var s=wt.find(e,"/!SummaryInformation");if(s&&s.size>0)try{var o=y4(s,k2,Ou.SI);for(var c in o)t[c]==null&&(t[c]=o[c])}catch(u){if(r.WTF)throw u}t.HeadingPairs&&t.TitlesOfParts&&(eP(t.HeadingPairs,t.TitlesOfParts,t,r),delete t.HeadingPairs,delete t.TitlesOfParts)}function iV(e,t){var r=[],n=[],a=[],i=0,s,o=ZE(S2,"n"),c=ZE(k2,"n");if(e.Props)for(s=_r(e.Props),i=0;i<s.length;++i)(Object.prototype.hasOwnProperty.call(o,s[i])?r:Object.prototype.hasOwnProperty.call(c,s[i])?n:a).push([s[i],e.Props[s[i]]]);if(e.Custprops)for(s=_r(e.Custprops),i=0;i<s.length;++i)Object.prototype.hasOwnProperty.call(e.Props||{},s[i])||(Object.prototype.hasOwnProperty.call(o,s[i])?r:Object.prototype.hasOwnProperty.call(c,s[i])?n:a).push([s[i],e.Custprops[s[i]]]);var u=[];for(i=0;i<a.length;++i)iP.indexOf(a[i][0])>-1||J6.indexOf(a[i][0])>-1||a[i][1]!=null&&u.push(a[i]);n.length&&wt.utils.cfb_add(t,"/SummaryInformation",w4(n,Ou.SI,c,k2)),(r.length||u.length)&&wt.utils.cfb_add(t,"/DocumentSummaryInformation",w4(r,Ou.DSI,o,S2,u.length?u:null,Ou.UDI))}function ZP(e,t){t||(t={}),Pb(t),rb(),t.codepage&&tb(t.codepage);var r,n;if(e.FullPaths){if(wt.find(e,"/encryption"))throw new Error("File is password-protected");r=wt.find(e,"!CompObj"),n=wt.find(e,"/Workbook")||wt.find(e,"/Book")}else{switch(t.type){case"base64":e=zn(pa(e));break;case"binary":e=zn(e);break;case"buffer":break;case"array":Array.isArray(e)||(e=Array.prototype.slice.call(e));break}Yr(e,0),n={content:e}}var a,i;if(r&&eV(r),t.bookProps&&!t.bookSheets)a={};else{var s=It?"buffer":"array";if(n&&n.content)a=nV(n.content,t);else if((i=wt.find(e,"PerfectOffice_MAIN"))&&i.content)a=Io.to_workbook(i.content,(t.type=s,t));else if((i=wt.find(e,"NativeContent_MAIN"))&&i.content)a=Io.to_workbook(i.content,(t.type=s,t));else throw(i=wt.find(e,"MN0"))&&i.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");t.bookVBA&&e.FullPaths&&wt.find(e,"/_VBA_PROJECT_CUR/VBA/dir")&&(a.vbaraw=hU(e))}var o={};return e.FullPaths&&aV(e,o,t),a.Props=a.Custprops=o,t.bookFiles&&(a.cfb=e),a}function sV(e,t){var r=t||{},n=wt.utils.cfb_new({root:"R"}),a="/Workbook";switch(r.bookType||"xls"){case"xls":r.bookType="biff8";case"xla":r.bookType||(r.bookType="xla");case"biff8":a="/Workbook",r.biff=8;break;case"biff5":a="/Book",r.biff=5;break;default:throw new Error("invalid type "+r.bookType+" for XLS CFB")}return wt.utils.cfb_add(n,a,JP(e,r)),r.biff==8&&(e.Props||e.Custprops)&&iV(e,n),r.biff==8&&e.vbaraw&&pU(n,wt.read(e.vbaraw,{type:typeof e.vbaraw=="string"?"binary":"buffer"})),n}var Yu={0:{f:FW},1:{f:UW},2:{f:aH},3:{f:KW},4:{f:qW},5:{f:tH},6:{f:cH},7:{f:ZW},8:{f:vH},9:{f:mH},10:{f:hH},11:{f:pH},12:{f:WW},13:{f:sH},14:{f:YW},15:{f:XW},16:{f:HP},17:{f:fH},18:{f:JW},19:{f:vb},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:dq},40:{},42:{},43:{f:l$},44:{f:s$},45:{f:f$},46:{f:h$},47:{f:d$},48:{},49:{f:SL},50:{},51:{f:U$},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:xP},62:{f:lH},63:{f:Z$},64:{f:IH},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:Rn,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:CH},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:BW},148:{f:RW,p:16},151:{f:_H},152:{},153:{f:cq},154:{},155:{},156:{f:oq},157:{},158:{},159:{T:1,f:yB},160:{T:-1},161:{T:1,f:Ko},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:gH},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:B$},336:{T:-1},337:{f:H$,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:_2},357:{},358:{},359:{},360:{T:1},361:{},362:{f:gP},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:SH},427:{f:kH},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:TH},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:LW},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:wH},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:_2},551:{f:rp},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:cU},633:{T:1},634:{T:-1},635:{T:1,f:oU},636:{T:-1},637:{f:AL},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:KH},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:FH},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},O2={6:{f:q1},10:{f:Ms},12:{f:Ir},13:{f:Ir},14:{f:Mr},15:{f:Mr},16:{f:In},17:{f:Mr},18:{f:Mr},19:{f:Ir},20:{f:E4},21:{f:E4},23:{f:gP},24:{f:A4},25:{f:Mr},26:{},27:{},28:{f:A9},29:{},34:{f:Mr},35:{f:T4},38:{f:In},39:{f:In},40:{f:In},41:{f:In},42:{f:Mr},43:{f:Mr},47:{f:$B},49:{f:K7},51:{f:Ir},60:{},61:{f:H7},64:{f:Mr},65:{f:G7},66:{f:Ir},77:{},80:{},81:{},82:{},85:{f:Ir},89:{},90:{},91:{},92:{f:F7},93:{f:N9},94:{},95:{f:Mr},96:{},97:{},99:{f:Mr},125:{f:xP},128:{f:g9},129:{f:j7},130:{f:Ir},131:{f:Mr},132:{f:Mr},133:{f:R7},134:{},140:{f:L9},141:{f:Ir},144:{},146:{f:U9},151:{},152:{},153:{},154:{},155:{},156:{f:Ir},157:{},158:{},160:{f:G9},161:{f:H9},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:l9},190:{f:c9},193:{f:Ms},197:{},198:{},199:{},200:{},201:{},202:{f:Mr},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:Ir},220:{},221:{f:Mr},222:{},224:{f:f9},225:{f:I7},226:{f:Ms},227:{},229:{f:C9},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:L7},253:{f:Z7},255:{f:$7},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:sP},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:Mr},353:{f:Ms},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:_9},431:{f:Mr},432:{},433:{},434:{},437:{},438:{f:F9},439:{f:Mr},440:{f:D9},441:{},442:{f:Hf},443:{},444:{f:Ir},445:{},446:{},448:{f:Ms},449:{f:W7,r:2},450:{f:Ms},512:{f:S4},513:{f:X9},515:{f:w9},516:{f:J7},517:{f:y9},519:{f:K9},520:{f:U7},523:{},545:{f:O4},549:{f:_4},566:{},574:{f:V7},638:{f:o9},659:{},1048:{},1054:{f:t9},1084:{},1212:{f:k9},2048:{f:R9},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:bd},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:Ms},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:z9,r:12},2173:{f:M$,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:Mr,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:S9,r:12},2197:{},2198:{f:P$,r:12},2199:{},2200:{},2201:{},2202:{f:E9,r:12},2203:{f:Ms},2204:{},2205:{},2206:{},2207:{},2211:{f:z7},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:Ir},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:q9},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:$9},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:S4},1:{},2:{f:eB},3:{f:Q9},4:{f:Z9},5:{f:nB},7:{f:rB},8:{},9:{f:bd},11:{},22:{f:Ir},30:{f:n9},31:{},32:{},33:{f:O4},36:{},37:{f:_4},50:{f:aB},62:{},52:{},67:{f:d9},68:{f:Ir},69:{},86:{},126:{},127:{f:Y9},135:{},136:{},137:{},143:{f:sB},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:iB},223:{},234:{},354:{},421:{},518:{f:q1},521:{f:bd},536:{f:A4},547:{f:T4},561:{},579:{f:m9},1030:{f:q1},1033:{f:bd},1091:{f:v9},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},101:{},102:{},105:{},106:{},107:{},109:{},112:{},114:{},29282:{}};function Be(e,t,r,n){var a=t;if(!isNaN(a)){var i=n||(r||[]).length||0,s=e.next(4);s.write_shift(2,a),s.write_shift(2,i),i>0&&hb(r)&&e.push(r)}}function oV(e,t,r,n){var a=(r||[]).length||0;if(a<=8224)return Be(e,t,r,a);var i=t;if(!isNaN(i)){for(var s=r.parts||[],o=0,c=0,u=0;u+(s[o]||8224)<=8224;)u+=s[o]||8224,o++;var d=e.next(4);for(d.write_shift(2,i),d.write_shift(2,u),e.push(r.slice(c,c+u)),c+=u;c<a;){for(d=e.next(4),d.write_shift(2,60),u=0;u+(s[o]||8224)<=8224;)u+=s[o]||8224,o++;d.write_shift(2,u),e.push(r.slice(c,c+u)),c+=u}}}function Y1(e,t,r,n){var a=be(9);return qf(a,e,t),lP(r,n||"b",a),a}function lV(e,t,r){var n=be(8+2*r.length);return qf(n,e,t),n.write_shift(1,r.length),n.write_shift(r.length,r,"sbcs"),n.l<n.length?n.slice(0,n.l):n}function QP(e,t){t.forEach(function(r){var n=r[0].map(function(i){return i.t}).join("");if(n.length<=2048)return Be(e,28,z1(n,r[1],r[2]));Be(e,28,z1(n.slice(0,2048),r[1],r[2],n.length));for(var a=2048;a<n.length;a+=2048)Be(e,28,z1(n.slice(a,Math.min(a+2048,n.length)),-1,-1,Math.min(2048,n.length-a)))})}function cV(e,t,r,n,a,i){var s=0;t.z!=null&&(s=a._BIFF2FmtTable.indexOf(t.z),s==-1&&(a._BIFF2FmtTable.push(t.z),s=a._BIFF2FmtTable.length-1));var o=0;if(t.z!=null){for(;o<a.cellXfs.length&&a.cellXfs[o].numFmtId!=s;++o);o==a.cellXfs.length&&a.cellXfs.push({numFmtId:s})}if(t.v!=null)switch(t.t){case"d":case"n":var c=t.t=="d"?Or(Tr(t.v,i),i):t.v;a.biff==2&&c==(c|0)&&c>=0&&c<65536?Be(e,2,tB(r,n,c,o,s)):isNaN(c)?Be(e,5,Y1(r,n,36,"e")):isFinite(c)?Be(e,3,J9(r,n,c,o,s)):Be(e,5,Y1(r,n,7,"e"));return;case"b":case"e":Be(e,5,Y1(r,n,t.v,t.t));return;case"s":case"str":Be(e,4,lV(r,n,t.v==null?"":String(t.v).slice(0,255)));return}Be(e,1,qf(null,r,n))}function uV(e,t,r,n,a){var i=t["!data"]!=null,s=Kt(t["!ref"]||"A1"),o="",c=[];if(s.e.c>255||s.e.r>16383){if(n.WTF)throw new Error("Range "+(t["!ref"]||"A1")+" exceeds format limit A1:IV16384");s.e.c=Math.min(s.e.c,255),s.e.r=Math.min(s.e.r,16383)}for(var u=(((a||{}).Workbook||{}).WBProps||{}).date1904,d=[],h=[],p=s.s.c;p<=s.e.c;++p)c[p]=Ft(p);for(var v=s.s.r;v<=s.e.r;++v)for(i&&(d=t["!data"][v]||[]),o=Ut(v),p=s.s.c;p<=s.e.c;++p){var x=i?d[p]:t[c[p]+o];x&&(cV(e,x,v,p,n,u),x.c&&h.push([x.c,v,p]))}QP(e,h)}function fV(e,t){for(var r=t||{},n=Dn(),a=0,i=0;i<e.SheetNames.length;++i)e.SheetNames[i]==r.sheet&&(a=i);if(a==0&&r.sheet&&e.SheetNames[0]!=r.sheet)throw new Error("Sheet not found: "+r.sheet);Be(n,r.biff==4?1033:r.biff==3?521:9,_b(e,16,r)),((e.Workbook||{}).WBProps||{}).date1904&&Be(n,34,On(!0)),r.cellXfs=[{numFmtId:0}],r._BIFF2FmtTable=["General"],r._Fonts=[];var s=Dn();return uV(s,e.Sheets[e.SheetNames[a]],a,r,e),r._BIFF2FmtTable.forEach(function(o){r.biff<=3?Be(n,30,a9(o)):Be(n,1054,i9(o))}),r.cellXfs.forEach(function(o){switch(r.biff){case 2:Be(n,67,h9(o));break;case 3:Be(n,579,vP(o));break;case 4:Be(n,1091,p9(o));break}}),delete r._BIFF2FmtTable,delete r.cellXfs,delete r._Fonts,n.push(s.end()),Be(n,10),n.end()}var ni=1,ja=[];function dV(){var e=be(82+8*ja.length);e.write_shift(2,15),e.write_shift(2,61440),e.write_shift(4,74+8*ja.length);{e.write_shift(2,0),e.write_shift(2,61446),e.write_shift(4,16+8*ja.length);{e.write_shift(4,ni),e.write_shift(4,ja.length+1);for(var t=0,r=0;r<ja.length;++r)t+=ja[r]&&ja[r][1]||0;e.write_shift(4,t),e.write_shift(4,ja.length)}ja.forEach(function(n){e.write_shift(4,n[0]),e.write_shift(4,n[2])})}return e.write_shift(2,51),e.write_shift(2,61451),e.write_shift(4,18),e.write_shift(2,191),e.write_shift(4,524296),e.write_shift(2,385),e.write_shift(4,134217793),e.write_shift(2,448),e.write_shift(4,134217792),e.write_shift(2,64),e.write_shift(2,61726),e.write_shift(4,16),e.write_shift(4,134217741),e.write_shift(4,134217740),e.write_shift(4,134217751),e.write_shift(4,268435703),e}function hV(e,t){var r=[],n=0,a=Dn(),i=ni,s;t.forEach(function(c,u){var d="",h=c[0].map(function(k){return k.a&&!d&&(d=k.a),k.t}).join("");++ni;{var p=be(150);p.write_shift(2,15),p.write_shift(2,61444),p.write_shift(4,150),p.write_shift(2,3234),p.write_shift(2,61450),p.write_shift(4,8),p.write_shift(4,ni),p.write_shift(4,2560),p.write_shift(2,227),p.write_shift(2,61451),p.write_shift(4,84),p.write_shift(2,128),p.write_shift(4,0),p.write_shift(2,139),p.write_shift(4,2),p.write_shift(2,191),p.write_shift(4,524296),p.write_shift(2,344),p.l+=4,p.write_shift(2,385),p.write_shift(4,134217808),p.write_shift(2,387),p.write_shift(4,134217808),p.write_shift(2,389),p.write_shift(4,268435700),p.write_shift(2,447),p.write_shift(4,1048592),p.write_shift(2,448),p.write_shift(4,134217809),p.write_shift(2,451),p.write_shift(4,268435700),p.write_shift(2,513),p.write_shift(4,134217809),p.write_shift(2,515),p.write_shift(4,268435700),p.write_shift(2,575),p.write_shift(4,196609),p.write_shift(2,959),p.write_shift(4,131072|(c[0].hidden?2:0)),p.l+=2,p.write_shift(2,61456),p.write_shift(4,18),p.write_shift(2,3),p.write_shift(2,c[2]+2),p.l+=2,p.write_shift(2,c[1]+1),p.l+=2,p.write_shift(2,c[2]+4),p.l+=2,p.write_shift(2,c[1]+5),p.l+=2,p.l+=2,p.write_shift(2,61457),p.l+=4,p.l=150,u==0?s=p:Be(a,236,p)}n+=150;{var v=be(52);v.write_shift(2,21),v.write_shift(2,18),v.write_shift(2,25),v.write_shift(2,ni),v.write_shift(2,0),v.l=22,v.write_shift(2,13),v.write_shift(2,22),v.write_shift(4,1651663474),v.write_shift(4,2503426821),v.write_shift(4,2150634280),v.write_shift(4,1768515844+ni*256),v.write_shift(2,0),v.write_shift(4,0),v.l+=4,Be(a,93,v)}{var x=be(8);x.l+=2,x.write_shift(2,61453),x.l+=4,Be(a,236,x)}n+=8;{var w=be(18);w.write_shift(2,18),w.l+=8,w.write_shift(2,h.length),w.write_shift(2,16),w.l+=4,Be(a,438,w);{var y=be(1+h.length);y.write_shift(1,0),y.write_shift(h.length,h,"sbcs"),Be(a,60,y)}{var _=be(16);_.l+=8,_.write_shift(2,h.length),_.l+=6,Be(a,60,_)}}{var S=be(12+d.length);S.write_shift(2,c[1]),S.write_shift(2,c[2]),S.write_shift(2,0|(c[0].hidden?0:2)),S.write_shift(2,ni),S.write_shift(2,d.length),S.write_shift(1,0),S.write_shift(d.length,d,"sbcs"),S.l++,r.push(S)}});{var o=be(80);o.write_shift(2,15),o.write_shift(2,61442),o.write_shift(4,n+o.length-8),o.write_shift(2,16),o.write_shift(2,61448),o.write_shift(4,8),o.write_shift(4,t.length+1),o.write_shift(4,ni),o.write_shift(2,15),o.write_shift(2,61443),o.write_shift(4,n+48),o.write_shift(2,15),o.write_shift(2,61444),o.write_shift(4,40),o.write_shift(2,1),o.write_shift(2,61449),o.write_shift(4,16),o.l+=16,o.write_shift(2,2),o.write_shift(2,61450),o.write_shift(4,8),o.write_shift(4,i),o.write_shift(4,5),Be(e,236,s?Lr([o,s]):o)}e.push(a.end()),r.forEach(function(c){Be(e,28,c)}),ja.push([i,t.length+1,ni]),++ni}function pV(e,t,r){Be(e,49,Y7({sz:12,name:"Arial"},r))}function mV(e,t,r){t&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var a=n[0];a<=n[1];++a)t[a]!=null&&Be(e,1054,r9(a,t[a],r))})}function vV(e,t){var r=be(19);r.write_shift(4,2151),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,1),r.write_shift(4,0),Be(e,2151,r),r=be(39),r.write_shift(4,2152),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,0),r.write_shift(4,0),r.write_shift(2,1),r.write_shift(4,4),r.write_shift(2,0),hP(Kt(t["!ref"]||"A1"),r),r.write_shift(4,4),Be(e,2152,r)}function gV(e,t){for(var r=0;r<16;++r)Be(e,224,k4({numFmtId:0,style:!0},0,t));t.cellXfs.forEach(function(n){Be(e,224,k4(n,0,t))})}function xV(e,t){for(var r=0;r<t["!links"].length;++r){var n=t["!links"][r];Be(e,440,j9(n)),n[1].Tooltip&&Be(e,2048,M9(n))}delete t["!links"]}function yV(e,t){if(t){var r=0;t.forEach(function(n,a){++r<=256&&n&&Be(e,125,W9(cp(a,n),a))})}}function wV(e,t,r,n,a,i){var s=16+Zs(a.cellXfs,t,a);if(t.v==null&&!t.bf){Be(e,513,Wo(r,n,s));return}if(t.bf)Be(e,6,$z(t,r,n,a,s));else switch(t.t){case"d":case"n":var o=t.t=="d"?Or(Tr(t.v,i),i):t.v;isNaN(o)?Be(e,517,U1(r,n,36,s,a,"e")):isFinite(o)?Be(e,515,b9(r,n,o,s)):Be(e,517,U1(r,n,7,s,a,"e"));break;case"b":case"e":Be(e,517,U1(r,n,t.v,s,a,t.t));break;case"s":case"str":if(a.bookSST){var c=Cb(a.Strings,t.v==null?"":String(t.v),a.revStrings);Be(e,253,Q7(r,n,c,s))}else Be(e,516,e9(r,n,(t.v==null?"":String(t.v)).slice(0,255),s,a));break;default:Be(e,513,Wo(r,n,s))}}function bV(e,t,r){var n=Dn(),a=r.SheetNames[e],i=r.Sheets[a]||{},s=(r||{}).Workbook||{},o=(s.Sheets||[])[e]||{},c=i["!data"]!=null,u=t.biff==8,d="",h=[],p=Kt(i["!ref"]||"A1"),v=u?65536:16384;if(p.e.c>255||p.e.r>=v){if(t.WTF)throw new Error("Range "+(i["!ref"]||"A1")+" exceeds format limit A1:IV"+v);p.e.c=Math.min(p.e.c,255),p.e.r=Math.min(p.e.r,v-1)}Be(n,2057,_b(r,16,t)),Be(n,13,Ra(1)),Be(n,12,Ra(100)),Be(n,15,On(!0)),Be(n,17,On(!1)),Be(n,16,Uo(.001)),Be(n,95,On(!0)),Be(n,42,On(!1)),Be(n,43,On(!1)),Be(n,130,Ra(1)),Be(n,128,x9()),Be(n,131,On(!1)),Be(n,132,On(!1)),u&&yV(n,i["!cols"]),Be(n,512,s9(p,t));var x=(((r||{}).Workbook||{}).WBProps||{}).date1904;u&&(i["!links"]=[]);for(var w=p.s.c;w<=p.e.c;++w)h[w]=Ft(w);for(var y=[],_=[],S=p.s.r;S<=p.e.r;++S)for(c&&(_=i["!data"][S]||[]),d=Ut(S),w=p.s.c;w<=p.e.c;++w){var k=c?_[w]:i[h[w]+d];k&&(wV(n,k,S,w,t,x),u&&k.l&&i["!links"].push([h[w]+d,k.l]),k.c&&y.push([k.c,S,w]))}var E=o.CodeName||o.name||a;return u?hV(n,y):QP(n,y),u&&Be(n,574,X7((s.Views||[])[0])),u&&(i["!merges"]||[]).length&&Be(n,229,O9(i["!merges"])),u&&xV(n,i),Be(n,442,cP(E)),u&&vV(n,i),Be(n,10),n.end()}function _V(e,t,r){var n=Dn(),a=(e||{}).Workbook||{},i=a.Sheets||[],s=a.WBProps||{},o=r.biff==8,c=r.biff==5;if(Be(n,2057,_b(e,5,r)),r.bookType=="xla"&&Be(n,135),Be(n,225,o?Ra(1200):null),Be(n,193,h7(2)),c&&Be(n,191),c&&Be(n,192),Be(n,226),Be(n,92,D7("SheetJS",r)),Be(n,66,Ra(o?1200:1252)),o&&Be(n,353,Ra(0)),o&&Be(n,448),Be(n,317,V9(e.SheetNames.length)),o&&e.vbaraw&&Be(n,211),o&&e.vbaraw){var u=s.CodeName||"ThisWorkbook";Be(n,442,cP(u))}Be(n,156,Ra(17)),Be(n,25,On(!1)),Be(n,18,On(!1)),Be(n,19,Ra(0)),o&&Be(n,431,On(!1)),o&&Be(n,444,Ra(0)),Be(n,61,q7()),Be(n,64,On(!1)),Be(n,141,Ra(0)),Be(n,34,On(eq(e)=="true")),Be(n,14,On(!0)),o&&Be(n,439,On(!1)),Be(n,218,Ra(0)),pV(n,e,r),mV(n,e.SSF,r),gV(n,r),o&&Be(n,352,On(!1));var d=n.end(),h=Dn();o&&Be(h,140,B9()),o&&ja.length&&Be(h,235,dV()),o&&r.Strings&&oV(h,252,B7(r.Strings)),Be(h,10);var p=h.end(),v=Dn(),x=0,w=0;for(w=0;w<e.SheetNames.length;++w)x+=(o?12:11)+(o?2:1)*e.SheetNames[w].length;var y=d.length+x+p.length;for(w=0;w<e.SheetNames.length;++w){var _=i[w]||{};Be(v,133,M7({pos:y,hs:_.Hidden||0,dt:0,name:e.SheetNames[w]},r)),y+=t[w].length}var S=v.end();if(x!=S.length)throw new Error("BS8 "+x+" != "+S.length);var k=[];return d.length&&k.push(d),S.length&&k.push(S),p.length&&k.push(p),Lr(k)}function SV(e,t){var r=t||{},n=[];e&&!e.SSF&&(e.SSF=dr(yt)),e&&e.SSF&&(dc(),Zh(e.SSF),r.revssf=Jh(e.SSF),r.revssf[e.SSF[65535]]=0,r.ssf=e.SSF),ni=1,ja=[],r.Strings=[],r.Strings.Count=0,r.Strings.Unique=0,Ib(r),r.cellXfs=[],Zs(r.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={});for(var a=0;a<e.SheetNames.length;++a)n[n.length]=bV(a,r,e);return n.unshift(_V(e,n,r)),Lr(n)}function JP(e,t){for(var r=0;r<=e.SheetNames.length;++r){var n=e.Sheets[e.SheetNames[r]];if(!(!n||!n["!ref"])){var a=hn(n["!ref"]);a.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+e.SheetNames[r]+"' extends beyond column IV (255).  Data may be lost."),a.e.r>65535&&typeof console<"u"&&console.error&&console.error("Worksheet '"+e.SheetNames[r]+"' extends beyond row 65536.  Data may be lost.")}}var i=t||{};switch(i.biff||2){case 8:case 5:return SV(e,t);case 4:case 3:case 2:return fV(e,t)}throw new Error("invalid type "+i.bookType+" for BIFF")}function z4(e,t){var r=t||{},n=r.dense!=null?r.dense:rM,a={};n&&(a["!data"]=[]),e=zf(e,"<!--","-->");var i=e.match(/<table/i);if(!i)throw new Error("Invalid HTML: could not find <table>");var s=e.match(/<\/table/i),o=i.index,c=s&&s.index||e.length,u=XM(e.slice(o,c),/(:?<tr[^<>]*>)/i,"<tr>"),d=-1,h=0,p=0,v=0,x={s:{r:1e7,c:1e7},e:{r:0,c:0}},w=[];for(o=0;o<u.length;++o){var y=u[o].trim(),_=y.slice(0,3).toLowerCase();if(_=="<tr"){if(++d,r.sheetRows&&r.sheetRows<=d){--d;break}h=0;continue}if(!(_!="<td"&&_!="<th")){var S=y.split(/<\/t[dh]>/i);for(c=0;c<S.length;++c){var k=S[c].trim();if(k.match(/<t[dh]/i)){for(var E=k,T=0;E.charAt(0)=="<"&&(T=E.indexOf(">"))>-1;)E=E.slice(T+1);for(var N=0;N<w.length;++N){var C=w[N];C.s.c==h&&C.s.r<d&&d<=C.e.r&&(h=C.e.c+1,N=-1)}var P=lt(k.slice(0,k.indexOf(">")));v=P.colspan?+P.colspan:1,((p=+P.rowspan)>1||v>1)&&w.push({s:{r:d,c:h},e:{r:d+(p||1)-1,c:h+v-1}});var j=P.t||P["data-t"]||"";if(!E.length){h+=v;continue}if(E=C6(E),x.s.r>d&&(x.s.r=d),x.e.r<d&&(x.e.r=d),x.s.c>h&&(x.s.c=h),x.e.c<h&&(x.e.c=h),!E.length){h+=v;continue}var R={t:"s",v:E};r.raw||!E.trim().length||j=="s"||(E==="TRUE"?R={t:"b",v:!0}:E==="FALSE"?R={t:"b",v:!1}:isNaN(ha(E))?isNaN($u(E).getDate())?E.charCodeAt(0)==35&&dn[E]!=null&&(R.t="e",R.w=E,R.v=dn[E]):(R={t:"d",v:Tr(E)},r.UTC===!1&&(R.v=$o(R.v)),r.cellDates||(R={t:"n",v:Or(R.v)}),R.z=r.dateNF||yt[14]):R={t:"n",v:ha(E)}),R.cellText!==!1&&(R.w=E),n?(a["!data"][d]||(a["!data"][d]=[]),a["!data"][d][h]=R):a[Rt({r:d,c:h})]=R,h+=v}}}}return a["!ref"]=Nt(x),w.length&&(a["!merges"]=w),a}function kV(e,t,r,n){for(var a=e["!merges"]||[],i=[],s={},o=e["!data"]!=null,c=t.s.c;c<=t.e.c;++c){for(var u=0,d=0,h=0;h<a.length;++h)if(!(a[h].s.r>r||a[h].s.c>c)&&!(a[h].e.r<r||a[h].e.c<c)){if(a[h].s.r<r||a[h].s.c<c){u=-1;break}u=a[h].e.r-a[h].s.r+1,d=a[h].e.c-a[h].s.c+1;break}if(!(u<0)){var p=Ft(c)+Ut(r),v=o?(e["!data"][r]||[])[c]:e[p];v&&v.t=="n"&&v.v!=null&&!isFinite(v.v)&&(isNaN(v.v)?v={t:"e",v:36,w:tn[36]}:v={t:"e",v:7,w:tn[7]});var x=v&&v.v!=null&&(v.h||wu(v.w||(is(v),v.w)||""))||"";s={},u>1&&(s.rowspan=u),d>1&&(s.colspan=d),n.editable?x='<span contenteditable="true">'+x+"</span>":v&&(s["data-t"]=v&&v.t||"z",v.v!=null&&(s["data-v"]=wu(v.v instanceof Date?v.v.toISOString():v.v)),v.z!=null&&(s["data-z"]=v.z),v.l&&(v.l.Target||"#").charAt(0)!="#"&&(x='<a href="'+wu(v.l.Target)+'">'+x+"</a>")),s.id=(n.id||"sjs")+"-"+p,i.push(Ge("td",x,s))}}var w="<tr>";return w+i.join("")+"</tr>"}var EV='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',TV="</body></html>";function AV(e,t){var r=YM(e,"table");if(!r||r.length==0)throw new Error("Invalid HTML: could not find <table>");if(r.length==1){var n=Ys(z4(r[0],t),t);return n.bookType="html",n}var a=jb();return r.forEach(function(i,s){Kf(a,z4(i,t),"Sheet"+(s+1))}),a.bookType="html",a}function CV(e,t,r){var n=[];return n.join("")+"<table"+(r&&r.id?' id="'+r.id+'"':"")+">"}function eI(e,t){var r=t||{},n=r.header!=null?r.header:EV,a=r.footer!=null?r.footer:TV,i=[n],s=hn(e["!ref"]||"A1");if(i.push(CV(e,s,r)),e["!ref"])for(var o=s.s.r;o<=s.e.r;++o)i.push(kV(e,s,o,r));return i.push("</table>"+a),i.join("")}function tI(e,t,r){var n=t.rows;if(!n)throw"Unsupported origin when "+t.tagName+" is not a TABLE";var a=r||{},i=e["!data"]!=null,s=0,o=0;if(a.origin!=null)if(typeof a.origin=="number")s=a.origin;else{var c=typeof a.origin=="string"?sr(a.origin):a.origin;s=c.r,o=c.c}var u=Math.min(a.sheetRows||1e7,n.length),d={s:{r:0,c:0},e:{r:s,c:o}};if(e["!ref"]){var h=hn(e["!ref"]);d.s.r=Math.min(d.s.r,h.s.r),d.s.c=Math.min(d.s.c,h.s.c),d.e.r=Math.max(d.e.r,h.e.r),d.e.c=Math.max(d.e.c,h.e.c),s==-1&&(d.e.r=s=h.e.r+1)}var p=[],v=0,x=e["!rows"]||(e["!rows"]=[]),w=0,y=0,_=0,S=0,k=0,E=0;for(e["!cols"]||(e["!cols"]=[]);w<n.length&&y<u;++w){var T=n[w];if(W4(T)){if(a.display)continue;x[y]={hidden:!0}}var N=T.cells;for(_=S=0;_<N.length;++_){var C=N[_];if(!(a.display&&W4(C))){var P=C.hasAttribute("data-v")?C.getAttribute("data-v"):C.hasAttribute("v")?C.getAttribute("v"):C6(C.innerHTML),j=C.getAttribute("data-z")||C.getAttribute("z");for(v=0;v<p.length;++v){var R=p[v];R.s.c==S+o&&R.s.r<y+s&&y+s<=R.e.r&&(S=R.e.c+1-o,v=-1)}E=+C.getAttribute("colspan")||1,((k=+C.getAttribute("rowspan")||1)>1||E>1)&&p.push({s:{r:y+s,c:S+o},e:{r:y+s+(k||1)-1,c:S+o+(E||1)-1}});var I={t:"s",v:P},F=C.getAttribute("data-t")||C.getAttribute("t")||"";P!=null&&(P.length==0?I.t=F||"z":a.raw||P.trim().length==0||F=="s"||(F=="e"&&tn[+P]?I={t:"e",v:+P,w:tn[+P]}:P==="TRUE"?I={t:"b",v:!0}:P==="FALSE"?I={t:"b",v:!1}:isNaN(ha(P))?isNaN($u(P).getDate())?P.charCodeAt(0)==35&&dn[P]!=null&&(I={t:"e",v:dn[P],w:P}):(I={t:"d",v:Tr(P)},a.UTC&&(I.v=ep(I.v)),a.cellDates||(I={t:"n",v:Or(I.v)}),I.z=a.dateNF||yt[14]):I={t:"n",v:ha(P)})),I.z===void 0&&j!=null&&(I.z=j);var L="",H=C.getElementsByTagName("A");if(H&&H.length)for(var V=0;V<H.length&&!(H[V].hasAttribute("href")&&(L=H[V].getAttribute("href"),L.charAt(0)!="#"));++V);L&&L.charAt(0)!="#"&&L.slice(0,11).toLowerCase()!="javascript:"&&(I.l={Target:L}),i?(e["!data"][y+s]||(e["!data"][y+s]=[]),e["!data"][y+s][S+o]=I):e[Rt({c:S+o,r:y+s})]=I,d.e.c<S+o&&(d.e.c=S+o),S+=E}}++y}return p.length&&(e["!merges"]=(e["!merges"]||[]).concat(p)),d.e.r=Math.max(d.e.r,y-1+s),e["!ref"]=Nt(d),y>=u&&(e["!fullref"]=Nt((d.e.r=n.length-w+y-1+s,d))),e}function rI(e,t){var r=t||{},n={};return r.dense&&(n["!data"]=[]),tI(n,e,t)}function OV(e,t){var r=Ys(rI(e,t),t);return r}function W4(e){var t="",r=NV(e);return r&&(t=r(e).getPropertyValue("display")),t||(t=e.style&&e.style.display),t==="none"}function NV(e){return e.ownerDocument.defaultView&&typeof e.ownerDocument.defaultView.getComputedStyle=="function"?e.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function PV(e){var t=e.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(n,a){return Array(parseInt(a,10)+1).join(" ")}).replace(/<text:tab[^<>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),r=zt(t.replace(/<[^<>]*>/g,""));return[r]}function nI(e,t,r){var n=r||{},a=tp(e);Hr.lastIndex=0,a=sb(zf(a,"<!--","-->"));for(var i,s,o="",c="",u,d=0,h=-1,p="";i=Hr.exec(a);)switch(i[3]=i[3].replace(/_[\s\S]*$/,"")){case"number-style":case"currency-style":case"percentage-style":case"date-style":case"time-style":case"text-style":i[1]==="/"?(s["truncate-on-overflow"]=="false"&&(o.match(/h/)?o=o.replace(/h+/,"[$&]"):o.match(/m/)?o=o.replace(/m+/,"[$&]"):o.match(/s/)&&(o=o.replace(/s+/,"[$&]"))),n[s.name]=o,o=""):i[0].charAt(i[0].length-2)!=="/"&&(o="",s=lt(i[0],!1));break;case"boolean-style":i[1]==="/"?(n[s.name]="General",o=""):i[0].charAt(i[0].length-2)!=="/"&&(o="",s=lt(i[0],!1));break;case"boolean":o+="General";break;case"text":i[1]==="/"?(p=a.slice(h,Hr.lastIndex-i[0].length),p=="%"&&s[0]=="<number:percentage-style"?o+="%":o+='"'+p.replace(/"/g,'""')+'"'):i[0].charAt(i[0].length-2)!=="/"&&(h=Hr.lastIndex);break;case"day":switch(u=lt(i[0],!1),u.style){case"short":o+="d";break;case"long":o+="dd";break;default:o+="dd";break}break;case"day-of-week":switch(u=lt(i[0],!1),u.style){case"short":o+="ddd";break;case"long":o+="dddd";break;default:o+="ddd";break}break;case"era":switch(u=lt(i[0],!1),u.style){case"short":o+="ee";break;case"long":o+="eeee";break;default:o+="eeee";break}break;case"hours":switch(u=lt(i[0],!1),u.style){case"short":o+="h";break;case"long":o+="hh";break;default:o+="hh";break}break;case"minutes":switch(u=lt(i[0],!1),u.style){case"short":o+="m";break;case"long":o+="mm";break;default:o+="mm";break}break;case"month":switch(u=lt(i[0],!1),u.textual&&(o+="mm"),u.style){case"short":o+="m";break;case"long":o+="mm";break;default:o+="m";break}break;case"seconds":{switch(u=lt(i[0],!1),u.style){case"short":o+="s";break;case"long":o+="ss";break;default:o+="ss";break}u["decimal-places"]&&(o+="."+qt("0",+u["decimal-places"]))}break;case"year":switch(u=lt(i[0],!1),u.style){case"short":o+="yy";break;case"long":o+="yyyy";break;default:o+="yy";break}break;case"am-pm":o+="AM/PM";break;case"week-of-year":case"quarter":console.error("Excel does not support ODS format token "+i[3]);break;case"fill-character":i[1]==="/"?(p=a.slice(h,Hr.lastIndex-i[0].length),o+='"'+p.replace(/"/g,'""')+'"*'):i[0].charAt(i[0].length-2)!=="/"&&(h=Hr.lastIndex);break;case"scientific-number":u=lt(i[0],!1),o+="0."+qt("0",+u["min-decimal-places"]||+u["decimal-places"]||2)+qt("?",+u["decimal-places"]-+u["min-decimal-places"]||0)+"E"+(tr(u["forced-exponent-sign"])?"+":"")+qt("0",+u["min-exponent-digits"]||2);break;case"fraction":u=lt(i[0],!1),+u["min-integer-digits"]?o+=qt("0",+u["min-integer-digits"]):o+="#",o+=" ",o+=qt("?",+u["min-numerator-digits"]||1),o+="/",+u["denominator-value"]?o+=u["denominator-value"]:o+=qt("?",+u["min-denominator-digits"]||1);break;case"currency-symbol":i[1]==="/"?o+='"'+a.slice(h,Hr.lastIndex-i[0].length).replace(/"/g,'""')+'"':i[0].charAt(i[0].length-2)!=="/"?h=Hr.lastIndex:o+="$";break;case"text-properties":switch(u=lt(i[0],!1),(u.color||"").toLowerCase().replace("#","")){case"ff0000":case"red":o="[Red]"+o;break}break;case"text-content":o+="@";break;case"map":u=lt(i[0],!1),zt(u.condition)=="value()>=0"?o=n[u["apply-style-name"]]+";"+o:console.error("ODS number format may be incorrect: "+u.condition);break;case"number":if(i[1]==="/")break;u=lt(i[0],!1),c="",c+=qt("0",+u["min-integer-digits"]||1),tr(u.grouping)&&(c=Gi(qt("#",Math.max(0,4-c.length))+c)),(+u["min-decimal-places"]||+u["decimal-places"])&&(c+="."),+u["min-decimal-places"]&&(c+=qt("0",+u["min-decimal-places"]||1)),+u["decimal-places"]-(+u["min-decimal-places"]||0)&&(c+=qt("0",+u["decimal-places"]-(+u["min-decimal-places"]||0))),o+=c;break;case"embedded-text":i[1]==="/"?d==0?o+='"'+a.slice(h,Hr.lastIndex-i[0].length).replace(/"/g,'""')+'"':o=o.slice(0,d)+'"'+a.slice(h,Hr.lastIndex-i[0].length).replace(/"/g,'""')+'"'+o.slice(d):i[0].charAt(i[0].length-2)!=="/"&&(h=Hr.lastIndex,d=-+lt(i[0],!1).position||0);break}return n}function aI(e,t,r){var n=t||{},a=tp(e),i=[],s,o,c,u="",d=0,h,p,v={},x=[],w={};n.dense&&(w["!data"]=[]);var y,_,S={value:""},k={},E="",T=0,N="",C=0,P=[],j=[],R=-1,I=-1,F={s:{r:1e6,c:1e7},e:{r:0,c:0}},L=0,H=r||{},V={},J=[],te={},q=0,oe=0,Q=[],Z=1,ee=1,ce=[],de={Names:[],WBProps:{}},Te={},Ie=["",""],Ne=[],W={},z="",G=0,X=!1,ie=!1,M=0;for(Hr.lastIndex=0,a=sb(zf(a,"<!--","-->"));y=Hr.exec(a);)switch(y[3]=y[3].replace(/_[\s\S]*$/,"")){case"table":case"":y[1]==="/"?(F.e.c>=F.s.c&&F.e.r>=F.s.r?w["!ref"]=Nt(F):w["!ref"]="A1:A1",n.sheetRows>0&&n.sheetRows<=F.e.r&&(w["!fullref"]=w["!ref"],F.e.r=n.sheetRows-1,w["!ref"]=Nt(F)),J.length&&(w["!merges"]=J),Q.length&&(w["!rows"]=Q),h.name=h.||h.name,typeof JSON<"u"&&JSON.stringify(h),x.push(h.name),v[h.name]=w,ie=!1):y[0].charAt(y[0].length-2)!=="/"&&(h=lt(y[0],!1),R=I=-1,F.s.r=F.s.c=1e7,F.e.r=F.e.c=0,w={},n.dense&&(w["!data"]=[]),J=[],Q=[],ie=!0);break;case"table-row-group":y[1]==="/"?--L:++L;break;case"table-row":case"":if(y[1]==="/"){R+=Z,Z=1;break}if(p=lt(y[0],!1),p.?R=p.-1:R==-1&&(R=0),Z=+p["number-rows-repeated"]||1,Z<10)for(M=0;M<Z;++M)L>0&&(Q[R+M]={level:L});I=-1;break;case"covered-table-cell":if(y[1]!=="/")if(++I,S=lt(y[0],!1),ee=parseInt(S["number-columns-repeated"]||"1",10)||1,n.sheetStubs){for(;ee-- >0;)n.dense?(w["!data"][R]||(w["!data"][R]=[]),w["!data"][R][I]={t:"z"}):w[Rt({r:R,c:I})]={t:"z"},++I;--I}else I+=ee-1;E="",P=[];break;case"table-cell":case"":if(y[0].charAt(y[0].length-2)==="/")++I,S=lt(y[0],!1),ee=parseInt(S["number-columns-repeated"]||"1",10)||1,_={t:"z",v:null},S.formula&&n.cellFormula!=!1&&(_.f=B4(zt(S.formula))),S["style-name"]&&V[S["style-name"]]&&(_.z=V[S["style-name"]]),(S.||S["value-type"])=="string"&&(_.t="s",_.v=zt(S["string-value"]||""),n.dense?(w["!data"][R]||(w["!data"][R]=[]),w["!data"][R][I]=_):w[Ft(I)+Ut(R)]=_),I+=ee-1;else if(y[1]!=="/"){++I,E=N="",T=C=0,P=[],j=[],ee=1;var le=Z?R+Z-1:R;if(I>F.e.c&&(F.e.c=I),I<F.s.c&&(F.s.c=I),R<F.s.r&&(F.s.r=R),le>F.e.r&&(F.e.r=le),S=lt(y[0],!1),k=rL(y[0]),Ne=[],W={},_={t:S.||S["value-type"],v:null},S["style-name"]&&V[S["style-name"]]&&(_.z=V[S["style-name"]]),n.cellFormula)if(S.formula&&(S.formula=zt(S.formula)),S["number-matrix-columns-spanned"]&&S["number-matrix-rows-spanned"]&&(q=parseInt(S["number-matrix-rows-spanned"],10)||0,oe=parseInt(S["number-matrix-columns-spanned"],10)||0,te={s:{r:R,c:I},e:{r:R+q-1,c:I+oe-1}},_.F=Nt(te),ce.push([te,_.F])),S.formula)_.f=B4(S.formula);else for(M=0;M<ce.length;++M)R>=ce[M][0].s.r&&R<=ce[M][0].e.r&&I>=ce[M][0].s.c&&I<=ce[M][0].e.c&&(_.F=ce[M][1]);switch((S["number-columns-spanned"]||S["number-rows-spanned"])&&(q=parseInt(S["number-rows-spanned"]||"1",10)||1,oe=parseInt(S["number-columns-spanned"]||"1",10)||1,q*oe>1&&(te={s:{r:R,c:I},e:{r:R+q-1,c:I+oe-1}},J.push(te))),S["number-columns-repeated"]&&(ee=parseInt(S["number-columns-repeated"],10)),_.t){case"boolean":_.t="b",_.v=tr(S["boolean-value"])||+S["boolean-value"]>=1;break;case"float":_.t="n",_.v=parseFloat(S.value),n.cellDates&&_.z&&Ha(_.z)&&(_.v=Ji(_.v+(de.WBProps.date1904?1462:0)),_.t=typeof _.v=="number"?"n":"d");break;case"percentage":_.t="n",_.v=parseFloat(S.value);break;case"currency":_.t="n",_.v=parseFloat(S.value);break;case"date":_.t="d",_.v=Tr(S["date-value"],de.WBProps.date1904),n.cellDates||(_.t="n",_.v=Or(_.v,de.WBProps.date1904)),_.z||(_.z="m/d/yy");break;case"time":_.t="n",_.v=MM(S["time-value"])/86400,n.cellDates&&(_.v=Ji(_.v),_.t=typeof _.v=="number"?"n":"d"),_.z||(_.z="HH:MM:SS");break;case"number":_.t="n",_.v=parseFloat(S.);break;default:if(_.t==="string"||_.t==="text"||!_.t)_.t="s",S["string-value"]!=null&&(E=zt(S["string-value"]),P=[]);else throw new Error("Unsupported value type "+_.t)}}else{if(X=!1,k["calcext:value-type"]=="error"&&dn[E]!=null&&(_.t="e",_.w=E,_.v=dn[E]),_.t==="s"&&(_.v=E||"",P.length&&(_.R=P),X=T==0),Te.Target&&(_.l=Te),Ne.length>0&&(_.c=Ne,Ne=[]),E&&n.cellText!==!1&&(_.w=E),X&&(_.t="z",delete _.v),(!X||n.sheetStubs)&&!(n.sheetRows&&n.sheetRows<=R))for(var ye=0;ye<Z;++ye){if(ee=parseInt(S["number-columns-repeated"]||"1",10),n.dense)for(w["!data"][R+ye]||(w["!data"][R+ye]=[]),w["!data"][R+ye][I]=ye==0?_:dr(_);--ee>0;)w["!data"][R+ye][I+ee]=dr(_);else for(w[Rt({r:R+ye,c:I})]=_;--ee>0;)w[Rt({r:R+ye,c:I+ee})]=dr(_);F.e.c<=I&&(F.e.c=I)}ee=parseInt(S["number-columns-repeated"]||"1",10),I+=ee-1,ee=0,_={},E="",P=[]}Te={};break;case"document":case"document-content":case"":case"spreadsheet":case"":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(y[1]==="/"){if((s=i.pop())[0]!==y[3])throw"Bad state: "+s}else y[0].charAt(y[0].length-2)!=="/"&&i.push([y[3],!0]);break;case"annotation":if(y[1]==="/"){if((s=i.pop())[0]!==y[3])throw"Bad state: "+s;W.t=E,P.length&&(W.R=P),W.a=z,Ne.push(W),E=N,T=C,P=j}else if(y[0].charAt(y[0].length-2)!=="/"){i.push([y[3],!1]);var Ce=lt(y[0],!0);Ce.display&&tr(Ce.display)||(Ne.hidden=!0),N=E,C=T,j=P,E="",T=0,P=[]}z="",G=0;break;case"creator":y[1]==="/"?z=a.slice(G,y.index):G=y.index+y[0].length;break;case"meta":case"":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(y[1]==="/"){if((s=i.pop())[0]!==y[3])throw"Bad state: "+s}else y[0].charAt(y[0].length-2)!=="/"&&i.push([y[3],!1]);E="",T=0,P=[];break;case"scientific-number":case"currency-symbol":case"fill-character":break;case"text-style":case"boolean-style":case"number-style":case"currency-style":case"percentage-style":case"date-style":case"time-style":if(y[1]==="/"){var ze=Hr.lastIndex;nI(a.slice(c,Hr.lastIndex),t,H),Hr.lastIndex=ze}else y[0].charAt(y[0].length-2)!=="/"&&(c=Hr.lastIndex-y[0].length);break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":{var Ze=lt(y[0],!1);Ze.family=="table-cell"&&H[Ze["data-style-name"]]&&(V[Ze.name]=H[Ze["data-style-name"]])}break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":break;case"boolean":break;case"text":if(y[0].slice(-2)==="/>")break;if(y[1]==="/")switch(i[i.length-1][0]){case"number-style":case"date-style":case"time-style":u+=a.slice(d,y.index);break}else d=y.index+y[0].length;break;case"named-range":o=lt(y[0],!1),Ie=V1(o["cell-range-address"]);var rt={Name:o.name,Ref:Ie[0]+"!"+Ie[1]};ie&&(rt.Sheet=x.length),de.Names.push(rt);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":switch(o=lt(y[0],!1),o["date-value"]){case"1904-01-01":de.WBProps.date1904=!0;break}break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"":if(["master-styles"].indexOf(i[i.length-1][0])>-1)break;if(y[1]==="/"&&(!S||!S["string-value"])){var xt=PV(a.slice(T,y.index));E=(E.length>0?E+`
`:"")+xt[0]}else y[0].slice(-2)=="/>"?E+=`
`:(lt(y[0],!1),T=y.index+y[0].length);break;case"s":break;case"database-range":if(y[1]==="/")break;try{Ie=V1(lt(y[0])["target-range-address"]),v[Ie[0]]["!autofilter"]={ref:Ie[1]}}catch{}break;case"date":break;case"object":break;case"title":case"":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"filter-set-item":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(y[1]!=="/"){if(Te=lt(y[0],!1),!Te.href)break;Te.Target=zt(Te.href),delete Te.href,Te.Target.charAt(0)=="#"&&Te.Target.indexOf(".")>-1?(Ie=V1(Te.Target.slice(1)),Te.Target="#"+Ie[0]+"!"+Ie[1]):Te.Target.match(/^\.\.[\\\/]/)&&(Te.Target=Te.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(y[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case":":case":":break;default:if(n.WTF)throw new Error(y)}}var mt={Sheets:v,SheetNames:x,Workbook:de};return n.bookSheets&&delete mt.Sheets,mt}function H4(e,t){t=t||{},Da(e,"META-INF/manifest.xml")&&XL(Wr(e,"META-INF/manifest.xml"),t);var r=Wn(e,"styles.xml"),n=r&&nI(ir(r)),a=Wn(e,"content.xml");if(!a)throw new Error("Missing content.xml in ODS / UOF file");var i=aI(ir(a),t,n);return Da(e,"meta.xml")&&(i.Props=Z6(Wr(e,"meta.xml"))),i.bookType="ods",i}function q4(e,t){var r=aI(e,t);return r.bookType="fods",r}var IV=(function(){var e=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),t="<office:document-styles "+Uu({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+e+"</office:document-styles>";return function(){return $r+t}})();function FV(e,t){var r="number",n="",a={"style:name":t},i="",s=0;e=e.replace(/"[$]"/g,"$");e:{if(e.indexOf(";")>-1&&(console.error("Unsupported ODS Style Map exported.  Using first branch of "+e),e=e.slice(0,e.indexOf(";"))),e=="@"){r="text",n="<number:text-content/>";break e}if(e.indexOf(/\$/)>-1&&(r="currency"),e[s]=='"'){for(i="";e[++s]!='"'||e[++s]=='"';)i+=e[s];--s,e[s+1]=="*"?(s++,n+="<number:fill-character>"+Pt(i.replace(/""/g,'"'))+"</number:fill-character>"):n+="<number:text>"+Pt(i.replace(/""/g,'"'))+"</number:text>",e=e.slice(s+1),s=0}var o=e.match(/# (\?+)\/(\?+)/);if(o){n+=Ge("number:fraction",null,{"number:min-integer-digits":0,"number:min-numerator-digits":o[1].length,"number:max-denominator-value":Math.max(+o[1].replace(/./g,"9"),+o[2].replace(/./g,"9"))});break e}if(o=e.match(/# (\?+)\/(\d+)/)){n+=Ge("number:fraction",null,{"number:min-integer-digits":0,"number:min-numerator-digits":o[1].length,"number:denominator-value":+o[2]});break e}if(o=e.match(/\b(\d+)(|\.\d+)%/)){r="percentage",n+=Ge("number:number",null,{"number:decimal-places":o[2]&&o.length-1||0,"number:min-decimal-places":o[2]&&o.length-1||0,"number:min-integer-digits":o[1].length})+"<number:text>%</number:text>";break e}var c=!1;if(["y","m","d"].indexOf(e[0])>-1){r="date";t:for(;s<e.length;++s)switch(i=e[s].toLowerCase()){case"h":case"s":c=!0,--s;break t;case"m":r:for(var u=s+1;u<e.length;++u)switch(e[u]){case"y":case"d":break r;case"h":case"s":c=!0,--s;break t}case"y":case"d":for(;(e[++s]||"").toLowerCase()==i[0];)i+=i[0];switch(--s,i){case"y":case"yy":n+="<number:year/>";break;case"yyy":case"yyyy":n+='<number:year number:style="long"/>';break;case"mmmmm":console.error("ODS has no equivalent of format |mmmmm|");case"m":case"mm":case"mmm":case"mmmm":n+='<number:month number:style="'+(i.length%2?"short":"long")+'" number:textual="'+(i.length>=3?"true":"false")+'"/>';break;case"d":case"dd":n+='<number:day number:style="'+(i.length%2?"short":"long")+'"/>';break;case"ddd":case"dddd":n+='<number:day-of-week number:style="'+(i.length%2?"short":"long")+'"/>';break}break;case'"':for(;e[++s]!='"'||e[++s]=='"';)i+=e[s];--s,n+="<number:text>"+Pt(i.slice(1).replace(/""/g,'"'))+"</number:text>";break;case"\\":i=e[++s],n+="<number:text>"+Pt(i)+"</number:text>";break;case"/":case":":n+="<number:text>"+Pt(i)+"</number:text>";break;default:console.error("unrecognized character "+i+" in ODF format "+e)}if(!c)break e;e=e.slice(s+1),s=0}if(e.match(/^\[?[hms]/)){for(r=="number"&&(r="time"),e.match(/\[/)&&(e=e.replace(/[\[\]]/g,""),a["number:truncate-on-overflow"]="false");s<e.length;++s)switch(i=e[s].toLowerCase()){case"h":case"m":case"s":for(;(e[++s]||"").toLowerCase()==i[0];)i+=i[0];switch(--s,i){case"h":case"hh":n+='<number:hours number:style="'+(i.length%2?"short":"long")+'"/>';break;case"m":case"mm":n+='<number:minutes number:style="'+(i.length%2?"short":"long")+'"/>';break;case"s":case"ss":if(e[s+1]==".")do i+=e[s+1],++s;while(e[s+1]=="0");n+='<number:seconds number:style="'+(i.match("ss")?"long":"short")+'"'+(i.match(/\./)?' number:decimal-places="'+(i.match(/0+/)||[""])[0].length+'"':"")+"/>";break}break;case'"':for(;e[++s]!='"'||e[++s]=='"';)i+=e[s];--s,n+="<number:text>"+Pt(i.slice(1).replace(/""/g,'"'))+"</number:text>";break;case"/":case":":n+="<number:text>"+Pt(i)+"</number:text>";break;case"a":if(e.slice(s,s+3).toLowerCase()=="a/p"){n+="<number:am-pm/>",s+=2;break}if(e.slice(s,s+5).toLowerCase()=="am/pm"){n+="<number:am-pm/>",s+=4;break}default:console.error("unrecognized character "+i+" in ODF format "+e)}break e}if(e.indexOf(/\$/)>-1&&(r="currency"),e[0]=="$"&&(n+='<number:currency-symbol number:language="en" number:country="US">$</number:currency-symbol>',e=e.slice(1),s=0),s=0,e[s]=='"'){for(;e[++s]!='"'||e[++s]=='"';)i+=e[s];--s,e[s+1]=="*"?(s++,n+="<number:fill-character>"+Pt(i.replace(/""/g,'"'))+"</number:fill-character>"):n+="<number:text>"+Pt(i.replace(/""/g,'"'))+"</number:text>",e=e.slice(s+1),s=0}var d=e.match(/([#0][0#,]*)(\.[0#]*|)(E[+]?0*|)/i);if(!d||!d[0])console.error("Could not find numeric part of "+e);else{var h=d[1].replace(/,/g,"");n+="<number:"+(d[3]?"scientific-":"")+'number number:min-integer-digits="'+(h.indexOf("0")==-1?"0":h.length-h.indexOf("0"))+'"'+(d[0].indexOf(",")>-1?' number:grouping="true"':"")+(d[2]&&' number:decimal-places="'+(d[2].length-1)+'"'||' number:decimal-places="0"')+(d[3]&&d[3].indexOf("+")>-1?' number:forced-exponent-sign="true"':"")+(d[3]?' number:min-exponent-digits="'+d[3].match(/0+/)[0].length+'"':"")+"></number:"+(d[3]?"scientific-":"")+"number>",s=d.index+d[0].length}if(e[s]=='"'){for(i="";e[++s]!='"'||e[++s]=='"';)i+=e[s];--s,n+="<number:text>"+Pt(i.replace(/""/g,'"'))+"</number:text>"}}return n?Ge("number:"+r+"-style",n,a):(console.error("Could not generate ODS number format for |"+e+"|"),"")}function V4(e,t,r){for(var n=[],a=0;a<e.length;++a){var i=e[a];i&&i.Sheet==(r==-1?null:r)&&n.push(i)}return n.length?`      <table:named-expressions>
`+n.map(function(s){var o=(r==-1?"$":"")+UP(s.Ref);return"        "+Ge("table:named-range",null,{"table:name":s.Name,"table:cell-range-address":o,"table:base-cell-address":o.replace(/[\.][^\.]*$/,".$A$1")})}).join(`
`)+`
      </table:named-expressions>
`:""}var X4=(function(){var e=function(a,i){return Pt(a).replace(/  +/g,function(s){return'<text:s text:c="'+s.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},t=`          <table:table-cell />
`,r=function(a,i,s,o,c,u){var d=[];d.push('      <table:table table:name="'+Pt(i.SheetNames[s])+`" table:style-name="ta1">
`);var h=0,p=0,v=hn(a["!ref"]||"A1"),x=a["!merges"]||[],w=0,y=a["!data"]!=null;if(a["!cols"])for(p=0;p<=v.e.c;++p)d.push("        <table:table-column"+(a["!cols"][p]?' table:style-name="co'+a["!cols"][p].ods+'"':"")+`></table:table-column>
`);var _="",S=a["!rows"]||[];for(h=0;h<v.s.r;++h)_=S[h]?' table:style-name="ro'+S[h].ods+'"':"",d.push("        <table:table-row"+_+`></table:table-row>
`);for(;h<=v.e.r;++h){for(_=S[h]?' table:style-name="ro'+S[h].ods+'"':"",d.push("        <table:table-row"+_+`>
`),p=0;p<v.s.c;++p)d.push(t);for(;p<=v.e.c;++p){var k=!1,E={},T="";for(w=0;w!=x.length;++w)if(!(x[w].s.c>p)&&!(x[w].s.r>h)&&!(x[w].e.c<p)&&!(x[w].e.r<h)){(x[w].s.c!=p||x[w].s.r!=h)&&(k=!0),E["table:number-columns-spanned"]=x[w].e.c-x[w].s.c+1,E["table:number-rows-spanned"]=x[w].e.r-x[w].s.r+1;break}if(k){d.push(`          <table:covered-table-cell/>
`);continue}var N=Rt({r:h,c:p}),C=y?(a["!data"][h]||[])[p]:a[N];if(C&&C.f&&(E["table:formula"]=Pt(nW(C.f)),C.F&&C.F.slice(0,N.length)==N)){var P=hn(C.F);E["table:number-matrix-columns-spanned"]=P.e.c-P.s.c+1,E["table:number-matrix-rows-spanned"]=P.e.r-P.s.r+1}if(!C){d.push(t);continue}switch(C.t){case"b":T=C.v?"TRUE":"FALSE",E["office:value-type"]="boolean",E["office:boolean-value"]=C.v?"true":"false";break;case"n":isFinite(C.v)?(T=C.w||String(C.v||0),E["office:value-type"]="float",E["office:value"]=C.v||0):(isNaN(C.v)?(T="#NUM!",E["table:formula"]="of:=#NUM!"):(T="#DIV/0!",E["table:formula"]="of:="+(C.v<0?"-":"")+"1/0"),E["office:string-value"]="",E["office:value-type"]="string",E["calcext:value-type"]="error");break;case"s":case"str":T=C.v==null?"":C.v,E["office:value-type"]="string";break;case"d":T=C.w||Tr(C.v,u).toISOString(),E["office:value-type"]="date",E["office:date-value"]=Tr(C.v,u).toISOString(),E["table:style-name"]="ce1";break;default:d.push(t);continue}var j=e(T);if(C.l&&C.l.Target){var R=C.l.Target;R=R.charAt(0)=="#"?"#"+UP(R.slice(1)):R,R.charAt(0)!="#"&&!R.match(/^\w+:/)&&(R="../"+R),j=Ge("text:a",j,{"xlink:href":R.replace(/&/g,"&amp;")})}c[C.z]&&(E["table:style-name"]="ce"+c[C.z].slice(1));var I=Ge("text:p",j,{});if(C.c){for(var F="",L="",H={},V=0;V<C.c.length;++V)!F&&C.c[V].a&&(F=C.c[V].a),L+="<text:p>"+e(C.c[V].t)+"</text:p>";C.c.hidden||(H["office:display"]=!0),I=Ge("office:annotation",L,H)+I}d.push("          "+Ge("table:table-cell",I,E)+`
`)}d.push(`        </table:table-row>
`)}return(i.Workbook||{}).Names&&d.push(V4(i.Workbook.Names,i.SheetNames,s)),d.push(`      </table:table>
`),d.join("")},n=function(a,i){a.push(` <office:automatic-styles>
`);var s=0;i.SheetNames.map(function(d){return i.Sheets[d]}).forEach(function(d){if(d&&d["!cols"]){for(var h=0;h<d["!cols"].length;++h)if(d["!cols"][h]){var p=d["!cols"][h];if(p.width==null&&p.wpx==null&&p.wch==null)continue;qs(p),p.ods=s;var v=d["!cols"][h].wpx+"px";a.push('  <style:style style:name="co'+s+`" style:family="table-column">
`),a.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+v+`"/>
`),a.push(`  </style:style>
`),++s}}});var o=0;i.SheetNames.map(function(d){return i.Sheets[d]}).forEach(function(d){if(d&&d["!rows"]){for(var h=0;h<d["!rows"].length;++h)if(d["!rows"][h]){d["!rows"][h].ods=o;var p=d["!rows"][h].hpx+"px";a.push('  <style:style style:name="ro'+o+`" style:family="table-row">
`),a.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+p+`"/>
`),a.push(`  </style:style>
`),++o}}}),a.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),a.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),a.push(`  </style:style>
`),a.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),a.push(`   <number:month number:style="long"/>
`),a.push(`   <number:text>/</number:text>
`),a.push(`   <number:day number:style="long"/>
`),a.push(`   <number:text>/</number:text>
`),a.push(`   <number:year/>
`),a.push(`  </number:date-style>
`);var c={},u=69;return i.SheetNames.map(function(d){return i.Sheets[d]}).forEach(function(d){if(d){var h=d["!data"]!=null;if(d["!ref"])for(var p=hn(d["!ref"]),v=0;v<=p.e.r;++v)for(var x=0;x<=p.e.c;++x){var w=h?(d["!data"][v]||[])[x]:d[Rt({r:v,c:x})];if(!(!w||!w.z||w.z.toLowerCase()=="general")&&!c[w.z]){var y=FV(w.z,"N"+u);y&&(c[w.z]="N"+u,++u,a.push(y+`
`))}}}}),a.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),_r(c).forEach(function(d){a.push('<style:style style:name="ce'+c[d].slice(1)+'" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="'+c[d]+`"/>
`)}),a.push(` </office:automatic-styles>
`),c};return function(i,s){var o=[$r],c=Uu({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),u=Uu({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});s.bookType=="fods"?(o.push("<office:document"+c+u+`>
`),o.push(Y6().replace(/<office:document-meta[^<>]*?>/,"").replace(/<\/office:document-meta>/,"")+`
`)):o.push("<office:document-content"+c+`>
`);var d=n(o,i);o.push(`  <office:body>
`),o.push(`    <office:spreadsheet>
`),((i.Workbook||{}).WBProps||{}).date1904&&o.push(`      <table:calculation-settings table:case-sensitive="false" table:search-criteria-must-apply-to-whole-cell="true" table:use-wildcards="true" table:use-regular-expressions="false" table:automatic-find-labels="false">
        <table:null-date table:date-value="1904-01-01"/>
      </table:calculation-settings>
`);for(var h=0;h!=i.SheetNames.length;++h)o.push(r(i.Sheets[i.SheetNames[h]],i,h,s,d,((i.Workbook||{}).WBProps||{}).date1904));return(i.Workbook||{}).Names&&o.push(V4(i.Workbook.Names,i.SheetNames,-1)),o.push(`    </office:spreadsheet>
`),o.push(`  </office:body>
`),s.bookType=="fods"?o.push("</office:document>"):o.push("</office:document-content>"),o.join("")}})();function iI(e,t){if(t.bookType=="fods")return X4(e,t);var r=cb(),n="",a=[],i=[];return n="mimetype",Ct(r,n,"application/vnd.oasis.opendocument.spreadsheet"),n="content.xml",Ct(r,n,X4(e,t)),a.push([n,"text/xml"]),i.push([n,"ContentFile"]),n="styles.xml",Ct(r,n,IV(e,t)),a.push([n,"text/xml"]),i.push([n,"StylesFile"]),n="meta.xml",Ct(r,n,$r+Y6()),a.push([n,"text/xml"]),i.push([n,"MetadataFile"]),n="manifest.rdf",Ct(r,n,YL(i)),a.push([n,"application/rdf+xml"]),n="META-INF/manifest.xml",Ct(r,n,GL(a)),r}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */var Br=(function(){try{return typeof Uint8Array>"u"||typeof Uint8Array.prototype.subarray>"u"?"slice":typeof Buffer<"u"?typeof Buffer.prototype.subarray>"u"?"slice":(typeof Buffer.from=="function"?Buffer.from([72,62]):new Buffer([72,62]))instanceof Uint8Array?"subarray":"slice":"subarray"}catch{return"slice"}})();function ss(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function ci(e){return typeof TextDecoder<"u"?new TextDecoder().decode(e):ir(Pi(e))}function $n(e){return typeof TextEncoder<"u"?new TextEncoder().encode(e):zn(ki(e))}function Xs(e){for(var t=0,r=0;r<e.length;++r)t+=e[r].length;var n=new Uint8Array(t),a=0;for(r=0;r<e.length;++r){var i=e[r],s=i.length;if(s<250)for(var o=0;o<s;++o)n[a++]=i[o];else n.set(i,a),a+=s}return n}function Nu(e){return e-=e>>1&1431655765,e=(e&858993459)+(e>>2&858993459),(e+(e>>4)&252645135)*16843009>>>24}function DV(e,t){for(var r=(e[t+15]&127)<<7|e[t+14]>>1,n=e[t+14]&1,a=t+13;a>=t;--a)n=n*256+e[a];return(e[t+15]&128?-n:n)*Math.pow(10,r-6176)}function jV(e,t,r){var n=Math.floor(r==0?0:Math.LOG10E*Math.log(Math.abs(r)))+6176-16,a=r/Math.pow(10,n-6176);e[t+15]|=n>>7,e[t+14]|=(n&127)<<1;for(var i=0;a>=1;++i,a/=256)e[t+i]=a&255;e[t+15]|=r>=0?0:128}function Zu(e,t){var r=t.l,n=e[r]&127;e:if(e[r++]>=128&&(n|=(e[r]&127)<<7,e[r++]<128||(n|=(e[r]&127)<<14,e[r++]<128)||(n|=(e[r]&127)<<21,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,28),++r,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,35),++r,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,42),++r,e[r++]<128)))break e;return t.l=r,n}function ht(e){var t=new Uint8Array(7);t[0]=e&127;var r=1;e:if(e>127){if(t[r-1]|=128,t[r]=e>>7&127,++r,e<=16383||(t[r-1]|=128,t[r]=e>>14&127,++r,e<=2097151)||(t[r-1]|=128,t[r]=e>>21&127,++r,e<=268435455)||(t[r-1]|=128,t[r]=e/256>>>21&127,++r,e<=34359738367)||(t[r-1]|=128,t[r]=e/65536>>>21&127,++r,e<=4398046511103))break e;t[r-1]|=128,t[r]=e/16777216>>>21&127,++r}return t[Br](0,r)}function sI(e){for(var t={l:0},r=[];t.l<e.length;)r.push(Zu(e,t));return r}function oI(e){return Xs(e.map(function(t){return ht(t)}))}function Ot(e){var t=0,r=e[t]&127;return e[t++]<128||(r|=(e[t]&127)<<7,e[t++]<128)||(r|=(e[t]&127)<<14,e[t++]<128)||(r|=(e[t]&127)<<21,e[t++]<128)||(r|=(e[t]&15)<<28),r}function Ye(e){for(var t=[],r={l:0};r.l<e.length;){var n=r.l,a=Zu(e,r),i=a&7;a=a/8|0;var s,o=r.l;switch(i){case 0:{for(;e[o++]>=128;);s=e[Br](r.l,o),r.l=o}break;case 1:s=e[Br](o,o+8),r.l=o+8;break;case 2:{var c=Zu(e,r);s=e[Br](r.l,r.l+c),r.l+=c}break;case 5:s=e[Br](o,o+4),r.l=o+4;break;default:throw new Error("PB Type ".concat(i," for Field ").concat(a," at offset ").concat(n))}var u={data:s,type:i};t[a]==null&&(t[a]=[]),t[a].push(u)}return t}function gt(e){var t=[];return e.forEach(function(r,n){n!=0&&r.forEach(function(a){a.data&&(t.push(ht(n*8+a.type)),a.type==2&&t.push(ht(a.data.length)),t.push(a.data))})}),Xs(t)}function Gs(e,t){return(e==null?void 0:e.map(function(r){return t(r.data)}))||[]}function Qu(e){for(var t,r=[],n={l:0};n.l<e.length;){var a=Zu(e,n),i=Ye(e[Br](n.l,n.l+a));n.l+=a;var s={id:Ot(i[1][0].data),messages:[]};i[2].forEach(function(o){var c=Ye(o.data),u=Ot(c[3][0].data);s.messages.push({meta:c,data:e[Br](n.l,n.l+u)}),n.l+=u}),(t=i[3])!=null&&t[0]&&(s.merge=Ot(i[3][0].data)>>>0>0),r.push(s)}return r}function Ml(e){var t=[];return e.forEach(function(r){var n=[[],[{data:ht(r.id),type:0}],[]];r.merge!=null&&(n[3]=[{data:ht(+!!r.merge),type:0}]);var a=[];r.messages.forEach(function(s){a.push(s.data),s.meta[3]=[{type:0,data:ht(s.data.length)}],n[2].push({data:gt(s.meta),type:2})});var i=gt(n);t.push(ht(i.length)),t.push(i),a.forEach(function(s){return t.push(s)})}),Xs(t)}function RV(e,t){if(e!=0)throw new Error("Unexpected Snappy chunk type ".concat(e));for(var r={l:0},n=Zu(t,r),a=[],i=r.l;i<t.length;){var s=t[i]&3;if(s==0){var o=t[i++]>>2;if(o<60)++o;else{var c=o-59;o=t[i],c>1&&(o|=t[i+1]<<8),c>2&&(o|=t[i+2]<<16),c>3&&(o|=t[i+3]<<24),o>>>=0,o++,i+=c}a.push(t[Br](i,i+o)),i+=o;continue}else{var u=0,d=0;if(s==1?(d=(t[i]>>2&7)+4,u=(t[i++]&224)<<3,u|=t[i++]):(d=(t[i++]>>2)+1,s==2?(u=t[i]|t[i+1]<<8,i+=2):(u=(t[i]|t[i+1]<<8|t[i+2]<<16|t[i+3]<<24)>>>0,i+=4)),u==0)throw new Error("Invalid offset 0");for(var h=a.length-1,p=u;h>=0&&p>=a[h].length;)p-=a[h].length,--h;if(h<0)if(p==0)p=a[h=0].length;else throw new Error("Invalid offset beyond length");if(d<p)a.push(a[h][Br](a[h].length-p,a[h].length-p+d));else{for(p>0&&(a.push(a[h][Br](a[h].length-p)),d-=p),++h;d>=a[h].length;)a.push(a[h]),d-=a[h].length,++h;d&&a.push(a[h][Br](0,d))}a.length>25&&(a=[Xs(a)])}}for(var v=0,x=0;x<a.length;++x)v+=a[x].length;if(v!=n)throw new Error("Unexpected length: ".concat(v," != ").concat(n));return a}function Ju(e){Array.isArray(e)&&(e=new Uint8Array(e));for(var t=[],r=0;r<e.length;){var n=e[r++],a=e[r]|e[r+1]<<8|e[r+2]<<16;r+=3,t.push.apply(t,RV(n,e[Br](r,r+a))),r+=a}if(r!==e.length)throw new Error("data is not a valid framed stream!");return t.length==1?t[0]:Xs(t)}function Ll(e){for(var t=[],r=0;r<e.length;){var n=Math.min(e.length-r,268435455),a=new Uint8Array(4);t.push(a);var i=ht(n),s=i.length;t.push(i),n<=60?(s++,t.push(new Uint8Array([n-1<<2]))):n<=256?(s+=2,t.push(new Uint8Array([240,n-1&255]))):n<=65536?(s+=3,t.push(new Uint8Array([244,n-1&255,n-1>>8&255]))):n<=16777216?(s+=4,t.push(new Uint8Array([248,n-1&255,n-1>>8&255,n-1>>16&255]))):n<=4294967296&&(s+=5,t.push(new Uint8Array([252,n-1&255,n-1>>8&255,n-1>>16&255,n-1>>>24&255]))),t.push(e[Br](r,r+n)),s+=n,a[0]=0,a[1]=s&255,a[2]=s>>8&255,a[3]=s>>16&255,r+=n}return Xs(t)}var MV=function(){return{sst:[],rsst:[],ofmt:[],nfmt:[],fmla:[],ferr:[],cmnt:[]}};function lI(e,t,r,n,a){var i,s,o,c,u=t&255,d=t>>8,h=d>=5?a:n;e:if(r&(d>4?8:4)&&e.t=="n"&&u==7){var p=(i=h[7])!=null&&i[0]?Ot(h[7][0].data):-1;if(p==-1)break e;var v=(s=h[15])!=null&&s[0]?Ot(h[15][0].data):-1,x=(o=h[16])!=null&&o[0]?Ot(h[16][0].data):-1,w=(c=h[40])!=null&&c[0]?Ot(h[40][0].data):-1,y=e.v,_=y;t:if(w){if(y==0){v=x=2;break t}y>=604800?v=1:y>=86400?v=2:y>=3600?v=4:y>=60?v=8:y>=1?v=16:v=32,Math.floor(y)!=y?x=32:y%60?x=16:y%3600?x=8:y%86400?x=4:y%604800&&(x=2),x<v&&(x=v)}if(v==-1||x==-1)break e;var S=[],k=[];v==1&&(_=y/604800,x==1?k.push('d"d"'):(_|=0,y-=604800*_),S.push(_+(p==2?" week"+(_==1?"":"s"):p==1?"w":""))),v<=2&&x>=2&&(_=y/86400,x>2&&(_|=0,y-=86400*_),k.push('d"d"'),S.push(_+(p==2?" day"+(_==1?"":"s"):p==1?"d":""))),v<=4&&x>=4&&(_=y/3600,x>4&&(_|=0,y-=3600*_),k.push((v>=4?"[h]":"h")+'"h"'),S.push(_+(p==2?" hour"+(_==1?"":"s"):p==1?"h":""))),v<=8&&x>=8&&(_=y/60,x>8&&(_|=0,y-=60*_),k.push((v>=8?"[m]":"m")+'"m"'),p==0?S.push((v==8&&x==8||_>=10?"":"0")+_):S.push(_+(p==2?" minute"+(_==1?"":"s"):p==1?"m":""))),v<=16&&x>=16&&(_=y,x>16&&(_|=0,y-=_),k.push((v>=16?"[s]":"s")+'"s"'),p==0?S.push((x==16&&v==16||_>=10?"":"0")+_):S.push(_+(p==2?" second"+(_==1?"":"s"):p==1?"s":""))),x>=32&&(_=Math.round(1e3*y),v<32&&k.push('.000"ms"'),p==0?S.push((_>=100?"":_>=10?"0":"00")+_):S.push(_+(p==2?" millisecond"+(_==1?"":"s"):p==1?"ms":""))),e.w=S.join(p==0?":":" "),e.z=k.join(p==0?'":"':" "),p==0&&(e.w=e.w.replace(/:(\d\d\d)$/,".$1"))}}function LV(e,t,r,n){var a=ss(e),i=a.getUint32(4,!0),s=-1,o=-1,c=-1,u=NaN,d=0,h=new Date(Date.UTC(2001,0,1)),p=r>1?12:8;i&2&&(c=a.getUint32(p,!0),p+=4),p+=Nu(i&(r>1?3468:396))*4,i&512&&(s=a.getUint32(p,!0),p+=4),p+=Nu(i&(r>1?12288:4096))*4,i&16&&(o=a.getUint32(p,!0),p+=4),i&32&&(u=a.getFloat64(p,!0),p+=8),i&64&&(h.setTime(h.getTime()+(d=a.getFloat64(p,!0))*1e3),p+=8),r>1&&(i=a.getUint32(8,!0)>>>16,i&255&&(c==-1&&(c=a.getUint32(p,!0)),p+=4));var v,x=e[r>=4?1:2];switch(x){case 0:return;case 2:v={t:"n",v:u};break;case 3:v={t:"s",v:t.sst[o]};break;case 5:n!=null&&n.cellDates?v={t:"d",v:h}:v={t:"n",v:d/86400+35430,z:yt[14]};break;case 6:v={t:"b",v:u>0};break;case 7:v={t:"n",v:u};break;case 8:v={t:"e",v:0};break;case 9:if(s>-1){var w=t.rsst[s];v={t:"s",v:w.v},w.l&&(v.l={Target:w.l})}else throw new Error("Unsupported cell type ".concat(e[Br](0,4)));break;default:throw new Error("Unsupported cell type ".concat(e[Br](0,4)))}return c>-1&&lI(v,x|r<<8,i,t.ofmt[c],t.nfmt[c]),x==7&&(v.v/=86400),v}function BV(e,t,r){var n=ss(e);n.getUint32(4,!0);var a=n.getUint32(8,!0),i=12,s=-1,o=-1,c=-1,u=NaN,d=NaN,h=0,p=new Date(Date.UTC(2001,0,1));a&1&&(u=DV(e,i),i+=16),a&2&&(d=n.getFloat64(i,!0),i+=8),a&4&&(p.setTime(p.getTime()+(h=n.getFloat64(i,!0))*1e3),i+=8),a&8&&(o=n.getUint32(i,!0),i+=4),a&16&&(s=n.getUint32(i,!0),i+=4),i+=Nu(a&480)*4,a&512&&(n.getUint32(i,!0),i+=4),i+=Nu(a&1024)*4,a&2048&&(n.getUint32(i,!0),i+=4);var v,x=e[1];switch(x){case 0:v={t:"z"};break;case 2:v={t:"n",v:u};break;case 3:v={t:"s",v:t.sst[o]};break;case 5:r!=null&&r.cellDates?v={t:"d",v:p}:v={t:"n",v:h/86400+35430,z:yt[14]};break;case 6:v={t:"b",v:d>0};break;case 7:v={t:"n",v:d};break;case 8:v={t:"e",v:0};break;case 9:if(s>-1){var w=t.rsst[s];v={t:"s",v:w.v},w.l&&(v.l={Target:w.l})}else throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(a&31," : ").concat(e[Br](0,4)));break;case 10:v={t:"n",v:u};break;default:throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(a&31," : ").concat(e[Br](0,4)))}if(i+=Nu(a&4096)*4,a&516096&&(c==-1&&(c=n.getUint32(i,!0)),i+=4),a&524288){var y=n.getUint32(i,!0);i+=4,t.cmnt[y]&&(v.c=WV(t.cmnt[y]))}return c>-1&&lI(v,x|1280,a>>13,t.ofmt[c],t.nfmt[c]),x==7&&(v.v/=86400),v}function Z1(e,t){var r=new Uint8Array(32),n=ss(r),a=12,i=0;switch(r[0]=5,e.t){case"n":if(e.z&&Ha(e.z)){r[1]=5,n.setFloat64(a,(Ji(e.v+1462).getTime()-Date.UTC(2001,0,1))/1e3,!0),i|=4,a+=8;break}else r[1]=2,jV(r,a,e.v),i|=1,a+=16;break;case"b":r[1]=6,n.setFloat64(a,e.v?1:0,!0),i|=2,a+=8;break;case"s":{var s=e.v==null?"":String(e.v);if(e.l){var o=t.rsst.findIndex(function(u){var d;return u.v==s&&u.l==((d=e.l)==null?void 0:d.Target)});o==-1&&(t.rsst[o=t.rsst.length]={v:s,l:e.l.Target}),r[1]=9,n.setUint32(a,o,!0),i|=16,a+=4}else{var c=t.sst.indexOf(s);c==-1&&(t.sst[c=t.sst.length]=s),r[1]=3,n.setUint32(a,c,!0),i|=8,a+=4}}break;case"d":r[1]=5,n.setFloat64(a,(e.v.getTime()-Date.UTC(2001,0,1))/1e3,!0),i|=4,a+=8;break;case"z":r[1]=0;break;default:throw"unsupported cell type "+e.t}return e.c&&(t.cmnt.push(HV(e.c)),n.setUint32(a,t.cmnt.length-1,!0),i|=524288,a+=4),n.setUint32(8,i,!0),r[Br](0,a)}function Q1(e,t){var r=new Uint8Array(32),n=ss(r),a=12,i=0,s="";switch(r[0]=4,e.t){case"n":break;case"b":break;case"s":if(s=e.v==null?"":String(e.v),e.l){var o=t.rsst.findIndex(function(u){var d;return u.v==s&&u.l==((d=e.l)==null?void 0:d.Target)});o==-1&&(t.rsst[o=t.rsst.length]={v:s,l:e.l.Target}),r[1]=9,n.setUint32(a,o,!0),i|=512,a+=4}break;case"d":break;case"e":break;case"z":break;default:throw"unsupported cell type "+e.t}switch(e.c&&(n.setUint32(a,t.cmnt.length-1,!0),i|=4096,a+=4),e.t){case"n":r[1]=2,n.setFloat64(a,e.v,!0),i|=32,a+=8;break;case"b":r[1]=6,n.setFloat64(a,e.v?1:0,!0),i|=32,a+=8;break;case"s":if(s=e.v==null?"":String(e.v),!e.l){var c=t.sst.indexOf(s);c==-1&&(t.sst[c=t.sst.length]=s),r[1]=3,n.setUint32(a,c,!0),i|=16,a+=4}break;case"d":r[1]=5,n.setFloat64(a,(e.v.getTime()-Date.UTC(2001,0,1))/1e3,!0),i|=64,a+=8;break;case"z":r[1]=0;break;default:throw"unsupported cell type "+e.t}return n.setUint32(8,i,!0),r[Br](0,a)}function $V(e,t,r){switch(e[0]){case 0:case 1:case 2:case 3:case 4:return LV(e,t,e[0],r);case 5:return BV(e,t,r);default:throw new Error("Unsupported payload version ".concat(e[0]))}}function Bt(e){var t=Ye(e);return Ot(t[1][0].data)}function Cn(e){return gt([[],[{type:0,data:ht(e)}]])}function An(e,t){var r,n=(r=e.messages[0].meta[5])!=null&&r[0]?sI(e.messages[0].meta[5][0].data):[],a=n.indexOf(t);a==-1&&(n.push(t),e.messages[0].meta[5]=[{type:2,data:oI(n)}])}function Hi(e,t){var r,n=(r=e.messages[0].meta[5])!=null&&r[0]?sI(e.messages[0].meta[5][0].data):[];e.messages[0].meta[5]=[{type:2,data:oI(n.filter(function(a){return a!=t}))}]}function vo(e,t){var r=Ye(t.data),n=Ot(r[1][0].data),a=r[3],i=[];return(a||[]).forEach(function(s){var o,c,u=Ye(s.data);if(u[1]){var d=Ot(u[1][0].data)>>>0;switch(n){case 1:i[d]=ci(u[3][0].data);break;case 8:{var h=e[Bt(u[9][0].data)][0],p=Ye(h.data),v=e[Bt(p[1][0].data)][0],x=Ot(v.meta[1][0].data);if(x!=2001)throw new Error("2000 unexpected reference to ".concat(x));var w=Ye(v.data),y={v:w[3].map(function(k){return ci(k.data)}).join("")};i[d]=y;e:if((o=w==null?void 0:w[11])!=null&&o[0]){var _=(c=Ye(w[11][0].data))==null?void 0:c[1];if(!_)break e;_.forEach(function(k){var E,T,N,C=Ye(k.data);if((E=C[2])!=null&&E[0]){var P=e[Bt((T=C[2])==null?void 0:T[0].data)][0],j=Ot(P.meta[1][0].data);switch(j){case 2032:var R=Ye(P.data);(N=R==null?void 0:R[2])!=null&&N[0]&&!y.l&&(y.l=ci(R[2][0].data));break;case 2039:break;default:console.log("unrecognized ObjectAttribute type ".concat(j))}}})}}break;case 2:i[d]=Ye(u[6][0].data);break;case 3:i[d]=Ye(u[5][0].data);break;case 10:{var S=e[Bt(u[10][0].data)][0];i[d]=cI(e,S.data)}break;default:throw n}}}),i}function UV(e,t){var r,n,a,i,s,o,c,u,d,h,p,v,x,w,y=Ye(e),_=Ot(y[1][0].data)>>>0,S=Ot(y[2][0].data)>>>0,k=((n=(r=y[8])==null?void 0:r[0])==null?void 0:n.data)&&Ot(y[8][0].data)>0||!1,E,T;if((i=(a=y[7])==null?void 0:a[0])!=null&&i.data&&t!=0)E=(o=(s=y[7])==null?void 0:s[0])==null?void 0:o.data,T=(u=(c=y[6])==null?void 0:c[0])==null?void 0:u.data;else if((h=(d=y[4])==null?void 0:d[0])!=null&&h.data&&t!=1)E=(v=(p=y[4])==null?void 0:p[0])==null?void 0:v.data,T=(w=(x=y[3])==null?void 0:x[0])==null?void 0:w.data;else throw"NUMBERS Tile missing ".concat(t," cell storage");for(var N=k?4:1,C=ss(E),P=[],j=0;j<E.length/2;++j){var R=C.getUint16(j*2,!0);R<65535&&P.push([j,R])}if(P.length!=S)throw"Expected ".concat(S," cells, found ").concat(P.length);var I=[];for(j=0;j<P.length-1;++j)I[P[j][0]]=T[Br](P[j][1]*N,P[j+1][1]*N);return P.length>=1&&(I[P[P.length-1][0]]=T[Br](P[P.length-1][1]*N)),{R:_,cells:I}}function zV(e,t){var r,n=Ye(t.data),a=-1;(r=n==null?void 0:n[7])!=null&&r[0]&&(Ot(n[7][0].data)>>>0?a=1:a=0);var i=Gs(n[5],function(s){return UV(s,a)});return{nrows:Ot(n[4][0].data)>>>0,data:i.reduce(function(s,o){return s[o.R]||(s[o.R]=[]),o.cells.forEach(function(c,u){if(s[o.R][u])throw new Error("Duplicate cell r=".concat(o.R," c=").concat(u));s[o.R][u]=c}),s},[])}}function cI(e,t){var r,n,a,i,s,o,c,u,d,h,p={t:"",a:""},v=Ye(t);if((n=(r=v==null?void 0:v[1])==null?void 0:r[0])!=null&&n.data&&(p.t=ci((i=(a=v==null?void 0:v[1])==null?void 0:a[0])==null?void 0:i.data)||""),(o=(s=v==null?void 0:v[3])==null?void 0:s[0])!=null&&o.data){var x=e[Bt((u=(c=v==null?void 0:v[3])==null?void 0:c[0])==null?void 0:u.data)][0],w=Ye(x.data);(h=(d=w[1])==null?void 0:d[0])!=null&&h.data&&(p.a=ci(w[1][0].data))}return v!=null&&v[4]&&(p.replies=[],v[4].forEach(function(y){var _=e[Bt(y.data)][0];p.replies.push(cI(e,_.data))})),p}function WV(e){var t=[];return t.push({t:e.t||"",a:e.a,T:e.replies&&e.replies.length>0}),e.replies&&e.replies.forEach(function(r){t.push({t:r.t||"",a:r.a,T:!0})}),t}function HV(e){for(var t={a:"",t:"",replies:[]},r=0;r<e.length;++r)r==0?(t.a=e[r].a,t.t=e[r].t):t.replies.push({a:e[r].a,t:e[r].t});return t}function qV(e,t,r,n){var a,i,s,o,c,u,d,h,p,v,x,w,y,_,S=Ye(t.data),k={s:{r:0,c:0},e:{r:0,c:0}};if(k.e.r=(Ot(S[6][0].data)>>>0)-1,k.e.r<0)throw new Error("Invalid row varint ".concat(S[6][0].data));if(k.e.c=(Ot(S[7][0].data)>>>0)-1,k.e.c<0)throw new Error("Invalid col varint ".concat(S[7][0].data));r["!ref"]=Nt(k);var E=r["!data"]!=null,T=r,N=Ye(S[4][0].data),C=MV();(a=N[4])!=null&&a[0]&&(C.sst=vo(e,e[Bt(N[4][0].data)][0])),(i=N[6])!=null&&i[0]&&(C.fmla=vo(e,e[Bt(N[6][0].data)][0])),(s=N[11])!=null&&s[0]&&(C.ofmt=vo(e,e[Bt(N[11][0].data)][0])),(o=N[12])!=null&&o[0]&&(C.ferr=vo(e,e[Bt(N[12][0].data)][0])),(c=N[17])!=null&&c[0]&&(C.rsst=vo(e,e[Bt(N[17][0].data)][0])),(u=N[19])!=null&&u[0]&&(C.cmnt=vo(e,e[Bt(N[19][0].data)][0])),(d=N[22])!=null&&d[0]&&(C.nfmt=vo(e,e[Bt(N[22][0].data)][0]));var P=Ye(N[3][0].data),j=0;if(!((h=N[9])!=null&&h[0]))throw"NUMBERS file missing row tree";var R=Ye(N[9][0].data)[1].map(function(V){return Ye(V.data)});if(R.forEach(function(V){j=Ot(V[1][0].data);var J=Ot(V[2][0].data),te=P[1][J];if(!te)throw"NUMBERS missing tile "+J;var q=Ye(te.data),oe=e[Bt(q[2][0].data)][0],Q=Ot(oe.meta[1][0].data);if(Q!=6002)throw new Error("6001 unexpected reference to ".concat(Q));var Z=zV(e,oe);Z.data.forEach(function(ee,ce){ee.forEach(function(de,Te){var Ie=$V(de,C,n);Ie&&(E?(T["!data"][j+ce]||(T["!data"][j+ce]=[]),T["!data"][j+ce][Te]=Ie):r[Ft(Te)+Ut(j+ce)]=Ie)})}),j+=Z.nrows}),(p=N[13])!=null&&p[0]){var I=e[Bt(N[13][0].data)][0],F=Ot(I.meta[1][0].data);if(F!=6144)throw new Error("Expected merge type 6144, found ".concat(F));r["!merges"]=(v=Ye(I.data))==null?void 0:v[1].map(function(V){var J=Ye(V.data),te=ss(Ye(J[1][0].data)[1][0].data),q=ss(Ye(J[2][0].data)[1][0].data);return{s:{r:te.getUint16(0,!0),c:te.getUint16(2,!0)},e:{r:te.getUint16(0,!0)+q.getUint16(0,!0)-1,c:te.getUint16(2,!0)+q.getUint16(2,!0)-1}}})}if(!((x=r["!merges"])!=null&&x.length)&&((w=S[47])!=null&&w[0])){var L=Ye(S[47][0].data);if((y=L[2])!=null&&y[0]){var H=Ye(L[2][0].data);(_=H[3])!=null&&_[0]&&(r["!merges"]=Gs(H[3],function(V){var J,te,q,oe,Q,Z=Ye(V),ee=Ye(Z[2][0].data),ce=Ye(ee[1][0].data);if((J=ce[1])!=null&&J[0]){var de=Ye(ce[1][0].data),Te=Ot(de[1][0].data);if(Te==67){var Ie=Ye(de[40][0].data);if(!(!((te=Ie[3])!=null&&te[0])||!((q=Ie[4])!=null&&q[0]))){var Ne=Ye(Ie[3][0].data),W=Ye(Ie[4][0].data),z=Ot(Ne[1][0].data),G=(oe=Ne[2])!=null&&oe[0]?Ot(Ne[2][0].data):z,X=Ot(W[1][0].data),ie=(Q=W[2])!=null&&Q[0]?Ot(W[2][0].data):X;return{s:{r:X,c:z},e:{r:ie,c:G}}}}}}).filter(function(V){return V!=null}))}}}function VV(e,t,r){var n=Ye(t.data),a={"!ref":"A1"};r!=null&&r.dense&&(a["!data"]=[]);var i=e[Bt(n[2][0].data)],s=Ot(i[0].meta[1][0].data);if(s!=6001)throw new Error("6000 unexpected reference to ".concat(s));return qV(e,i[0],a,r),a}function XV(e,t,r){var n,a=Ye(t.data),i={name:(n=a[1])!=null&&n[0]?ci(a[1][0].data):"",sheets:[]},s=Gs(a[2],Bt);return s.forEach(function(o){e[o].forEach(function(c){var u=Ot(c.meta[1][0].data);u==6e3&&i.sheets.push(VV(e,c,r))})}),i}function GV(e,t,r){var n,a=jb();a.Workbook={WBProps:{date1904:!0}};var i=Ye(t.data);if((n=i[2])!=null&&n[0])throw new Error("Keynote presentations are not supported");var s=Gs(i[1],Bt);if(s.forEach(function(o){e[o].forEach(function(c){var u=Ot(c.meta[1][0].data);if(u==2){var d=XV(e,c,r);d.sheets.forEach(function(h,p){Kf(a,h,p==0?d.name:d.name+"_"+p,!0)})}})}),a.SheetNames.length==0)throw new Error("Empty NUMBERS file");return a.bookType="numbers",a}function J1(e,t){var r,n,a,i,s,o,c,u={},d=[];if(e.FullPaths.forEach(function(p){if(p.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),e.FileIndex.forEach(function(p){if(p.name.match(/\.iwa$/)&&p.content[0]==0){var v;try{v=Ju(p.content)}catch(w){return console.log("?? "+p.content.length+" "+(w.message||w))}var x;try{x=Qu(v)}catch(w){return console.log("## "+(w.message||w))}x.forEach(function(w){u[w.id]=w.messages,d.push(w.id)})}}),!d.length)throw new Error("File has no messages");if((a=(n=(r=u==null?void 0:u[1])==null?void 0:r[0].meta)==null?void 0:n[1])!=null&&a[0].data&&Ot(u[1][0].meta[1][0].data)==1e4)throw new Error("Pages documents are not supported");var h=((c=(o=(s=(i=u==null?void 0:u[1])==null?void 0:i[0])==null?void 0:s.meta)==null?void 0:o[1])==null?void 0:c[0].data)&&Ot(u[1][0].meta[1][0].data)==1&&u[1][0];if(h||d.forEach(function(p){u[p].forEach(function(v){var x=Ot(v.meta[1][0].data)>>>0;if(x==1)if(!h)h=v;else throw new Error("Document has multiple roots")})}),!h)throw new Error("Cannot find Document root");return GV(u,h,t)}function KV(e,t,r){var n,a,i,s=[[],[{type:0,data:ht(0)}],[{type:0,data:ht(0)}],[{type:2,data:new Uint8Array([])}],[{type:2,data:new Uint8Array(Array.from({length:510},function(){return 255}))}],[{type:0,data:ht(5)}],[{type:2,data:new Uint8Array([])}],[{type:2,data:new Uint8Array(Array.from({length:510},function(){return 255}))}],[{type:0,data:ht(1)}]];if(!((n=s[6])!=null&&n[0])||!((a=s[7])!=null&&a[0]))throw"Mutation only works on post-BNC storages!";var o=0;if(s[7][0].data.length<2*e.length){var c=new Uint8Array(2*e.length);c.set(s[7][0].data),s[7][0].data=c}if(s[4][0].data.length<2*e.length){var u=new Uint8Array(2*e.length);u.set(s[4][0].data),s[4][0].data=u}for(var d=ss(s[7][0].data),h=0,p=[],v=ss(s[4][0].data),x=0,w=[],y=4,_=0;_<e.length;++_){if(e[_]==null||e[_].t=="z"&&!((i=e[_].c)!=null&&i.length)||e[_].t=="e"){d.setUint16(_*2,65535,!0),v.setUint16(_*2,65535);continue}d.setUint16(_*2,h/y,!0),v.setUint16(_*2,x/y,!0);var S,k;switch(e[_].t){case"d":if(e[_].v instanceof Date){S=Z1(e[_],t),k=Q1(e[_],t);break}S=Z1(e[_],t),k=Q1(e[_],t);break;case"s":case"n":case"b":case"z":S=Z1(e[_],t),k=Q1(e[_],t);break;default:throw new Error("Unsupported value "+e[_])}p.push(S),h+=S.length,w.push(k),x+=k.length,++o}for(s[2][0].data=ht(o),s[5][0].data=ht(5);_<s[7][0].data.length/2;++_)d.setUint16(_*2,65535,!0),v.setUint16(_*2,65535,!0);return s[6][0].data=Xs(p),s[3][0].data=Xs(w),s[8]=[{type:0,data:ht(1)}],s}function N2(e,t){return{meta:[[],[{type:0,data:ht(e)}]],data:t}}function _i(e,t){t.last||(t.last=927262);for(var r=t.last;r<2e6;++r)if(!t[r])return t[t.last=r]=e,r;throw new Error("Too many messages")}function YV(e){var t={},r=[];return e.FileIndex.map(function(n,a){return[n,e.FullPaths[a]]}).forEach(function(n){var a=n[0],i=n[1];a.type==2&&a.name.match(/\.iwa/)&&a.content[0]==0&&Qu(Ju(a.content)).forEach(function(s){r.push(s.id),t[s.id]={deps:[],location:i,type:Ot(s.messages[0].meta[1][0].data)}})}),e.FileIndex.forEach(function(n){n.name.match(/\.iwa/)&&n.content[0]==0&&Qu(Ju(n.content)).forEach(function(a){a.messages.forEach(function(i){[5,6].forEach(function(s){i.meta[s]&&i.meta[s].forEach(function(o){t[a.id].deps.push(Ot(o.data))})})})})}),t}function Td(e,t,r){return gt([[],[{type:0,data:ht(1)}],[],[{type:5,data:new Uint8Array(Float32Array.from([e/255]).buffer)}],[{type:5,data:new Uint8Array(Float32Array.from([t/255]).buffer)}],[{type:5,data:new Uint8Array(Float32Array.from([r/255]).buffer)}],[{type:5,data:new Uint8Array(Float32Array.from([1]).buffer)}],[],[],[],[],[],[{type:0,data:ht(1)}]])}function G4(e){switch(e){case 0:return Td(99,222,171);case 1:return Td(162,197,240);case 2:return Td(255,189,189)}return Td(Math.random()*255,Math.random()*255,Math.random()*255)}function ZV(e,t){if(!t||!t.numbers)throw new Error("Must pass a `numbers` option -- check the README");var r=wt.read(t.numbers,{type:"base64"}),n=YV(r),a=Si(r,n,1);if(a==null)throw"Could not find message ".concat(1," in Numbers template");var i=Gs(Ye(a.messages[0].data)[1],Bt);if(i.length>1)throw new Error("Template NUMBERS file must have exactly one sheet");return e.SheetNames.forEach(function(s,o){o>=1&&(JV(r,n,o+1),a=Si(r,n,1),i=Gs(Ye(a.messages[0].data)[1],Bt)),eX(r,n,e.Sheets[s],s,o,i[o])}),r}function cr(e,t,r,n){var a=wt.find(e,t[r].location);if(!a)throw"Could not find ".concat(t[r].location," in Numbers template");var i=Qu(Ju(a.content)),s=i.find(function(o){return o.id==r});n(s,i),a.content=Ll(Ml(i)),a.size=a.content.length}function Si(e,t,r){var n=wt.find(e,t[r].location);if(!n)throw"Could not find ".concat(t[r].location," in Numbers template");var a=Qu(Ju(n.content)),i=a.find(function(s){return s.id==r});return i}function P2(e,t,r){e[3].push({type:2,data:gt([[],[{type:0,data:ht(t)}],[{type:2,data:$n(r.replace(/-[\s\S]*$/,""))}],[{type:2,data:$n(r)}],[{type:2,data:new Uint8Array([2,0,0])}],[{type:2,data:new Uint8Array([2,0,0])}],[],[],[],[],[{type:0,data:ht(0)}],[],[{type:0,data:ht(0)}]])}),e[1]=[{type:0,data:ht(Math.max(t+1,Ot(e[1][0].data)))}]}function go(e,t,r,n,a,i){i||(i=_i({deps:[],location:"",type:t},a));var s="".concat(n,"-").concat(i,".iwa");a[i].location="Root Entry"+s,wt.utils.cfb_add(e,s,Ll(Ml([{id:i,messages:[N2(t,gt(r))]}])));var o=s.replace(/^[\/]/,"").replace(/^Index\//,"").replace(/\.iwa$/,"");return cr(e,a,2,function(c){var u=Ye(c.messages[0].data);P2(u,i||0,o),c.messages[0].data=gt(u)}),i}function Zn(e,t,r,n){var a=t[r].location.replace(/^Root Entry\//,"").replace(/^Index\//,"").replace(/\.iwa$/,""),i=e[3].findIndex(function(o){var c,u,d=Ye(o.data);return(c=d[3])!=null&&c[0]?ci(d[3][0].data)==a:!!((u=d[2])!=null&&u[0]&&ci(d[2][0].data)==a)}),s=Ye(e[3][i].data);s[6]||(s[6]=[]),(Array.isArray(n)?n:[n]).forEach(function(o){s[6].push({type:2,data:gt([[],[{type:0,data:ht(o)}]])})}),e[3][i].data=gt(s)}function QV(e,t,r,n){var a=t[r].location.replace(/^Root Entry\//,"").replace(/^Index\//,"").replace(/\.iwa$/,""),i=e[3].findIndex(function(o){var c,u,d=Ye(o.data);return(c=d[3])!=null&&c[0]?ci(d[3][0].data)==a:!!((u=d[2])!=null&&u[0]&&ci(d[2][0].data)==a)}),s=Ye(e[3][i].data);s[6]||(s[6]=[]),s[6]=s[6].filter(function(o){return Ot(Ye(o.data)[1][0].data)!=n}),e[3][i].data=gt(s)}function JV(e,t,r){var n=-1,a=-1,i={};cr(e,t,1,function(c,u){var d=Ye(c.messages[0].data);n=Bt(Ye(c.messages[0].data)[1][0].data),a=_i({deps:[1],location:t[n].location,type:2},t),i[n]=a,An(c,a),d[1].push({type:2,data:Cn(a)});var h=Si(e,t,n);h.id=a,t[1].location==t[a].location?u.push(h):cr(e,t,a,function(p,v){return v.push(h)}),c.messages[0].data=gt(d)});var s=-1;cr(e,t,a,function(c,u){for(var d=Ye(c.messages[0].data),h=3;h<=69;++h)delete d[h];var p=Gs(d[2],Bt);p.forEach(function(x){return Hi(c,x)}),s=_i({deps:[a],location:t[p[0]].location,type:t[p[0]].type},t),An(c,s),i[p[0]]=s,d[2]=[{type:2,data:Cn(s)}];var v=Si(e,t,p[0]);v.id=s,t[p[0]].location==t[a].location?u.push(v):(cr(e,t,2,function(x){var w=Ye(x.messages[0].data);Zn(w,t,a,s),x.messages[0].data=gt(w)}),cr(e,t,s,function(x,w){return w.push(v)})),c.messages[0].data=gt(d)});var o=-1;cr(e,t,s,function(c,u){for(var d=Ye(c.messages[0].data),h=Ye(d[1][0].data),p=3;p<=69;++p)delete h[p];var v=Bt(h[2][0].data);h[2][0].data=Cn(i[v]),d[1][0].data=gt(h);var x=Bt(d[2][0].data);Hi(c,x),o=_i({deps:[s],location:t[x].location,type:t[x].type},t),An(c,o),i[x]=o,d[2][0].data=Cn(o);var w=Si(e,t,x);w.id=o,t[s].location==t[o].location?u.push(w):cr(e,t,o,function(y,_){return _.push(w)}),c.messages[0].data=gt(d)}),cr(e,t,o,function(c,u){var d,h,p=Ye(c.messages[0].data),v=ci(p[1][0].data),x=v.replace(/-[A-Z0-9]*/,"-".concat(("0000"+r.toString(16)).slice(-4)));if(p[1][0].data=$n(x),[12,13,29,31,32,33,39,44,47,81,82,84].forEach(function(T){return delete p[T]}),p[45]){var w=Ye(p[45][0].data),y=Bt(w[1][0].data);Hi(c,y),delete p[45]}if(p[70]){var _=Ye(p[70][0].data);(d=_[2])==null||d.forEach(function(T){var N=Ye(T.data);[2,3].map(function(C){return N[C][0]}).forEach(function(C){var P=Ye(C.data);if(P[8]){var j=Bt(P[8][0].data);Hi(c,j)}})}),delete p[70]}[46,30,34,35,36,38,48,49,60,61,62,63,64,71,72,73,74,75,85,86,87,88,89].forEach(function(T){if(p[T]){var N=Bt(p[T][0].data);delete p[T],Hi(c,N)}});var S=Ye(p[4][0].data);{[2,4,5,6,11,12,13,15,16,17,18,19,20,21,22].forEach(function(T){var N;if((N=S[T])!=null&&N[0]){var C=Bt(S[T][0].data),P=_i({deps:[o],location:t[C].location,type:t[C].type},t);Hi(c,C),An(c,P),i[C]=P;var j=Si(e,t,C);if(j.id=P,t[C].location==t[o].location)u.push(j);else{t[P].location=t[C].location.replace(C.toString(),P.toString()),t[P].location==t[C].location&&(t[P].location=t[P].location.replace(/\.iwa/,"-".concat(P,".iwa"))),wt.utils.cfb_add(e,t[P].location,Ll(Ml([j])));var R=t[P].location.replace(/^Root Entry\//,"").replace(/^Index\//,"").replace(/\.iwa$/,"");cr(e,t,2,function(I){var F=Ye(I.messages[0].data);P2(F,P,R),Zn(F,t,o,P),I.messages[0].data=gt(F)})}S[T][0].data=Cn(P)}});var k=Ye(S[1][0].data);(h=k[2])==null||h.forEach(function(T){var N=Bt(T.data),C=_i({deps:[o],location:t[N].location,type:t[N].type},t);Hi(c,N),An(c,C),i[N]=C;var P=Si(e,t,N);if(P.id=C,t[N].location==t[o].location)u.push(P);else{t[C].location=t[N].location.replace(N.toString(),C.toString()),t[C].location==t[N].location&&(t[C].location=t[C].location.replace(/\.iwa/,"-".concat(C,".iwa"))),wt.utils.cfb_add(e,t[C].location,Ll(Ml([P])));var j=t[C].location.replace(/^Root Entry\//,"").replace(/^Index\//,"").replace(/\.iwa$/,"");cr(e,t,2,function(R){var I=Ye(R.messages[0].data);P2(I,C,j),Zn(I,t,o,C),R.messages[0].data=gt(I)})}T.data=Cn(C)}),S[1][0].data=gt(k);var E=Ye(S[3][0].data);E[1].forEach(function(T){var N=Ye(T.data),C=Bt(N[2][0].data),P=i[C];if(!i[C]){P=_i({deps:[o],location:"",type:t[C].type},t),t[P].location="Root Entry/Index/Tables/Tile-".concat(P,".iwa"),i[C]=P;var j=Si(e,t,C);j.id=P,Hi(c,C),An(c,P),wt.utils.cfb_add(e,"/Index/Tables/Tile-".concat(P,".iwa"),Ll(Ml([j]))),cr(e,t,2,function(R){var I=Ye(R.messages[0].data);I[3].push({type:2,data:gt([[],[{type:0,data:ht(P)}],[{type:2,data:$n("Tables/Tile")}],[{type:2,data:$n("Tables/Tile-".concat(P))}],[{type:2,data:new Uint8Array([2,0,0])}],[{type:2,data:new Uint8Array([2,0,0])}],[],[],[],[],[{type:0,data:ht(0)}],[],[{type:0,data:ht(0)}]])}),I[1]=[{type:0,data:ht(Math.max(P+1,Ot(I[1][0].data)))}],Zn(I,t,o,P),R.messages[0].data=gt(I)})}N[2][0].data=Cn(P),T.data=gt(N)}),S[3][0].data=gt(E)}p[4][0].data=gt(S),c.messages[0].data=gt(p)})}function eX(e,t,r,n,a,i){var s=[];cr(e,t,i,function(u){var d=Ye(u.messages[0].data);d[1]=[{type:2,data:$n(n)}],s=Gs(d[2],Bt),u.messages[0].data=gt(d)});var o=Si(e,t,s[0]),c=Bt(Ye(o.messages[0].data)[2][0].data);cr(e,t,c,function(u,d){return tX(e,t,r,u,d,c)})}function tX(e,t,r,n,a,i){if(!r["!ref"])throw new Error("Cannot export empty sheet to NUMBERS");var s=hn(r["!ref"]);s.s.r=s.s.c=0;var o=!1;s.e.c>999&&(o=!0,s.e.c=999),s.e.r>999999&&(o=!0,s.e.r=999999),o&&console.error("Truncating to ".concat(Nt(s)));var c=[];if(r["!data"])c=r["!data"];else{for(var u=[],d=0;d<=s.e.c;++d)u[d]=Ft(d);for(var h=0;h<=s.e.r;++h){c[h]=[];var p=""+(h+1);for(d=0;d<=s.e.c;++d){var v=r[u[d]+p];v&&(c[h][d]=v)}}}var x={cmnt:[{a:"~54ee77S~",t:"... the people who are crazy enough to think they can change the world, are the ones who do."}],rsst:[{v:"~54ee77S~",l:"https://sheetjs.com/"}],sst:["~Sh33tJ5~"]},w=Ye(n.messages[0].data);{w[6][0].data=ht(s.e.r+1),w[7][0].data=ht(s.e.c+1),delete w[46];var y=Ye(w[4][0].data);{var _=Bt(Ye(y[1][0].data)[2][0].data);cr(e,t,_,function(ee,ce){var de,Te=Ye(ee.messages[0].data);if((de=Te==null?void 0:Te[2])!=null&&de[0])for(var Ie=0;Ie<c.length;++Ie){var Ne=Ye(Te[2][0].data);Ne[1][0].data=ht(Ie),Ne[4][0].data=ht(c[Ie].length),Te[2][Ie]={type:Te[2][0].type,data:gt(Ne)}}ee.messages[0].data=gt(Te)});var S=Bt(y[2][0].data);cr(e,t,S,function(ee,ce){for(var de=Ye(ee.messages[0].data),Te=0;Te<=s.e.c;++Te){var Ie=Ye(de[2][0].data);Ie[1][0].data=ht(Te),Ie[4][0].data=ht(s.e.r+1),de[2][Te]={type:de[2][0].type,data:gt(Ie)}}ee.messages[0].data=gt(de)});var k=Ye(y[9][0].data);k[1]=[];var E=Ye(y[3][0].data);{var T=256;E[2]=[{type:0,data:ht(T)}];var N=Bt(Ye(E[1][0].data)[2][0].data),C=(function(){var ee=Si(e,t,2),ce=Ye(ee.messages[0].data),de=ce[3].filter(function(Te){return Ot(Ye(Te.data)[1][0].data)==N});return de!=null&&de.length?Ot(Ye(de[0].data)[12][0].data):0})();wt.utils.cfb_del(e,t[N].location),cr(e,t,2,function(ee){var ce=Ye(ee.messages[0].data);ce[3]=ce[3].filter(function(de){return Ot(Ye(de.data)[1][0].data)!=N}),QV(ce,t,i,N),ee.messages[0].data=gt(ce)}),Hi(n,N),E[1]=[];for(var P=Math.ceil((s.e.r+1)/T),j=0;j<P;++j){var R=_i({deps:[],location:"",type:6002},t);t[R].location="Root Entry/Index/Tables/Tile-".concat(R,".iwa");for(var I=[[],[{type:0,data:ht(0)}],[{type:0,data:ht(Math.min(s.e.r+1,(j+1)*T))}],[{type:0,data:ht(0)}],[{type:0,data:ht(Math.min((j+1)*T,s.e.r+1)-j*T)}],[],[{type:0,data:ht(5)}],[{type:0,data:ht(1)}],[{type:0,data:ht(1)}]],F=j*T;F<=Math.min(s.e.r,(j+1)*T-1);++F){var L=KV(c[F],x);L[1][0].data=ht(F-j*T),I[5].push({data:gt(L),type:2})}E[1].push({type:2,data:gt([[],[{type:0,data:ht(j)}],[{type:2,data:Cn(R)}]])});var H={id:R,messages:[N2(6002,gt(I))]},V=Ll(Ml([H]));wt.utils.cfb_add(e,"/Index/Tables/Tile-".concat(R,".iwa"),V),cr(e,t,2,function(ee){var ce=Ye(ee.messages[0].data);ce[3].push({type:2,data:gt([[],[{type:0,data:ht(R)}],[{type:2,data:$n("Tables/Tile")}],[{type:2,data:$n("Tables/Tile-".concat(R))}],[{type:2,data:new Uint8Array([2,0,0])}],[{type:2,data:new Uint8Array([2,0,0])}],[],[],[],[],[{type:0,data:ht(0)}],[],[{type:0,data:ht(C)}]])}),ce[1]=[{type:0,data:ht(Math.max(R+1,Ot(ce[1][0].data)))}],Zn(ce,t,i,R),ee.messages[0].data=gt(ce)}),An(n,R),k[1].push({type:2,data:gt([[],[{type:0,data:ht(j*T)}],[{type:0,data:ht(j)}]])})}}if(y[3][0].data=gt(E),y[9][0].data=gt(k),y[10]=[{type:2,data:new Uint8Array([])}],r["!merges"]){var J=_i({type:6144,deps:[i],location:t[i].location},t);a.push({id:J,messages:[N2(6144,gt([[],r["!merges"].map(function(ee){return{type:2,data:gt([[],[{type:2,data:gt([[],[{type:5,data:new Uint8Array(new Uint16Array([ee.s.r,ee.s.c]).buffer)}]])}],[{type:2,data:gt([[],[{type:5,data:new Uint8Array(new Uint16Array([ee.e.r-ee.s.r+1,ee.e.c-ee.s.c+1]).buffer)}]])}]])}})]))]}),y[13]=[{type:2,data:Cn(J)}],cr(e,t,2,function(ee){var ce=Ye(ee.messages[0].data);Zn(ce,t,i,J),ee.messages[0].data=gt(ce)}),An(n,J)}else delete y[13];var te=Bt(y[4][0].data);cr(e,t,te,function(ee){var ce=Ye(ee.messages[0].data);ce[3]=[],x.sst.forEach(function(de,Te){Te!=0&&ce[3].push({type:2,data:gt([[],[{type:0,data:ht(Te)}],[{type:0,data:ht(1)}],[{type:2,data:$n(de)}]])})}),ee.messages[0].data=gt(ce)});var q=Bt(y[17][0].data);if(cr(e,t,q,function(ee){var ce=Ye(ee.messages[0].data);ce[3]=[];var de=[904980,903835,903815,903845];x.rsst.forEach(function(Te,Ie){if(Ie!=0){var Ne=[[],[{type:0,data:new Uint8Array([5])}],[],[{type:2,data:$n(Te.v)}]];Ne[10]=[{type:0,data:new Uint8Array([1])}],Ne[19]=[{type:2,data:new Uint8Array([10,6,8,0,18,2,101,110])}],Ne[5]=[{type:2,data:new Uint8Array([10,8,8,0,18,4,8,155,149,55])}],Ne[2]=[{type:2,data:new Uint8Array([8,148,158,55])}],Ne[6]=[{type:2,data:new Uint8Array([10,6,8,0,16,0,24,0])}],Ne[7]=[{type:2,data:new Uint8Array([10,8,8,0,18,4,8,135,149,55])}],Ne[8]=[{type:2,data:new Uint8Array([10,8,8,0,18,4,8,165,149,55])}],Ne[14]=[{type:2,data:new Uint8Array([10,6,8,0,16,0,24,0])}],Ne[24]=[{type:2,data:new Uint8Array([10,6,8,0,16,0,24,0])}];var W=_i({deps:[],location:"",type:2001},t),z=[];if(Te.l){var G=go(e,2032,[[],[],[{type:2,data:$n(Te.l)}]],"/Index/Tables/DataList",t);Ne[11]=[];var X=[[],[]];X[1]||(X[1]=[]),X[1].push({type:2,data:gt([[],[{type:0,data:ht(0)}],[{type:2,data:Cn(G)}]])}),Ne[11][0]={type:2,data:gt(X)},z.push(G)}go(e,2001,Ne,"/Index/Tables/DataList",t,W),cr(e,t,W,function(M){de.forEach(function(le){return An(M,le)}),z.forEach(function(le){return An(M,le)})});var ie=go(e,6218,[[],[{type:2,data:Cn(W)}],[],[{type:2,data:new Uint8Array([13,255,255,255,0,18,10,16,255,255,1,24,255,255,255,255,7])}]],"/Index/Tables/DataList",t);cr(e,t,ie,function(M){return An(M,W)}),ce[3].push({type:2,data:gt([[],[{type:0,data:ht(Ie)}],[{type:0,data:ht(1)}],[],[],[],[],[],[],[{type:2,data:Cn(ie)}]])}),An(ee,ie),cr(e,t,2,function(M){var le=Ye(M.messages[0].data);Zn(le,t,q,ie),Zn(le,t,ie,W),Zn(le,t,W,z),Zn(le,t,W,de),M.messages[0].data=gt(le)})}}),ee.messages[0].data=gt(ce)}),x.cmnt.length>1){var oe=Bt(y[19][0].data),Q={},Z=0;cr(e,t,oe,function(ee){var ce=Ye(ee.messages[0].data);ce[3]=[],x.cmnt.forEach(function(de,Te){if(Te!=0){var Ie=[];de.replies&&de.replies.forEach(function(z){Q[z.a||""]||(Q[z.a||""]=go(e,212,[[],[{type:2,data:$n(z.a||"")}],[{type:2,data:G4(++Z)}],[],[{type:0,data:ht(0)}]],"/Index/Tables/DataList",t));var G=Q[z.a||""],X=go(e,3056,[[],[{type:2,data:$n(z.t||"")}],[{type:2,data:gt([[],[{type:1,data:new Uint8Array([0,0,0,128,116,109,182,65])}]])}],[{type:2,data:Cn(G)}]],"/Index/Tables/DataList",t);cr(e,t,X,function(ie){return An(ie,G)}),Ie.push(X),cr(e,t,2,function(ie){var M=Ye(ie.messages[0].data);Zn(M,t,X,G),ie.messages[0].data=gt(M)})}),Q[de.a||""]||(Q[de.a||""]=go(e,212,[[],[{type:2,data:$n(de.a||"")}],[{type:2,data:G4(++Z)}],[],[{type:0,data:ht(0)}]],"/Index/Tables/DataList",t));var Ne=Q[de.a||""],W=go(e,3056,[[],[{type:2,data:$n(de.t||"")}],[{type:2,data:gt([[],[{type:1,data:new Uint8Array([0,0,0,128,116,109,182,65])}]])}],[{type:2,data:Cn(Ne)}],Ie.map(function(z){return{type:2,data:Cn(z)}}),[{type:2,data:gt([[],[{type:0,data:ht(Te)}],[{type:0,data:ht(0)}]])}]],"/Index/Tables/DataList",t);cr(e,t,W,function(z){An(z,Ne),Ie.forEach(function(G){return An(z,G)})}),ce[3].push({type:2,data:gt([[],[{type:0,data:ht(Te)}],[{type:0,data:ht(1)}],[],[],[],[],[],[],[],[{type:2,data:Cn(W)}]])}),An(ee,W),cr(e,t,2,function(z){var G=Ye(z.messages[0].data);Zn(G,t,oe,W),Zn(G,t,W,Ne),Ie.length&&Zn(G,t,W,Ie),z.messages[0].data=gt(G)})}}),ce[2][0].data=ht(x.cmnt.length+1),ee.messages[0].data=gt(ce)})}}w[4][0].data=gt(y)}n.messages[0].data=gt(w)}function uI(e){return function(r){for(var n=0;n!=e.length;++n){var a=e[n];r[a[0]]===void 0&&(r[a[0]]=a[1]),a[2]==="n"&&(r[a[0]]=Number(r[a[0]]))}}}function Pb(e){uI([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(e)}function Ib(e){uI([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(e)}function rX(e){return jt.WS.indexOf(e)>-1?"sheet":e==jt.CS?"chart":e==jt.DS?"dialog":e==jt.MS?"macro":e&&e.length?e:"sheet"}function nX(e,t){if(!e)return 0;try{e=t.map(function(n){return n.id||(n.id=n.strRelID),[n.name,e["!id"][n.id].Target,rX(e["!id"][n.id].Type)]})}catch{return null}return!e||e.length===0?null:e}function aX(e,t,r,n,a,i,s,o){if(!(!e||!e["!legdrawel"])){var c=Nl(e["!legdrawel"].Target,n),u=Wn(r,c,!0);u&&tU(ir(u),e,o||[])}}function iX(e,t,r,n,a,i,s,o,c,u,d,h){try{i[n]=ku(Wn(e,r,!0),t);var p=Wr(e,t),v;switch(o){case"sheet":v=kq(p,t,a,c,i[n],u,d,h);break;case"chart":if(v=Eq(p,t,a,c,i[n],u,d,h),!v||!v["!drawel"])break;var x=Nl(v["!drawel"].Target,t),w=qu(x),y=eU(Wn(e,x,!0),ku(Wn(e,w,!0),x)),_=Nl(y,x),S=qu(_);v=XH(Wn(e,_,!0),_,c,ku(Wn(e,S,!0),_),u,v);break;case"macro":v=Tq(p,t,a,c,i[n],u,d,h);break;case"dialog":v=Aq(p,t,a,c,i[n],u,d,h);break;default:throw new Error("Unrecognized sheet type "+o)}s[n]=v;var k=[],E=[];i&&i[n]&&_r(i[n]).forEach(function(T){var N="";if(i[n][T].Type==jt.CMNT){if(N=Nl(i[n][T].Target,t),k=Nq(Wr(e,N,!0),N,c),!k||!k.length)return;P4(v,k,!1)}i[n][T].Type==jt.TCMNT&&(N=Nl(i[n][T].Target,t),E=E.concat(iU(Wr(e,N,!0),c)))}),E&&E.length&&P4(v,E,!0,c.people||[]),aX(v,o,e,t,a,c,u,k)}catch(T){if(c.WTF)throw T}}function Ca(e){return e.charAt(0)=="/"?e.slice(1):e}function sX(e,t){if(dc(),t=t||{},Pb(t),Da(e,"META-INF/manifest.xml")||Da(e,"objectdata.xml"))return H4(e,t);if(Da(e,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof J1<"u"){if(e.FileIndex)return J1(e,t);var r=wt.utils.cfb_new();return QE(e).forEach(function(V){Ct(r,V,QM(e,V))}),J1(r,t)}throw new Error("Unsupported NUMBERS file")}if(!Da(e,"[Content_Types].xml")){if(Da(e,"index.xml.gz"))throw new Error("Unsupported NUMBERS 08 file");if(Da(e,"index.xml"))throw new Error("Unsupported NUMBERS 09 file");var n=wt.find(e,"Index.zip");if(n)return t=dr(t),delete t.type,typeof n.content=="string"&&(t.type="binary"),typeof Bun<"u"&&Buffer.isBuffer(n.content)?Bl(new Uint8Array(n.content),t):Bl(n.content,t);throw new Error("Unsupported ZIP file")}var a=QE(e),i=qL(Wn(e,"[Content_Types].xml")),s=!1,o,c;if(i.workbooks.length===0&&(c="xl/workbook.xml",Wr(e,c,!0)&&i.workbooks.push(c)),i.workbooks.length===0){if(c="xl/workbook.bin",!Wr(e,c,!0))throw new Error("Could not find workbook");i.workbooks.push(c),s=!0}i.workbooks[0].slice(-3)=="bin"&&(s=!0);var u={},d={};if(!t.bookSheets&&!t.bookProps){if(Tu=[],i.sst)try{Tu=Oq(Wr(e,Ca(i.sst)),i.sst,t)}catch(V){if(t.WTF)throw V}t.cellStyles&&i.themes.length&&(u=OP(Wn(e,i.themes[0].replace(/^\//,""),!0)||"",t)),i.style&&(d=Cq(Wr(e,Ca(i.style)),i.style,u,t))}i.links.map(function(V){try{var J=ku(Wn(e,qu(Ca(V))),V);return Iq(Wr(e,Ca(V)),J,V,t)}catch{}});var h=Sq(Wr(e,Ca(i.workbooks[0])),i.workbooks[0],t),p={},v="";i.coreprops.length&&(v=Wr(e,Ca(i.coreprops[0]),!0),v&&(p=Z6(v)),i.extprops.length!==0&&(v=Wr(e,Ca(i.extprops[0]),!0),v&&ZL(v,p,t)));var x={};(!t.bookSheets||t.bookProps)&&i.custprops.length!==0&&(v=Wn(e,Ca(i.custprops[0]),!0),v&&(x=JL(v,t)));var w={};if((t.bookSheets||t.bookProps)&&(h.Sheets?o=h.Sheets.map(function(J){return J.name}):p.Worksheets&&p.SheetNames.length>0&&(o=p.SheetNames),t.bookProps&&(w.Props=p,w.Custprops=x),t.bookSheets&&typeof o<"u"&&(w.SheetNames=o),t.bookSheets?w.SheetNames:t.bookProps))return w;o={};var y={};t.bookDeps&&i.calcchain&&(y=Pq(Wr(e,Ca(i.calcchain)),i.calcchain));var _=0,S={},k,E;{var T=h.Sheets;p.Worksheets=T.length,p.SheetNames=[];for(var N=0;N!=T.length;++N)p.SheetNames[N]=T[N].name}var C=s?"bin":"xml",P=i.workbooks[0].lastIndexOf("/"),j=(i.workbooks[0].slice(0,P+1)+"_rels/"+i.workbooks[0].slice(P+1)+".rels").replace(/^\//,"");Da(e,j)||(j="xl/_rels/workbook."+C+".rels");var R=ku(Wn(e,j,!0),j.replace(/_rels.*/,"s5s"));(i.metadata||[]).length>=1&&(t.xlmeta=Fq(Wr(e,Ca(i.metadata[0])),i.metadata[0],t)),(i.people||[]).length>=1&&(t.people=sU(Wr(e,Ca(i.people[0])),t)),R&&(R=nX(R,h.Sheets));var I=Wr(e,"xl/worksheets/sheet.xml",!0)?1:0;e:for(_=0;_!=p.Worksheets;++_){var F="sheet";if(R&&R[_]?(k="xl/"+R[_][1].replace(/[\/]?xl\//,""),Da(e,k)||(k=R[_][1]),Da(e,k)||(k=j.replace(/_rels\/[\S\s]*$/,"")+R[_][1]),F=R[_][2]):(k="xl/worksheets/sheet"+(_+1-I)+"."+C,k=k.replace(/sheet0\./,"sheet.")),E=k.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),t&&t.sheets!=null)switch(typeof t.sheets){case"number":if(_!=t.sheets)continue e;break;case"string":if(p.SheetNames[_].toLowerCase()!=t.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(t.sheets)){for(var L=!1,H=0;H!=t.sheets.length;++H)typeof t.sheets[H]=="number"&&t.sheets[H]==_&&(L=1),typeof t.sheets[H]=="string"&&t.sheets[H].toLowerCase()==p.SheetNames[_].toLowerCase()&&(L=1);if(!L)continue e}}iX(e,k,E,p.SheetNames[_],_,S,o,F,t,h,u,d)}return w={Directory:i,Workbook:h,Props:p,Custprops:x,Deps:y,Sheets:o,SheetNames:p.SheetNames,Strings:Tu,Styles:d,Themes:u,SSF:dr(yt)},t&&t.bookFiles&&(e.files?(w.keys=a,w.files=e.files):(w.keys=[],w.files={},e.FullPaths.forEach(function(V,J){V=V.replace(/^Root Entry[\/]/,""),w.keys.push(V),w.files[V]=e.FileIndex[J]}))),t&&t.bookVBA&&(i.vba.length>0?w.vbaraw=Wr(e,Ca(i.vba[0]),!0):i.defaults&&i.defaults.bin===dU&&(w.vbaraw=Wr(e,"xl/vbaProject.bin",!0))),w.bookType=s?"xlsb":"xlsx",w}function oX(e,t){var r=t||{},n="Workbook",a=wt.find(e,n);try{if(n="/!DataSpaces/Version",a=wt.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(kB(a.content),n="/!DataSpaces/DataSpaceMap",a=wt.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);var i=TB(a.content);if(i.length!==1||i[0].comps.length!==1||i[0].comps[0].t!==0||i[0].name!=="StrongEncryptionDataSpace"||i[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",a=wt.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);var s=AB(a.content);if(s.length!=1||s[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",a=wt.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);OB(a.content)}catch{}if(n="/EncryptionInfo",a=wt.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);var o=NB(a.content);if(n="/EncryptedPackage",a=wt.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(o[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(o[1],a.content,r.password||"",r);if(o[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(o[1],a.content,r.password||"",r);throw new Error("File is password-protected")}function lX(e,t){e&&!e.SSF&&(e.SSF=dr(yt)),e&&e.SSF&&(dc(),Zh(e.SSF),t.revssf=Jh(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,Au?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r="bin",n=!0,a=wb();Ib(t=t||{});var i=cb(),s="",o=0;if(t.cellXfs=[],Zs(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),s="docProps/core.xml",Ct(i,s,Q6(e.Props,t)),a.coreprops.push(s),er(t.rels,2,s,jt.CORE_PROPS),s="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var c=[],u=0;u<e.SheetNames.length;++u)(e.Workbook.Sheets[u]||{}).Hidden!=2&&c.push(e.SheetNames[u]);e.Props.SheetNames=c}e.Props.Worksheets=e.Props.SheetNames.length,Ct(i,s,tP(e.Props)),a.extprops.push(s),er(t.rels,3,s,jt.EXT_PROPS),e.Custprops!==e.Props&&_r(e.Custprops||{}).length>0&&(s="docProps/custom.xml",Ct(i,s,rP(e.Custprops)),a.custprops.push(s),er(t.rels,4,s,jt.CUST_PROPS));var d=["SheetJ5"];for(t.tcid=0,o=1;o<=e.SheetNames.length;++o){var h={"!id":{}},p=e.Sheets[e.SheetNames[o-1]],v=(p||{})["!type"]||"sheet";switch(v){case"chart":default:s="xl/worksheets/sheet"+o+"."+r,Ct(i,s,qH(o-1,t,e,h)),a.sheets.push(s),er(t.wbrels,-1,"worksheets/sheet"+o+"."+r,jt.WS[0])}if(p){var x=p["!comments"],w=!1,y="";if(x&&x.length>0){var _=!1;x.forEach(function(k){k[1].forEach(function(E){E.T==!0&&(_=!0)})}),_&&(y="xl/threadedComments/threadedComment"+o+".xml",Ct(i,y,PP(x,d,t)),a.threadedcomments.push(y),er(h,-1,"../threadedComments/threadedComment"+o+".xml",jt.TCMNT)),y="xl/comments"+o+"."+r,Ct(i,y,fU(x)),a.comments.push(y),er(h,-1,"../comments"+o+"."+r,jt.CMNT),w=!0}p["!legacy"]&&w&&Ct(i,"xl/drawings/vmlDrawing"+o+".vml",NP(o,p["!comments"])),delete p["!comments"],delete p["!legacy"]}h["!id"].rId1&&Ct(i,qu(s),jl(h))}t.Strings!=null&&t.Strings.length>0&&(s="xl/sharedStrings."+r,Ct(i,s,SB(t.Strings)),a.strs.push(s),er(t.wbrels,-1,"sharedStrings."+r,jt.SST)),s="xl/workbook."+r,Ct(i,s,_q(e)),a.workbooks.push(s),er(t.rels,1,s,jt.WB),s="xl/theme/theme1.xml";var S=Tb(e.Themes,t);return Ct(i,s,S),a.themes.push(s),er(t.wbrels,-1,"theme/theme1.xml",jt.THEME),s="xl/styles."+r,Ct(i,s,A$(e,t)),a.styles.push(s),er(t.wbrels,-1,"styles."+r,jt.STY),e.vbaraw&&n&&(s="xl/vbaProject.bin",Ct(i,s,e.vbaraw),a.vba.push(s),er(t.wbrels,-1,"vbaProject.bin",jt.VBA)),s="xl/metadata."+r,Ct(i,s,X$()),a.metadata.push(s),er(t.wbrels,-1,"metadata."+r,jt.XLMETA),d.length>1&&(s="xl/persons/person.xml",Ct(i,s,IP(d)),a.people.push(s),er(t.wbrels,-1,"persons/person.xml",jt.PEOPLE)),Ct(i,"[Content_Types].xml",K6(a,t)),Ct(i,"_rels/.rels",jl(t.rels)),Ct(i,"xl/_rels/workbook."+r+".rels",jl(t.wbrels)),delete t.revssf,delete t.ssf,i}function cX(e,t){e&&!e.SSF&&(e.SSF=dr(yt)),e&&e.SSF&&(dc(),Zh(e.SSF),t.revssf=Jh(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,Au?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r="xml",n=mU.indexOf(t.bookType)>-1,a=wb();Ib(t=t||{});var i=cb(),s="",o=0;if(t.cellXfs=[],Zs(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),s="docProps/core.xml",Ct(i,s,Q6(e.Props,t)),a.coreprops.push(s),er(t.rels,2,s,jt.CORE_PROPS),s="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var c=[],u=0;u<e.SheetNames.length;++u)(e.Workbook.Sheets[u]||{}).Hidden!=2&&c.push(e.SheetNames[u]);e.Props.SheetNames=c}e.Props.Worksheets=e.Props.SheetNames.length,Ct(i,s,tP(e.Props)),a.extprops.push(s),er(t.rels,3,s,jt.EXT_PROPS),e.Custprops!==e.Props&&_r(e.Custprops||{}).length>0&&(s="docProps/custom.xml",Ct(i,s,rP(e.Custprops)),a.custprops.push(s),er(t.rels,4,s,jt.CUST_PROPS));var d=["SheetJ5"];for(t.tcid=0,o=1;o<=e.SheetNames.length;++o){var h={"!id":{}},p=e.Sheets[e.SheetNames[o-1]],v=(p||{})["!type"]||"sheet";switch(v){case"chart":default:s="xl/worksheets/sheet"+o+"."+r,Ct(i,s,IW(o-1,t,e,h)),a.sheets.push(s),er(t.wbrels,-1,"worksheets/sheet"+o+"."+r,jt.WS[0])}if(p){var x=p["!comments"],w=!1,y="";if(x&&x.length>0){var _=!1;x.forEach(function(S){S[1].forEach(function(k){k.T==!0&&(_=!0)})}),_&&(y="xl/threadedComments/threadedComment"+o+".xml",Ct(i,y,PP(x,d,t)),a.threadedcomments.push(y),er(h,-1,"../threadedComments/threadedComment"+o+".xml",jt.TCMNT)),y="xl/comments"+o+"."+r,Ct(i,y,aU(x)),a.comments.push(y),er(h,-1,"../comments"+o+"."+r,jt.CMNT),w=!0}p["!legacy"]&&w&&Ct(i,"xl/drawings/vmlDrawing"+o+".vml",NP(o,p["!comments"])),delete p["!comments"],delete p["!legacy"]}h["!id"].rId1&&Ct(i,qu(s),jl(h))}return t.Strings!=null&&t.Strings.length>0&&(s="xl/sharedStrings."+r,Ct(i,s,xB(t.Strings,t)),a.strs.push(s),er(t.wbrels,-1,"sharedStrings."+r,jt.SST)),s="xl/workbook."+r,Ct(i,s,sq(e)),a.workbooks.push(s),er(t.rels,1,s,jt.WB),s="xl/theme/theme1.xml",Ct(i,s,Tb(e.Themes,t)),a.themes.push(s),er(t.wbrels,-1,"theme/theme1.xml",jt.THEME),s="xl/styles."+r,Ct(i,s,i$(e,t)),a.styles.push(s),er(t.wbrels,-1,"styles."+r,jt.STY),e.vbaraw&&n&&(s="xl/vbaProject.bin",Ct(i,s,e.vbaraw),a.vba.push(s),er(t.wbrels,-1,"vbaProject.bin",jt.VBA)),s="xl/metadata."+r,Ct(i,s,K$()),a.metadata.push(s),er(t.wbrels,-1,"metadata."+r,jt.XLMETA),d.length>1&&(s="xl/persons/person.xml",Ct(i,s,IP(d)),a.people.push(s),er(t.wbrels,-1,"persons/person.xml",jt.PEOPLE)),Ct(i,"[Content_Types].xml",K6(a,t)),Ct(i,"_rels/.rels",jl(t.rels)),Ct(i,"xl/_rels/workbook."+r+".rels",jl(t.wbrels)),delete t.revssf,delete t.ssf,i}function Fb(e,t){var r="";switch((t||{}).type||"base64"){case"buffer":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];case"base64":r=pa(e.slice(0,12));break;case"binary":r=e;break;case"array":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];default:throw new Error("Unrecognized type "+(t&&t.type||"undefined"))}return[r.charCodeAt(0),r.charCodeAt(1),r.charCodeAt(2),r.charCodeAt(3),r.charCodeAt(4),r.charCodeAt(5),r.charCodeAt(6),r.charCodeAt(7)]}function uX(e,t){return wt.find(e,"EncryptedPackage")?oX(e,t):ZP(e,t)}function fX(e,t){var r,n=e,a=t||{};return a.type||(a.type=It&&Buffer.isBuffer(e)?"buffer":"base64"),r=k6(n,a),sX(r,a)}function fI(e,t){var r=0;e:for(;r<e.length;)switch(e.charCodeAt(r)){case 10:case 13:case 32:++r;break;case 60:return C2(e.slice(r),t);default:break e}return Wl.to_workbook(e,t)}function dX(e,t){var r="",n=Fb(e,t);switch(t.type){case"base64":r=pa(e);break;case"binary":r=e;break;case"buffer":r=e.toString("binary");break;case"array":r=Bo(e);break;default:throw new Error("Unrecognized type "+t.type)}return n[0]==239&&n[1]==187&&n[2]==191&&(r=ir(r)),t.type="binary",fI(r,t)}function hX(e,t){var r=e;return t.type=="base64"&&(r=pa(r)),typeof ArrayBuffer<"u"&&e instanceof ArrayBuffer&&(r=new Uint8Array(e)),r=It&&Buffer.isBuffer(e)?e.slice(2).toString("utf16le"):typeof Uint8Array<"u"&&r instanceof Uint8Array?typeof TextDecoder<"u"?new TextDecoder("utf-16le").decode(r.slice(2)):tM(r.slice(2)):l6(r.slice(2)),t.type="binary",fI(r,t)}function pX(e){return e.match(/[^\x00-\x7F]/)?ki(e):e}function ev(e,t,r,n){return n?(r.type="string",Wl.to_workbook(e,r)):Wl.to_workbook(t,r)}function Bl(e,t){rb();var r=t||{};if(r.codepage&&console.error("Codepage tables are not loaded.  Non-ASCII characters may not give expected results"),typeof ArrayBuffer<"u"&&e instanceof ArrayBuffer)return Bl(new Uint8Array(e),(r=dr(r),r.type="array",r));if(typeof Int8Array<"u"&&e instanceof Int8Array)return Bl(new Uint8Array(e.buffer,e.byteOffset,e.length),r);typeof Uint8Array<"u"&&e instanceof Uint8Array&&!r.type&&(r.type=typeof Deno<"u"?"buffer":"array");var n=e,a=[0,0,0,0],i=!1;if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),Rl={},r.dateNF&&(Rl.dateNF=r.dateNF),r.type||(r.type=It&&Buffer.isBuffer(e)?"buffer":"base64"),r.type=="file"&&(r.type=It?"buffer":"binary",n=FM(e),typeof Uint8Array<"u"&&!It&&(r.type="array")),r.type=="string"&&(i=!0,r.type="binary",r.codepage=65001,n=pX(e)),r.type=="array"&&typeof Uint8Array<"u"&&e instanceof Uint8Array&&typeof ArrayBuffer<"u"){var s=new ArrayBuffer(3),o=new Uint8Array(s);if(o.foo="bar",!o.foo)return r=dr(r),r.type="array",Bl(nb(n),r)}switch((a=Fb(n,r))[0]){case 208:if(a[1]===207&&a[2]===17&&a[3]===224&&a[4]===161&&a[5]===177&&a[6]===26&&a[7]===225)return uX(wt.read(n,r),r);break;case 9:if(a[1]<=8)return ZP(n,r);break;case 60:return C2(n,r);case 73:if(a[1]===73&&a[2]===42&&a[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(a[1]===68)return lB(n,r);break;case 84:if(a[1]===65&&a[2]===66&&a[3]===76)return wP.to_workbook(n,r);break;case 80:return a[1]===75&&a[2]<9&&a[3]<9?fX(n,r):ev(e,n,r,i);case 239:return a[3]===60?C2(n,r):ev(e,n,r,i);case 255:if(a[1]===254)return hX(n,r);if(a[1]===0&&a[2]===2&&a[3]===0)return Io.to_workbook(n,r);break;case 0:if(a[1]===0&&(a[2]>=2&&a[3]===0||a[2]===0&&(a[3]===8||a[3]===9)))return Io.to_workbook(n,r);break;case 3:case 131:case 139:case 140:return A2.to_workbook(n,r);case 123:if(a[1]===92&&a[2]===114&&a[3]===116)return zB(n,r);break;case 10:case 13:case 32:return dX(n,r);case 137:if(a[1]===80&&a[2]===78&&a[3]===71)throw new Error("PNG Image File is not a spreadsheet");break;case 8:if(a[1]===231)throw new Error("Unsupported Multiplan 1.x file!");break;case 12:if(a[1]===236)throw new Error("Unsupported Multiplan 2.x file!");if(a[1]===237)throw new Error("Unsupported Multiplan 3.x file!");break}return oB.indexOf(a[0])>-1&&a[2]<=12&&a[3]<=31?A2.to_workbook(n,r):ev(e,n,r,i)}function dI(e,t){switch(t.type){case"base64":case"binary":break;case"buffer":case"array":t.type="";break;case"file":return Uf(t.file,wt.write(e,{type:It?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");default:throw new Error("Unrecognized type "+t.type)}return wt.write(e,t)}function mX(e,t){switch(t.bookType){case"ods":return iI(e,t);case"numbers":return ZV(e,t);case"xlsb":return lX(e,t);default:return cX(e,t)}}function vX(e,t){var r=dr(t||{}),n=mX(e,r);return gX(n,r)}function gX(e,t){var r={},n=It?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(t.compression&&(r.compression="DEFLATE"),t.password)r.type=n;else switch(t.type){case"base64":r.type="base64";break;case"binary":r.type="string";break;case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");case"buffer":case"file":r.type=n;break;default:throw new Error("Unrecognized type "+t.type)}var a=e.FullPaths?wt.write(e,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[r.type]||r.type,compression:!!t.compression}):e.generate(r);if(typeof Deno<"u"&&typeof a=="string"){if(t.type=="binary"||t.type=="base64")return a;a=new Uint8Array(Yh(a))}return t.password&&typeof encrypt_agile<"u"?dI(encrypt_agile(a,t.password),t):t.type==="file"?Uf(t.file,a):t.type=="string"?ir(a):a}function xX(e,t){var r=t||{},n=sV(e,r);return dI(n,r)}function wi(e,t,r){r||(r="");var n=r+e;switch(t.type){case"base64":return Jd(ki(n));case"binary":return ki(n);case"string":return e;case"file":return Uf(t.file,n,"utf8");case"buffer":return It?Fi(n,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(n):wi(n,{type:"binary"}).split("").map(function(a){return a.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function yX(e,t){switch(t.type){case"base64":return nM(e);case"binary":return e;case"string":return e;case"file":return Uf(t.file,e,"binary");case"buffer":return It?Fi(e,"binary"):e.split("").map(function(r){return r.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function Ad(e,t){switch(t.type){case"string":case"base64":case"binary":for(var r="",n=0;n<e.length;++n)r+=String.fromCharCode(e[n]);return t.type=="base64"?Jd(r):t.type=="string"?ir(r):r;case"file":return Uf(t.file,e);case"buffer":return e;default:throw new Error("Unrecognized type "+t.type)}}function hI(e,t){rb(),nq(e);var r=dr(t||{});if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),r.type=="array"){r.type="binary";var n=hI(e,r);return r.type="array",Yh(n)}var a=0;if(r.sheet&&(typeof r.sheet=="number"?a=r.sheet:a=e.SheetNames.indexOf(r.sheet),!e.SheetNames[a]))throw new Error("Sheet not found: "+r.sheet+" : "+typeof r.sheet);switch(r.bookType||"xlsb"){case"xml":case"xlml":return wi(Jq(e,r),r);case"slk":case"sylk":return wi(yP.from_sheet(e.Sheets[e.SheetNames[a]],r,e),r);case"htm":case"html":return wi(eI(e.Sheets[e.SheetNames[a]],r),r);case"txt":return yX(pI(e.Sheets[e.SheetNames[a]],r),r);case"csv":return wi(Db(e.Sheets[e.SheetNames[a]],r),r,"\uFEFF");case"dif":return wi(wP.from_sheet(e.Sheets[e.SheetNames[a]],r),r);case"dbf":return Ad(A2.from_sheet(e.Sheets[e.SheetNames[a]],r),r);case"prn":return wi(Wl.from_sheet(e.Sheets[e.SheetNames[a]],r),r);case"rtf":return wi(WB(e.Sheets[e.SheetNames[a]]),r);case"eth":return wi(bP.from_sheet(e.Sheets[e.SheetNames[a]],r),r);case"fods":return wi(iI(e,r),r);case"wk1":return Ad(Io.sheet_to_wk1(e.Sheets[e.SheetNames[a]],r),r);case"wk3":return Ad(Io.book_to_wk3(e,r),r);case"biff2":r.biff||(r.biff=2);case"biff3":r.biff||(r.biff=3);case"biff4":return r.biff||(r.biff=4),Ad(JP(e,r),r);case"biff5":r.biff||(r.biff=5);case"biff8":case"xla":case"xls":return r.biff||(r.biff=8),xX(e,r);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return vX(e,r);default:throw new Error("Unrecognized bookType |"+r.bookType+"|")}}function wX(e){if(!e.bookType){var t={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"},r=e.file.slice(e.file.lastIndexOf(".")).toLowerCase();r.match(/^\.[a-z]+$/)&&(e.bookType=r.slice(1)),e.bookType=t[e.bookType]||e.bookType}}function bX(e,t,r){var n=r||{};return n.type="file",n.file=t,wX(n),hI(e,n)}function _X(e,t,r,n,a,i,s){var o=Ut(r),c=s.defval,u=s.raw||!Object.prototype.hasOwnProperty.call(s,"raw"),d=!0,h=e["!data"]!=null,p=a===1?[]:{};if(a!==1)if(Object.defineProperty)try{Object.defineProperty(p,"__rowNum__",{value:r,enumerable:!1})}catch{p.__rowNum__=r}else p.__rowNum__=r;if(!h||e["!data"][r])for(var v=t.s.c;v<=t.e.c;++v){var x=h?(e["!data"][r]||[])[v]:e[n[v]+o];if(x==null||x.t===void 0){if(c===void 0)continue;i[v]!=null&&(p[i[v]]=c);continue}var w=x.v;switch(x.t){case"z":if(w==null)break;continue;case"e":w=w==0?null:void 0;break;case"s":case"b":case"n":if(!x.z||!Ha(x.z)||(w=Ji(w),typeof w=="number"))break;case"d":s&&(s.UTC||s.raw===!1)||(w=$o(new Date(w)));break;default:throw new Error("unrecognized type "+x.t)}if(i[v]!=null){if(w==null)if(x.t=="e"&&w===null)p[i[v]]=null;else if(c!==void 0)p[i[v]]=c;else if(u&&w===null)p[i[v]]=null;else continue;else p[i[v]]=(x.t==="n"&&typeof s.rawNumbers=="boolean"?s.rawNumbers:u)?w:is(x,w,s);w!=null&&(d=!1)}}return{row:p,isempty:d}}function I2(e,t){if(e==null||e["!ref"]==null)return[];var r={t:"n",v:0},n=0,a=1,i=[],s=0,o="",c={s:{r:0,c:0},e:{r:0,c:0}},u=t||{},d=u.range!=null?u.range:e["!ref"];switch(u.header===1?n=1:u.header==="A"?n=2:Array.isArray(u.header)?n=3:u.header==null&&(n=0),typeof d){case"string":c=Kt(d);break;case"number":c=Kt(e["!ref"]),c.s.r=d;break;default:c=d}n>0&&(a=0);var h=Ut(c.s.r),p=[],v=[],x=0,w=0,y=e["!data"]!=null,_=c.s.r,S=0,k={};y&&!e["!data"][_]&&(e["!data"][_]=[]);var E=u.skipHidden&&e["!cols"]||[],T=u.skipHidden&&e["!rows"]||[];for(S=c.s.c;S<=c.e.c;++S)if(!(E[S]||{}).hidden)switch(p[S]=Ft(S),r=y?e["!data"][_][S]:e[p[S]+h],n){case 1:i[S]=S-c.s.c;break;case 2:i[S]=p[S];break;case 3:i[S]=u.header[S-c.s.c];break;default:if(r==null&&(r={w:"__EMPTY",t:"s"}),o=s=is(r,null,u),w=k[s]||0,!w)k[s]=1;else{do o=s+"_"+w++;while(k[o]);k[s]=w,k[o]=1}i[S]=o}for(_=c.s.r+a;_<=c.e.r;++_)if(!(T[_]||{}).hidden){var N=_X(e,c,_,p,n,i,u);(N.isempty===!1||(n===1?u.blankrows!==!1:u.blankrows))&&(v[x++]=N.row)}return v.length=x,v}var K4=/"/g;function SX(e,t,r,n,a,i,s,o,c){for(var u=!0,d=[],h="",p=Ut(r),v=e["!data"]!=null,x=v&&e["!data"][r]||[],w=t.s.c;w<=t.e.c;++w)if(n[w]){var y=v?x[w]:e[n[w]+p];if(y==null)h="";else if(y.v!=null){u=!1,h=""+(c.rawNumbers&&y.t=="n"?y.v:is(y,null,c));for(var _=0,S=0;_!==h.length;++_)if((S=h.charCodeAt(_))===a||S===i||S===34||c.forceQuotes){h='"'+h.replace(K4,'""')+'"';break}h=="ID"&&o==0&&d.length==0&&(h='"ID"')}else y.f!=null&&!y.F?(u=!1,h="="+y.f,h.indexOf(",")>=0&&(h='"'+h.replace(K4,'""')+'"')):h="";d.push(h)}if(c.strip)for(;d[d.length-1]==="";)--d.length;return c.blankrows===!1&&u?null:d.join(s)}function Db(e,t){var r=[],n=t??{};if(e==null||e["!ref"]==null)return"";for(var a=Kt(e["!ref"]),i=n.FS!==void 0?n.FS:",",s=i.charCodeAt(0),o=n.RS!==void 0?n.RS:`
`,c=o.charCodeAt(0),u="",d=[],h=n.skipHidden&&e["!cols"]||[],p=n.skipHidden&&e["!rows"]||[],v=a.s.c;v<=a.e.c;++v)(h[v]||{}).hidden||(d[v]=Ft(v));for(var x=0,w=a.s.r;w<=a.e.r;++w)(p[w]||{}).hidden||(u=SX(e,a,w,d,s,c,i,x,n),u!=null&&(u||n.blankrows!==!1)&&r.push((x++?o:"")+u));return r.join("")}function pI(e,t){t||(t={}),t.FS="	",t.RS=`
`;var r=Db(e,t);return r}function kX(e,t){var r="",n,a="";if(e==null||e["!ref"]==null)return[];var i=Kt(e["!ref"]),s="",o=[],c,u=[],d=e["!data"]!=null;for(c=i.s.c;c<=i.e.c;++c)o[c]=Ft(c);for(var h=i.s.r;h<=i.e.r;++h)for(s=Ut(h),c=i.s.c;c<=i.e.c;++c)if(r=o[c]+s,n=d?(e["!data"][h]||[])[c]:e[r],a="",n!==void 0){if(n.F!=null){if(r=n.F,!n.f)continue;a=n.f,r.indexOf(":")==-1&&(r=r+":"+r)}if(n.f!=null)a=n.f;else{if(t&&t.values===!1)continue;if(n.t=="z")continue;if(n.t=="n"&&n.v!=null)a=""+n.v;else if(n.t=="b")a=n.v?"TRUE":"FALSE";else if(n.w!==void 0)a="'"+n.w;else{if(n.v===void 0)continue;n.t=="s"?a="'"+n.v:a=""+n.v}}u[u.length]=r+"="+a}return u}function mI(e,t,r){var n=r||{},a=e?e["!data"]!=null:n.dense,i=+!n.skipHeader,s=e||{};!e&&a&&(s["!data"]=[]);var o=0,c=0;if(s&&n.origin!=null)if(typeof n.origin=="number")o=n.origin;else{var u=typeof n.origin=="string"?sr(n.origin):n.origin;o=u.r,c=u.c}var d={s:{c:0,r:0},e:{c,r:o+t.length-1+i}};if(s["!ref"]){var h=Kt(s["!ref"]);d.e.c=Math.max(d.e.c,h.e.c),d.e.r=Math.max(d.e.r,h.e.r),o==-1&&(o=h.e.r+1,d.e.r=o+t.length-1+i)}else o==-1&&(o=0,d.e.r=t.length-1+i);var p=n.header||[],v=0,x=[];t.forEach(function(y,_){a&&!s["!data"][o+_+i]&&(s["!data"][o+_+i]=[]),a&&(x=s["!data"][o+_+i]),_r(y).forEach(function(S){(v=p.indexOf(S))==-1&&(p[v=p.length]=S);var k=y[S],E="z",T="",N=a?"":Ft(c+v)+Ut(o+_+i),C=a?x[c+v]:s[N];k&&typeof k=="object"&&!(k instanceof Date)?a?x[c+v]=k:s[N]=k:(typeof k=="number"?E="n":typeof k=="boolean"?E="b":typeof k=="string"?E="s":k instanceof Date?(E="d",n.UTC||(k=ep(k)),n.cellDates||(E="n",k=Or(k)),T=C!=null&&C.z&&Ha(C.z)?C.z:n.dateNF||yt[14]):k===null&&n.nullError&&(E="e",k=0),C?(C.t=E,C.v=k,delete C.w,delete C.R,T&&(C.z=T)):a?x[c+v]=C={t:E,v:k}:s[N]=C={t:E,v:k},T&&(C.z=T))})}),d.e.c=Math.max(d.e.c,c+p.length-1);var w=Ut(o);if(a&&!s["!data"][o]&&(s["!data"][o]=[]),i)for(v=0;v<p.length;++v)a?s["!data"][o][v+c]={t:"s",v:p[v]}:s[Ft(v+c)+w]={t:"s",v:p[v]};return s["!ref"]=Nt(d),s}function EX(e,t){return mI(null,e,t)}function ef(e,t,r){if(typeof t=="string"){if(e["!data"]!=null){var n=sr(t);return e["!data"][n.r]||(e["!data"][n.r]=[]),e["!data"][n.r][n.c]||(e["!data"][n.r][n.c]={t:"z"})}return e[t]||(e[t]={t:"z"})}return typeof t!="number"?ef(e,Rt(t)):ef(e,Ft(r||0)+Ut(t))}function TX(e,t){if(typeof t=="number"){if(t>=0&&e.SheetNames.length>t)return t;throw new Error("Cannot find sheet # "+t)}else if(typeof t=="string"){var r=e.SheetNames.indexOf(t);if(r>-1)return r;throw new Error("Cannot find sheet name |"+t+"|")}else throw new Error("Cannot find sheet |"+t+"|")}function jb(e,t){var r={SheetNames:[],Sheets:{}};return e&&Kf(r,e,t||"Sheet1"),r}function Kf(e,t,r,n){var a=1;if(!r)for(;a<=65535&&e.SheetNames.indexOf(r="Sheet"+a)!=-1;++a,r=void 0);if(!r||e.SheetNames.length>=65535)throw new Error("Too many worksheets");if(n&&e.SheetNames.indexOf(r)>=0&&r.length<32){var i=r.match(/\d+$/);a=i&&+i[0]||0;var s=i&&r.slice(0,i.index)||r;for(++a;a<=65535&&e.SheetNames.indexOf(r=s+a)!=-1;++a);}if(XP(r),e.SheetNames.indexOf(r)>=0)throw new Error("Worksheet with name |"+r+"| already exists!");return e.SheetNames.push(r),e.Sheets[r]=t,r}function AX(e,t,r){e.Workbook||(e.Workbook={}),e.Workbook.Sheets||(e.Workbook.Sheets=[]);var n=TX(e,t);switch(e.Workbook.Sheets[n]||(e.Workbook.Sheets[n]={}),r){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+r)}e.Workbook.Sheets[n].Hidden=r}function CX(e,t){return e.z=t,e}function vI(e,t,r){return t?(e.l={Target:t},r&&(e.l.Tooltip=r)):delete e.l,e}function OX(e,t,r){return vI(e,"#"+t,r)}function NX(e,t,r){e.c||(e.c=[]),e.c.push({t,a:r||"SheetJS"})}function PX(e,t,r,n){for(var a=typeof t!="string"?t:Kt(t),i=typeof t=="string"?t:Nt(t),s=a.s.r;s<=a.e.r;++s)for(var o=a.s.c;o<=a.e.c;++o){var c=ef(e,s,o);c.t="n",c.F=i,delete c.v,s==a.s.r&&o==a.s.c&&(c.f=r,n&&(c.D=!0))}var u=hn(e["!ref"]);return u.s.r>a.s.r&&(u.s.r=a.s.r),u.s.c>a.s.c&&(u.s.c=a.s.c),u.e.r<a.e.r&&(u.e.r=a.e.r),u.e.c<a.e.c&&(u.e.c=a.e.c),e["!ref"]=Nt(u),e}var Xd={encode_col:Ft,encode_row:Ut,encode_cell:Rt,encode_range:Nt,decode_col:mb,decode_row:pb,split_cell:bL,decode_cell:sr,decode_range:hn,format_cell:is,sheet_new:_L,sheet_add_aoa:W6,sheet_add_json:mI,sheet_add_dom:tI,aoa_to_sheet:hc,json_to_sheet:EX,table_to_sheet:rI,table_to_book:OV,sheet_to_csv:Db,sheet_to_txt:pI,sheet_to_json:I2,sheet_to_html:eI,sheet_to_formulae:kX,sheet_to_row_object_array:I2,sheet_get_cell:ef,book_new:jb,book_append_sheet:Kf,book_set_sheet_visibility:AX,cell_set_number_format:CX,cell_set_hyperlink:vI,cell_set_internal_link:OX,cell_add_comment:NX,sheet_set_array_formula:PX,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};const IX=e=>new Promise((t,r)=>{try{const n=document.createElement("canvas"),a=n.getContext("2d");if(!a)throw new Error("Canvas context not available");const i=e.split(`
`),s=14,o=18,c=20,u="Courier New, monospace";a.font=`${s}px ${u}`;let d=0;i.forEach(y=>{const _=a.measureText(y).width;_>d&&(d=_)});const h=Math.min(Math.max(d+c*2,600),2e3),p=300,v=i.slice(0,p),x=v.length*o+c*2;n.width=h,n.height=x,a.fillStyle="#ffffff",a.fillRect(0,0,n.width,n.height),a.fillStyle="#000000",a.font=`${s}px ${u}`,a.textBaseline="top",v.forEach((y,_)=>{a.fillText(y,c,c+_*o)}),i.length>p&&(a.fillStyle="#666666",a.fillText(`... e altre ${i.length-p} righe ...`,c,c+p*o));const w=n.toDataURL("image/png");t(w.split(",")[1])}catch(n){r(n)}}),FX=async e=>{let t="";if(e.name.endsWith(".csv"))t=await e.text();else if(e.name.match(/\.(xlsx|xls)$/i)){const n=await e.arrayBuffer(),a=Bl(n,{type:"array"}),i=a.SheetNames[0],s=a.Sheets[i];t=Xd.sheet_to_csv(s)}else{if(e.type.startsWith("image/"))return ql(e);throw new Error("Formato file non supportato. Usa CSV, Excel o Immagini.")}if(!t.trim())throw new Error("Il file sembra vuoto.");return{base64:await IX(t),mimeType:"image/png"}},ql=e=>new Promise((t,r)=>{const n=new Image,a=URL.createObjectURL(e);n.onload=()=>{const i=document.createElement("canvas");let{width:s,height:o}=n;const c=1024;s>o&&s>c?(o=Math.round(o*c/s),s=c):o>=s&&o>c&&(s=Math.round(s*c/o),o=c),i.width=s,i.height=o;const u=i.getContext("2d");if(u){u.drawImage(n,0,0,s,o);const d=e.type==="image/png"?"image/png":"image/jpeg";t({base64:i.toDataURL(d,.8).split(",")[1],mimeType:d})}else r(new Error("Canvas error"))},n.onerror=()=>r(new Error("Image load error")),n.src=a}),up=e=>new Promise((t,r)=>{const n=document.createElement("input");n.type="file",n.accept="image/*",e==="camera"&&(n.capture="environment"),n.onchange=a=>{a.target.files&&a.target.files[0]?t(a.target.files[0]):r(new Error("Nessun file"))},n.click()}),gI=(e,t="excel")=>{const r=new Date().toISOString().slice(0,10);if(t==="excel")try{const n=e.map(s=>({Data:s.date,Ora:s.time||"",Importo:s.amount,Descrizione:s.description,Categoria:s.category,Sottocategoria:s.subcategory||"",Conto:s.accountId,Tags:s.tags?s.tags.join(", "):"",Frequenza:s.frequency==="recurring"?"Ricorrente":"Singola"})),a=Xd.json_to_sheet(n),i=Xd.book_new();Xd.book_append_sheet(i,a,"Spese"),bX(i,`Spese_Export_${r}.xlsx`)}catch(n){console.error("Export Excel failed",n)}else if(t==="json")try{const n=JSON.stringify(e,null,2),a=new Blob([n],{type:"application/json"}),i=URL.createObjectURL(a),s=document.createElement("a");s.href=i,s.download=`Spese_Export_${r}.json`,document.body.appendChild(s),s.click(),document.body.removeChild(s),URL.revokeObjectURL(i)}catch(n){console.error("Export JSON failed",n)}},DX=Object.freeze(Object.defineProperty({__proto__:null,exportExpenses:gI,pickImage:up,processFileToImage:FX,processImageFile:ql},Symbol.toStringTag,{value:"Module"})),Rb="https://script.google.com/macros/s/AKfycbzuAtweyuib21-BX4dQszoxEL5BW-nzVN2Vyum4UZvWH-TzP3GLZB5He1jFkrO6242JPA/exec",jX=async e=>{try{const t=await fetch(Rb,{method:"POST",redirect:"follow",headers:{"Content-Type":"text/plain;charset=utf-8"},body:JSON.stringify({action:"checkUser",email:e})});return t.ok?!!(await t.json()).exists:!1}catch(t){return console.error("Errore check user:",t),!1}},RX=async(e,t,r,n)=>{try{return await fetch(Rb,{method:"POST",mode:"no-cors",headers:{"Content-Type":"text/plain"},body:JSON.stringify({action:"save",email:e,data:t,pinHash:r,pinSalt:n})}),!0}catch(a){return console.error("Errore save cloud:",a),!1}},MX=async e=>{try{const t=await fetch(Rb,{method:"POST",redirect:"follow",headers:{"Content-Type":"text/plain;charset=utf-8"},body:JSON.stringify({action:"load",email:e})});if(!t.ok)throw new Error("Errore rete");const r=await t.json();return r.success&&r.data?{data:r.data,pinHash:r.pinHash,pinSalt:r.pinSalt}:null}catch(t){return console.error("Errore load cloud:",t),null}},LX=e=>{const t=atob(e),r=new Uint8Array(t.length);for(let n=0;n<t.length;n++)r[n]=t.charCodeAt(n);return r.buffer},Y4=e=>{let t="";const r=new Uint8Array(e),n=r.byteLength;for(let a=0;a<n;a++)t+=String.fromCharCode(r[a]);return window.btoa(t)};async function Mb(e,t){const r=t||crypto.getRandomValues(new Uint8Array(16)),n=new TextEncoder,a=await crypto.subtle.importKey("raw",n.encode(e),{name:"PBKDF2"},!1,["deriveBits"]),i=await crypto.subtle.deriveBits({name:"PBKDF2",salt:r,iterations:1e5,hash:"SHA-256"},a,256);return{hash:Y4(i),salt:Y4(r)}}async function BX(e,t,r){if(!e||!t||!r)return!1;try{const n=LX(r),{hash:a}=await Mb(e,n);return a===t}catch(n){return console.error("PIN verification failed",n),!1}}const xI="users_db",Yf=()=>{try{const e=localStorage.getItem(xI);if(!e)return{};const t=JSON.parse(e);return t&&typeof t=="object"?t:{}}catch{return{}}},Lb=e=>{localStorage.setItem(xI,JSON.stringify(e))},fp=e=>e.trim().toLowerCase(),$X=async(e,t)=>{const r=fp(e);if(!r||!r.includes("@"))return{success:!1,message:"Inserisci un indirizzo email valido."};if(!/^\d{4}$/.test(t))return{success:!1,message:"Il PIN deve essere di 4 cifre numeriche."};const n=Yf();if(n[r])return{success:!1,message:"Esiste gi un utente registrato con questa email."};const{hash:a,salt:i}=await Mb(t),s={email:r,pinHash:a,pinSalt:i,createdAt:new Date().toISOString()};return n[r]=s,Lb(n),{success:!0,message:"Registrazione completata."}},yI=async(e,t)=>{const r=fp(e),a=Yf()[r];return a?await BX(t,a.pinHash,a.pinSalt)?{success:!0,token:`${r}:${Date.now()}`}:{success:!1,message:"Credenziali non valide."}:{success:!1,message:"Credenziali non valide."}},UX="https://script.google.com/macros/s/AKfycbzmq-PTrMcMdrYqCRX29_S034zCaj5ttyc3tZhdhjV77wF6n99LKricFgzy7taGqKOo/exec",wI=async e=>{const t=fp(e);if(!t||!t.includes("@"))return{success:!1,message:"Inserisci un indirizzo email valido."};try{const n=`${UX}?action=request&email=${encodeURIComponent(t)}&redirect=${encodeURIComponent("https://jerbamichol-del.github.io/gestore/reset/")}`;await fetch(n,{method:"GET",mode:"no-cors",cache:"no-store"})}catch(r){console.warn("forgotPassword (fire-and-forget) warning:",r)}return{success:!0,message:"Se l'email  registrata, riceverai un link per il reset."}},zX=async(e,t,r)=>{const n=fp(e),a=Yf(),i=a[n];if(!i)return{success:!1,message:"Utente non trovato nel database locale."};if(!/^\d{4}$/.test(r))return{success:!1,message:"Il nuovo PIN deve essere di 4 cifre."};try{const{hash:s,salt:o}=await Mb(r);return i.pinHash=s,i.pinSalt=o,a[n]=i,Lb(a),{success:!0,message:"PIN aggiornato con successo."}}catch(s){return console.error("Errore aggiornando il PIN locale:",s),{success:!1,message:"Errore durante laggiornamento del PIN."}}},dp=e=>g.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...e,children:g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m2.25 15.75 5.159-5.159a2.25 2.25 0 0 1 3.182 0l5.159 5.159m-1.5-1.5 1.409-1.409a2.25 2.25 0 0 1 3.182 0l2.909 2.909m-18 3.75h16.5a1.5 1.5 0 0 0 1.5-1.5V6a1.5 1.5 0 0 0-1.5-1.5H3.75A1.5 1.5 0 0 0 2.25 6v12a1.5 1.5 0 0 0 1.5 1.5Zm16.5-16.5h.008v.008h-.008V4.5Z"})}),WX=e=>g.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...e,children:g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 3.75H6.75a2.25 2.25 0 0 0-2.25 2.25v11.25c0 1.24 1.01 2.25 2.25 2.25h10.5a2.25 2.25 0 0 0 2.25-2.25V6.75a2.25 2.25 0 0 0-2.25-2.25H15M12 15V3.75m0 0L9.75 6m2.25-2.25L14.25 6"})}),HX=e=>g.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...e,children:g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M16.5 10.5V6.75a4.5 4.5 0 0 0-9 0v3.75m-.75 11.25h10.5a2.25 2.25 0 0 0 2.25-2.25v-6.75a2.25 2.25 0 0 0-2.25-2.25H6.75a2.25 2.25 0 0 0-2.25 2.25v6.75a2.25 2.25 0 0 0 2.25 2.25Z"})}),qX=e=>g.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...e,children:[g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3.75 4.875c0-.621.504-1.125 1.125-1.125h4.5c.621 0 1.125.504 1.125 1.125v4.5c0 .621-.504 1.125-1.125 1.125h-4.5A1.125 1.125 0 0 1 3.75 9.375v-4.5ZM3.75 14.625c0-.621.504-1.125 1.125-1.125h4.5c.621 0 1.125.504 1.125 1.125v4.5c0 .621-.504 1.125-1.125 1.125h-4.5a1.125 1.125 0 0 1-1.125-1.125v-4.5ZM13.5 4.875c0-.621.504-1.125 1.125-1.125h4.5c.621 0 1.125.504 1.125 1.125v4.5c0 .621-.504 1.125-1.125 1.125h-4.5A1.125 1.125 0 0 1 13.5 9.375v-4.5Z"}),g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6.75 6.75h.75v.75h-.75v-.75ZM6.75 16.5h.75v.75h-.75v-.75ZM16.5 6.75h.75v.75h-.75v-.75ZM13.5 13.5h.75v.75h-.75v-.75ZM13.5 19.5h.75v.75h-.75v-.75ZM19.5 13.5h.75v.75h-.75v-.75ZM19.5 19.5h.75v.75h-.75v-.75ZM16.5 16.5h.75v.75h-.75v-.75Z"})]}),VX=({pendingSyncs:e,isOnline:t,onInstallClick:r,installPromptEvent:n,onLogout:a,onShowQr:i})=>g.jsx("header",{className:"bg-white shadow-md sticky top-0 z-20",children:g.jsx("div",{className:"mx-auto",children:g.jsxs("div",{className:"py-2 flex items-center justify-between gap-3 px-4 md:px-8 h-[58px]",children:[g.jsx("h1",{className:"text-xl font-bold text-slate-800",children:"Gestore Spese"}),g.jsxs("div",{className:"flex items-center gap-2 sm:gap-4",children:[!t&&g.jsxs("div",{className:"flex items-center gap-2 text-sm font-semibold text-amber-600 bg-amber-100 px-3 py-1.5 rounded-full",children:[g.jsxs("span",{className:"relative flex h-2 w-2",children:[g.jsx("span",{className:"animate-ping absolute inline-flex h-full w-full rounded-full bg-amber-500 opacity-75"}),g.jsx("span",{className:"relative inline-flex rounded-full h-2 w-2 bg-amber-500"})]}),g.jsx("span",{className:"hidden sm:inline",children:"Offline"})]}),e>0&&t&&g.jsxs("div",{className:"flex items-center gap-2 text-sm font-semibold text-indigo-600 bg-indigo-100 px-3 py-1.5 rounded-full",children:[g.jsx(dp,{className:"w-5 h-5"}),g.jsx("span",{children:e}),g.jsx("span",{className:"hidden sm:inline md:inline",children:"in sync"})]}),n&&g.jsxs("button",{onClick:r,className:"flex items-center gap-2 text-sm font-semibold text-indigo-600 bg-indigo-100 px-3 py-1.5 rounded-full hover:bg-indigo-200 transition-colors","aria-label":"Installa App",title:"Installa App",children:[g.jsx(WX,{className:"w-5 h-5"}),g.jsx("span",{className:"hidden sm:inline",children:"Installa"})]}),g.jsx("button",{onClick:i,className:"p-2 text-slate-500 hover:text-indigo-600 hover:bg-indigo-100 rounded-full transition-colors","aria-label":"Mostra QR Code",title:"Condividi via QR",children:g.jsx(qX,{className:"w-6 h-6"})}),g.jsx("button",{onClick:a,className:"p-2 text-slate-500 hover:text-indigo-600 hover:bg-indigo-100 rounded-full transition-colors","aria-label":"Logout",title:"Logout",children:g.jsx(HX,{className:"w-6 h-6"})})]})]})})});function bI(e){var t,r,n="";if(typeof e=="string"||typeof e=="number")n+=e;else if(typeof e=="object")if(Array.isArray(e)){var a=e.length;for(t=0;t<a;t++)e[t]&&(r=bI(e[t]))&&(n&&(n+=" "),n+=r)}else for(r in e)e[r]&&(n&&(n+=" "),n+=r);return n}function Qt(){for(var e,t,r=0,n="",a=arguments.length;r<a;r++)(e=arguments[r])&&(t=bI(e))&&(n&&(n+=" "),n+=t);return n}var tv,Z4;function ra(){if(Z4)return tv;Z4=1;var e=Array.isArray;return tv=e,tv}var rv,Q4;function _I(){if(Q4)return rv;Q4=1;var e=typeof dd=="object"&&dd&&dd.Object===Object&&dd;return rv=e,rv}var nv,J4;function Di(){if(J4)return nv;J4=1;var e=_I(),t=typeof self=="object"&&self&&self.Object===Object&&self,r=e||t||Function("return this")();return nv=r,nv}var av,eT;function Zf(){if(eT)return av;eT=1;var e=Di(),t=e.Symbol;return av=t,av}var iv,tT;function XX(){if(tT)return iv;tT=1;var e=Zf(),t=Object.prototype,r=t.hasOwnProperty,n=t.toString,a=e?e.toStringTag:void 0;function i(s){var o=r.call(s,a),c=s[a];try{s[a]=void 0;var u=!0}catch{}var d=n.call(s);return u&&(o?s[a]=c:delete s[a]),d}return iv=i,iv}var sv,rT;function GX(){if(rT)return sv;rT=1;var e=Object.prototype,t=e.toString;function r(n){return t.call(n)}return sv=r,sv}var ov,nT;function ds(){if(nT)return ov;nT=1;var e=Zf(),t=XX(),r=GX(),n="[object Null]",a="[object Undefined]",i=e?e.toStringTag:void 0;function s(o){return o==null?o===void 0?a:n:i&&i in Object(o)?t(o):r(o)}return ov=s,ov}var lv,aT;function hs(){if(aT)return lv;aT=1;function e(t){return t!=null&&typeof t=="object"}return lv=e,lv}var cv,iT;function mc(){if(iT)return cv;iT=1;var e=ds(),t=hs(),r="[object Symbol]";function n(a){return typeof a=="symbol"||t(a)&&e(a)==r}return cv=n,cv}var uv,sT;function Bb(){if(sT)return uv;sT=1;var e=ra(),t=mc(),r=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,n=/^\w*$/;function a(i,s){if(e(i))return!1;var o=typeof i;return o=="number"||o=="symbol"||o=="boolean"||i==null||t(i)?!0:n.test(i)||!r.test(i)||s!=null&&i in Object(s)}return uv=a,uv}var fv,oT;function Qs(){if(oT)return fv;oT=1;function e(t){var r=typeof t;return t!=null&&(r=="object"||r=="function")}return fv=e,fv}var dv,lT;function $b(){if(lT)return dv;lT=1;var e=ds(),t=Qs(),r="[object AsyncFunction]",n="[object Function]",a="[object GeneratorFunction]",i="[object Proxy]";function s(o){if(!t(o))return!1;var c=e(o);return c==n||c==a||c==r||c==i}return dv=s,dv}var hv,cT;function KX(){if(cT)return hv;cT=1;var e=Di(),t=e["__core-js_shared__"];return hv=t,hv}var pv,uT;function YX(){if(uT)return pv;uT=1;var e=KX(),t=(function(){var n=/[^.]+$/.exec(e&&e.keys&&e.keys.IE_PROTO||"");return n?"Symbol(src)_1."+n:""})();function r(n){return!!t&&t in n}return pv=r,pv}var mv,fT;function SI(){if(fT)return mv;fT=1;var e=Function.prototype,t=e.toString;function r(n){if(n!=null){try{return t.call(n)}catch{}try{return n+""}catch{}}return""}return mv=r,mv}var vv,dT;function ZX(){if(dT)return vv;dT=1;var e=$b(),t=YX(),r=Qs(),n=SI(),a=/[\\^$.*+?()[\]{}|]/g,i=/^\[object .+?Constructor\]$/,s=Function.prototype,o=Object.prototype,c=s.toString,u=o.hasOwnProperty,d=RegExp("^"+c.call(u).replace(a,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function h(p){if(!r(p)||t(p))return!1;var v=e(p)?d:i;return v.test(n(p))}return vv=h,vv}var gv,hT;function QX(){if(hT)return gv;hT=1;function e(t,r){return t==null?void 0:t[r]}return gv=e,gv}var xv,pT;function Zo(){if(pT)return xv;pT=1;var e=ZX(),t=QX();function r(n,a){var i=t(n,a);return e(i)?i:void 0}return xv=r,xv}var yv,mT;function hp(){if(mT)return yv;mT=1;var e=Zo(),t=e(Object,"create");return yv=t,yv}var wv,vT;function JX(){if(vT)return wv;vT=1;var e=hp();function t(){this.__data__=e?e(null):{},this.size=0}return wv=t,wv}var bv,gT;function eG(){if(gT)return bv;gT=1;function e(t){var r=this.has(t)&&delete this.__data__[t];return this.size-=r?1:0,r}return bv=e,bv}var _v,xT;function tG(){if(xT)return _v;xT=1;var e=hp(),t="__lodash_hash_undefined__",r=Object.prototype,n=r.hasOwnProperty;function a(i){var s=this.__data__;if(e){var o=s[i];return o===t?void 0:o}return n.call(s,i)?s[i]:void 0}return _v=a,_v}var Sv,yT;function rG(){if(yT)return Sv;yT=1;var e=hp(),t=Object.prototype,r=t.hasOwnProperty;function n(a){var i=this.__data__;return e?i[a]!==void 0:r.call(i,a)}return Sv=n,Sv}var kv,wT;function nG(){if(wT)return kv;wT=1;var e=hp(),t="__lodash_hash_undefined__";function r(n,a){var i=this.__data__;return this.size+=this.has(n)?0:1,i[n]=e&&a===void 0?t:a,this}return kv=r,kv}var Ev,bT;function aG(){if(bT)return Ev;bT=1;var e=JX(),t=eG(),r=tG(),n=rG(),a=nG();function i(s){var o=-1,c=s==null?0:s.length;for(this.clear();++o<c;){var u=s[o];this.set(u[0],u[1])}}return i.prototype.clear=e,i.prototype.delete=t,i.prototype.get=r,i.prototype.has=n,i.prototype.set=a,Ev=i,Ev}var Tv,_T;function iG(){if(_T)return Tv;_T=1;function e(){this.__data__=[],this.size=0}return Tv=e,Tv}var Av,ST;function Ub(){if(ST)return Av;ST=1;function e(t,r){return t===r||t!==t&&r!==r}return Av=e,Av}var Cv,kT;function pp(){if(kT)return Cv;kT=1;var e=Ub();function t(r,n){for(var a=r.length;a--;)if(e(r[a][0],n))return a;return-1}return Cv=t,Cv}var Ov,ET;function sG(){if(ET)return Ov;ET=1;var e=pp(),t=Array.prototype,r=t.splice;function n(a){var i=this.__data__,s=e(i,a);if(s<0)return!1;var o=i.length-1;return s==o?i.pop():r.call(i,s,1),--this.size,!0}return Ov=n,Ov}var Nv,TT;function oG(){if(TT)return Nv;TT=1;var e=pp();function t(r){var n=this.__data__,a=e(n,r);return a<0?void 0:n[a][1]}return Nv=t,Nv}var Pv,AT;function lG(){if(AT)return Pv;AT=1;var e=pp();function t(r){return e(this.__data__,r)>-1}return Pv=t,Pv}var Iv,CT;function cG(){if(CT)return Iv;CT=1;var e=pp();function t(r,n){var a=this.__data__,i=e(a,r);return i<0?(++this.size,a.push([r,n])):a[i][1]=n,this}return Iv=t,Iv}var Fv,OT;function mp(){if(OT)return Fv;OT=1;var e=iG(),t=sG(),r=oG(),n=lG(),a=cG();function i(s){var o=-1,c=s==null?0:s.length;for(this.clear();++o<c;){var u=s[o];this.set(u[0],u[1])}}return i.prototype.clear=e,i.prototype.delete=t,i.prototype.get=r,i.prototype.has=n,i.prototype.set=a,Fv=i,Fv}var Dv,NT;function zb(){if(NT)return Dv;NT=1;var e=Zo(),t=Di(),r=e(t,"Map");return Dv=r,Dv}var jv,PT;function uG(){if(PT)return jv;PT=1;var e=aG(),t=mp(),r=zb();function n(){this.size=0,this.__data__={hash:new e,map:new(r||t),string:new e}}return jv=n,jv}var Rv,IT;function fG(){if(IT)return Rv;IT=1;function e(t){var r=typeof t;return r=="string"||r=="number"||r=="symbol"||r=="boolean"?t!=="__proto__":t===null}return Rv=e,Rv}var Mv,FT;function vp(){if(FT)return Mv;FT=1;var e=fG();function t(r,n){var a=r.__data__;return e(n)?a[typeof n=="string"?"string":"hash"]:a.map}return Mv=t,Mv}var Lv,DT;function dG(){if(DT)return Lv;DT=1;var e=vp();function t(r){var n=e(this,r).delete(r);return this.size-=n?1:0,n}return Lv=t,Lv}var Bv,jT;function hG(){if(jT)return Bv;jT=1;var e=vp();function t(r){return e(this,r).get(r)}return Bv=t,Bv}var $v,RT;function pG(){if(RT)return $v;RT=1;var e=vp();function t(r){return e(this,r).has(r)}return $v=t,$v}var Uv,MT;function mG(){if(MT)return Uv;MT=1;var e=vp();function t(r,n){var a=e(this,r),i=a.size;return a.set(r,n),this.size+=a.size==i?0:1,this}return Uv=t,Uv}var zv,LT;function Wb(){if(LT)return zv;LT=1;var e=uG(),t=dG(),r=hG(),n=pG(),a=mG();function i(s){var o=-1,c=s==null?0:s.length;for(this.clear();++o<c;){var u=s[o];this.set(u[0],u[1])}}return i.prototype.clear=e,i.prototype.delete=t,i.prototype.get=r,i.prototype.has=n,i.prototype.set=a,zv=i,zv}var Wv,BT;function kI(){if(BT)return Wv;BT=1;var e=Wb(),t="Expected a function";function r(n,a){if(typeof n!="function"||a!=null&&typeof a!="function")throw new TypeError(t);var i=function(){var s=arguments,o=a?a.apply(this,s):s[0],c=i.cache;if(c.has(o))return c.get(o);var u=n.apply(this,s);return i.cache=c.set(o,u)||c,u};return i.cache=new(r.Cache||e),i}return r.Cache=e,Wv=r,Wv}var Hv,$T;function vG(){if($T)return Hv;$T=1;var e=kI(),t=500;function r(n){var a=e(n,function(s){return i.size===t&&i.clear(),s}),i=a.cache;return a}return Hv=r,Hv}var qv,UT;function gG(){if(UT)return qv;UT=1;var e=vG(),t=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,r=/\\(\\)?/g,n=e(function(a){var i=[];return a.charCodeAt(0)===46&&i.push(""),a.replace(t,function(s,o,c,u){i.push(c?u.replace(r,"$1"):o||s)}),i});return qv=n,qv}var Vv,zT;function Hb(){if(zT)return Vv;zT=1;function e(t,r){for(var n=-1,a=t==null?0:t.length,i=Array(a);++n<a;)i[n]=r(t[n],n,t);return i}return Vv=e,Vv}var Xv,WT;function xG(){if(WT)return Xv;WT=1;var e=Zf(),t=Hb(),r=ra(),n=mc(),a=e?e.prototype:void 0,i=a?a.toString:void 0;function s(o){if(typeof o=="string")return o;if(r(o))return t(o,s)+"";if(n(o))return i?i.call(o):"";var c=o+"";return c=="0"&&1/o==-1/0?"-0":c}return Xv=s,Xv}var Gv,HT;function EI(){if(HT)return Gv;HT=1;var e=xG();function t(r){return r==null?"":e(r)}return Gv=t,Gv}var Kv,qT;function TI(){if(qT)return Kv;qT=1;var e=ra(),t=Bb(),r=gG(),n=EI();function a(i,s){return e(i)?i:t(i,s)?[i]:r(n(i))}return Kv=a,Kv}var Yv,VT;function gp(){if(VT)return Yv;VT=1;var e=mc();function t(r){if(typeof r=="string"||e(r))return r;var n=r+"";return n=="0"&&1/r==-1/0?"-0":n}return Yv=t,Yv}var Zv,XT;function qb(){if(XT)return Zv;XT=1;var e=TI(),t=gp();function r(n,a){a=e(a,n);for(var i=0,s=a.length;n!=null&&i<s;)n=n[t(a[i++])];return i&&i==s?n:void 0}return Zv=r,Zv}var Qv,GT;function AI(){if(GT)return Qv;GT=1;var e=qb();function t(r,n,a){var i=r==null?void 0:e(r,n);return i===void 0?a:i}return Qv=t,Qv}var yG=AI();const ui=rr(yG);var Jv,KT;function wG(){if(KT)return Jv;KT=1;function e(t){return t==null}return Jv=e,Jv}var bG=wG();const Vt=rr(bG);var eg,YT;function _G(){if(YT)return eg;YT=1;var e=ds(),t=ra(),r=hs(),n="[object String]";function a(i){return typeof i=="string"||!t(i)&&r(i)&&e(i)==n}return eg=a,eg}var SG=_G();const Qf=rr(SG);var kG=$b();const $t=rr(kG);var EG=Qs();const vc=rr(EG);var tg={exports:{}},nr={};/** @license React v16.13.1
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ZT;function TG(){if(ZT)return nr;ZT=1;var e=typeof Symbol=="function"&&Symbol.for,t=e?Symbol.for("react.element"):60103,r=e?Symbol.for("react.portal"):60106,n=e?Symbol.for("react.fragment"):60107,a=e?Symbol.for("react.strict_mode"):60108,i=e?Symbol.for("react.profiler"):60114,s=e?Symbol.for("react.provider"):60109,o=e?Symbol.for("react.context"):60110,c=e?Symbol.for("react.async_mode"):60111,u=e?Symbol.for("react.concurrent_mode"):60111,d=e?Symbol.for("react.forward_ref"):60112,h=e?Symbol.for("react.suspense"):60113,p=e?Symbol.for("react.suspense_list"):60120,v=e?Symbol.for("react.memo"):60115,x=e?Symbol.for("react.lazy"):60116,w=e?Symbol.for("react.block"):60121,y=e?Symbol.for("react.fundamental"):60117,_=e?Symbol.for("react.responder"):60118,S=e?Symbol.for("react.scope"):60119;function k(T){if(typeof T=="object"&&T!==null){var N=T.$$typeof;switch(N){case t:switch(T=T.type,T){case c:case u:case n:case i:case a:case h:return T;default:switch(T=T&&T.$$typeof,T){case o:case d:case x:case v:case s:return T;default:return N}}case r:return N}}}function E(T){return k(T)===u}return nr.AsyncMode=c,nr.ConcurrentMode=u,nr.ContextConsumer=o,nr.ContextProvider=s,nr.Element=t,nr.ForwardRef=d,nr.Fragment=n,nr.Lazy=x,nr.Memo=v,nr.Portal=r,nr.Profiler=i,nr.StrictMode=a,nr.Suspense=h,nr.isAsyncMode=function(T){return E(T)||k(T)===c},nr.isConcurrentMode=E,nr.isContextConsumer=function(T){return k(T)===o},nr.isContextProvider=function(T){return k(T)===s},nr.isElement=function(T){return typeof T=="object"&&T!==null&&T.$$typeof===t},nr.isForwardRef=function(T){return k(T)===d},nr.isFragment=function(T){return k(T)===n},nr.isLazy=function(T){return k(T)===x},nr.isMemo=function(T){return k(T)===v},nr.isPortal=function(T){return k(T)===r},nr.isProfiler=function(T){return k(T)===i},nr.isStrictMode=function(T){return k(T)===a},nr.isSuspense=function(T){return k(T)===h},nr.isValidElementType=function(T){return typeof T=="string"||typeof T=="function"||T===n||T===u||T===i||T===a||T===h||T===p||typeof T=="object"&&T!==null&&(T.$$typeof===x||T.$$typeof===v||T.$$typeof===s||T.$$typeof===o||T.$$typeof===d||T.$$typeof===y||T.$$typeof===_||T.$$typeof===S||T.$$typeof===w)},nr.typeOf=k,nr}var QT;function AG(){return QT||(QT=1,tg.exports=TG()),tg.exports}var F2=AG(),rg,JT;function CI(){if(JT)return rg;JT=1;var e=ds(),t=hs(),r="[object Number]";function n(a){return typeof a=="number"||t(a)&&e(a)==r}return rg=n,rg}var ng,e5;function CG(){if(e5)return ng;e5=1;var e=CI();function t(r){return e(r)&&r!=+r}return ng=t,ng}var OG=CG();const Jf=rr(OG);var NG=CI();const PG=rr(NG);var za=function(t){return t===0?0:t>0?1:-1},Eo=function(t){return Qf(t)&&t.indexOf("%")===t.length-1},ot=function(t){return PG(t)&&!Jf(t)},en=function(t){return ot(t)||Qf(t)},IG=0,xp=function(t){var r=++IG;return"".concat(t||"").concat(r)},Jn=function(t,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(!ot(t)&&!Qf(t))return n;var i;if(Eo(t)){var s=t.indexOf("%");i=r*parseFloat(t.slice(0,s))/100}else i=+t;return Jf(i)&&(i=n),a&&i>r&&(i=r),i},Cl=function(t){if(!t)return null;var r=Object.keys(t);return r&&r.length?t[r[0]]:null},FG=function(t){if(!Array.isArray(t))return!1;for(var r=t.length,n={},a=0;a<r;a++)if(!n[t[a]])n[t[a]]=!0;else return!0;return!1},t5=function(t,r){return ot(t)&&ot(r)?function(n){return t+n*(r-t)}:function(){return r}};function D2(e,t,r){return!e||!e.length?null:e.find(function(n){return n&&(typeof t=="function"?t(n):ui(n,t))===r})}function j2(e,t){for(var r in e)if({}.hasOwnProperty.call(e,r)&&(!{}.hasOwnProperty.call(t,r)||e[r]!==t[r]))return!1;for(var n in t)if({}.hasOwnProperty.call(t,n)&&!{}.hasOwnProperty.call(e,n))return!1;return!0}function R2(e){"@babel/helpers - typeof";return R2=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},R2(e)}var DG=["viewBox","children"],jG=["aria-activedescendant","aria-atomic","aria-autocomplete","aria-busy","aria-checked","aria-colcount","aria-colindex","aria-colspan","aria-controls","aria-current","aria-describedby","aria-details","aria-disabled","aria-errormessage","aria-expanded","aria-flowto","aria-haspopup","aria-hidden","aria-invalid","aria-keyshortcuts","aria-label","aria-labelledby","aria-level","aria-live","aria-modal","aria-multiline","aria-multiselectable","aria-orientation","aria-owns","aria-placeholder","aria-posinset","aria-pressed","aria-readonly","aria-relevant","aria-required","aria-roledescription","aria-rowcount","aria-rowindex","aria-rowspan","aria-selected","aria-setsize","aria-sort","aria-valuemax","aria-valuemin","aria-valuenow","aria-valuetext","className","color","height","id","lang","max","media","method","min","name","style","target","width","role","tabIndex","accentHeight","accumulate","additive","alignmentBaseline","allowReorder","alphabetic","amplitude","arabicForm","ascent","attributeName","attributeType","autoReverse","azimuth","baseFrequency","baselineShift","baseProfile","bbox","begin","bias","by","calcMode","capHeight","clip","clipPath","clipPathUnits","clipRule","colorInterpolation","colorInterpolationFilters","colorProfile","colorRendering","contentScriptType","contentStyleType","cursor","cx","cy","d","decelerate","descent","diffuseConstant","direction","display","divisor","dominantBaseline","dur","dx","dy","edgeMode","elevation","enableBackground","end","exponent","externalResourcesRequired","fill","fillOpacity","fillRule","filter","filterRes","filterUnits","floodColor","floodOpacity","focusable","fontFamily","fontSize","fontSizeAdjust","fontStretch","fontStyle","fontVariant","fontWeight","format","from","fx","fy","g1","g2","glyphName","glyphOrientationHorizontal","glyphOrientationVertical","glyphRef","gradientTransform","gradientUnits","hanging","horizAdvX","horizOriginX","href","ideographic","imageRendering","in2","in","intercept","k1","k2","k3","k4","k","kernelMatrix","kernelUnitLength","kerning","keyPoints","keySplines","keyTimes","lengthAdjust","letterSpacing","lightingColor","limitingConeAngle","local","markerEnd","markerHeight","markerMid","markerStart","markerUnits","markerWidth","mask","maskContentUnits","maskUnits","mathematical","mode","numOctaves","offset","opacity","operator","order","orient","orientation","origin","overflow","overlinePosition","overlineThickness","paintOrder","panose1","pathLength","patternContentUnits","patternTransform","patternUnits","pointerEvents","pointsAtX","pointsAtY","pointsAtZ","preserveAlpha","preserveAspectRatio","primitiveUnits","r","radius","refX","refY","renderingIntent","repeatCount","repeatDur","requiredExtensions","requiredFeatures","restart","result","rotate","rx","ry","seed","shapeRendering","slope","spacing","specularConstant","specularExponent","speed","spreadMethod","startOffset","stdDeviation","stemh","stemv","stitchTiles","stopColor","stopOpacity","strikethroughPosition","strikethroughThickness","string","stroke","strokeDasharray","strokeDashoffset","strokeLinecap","strokeLinejoin","strokeMiterlimit","strokeOpacity","strokeWidth","surfaceScale","systemLanguage","tableValues","targetX","targetY","textAnchor","textDecoration","textLength","textRendering","to","transform","u1","u2","underlinePosition","underlineThickness","unicode","unicodeBidi","unicodeRange","unitsPerEm","vAlphabetic","values","vectorEffect","version","vertAdvY","vertOriginX","vertOriginY","vHanging","vIdeographic","viewTarget","visibility","vMathematical","widths","wordSpacing","writingMode","x1","x2","x","xChannelSelector","xHeight","xlinkActuate","xlinkArcrole","xlinkHref","xlinkRole","xlinkShow","xlinkTitle","xlinkType","xmlBase","xmlLang","xmlns","xmlnsXlink","xmlSpace","y1","y2","y","yChannelSelector","z","zoomAndPan","ref","key","angle"],r5=["points","pathLength"],ag={svg:DG,polygon:r5,polyline:r5},Vb=["dangerouslySetInnerHTML","onCopy","onCopyCapture","onCut","onCutCapture","onPaste","onPasteCapture","onCompositionEnd","onCompositionEndCapture","onCompositionStart","onCompositionStartCapture","onCompositionUpdate","onCompositionUpdateCapture","onFocus","onFocusCapture","onBlur","onBlurCapture","onChange","onChangeCapture","onBeforeInput","onBeforeInputCapture","onInput","onInputCapture","onReset","onResetCapture","onSubmit","onSubmitCapture","onInvalid","onInvalidCapture","onLoad","onLoadCapture","onError","onErrorCapture","onKeyDown","onKeyDownCapture","onKeyPress","onKeyPressCapture","onKeyUp","onKeyUpCapture","onAbort","onAbortCapture","onCanPlay","onCanPlayCapture","onCanPlayThrough","onCanPlayThroughCapture","onDurationChange","onDurationChangeCapture","onEmptied","onEmptiedCapture","onEncrypted","onEncryptedCapture","onEnded","onEndedCapture","onLoadedData","onLoadedDataCapture","onLoadedMetadata","onLoadedMetadataCapture","onLoadStart","onLoadStartCapture","onPause","onPauseCapture","onPlay","onPlayCapture","onPlaying","onPlayingCapture","onProgress","onProgressCapture","onRateChange","onRateChangeCapture","onSeeked","onSeekedCapture","onSeeking","onSeekingCapture","onStalled","onStalledCapture","onSuspend","onSuspendCapture","onTimeUpdate","onTimeUpdateCapture","onVolumeChange","onVolumeChangeCapture","onWaiting","onWaitingCapture","onAuxClick","onAuxClickCapture","onClick","onClickCapture","onContextMenu","onContextMenuCapture","onDoubleClick","onDoubleClickCapture","onDrag","onDragCapture","onDragEnd","onDragEndCapture","onDragEnter","onDragEnterCapture","onDragExit","onDragExitCapture","onDragLeave","onDragLeaveCapture","onDragOver","onDragOverCapture","onDragStart","onDragStartCapture","onDrop","onDropCapture","onMouseDown","onMouseDownCapture","onMouseEnter","onMouseLeave","onMouseMove","onMouseMoveCapture","onMouseOut","onMouseOutCapture","onMouseOver","onMouseOverCapture","onMouseUp","onMouseUpCapture","onSelect","onSelectCapture","onTouchCancel","onTouchCancelCapture","onTouchEnd","onTouchEndCapture","onTouchMove","onTouchMoveCapture","onTouchStart","onTouchStartCapture","onPointerDown","onPointerDownCapture","onPointerMove","onPointerMoveCapture","onPointerUp","onPointerUpCapture","onPointerCancel","onPointerCancelCapture","onPointerEnter","onPointerEnterCapture","onPointerLeave","onPointerLeaveCapture","onPointerOver","onPointerOverCapture","onPointerOut","onPointerOutCapture","onGotPointerCapture","onGotPointerCaptureCapture","onLostPointerCapture","onLostPointerCaptureCapture","onScroll","onScrollCapture","onWheel","onWheelCapture","onAnimationStart","onAnimationStartCapture","onAnimationEnd","onAnimationEndCapture","onAnimationIteration","onAnimationIterationCapture","onTransitionEnd","onTransitionEndCapture"],uh=function(t,r){if(!t||typeof t=="function"||typeof t=="boolean")return null;var n=t;if(D.isValidElement(t)&&(n=t.props),!vc(n))return null;var a={};return Object.keys(n).forEach(function(i){Vb.includes(i)&&(a[i]=r||function(s){return n[i](n,s)})}),a},RG=function(t,r,n){return function(a){return t(r,n,a),null}},yp=function(t,r,n){if(!vc(t)||R2(t)!=="object")return null;var a=null;return Object.keys(t).forEach(function(i){var s=t[i];Vb.includes(i)&&typeof s=="function"&&(a||(a={}),a[i]=RG(s,r,n))}),a},MG=["children"],LG=["children"];function n5(e,t){if(e==null)return{};var r=BG(e,t),n,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function BG(e,t){if(e==null)return{};var r={},n=Object.keys(e),a,i;for(i=0;i<n.length;i++)a=n[i],!(t.indexOf(a)>=0)&&(r[a]=e[a]);return r}var a5={click:"onClick",mousedown:"onMouseDown",mouseup:"onMouseUp",mouseover:"onMouseOver",mousemove:"onMouseMove",mouseout:"onMouseOut",mouseenter:"onMouseEnter",mouseleave:"onMouseLeave",touchcancel:"onTouchCancel",touchend:"onTouchEnd",touchmove:"onTouchMove",touchstart:"onTouchStart"},rs=function(t){return typeof t=="string"?t:t?t.displayName||t.name||"Component":""},i5=null,ig=null,Xb=function e(t){if(t===i5&&Array.isArray(ig))return ig;var r=[];return D.Children.forEach(t,function(n){Vt(n)||(F2.isFragment(n)?r=r.concat(e(n.props.children)):r.push(n))}),ig=r,i5=t,r};function Ai(e,t){var r=[],n=[];return Array.isArray(t)?n=t.map(function(a){return rs(a)}):n=[rs(t)],Xb(e).forEach(function(a){var i=ui(a,"type.displayName")||ui(a,"type.name");n.indexOf(i)!==-1&&r.push(a)}),r}function Ma(e,t){var r=Ai(e,t);return r&&r[0]}var s5=function(t){if(!t||!t.props)return!1;var r=t.props,n=r.width,a=r.height;return!(!ot(n)||n<=0||!ot(a)||a<=0)},$G=["a","altGlyph","altGlyphDef","altGlyphItem","animate","animateColor","animateMotion","animateTransform","circle","clipPath","color-profile","cursor","defs","desc","ellipse","feBlend","feColormatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence","filter","font","font-face","font-face-format","font-face-name","font-face-url","foreignObject","g","glyph","glyphRef","hkern","image","line","lineGradient","marker","mask","metadata","missing-glyph","mpath","path","pattern","polygon","polyline","radialGradient","rect","script","set","stop","style","svg","switch","symbol","text","textPath","title","tref","tspan","use","view","vkern"],UG=function(t){return t&&t.type&&Qf(t.type)&&$G.indexOf(t.type)>=0},zG=function(t,r,n,a){var i,s=(i=ag==null?void 0:ag[a])!==null&&i!==void 0?i:[];return!$t(t)&&(a&&s.includes(r)||jG.includes(r))||n&&Vb.includes(r)},Mt=function(t,r,n){if(!t||typeof t=="function"||typeof t=="boolean")return null;var a=t;if(D.isValidElement(t)&&(a=t.props),!vc(a))return null;var i={};return Object.keys(a).forEach(function(s){var o;zG((o=a)===null||o===void 0?void 0:o[s],s,r,n)&&(i[s]=a[s])}),i},M2=function e(t,r){if(t===r)return!0;var n=D.Children.count(t);if(n!==D.Children.count(r))return!1;if(n===0)return!0;if(n===1)return o5(Array.isArray(t)?t[0]:t,Array.isArray(r)?r[0]:r);for(var a=0;a<n;a++){var i=t[a],s=r[a];if(Array.isArray(i)||Array.isArray(s)){if(!e(i,s))return!1}else if(!o5(i,s))return!1}return!0},o5=function(t,r){if(Vt(t)&&Vt(r))return!0;if(!Vt(t)&&!Vt(r)){var n=t.props||{},a=n.children,i=n5(n,MG),s=r.props||{},o=s.children,c=n5(s,LG);return a&&o?j2(i,c)&&M2(a,o):!a&&!o?j2(i,c):!1}return!1},l5=function(t,r){var n=[],a={};return Xb(t).forEach(function(i,s){if(UG(i))n.push(i);else if(i){var o=rs(i.type),c=r[o]||{},u=c.handler,d=c.once;if(u&&(!d||!a[o])){var h=u(i,o,s);n.push(h),a[o]=!0}}}),n},WG=function(t){var r=t&&t.type;return r&&a5[r]?a5[r]:null},HG=function(t,r){return Xb(r).indexOf(t)},qG=["children","width","height","viewBox","className","style","title","desc"];function L2(){return L2=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},L2.apply(this,arguments)}function VG(e,t){if(e==null)return{};var r=XG(e,t),n,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function XG(e,t){if(e==null)return{};var r={},n=Object.keys(e),a,i;for(i=0;i<n.length;i++)a=n[i],!(t.indexOf(a)>=0)&&(r[a]=e[a]);return r}function B2(e){var t=e.children,r=e.width,n=e.height,a=e.viewBox,i=e.className,s=e.style,o=e.title,c=e.desc,u=VG(e,qG),d=a||{width:r,height:n,x:0,y:0},h=Qt("recharts-surface",i);return me.createElement("svg",L2({},Mt(u,!0,"svg"),{className:h,width:r,height:n,style:s,viewBox:"".concat(d.x," ").concat(d.y," ").concat(d.width," ").concat(d.height)}),me.createElement("title",null,o),me.createElement("desc",null,c),t)}var GG=["children","className"];function $2(){return $2=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},$2.apply(this,arguments)}function KG(e,t){if(e==null)return{};var r=YG(e,t),n,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function YG(e,t){if(e==null)return{};var r={},n=Object.keys(e),a,i;for(i=0;i<n.length;i++)a=n[i],!(t.indexOf(a)>=0)&&(r[a]=e[a]);return r}var Fr=me.forwardRef(function(e,t){var r=e.children,n=e.className,a=KG(e,GG),i=Qt("recharts-layer",n);return me.createElement("g",$2({className:i},Mt(a,!0),{ref:t}),r)}),ns=function(t,r){for(var n=arguments.length,a=new Array(n>2?n-2:0),i=2;i<n;i++)a[i-2]=arguments[i]},sg,c5;function ZG(){if(c5)return sg;c5=1;function e(t,r,n){var a=-1,i=t.length;r<0&&(r=-r>i?0:i+r),n=n>i?i:n,n<0&&(n+=i),i=r>n?0:n-r>>>0,r>>>=0;for(var s=Array(i);++a<i;)s[a]=t[a+r];return s}return sg=e,sg}var og,u5;function QG(){if(u5)return og;u5=1;var e=ZG();function t(r,n,a){var i=r.length;return a=a===void 0?i:a,!n&&a>=i?r:e(r,n,a)}return og=t,og}var lg,f5;function OI(){if(f5)return lg;f5=1;var e="\\ud800-\\udfff",t="\\u0300-\\u036f",r="\\ufe20-\\ufe2f",n="\\u20d0-\\u20ff",a=t+r+n,i="\\ufe0e\\ufe0f",s="\\u200d",o=RegExp("["+s+e+a+i+"]");function c(u){return o.test(u)}return lg=c,lg}var cg,d5;function JG(){if(d5)return cg;d5=1;function e(t){return t.split("")}return cg=e,cg}var ug,h5;function eK(){if(h5)return ug;h5=1;var e="\\ud800-\\udfff",t="\\u0300-\\u036f",r="\\ufe20-\\ufe2f",n="\\u20d0-\\u20ff",a=t+r+n,i="\\ufe0e\\ufe0f",s="["+e+"]",o="["+a+"]",c="\\ud83c[\\udffb-\\udfff]",u="(?:"+o+"|"+c+")",d="[^"+e+"]",h="(?:\\ud83c[\\udde6-\\uddff]){2}",p="[\\ud800-\\udbff][\\udc00-\\udfff]",v="\\u200d",x=u+"?",w="["+i+"]?",y="(?:"+v+"(?:"+[d,h,p].join("|")+")"+w+x+")*",_=w+x+y,S="(?:"+[d+o+"?",o,h,p,s].join("|")+")",k=RegExp(c+"(?="+c+")|"+S+_,"g");function E(T){return T.match(k)||[]}return ug=E,ug}var fg,p5;function tK(){if(p5)return fg;p5=1;var e=JG(),t=OI(),r=eK();function n(a){return t(a)?r(a):e(a)}return fg=n,fg}var dg,m5;function rK(){if(m5)return dg;m5=1;var e=QG(),t=OI(),r=tK(),n=EI();function a(i){return function(s){s=n(s);var o=t(s)?r(s):void 0,c=o?o[0]:s.charAt(0),u=o?e(o,1).join(""):s.slice(1);return c[i]()+u}}return dg=a,dg}var hg,v5;function nK(){if(v5)return hg;v5=1;var e=rK(),t=e("toUpperCase");return hg=t,hg}var aK=nK();const wp=rr(aK);function gr(e){return function(){return e}}const NI=Math.cos,fh=Math.sin,di=Math.sqrt,dh=Math.PI,bp=2*dh,U2=Math.PI,z2=2*U2,bo=1e-6,iK=z2-bo;function PI(e){this._+=e[0];for(let t=1,r=e.length;t<r;++t)this._+=arguments[t]+e[t]}function sK(e){let t=Math.floor(e);if(!(t>=0))throw new Error(`invalid digits: ${e}`);if(t>15)return PI;const r=10**t;return function(n){this._+=n[0];for(let a=1,i=n.length;a<i;++a)this._+=Math.round(arguments[a]*r)/r+n[a]}}class oK{constructor(t){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=t==null?PI:sK(t)}moveTo(t,r){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+r}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(t,r){this._append`L${this._x1=+t},${this._y1=+r}`}quadraticCurveTo(t,r,n,a){this._append`Q${+t},${+r},${this._x1=+n},${this._y1=+a}`}bezierCurveTo(t,r,n,a,i,s){this._append`C${+t},${+r},${+n},${+a},${this._x1=+i},${this._y1=+s}`}arcTo(t,r,n,a,i){if(t=+t,r=+r,n=+n,a=+a,i=+i,i<0)throw new Error(`negative radius: ${i}`);let s=this._x1,o=this._y1,c=n-t,u=a-r,d=s-t,h=o-r,p=d*d+h*h;if(this._x1===null)this._append`M${this._x1=t},${this._y1=r}`;else if(p>bo)if(!(Math.abs(h*c-u*d)>bo)||!i)this._append`L${this._x1=t},${this._y1=r}`;else{let v=n-s,x=a-o,w=c*c+u*u,y=v*v+x*x,_=Math.sqrt(w),S=Math.sqrt(p),k=i*Math.tan((U2-Math.acos((w+p-y)/(2*_*S)))/2),E=k/S,T=k/_;Math.abs(E-1)>bo&&this._append`L${t+E*d},${r+E*h}`,this._append`A${i},${i},0,0,${+(h*v>d*x)},${this._x1=t+T*c},${this._y1=r+T*u}`}}arc(t,r,n,a,i,s){if(t=+t,r=+r,n=+n,s=!!s,n<0)throw new Error(`negative radius: ${n}`);let o=n*Math.cos(a),c=n*Math.sin(a),u=t+o,d=r+c,h=1^s,p=s?a-i:i-a;this._x1===null?this._append`M${u},${d}`:(Math.abs(this._x1-u)>bo||Math.abs(this._y1-d)>bo)&&this._append`L${u},${d}`,n&&(p<0&&(p=p%z2+z2),p>iK?this._append`A${n},${n},0,1,${h},${t-o},${r-c}A${n},${n},0,1,${h},${this._x1=u},${this._y1=d}`:p>bo&&this._append`A${n},${n},0,${+(p>=U2)},${h},${this._x1=t+n*Math.cos(i)},${this._y1=r+n*Math.sin(i)}`)}rect(t,r,n,a){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+r}h${n=+n}v${+a}h${-n}Z`}toString(){return this._}}function Gb(e){let t=3;return e.digits=function(r){if(!arguments.length)return t;if(r==null)t=null;else{const n=Math.floor(r);if(!(n>=0))throw new RangeError(`invalid digits: ${r}`);t=n}return e},()=>new oK(t)}function Kb(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function II(e){this._context=e}II.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:this._context.lineTo(e,t);break}}};function _p(e){return new II(e)}function FI(e){return e[0]}function DI(e){return e[1]}function jI(e,t){var r=gr(!0),n=null,a=_p,i=null,s=Gb(o);e=typeof e=="function"?e:e===void 0?FI:gr(e),t=typeof t=="function"?t:t===void 0?DI:gr(t);function o(c){var u,d=(c=Kb(c)).length,h,p=!1,v;for(n==null&&(i=a(v=s())),u=0;u<=d;++u)!(u<d&&r(h=c[u],u,c))===p&&((p=!p)?i.lineStart():i.lineEnd()),p&&i.point(+e(h,u,c),+t(h,u,c));if(v)return i=null,v+""||null}return o.x=function(c){return arguments.length?(e=typeof c=="function"?c:gr(+c),o):e},o.y=function(c){return arguments.length?(t=typeof c=="function"?c:gr(+c),o):t},o.defined=function(c){return arguments.length?(r=typeof c=="function"?c:gr(!!c),o):r},o.curve=function(c){return arguments.length?(a=c,n!=null&&(i=a(n)),o):a},o.context=function(c){return arguments.length?(c==null?n=i=null:i=a(n=c),o):n},o}function Cd(e,t,r){var n=null,a=gr(!0),i=null,s=_p,o=null,c=Gb(u);e=typeof e=="function"?e:e===void 0?FI:gr(+e),t=typeof t=="function"?t:gr(t===void 0?0:+t),r=typeof r=="function"?r:r===void 0?DI:gr(+r);function u(h){var p,v,x,w=(h=Kb(h)).length,y,_=!1,S,k=new Array(w),E=new Array(w);for(i==null&&(o=s(S=c())),p=0;p<=w;++p){if(!(p<w&&a(y=h[p],p,h))===_)if(_=!_)v=p,o.areaStart(),o.lineStart();else{for(o.lineEnd(),o.lineStart(),x=p-1;x>=v;--x)o.point(k[x],E[x]);o.lineEnd(),o.areaEnd()}_&&(k[p]=+e(y,p,h),E[p]=+t(y,p,h),o.point(n?+n(y,p,h):k[p],r?+r(y,p,h):E[p]))}if(S)return o=null,S+""||null}function d(){return jI().defined(a).curve(s).context(i)}return u.x=function(h){return arguments.length?(e=typeof h=="function"?h:gr(+h),n=null,u):e},u.x0=function(h){return arguments.length?(e=typeof h=="function"?h:gr(+h),u):e},u.x1=function(h){return arguments.length?(n=h==null?null:typeof h=="function"?h:gr(+h),u):n},u.y=function(h){return arguments.length?(t=typeof h=="function"?h:gr(+h),r=null,u):t},u.y0=function(h){return arguments.length?(t=typeof h=="function"?h:gr(+h),u):t},u.y1=function(h){return arguments.length?(r=h==null?null:typeof h=="function"?h:gr(+h),u):r},u.lineX0=u.lineY0=function(){return d().x(e).y(t)},u.lineY1=function(){return d().x(e).y(r)},u.lineX1=function(){return d().x(n).y(t)},u.defined=function(h){return arguments.length?(a=typeof h=="function"?h:gr(!!h),u):a},u.curve=function(h){return arguments.length?(s=h,i!=null&&(o=s(i)),u):s},u.context=function(h){return arguments.length?(h==null?i=o=null:o=s(i=h),u):i},u}class RI{constructor(t,r){this._context=t,this._x=r}areaStart(){this._line=0}areaEnd(){this._line=NaN}lineStart(){this._point=0}lineEnd(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line}point(t,r){switch(t=+t,r=+r,this._point){case 0:{this._point=1,this._line?this._context.lineTo(t,r):this._context.moveTo(t,r);break}case 1:this._point=2;default:{this._x?this._context.bezierCurveTo(this._x0=(this._x0+t)/2,this._y0,this._x0,r,t,r):this._context.bezierCurveTo(this._x0,this._y0=(this._y0+r)/2,t,this._y0,t,r);break}}this._x0=t,this._y0=r}}function lK(e){return new RI(e,!0)}function cK(e){return new RI(e,!1)}const Yb={draw(e,t){const r=di(t/dh);e.moveTo(r,0),e.arc(0,0,r,0,bp)}},uK={draw(e,t){const r=di(t/5)/2;e.moveTo(-3*r,-r),e.lineTo(-r,-r),e.lineTo(-r,-3*r),e.lineTo(r,-3*r),e.lineTo(r,-r),e.lineTo(3*r,-r),e.lineTo(3*r,r),e.lineTo(r,r),e.lineTo(r,3*r),e.lineTo(-r,3*r),e.lineTo(-r,r),e.lineTo(-3*r,r),e.closePath()}},MI=di(1/3),fK=MI*2,dK={draw(e,t){const r=di(t/fK),n=r*MI;e.moveTo(0,-r),e.lineTo(n,0),e.lineTo(0,r),e.lineTo(-n,0),e.closePath()}},hK={draw(e,t){const r=di(t),n=-r/2;e.rect(n,n,r,r)}},pK=.8908130915292852,LI=fh(dh/10)/fh(7*dh/10),mK=fh(bp/10)*LI,vK=-NI(bp/10)*LI,gK={draw(e,t){const r=di(t*pK),n=mK*r,a=vK*r;e.moveTo(0,-r),e.lineTo(n,a);for(let i=1;i<5;++i){const s=bp*i/5,o=NI(s),c=fh(s);e.lineTo(c*r,-o*r),e.lineTo(o*n-c*a,c*n+o*a)}e.closePath()}},pg=di(3),xK={draw(e,t){const r=-di(t/(pg*3));e.moveTo(0,r*2),e.lineTo(-pg*r,-r),e.lineTo(pg*r,-r),e.closePath()}},Oa=-.5,Na=di(3)/2,W2=1/di(12),yK=(W2/2+1)*3,wK={draw(e,t){const r=di(t/yK),n=r/2,a=r*W2,i=n,s=r*W2+r,o=-i,c=s;e.moveTo(n,a),e.lineTo(i,s),e.lineTo(o,c),e.lineTo(Oa*n-Na*a,Na*n+Oa*a),e.lineTo(Oa*i-Na*s,Na*i+Oa*s),e.lineTo(Oa*o-Na*c,Na*o+Oa*c),e.lineTo(Oa*n+Na*a,Oa*a-Na*n),e.lineTo(Oa*i+Na*s,Oa*s-Na*i),e.lineTo(Oa*o+Na*c,Oa*c-Na*o),e.closePath()}};function bK(e,t){let r=null,n=Gb(a);e=typeof e=="function"?e:gr(e||Yb),t=typeof t=="function"?t:gr(t===void 0?64:+t);function a(){let i;if(r||(r=i=n()),e.apply(this,arguments).draw(r,+t.apply(this,arguments)),i)return r=null,i+""||null}return a.type=function(i){return arguments.length?(e=typeof i=="function"?i:gr(i),a):e},a.size=function(i){return arguments.length?(t=typeof i=="function"?i:gr(+i),a):t},a.context=function(i){return arguments.length?(r=i??null,a):r},a}function hh(){}function ph(e,t,r){e._context.bezierCurveTo((2*e._x0+e._x1)/3,(2*e._y0+e._y1)/3,(e._x0+2*e._x1)/3,(e._y0+2*e._y1)/3,(e._x0+4*e._x1+t)/6,(e._y0+4*e._y1+r)/6)}function BI(e){this._context=e}BI.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:ph(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:ph(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function _K(e){return new BI(e)}function $I(e){this._context=e}$I.prototype={areaStart:hh,areaEnd:hh,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x2,this._y2),this._context.closePath();break}case 2:{this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break}case 3:{this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4);break}}},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._x2=e,this._y2=t;break;case 1:this._point=2,this._x3=e,this._y3=t;break;case 2:this._point=3,this._x4=e,this._y4=t,this._context.moveTo((this._x0+4*this._x1+e)/6,(this._y0+4*this._y1+t)/6);break;default:ph(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function SK(e){return new $I(e)}function UI(e){this._context=e}UI.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var r=(this._x0+4*this._x1+e)/6,n=(this._y0+4*this._y1+t)/6;this._line?this._context.lineTo(r,n):this._context.moveTo(r,n);break;case 3:this._point=4;default:ph(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function kK(e){return new UI(e)}function zI(e){this._context=e}zI.prototype={areaStart:hh,areaEnd:hh,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(e,t){e=+e,t=+t,this._point?this._context.lineTo(e,t):(this._point=1,this._context.moveTo(e,t))}};function EK(e){return new zI(e)}function g5(e){return e<0?-1:1}function x5(e,t,r){var n=e._x1-e._x0,a=t-e._x1,i=(e._y1-e._y0)/(n||a<0&&-0),s=(r-e._y1)/(a||n<0&&-0),o=(i*a+s*n)/(n+a);return(g5(i)+g5(s))*Math.min(Math.abs(i),Math.abs(s),.5*Math.abs(o))||0}function y5(e,t){var r=e._x1-e._x0;return r?(3*(e._y1-e._y0)/r-t)/2:t}function mg(e,t,r){var n=e._x0,a=e._y0,i=e._x1,s=e._y1,o=(i-n)/3;e._context.bezierCurveTo(n+o,a+o*t,i-o,s-o*r,i,s)}function mh(e){this._context=e}mh.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:mg(this,this._t0,y5(this,this._t0));break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){var r=NaN;if(e=+e,t=+t,!(e===this._x1&&t===this._y1)){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,mg(this,y5(this,r=x5(this,e,t)),r);break;default:mg(this,this._t0,r=x5(this,e,t));break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t,this._t0=r}}};function WI(e){this._context=new HI(e)}(WI.prototype=Object.create(mh.prototype)).point=function(e,t){mh.prototype.point.call(this,t,e)};function HI(e){this._context=e}HI.prototype={moveTo:function(e,t){this._context.moveTo(t,e)},closePath:function(){this._context.closePath()},lineTo:function(e,t){this._context.lineTo(t,e)},bezierCurveTo:function(e,t,r,n,a,i){this._context.bezierCurveTo(t,e,n,r,i,a)}};function TK(e){return new mh(e)}function AK(e){return new WI(e)}function qI(e){this._context=e}qI.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var e=this._x,t=this._y,r=e.length;if(r)if(this._line?this._context.lineTo(e[0],t[0]):this._context.moveTo(e[0],t[0]),r===2)this._context.lineTo(e[1],t[1]);else for(var n=w5(e),a=w5(t),i=0,s=1;s<r;++i,++s)this._context.bezierCurveTo(n[0][i],a[0][i],n[1][i],a[1][i],e[s],t[s]);(this._line||this._line!==0&&r===1)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(e,t){this._x.push(+e),this._y.push(+t)}};function w5(e){var t,r=e.length-1,n,a=new Array(r),i=new Array(r),s=new Array(r);for(a[0]=0,i[0]=2,s[0]=e[0]+2*e[1],t=1;t<r-1;++t)a[t]=1,i[t]=4,s[t]=4*e[t]+2*e[t+1];for(a[r-1]=2,i[r-1]=7,s[r-1]=8*e[r-1]+e[r],t=1;t<r;++t)n=a[t]/i[t-1],i[t]-=n,s[t]-=n*s[t-1];for(a[r-1]=s[r-1]/i[r-1],t=r-2;t>=0;--t)a[t]=(s[t]-a[t+1])/i[t];for(i[r-1]=(e[r]+a[r-1])/2,t=0;t<r-1;++t)i[t]=2*e[t+1]-a[t+1];return[a,i]}function CK(e){return new qI(e)}function Sp(e,t){this._context=e,this._t=t}Sp.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&this._point===2&&this._context.lineTo(this._x,this._y),(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:{if(this._t<=0)this._context.lineTo(this._x,t),this._context.lineTo(e,t);else{var r=this._x*(1-this._t)+e*this._t;this._context.lineTo(r,this._y),this._context.lineTo(r,t)}break}}this._x=e,this._y=t}};function OK(e){return new Sp(e,.5)}function NK(e){return new Sp(e,0)}function PK(e){return new Sp(e,1)}function Vl(e,t){if((s=e.length)>1)for(var r=1,n,a,i=e[t[0]],s,o=i.length;r<s;++r)for(a=i,i=e[t[r]],n=0;n<o;++n)i[n][1]+=i[n][0]=isNaN(a[n][1])?a[n][0]:a[n][1]}function H2(e){for(var t=e.length,r=new Array(t);--t>=0;)r[t]=t;return r}function IK(e,t){return e[t]}function FK(e){const t=[];return t.key=e,t}function DK(){var e=gr([]),t=H2,r=Vl,n=IK;function a(i){var s=Array.from(e.apply(this,arguments),FK),o,c=s.length,u=-1,d;for(const h of i)for(o=0,++u;o<c;++o)(s[o][u]=[0,+n(h,s[o].key,u,i)]).data=h;for(o=0,d=Kb(t(s));o<c;++o)s[d[o]].index=o;return r(s,d),s}return a.keys=function(i){return arguments.length?(e=typeof i=="function"?i:gr(Array.from(i)),a):e},a.value=function(i){return arguments.length?(n=typeof i=="function"?i:gr(+i),a):n},a.order=function(i){return arguments.length?(t=i==null?H2:typeof i=="function"?i:gr(Array.from(i)),a):t},a.offset=function(i){return arguments.length?(r=i??Vl,a):r},a}function jK(e,t){if((n=e.length)>0){for(var r,n,a=0,i=e[0].length,s;a<i;++a){for(s=r=0;r<n;++r)s+=e[r][a][1]||0;if(s)for(r=0;r<n;++r)e[r][a][1]/=s}Vl(e,t)}}function RK(e,t){if((a=e.length)>0){for(var r=0,n=e[t[0]],a,i=n.length;r<i;++r){for(var s=0,o=0;s<a;++s)o+=e[s][r][1]||0;n[r][1]+=n[r][0]=-o/2}Vl(e,t)}}function MK(e,t){if(!(!((s=e.length)>0)||!((i=(a=e[t[0]]).length)>0))){for(var r=0,n=1,a,i,s;n<i;++n){for(var o=0,c=0,u=0;o<s;++o){for(var d=e[t[o]],h=d[n][1]||0,p=d[n-1][1]||0,v=(h-p)/2,x=0;x<o;++x){var w=e[t[x]],y=w[n][1]||0,_=w[n-1][1]||0;v+=y-_}c+=h,u+=v*h}a[n-1][1]+=a[n-1][0]=r,c&&(r-=u/c)}a[n-1][1]+=a[n-1][0]=r,Vl(e,t)}}function tf(e){"@babel/helpers - typeof";return tf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},tf(e)}var LK=["type","size","sizeType"];function q2(){return q2=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},q2.apply(this,arguments)}function b5(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function _5(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?b5(Object(r),!0).forEach(function(n){BK(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):b5(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function BK(e,t,r){return t=$K(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function $K(e){var t=UK(e,"string");return tf(t)=="symbol"?t:String(t)}function UK(e,t){if(tf(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(tf(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function zK(e,t){if(e==null)return{};var r=WK(e,t),n,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function WK(e,t){if(e==null)return{};var r={},n=Object.keys(e),a,i;for(i=0;i<n.length;i++)a=n[i],!(t.indexOf(a)>=0)&&(r[a]=e[a]);return r}var VI={symbolCircle:Yb,symbolCross:uK,symbolDiamond:dK,symbolSquare:hK,symbolStar:gK,symbolTriangle:xK,symbolWye:wK},HK=Math.PI/180,qK=function(t){var r="symbol".concat(wp(t));return VI[r]||Yb},VK=function(t,r,n){if(r==="area")return t;switch(n){case"cross":return 5*t*t/9;case"diamond":return .5*t*t/Math.sqrt(3);case"square":return t*t;case"star":{var a=18*HK;return 1.25*t*t*(Math.tan(a)-Math.tan(a*2)*Math.pow(Math.tan(a),2))}case"triangle":return Math.sqrt(3)*t*t/4;case"wye":return(21-10*Math.sqrt(3))*t*t/8;default:return Math.PI*t*t/4}},XK=function(t,r){VI["symbol".concat(wp(t))]=r},Zb=function(t){var r=t.type,n=r===void 0?"circle":r,a=t.size,i=a===void 0?64:a,s=t.sizeType,o=s===void 0?"area":s,c=zK(t,LK),u=_5(_5({},c),{},{type:n,size:i,sizeType:o}),d=function(){var y=qK(n),_=bK().type(y).size(VK(i,o,n));return _()},h=u.className,p=u.cx,v=u.cy,x=Mt(u,!0);return p===+p&&v===+v&&i===+i?me.createElement("path",q2({},x,{className:Qt("recharts-symbols",h),transform:"translate(".concat(p,", ").concat(v,")"),d:d()})):null};Zb.registerSymbol=XK;function Xl(e){"@babel/helpers - typeof";return Xl=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Xl(e)}function V2(){return V2=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},V2.apply(this,arguments)}function S5(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function GK(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?S5(Object(r),!0).forEach(function(n){rf(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):S5(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function KK(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function YK(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,GI(n.key),n)}}function ZK(e,t,r){return t&&YK(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function QK(e,t,r){return t=vh(t),JK(e,XI()?Reflect.construct(t,r||[],vh(e).constructor):t.apply(e,r))}function JK(e,t){if(t&&(Xl(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return eY(e)}function eY(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function XI(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(XI=function(){return!!e})()}function vh(e){return vh=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},vh(e)}function tY(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&X2(e,t)}function X2(e,t){return X2=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},X2(e,t)}function rf(e,t,r){return t=GI(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function GI(e){var t=rY(e,"string");return Xl(t)=="symbol"?t:String(t)}function rY(e,t){if(Xl(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Xl(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var Pa=32,Qb=(function(e){tY(t,e);function t(){return KK(this,t),QK(this,t,arguments)}return ZK(t,[{key:"renderIcon",value:function(n){var a=this.props.inactiveColor,i=Pa/2,s=Pa/6,o=Pa/3,c=n.inactive?a:n.color;if(n.type==="plainline")return me.createElement("line",{strokeWidth:4,fill:"none",stroke:c,strokeDasharray:n.payload.strokeDasharray,x1:0,y1:i,x2:Pa,y2:i,className:"recharts-legend-icon"});if(n.type==="line")return me.createElement("path",{strokeWidth:4,fill:"none",stroke:c,d:"M0,".concat(i,"h").concat(o,`
            A`).concat(s,",").concat(s,",0,1,1,").concat(2*o,",").concat(i,`
            H`).concat(Pa,"M").concat(2*o,",").concat(i,`
            A`).concat(s,",").concat(s,",0,1,1,").concat(o,",").concat(i),className:"recharts-legend-icon"});if(n.type==="rect")return me.createElement("path",{stroke:"none",fill:c,d:"M0,".concat(Pa/8,"h").concat(Pa,"v").concat(Pa*3/4,"h").concat(-Pa,"z"),className:"recharts-legend-icon"});if(me.isValidElement(n.legendIcon)){var u=GK({},n);return delete u.legendIcon,me.cloneElement(n.legendIcon,u)}return me.createElement(Zb,{fill:c,cx:i,cy:i,size:Pa,sizeType:"diameter",type:n.type})}},{key:"renderItems",value:function(){var n=this,a=this.props,i=a.payload,s=a.iconSize,o=a.layout,c=a.formatter,u=a.inactiveColor,d={x:0,y:0,width:Pa,height:Pa},h={display:o==="horizontal"?"inline-block":"block",marginRight:10},p={display:"inline-block",verticalAlign:"middle",marginRight:4};return i.map(function(v,x){var w=v.formatter||c,y=Qt(rf(rf({"recharts-legend-item":!0},"legend-item-".concat(x),!0),"inactive",v.inactive));if(v.type==="none")return null;var _=$t(v.value)?null:v.value;ns(!$t(v.value),`The name property is also required when using a function for the dataKey of a chart's cartesian components. Ex: <Bar name="Name of my Data"/>`);var S=v.inactive?u:v.color;return me.createElement("li",V2({className:y,style:h,key:"legend-item-".concat(x)},yp(n.props,v,x)),me.createElement(B2,{width:s,height:s,viewBox:d,style:p},n.renderIcon(v)),me.createElement("span",{className:"recharts-legend-item-text",style:{color:S}},w?w(_,v,x):_))})}},{key:"render",value:function(){var n=this.props,a=n.payload,i=n.layout,s=n.align;if(!a||!a.length)return null;var o={padding:0,margin:0,textAlign:i==="horizontal"?s:"left"};return me.createElement("ul",{className:"recharts-default-legend",style:o},this.renderItems())}}]),t})(D.PureComponent);rf(Qb,"displayName","Legend");rf(Qb,"defaultProps",{iconSize:14,layout:"horizontal",align:"center",verticalAlign:"middle",inactiveColor:"#ccc"});var vg,k5;function nY(){if(k5)return vg;k5=1;var e=mp();function t(){this.__data__=new e,this.size=0}return vg=t,vg}var gg,E5;function aY(){if(E5)return gg;E5=1;function e(t){var r=this.__data__,n=r.delete(t);return this.size=r.size,n}return gg=e,gg}var xg,T5;function iY(){if(T5)return xg;T5=1;function e(t){return this.__data__.get(t)}return xg=e,xg}var yg,A5;function sY(){if(A5)return yg;A5=1;function e(t){return this.__data__.has(t)}return yg=e,yg}var wg,C5;function oY(){if(C5)return wg;C5=1;var e=mp(),t=zb(),r=Wb(),n=200;function a(i,s){var o=this.__data__;if(o instanceof e){var c=o.__data__;if(!t||c.length<n-1)return c.push([i,s]),this.size=++o.size,this;o=this.__data__=new r(c)}return o.set(i,s),this.size=o.size,this}return wg=a,wg}var bg,O5;function KI(){if(O5)return bg;O5=1;var e=mp(),t=nY(),r=aY(),n=iY(),a=sY(),i=oY();function s(o){var c=this.__data__=new e(o);this.size=c.size}return s.prototype.clear=t,s.prototype.delete=r,s.prototype.get=n,s.prototype.has=a,s.prototype.set=i,bg=s,bg}var _g,N5;function lY(){if(N5)return _g;N5=1;var e="__lodash_hash_undefined__";function t(r){return this.__data__.set(r,e),this}return _g=t,_g}var Sg,P5;function cY(){if(P5)return Sg;P5=1;function e(t){return this.__data__.has(t)}return Sg=e,Sg}var kg,I5;function YI(){if(I5)return kg;I5=1;var e=Wb(),t=lY(),r=cY();function n(a){var i=-1,s=a==null?0:a.length;for(this.__data__=new e;++i<s;)this.add(a[i])}return n.prototype.add=n.prototype.push=t,n.prototype.has=r,kg=n,kg}var Eg,F5;function ZI(){if(F5)return Eg;F5=1;function e(t,r){for(var n=-1,a=t==null?0:t.length;++n<a;)if(r(t[n],n,t))return!0;return!1}return Eg=e,Eg}var Tg,D5;function QI(){if(D5)return Tg;D5=1;function e(t,r){return t.has(r)}return Tg=e,Tg}var Ag,j5;function JI(){if(j5)return Ag;j5=1;var e=YI(),t=ZI(),r=QI(),n=1,a=2;function i(s,o,c,u,d,h){var p=c&n,v=s.length,x=o.length;if(v!=x&&!(p&&x>v))return!1;var w=h.get(s),y=h.get(o);if(w&&y)return w==o&&y==s;var _=-1,S=!0,k=c&a?new e:void 0;for(h.set(s,o),h.set(o,s);++_<v;){var E=s[_],T=o[_];if(u)var N=p?u(T,E,_,o,s,h):u(E,T,_,s,o,h);if(N!==void 0){if(N)continue;S=!1;break}if(k){if(!t(o,function(C,P){if(!r(k,P)&&(E===C||d(E,C,c,u,h)))return k.push(P)})){S=!1;break}}else if(!(E===T||d(E,T,c,u,h))){S=!1;break}}return h.delete(s),h.delete(o),S}return Ag=i,Ag}var Cg,R5;function uY(){if(R5)return Cg;R5=1;var e=Di(),t=e.Uint8Array;return Cg=t,Cg}var Og,M5;function fY(){if(M5)return Og;M5=1;function e(t){var r=-1,n=Array(t.size);return t.forEach(function(a,i){n[++r]=[i,a]}),n}return Og=e,Og}var Ng,L5;function Jb(){if(L5)return Ng;L5=1;function e(t){var r=-1,n=Array(t.size);return t.forEach(function(a){n[++r]=a}),n}return Ng=e,Ng}var Pg,B5;function dY(){if(B5)return Pg;B5=1;var e=Zf(),t=uY(),r=Ub(),n=JI(),a=fY(),i=Jb(),s=1,o=2,c="[object Boolean]",u="[object Date]",d="[object Error]",h="[object Map]",p="[object Number]",v="[object RegExp]",x="[object Set]",w="[object String]",y="[object Symbol]",_="[object ArrayBuffer]",S="[object DataView]",k=e?e.prototype:void 0,E=k?k.valueOf:void 0;function T(N,C,P,j,R,I,F){switch(P){case S:if(N.byteLength!=C.byteLength||N.byteOffset!=C.byteOffset)return!1;N=N.buffer,C=C.buffer;case _:return!(N.byteLength!=C.byteLength||!I(new t(N),new t(C)));case c:case u:case p:return r(+N,+C);case d:return N.name==C.name&&N.message==C.message;case v:case w:return N==C+"";case h:var L=a;case x:var H=j&s;if(L||(L=i),N.size!=C.size&&!H)return!1;var V=F.get(N);if(V)return V==C;j|=o,F.set(N,C);var J=n(L(N),L(C),j,R,I,F);return F.delete(N),J;case y:if(E)return E.call(N)==E.call(C)}return!1}return Pg=T,Pg}var Ig,$5;function e8(){if($5)return Ig;$5=1;function e(t,r){for(var n=-1,a=r.length,i=t.length;++n<a;)t[i+n]=r[n];return t}return Ig=e,Ig}var Fg,U5;function hY(){if(U5)return Fg;U5=1;var e=e8(),t=ra();function r(n,a,i){var s=a(n);return t(n)?s:e(s,i(n))}return Fg=r,Fg}var Dg,z5;function pY(){if(z5)return Dg;z5=1;function e(t,r){for(var n=-1,a=t==null?0:t.length,i=0,s=[];++n<a;){var o=t[n];r(o,n,t)&&(s[i++]=o)}return s}return Dg=e,Dg}var jg,W5;function mY(){if(W5)return jg;W5=1;function e(){return[]}return jg=e,jg}var Rg,H5;function vY(){if(H5)return Rg;H5=1;var e=pY(),t=mY(),r=Object.prototype,n=r.propertyIsEnumerable,a=Object.getOwnPropertySymbols,i=a?function(s){return s==null?[]:(s=Object(s),e(a(s),function(o){return n.call(s,o)}))}:t;return Rg=i,Rg}var Mg,q5;function gY(){if(q5)return Mg;q5=1;function e(t,r){for(var n=-1,a=Array(t);++n<t;)a[n]=r(n);return a}return Mg=e,Mg}var Lg,V5;function xY(){if(V5)return Lg;V5=1;var e=ds(),t=hs(),r="[object Arguments]";function n(a){return t(a)&&e(a)==r}return Lg=n,Lg}var Bg,X5;function e_(){if(X5)return Bg;X5=1;var e=xY(),t=hs(),r=Object.prototype,n=r.hasOwnProperty,a=r.propertyIsEnumerable,i=e((function(){return arguments})())?e:function(s){return t(s)&&n.call(s,"callee")&&!a.call(s,"callee")};return Bg=i,Bg}var pu={exports:{}},$g,G5;function yY(){if(G5)return $g;G5=1;function e(){return!1}return $g=e,$g}pu.exports;var K5;function t8(){return K5||(K5=1,(function(e,t){var r=Di(),n=yY(),a=t&&!t.nodeType&&t,i=a&&!0&&e&&!e.nodeType&&e,s=i&&i.exports===a,o=s?r.Buffer:void 0,c=o?o.isBuffer:void 0,u=c||n;e.exports=u})(pu,pu.exports)),pu.exports}var Ug,Y5;function t_(){if(Y5)return Ug;Y5=1;var e=9007199254740991,t=/^(?:0|[1-9]\d*)$/;function r(n,a){var i=typeof n;return a=a??e,!!a&&(i=="number"||i!="symbol"&&t.test(n))&&n>-1&&n%1==0&&n<a}return Ug=r,Ug}var zg,Z5;function r_(){if(Z5)return zg;Z5=1;var e=9007199254740991;function t(r){return typeof r=="number"&&r>-1&&r%1==0&&r<=e}return zg=t,zg}var Wg,Q5;function wY(){if(Q5)return Wg;Q5=1;var e=ds(),t=r_(),r=hs(),n="[object Arguments]",a="[object Array]",i="[object Boolean]",s="[object Date]",o="[object Error]",c="[object Function]",u="[object Map]",d="[object Number]",h="[object Object]",p="[object RegExp]",v="[object Set]",x="[object String]",w="[object WeakMap]",y="[object ArrayBuffer]",_="[object DataView]",S="[object Float32Array]",k="[object Float64Array]",E="[object Int8Array]",T="[object Int16Array]",N="[object Int32Array]",C="[object Uint8Array]",P="[object Uint8ClampedArray]",j="[object Uint16Array]",R="[object Uint32Array]",I={};I[S]=I[k]=I[E]=I[T]=I[N]=I[C]=I[P]=I[j]=I[R]=!0,I[n]=I[a]=I[y]=I[i]=I[_]=I[s]=I[o]=I[c]=I[u]=I[d]=I[h]=I[p]=I[v]=I[x]=I[w]=!1;function F(L){return r(L)&&t(L.length)&&!!I[e(L)]}return Wg=F,Wg}var Hg,J5;function r8(){if(J5)return Hg;J5=1;function e(t){return function(r){return t(r)}}return Hg=e,Hg}var mu={exports:{}};mu.exports;var eA;function bY(){return eA||(eA=1,(function(e,t){var r=_I(),n=t&&!t.nodeType&&t,a=n&&!0&&e&&!e.nodeType&&e,i=a&&a.exports===n,s=i&&r.process,o=(function(){try{var c=a&&a.require&&a.require("util").types;return c||s&&s.binding&&s.binding("util")}catch{}})();e.exports=o})(mu,mu.exports)),mu.exports}var qg,tA;function n8(){if(tA)return qg;tA=1;var e=wY(),t=r8(),r=bY(),n=r&&r.isTypedArray,a=n?t(n):e;return qg=a,qg}var Vg,rA;function _Y(){if(rA)return Vg;rA=1;var e=gY(),t=e_(),r=ra(),n=t8(),a=t_(),i=n8(),s=Object.prototype,o=s.hasOwnProperty;function c(u,d){var h=r(u),p=!h&&t(u),v=!h&&!p&&n(u),x=!h&&!p&&!v&&i(u),w=h||p||v||x,y=w?e(u.length,String):[],_=y.length;for(var S in u)(d||o.call(u,S))&&!(w&&(S=="length"||v&&(S=="offset"||S=="parent")||x&&(S=="buffer"||S=="byteLength"||S=="byteOffset")||a(S,_)))&&y.push(S);return y}return Vg=c,Vg}var Xg,nA;function SY(){if(nA)return Xg;nA=1;var e=Object.prototype;function t(r){var n=r&&r.constructor,a=typeof n=="function"&&n.prototype||e;return r===a}return Xg=t,Xg}var Gg,aA;function a8(){if(aA)return Gg;aA=1;function e(t,r){return function(n){return t(r(n))}}return Gg=e,Gg}var Kg,iA;function kY(){if(iA)return Kg;iA=1;var e=a8(),t=e(Object.keys,Object);return Kg=t,Kg}var Yg,sA;function EY(){if(sA)return Yg;sA=1;var e=SY(),t=kY(),r=Object.prototype,n=r.hasOwnProperty;function a(i){if(!e(i))return t(i);var s=[];for(var o in Object(i))n.call(i,o)&&o!="constructor"&&s.push(o);return s}return Yg=a,Yg}var Zg,oA;function e0(){if(oA)return Zg;oA=1;var e=$b(),t=r_();function r(n){return n!=null&&t(n.length)&&!e(n)}return Zg=r,Zg}var Qg,lA;function kp(){if(lA)return Qg;lA=1;var e=_Y(),t=EY(),r=e0();function n(a){return r(a)?e(a):t(a)}return Qg=n,Qg}var Jg,cA;function TY(){if(cA)return Jg;cA=1;var e=hY(),t=vY(),r=kp();function n(a){return e(a,r,t)}return Jg=n,Jg}var ex,uA;function AY(){if(uA)return ex;uA=1;var e=TY(),t=1,r=Object.prototype,n=r.hasOwnProperty;function a(i,s,o,c,u,d){var h=o&t,p=e(i),v=p.length,x=e(s),w=x.length;if(v!=w&&!h)return!1;for(var y=v;y--;){var _=p[y];if(!(h?_ in s:n.call(s,_)))return!1}var S=d.get(i),k=d.get(s);if(S&&k)return S==s&&k==i;var E=!0;d.set(i,s),d.set(s,i);for(var T=h;++y<v;){_=p[y];var N=i[_],C=s[_];if(c)var P=h?c(C,N,_,s,i,d):c(N,C,_,i,s,d);if(!(P===void 0?N===C||u(N,C,o,c,d):P)){E=!1;break}T||(T=_=="constructor")}if(E&&!T){var j=i.constructor,R=s.constructor;j!=R&&"constructor"in i&&"constructor"in s&&!(typeof j=="function"&&j instanceof j&&typeof R=="function"&&R instanceof R)&&(E=!1)}return d.delete(i),d.delete(s),E}return ex=a,ex}var tx,fA;function CY(){if(fA)return tx;fA=1;var e=Zo(),t=Di(),r=e(t,"DataView");return tx=r,tx}var rx,dA;function OY(){if(dA)return rx;dA=1;var e=Zo(),t=Di(),r=e(t,"Promise");return rx=r,rx}var nx,hA;function i8(){if(hA)return nx;hA=1;var e=Zo(),t=Di(),r=e(t,"Set");return nx=r,nx}var ax,pA;function NY(){if(pA)return ax;pA=1;var e=Zo(),t=Di(),r=e(t,"WeakMap");return ax=r,ax}var ix,mA;function PY(){if(mA)return ix;mA=1;var e=CY(),t=zb(),r=OY(),n=i8(),a=NY(),i=ds(),s=SI(),o="[object Map]",c="[object Object]",u="[object Promise]",d="[object Set]",h="[object WeakMap]",p="[object DataView]",v=s(e),x=s(t),w=s(r),y=s(n),_=s(a),S=i;return(e&&S(new e(new ArrayBuffer(1)))!=p||t&&S(new t)!=o||r&&S(r.resolve())!=u||n&&S(new n)!=d||a&&S(new a)!=h)&&(S=function(k){var E=i(k),T=E==c?k.constructor:void 0,N=T?s(T):"";if(N)switch(N){case v:return p;case x:return o;case w:return u;case y:return d;case _:return h}return E}),ix=S,ix}var sx,vA;function IY(){if(vA)return sx;vA=1;var e=KI(),t=JI(),r=dY(),n=AY(),a=PY(),i=ra(),s=t8(),o=n8(),c=1,u="[object Arguments]",d="[object Array]",h="[object Object]",p=Object.prototype,v=p.hasOwnProperty;function x(w,y,_,S,k,E){var T=i(w),N=i(y),C=T?d:a(w),P=N?d:a(y);C=C==u?h:C,P=P==u?h:P;var j=C==h,R=P==h,I=C==P;if(I&&s(w)){if(!s(y))return!1;T=!0,j=!1}if(I&&!j)return E||(E=new e),T||o(w)?t(w,y,_,S,k,E):r(w,y,C,_,S,k,E);if(!(_&c)){var F=j&&v.call(w,"__wrapped__"),L=R&&v.call(y,"__wrapped__");if(F||L){var H=F?w.value():w,V=L?y.value():y;return E||(E=new e),k(H,V,_,S,E)}}return I?(E||(E=new e),n(w,y,_,S,k,E)):!1}return sx=x,sx}var ox,gA;function n_(){if(gA)return ox;gA=1;var e=IY(),t=hs();function r(n,a,i,s,o){return n===a?!0:n==null||a==null||!t(n)&&!t(a)?n!==n&&a!==a:e(n,a,i,s,r,o)}return ox=r,ox}var lx,xA;function FY(){if(xA)return lx;xA=1;var e=KI(),t=n_(),r=1,n=2;function a(i,s,o,c){var u=o.length,d=u,h=!c;if(i==null)return!d;for(i=Object(i);u--;){var p=o[u];if(h&&p[2]?p[1]!==i[p[0]]:!(p[0]in i))return!1}for(;++u<d;){p=o[u];var v=p[0],x=i[v],w=p[1];if(h&&p[2]){if(x===void 0&&!(v in i))return!1}else{var y=new e;if(c)var _=c(x,w,v,i,s,y);if(!(_===void 0?t(w,x,r|n,c,y):_))return!1}}return!0}return lx=a,lx}var cx,yA;function s8(){if(yA)return cx;yA=1;var e=Qs();function t(r){return r===r&&!e(r)}return cx=t,cx}var ux,wA;function DY(){if(wA)return ux;wA=1;var e=s8(),t=kp();function r(n){for(var a=t(n),i=a.length;i--;){var s=a[i],o=n[s];a[i]=[s,o,e(o)]}return a}return ux=r,ux}var fx,bA;function o8(){if(bA)return fx;bA=1;function e(t,r){return function(n){return n==null?!1:n[t]===r&&(r!==void 0||t in Object(n))}}return fx=e,fx}var dx,_A;function jY(){if(_A)return dx;_A=1;var e=FY(),t=DY(),r=o8();function n(a){var i=t(a);return i.length==1&&i[0][2]?r(i[0][0],i[0][1]):function(s){return s===a||e(s,a,i)}}return dx=n,dx}var hx,SA;function RY(){if(SA)return hx;SA=1;function e(t,r){return t!=null&&r in Object(t)}return hx=e,hx}var px,kA;function MY(){if(kA)return px;kA=1;var e=TI(),t=e_(),r=ra(),n=t_(),a=r_(),i=gp();function s(o,c,u){c=e(c,o);for(var d=-1,h=c.length,p=!1;++d<h;){var v=i(c[d]);if(!(p=o!=null&&u(o,v)))break;o=o[v]}return p||++d!=h?p:(h=o==null?0:o.length,!!h&&a(h)&&n(v,h)&&(r(o)||t(o)))}return px=s,px}var mx,EA;function LY(){if(EA)return mx;EA=1;var e=RY(),t=MY();function r(n,a){return n!=null&&t(n,a,e)}return mx=r,mx}var vx,TA;function BY(){if(TA)return vx;TA=1;var e=n_(),t=AI(),r=LY(),n=Bb(),a=s8(),i=o8(),s=gp(),o=1,c=2;function u(d,h){return n(d)&&a(h)?i(s(d),h):function(p){var v=t(p,d);return v===void 0&&v===h?r(p,d):e(h,v,o|c)}}return vx=u,vx}var gx,AA;function gc(){if(AA)return gx;AA=1;function e(t){return t}return gx=e,gx}var xx,CA;function $Y(){if(CA)return xx;CA=1;function e(t){return function(r){return r==null?void 0:r[t]}}return xx=e,xx}var yx,OA;function UY(){if(OA)return yx;OA=1;var e=qb();function t(r){return function(n){return e(n,r)}}return yx=t,yx}var wx,NA;function zY(){if(NA)return wx;NA=1;var e=$Y(),t=UY(),r=Bb(),n=gp();function a(i){return r(i)?e(n(i)):t(i)}return wx=a,wx}var bx,PA;function ji(){if(PA)return bx;PA=1;var e=jY(),t=BY(),r=gc(),n=ra(),a=zY();function i(s){return typeof s=="function"?s:s==null?r:typeof s=="object"?n(s)?t(s[0],s[1]):e(s):a(s)}return bx=i,bx}var _x,IA;function l8(){if(IA)return _x;IA=1;function e(t,r,n,a){for(var i=t.length,s=n+(a?1:-1);a?s--:++s<i;)if(r(t[s],s,t))return s;return-1}return _x=e,_x}var Sx,FA;function WY(){if(FA)return Sx;FA=1;function e(t){return t!==t}return Sx=e,Sx}var kx,DA;function HY(){if(DA)return kx;DA=1;function e(t,r,n){for(var a=n-1,i=t.length;++a<i;)if(t[a]===r)return a;return-1}return kx=e,kx}var Ex,jA;function qY(){if(jA)return Ex;jA=1;var e=l8(),t=WY(),r=HY();function n(a,i,s){return i===i?r(a,i,s):e(a,t,s)}return Ex=n,Ex}var Tx,RA;function VY(){if(RA)return Tx;RA=1;var e=qY();function t(r,n){var a=r==null?0:r.length;return!!a&&e(r,n,0)>-1}return Tx=t,Tx}var Ax,MA;function XY(){if(MA)return Ax;MA=1;function e(t,r,n){for(var a=-1,i=t==null?0:t.length;++a<i;)if(n(r,t[a]))return!0;return!1}return Ax=e,Ax}var Cx,LA;function GY(){if(LA)return Cx;LA=1;function e(){}return Cx=e,Cx}var Ox,BA;function KY(){if(BA)return Ox;BA=1;var e=i8(),t=GY(),r=Jb(),n=1/0,a=e&&1/r(new e([,-0]))[1]==n?function(i){return new e(i)}:t;return Ox=a,Ox}var Nx,$A;function YY(){if($A)return Nx;$A=1;var e=YI(),t=VY(),r=XY(),n=QI(),a=KY(),i=Jb(),s=200;function o(c,u,d){var h=-1,p=t,v=c.length,x=!0,w=[],y=w;if(d)x=!1,p=r;else if(v>=s){var _=u?null:a(c);if(_)return i(_);x=!1,p=n,y=new e}else y=u?[]:w;e:for(;++h<v;){var S=c[h],k=u?u(S):S;if(S=d||S!==0?S:0,x&&k===k){for(var E=y.length;E--;)if(y[E]===k)continue e;u&&y.push(k),w.push(S)}else p(y,k,d)||(y!==w&&y.push(k),w.push(S))}return w}return Nx=o,Nx}var Px,UA;function ZY(){if(UA)return Px;UA=1;var e=ji(),t=YY();function r(n,a){return n&&n.length?t(n,e(a,2)):[]}return Px=r,Px}var QY=ZY();const zA=rr(QY);function c8(e,t,r){return t===!0?zA(e,r):$t(t)?zA(e,t):e}function Gl(e){"@babel/helpers - typeof";return Gl=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Gl(e)}var JY=["ref"];function WA(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function xo(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?WA(Object(r),!0).forEach(function(n){Ep(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):WA(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function eZ(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function HA(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,d8(n.key),n)}}function tZ(e,t,r){return t&&HA(e.prototype,t),r&&HA(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function rZ(e,t,r){return t=gh(t),nZ(e,u8()?Reflect.construct(t,r||[],gh(e).constructor):t.apply(e,r))}function nZ(e,t){if(t&&(Gl(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return f8(e)}function u8(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(u8=function(){return!!e})()}function gh(e){return gh=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},gh(e)}function f8(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function aZ(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&G2(e,t)}function G2(e,t){return G2=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},G2(e,t)}function Ep(e,t,r){return t=d8(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function d8(e){var t=iZ(e,"string");return Gl(t)=="symbol"?t:String(t)}function iZ(e,t){if(Gl(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Gl(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function sZ(e,t){if(e==null)return{};var r=oZ(e,t),n,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function oZ(e,t){if(e==null)return{};var r={},n=Object.keys(e),a,i;for(i=0;i<n.length;i++)a=n[i],!(t.indexOf(a)>=0)&&(r[a]=e[a]);return r}function lZ(e){return e.value}function cZ(e,t){if(me.isValidElement(e))return me.cloneElement(e,t);if(typeof e=="function")return me.createElement(e,t);t.ref;var r=sZ(t,JY);return me.createElement(Qb,r)}var qA=1,nf=(function(e){aZ(t,e);function t(){var r;eZ(this,t);for(var n=arguments.length,a=new Array(n),i=0;i<n;i++)a[i]=arguments[i];return r=rZ(this,t,[].concat(a)),Ep(f8(r),"lastBoundingBox",{width:-1,height:-1}),r}return tZ(t,[{key:"componentDidMount",value:function(){this.updateBBox()}},{key:"componentDidUpdate",value:function(){this.updateBBox()}},{key:"getBBox",value:function(){if(this.wrapperNode&&this.wrapperNode.getBoundingClientRect){var n=this.wrapperNode.getBoundingClientRect();return n.height=this.wrapperNode.offsetHeight,n.width=this.wrapperNode.offsetWidth,n}return null}},{key:"updateBBox",value:function(){var n=this.props.onBBoxUpdate,a=this.getBBox();a?(Math.abs(a.width-this.lastBoundingBox.width)>qA||Math.abs(a.height-this.lastBoundingBox.height)>qA)&&(this.lastBoundingBox.width=a.width,this.lastBoundingBox.height=a.height,n&&n(a)):(this.lastBoundingBox.width!==-1||this.lastBoundingBox.height!==-1)&&(this.lastBoundingBox.width=-1,this.lastBoundingBox.height=-1,n&&n(null))}},{key:"getBBoxSnapshot",value:function(){return this.lastBoundingBox.width>=0&&this.lastBoundingBox.height>=0?xo({},this.lastBoundingBox):{width:0,height:0}}},{key:"getDefaultPosition",value:function(n){var a=this.props,i=a.layout,s=a.align,o=a.verticalAlign,c=a.margin,u=a.chartWidth,d=a.chartHeight,h,p;if(!n||(n.left===void 0||n.left===null)&&(n.right===void 0||n.right===null))if(s==="center"&&i==="vertical"){var v=this.getBBoxSnapshot();h={left:((u||0)-v.width)/2}}else h=s==="right"?{right:c&&c.right||0}:{left:c&&c.left||0};if(!n||(n.top===void 0||n.top===null)&&(n.bottom===void 0||n.bottom===null))if(o==="middle"){var x=this.getBBoxSnapshot();p={top:((d||0)-x.height)/2}}else p=o==="bottom"?{bottom:c&&c.bottom||0}:{top:c&&c.top||0};return xo(xo({},h),p)}},{key:"render",value:function(){var n=this,a=this.props,i=a.content,s=a.width,o=a.height,c=a.wrapperStyle,u=a.payloadUniqBy,d=a.payload,h=xo(xo({position:"absolute",width:s||"auto",height:o||"auto"},this.getDefaultPosition(c)),c);return me.createElement("div",{className:"recharts-legend-wrapper",style:h,ref:function(v){n.wrapperNode=v}},cZ(i,xo(xo({},this.props),{},{payload:c8(d,u,lZ)})))}}],[{key:"getWithHeight",value:function(n,a){var i=n.props.layout;return i==="vertical"&&ot(n.props.height)?{height:n.props.height}:i==="horizontal"?{width:n.props.width||a}:null}}]),t})(D.PureComponent);Ep(nf,"displayName","Legend");Ep(nf,"defaultProps",{iconSize:14,layout:"horizontal",align:"center",verticalAlign:"bottom"});var Ix,VA;function uZ(){if(VA)return Ix;VA=1;var e=Zf(),t=e_(),r=ra(),n=e?e.isConcatSpreadable:void 0;function a(i){return r(i)||t(i)||!!(n&&i&&i[n])}return Ix=a,Ix}var Fx,XA;function h8(){if(XA)return Fx;XA=1;var e=e8(),t=uZ();function r(n,a,i,s,o){var c=-1,u=n.length;for(i||(i=t),o||(o=[]);++c<u;){var d=n[c];a>0&&i(d)?a>1?r(d,a-1,i,s,o):e(o,d):s||(o[o.length]=d)}return o}return Fx=r,Fx}var Dx,GA;function fZ(){if(GA)return Dx;GA=1;function e(t){return function(r,n,a){for(var i=-1,s=Object(r),o=a(r),c=o.length;c--;){var u=o[t?c:++i];if(n(s[u],u,s)===!1)break}return r}}return Dx=e,Dx}var jx,KA;function dZ(){if(KA)return jx;KA=1;var e=fZ(),t=e();return jx=t,jx}var Rx,YA;function p8(){if(YA)return Rx;YA=1;var e=dZ(),t=kp();function r(n,a){return n&&e(n,a,t)}return Rx=r,Rx}var Mx,ZA;function hZ(){if(ZA)return Mx;ZA=1;var e=e0();function t(r,n){return function(a,i){if(a==null)return a;if(!e(a))return r(a,i);for(var s=a.length,o=n?s:-1,c=Object(a);(n?o--:++o<s)&&i(c[o],o,c)!==!1;);return a}}return Mx=t,Mx}var Lx,QA;function a_(){if(QA)return Lx;QA=1;var e=p8(),t=hZ(),r=t(e);return Lx=r,Lx}var Bx,JA;function m8(){if(JA)return Bx;JA=1;var e=a_(),t=e0();function r(n,a){var i=-1,s=t(n)?Array(n.length):[];return e(n,function(o,c,u){s[++i]=a(o,c,u)}),s}return Bx=r,Bx}var $x,eC;function pZ(){if(eC)return $x;eC=1;function e(t,r){var n=t.length;for(t.sort(r);n--;)t[n]=t[n].value;return t}return $x=e,$x}var Ux,tC;function mZ(){if(tC)return Ux;tC=1;var e=mc();function t(r,n){if(r!==n){var a=r!==void 0,i=r===null,s=r===r,o=e(r),c=n!==void 0,u=n===null,d=n===n,h=e(n);if(!u&&!h&&!o&&r>n||o&&c&&d&&!u&&!h||i&&c&&d||!a&&d||!s)return 1;if(!i&&!o&&!h&&r<n||h&&a&&s&&!i&&!o||u&&a&&s||!c&&s||!d)return-1}return 0}return Ux=t,Ux}var zx,rC;function vZ(){if(rC)return zx;rC=1;var e=mZ();function t(r,n,a){for(var i=-1,s=r.criteria,o=n.criteria,c=s.length,u=a.length;++i<c;){var d=e(s[i],o[i]);if(d){if(i>=u)return d;var h=a[i];return d*(h=="desc"?-1:1)}}return r.index-n.index}return zx=t,zx}var Wx,nC;function gZ(){if(nC)return Wx;nC=1;var e=Hb(),t=qb(),r=ji(),n=m8(),a=pZ(),i=r8(),s=vZ(),o=gc(),c=ra();function u(d,h,p){h.length?h=e(h,function(w){return c(w)?function(y){return t(y,w.length===1?w[0]:w)}:w}):h=[o];var v=-1;h=e(h,i(r));var x=n(d,function(w,y,_){var S=e(h,function(k){return k(w)});return{criteria:S,index:++v,value:w}});return a(x,function(w,y){return s(w,y,p)})}return Wx=u,Wx}var Hx,aC;function xZ(){if(aC)return Hx;aC=1;function e(t,r,n){switch(n.length){case 0:return t.call(r);case 1:return t.call(r,n[0]);case 2:return t.call(r,n[0],n[1]);case 3:return t.call(r,n[0],n[1],n[2])}return t.apply(r,n)}return Hx=e,Hx}var qx,iC;function yZ(){if(iC)return qx;iC=1;var e=xZ(),t=Math.max;function r(n,a,i){return a=t(a===void 0?n.length-1:a,0),function(){for(var s=arguments,o=-1,c=t(s.length-a,0),u=Array(c);++o<c;)u[o]=s[a+o];o=-1;for(var d=Array(a+1);++o<a;)d[o]=s[o];return d[a]=i(u),e(n,this,d)}}return qx=r,qx}var Vx,sC;function wZ(){if(sC)return Vx;sC=1;function e(t){return function(){return t}}return Vx=e,Vx}var Xx,oC;function v8(){if(oC)return Xx;oC=1;var e=Zo(),t=(function(){try{var r=e(Object,"defineProperty");return r({},"",{}),r}catch{}})();return Xx=t,Xx}var Gx,lC;function bZ(){if(lC)return Gx;lC=1;var e=wZ(),t=v8(),r=gc(),n=t?function(a,i){return t(a,"toString",{configurable:!0,enumerable:!1,value:e(i),writable:!0})}:r;return Gx=n,Gx}var Kx,cC;function _Z(){if(cC)return Kx;cC=1;var e=800,t=16,r=Date.now;function n(a){var i=0,s=0;return function(){var o=r(),c=t-(o-s);if(s=o,c>0){if(++i>=e)return arguments[0]}else i=0;return a.apply(void 0,arguments)}}return Kx=n,Kx}var Yx,uC;function SZ(){if(uC)return Yx;uC=1;var e=bZ(),t=_Z(),r=t(e);return Yx=r,Yx}var Zx,fC;function kZ(){if(fC)return Zx;fC=1;var e=gc(),t=yZ(),r=SZ();function n(a,i){return r(t(a,i,e),a+"")}return Zx=n,Zx}var Qx,dC;function Tp(){if(dC)return Qx;dC=1;var e=Ub(),t=e0(),r=t_(),n=Qs();function a(i,s,o){if(!n(o))return!1;var c=typeof s;return(c=="number"?t(o)&&r(s,o.length):c=="string"&&s in o)?e(o[s],i):!1}return Qx=a,Qx}var Jx,hC;function EZ(){if(hC)return Jx;hC=1;var e=h8(),t=gZ(),r=kZ(),n=Tp(),a=r(function(i,s){if(i==null)return[];var o=s.length;return o>1&&n(i,s[0],s[1])?s=[]:o>2&&n(s[0],s[1],s[2])&&(s=[s[0]]),t(i,e(s,1),[])});return Jx=a,Jx}var TZ=EZ();const i_=rr(TZ);function af(e){"@babel/helpers - typeof";return af=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},af(e)}function K2(){return K2=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},K2.apply(this,arguments)}function AZ(e,t){return PZ(e)||NZ(e,t)||OZ(e,t)||CZ()}function CZ(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function OZ(e,t){if(e){if(typeof e=="string")return pC(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return pC(e,t)}}function pC(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function NZ(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,a,i,s,o=[],c=!0,u=!1;try{if(i=(r=r.call(e)).next,t!==0)for(;!(c=(n=i.call(r)).done)&&(o.push(n.value),o.length!==t);c=!0);}catch(d){u=!0,a=d}finally{try{if(!c&&r.return!=null&&(s=r.return(),Object(s)!==s))return}finally{if(u)throw a}}return o}}function PZ(e){if(Array.isArray(e))return e}function mC(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function ey(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?mC(Object(r),!0).forEach(function(n){IZ(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):mC(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function IZ(e,t,r){return t=FZ(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function FZ(e){var t=DZ(e,"string");return af(t)=="symbol"?t:String(t)}function DZ(e,t){if(af(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(af(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function jZ(e){return Array.isArray(e)&&en(e[0])&&en(e[1])?e.join(" ~ "):e}var RZ=function(t){var r=t.separator,n=r===void 0?" : ":r,a=t.contentStyle,i=a===void 0?{}:a,s=t.itemStyle,o=s===void 0?{}:s,c=t.labelStyle,u=c===void 0?{}:c,d=t.payload,h=t.formatter,p=t.itemSorter,v=t.wrapperClassName,x=t.labelClassName,w=t.label,y=t.labelFormatter,_=t.accessibilityLayer,S=_===void 0?!1:_,k=function(){if(d&&d.length){var F={padding:0,margin:0},L=(p?i_(d,p):d).map(function(H,V){if(H.type==="none")return null;var J=ey({display:"block",paddingTop:4,paddingBottom:4,color:H.color||"#000"},o),te=H.formatter||h||jZ,q=H.value,oe=H.name,Q=q,Z=oe;if(te&&Q!=null&&Z!=null){var ee=te(q,oe,H,V,d);if(Array.isArray(ee)){var ce=AZ(ee,2);Q=ce[0],Z=ce[1]}else Q=ee}return me.createElement("li",{className:"recharts-tooltip-item",key:"tooltip-item-".concat(V),style:J},en(Z)?me.createElement("span",{className:"recharts-tooltip-item-name"},Z):null,en(Z)?me.createElement("span",{className:"recharts-tooltip-item-separator"},n):null,me.createElement("span",{className:"recharts-tooltip-item-value"},Q),me.createElement("span",{className:"recharts-tooltip-item-unit"},H.unit||""))});return me.createElement("ul",{className:"recharts-tooltip-item-list",style:F},L)}return null},E=ey({margin:0,padding:10,backgroundColor:"#fff",border:"1px solid #ccc",whiteSpace:"nowrap"},i),T=ey({margin:0},u),N=!Vt(w),C=N?w:"",P=Qt("recharts-default-tooltip",v),j=Qt("recharts-tooltip-label",x);N&&y&&d!==void 0&&d!==null&&(C=y(w,d));var R=S?{role:"status","aria-live":"assertive"}:{};return me.createElement("div",K2({className:P,style:E},R),me.createElement("p",{className:j,style:T},me.isValidElement(C)?C:"".concat(C)),k())};function sf(e){"@babel/helpers - typeof";return sf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},sf(e)}function Od(e,t,r){return t=MZ(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function MZ(e){var t=LZ(e,"string");return sf(t)=="symbol"?t:String(t)}function LZ(e,t){if(sf(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(sf(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var nu="recharts-tooltip-wrapper",BZ={visibility:"hidden"};function $Z(e){var t=e.coordinate,r=e.translateX,n=e.translateY;return Qt(nu,Od(Od(Od(Od({},"".concat(nu,"-right"),ot(r)&&t&&ot(t.x)&&r>=t.x),"".concat(nu,"-left"),ot(r)&&t&&ot(t.x)&&r<t.x),"".concat(nu,"-bottom"),ot(n)&&t&&ot(t.y)&&n>=t.y),"".concat(nu,"-top"),ot(n)&&t&&ot(t.y)&&n<t.y))}function vC(e){var t=e.allowEscapeViewBox,r=e.coordinate,n=e.key,a=e.offsetTopLeft,i=e.position,s=e.reverseDirection,o=e.tooltipDimension,c=e.viewBox,u=e.viewBoxDimension;if(i&&ot(i[n]))return i[n];var d=r[n]-o-a,h=r[n]+a;if(t[n])return s[n]?d:h;if(s[n]){var p=d,v=c[n];return p<v?Math.max(h,c[n]):Math.max(d,c[n])}var x=h+o,w=c[n]+u;return x>w?Math.max(d,c[n]):Math.max(h,c[n])}function UZ(e){var t=e.translateX,r=e.translateY,n=e.useTranslate3d;return{transform:n?"translate3d(".concat(t,"px, ").concat(r,"px, 0)"):"translate(".concat(t,"px, ").concat(r,"px)")}}function zZ(e){var t=e.allowEscapeViewBox,r=e.coordinate,n=e.offsetTopLeft,a=e.position,i=e.reverseDirection,s=e.tooltipBox,o=e.useTranslate3d,c=e.viewBox,u,d,h;return s.height>0&&s.width>0&&r?(d=vC({allowEscapeViewBox:t,coordinate:r,key:"x",offsetTopLeft:n,position:a,reverseDirection:i,tooltipDimension:s.width,viewBox:c,viewBoxDimension:c.width}),h=vC({allowEscapeViewBox:t,coordinate:r,key:"y",offsetTopLeft:n,position:a,reverseDirection:i,tooltipDimension:s.height,viewBox:c,viewBoxDimension:c.height}),u=UZ({translateX:d,translateY:h,useTranslate3d:o})):u=BZ,{cssProperties:u,cssClasses:$Z({translateX:d,translateY:h,coordinate:r})}}function Kl(e){"@babel/helpers - typeof";return Kl=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Kl(e)}function gC(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function xC(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?gC(Object(r),!0).forEach(function(n){Q2(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):gC(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function WZ(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function HZ(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,x8(n.key),n)}}function qZ(e,t,r){return t&&HZ(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function VZ(e,t,r){return t=xh(t),XZ(e,g8()?Reflect.construct(t,r||[],xh(e).constructor):t.apply(e,r))}function XZ(e,t){if(t&&(Kl(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Y2(e)}function g8(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(g8=function(){return!!e})()}function xh(e){return xh=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},xh(e)}function Y2(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function GZ(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Z2(e,t)}function Z2(e,t){return Z2=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},Z2(e,t)}function Q2(e,t,r){return t=x8(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function x8(e){var t=KZ(e,"string");return Kl(t)=="symbol"?t:String(t)}function KZ(e,t){if(Kl(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Kl(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var yC=1,YZ=(function(e){GZ(t,e);function t(){var r;WZ(this,t);for(var n=arguments.length,a=new Array(n),i=0;i<n;i++)a[i]=arguments[i];return r=VZ(this,t,[].concat(a)),Q2(Y2(r),"state",{dismissed:!1,dismissedAtCoordinate:{x:0,y:0},lastBoundingBox:{width:-1,height:-1}}),Q2(Y2(r),"handleKeyDown",function(s){if(s.key==="Escape"){var o,c,u,d;r.setState({dismissed:!0,dismissedAtCoordinate:{x:(o=(c=r.props.coordinate)===null||c===void 0?void 0:c.x)!==null&&o!==void 0?o:0,y:(u=(d=r.props.coordinate)===null||d===void 0?void 0:d.y)!==null&&u!==void 0?u:0}})}}),r}return qZ(t,[{key:"updateBBox",value:function(){if(this.wrapperNode&&this.wrapperNode.getBoundingClientRect){var n=this.wrapperNode.getBoundingClientRect();(Math.abs(n.width-this.state.lastBoundingBox.width)>yC||Math.abs(n.height-this.state.lastBoundingBox.height)>yC)&&this.setState({lastBoundingBox:{width:n.width,height:n.height}})}else(this.state.lastBoundingBox.width!==-1||this.state.lastBoundingBox.height!==-1)&&this.setState({lastBoundingBox:{width:-1,height:-1}})}},{key:"componentDidMount",value:function(){document.addEventListener("keydown",this.handleKeyDown),this.updateBBox()}},{key:"componentWillUnmount",value:function(){document.removeEventListener("keydown",this.handleKeyDown)}},{key:"componentDidUpdate",value:function(){var n,a;this.props.active&&this.updateBBox(),this.state.dismissed&&(((n=this.props.coordinate)===null||n===void 0?void 0:n.x)!==this.state.dismissedAtCoordinate.x||((a=this.props.coordinate)===null||a===void 0?void 0:a.y)!==this.state.dismissedAtCoordinate.y)&&(this.state.dismissed=!1)}},{key:"render",value:function(){var n=this,a=this.props,i=a.active,s=a.allowEscapeViewBox,o=a.animationDuration,c=a.animationEasing,u=a.children,d=a.coordinate,h=a.hasPayload,p=a.isAnimationActive,v=a.offset,x=a.position,w=a.reverseDirection,y=a.useTranslate3d,_=a.viewBox,S=a.wrapperStyle,k=zZ({allowEscapeViewBox:s,coordinate:d,offsetTopLeft:v,position:x,reverseDirection:w,tooltipBox:this.state.lastBoundingBox,useTranslate3d:y,viewBox:_}),E=k.cssClasses,T=k.cssProperties,N=xC(xC({transition:p&&i?"transform ".concat(o,"ms ").concat(c):void 0},T),{},{pointerEvents:"none",visibility:!this.state.dismissed&&i&&h?"visible":"hidden",position:"absolute",top:0,left:0},S);return me.createElement("div",{tabIndex:-1,className:E,style:N,ref:function(P){n.wrapperNode=P}},u)}}]),t})(D.PureComponent),ZZ=function(){return!(typeof window<"u"&&window.document&&window.document.createElement&&window.setTimeout)},Ap={isSsr:ZZ()};function Yl(e){"@babel/helpers - typeof";return Yl=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Yl(e)}function wC(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function bC(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?wC(Object(r),!0).forEach(function(n){s_(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):wC(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function QZ(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function JZ(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,w8(n.key),n)}}function eQ(e,t,r){return t&&JZ(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function tQ(e,t,r){return t=yh(t),rQ(e,y8()?Reflect.construct(t,r||[],yh(e).constructor):t.apply(e,r))}function rQ(e,t){if(t&&(Yl(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return nQ(e)}function nQ(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function y8(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(y8=function(){return!!e})()}function yh(e){return yh=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},yh(e)}function aQ(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&J2(e,t)}function J2(e,t){return J2=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},J2(e,t)}function s_(e,t,r){return t=w8(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function w8(e){var t=iQ(e,"string");return Yl(t)=="symbol"?t:String(t)}function iQ(e,t){if(Yl(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Yl(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}function sQ(e){return e.dataKey}function oQ(e,t){return me.isValidElement(e)?me.cloneElement(e,t):typeof e=="function"?me.createElement(e,t):me.createElement(RZ,t)}var qi=(function(e){aQ(t,e);function t(){return QZ(this,t),tQ(this,t,arguments)}return eQ(t,[{key:"render",value:function(){var n=this,a=this.props,i=a.active,s=a.allowEscapeViewBox,o=a.animationDuration,c=a.animationEasing,u=a.content,d=a.coordinate,h=a.filterNull,p=a.isAnimationActive,v=a.offset,x=a.payload,w=a.payloadUniqBy,y=a.position,_=a.reverseDirection,S=a.useTranslate3d,k=a.viewBox,E=a.wrapperStyle,T=x??[];h&&T.length&&(T=c8(x.filter(function(C){return C.value!=null&&(C.hide!==!0||n.props.includeHidden)}),w,sQ));var N=T.length>0;return me.createElement(YZ,{allowEscapeViewBox:s,animationDuration:o,animationEasing:c,isAnimationActive:p,active:i,coordinate:d,hasPayload:N,offset:v,position:y,reverseDirection:_,useTranslate3d:S,viewBox:k,wrapperStyle:E},oQ(u,bC(bC({},this.props),{},{payload:T})))}}]),t})(D.PureComponent);s_(qi,"displayName","Tooltip");s_(qi,"defaultProps",{accessibilityLayer:!1,allowEscapeViewBox:{x:!1,y:!1},animationDuration:400,animationEasing:"ease",contentStyle:{},coordinate:{x:0,y:0},cursor:!0,cursorStyle:{},filterNull:!0,isAnimationActive:!Ap.isSsr,itemStyle:{},labelStyle:{},offset:10,reverseDirection:{x:!1,y:!1},separator:" : ",trigger:"hover",useTranslate3d:!1,viewBox:{x:0,y:0,height:0,width:0},wrapperStyle:{}});var ty,_C;function lQ(){if(_C)return ty;_C=1;var e=Di(),t=function(){return e.Date.now()};return ty=t,ty}var ry,SC;function cQ(){if(SC)return ry;SC=1;var e=/\s/;function t(r){for(var n=r.length;n--&&e.test(r.charAt(n)););return n}return ry=t,ry}var ny,kC;function uQ(){if(kC)return ny;kC=1;var e=cQ(),t=/^\s+/;function r(n){return n&&n.slice(0,e(n)+1).replace(t,"")}return ny=r,ny}var ay,EC;function b8(){if(EC)return ay;EC=1;var e=uQ(),t=Qs(),r=mc(),n=NaN,a=/^[-+]0x[0-9a-f]+$/i,i=/^0b[01]+$/i,s=/^0o[0-7]+$/i,o=parseInt;function c(u){if(typeof u=="number")return u;if(r(u))return n;if(t(u)){var d=typeof u.valueOf=="function"?u.valueOf():u;u=t(d)?d+"":d}if(typeof u!="string")return u===0?u:+u;u=e(u);var h=i.test(u);return h||s.test(u)?o(u.slice(2),h?2:8):a.test(u)?n:+u}return ay=c,ay}var iy,TC;function fQ(){if(TC)return iy;TC=1;var e=Qs(),t=lQ(),r=b8(),n="Expected a function",a=Math.max,i=Math.min;function s(o,c,u){var d,h,p,v,x,w,y=0,_=!1,S=!1,k=!0;if(typeof o!="function")throw new TypeError(n);c=r(c)||0,e(u)&&(_=!!u.leading,S="maxWait"in u,p=S?a(r(u.maxWait)||0,c):p,k="trailing"in u?!!u.trailing:k);function E(L){var H=d,V=h;return d=h=void 0,y=L,v=o.apply(V,H),v}function T(L){return y=L,x=setTimeout(P,c),_?E(L):v}function N(L){var H=L-w,V=L-y,J=c-H;return S?i(J,p-V):J}function C(L){var H=L-w,V=L-y;return w===void 0||H>=c||H<0||S&&V>=p}function P(){var L=t();if(C(L))return j(L);x=setTimeout(P,N(L))}function j(L){return x=void 0,k&&d?E(L):(d=h=void 0,v)}function R(){x!==void 0&&clearTimeout(x),y=0,d=w=h=x=void 0}function I(){return x===void 0?v:j(t())}function F(){var L=t(),H=C(L);if(d=arguments,h=this,w=L,H){if(x===void 0)return T(w);if(S)return clearTimeout(x),x=setTimeout(P,c),E(w)}return x===void 0&&(x=setTimeout(P,c)),v}return F.cancel=R,F.flush=I,F}return iy=s,iy}var sy,AC;function dQ(){if(AC)return sy;AC=1;var e=fQ(),t=Qs(),r="Expected a function";function n(a,i,s){var o=!0,c=!0;if(typeof a!="function")throw new TypeError(r);return t(s)&&(o="leading"in s?!!s.leading:o,c="trailing"in s?!!s.trailing:c),e(a,i,{leading:o,maxWait:i,trailing:c})}return sy=n,sy}var hQ=dQ();const _8=rr(hQ);function of(e){"@babel/helpers - typeof";return of=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},of(e)}function CC(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Nd(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?CC(Object(r),!0).forEach(function(n){pQ(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):CC(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function pQ(e,t,r){return t=mQ(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function mQ(e){var t=vQ(e,"string");return of(t)=="symbol"?t:String(t)}function vQ(e,t){if(of(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(of(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function gQ(e,t){return bQ(e)||wQ(e,t)||yQ(e,t)||xQ()}function xQ(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function yQ(e,t){if(e){if(typeof e=="string")return OC(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return OC(e,t)}}function OC(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function wQ(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,a,i,s,o=[],c=!0,u=!1;try{if(i=(r=r.call(e)).next,t!==0)for(;!(c=(n=i.call(r)).done)&&(o.push(n.value),o.length!==t);c=!0);}catch(d){u=!0,a=d}finally{try{if(!c&&r.return!=null&&(s=r.return(),Object(s)!==s))return}finally{if(u)throw a}}return o}}function bQ(e){if(Array.isArray(e))return e}var _Q=D.forwardRef(function(e,t){var r=e.aspect,n=e.initialDimension,a=n===void 0?{width:-1,height:-1}:n,i=e.width,s=i===void 0?"100%":i,o=e.height,c=o===void 0?"100%":o,u=e.minWidth,d=u===void 0?0:u,h=e.minHeight,p=e.maxHeight,v=e.children,x=e.debounce,w=x===void 0?0:x,y=e.id,_=e.className,S=e.onResize,k=e.style,E=k===void 0?{}:k,T=D.useRef(null),N=D.useRef();N.current=S,D.useImperativeHandle(t,function(){return Object.defineProperty(T.current,"current",{get:function(){return console.warn("The usage of ref.current.current is deprecated and will no longer be supported."),T.current},configurable:!0})});var C=D.useState({containerWidth:a.width,containerHeight:a.height}),P=gQ(C,2),j=P[0],R=P[1],I=D.useCallback(function(L,H){R(function(V){var J=Math.round(L),te=Math.round(H);return V.containerWidth===J&&V.containerHeight===te?V:{containerWidth:J,containerHeight:te}})},[]);D.useEffect(function(){var L=function(oe){var Q,Z=oe[0].contentRect,ee=Z.width,ce=Z.height;I(ee,ce),(Q=N.current)===null||Q===void 0||Q.call(N,ee,ce)};w>0&&(L=_8(L,w,{trailing:!0,leading:!1}));var H=new ResizeObserver(L),V=T.current.getBoundingClientRect(),J=V.width,te=V.height;return I(J,te),H.observe(T.current),function(){H.disconnect()}},[I,w]);var F=D.useMemo(function(){var L=j.containerWidth,H=j.containerHeight;if(L<0||H<0)return null;ns(Eo(s)||Eo(c),`The width(%s) and height(%s) are both fixed numbers,
       maybe you don't need to use a ResponsiveContainer.`,s,c),ns(!r||r>0,"The aspect(%s) must be greater than zero.",r);var V=Eo(s)?L:s,J=Eo(c)?H:c;r&&r>0&&(V?J=V/r:J&&(V=J*r),p&&J>p&&(J=p)),ns(V>0||J>0,`The width(%s) and height(%s) of chart should be greater than 0,
       please check the style of container, or the props width(%s) and height(%s),
       or add a minWidth(%s) or minHeight(%s) or use aspect(%s) to control the
       height and width.`,V,J,s,c,d,h,r);var te=!Array.isArray(v)&&F2.isElement(v)&&rs(v.type).endsWith("Chart");return me.Children.map(v,function(q){return F2.isElement(q)?D.cloneElement(q,Nd({width:V,height:J},te?{style:Nd({height:"100%",width:"100%",maxHeight:J,maxWidth:V},q.props.style)}:{})):q})},[r,v,c,p,h,d,j,s]);return me.createElement("div",{id:y?"".concat(y):void 0,className:Qt("recharts-responsive-container",_),style:Nd(Nd({},E),{},{width:s,height:c,minWidth:d,minHeight:h,maxHeight:p}),ref:T},F)}),o_=function(t){return null};o_.displayName="Cell";function lf(e){"@babel/helpers - typeof";return lf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},lf(e)}function NC(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function ew(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?NC(Object(r),!0).forEach(function(n){SQ(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):NC(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function SQ(e,t,r){return t=kQ(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function kQ(e){var t=EQ(e,"string");return lf(t)=="symbol"?t:String(t)}function EQ(e,t){if(lf(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(lf(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var kl={widthCache:{},cacheCount:0},TQ=2e3,AQ={position:"absolute",top:"-20000px",left:0,padding:0,margin:0,border:"none",whiteSpace:"pre"},PC="recharts_measurement_span";function CQ(e){var t=ew({},e);return Object.keys(t).forEach(function(r){t[r]||delete t[r]}),t}var IC=function(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(t==null||Ap.isSsr)return{width:0,height:0};var n=CQ(r),a=JSON.stringify({text:t,copyStyle:n});if(kl.widthCache[a])return kl.widthCache[a];try{var i=document.getElementById(PC);i||(i=document.createElement("span"),i.setAttribute("id",PC),i.setAttribute("aria-hidden","true"),document.body.appendChild(i));var s=ew(ew({},AQ),n);Object.assign(i.style,s),i.textContent="".concat(t);var o=i.getBoundingClientRect(),c={width:o.width,height:o.height};return kl.widthCache[a]=c,++kl.cacheCount>TQ&&(kl.cacheCount=0,kl.widthCache={}),c}catch{return{width:0,height:0}}},OQ=function(t){return{top:t.top+window.scrollY-document.documentElement.clientTop,left:t.left+window.scrollX-document.documentElement.clientLeft}};function cf(e){"@babel/helpers - typeof";return cf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},cf(e)}function wh(e,t){return FQ(e)||IQ(e,t)||PQ(e,t)||NQ()}function NQ(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function PQ(e,t){if(e){if(typeof e=="string")return FC(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return FC(e,t)}}function FC(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function IQ(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,a,i,s,o=[],c=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=i.call(r)).done)&&(o.push(n.value),o.length!==t);c=!0);}catch(d){u=!0,a=d}finally{try{if(!c&&r.return!=null&&(s=r.return(),Object(s)!==s))return}finally{if(u)throw a}}return o}}function FQ(e){if(Array.isArray(e))return e}function DQ(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function DC(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,RQ(n.key),n)}}function jQ(e,t,r){return t&&DC(e.prototype,t),r&&DC(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function RQ(e){var t=MQ(e,"string");return cf(t)=="symbol"?t:String(t)}function MQ(e,t){if(cf(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(cf(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var jC=/(-?\d+(?:\.\d+)?[a-zA-Z%]*)([*/])(-?\d+(?:\.\d+)?[a-zA-Z%]*)/,RC=/(-?\d+(?:\.\d+)?[a-zA-Z%]*)([+-])(-?\d+(?:\.\d+)?[a-zA-Z%]*)/,LQ=/^px|cm|vh|vw|em|rem|%|mm|in|pt|pc|ex|ch|vmin|vmax|Q$/,BQ=/(-?\d+(?:\.\d+)?)([a-zA-Z%]+)?/,S8={cm:96/2.54,mm:96/25.4,pt:96/72,pc:96/6,in:96,Q:96/(2.54*40),px:1},$Q=Object.keys(S8),Pl="NaN";function UQ(e,t){return e*S8[t]}var Pd=(function(){function e(t,r){DQ(this,e),this.num=t,this.unit=r,this.num=t,this.unit=r,Number.isNaN(t)&&(this.unit=""),r!==""&&!LQ.test(r)&&(this.num=NaN,this.unit=""),$Q.includes(r)&&(this.num=UQ(t,r),this.unit="px")}return jQ(e,[{key:"add",value:function(r){return this.unit!==r.unit?new e(NaN,""):new e(this.num+r.num,this.unit)}},{key:"subtract",value:function(r){return this.unit!==r.unit?new e(NaN,""):new e(this.num-r.num,this.unit)}},{key:"multiply",value:function(r){return this.unit!==""&&r.unit!==""&&this.unit!==r.unit?new e(NaN,""):new e(this.num*r.num,this.unit||r.unit)}},{key:"divide",value:function(r){return this.unit!==""&&r.unit!==""&&this.unit!==r.unit?new e(NaN,""):new e(this.num/r.num,this.unit||r.unit)}},{key:"toString",value:function(){return"".concat(this.num).concat(this.unit)}},{key:"isNaN",value:function(){return Number.isNaN(this.num)}}],[{key:"parse",value:function(r){var n,a=(n=BQ.exec(r))!==null&&n!==void 0?n:[],i=wh(a,3),s=i[1],o=i[2];return new e(parseFloat(s),o??"")}}]),e})();function k8(e){if(e.includes(Pl))return Pl;for(var t=e;t.includes("*")||t.includes("/");){var r,n=(r=jC.exec(t))!==null&&r!==void 0?r:[],a=wh(n,4),i=a[1],s=a[2],o=a[3],c=Pd.parse(i??""),u=Pd.parse(o??""),d=s==="*"?c.multiply(u):c.divide(u);if(d.isNaN())return Pl;t=t.replace(jC,d.toString())}for(;t.includes("+")||/.-\d+(?:\.\d+)?/.test(t);){var h,p=(h=RC.exec(t))!==null&&h!==void 0?h:[],v=wh(p,4),x=v[1],w=v[2],y=v[3],_=Pd.parse(x??""),S=Pd.parse(y??""),k=w==="+"?_.add(S):_.subtract(S);if(k.isNaN())return Pl;t=t.replace(RC,k.toString())}return t}var MC=/\(([^()]*)\)/;function zQ(e){for(var t=e;t.includes("(");){var r=MC.exec(t),n=wh(r,2),a=n[1];t=t.replace(MC,k8(a))}return t}function WQ(e){var t=e.replace(/\s+/g,"");return t=zQ(t),t=k8(t),t}function HQ(e){try{return WQ(e)}catch{return Pl}}function oy(e){var t=HQ(e.slice(5,-1));return t===Pl?"":t}var qQ=["x","y","lineHeight","capHeight","scaleToFit","textAnchor","verticalAnchor","fill"],VQ=["dx","dy","angle","className","breakAll"];function tw(){return tw=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},tw.apply(this,arguments)}function LC(e,t){if(e==null)return{};var r=XQ(e,t),n,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function XQ(e,t){if(e==null)return{};var r={},n=Object.keys(e),a,i;for(i=0;i<n.length;i++)a=n[i],!(t.indexOf(a)>=0)&&(r[a]=e[a]);return r}function BC(e,t){return ZQ(e)||YQ(e,t)||KQ(e,t)||GQ()}function GQ(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function KQ(e,t){if(e){if(typeof e=="string")return $C(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return $C(e,t)}}function $C(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function YQ(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,a,i,s,o=[],c=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=i.call(r)).done)&&(o.push(n.value),o.length!==t);c=!0);}catch(d){u=!0,a=d}finally{try{if(!c&&r.return!=null&&(s=r.return(),Object(s)!==s))return}finally{if(u)throw a}}return o}}function ZQ(e){if(Array.isArray(e))return e}var E8=/[ \f\n\r\t\v\u2028\u2029]+/,T8=function(t){var r=t.children,n=t.breakAll,a=t.style;try{var i=[];Vt(r)||(n?i=r.toString().split(""):i=r.toString().split(E8));var s=i.map(function(c){return{word:c,width:IC(c,a).width}}),o=n?0:IC("",a).width;return{wordsWithComputedWidth:s,spaceWidth:o}}catch{return null}},QQ=function(t,r,n,a,i){var s=t.maxLines,o=t.children,c=t.style,u=t.breakAll,d=ot(s),h=o,p=function(){var V=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return V.reduce(function(J,te){var q=te.word,oe=te.width,Q=J[J.length-1];if(Q&&(a==null||i||Q.width+oe+n<Number(a)))Q.words.push(q),Q.width+=oe+n;else{var Z={words:[q],width:oe};J.push(Z)}return J},[])},v=p(r),x=function(V){return V.reduce(function(J,te){return J.width>te.width?J:te})};if(!d)return v;for(var w="",y=function(V){var J=h.slice(0,V),te=T8({breakAll:u,style:c,children:J+w}).wordsWithComputedWidth,q=p(te),oe=q.length>s||x(q).width>Number(a);return[oe,q]},_=0,S=h.length-1,k=0,E;_<=S&&k<=h.length-1;){var T=Math.floor((_+S)/2),N=T-1,C=y(N),P=BC(C,2),j=P[0],R=P[1],I=y(T),F=BC(I,1),L=F[0];if(!j&&!L&&(_=T+1),j&&L&&(S=T-1),!j&&L){E=R;break}k++}return E||v},UC=function(t){var r=Vt(t)?[]:t.toString().split(E8);return[{words:r}]},JQ=function(t){var r=t.width,n=t.scaleToFit,a=t.children,i=t.style,s=t.breakAll,o=t.maxLines;if((r||n)&&!Ap.isSsr){var c,u,d=T8({breakAll:s,children:a,style:i});if(d){var h=d.wordsWithComputedWidth,p=d.spaceWidth;c=h,u=p}else return UC(a);return QQ({breakAll:s,children:a,maxLines:o,style:i},c,u,r,n)}return UC(a)},zC="#808080",Zl=function(t){var r=t.x,n=r===void 0?0:r,a=t.y,i=a===void 0?0:a,s=t.lineHeight,o=s===void 0?"1em":s,c=t.capHeight,u=c===void 0?"0.71em":c,d=t.scaleToFit,h=d===void 0?!1:d,p=t.textAnchor,v=p===void 0?"start":p,x=t.verticalAnchor,w=x===void 0?"end":x,y=t.fill,_=y===void 0?zC:y,S=LC(t,qQ),k=D.useMemo(function(){return JQ({breakAll:S.breakAll,children:S.children,maxLines:S.maxLines,scaleToFit:h,style:S.style,width:S.width})},[S.breakAll,S.children,S.maxLines,h,S.style,S.width]),E=S.dx,T=S.dy,N=S.angle,C=S.className,P=S.breakAll,j=LC(S,VQ);if(!en(n)||!en(i))return null;var R=n+(ot(E)?E:0),I=i+(ot(T)?T:0),F;switch(w){case"start":F=oy("calc(".concat(u,")"));break;case"middle":F=oy("calc(".concat((k.length-1)/2," * -").concat(o," + (").concat(u," / 2))"));break;default:F=oy("calc(".concat(k.length-1," * -").concat(o,")"));break}var L=[];if(h){var H=k[0].width,V=S.width;L.push("scale(".concat((ot(V)?V/H:1)/H,")"))}return N&&L.push("rotate(".concat(N,", ").concat(R,", ").concat(I,")")),L.length&&(j.transform=L.join(" ")),me.createElement("text",tw({},Mt(j,!0),{x:R,y:I,className:Qt("recharts-text",C),textAnchor:v,fill:_.includes("url")?zC:_}),k.map(function(J,te){var q=J.words.join(P?"":" ");return me.createElement("tspan",{x:R,dy:te===0?F:o,key:q},q)}))};function Ws(e,t){return e==null||t==null?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function eJ(e,t){return e==null||t==null?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function l_(e){let t,r,n;e.length!==2?(t=Ws,r=(o,c)=>Ws(e(o),c),n=(o,c)=>e(o)-c):(t=e===Ws||e===eJ?e:tJ,r=e,n=e);function a(o,c,u=0,d=o.length){if(u<d){if(t(c,c)!==0)return d;do{const h=u+d>>>1;r(o[h],c)<0?u=h+1:d=h}while(u<d)}return u}function i(o,c,u=0,d=o.length){if(u<d){if(t(c,c)!==0)return d;do{const h=u+d>>>1;r(o[h],c)<=0?u=h+1:d=h}while(u<d)}return u}function s(o,c,u=0,d=o.length){const h=a(o,c,u,d-1);return h>u&&n(o[h-1],c)>-n(o[h],c)?h-1:h}return{left:a,center:s,right:i}}function tJ(){return 0}function A8(e){return e===null?NaN:+e}function*rJ(e,t){for(let r of e)r!=null&&(r=+r)>=r&&(yield r)}const nJ=l_(Ws),t0=nJ.right;l_(A8).center;class WC extends Map{constructor(t,r=sJ){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:r}}),t!=null)for(const[n,a]of t)this.set(n,a)}get(t){return super.get(HC(this,t))}has(t){return super.has(HC(this,t))}set(t,r){return super.set(aJ(this,t),r)}delete(t){return super.delete(iJ(this,t))}}function HC({_intern:e,_key:t},r){const n=t(r);return e.has(n)?e.get(n):r}function aJ({_intern:e,_key:t},r){const n=t(r);return e.has(n)?e.get(n):(e.set(n,r),r)}function iJ({_intern:e,_key:t},r){const n=t(r);return e.has(n)&&(r=e.get(n),e.delete(n)),r}function sJ(e){return e!==null&&typeof e=="object"?e.valueOf():e}function oJ(e=Ws){if(e===Ws)return C8;if(typeof e!="function")throw new TypeError("compare is not a function");return(t,r)=>{const n=e(t,r);return n||n===0?n:(e(r,r)===0)-(e(t,t)===0)}}function C8(e,t){return(e==null||!(e>=e))-(t==null||!(t>=t))||(e<t?-1:e>t?1:0)}const lJ=Math.sqrt(50),cJ=Math.sqrt(10),uJ=Math.sqrt(2);function bh(e,t,r){const n=(t-e)/Math.max(0,r),a=Math.floor(Math.log10(n)),i=n/Math.pow(10,a),s=i>=lJ?10:i>=cJ?5:i>=uJ?2:1;let o,c,u;return a<0?(u=Math.pow(10,-a)/s,o=Math.round(e*u),c=Math.round(t*u),o/u<e&&++o,c/u>t&&--c,u=-u):(u=Math.pow(10,a)*s,o=Math.round(e/u),c=Math.round(t/u),o*u<e&&++o,c*u>t&&--c),c<o&&.5<=r&&r<2?bh(e,t,r*2):[o,c,u]}function rw(e,t,r){if(t=+t,e=+e,r=+r,!(r>0))return[];if(e===t)return[e];const n=t<e,[a,i,s]=n?bh(t,e,r):bh(e,t,r);if(!(i>=a))return[];const o=i-a+1,c=new Array(o);if(n)if(s<0)for(let u=0;u<o;++u)c[u]=(i-u)/-s;else for(let u=0;u<o;++u)c[u]=(i-u)*s;else if(s<0)for(let u=0;u<o;++u)c[u]=(a+u)/-s;else for(let u=0;u<o;++u)c[u]=(a+u)*s;return c}function nw(e,t,r){return t=+t,e=+e,r=+r,bh(e,t,r)[2]}function aw(e,t,r){t=+t,e=+e,r=+r;const n=t<e,a=n?nw(t,e,r):nw(e,t,r);return(n?-1:1)*(a<0?1/-a:a)}function qC(e,t){let r;for(const n of e)n!=null&&(r<n||r===void 0&&n>=n)&&(r=n);return r}function VC(e,t){let r;for(const n of e)n!=null&&(r>n||r===void 0&&n>=n)&&(r=n);return r}function O8(e,t,r=0,n=1/0,a){if(t=Math.floor(t),r=Math.floor(Math.max(0,r)),n=Math.floor(Math.min(e.length-1,n)),!(r<=t&&t<=n))return e;for(a=a===void 0?C8:oJ(a);n>r;){if(n-r>600){const c=n-r+1,u=t-r+1,d=Math.log(c),h=.5*Math.exp(2*d/3),p=.5*Math.sqrt(d*h*(c-h)/c)*(u-c/2<0?-1:1),v=Math.max(r,Math.floor(t-u*h/c+p)),x=Math.min(n,Math.floor(t+(c-u)*h/c+p));O8(e,t,v,x,a)}const i=e[t];let s=r,o=n;for(au(e,r,t),a(e[n],i)>0&&au(e,r,n);s<o;){for(au(e,s,o),++s,--o;a(e[s],i)<0;)++s;for(;a(e[o],i)>0;)--o}a(e[r],i)===0?au(e,r,o):(++o,au(e,o,n)),o<=t&&(r=o+1),t<=o&&(n=o-1)}return e}function au(e,t,r){const n=e[t];e[t]=e[r],e[r]=n}function fJ(e,t,r){if(e=Float64Array.from(rJ(e)),!(!(n=e.length)||isNaN(t=+t))){if(t<=0||n<2)return VC(e);if(t>=1)return qC(e);var n,a=(n-1)*t,i=Math.floor(a),s=qC(O8(e,i).subarray(0,i+1)),o=VC(e.subarray(i+1));return s+(o-s)*(a-i)}}function dJ(e,t,r=A8){if(!(!(n=e.length)||isNaN(t=+t))){if(t<=0||n<2)return+r(e[0],0,e);if(t>=1)return+r(e[n-1],n-1,e);var n,a=(n-1)*t,i=Math.floor(a),s=+r(e[i],i,e),o=+r(e[i+1],i+1,e);return s+(o-s)*(a-i)}}function hJ(e,t,r){e=+e,t=+t,r=(a=arguments.length)<2?(t=e,e=0,1):a<3?1:+r;for(var n=-1,a=Math.max(0,Math.ceil((t-e)/r))|0,i=new Array(a);++n<a;)i[n]=e+n*r;return i}function Ga(e,t){switch(arguments.length){case 0:break;case 1:this.range(e);break;default:this.range(t).domain(e);break}return this}function ps(e,t){switch(arguments.length){case 0:break;case 1:{typeof e=="function"?this.interpolator(e):this.range(e);break}default:{this.domain(e),typeof t=="function"?this.interpolator(t):this.range(t);break}}return this}const iw=Symbol("implicit");function c_(){var e=new WC,t=[],r=[],n=iw;function a(i){let s=e.get(i);if(s===void 0){if(n!==iw)return n;e.set(i,s=t.push(i)-1)}return r[s%r.length]}return a.domain=function(i){if(!arguments.length)return t.slice();t=[],e=new WC;for(const s of i)e.has(s)||e.set(s,t.push(s)-1);return a},a.range=function(i){return arguments.length?(r=Array.from(i),a):r.slice()},a.unknown=function(i){return arguments.length?(n=i,a):n},a.copy=function(){return c_(t,r).unknown(n)},Ga.apply(a,arguments),a}function uf(){var e=c_().unknown(void 0),t=e.domain,r=e.range,n=0,a=1,i,s,o=!1,c=0,u=0,d=.5;delete e.unknown;function h(){var p=t().length,v=a<n,x=v?a:n,w=v?n:a;i=(w-x)/Math.max(1,p-c+u*2),o&&(i=Math.floor(i)),x+=(w-x-i*(p-c))*d,s=i*(1-c),o&&(x=Math.round(x),s=Math.round(s));var y=hJ(p).map(function(_){return x+i*_});return r(v?y.reverse():y)}return e.domain=function(p){return arguments.length?(t(p),h()):t()},e.range=function(p){return arguments.length?([n,a]=p,n=+n,a=+a,h()):[n,a]},e.rangeRound=function(p){return[n,a]=p,n=+n,a=+a,o=!0,h()},e.bandwidth=function(){return s},e.step=function(){return i},e.round=function(p){return arguments.length?(o=!!p,h()):o},e.padding=function(p){return arguments.length?(c=Math.min(1,u=+p),h()):c},e.paddingInner=function(p){return arguments.length?(c=Math.min(1,p),h()):c},e.paddingOuter=function(p){return arguments.length?(u=+p,h()):u},e.align=function(p){return arguments.length?(d=Math.max(0,Math.min(1,p)),h()):d},e.copy=function(){return uf(t(),[n,a]).round(o).paddingInner(c).paddingOuter(u).align(d)},Ga.apply(h(),arguments)}function N8(e){var t=e.copy;return e.padding=e.paddingOuter,delete e.paddingInner,delete e.paddingOuter,e.copy=function(){return N8(t())},e}function Pu(){return N8(uf.apply(null,arguments).paddingInner(1))}function u_(e,t,r){e.prototype=t.prototype=r,r.constructor=e}function P8(e,t){var r=Object.create(e.prototype);for(var n in t)r[n]=t[n];return r}function r0(){}var ff=.7,_h=1/ff,$l="\\s*([+-]?\\d+)\\s*",df="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",Ci="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",pJ=/^#([0-9a-f]{3,8})$/,mJ=new RegExp(`^rgb\\(${$l},${$l},${$l}\\)$`),vJ=new RegExp(`^rgb\\(${Ci},${Ci},${Ci}\\)$`),gJ=new RegExp(`^rgba\\(${$l},${$l},${$l},${df}\\)$`),xJ=new RegExp(`^rgba\\(${Ci},${Ci},${Ci},${df}\\)$`),yJ=new RegExp(`^hsl\\(${df},${Ci},${Ci}\\)$`),wJ=new RegExp(`^hsla\\(${df},${Ci},${Ci},${df}\\)$`),XC={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};u_(r0,hf,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:GC,formatHex:GC,formatHex8:bJ,formatHsl:_J,formatRgb:KC,toString:KC});function GC(){return this.rgb().formatHex()}function bJ(){return this.rgb().formatHex8()}function _J(){return I8(this).formatHsl()}function KC(){return this.rgb().formatRgb()}function hf(e){var t,r;return e=(e+"").trim().toLowerCase(),(t=pJ.exec(e))?(r=t[1].length,t=parseInt(t[1],16),r===6?YC(t):r===3?new ea(t>>8&15|t>>4&240,t>>4&15|t&240,(t&15)<<4|t&15,1):r===8?Id(t>>24&255,t>>16&255,t>>8&255,(t&255)/255):r===4?Id(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|t&240,((t&15)<<4|t&15)/255):null):(t=mJ.exec(e))?new ea(t[1],t[2],t[3],1):(t=vJ.exec(e))?new ea(t[1]*255/100,t[2]*255/100,t[3]*255/100,1):(t=gJ.exec(e))?Id(t[1],t[2],t[3],t[4]):(t=xJ.exec(e))?Id(t[1]*255/100,t[2]*255/100,t[3]*255/100,t[4]):(t=yJ.exec(e))?JC(t[1],t[2]/100,t[3]/100,1):(t=wJ.exec(e))?JC(t[1],t[2]/100,t[3]/100,t[4]):XC.hasOwnProperty(e)?YC(XC[e]):e==="transparent"?new ea(NaN,NaN,NaN,0):null}function YC(e){return new ea(e>>16&255,e>>8&255,e&255,1)}function Id(e,t,r,n){return n<=0&&(e=t=r=NaN),new ea(e,t,r,n)}function SJ(e){return e instanceof r0||(e=hf(e)),e?(e=e.rgb(),new ea(e.r,e.g,e.b,e.opacity)):new ea}function sw(e,t,r,n){return arguments.length===1?SJ(e):new ea(e,t,r,n??1)}function ea(e,t,r,n){this.r=+e,this.g=+t,this.b=+r,this.opacity=+n}u_(ea,sw,P8(r0,{brighter(e){return e=e==null?_h:Math.pow(_h,e),new ea(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=e==null?ff:Math.pow(ff,e),new ea(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new ea(jo(this.r),jo(this.g),jo(this.b),Sh(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:ZC,formatHex:ZC,formatHex8:kJ,formatRgb:QC,toString:QC}));function ZC(){return`#${To(this.r)}${To(this.g)}${To(this.b)}`}function kJ(){return`#${To(this.r)}${To(this.g)}${To(this.b)}${To((isNaN(this.opacity)?1:this.opacity)*255)}`}function QC(){const e=Sh(this.opacity);return`${e===1?"rgb(":"rgba("}${jo(this.r)}, ${jo(this.g)}, ${jo(this.b)}${e===1?")":`, ${e})`}`}function Sh(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function jo(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function To(e){return e=jo(e),(e<16?"0":"")+e.toString(16)}function JC(e,t,r,n){return n<=0?e=t=r=NaN:r<=0||r>=1?e=t=NaN:t<=0&&(e=NaN),new ai(e,t,r,n)}function I8(e){if(e instanceof ai)return new ai(e.h,e.s,e.l,e.opacity);if(e instanceof r0||(e=hf(e)),!e)return new ai;if(e instanceof ai)return e;e=e.rgb();var t=e.r/255,r=e.g/255,n=e.b/255,a=Math.min(t,r,n),i=Math.max(t,r,n),s=NaN,o=i-a,c=(i+a)/2;return o?(t===i?s=(r-n)/o+(r<n)*6:r===i?s=(n-t)/o+2:s=(t-r)/o+4,o/=c<.5?i+a:2-i-a,s*=60):o=c>0&&c<1?0:s,new ai(s,o,c,e.opacity)}function EJ(e,t,r,n){return arguments.length===1?I8(e):new ai(e,t,r,n??1)}function ai(e,t,r,n){this.h=+e,this.s=+t,this.l=+r,this.opacity=+n}u_(ai,EJ,P8(r0,{brighter(e){return e=e==null?_h:Math.pow(_h,e),new ai(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=e==null?ff:Math.pow(ff,e),new ai(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+(this.h<0)*360,t=isNaN(e)||isNaN(this.s)?0:this.s,r=this.l,n=r+(r<.5?r:1-r)*t,a=2*r-n;return new ea(ly(e>=240?e-240:e+120,a,n),ly(e,a,n),ly(e<120?e+240:e-120,a,n),this.opacity)},clamp(){return new ai(e3(this.h),Fd(this.s),Fd(this.l),Sh(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const e=Sh(this.opacity);return`${e===1?"hsl(":"hsla("}${e3(this.h)}, ${Fd(this.s)*100}%, ${Fd(this.l)*100}%${e===1?")":`, ${e})`}`}}));function e3(e){return e=(e||0)%360,e<0?e+360:e}function Fd(e){return Math.max(0,Math.min(1,e||0))}function ly(e,t,r){return(e<60?t+(r-t)*e/60:e<180?r:e<240?t+(r-t)*(240-e)/60:t)*255}const f_=e=>()=>e;function TJ(e,t){return function(r){return e+r*t}}function AJ(e,t,r){return e=Math.pow(e,r),t=Math.pow(t,r)-e,r=1/r,function(n){return Math.pow(e+n*t,r)}}function CJ(e){return(e=+e)==1?F8:function(t,r){return r-t?AJ(t,r,e):f_(isNaN(t)?r:t)}}function F8(e,t){var r=t-e;return r?TJ(e,r):f_(isNaN(e)?t:e)}const t3=(function e(t){var r=CJ(t);function n(a,i){var s=r((a=sw(a)).r,(i=sw(i)).r),o=r(a.g,i.g),c=r(a.b,i.b),u=F8(a.opacity,i.opacity);return function(d){return a.r=s(d),a.g=o(d),a.b=c(d),a.opacity=u(d),a+""}}return n.gamma=e,n})(1);function OJ(e,t){t||(t=[]);var r=e?Math.min(t.length,e.length):0,n=t.slice(),a;return function(i){for(a=0;a<r;++a)n[a]=e[a]*(1-i)+t[a]*i;return n}}function NJ(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}function PJ(e,t){var r=t?t.length:0,n=e?Math.min(r,e.length):0,a=new Array(n),i=new Array(r),s;for(s=0;s<n;++s)a[s]=xc(e[s],t[s]);for(;s<r;++s)i[s]=t[s];return function(o){for(s=0;s<n;++s)i[s]=a[s](o);return i}}function IJ(e,t){var r=new Date;return e=+e,t=+t,function(n){return r.setTime(e*(1-n)+t*n),r}}function kh(e,t){return e=+e,t=+t,function(r){return e*(1-r)+t*r}}function FJ(e,t){var r={},n={},a;(e===null||typeof e!="object")&&(e={}),(t===null||typeof t!="object")&&(t={});for(a in t)a in e?r[a]=xc(e[a],t[a]):n[a]=t[a];return function(i){for(a in r)n[a]=r[a](i);return n}}var ow=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,cy=new RegExp(ow.source,"g");function DJ(e){return function(){return e}}function jJ(e){return function(t){return e(t)+""}}function RJ(e,t){var r=ow.lastIndex=cy.lastIndex=0,n,a,i,s=-1,o=[],c=[];for(e=e+"",t=t+"";(n=ow.exec(e))&&(a=cy.exec(t));)(i=a.index)>r&&(i=t.slice(r,i),o[s]?o[s]+=i:o[++s]=i),(n=n[0])===(a=a[0])?o[s]?o[s]+=a:o[++s]=a:(o[++s]=null,c.push({i:s,x:kh(n,a)})),r=cy.lastIndex;return r<t.length&&(i=t.slice(r),o[s]?o[s]+=i:o[++s]=i),o.length<2?c[0]?jJ(c[0].x):DJ(t):(t=c.length,function(u){for(var d=0,h;d<t;++d)o[(h=c[d]).i]=h.x(u);return o.join("")})}function xc(e,t){var r=typeof t,n;return t==null||r==="boolean"?f_(t):(r==="number"?kh:r==="string"?(n=hf(t))?(t=n,t3):RJ:t instanceof hf?t3:t instanceof Date?IJ:NJ(t)?OJ:Array.isArray(t)?PJ:typeof t.valueOf!="function"&&typeof t.toString!="function"||isNaN(t)?FJ:kh)(e,t)}function d_(e,t){return e=+e,t=+t,function(r){return Math.round(e*(1-r)+t*r)}}function MJ(e,t){t===void 0&&(t=e,e=xc);for(var r=0,n=t.length-1,a=t[0],i=new Array(n<0?0:n);r<n;)i[r]=e(a,a=t[++r]);return function(s){var o=Math.max(0,Math.min(n-1,Math.floor(s*=n)));return i[o](s-o)}}function LJ(e){return function(){return e}}function Eh(e){return+e}var r3=[0,1];function Hn(e){return e}function lw(e,t){return(t-=e=+e)?function(r){return(r-e)/t}:LJ(isNaN(t)?NaN:.5)}function BJ(e,t){var r;return e>t&&(r=e,e=t,t=r),function(n){return Math.max(e,Math.min(t,n))}}function $J(e,t,r){var n=e[0],a=e[1],i=t[0],s=t[1];return a<n?(n=lw(a,n),i=r(s,i)):(n=lw(n,a),i=r(i,s)),function(o){return i(n(o))}}function UJ(e,t,r){var n=Math.min(e.length,t.length)-1,a=new Array(n),i=new Array(n),s=-1;for(e[n]<e[0]&&(e=e.slice().reverse(),t=t.slice().reverse());++s<n;)a[s]=lw(e[s],e[s+1]),i[s]=r(t[s],t[s+1]);return function(o){var c=t0(e,o,1,n)-1;return i[c](a[c](o))}}function n0(e,t){return t.domain(e.domain()).range(e.range()).interpolate(e.interpolate()).clamp(e.clamp()).unknown(e.unknown())}function Cp(){var e=r3,t=r3,r=xc,n,a,i,s=Hn,o,c,u;function d(){var p=Math.min(e.length,t.length);return s!==Hn&&(s=BJ(e[0],e[p-1])),o=p>2?UJ:$J,c=u=null,h}function h(p){return p==null||isNaN(p=+p)?i:(c||(c=o(e.map(n),t,r)))(n(s(p)))}return h.invert=function(p){return s(a((u||(u=o(t,e.map(n),kh)))(p)))},h.domain=function(p){return arguments.length?(e=Array.from(p,Eh),d()):e.slice()},h.range=function(p){return arguments.length?(t=Array.from(p),d()):t.slice()},h.rangeRound=function(p){return t=Array.from(p),r=d_,d()},h.clamp=function(p){return arguments.length?(s=p?!0:Hn,d()):s!==Hn},h.interpolate=function(p){return arguments.length?(r=p,d()):r},h.unknown=function(p){return arguments.length?(i=p,h):i},function(p,v){return n=p,a=v,d()}}function h_(){return Cp()(Hn,Hn)}function zJ(e){return Math.abs(e=Math.round(e))>=1e21?e.toLocaleString("en").replace(/,/g,""):e.toString(10)}function Th(e,t){if((r=(e=t?e.toExponential(t-1):e.toExponential()).indexOf("e"))<0)return null;var r,n=e.slice(0,r);return[n.length>1?n[0]+n.slice(2):n,+e.slice(r+1)]}function Ql(e){return e=Th(Math.abs(e)),e?e[1]:NaN}function WJ(e,t){return function(r,n){for(var a=r.length,i=[],s=0,o=e[0],c=0;a>0&&o>0&&(c+o+1>n&&(o=Math.max(1,n-c)),i.push(r.substring(a-=o,a+o)),!((c+=o+1)>n));)o=e[s=(s+1)%e.length];return i.reverse().join(t)}}function HJ(e){return function(t){return t.replace(/[0-9]/g,function(r){return e[+r]})}}var qJ=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function pf(e){if(!(t=qJ.exec(e)))throw new Error("invalid format: "+e);var t;return new p_({fill:t[1],align:t[2],sign:t[3],symbol:t[4],zero:t[5],width:t[6],comma:t[7],precision:t[8]&&t[8].slice(1),trim:t[9],type:t[10]})}pf.prototype=p_.prototype;function p_(e){this.fill=e.fill===void 0?" ":e.fill+"",this.align=e.align===void 0?">":e.align+"",this.sign=e.sign===void 0?"-":e.sign+"",this.symbol=e.symbol===void 0?"":e.symbol+"",this.zero=!!e.zero,this.width=e.width===void 0?void 0:+e.width,this.comma=!!e.comma,this.precision=e.precision===void 0?void 0:+e.precision,this.trim=!!e.trim,this.type=e.type===void 0?"":e.type+""}p_.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function VJ(e){e:for(var t=e.length,r=1,n=-1,a;r<t;++r)switch(e[r]){case".":n=a=r;break;case"0":n===0&&(n=r),a=r;break;default:if(!+e[r])break e;n>0&&(n=0);break}return n>0?e.slice(0,n)+e.slice(a+1):e}var D8;function XJ(e,t){var r=Th(e,t);if(!r)return e+"";var n=r[0],a=r[1],i=a-(D8=Math.max(-8,Math.min(8,Math.floor(a/3)))*3)+1,s=n.length;return i===s?n:i>s?n+new Array(i-s+1).join("0"):i>0?n.slice(0,i)+"."+n.slice(i):"0."+new Array(1-i).join("0")+Th(e,Math.max(0,t+i-1))[0]}function n3(e,t){var r=Th(e,t);if(!r)return e+"";var n=r[0],a=r[1];return a<0?"0."+new Array(-a).join("0")+n:n.length>a+1?n.slice(0,a+1)+"."+n.slice(a+1):n+new Array(a-n.length+2).join("0")}const a3={"%":(e,t)=>(e*100).toFixed(t),b:e=>Math.round(e).toString(2),c:e=>e+"",d:zJ,e:(e,t)=>e.toExponential(t),f:(e,t)=>e.toFixed(t),g:(e,t)=>e.toPrecision(t),o:e=>Math.round(e).toString(8),p:(e,t)=>n3(e*100,t),r:n3,s:XJ,X:e=>Math.round(e).toString(16).toUpperCase(),x:e=>Math.round(e).toString(16)};function i3(e){return e}var s3=Array.prototype.map,o3=["y","z","a","f","p","n","","m","","k","M","G","T","P","E","Z","Y"];function GJ(e){var t=e.grouping===void 0||e.thousands===void 0?i3:WJ(s3.call(e.grouping,Number),e.thousands+""),r=e.currency===void 0?"":e.currency[0]+"",n=e.currency===void 0?"":e.currency[1]+"",a=e.decimal===void 0?".":e.decimal+"",i=e.numerals===void 0?i3:HJ(s3.call(e.numerals,String)),s=e.percent===void 0?"%":e.percent+"",o=e.minus===void 0?"":e.minus+"",c=e.nan===void 0?"NaN":e.nan+"";function u(h){h=pf(h);var p=h.fill,v=h.align,x=h.sign,w=h.symbol,y=h.zero,_=h.width,S=h.comma,k=h.precision,E=h.trim,T=h.type;T==="n"?(S=!0,T="g"):a3[T]||(k===void 0&&(k=12),E=!0,T="g"),(y||p==="0"&&v==="=")&&(y=!0,p="0",v="=");var N=w==="$"?r:w==="#"&&/[boxX]/.test(T)?"0"+T.toLowerCase():"",C=w==="$"?n:/[%p]/.test(T)?s:"",P=a3[T],j=/[defgprs%]/.test(T);k=k===void 0?6:/[gprs]/.test(T)?Math.max(1,Math.min(21,k)):Math.max(0,Math.min(20,k));function R(I){var F=N,L=C,H,V,J;if(T==="c")L=P(I)+L,I="";else{I=+I;var te=I<0||1/I<0;if(I=isNaN(I)?c:P(Math.abs(I),k),E&&(I=VJ(I)),te&&+I==0&&x!=="+"&&(te=!1),F=(te?x==="("?x:o:x==="-"||x==="("?"":x)+F,L=(T==="s"?o3[8+D8/3]:"")+L+(te&&x==="("?")":""),j){for(H=-1,V=I.length;++H<V;)if(J=I.charCodeAt(H),48>J||J>57){L=(J===46?a+I.slice(H+1):I.slice(H))+L,I=I.slice(0,H);break}}}S&&!y&&(I=t(I,1/0));var q=F.length+I.length+L.length,oe=q<_?new Array(_-q+1).join(p):"";switch(S&&y&&(I=t(oe+I,oe.length?_-L.length:1/0),oe=""),v){case"<":I=F+I+L+oe;break;case"=":I=F+oe+I+L;break;case"^":I=oe.slice(0,q=oe.length>>1)+F+I+L+oe.slice(q);break;default:I=oe+F+I+L;break}return i(I)}return R.toString=function(){return h+""},R}function d(h,p){var v=u((h=pf(h),h.type="f",h)),x=Math.max(-8,Math.min(8,Math.floor(Ql(p)/3)))*3,w=Math.pow(10,-x),y=o3[8+x/3];return function(_){return v(w*_)+y}}return{format:u,formatPrefix:d}}var Dd,m_,j8;KJ({thousands:",",grouping:[3],currency:["$",""]});function KJ(e){return Dd=GJ(e),m_=Dd.format,j8=Dd.formatPrefix,Dd}function YJ(e){return Math.max(0,-Ql(Math.abs(e)))}function ZJ(e,t){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(Ql(t)/3)))*3-Ql(Math.abs(e)))}function QJ(e,t){return e=Math.abs(e),t=Math.abs(t)-e,Math.max(0,Ql(t)-Ql(e))+1}function R8(e,t,r,n){var a=aw(e,t,r),i;switch(n=pf(n??",f"),n.type){case"s":{var s=Math.max(Math.abs(e),Math.abs(t));return n.precision==null&&!isNaN(i=ZJ(a,s))&&(n.precision=i),j8(n,s)}case"":case"e":case"g":case"p":case"r":{n.precision==null&&!isNaN(i=QJ(a,Math.max(Math.abs(e),Math.abs(t))))&&(n.precision=i-(n.type==="e"));break}case"f":case"%":{n.precision==null&&!isNaN(i=YJ(a))&&(n.precision=i-(n.type==="%")*2);break}}return m_(n)}function Js(e){var t=e.domain;return e.ticks=function(r){var n=t();return rw(n[0],n[n.length-1],r??10)},e.tickFormat=function(r,n){var a=t();return R8(a[0],a[a.length-1],r??10,n)},e.nice=function(r){r==null&&(r=10);var n=t(),a=0,i=n.length-1,s=n[a],o=n[i],c,u,d=10;for(o<s&&(u=s,s=o,o=u,u=a,a=i,i=u);d-- >0;){if(u=nw(s,o,r),u===c)return n[a]=s,n[i]=o,t(n);if(u>0)s=Math.floor(s/u)*u,o=Math.ceil(o/u)*u;else if(u<0)s=Math.ceil(s*u)/u,o=Math.floor(o*u)/u;else break;c=u}return e},e}function Ah(){var e=h_();return e.copy=function(){return n0(e,Ah())},Ga.apply(e,arguments),Js(e)}function M8(e){var t;function r(n){return n==null||isNaN(n=+n)?t:n}return r.invert=r,r.domain=r.range=function(n){return arguments.length?(e=Array.from(n,Eh),r):e.slice()},r.unknown=function(n){return arguments.length?(t=n,r):t},r.copy=function(){return M8(e).unknown(t)},e=arguments.length?Array.from(e,Eh):[0,1],Js(r)}function L8(e,t){e=e.slice();var r=0,n=e.length-1,a=e[r],i=e[n],s;return i<a&&(s=r,r=n,n=s,s=a,a=i,i=s),e[r]=t.floor(a),e[n]=t.ceil(i),e}function l3(e){return Math.log(e)}function c3(e){return Math.exp(e)}function JJ(e){return-Math.log(-e)}function eee(e){return-Math.exp(-e)}function tee(e){return isFinite(e)?+("1e"+e):e<0?0:e}function ree(e){return e===10?tee:e===Math.E?Math.exp:t=>Math.pow(e,t)}function nee(e){return e===Math.E?Math.log:e===10&&Math.log10||e===2&&Math.log2||(e=Math.log(e),t=>Math.log(t)/e)}function u3(e){return(t,r)=>-e(-t,r)}function v_(e){const t=e(l3,c3),r=t.domain;let n=10,a,i;function s(){return a=nee(n),i=ree(n),r()[0]<0?(a=u3(a),i=u3(i),e(JJ,eee)):e(l3,c3),t}return t.base=function(o){return arguments.length?(n=+o,s()):n},t.domain=function(o){return arguments.length?(r(o),s()):r()},t.ticks=o=>{const c=r();let u=c[0],d=c[c.length-1];const h=d<u;h&&([u,d]=[d,u]);let p=a(u),v=a(d),x,w;const y=o==null?10:+o;let _=[];if(!(n%1)&&v-p<y){if(p=Math.floor(p),v=Math.ceil(v),u>0){for(;p<=v;++p)for(x=1;x<n;++x)if(w=p<0?x/i(-p):x*i(p),!(w<u)){if(w>d)break;_.push(w)}}else for(;p<=v;++p)for(x=n-1;x>=1;--x)if(w=p>0?x/i(-p):x*i(p),!(w<u)){if(w>d)break;_.push(w)}_.length*2<y&&(_=rw(u,d,y))}else _=rw(p,v,Math.min(v-p,y)).map(i);return h?_.reverse():_},t.tickFormat=(o,c)=>{if(o==null&&(o=10),c==null&&(c=n===10?"s":","),typeof c!="function"&&(!(n%1)&&(c=pf(c)).precision==null&&(c.trim=!0),c=m_(c)),o===1/0)return c;const u=Math.max(1,n*o/t.ticks().length);return d=>{let h=d/i(Math.round(a(d)));return h*n<n-.5&&(h*=n),h<=u?c(d):""}},t.nice=()=>r(L8(r(),{floor:o=>i(Math.floor(a(o))),ceil:o=>i(Math.ceil(a(o)))})),t}function B8(){const e=v_(Cp()).domain([1,10]);return e.copy=()=>n0(e,B8()).base(e.base()),Ga.apply(e,arguments),e}function f3(e){return function(t){return Math.sign(t)*Math.log1p(Math.abs(t/e))}}function d3(e){return function(t){return Math.sign(t)*Math.expm1(Math.abs(t))*e}}function g_(e){var t=1,r=e(f3(t),d3(t));return r.constant=function(n){return arguments.length?e(f3(t=+n),d3(t)):t},Js(r)}function $8(){var e=g_(Cp());return e.copy=function(){return n0(e,$8()).constant(e.constant())},Ga.apply(e,arguments)}function h3(e){return function(t){return t<0?-Math.pow(-t,e):Math.pow(t,e)}}function aee(e){return e<0?-Math.sqrt(-e):Math.sqrt(e)}function iee(e){return e<0?-e*e:e*e}function x_(e){var t=e(Hn,Hn),r=1;function n(){return r===1?e(Hn,Hn):r===.5?e(aee,iee):e(h3(r),h3(1/r))}return t.exponent=function(a){return arguments.length?(r=+a,n()):r},Js(t)}function y_(){var e=x_(Cp());return e.copy=function(){return n0(e,y_()).exponent(e.exponent())},Ga.apply(e,arguments),e}function see(){return y_.apply(null,arguments).exponent(.5)}function p3(e){return Math.sign(e)*e*e}function oee(e){return Math.sign(e)*Math.sqrt(Math.abs(e))}function U8(){var e=h_(),t=[0,1],r=!1,n;function a(i){var s=oee(e(i));return isNaN(s)?n:r?Math.round(s):s}return a.invert=function(i){return e.invert(p3(i))},a.domain=function(i){return arguments.length?(e.domain(i),a):e.domain()},a.range=function(i){return arguments.length?(e.range((t=Array.from(i,Eh)).map(p3)),a):t.slice()},a.rangeRound=function(i){return a.range(i).round(!0)},a.round=function(i){return arguments.length?(r=!!i,a):r},a.clamp=function(i){return arguments.length?(e.clamp(i),a):e.clamp()},a.unknown=function(i){return arguments.length?(n=i,a):n},a.copy=function(){return U8(e.domain(),t).round(r).clamp(e.clamp()).unknown(n)},Ga.apply(a,arguments),Js(a)}function z8(){var e=[],t=[],r=[],n;function a(){var s=0,o=Math.max(1,t.length);for(r=new Array(o-1);++s<o;)r[s-1]=dJ(e,s/o);return i}function i(s){return s==null||isNaN(s=+s)?n:t[t0(r,s)]}return i.invertExtent=function(s){var o=t.indexOf(s);return o<0?[NaN,NaN]:[o>0?r[o-1]:e[0],o<r.length?r[o]:e[e.length-1]]},i.domain=function(s){if(!arguments.length)return e.slice();e=[];for(let o of s)o!=null&&!isNaN(o=+o)&&e.push(o);return e.sort(Ws),a()},i.range=function(s){return arguments.length?(t=Array.from(s),a()):t.slice()},i.unknown=function(s){return arguments.length?(n=s,i):n},i.quantiles=function(){return r.slice()},i.copy=function(){return z8().domain(e).range(t).unknown(n)},Ga.apply(i,arguments)}function W8(){var e=0,t=1,r=1,n=[.5],a=[0,1],i;function s(c){return c!=null&&c<=c?a[t0(n,c,0,r)]:i}function o(){var c=-1;for(n=new Array(r);++c<r;)n[c]=((c+1)*t-(c-r)*e)/(r+1);return s}return s.domain=function(c){return arguments.length?([e,t]=c,e=+e,t=+t,o()):[e,t]},s.range=function(c){return arguments.length?(r=(a=Array.from(c)).length-1,o()):a.slice()},s.invertExtent=function(c){var u=a.indexOf(c);return u<0?[NaN,NaN]:u<1?[e,n[0]]:u>=r?[n[r-1],t]:[n[u-1],n[u]]},s.unknown=function(c){return arguments.length&&(i=c),s},s.thresholds=function(){return n.slice()},s.copy=function(){return W8().domain([e,t]).range(a).unknown(i)},Ga.apply(Js(s),arguments)}function H8(){var e=[.5],t=[0,1],r,n=1;function a(i){return i!=null&&i<=i?t[t0(e,i,0,n)]:r}return a.domain=function(i){return arguments.length?(e=Array.from(i),n=Math.min(e.length,t.length-1),a):e.slice()},a.range=function(i){return arguments.length?(t=Array.from(i),n=Math.min(e.length,t.length-1),a):t.slice()},a.invertExtent=function(i){var s=t.indexOf(i);return[e[s-1],e[s]]},a.unknown=function(i){return arguments.length?(r=i,a):r},a.copy=function(){return H8().domain(e).range(t).unknown(r)},Ga.apply(a,arguments)}const uy=new Date,fy=new Date;function rn(e,t,r,n){function a(i){return e(i=arguments.length===0?new Date:new Date(+i)),i}return a.floor=i=>(e(i=new Date(+i)),i),a.ceil=i=>(e(i=new Date(i-1)),t(i,1),e(i),i),a.round=i=>{const s=a(i),o=a.ceil(i);return i-s<o-i?s:o},a.offset=(i,s)=>(t(i=new Date(+i),s==null?1:Math.floor(s)),i),a.range=(i,s,o)=>{const c=[];if(i=a.ceil(i),o=o==null?1:Math.floor(o),!(i<s)||!(o>0))return c;let u;do c.push(u=new Date(+i)),t(i,o),e(i);while(u<i&&i<s);return c},a.filter=i=>rn(s=>{if(s>=s)for(;e(s),!i(s);)s.setTime(s-1)},(s,o)=>{if(s>=s)if(o<0)for(;++o<=0;)for(;t(s,-1),!i(s););else for(;--o>=0;)for(;t(s,1),!i(s););}),r&&(a.count=(i,s)=>(uy.setTime(+i),fy.setTime(+s),e(uy),e(fy),Math.floor(r(uy,fy))),a.every=i=>(i=Math.floor(i),!isFinite(i)||!(i>0)?null:i>1?a.filter(n?s=>n(s)%i===0:s=>a.count(0,s)%i===0):a)),a}const Ch=rn(()=>{},(e,t)=>{e.setTime(+e+t)},(e,t)=>t-e);Ch.every=e=>(e=Math.floor(e),!isFinite(e)||!(e>0)?null:e>1?rn(t=>{t.setTime(Math.floor(t/e)*e)},(t,r)=>{t.setTime(+t+r*e)},(t,r)=>(r-t)/e):Ch);Ch.range;const Yi=1e3,Wa=Yi*60,Zi=Wa*60,os=Zi*24,w_=os*7,m3=os*30,dy=os*365,Ao=rn(e=>{e.setTime(e-e.getMilliseconds())},(e,t)=>{e.setTime(+e+t*Yi)},(e,t)=>(t-e)/Yi,e=>e.getUTCSeconds());Ao.range;const b_=rn(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*Yi)},(e,t)=>{e.setTime(+e+t*Wa)},(e,t)=>(t-e)/Wa,e=>e.getMinutes());b_.range;const __=rn(e=>{e.setUTCSeconds(0,0)},(e,t)=>{e.setTime(+e+t*Wa)},(e,t)=>(t-e)/Wa,e=>e.getUTCMinutes());__.range;const S_=rn(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*Yi-e.getMinutes()*Wa)},(e,t)=>{e.setTime(+e+t*Zi)},(e,t)=>(t-e)/Zi,e=>e.getHours());S_.range;const k_=rn(e=>{e.setUTCMinutes(0,0,0)},(e,t)=>{e.setTime(+e+t*Zi)},(e,t)=>(t-e)/Zi,e=>e.getUTCHours());k_.range;const a0=rn(e=>e.setHours(0,0,0,0),(e,t)=>e.setDate(e.getDate()+t),(e,t)=>(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*Wa)/os,e=>e.getDate()-1);a0.range;const Op=rn(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/os,e=>e.getUTCDate()-1);Op.range;const q8=rn(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/os,e=>Math.floor(e/os));q8.range;function Qo(e){return rn(t=>{t.setDate(t.getDate()-(t.getDay()+7-e)%7),t.setHours(0,0,0,0)},(t,r)=>{t.setDate(t.getDate()+r*7)},(t,r)=>(r-t-(r.getTimezoneOffset()-t.getTimezoneOffset())*Wa)/w_)}const Np=Qo(0),Oh=Qo(1),lee=Qo(2),cee=Qo(3),Jl=Qo(4),uee=Qo(5),fee=Qo(6);Np.range;Oh.range;lee.range;cee.range;Jl.range;uee.range;fee.range;function Jo(e){return rn(t=>{t.setUTCDate(t.getUTCDate()-(t.getUTCDay()+7-e)%7),t.setUTCHours(0,0,0,0)},(t,r)=>{t.setUTCDate(t.getUTCDate()+r*7)},(t,r)=>(r-t)/w_)}const Pp=Jo(0),Nh=Jo(1),dee=Jo(2),hee=Jo(3),ec=Jo(4),pee=Jo(5),mee=Jo(6);Pp.range;Nh.range;dee.range;hee.range;ec.range;pee.range;mee.range;const E_=rn(e=>{e.setDate(1),e.setHours(0,0,0,0)},(e,t)=>{e.setMonth(e.getMonth()+t)},(e,t)=>t.getMonth()-e.getMonth()+(t.getFullYear()-e.getFullYear())*12,e=>e.getMonth());E_.range;const T_=rn(e=>{e.setUTCDate(1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCMonth(e.getUTCMonth()+t)},(e,t)=>t.getUTCMonth()-e.getUTCMonth()+(t.getUTCFullYear()-e.getUTCFullYear())*12,e=>e.getUTCMonth());T_.range;const ls=rn(e=>{e.setMonth(0,1),e.setHours(0,0,0,0)},(e,t)=>{e.setFullYear(e.getFullYear()+t)},(e,t)=>t.getFullYear()-e.getFullYear(),e=>e.getFullYear());ls.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:rn(t=>{t.setFullYear(Math.floor(t.getFullYear()/e)*e),t.setMonth(0,1),t.setHours(0,0,0,0)},(t,r)=>{t.setFullYear(t.getFullYear()+r*e)});ls.range;const cs=rn(e=>{e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCFullYear(e.getUTCFullYear()+t)},(e,t)=>t.getUTCFullYear()-e.getUTCFullYear(),e=>e.getUTCFullYear());cs.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:rn(t=>{t.setUTCFullYear(Math.floor(t.getUTCFullYear()/e)*e),t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)},(t,r)=>{t.setUTCFullYear(t.getUTCFullYear()+r*e)});cs.range;function V8(e,t,r,n,a,i){const s=[[Ao,1,Yi],[Ao,5,5*Yi],[Ao,15,15*Yi],[Ao,30,30*Yi],[i,1,Wa],[i,5,5*Wa],[i,15,15*Wa],[i,30,30*Wa],[a,1,Zi],[a,3,3*Zi],[a,6,6*Zi],[a,12,12*Zi],[n,1,os],[n,2,2*os],[r,1,w_],[t,1,m3],[t,3,3*m3],[e,1,dy]];function o(u,d,h){const p=d<u;p&&([u,d]=[d,u]);const v=h&&typeof h.range=="function"?h:c(u,d,h),x=v?v.range(u,+d+1):[];return p?x.reverse():x}function c(u,d,h){const p=Math.abs(d-u)/h,v=l_(([,,y])=>y).right(s,p);if(v===s.length)return e.every(aw(u/dy,d/dy,h));if(v===0)return Ch.every(Math.max(aw(u,d,h),1));const[x,w]=s[p/s[v-1][2]<s[v][2]/p?v-1:v];return x.every(w)}return[o,c]}const[vee,gee]=V8(cs,T_,Pp,q8,k_,__),[xee,yee]=V8(ls,E_,Np,a0,S_,b_);function hy(e){if(0<=e.y&&e.y<100){var t=new Date(-1,e.m,e.d,e.H,e.M,e.S,e.L);return t.setFullYear(e.y),t}return new Date(e.y,e.m,e.d,e.H,e.M,e.S,e.L)}function py(e){if(0<=e.y&&e.y<100){var t=new Date(Date.UTC(-1,e.m,e.d,e.H,e.M,e.S,e.L));return t.setUTCFullYear(e.y),t}return new Date(Date.UTC(e.y,e.m,e.d,e.H,e.M,e.S,e.L))}function iu(e,t,r){return{y:e,m:t,d:r,H:0,M:0,S:0,L:0}}function wee(e){var t=e.dateTime,r=e.date,n=e.time,a=e.periods,i=e.days,s=e.shortDays,o=e.months,c=e.shortMonths,u=su(a),d=ou(a),h=su(i),p=ou(i),v=su(s),x=ou(s),w=su(o),y=ou(o),_=su(c),S=ou(c),k={a:te,A:q,b:oe,B:Q,c:null,d:b3,e:b3,f:Wee,g:Jee,G:tte,H:$ee,I:Uee,j:zee,L:X8,m:Hee,M:qee,p:Z,q:ee,Q:k3,s:E3,S:Vee,u:Xee,U:Gee,V:Kee,w:Yee,W:Zee,x:null,X:null,y:Qee,Y:ete,Z:rte,"%":S3},E={a:ce,A:de,b:Te,B:Ie,c:null,d:_3,e:_3,f:ste,g:vte,G:xte,H:nte,I:ate,j:ite,L:K8,m:ote,M:lte,p:Ne,q:W,Q:k3,s:E3,S:cte,u:ute,U:fte,V:dte,w:hte,W:pte,x:null,X:null,y:mte,Y:gte,Z:yte,"%":S3},T={a:R,A:I,b:F,B:L,c:H,d:y3,e:y3,f:Ree,g:x3,G:g3,H:w3,I:w3,j:Iee,L:jee,m:Pee,M:Fee,p:j,q:Nee,Q:Lee,s:Bee,S:Dee,u:Eee,U:Tee,V:Aee,w:kee,W:Cee,x:V,X:J,y:x3,Y:g3,Z:Oee,"%":Mee};k.x=N(r,k),k.X=N(n,k),k.c=N(t,k),E.x=N(r,E),E.X=N(n,E),E.c=N(t,E);function N(z,G){return function(X){var ie=[],M=-1,le=0,ye=z.length,Ce,ze,Ze;for(X instanceof Date||(X=new Date(+X));++M<ye;)z.charCodeAt(M)===37&&(ie.push(z.slice(le,M)),(ze=v3[Ce=z.charAt(++M)])!=null?Ce=z.charAt(++M):ze=Ce==="e"?" ":"0",(Ze=G[Ce])&&(Ce=Ze(X,ze)),ie.push(Ce),le=M+1);return ie.push(z.slice(le,M)),ie.join("")}}function C(z,G){return function(X){var ie=iu(1900,void 0,1),M=P(ie,z,X+="",0),le,ye;if(M!=X.length)return null;if("Q"in ie)return new Date(ie.Q);if("s"in ie)return new Date(ie.s*1e3+("L"in ie?ie.L:0));if(G&&!("Z"in ie)&&(ie.Z=0),"p"in ie&&(ie.H=ie.H%12+ie.p*12),ie.m===void 0&&(ie.m="q"in ie?ie.q:0),"V"in ie){if(ie.V<1||ie.V>53)return null;"w"in ie||(ie.w=1),"Z"in ie?(le=py(iu(ie.y,0,1)),ye=le.getUTCDay(),le=ye>4||ye===0?Nh.ceil(le):Nh(le),le=Op.offset(le,(ie.V-1)*7),ie.y=le.getUTCFullYear(),ie.m=le.getUTCMonth(),ie.d=le.getUTCDate()+(ie.w+6)%7):(le=hy(iu(ie.y,0,1)),ye=le.getDay(),le=ye>4||ye===0?Oh.ceil(le):Oh(le),le=a0.offset(le,(ie.V-1)*7),ie.y=le.getFullYear(),ie.m=le.getMonth(),ie.d=le.getDate()+(ie.w+6)%7)}else("W"in ie||"U"in ie)&&("w"in ie||(ie.w="u"in ie?ie.u%7:"W"in ie?1:0),ye="Z"in ie?py(iu(ie.y,0,1)).getUTCDay():hy(iu(ie.y,0,1)).getDay(),ie.m=0,ie.d="W"in ie?(ie.w+6)%7+ie.W*7-(ye+5)%7:ie.w+ie.U*7-(ye+6)%7);return"Z"in ie?(ie.H+=ie.Z/100|0,ie.M+=ie.Z%100,py(ie)):hy(ie)}}function P(z,G,X,ie){for(var M=0,le=G.length,ye=X.length,Ce,ze;M<le;){if(ie>=ye)return-1;if(Ce=G.charCodeAt(M++),Ce===37){if(Ce=G.charAt(M++),ze=T[Ce in v3?G.charAt(M++):Ce],!ze||(ie=ze(z,X,ie))<0)return-1}else if(Ce!=X.charCodeAt(ie++))return-1}return ie}function j(z,G,X){var ie=u.exec(G.slice(X));return ie?(z.p=d.get(ie[0].toLowerCase()),X+ie[0].length):-1}function R(z,G,X){var ie=v.exec(G.slice(X));return ie?(z.w=x.get(ie[0].toLowerCase()),X+ie[0].length):-1}function I(z,G,X){var ie=h.exec(G.slice(X));return ie?(z.w=p.get(ie[0].toLowerCase()),X+ie[0].length):-1}function F(z,G,X){var ie=_.exec(G.slice(X));return ie?(z.m=S.get(ie[0].toLowerCase()),X+ie[0].length):-1}function L(z,G,X){var ie=w.exec(G.slice(X));return ie?(z.m=y.get(ie[0].toLowerCase()),X+ie[0].length):-1}function H(z,G,X){return P(z,t,G,X)}function V(z,G,X){return P(z,r,G,X)}function J(z,G,X){return P(z,n,G,X)}function te(z){return s[z.getDay()]}function q(z){return i[z.getDay()]}function oe(z){return c[z.getMonth()]}function Q(z){return o[z.getMonth()]}function Z(z){return a[+(z.getHours()>=12)]}function ee(z){return 1+~~(z.getMonth()/3)}function ce(z){return s[z.getUTCDay()]}function de(z){return i[z.getUTCDay()]}function Te(z){return c[z.getUTCMonth()]}function Ie(z){return o[z.getUTCMonth()]}function Ne(z){return a[+(z.getUTCHours()>=12)]}function W(z){return 1+~~(z.getUTCMonth()/3)}return{format:function(z){var G=N(z+="",k);return G.toString=function(){return z},G},parse:function(z){var G=C(z+="",!1);return G.toString=function(){return z},G},utcFormat:function(z){var G=N(z+="",E);return G.toString=function(){return z},G},utcParse:function(z){var G=C(z+="",!0);return G.toString=function(){return z},G}}}var v3={"-":"",_:" ",0:"0"},pn=/^\s*\d+/,bee=/^%/,_ee=/[\\^$*+?|[\]().{}]/g;function Jt(e,t,r){var n=e<0?"-":"",a=(n?-e:e)+"",i=a.length;return n+(i<r?new Array(r-i+1).join(t)+a:a)}function See(e){return e.replace(_ee,"\\$&")}function su(e){return new RegExp("^(?:"+e.map(See).join("|")+")","i")}function ou(e){return new Map(e.map((t,r)=>[t.toLowerCase(),r]))}function kee(e,t,r){var n=pn.exec(t.slice(r,r+1));return n?(e.w=+n[0],r+n[0].length):-1}function Eee(e,t,r){var n=pn.exec(t.slice(r,r+1));return n?(e.u=+n[0],r+n[0].length):-1}function Tee(e,t,r){var n=pn.exec(t.slice(r,r+2));return n?(e.U=+n[0],r+n[0].length):-1}function Aee(e,t,r){var n=pn.exec(t.slice(r,r+2));return n?(e.V=+n[0],r+n[0].length):-1}function Cee(e,t,r){var n=pn.exec(t.slice(r,r+2));return n?(e.W=+n[0],r+n[0].length):-1}function g3(e,t,r){var n=pn.exec(t.slice(r,r+4));return n?(e.y=+n[0],r+n[0].length):-1}function x3(e,t,r){var n=pn.exec(t.slice(r,r+2));return n?(e.y=+n[0]+(+n[0]>68?1900:2e3),r+n[0].length):-1}function Oee(e,t,r){var n=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(t.slice(r,r+6));return n?(e.Z=n[1]?0:-(n[2]+(n[3]||"00")),r+n[0].length):-1}function Nee(e,t,r){var n=pn.exec(t.slice(r,r+1));return n?(e.q=n[0]*3-3,r+n[0].length):-1}function Pee(e,t,r){var n=pn.exec(t.slice(r,r+2));return n?(e.m=n[0]-1,r+n[0].length):-1}function y3(e,t,r){var n=pn.exec(t.slice(r,r+2));return n?(e.d=+n[0],r+n[0].length):-1}function Iee(e,t,r){var n=pn.exec(t.slice(r,r+3));return n?(e.m=0,e.d=+n[0],r+n[0].length):-1}function w3(e,t,r){var n=pn.exec(t.slice(r,r+2));return n?(e.H=+n[0],r+n[0].length):-1}function Fee(e,t,r){var n=pn.exec(t.slice(r,r+2));return n?(e.M=+n[0],r+n[0].length):-1}function Dee(e,t,r){var n=pn.exec(t.slice(r,r+2));return n?(e.S=+n[0],r+n[0].length):-1}function jee(e,t,r){var n=pn.exec(t.slice(r,r+3));return n?(e.L=+n[0],r+n[0].length):-1}function Ree(e,t,r){var n=pn.exec(t.slice(r,r+6));return n?(e.L=Math.floor(n[0]/1e3),r+n[0].length):-1}function Mee(e,t,r){var n=bee.exec(t.slice(r,r+1));return n?r+n[0].length:-1}function Lee(e,t,r){var n=pn.exec(t.slice(r));return n?(e.Q=+n[0],r+n[0].length):-1}function Bee(e,t,r){var n=pn.exec(t.slice(r));return n?(e.s=+n[0],r+n[0].length):-1}function b3(e,t){return Jt(e.getDate(),t,2)}function $ee(e,t){return Jt(e.getHours(),t,2)}function Uee(e,t){return Jt(e.getHours()%12||12,t,2)}function zee(e,t){return Jt(1+a0.count(ls(e),e),t,3)}function X8(e,t){return Jt(e.getMilliseconds(),t,3)}function Wee(e,t){return X8(e,t)+"000"}function Hee(e,t){return Jt(e.getMonth()+1,t,2)}function qee(e,t){return Jt(e.getMinutes(),t,2)}function Vee(e,t){return Jt(e.getSeconds(),t,2)}function Xee(e){var t=e.getDay();return t===0?7:t}function Gee(e,t){return Jt(Np.count(ls(e)-1,e),t,2)}function G8(e){var t=e.getDay();return t>=4||t===0?Jl(e):Jl.ceil(e)}function Kee(e,t){return e=G8(e),Jt(Jl.count(ls(e),e)+(ls(e).getDay()===4),t,2)}function Yee(e){return e.getDay()}function Zee(e,t){return Jt(Oh.count(ls(e)-1,e),t,2)}function Qee(e,t){return Jt(e.getFullYear()%100,t,2)}function Jee(e,t){return e=G8(e),Jt(e.getFullYear()%100,t,2)}function ete(e,t){return Jt(e.getFullYear()%1e4,t,4)}function tte(e,t){var r=e.getDay();return e=r>=4||r===0?Jl(e):Jl.ceil(e),Jt(e.getFullYear()%1e4,t,4)}function rte(e){var t=e.getTimezoneOffset();return(t>0?"-":(t*=-1,"+"))+Jt(t/60|0,"0",2)+Jt(t%60,"0",2)}function _3(e,t){return Jt(e.getUTCDate(),t,2)}function nte(e,t){return Jt(e.getUTCHours(),t,2)}function ate(e,t){return Jt(e.getUTCHours()%12||12,t,2)}function ite(e,t){return Jt(1+Op.count(cs(e),e),t,3)}function K8(e,t){return Jt(e.getUTCMilliseconds(),t,3)}function ste(e,t){return K8(e,t)+"000"}function ote(e,t){return Jt(e.getUTCMonth()+1,t,2)}function lte(e,t){return Jt(e.getUTCMinutes(),t,2)}function cte(e,t){return Jt(e.getUTCSeconds(),t,2)}function ute(e){var t=e.getUTCDay();return t===0?7:t}function fte(e,t){return Jt(Pp.count(cs(e)-1,e),t,2)}function Y8(e){var t=e.getUTCDay();return t>=4||t===0?ec(e):ec.ceil(e)}function dte(e,t){return e=Y8(e),Jt(ec.count(cs(e),e)+(cs(e).getUTCDay()===4),t,2)}function hte(e){return e.getUTCDay()}function pte(e,t){return Jt(Nh.count(cs(e)-1,e),t,2)}function mte(e,t){return Jt(e.getUTCFullYear()%100,t,2)}function vte(e,t){return e=Y8(e),Jt(e.getUTCFullYear()%100,t,2)}function gte(e,t){return Jt(e.getUTCFullYear()%1e4,t,4)}function xte(e,t){var r=e.getUTCDay();return e=r>=4||r===0?ec(e):ec.ceil(e),Jt(e.getUTCFullYear()%1e4,t,4)}function yte(){return"+0000"}function S3(){return"%"}function k3(e){return+e}function E3(e){return Math.floor(+e/1e3)}var El,Z8,Q8;wte({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});function wte(e){return El=wee(e),Z8=El.format,El.parse,Q8=El.utcFormat,El.utcParse,El}function bte(e){return new Date(e)}function _te(e){return e instanceof Date?+e:+new Date(+e)}function A_(e,t,r,n,a,i,s,o,c,u){var d=h_(),h=d.invert,p=d.domain,v=u(".%L"),x=u(":%S"),w=u("%I:%M"),y=u("%I %p"),_=u("%a %d"),S=u("%b %d"),k=u("%B"),E=u("%Y");function T(N){return(c(N)<N?v:o(N)<N?x:s(N)<N?w:i(N)<N?y:n(N)<N?a(N)<N?_:S:r(N)<N?k:E)(N)}return d.invert=function(N){return new Date(h(N))},d.domain=function(N){return arguments.length?p(Array.from(N,_te)):p().map(bte)},d.ticks=function(N){var C=p();return e(C[0],C[C.length-1],N??10)},d.tickFormat=function(N,C){return C==null?T:u(C)},d.nice=function(N){var C=p();return(!N||typeof N.range!="function")&&(N=t(C[0],C[C.length-1],N??10)),N?p(L8(C,N)):d},d.copy=function(){return n0(d,A_(e,t,r,n,a,i,s,o,c,u))},d}function Ste(){return Ga.apply(A_(xee,yee,ls,E_,Np,a0,S_,b_,Ao,Z8).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)}function kte(){return Ga.apply(A_(vee,gee,cs,T_,Pp,Op,k_,__,Ao,Q8).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)}function Ip(){var e=0,t=1,r,n,a,i,s=Hn,o=!1,c;function u(h){return h==null||isNaN(h=+h)?c:s(a===0?.5:(h=(i(h)-r)*a,o?Math.max(0,Math.min(1,h)):h))}u.domain=function(h){return arguments.length?([e,t]=h,r=i(e=+e),n=i(t=+t),a=r===n?0:1/(n-r),u):[e,t]},u.clamp=function(h){return arguments.length?(o=!!h,u):o},u.interpolator=function(h){return arguments.length?(s=h,u):s};function d(h){return function(p){var v,x;return arguments.length?([v,x]=p,s=h(v,x),u):[s(0),s(1)]}}return u.range=d(xc),u.rangeRound=d(d_),u.unknown=function(h){return arguments.length?(c=h,u):c},function(h){return i=h,r=h(e),n=h(t),a=r===n?0:1/(n-r),u}}function eo(e,t){return t.domain(e.domain()).interpolator(e.interpolator()).clamp(e.clamp()).unknown(e.unknown())}function J8(){var e=Js(Ip()(Hn));return e.copy=function(){return eo(e,J8())},ps.apply(e,arguments)}function eF(){var e=v_(Ip()).domain([1,10]);return e.copy=function(){return eo(e,eF()).base(e.base())},ps.apply(e,arguments)}function tF(){var e=g_(Ip());return e.copy=function(){return eo(e,tF()).constant(e.constant())},ps.apply(e,arguments)}function C_(){var e=x_(Ip());return e.copy=function(){return eo(e,C_()).exponent(e.exponent())},ps.apply(e,arguments)}function Ete(){return C_.apply(null,arguments).exponent(.5)}function rF(){var e=[],t=Hn;function r(n){if(n!=null&&!isNaN(n=+n))return t((t0(e,n,1)-1)/(e.length-1))}return r.domain=function(n){if(!arguments.length)return e.slice();e=[];for(let a of n)a!=null&&!isNaN(a=+a)&&e.push(a);return e.sort(Ws),r},r.interpolator=function(n){return arguments.length?(t=n,r):t},r.range=function(){return e.map((n,a)=>t(a/(e.length-1)))},r.quantiles=function(n){return Array.from({length:n+1},(a,i)=>fJ(e,i/n))},r.copy=function(){return rF(t).domain(e)},ps.apply(r,arguments)}function Fp(){var e=0,t=.5,r=1,n=1,a,i,s,o,c,u=Hn,d,h=!1,p;function v(w){return isNaN(w=+w)?p:(w=.5+((w=+d(w))-i)*(n*w<n*i?o:c),u(h?Math.max(0,Math.min(1,w)):w))}v.domain=function(w){return arguments.length?([e,t,r]=w,a=d(e=+e),i=d(t=+t),s=d(r=+r),o=a===i?0:.5/(i-a),c=i===s?0:.5/(s-i),n=i<a?-1:1,v):[e,t,r]},v.clamp=function(w){return arguments.length?(h=!!w,v):h},v.interpolator=function(w){return arguments.length?(u=w,v):u};function x(w){return function(y){var _,S,k;return arguments.length?([_,S,k]=y,u=MJ(w,[_,S,k]),v):[u(0),u(.5),u(1)]}}return v.range=x(xc),v.rangeRound=x(d_),v.unknown=function(w){return arguments.length?(p=w,v):p},function(w){return d=w,a=w(e),i=w(t),s=w(r),o=a===i?0:.5/(i-a),c=i===s?0:.5/(s-i),n=i<a?-1:1,v}}function nF(){var e=Js(Fp()(Hn));return e.copy=function(){return eo(e,nF())},ps.apply(e,arguments)}function aF(){var e=v_(Fp()).domain([.1,1,10]);return e.copy=function(){return eo(e,aF()).base(e.base())},ps.apply(e,arguments)}function iF(){var e=g_(Fp());return e.copy=function(){return eo(e,iF()).constant(e.constant())},ps.apply(e,arguments)}function O_(){var e=x_(Fp());return e.copy=function(){return eo(e,O_()).exponent(e.exponent())},ps.apply(e,arguments)}function Tte(){return O_.apply(null,arguments).exponent(.5)}const T3=Object.freeze(Object.defineProperty({__proto__:null,scaleBand:uf,scaleDiverging:nF,scaleDivergingLog:aF,scaleDivergingPow:O_,scaleDivergingSqrt:Tte,scaleDivergingSymlog:iF,scaleIdentity:M8,scaleImplicit:iw,scaleLinear:Ah,scaleLog:B8,scaleOrdinal:c_,scalePoint:Pu,scalePow:y_,scaleQuantile:z8,scaleQuantize:W8,scaleRadial:U8,scaleSequential:J8,scaleSequentialLog:eF,scaleSequentialPow:C_,scaleSequentialQuantile:rF,scaleSequentialSqrt:Ete,scaleSequentialSymlog:tF,scaleSqrt:see,scaleSymlog:$8,scaleThreshold:H8,scaleTime:Ste,scaleUtc:kte,tickFormat:R8},Symbol.toStringTag,{value:"Module"}));var my,A3;function Dp(){if(A3)return my;A3=1;var e=mc();function t(r,n,a){for(var i=-1,s=r.length;++i<s;){var o=r[i],c=n(o);if(c!=null&&(u===void 0?c===c&&!e(c):a(c,u)))var u=c,d=o}return d}return my=t,my}var vy,C3;function sF(){if(C3)return vy;C3=1;function e(t,r){return t>r}return vy=e,vy}var gy,O3;function Ate(){if(O3)return gy;O3=1;var e=Dp(),t=sF(),r=gc();function n(a){return a&&a.length?e(a,r,t):void 0}return gy=n,gy}var Cte=Ate();const jp=rr(Cte);var xy,N3;function oF(){if(N3)return xy;N3=1;function e(t,r){return t<r}return xy=e,xy}var yy,P3;function Ote(){if(P3)return yy;P3=1;var e=Dp(),t=oF(),r=gc();function n(a){return a&&a.length?e(a,r,t):void 0}return yy=n,yy}var Nte=Ote();const Rp=rr(Nte);var wy,I3;function Pte(){if(I3)return wy;I3=1;var e=Hb(),t=ji(),r=m8(),n=ra();function a(i,s){var o=n(i)?e:r;return o(i,t(s,3))}return wy=a,wy}var by,F3;function Ite(){if(F3)return by;F3=1;var e=h8(),t=Pte();function r(n,a){return e(t(n,a),1)}return by=r,by}var Fte=Ite();const Dte=rr(Fte);var _y,D3;function jte(){if(D3)return _y;D3=1;var e=n_();function t(r,n){return e(r,n)}return _y=t,_y}var Rte=jte();const N_=rr(Rte);var yc=1e9,Mte={precision:20,rounding:4,toExpNeg:-7,toExpPos:21,LN10:"2.302585092994045684017991454684364207601101488628772976033327900967572609677352480235997205089598298341967784042286"},I_,Er=!0,qa="[DecimalError] ",Ro=qa+"Invalid argument: ",P_=qa+"Exponent out of range: ",wc=Math.floor,_o=Math.pow,Lte=/^(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i,ua,cn=1e7,br=7,lF=9007199254740991,Ph=wc(lF/br),ut={};ut.absoluteValue=ut.abs=function(){var e=new this.constructor(this);return e.s&&(e.s=1),e};ut.comparedTo=ut.cmp=function(e){var t,r,n,a,i=this;if(e=new i.constructor(e),i.s!==e.s)return i.s||-e.s;if(i.e!==e.e)return i.e>e.e^i.s<0?1:-1;for(n=i.d.length,a=e.d.length,t=0,r=n<a?n:a;t<r;++t)if(i.d[t]!==e.d[t])return i.d[t]>e.d[t]^i.s<0?1:-1;return n===a?0:n>a^i.s<0?1:-1};ut.decimalPlaces=ut.dp=function(){var e=this,t=e.d.length-1,r=(t-e.e)*br;if(t=e.d[t],t)for(;t%10==0;t/=10)r--;return r<0?0:r};ut.dividedBy=ut.div=function(e){return as(this,new this.constructor(e))};ut.dividedToIntegerBy=ut.idiv=function(e){var t=this,r=t.constructor;return pr(as(t,new r(e),0,1),r.precision)};ut.equals=ut.eq=function(e){return!this.cmp(e)};ut.exponent=function(){return qr(this)};ut.greaterThan=ut.gt=function(e){return this.cmp(e)>0};ut.greaterThanOrEqualTo=ut.gte=function(e){return this.cmp(e)>=0};ut.isInteger=ut.isint=function(){return this.e>this.d.length-2};ut.isNegative=ut.isneg=function(){return this.s<0};ut.isPositive=ut.ispos=function(){return this.s>0};ut.isZero=function(){return this.s===0};ut.lessThan=ut.lt=function(e){return this.cmp(e)<0};ut.lessThanOrEqualTo=ut.lte=function(e){return this.cmp(e)<1};ut.logarithm=ut.log=function(e){var t,r=this,n=r.constructor,a=n.precision,i=a+5;if(e===void 0)e=new n(10);else if(e=new n(e),e.s<1||e.eq(ua))throw Error(qa+"NaN");if(r.s<1)throw Error(qa+(r.s?"NaN":"-Infinity"));return r.eq(ua)?new n(0):(Er=!1,t=as(mf(r,i),mf(e,i),i),Er=!0,pr(t,a))};ut.minus=ut.sub=function(e){var t=this;return e=new t.constructor(e),t.s==e.s?fF(t,e):cF(t,(e.s=-e.s,e))};ut.modulo=ut.mod=function(e){var t,r=this,n=r.constructor,a=n.precision;if(e=new n(e),!e.s)throw Error(qa+"NaN");return r.s?(Er=!1,t=as(r,e,0,1).times(e),Er=!0,r.minus(t)):pr(new n(r),a)};ut.naturalExponential=ut.exp=function(){return uF(this)};ut.naturalLogarithm=ut.ln=function(){return mf(this)};ut.negated=ut.neg=function(){var e=new this.constructor(this);return e.s=-e.s||0,e};ut.plus=ut.add=function(e){var t=this;return e=new t.constructor(e),t.s==e.s?cF(t,e):fF(t,(e.s=-e.s,e))};ut.precision=ut.sd=function(e){var t,r,n,a=this;if(e!==void 0&&e!==!!e&&e!==1&&e!==0)throw Error(Ro+e);if(t=qr(a)+1,n=a.d.length-1,r=n*br+1,n=a.d[n],n){for(;n%10==0;n/=10)r--;for(n=a.d[0];n>=10;n/=10)r++}return e&&t>r?t:r};ut.squareRoot=ut.sqrt=function(){var e,t,r,n,a,i,s,o=this,c=o.constructor;if(o.s<1){if(!o.s)return new c(0);throw Error(qa+"NaN")}for(e=qr(o),Er=!1,a=Math.sqrt(+o),a==0||a==1/0?(t=Ei(o.d),(t.length+e)%2==0&&(t+="0"),a=Math.sqrt(t),e=wc((e+1)/2)-(e<0||e%2),a==1/0?t="5e"+e:(t=a.toExponential(),t=t.slice(0,t.indexOf("e")+1)+e),n=new c(t)):n=new c(a.toString()),r=c.precision,a=s=r+3;;)if(i=n,n=i.plus(as(o,i,s+2)).times(.5),Ei(i.d).slice(0,s)===(t=Ei(n.d)).slice(0,s)){if(t=t.slice(s-3,s+1),a==s&&t=="4999"){if(pr(i,r+1,0),i.times(i).eq(o)){n=i;break}}else if(t!="9999")break;s+=4}return Er=!0,pr(n,r)};ut.times=ut.mul=function(e){var t,r,n,a,i,s,o,c,u,d=this,h=d.constructor,p=d.d,v=(e=new h(e)).d;if(!d.s||!e.s)return new h(0);for(e.s*=d.s,r=d.e+e.e,c=p.length,u=v.length,c<u&&(i=p,p=v,v=i,s=c,c=u,u=s),i=[],s=c+u,n=s;n--;)i.push(0);for(n=u;--n>=0;){for(t=0,a=c+n;a>n;)o=i[a]+v[n]*p[a-n-1]+t,i[a--]=o%cn|0,t=o/cn|0;i[a]=(i[a]+t)%cn|0}for(;!i[--s];)i.pop();return t?++r:i.shift(),e.d=i,e.e=r,Er?pr(e,h.precision):e};ut.toDecimalPlaces=ut.todp=function(e,t){var r=this,n=r.constructor;return r=new n(r),e===void 0?r:(Ii(e,0,yc),t===void 0?t=n.rounding:Ii(t,0,8),pr(r,e+qr(r)+1,t))};ut.toExponential=function(e,t){var r,n=this,a=n.constructor;return e===void 0?r=Ho(n,!0):(Ii(e,0,yc),t===void 0?t=a.rounding:Ii(t,0,8),n=pr(new a(n),e+1,t),r=Ho(n,!0,e+1)),r};ut.toFixed=function(e,t){var r,n,a=this,i=a.constructor;return e===void 0?Ho(a):(Ii(e,0,yc),t===void 0?t=i.rounding:Ii(t,0,8),n=pr(new i(a),e+qr(a)+1,t),r=Ho(n.abs(),!1,e+qr(n)+1),a.isneg()&&!a.isZero()?"-"+r:r)};ut.toInteger=ut.toint=function(){var e=this,t=e.constructor;return pr(new t(e),qr(e)+1,t.rounding)};ut.toNumber=function(){return+this};ut.toPower=ut.pow=function(e){var t,r,n,a,i,s,o=this,c=o.constructor,u=12,d=+(e=new c(e));if(!e.s)return new c(ua);if(o=new c(o),!o.s){if(e.s<1)throw Error(qa+"Infinity");return o}if(o.eq(ua))return o;if(n=c.precision,e.eq(ua))return pr(o,n);if(t=e.e,r=e.d.length-1,s=t>=r,i=o.s,s){if((r=d<0?-d:d)<=lF){for(a=new c(ua),t=Math.ceil(n/br+4),Er=!1;r%2&&(a=a.times(o),R3(a.d,t)),r=wc(r/2),r!==0;)o=o.times(o),R3(o.d,t);return Er=!0,e.s<0?new c(ua).div(a):pr(a,n)}}else if(i<0)throw Error(qa+"NaN");return i=i<0&&e.d[Math.max(t,r)]&1?-1:1,o.s=1,Er=!1,a=e.times(mf(o,n+u)),Er=!0,a=uF(a),a.s=i,a};ut.toPrecision=function(e,t){var r,n,a=this,i=a.constructor;return e===void 0?(r=qr(a),n=Ho(a,r<=i.toExpNeg||r>=i.toExpPos)):(Ii(e,1,yc),t===void 0?t=i.rounding:Ii(t,0,8),a=pr(new i(a),e,t),r=qr(a),n=Ho(a,e<=r||r<=i.toExpNeg,e)),n};ut.toSignificantDigits=ut.tosd=function(e,t){var r=this,n=r.constructor;return e===void 0?(e=n.precision,t=n.rounding):(Ii(e,1,yc),t===void 0?t=n.rounding:Ii(t,0,8)),pr(new n(r),e,t)};ut.toString=ut.valueOf=ut.val=ut.toJSON=ut[Symbol.for("nodejs.util.inspect.custom")]=function(){var e=this,t=qr(e),r=e.constructor;return Ho(e,t<=r.toExpNeg||t>=r.toExpPos)};function cF(e,t){var r,n,a,i,s,o,c,u,d=e.constructor,h=d.precision;if(!e.s||!t.s)return t.s||(t=new d(e)),Er?pr(t,h):t;if(c=e.d,u=t.d,s=e.e,a=t.e,c=c.slice(),i=s-a,i){for(i<0?(n=c,i=-i,o=u.length):(n=u,a=s,o=c.length),s=Math.ceil(h/br),o=s>o?s+1:o+1,i>o&&(i=o,n.length=1),n.reverse();i--;)n.push(0);n.reverse()}for(o=c.length,i=u.length,o-i<0&&(i=o,n=u,u=c,c=n),r=0;i;)r=(c[--i]=c[i]+u[i]+r)/cn|0,c[i]%=cn;for(r&&(c.unshift(r),++a),o=c.length;c[--o]==0;)c.pop();return t.d=c,t.e=a,Er?pr(t,h):t}function Ii(e,t,r){if(e!==~~e||e<t||e>r)throw Error(Ro+e)}function Ei(e){var t,r,n,a=e.length-1,i="",s=e[0];if(a>0){for(i+=s,t=1;t<a;t++)n=e[t]+"",r=br-n.length,r&&(i+=Us(r)),i+=n;s=e[t],n=s+"",r=br-n.length,r&&(i+=Us(r))}else if(s===0)return"0";for(;s%10===0;)s/=10;return i+s}var as=(function(){function e(n,a){var i,s=0,o=n.length;for(n=n.slice();o--;)i=n[o]*a+s,n[o]=i%cn|0,s=i/cn|0;return s&&n.unshift(s),n}function t(n,a,i,s){var o,c;if(i!=s)c=i>s?1:-1;else for(o=c=0;o<i;o++)if(n[o]!=a[o]){c=n[o]>a[o]?1:-1;break}return c}function r(n,a,i){for(var s=0;i--;)n[i]-=s,s=n[i]<a[i]?1:0,n[i]=s*cn+n[i]-a[i];for(;!n[0]&&n.length>1;)n.shift()}return function(n,a,i,s){var o,c,u,d,h,p,v,x,w,y,_,S,k,E,T,N,C,P,j=n.constructor,R=n.s==a.s?1:-1,I=n.d,F=a.d;if(!n.s)return new j(n);if(!a.s)throw Error(qa+"Division by zero");for(c=n.e-a.e,C=F.length,T=I.length,v=new j(R),x=v.d=[],u=0;F[u]==(I[u]||0);)++u;if(F[u]>(I[u]||0)&&--c,i==null?S=i=j.precision:s?S=i+(qr(n)-qr(a))+1:S=i,S<0)return new j(0);if(S=S/br+2|0,u=0,C==1)for(d=0,F=F[0],S++;(u<T||d)&&S--;u++)k=d*cn+(I[u]||0),x[u]=k/F|0,d=k%F|0;else{for(d=cn/(F[0]+1)|0,d>1&&(F=e(F,d),I=e(I,d),C=F.length,T=I.length),E=C,w=I.slice(0,C),y=w.length;y<C;)w[y++]=0;P=F.slice(),P.unshift(0),N=F[0],F[1]>=cn/2&&++N;do d=0,o=t(F,w,C,y),o<0?(_=w[0],C!=y&&(_=_*cn+(w[1]||0)),d=_/N|0,d>1?(d>=cn&&(d=cn-1),h=e(F,d),p=h.length,y=w.length,o=t(h,w,p,y),o==1&&(d--,r(h,C<p?P:F,p))):(d==0&&(o=d=1),h=F.slice()),p=h.length,p<y&&h.unshift(0),r(w,h,y),o==-1&&(y=w.length,o=t(F,w,C,y),o<1&&(d++,r(w,C<y?P:F,y))),y=w.length):o===0&&(d++,w=[0]),x[u++]=d,o&&w[0]?w[y++]=I[E]||0:(w=[I[E]],y=1);while((E++<T||w[0]!==void 0)&&S--)}return x[0]||x.shift(),v.e=c,pr(v,s?i+qr(v)+1:i)}})();function uF(e,t){var r,n,a,i,s,o,c=0,u=0,d=e.constructor,h=d.precision;if(qr(e)>16)throw Error(P_+qr(e));if(!e.s)return new d(ua);for(Er=!1,o=h,s=new d(.03125);e.abs().gte(.1);)e=e.times(s),u+=5;for(n=Math.log(_o(2,u))/Math.LN10*2+5|0,o+=n,r=a=i=new d(ua),d.precision=o;;){if(a=pr(a.times(e),o),r=r.times(++c),s=i.plus(as(a,r,o)),Ei(s.d).slice(0,o)===Ei(i.d).slice(0,o)){for(;u--;)i=pr(i.times(i),o);return d.precision=h,t==null?(Er=!0,pr(i,h)):i}i=s}}function qr(e){for(var t=e.e*br,r=e.d[0];r>=10;r/=10)t++;return t}function Sy(e,t,r){if(t>e.LN10.sd())throw Er=!0,r&&(e.precision=r),Error(qa+"LN10 precision limit exceeded");return pr(new e(e.LN10),t)}function Us(e){for(var t="";e--;)t+="0";return t}function mf(e,t){var r,n,a,i,s,o,c,u,d,h=1,p=10,v=e,x=v.d,w=v.constructor,y=w.precision;if(v.s<1)throw Error(qa+(v.s?"NaN":"-Infinity"));if(v.eq(ua))return new w(0);if(t==null?(Er=!1,u=y):u=t,v.eq(10))return t==null&&(Er=!0),Sy(w,u);if(u+=p,w.precision=u,r=Ei(x),n=r.charAt(0),i=qr(v),Math.abs(i)<15e14){for(;n<7&&n!=1||n==1&&r.charAt(1)>3;)v=v.times(e),r=Ei(v.d),n=r.charAt(0),h++;i=qr(v),n>1?(v=new w("0."+r),i++):v=new w(n+"."+r.slice(1))}else return c=Sy(w,u+2,y).times(i+""),v=mf(new w(n+"."+r.slice(1)),u-p).plus(c),w.precision=y,t==null?(Er=!0,pr(v,y)):v;for(o=s=v=as(v.minus(ua),v.plus(ua),u),d=pr(v.times(v),u),a=3;;){if(s=pr(s.times(d),u),c=o.plus(as(s,new w(a),u)),Ei(c.d).slice(0,u)===Ei(o.d).slice(0,u))return o=o.times(2),i!==0&&(o=o.plus(Sy(w,u+2,y).times(i+""))),o=as(o,new w(h),u),w.precision=y,t==null?(Er=!0,pr(o,y)):o;o=c,a+=2}}function j3(e,t){var r,n,a;for((r=t.indexOf("."))>-1&&(t=t.replace(".","")),(n=t.search(/e/i))>0?(r<0&&(r=n),r+=+t.slice(n+1),t=t.substring(0,n)):r<0&&(r=t.length),n=0;t.charCodeAt(n)===48;)++n;for(a=t.length;t.charCodeAt(a-1)===48;)--a;if(t=t.slice(n,a),t){if(a-=n,r=r-n-1,e.e=wc(r/br),e.d=[],n=(r+1)%br,r<0&&(n+=br),n<a){for(n&&e.d.push(+t.slice(0,n)),a-=br;n<a;)e.d.push(+t.slice(n,n+=br));t=t.slice(n),n=br-t.length}else n-=a;for(;n--;)t+="0";if(e.d.push(+t),Er&&(e.e>Ph||e.e<-Ph))throw Error(P_+r)}else e.s=0,e.e=0,e.d=[0];return e}function pr(e,t,r){var n,a,i,s,o,c,u,d,h=e.d;for(s=1,i=h[0];i>=10;i/=10)s++;if(n=t-s,n<0)n+=br,a=t,u=h[d=0];else{if(d=Math.ceil((n+1)/br),i=h.length,d>=i)return e;for(u=i=h[d],s=1;i>=10;i/=10)s++;n%=br,a=n-br+s}if(r!==void 0&&(i=_o(10,s-a-1),o=u/i%10|0,c=t<0||h[d+1]!==void 0||u%i,c=r<4?(o||c)&&(r==0||r==(e.s<0?3:2)):o>5||o==5&&(r==4||c||r==6&&(n>0?a>0?u/_o(10,s-a):0:h[d-1])%10&1||r==(e.s<0?8:7))),t<1||!h[0])return c?(i=qr(e),h.length=1,t=t-i-1,h[0]=_o(10,(br-t%br)%br),e.e=wc(-t/br)||0):(h.length=1,h[0]=e.e=e.s=0),e;if(n==0?(h.length=d,i=1,d--):(h.length=d+1,i=_o(10,br-n),h[d]=a>0?(u/_o(10,s-a)%_o(10,a)|0)*i:0),c)for(;;)if(d==0){(h[0]+=i)==cn&&(h[0]=1,++e.e);break}else{if(h[d]+=i,h[d]!=cn)break;h[d--]=0,i=1}for(n=h.length;h[--n]===0;)h.pop();if(Er&&(e.e>Ph||e.e<-Ph))throw Error(P_+qr(e));return e}function fF(e,t){var r,n,a,i,s,o,c,u,d,h,p=e.constructor,v=p.precision;if(!e.s||!t.s)return t.s?t.s=-t.s:t=new p(e),Er?pr(t,v):t;if(c=e.d,h=t.d,n=t.e,u=e.e,c=c.slice(),s=u-n,s){for(d=s<0,d?(r=c,s=-s,o=h.length):(r=h,n=u,o=c.length),a=Math.max(Math.ceil(v/br),o)+2,s>a&&(s=a,r.length=1),r.reverse(),a=s;a--;)r.push(0);r.reverse()}else{for(a=c.length,o=h.length,d=a<o,d&&(o=a),a=0;a<o;a++)if(c[a]!=h[a]){d=c[a]<h[a];break}s=0}for(d&&(r=c,c=h,h=r,t.s=-t.s),o=c.length,a=h.length-o;a>0;--a)c[o++]=0;for(a=h.length;a>s;){if(c[--a]<h[a]){for(i=a;i&&c[--i]===0;)c[i]=cn-1;--c[i],c[a]+=cn}c[a]-=h[a]}for(;c[--o]===0;)c.pop();for(;c[0]===0;c.shift())--n;return c[0]?(t.d=c,t.e=n,Er?pr(t,v):t):new p(0)}function Ho(e,t,r){var n,a=qr(e),i=Ei(e.d),s=i.length;return t?(r&&(n=r-s)>0?i=i.charAt(0)+"."+i.slice(1)+Us(n):s>1&&(i=i.charAt(0)+"."+i.slice(1)),i=i+(a<0?"e":"e+")+a):a<0?(i="0."+Us(-a-1)+i,r&&(n=r-s)>0&&(i+=Us(n))):a>=s?(i+=Us(a+1-s),r&&(n=r-a-1)>0&&(i=i+"."+Us(n))):((n=a+1)<s&&(i=i.slice(0,n)+"."+i.slice(n)),r&&(n=r-s)>0&&(a+1===s&&(i+="."),i+=Us(n))),e.s<0?"-"+i:i}function R3(e,t){if(e.length>t)return e.length=t,!0}function dF(e){var t,r,n;function a(i){var s=this;if(!(s instanceof a))return new a(i);if(s.constructor=a,i instanceof a){s.s=i.s,s.e=i.e,s.d=(i=i.d)?i.slice():i;return}if(typeof i=="number"){if(i*0!==0)throw Error(Ro+i);if(i>0)s.s=1;else if(i<0)i=-i,s.s=-1;else{s.s=0,s.e=0,s.d=[0];return}if(i===~~i&&i<1e7){s.e=0,s.d=[i];return}return j3(s,i.toString())}else if(typeof i!="string")throw Error(Ro+i);if(i.charCodeAt(0)===45?(i=i.slice(1),s.s=-1):s.s=1,Lte.test(i))j3(s,i);else throw Error(Ro+i)}if(a.prototype=ut,a.ROUND_UP=0,a.ROUND_DOWN=1,a.ROUND_CEIL=2,a.ROUND_FLOOR=3,a.ROUND_HALF_UP=4,a.ROUND_HALF_DOWN=5,a.ROUND_HALF_EVEN=6,a.ROUND_HALF_CEIL=7,a.ROUND_HALF_FLOOR=8,a.clone=dF,a.config=a.set=Bte,e===void 0&&(e={}),e)for(n=["precision","rounding","toExpNeg","toExpPos","LN10"],t=0;t<n.length;)e.hasOwnProperty(r=n[t++])||(e[r]=this[r]);return a.config(e),a}function Bte(e){if(!e||typeof e!="object")throw Error(qa+"Object expected");var t,r,n,a=["precision",1,yc,"rounding",0,8,"toExpNeg",-1/0,0,"toExpPos",0,1/0];for(t=0;t<a.length;t+=3)if((n=e[r=a[t]])!==void 0)if(wc(n)===n&&n>=a[t+1]&&n<=a[t+2])this[r]=n;else throw Error(Ro+r+": "+n);if((n=e[r="LN10"])!==void 0)if(n==Math.LN10)this[r]=new this(n);else throw Error(Ro+r+": "+n);return this}var I_=dF(Mte);ua=new I_(1);const fr=I_;function $te(e){return Hte(e)||Wte(e)||zte(e)||Ute()}function Ute(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function zte(e,t){if(e){if(typeof e=="string")return cw(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return cw(e,t)}}function Wte(e){if(typeof Symbol<"u"&&Symbol.iterator in Object(e))return Array.from(e)}function Hte(e){if(Array.isArray(e))return cw(e)}function cw(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var qte=function(t){return t},hF={},pF=function(t){return t===hF},M3=function(t){return function r(){return arguments.length===0||arguments.length===1&&pF(arguments.length<=0?void 0:arguments[0])?r:t.apply(void 0,arguments)}},Vte=function e(t,r){return t===1?r:M3(function(){for(var n=arguments.length,a=new Array(n),i=0;i<n;i++)a[i]=arguments[i];var s=a.filter(function(o){return o!==hF}).length;return s>=t?r.apply(void 0,a):e(t-s,M3(function(){for(var o=arguments.length,c=new Array(o),u=0;u<o;u++)c[u]=arguments[u];var d=a.map(function(h){return pF(h)?c.shift():h});return r.apply(void 0,$te(d).concat(c))}))})},Mp=function(t){return Vte(t.length,t)},uw=function(t,r){for(var n=[],a=t;a<r;++a)n[a-t]=a;return n},Xte=Mp(function(e,t){return Array.isArray(t)?t.map(e):Object.keys(t).map(function(r){return t[r]}).map(e)}),Gte=function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];if(!r.length)return qte;var a=r.reverse(),i=a[0],s=a.slice(1);return function(){return s.reduce(function(o,c){return c(o)},i.apply(void 0,arguments))}},fw=function(t){return Array.isArray(t)?t.reverse():t.split("").reverse.join("")},mF=function(t){var r=null,n=null;return function(){for(var a=arguments.length,i=new Array(a),s=0;s<a;s++)i[s]=arguments[s];return r&&i.every(function(o,c){return o===r[c]})||(r=i,n=t.apply(void 0,i)),n}};function Kte(e){var t;return e===0?t=1:t=Math.floor(new fr(e).abs().log(10).toNumber())+1,t}function Yte(e,t,r){for(var n=new fr(e),a=0,i=[];n.lt(t)&&a<1e5;)i.push(n.toNumber()),n=n.add(r),a++;return i}var Zte=Mp(function(e,t,r){var n=+e,a=+t;return n+r*(a-n)}),Qte=Mp(function(e,t,r){var n=t-+e;return n=n||1/0,(r-e)/n}),Jte=Mp(function(e,t,r){var n=t-+e;return n=n||1/0,Math.max(0,Math.min(1,(r-e)/n))});const Lp={rangeStep:Yte,getDigitCount:Kte,interpolateNumber:Zte,uninterpolateNumber:Qte,uninterpolateTruncation:Jte};function dw(e){return rre(e)||tre(e)||vF(e)||ere()}function ere(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function tre(e){if(typeof Symbol<"u"&&Symbol.iterator in Object(e))return Array.from(e)}function rre(e){if(Array.isArray(e))return hw(e)}function vf(e,t){return ire(e)||are(e,t)||vF(e,t)||nre()}function nre(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function vF(e,t){if(e){if(typeof e=="string")return hw(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return hw(e,t)}}function hw(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function are(e,t){if(!(typeof Symbol>"u"||!(Symbol.iterator in Object(e)))){var r=[],n=!0,a=!1,i=void 0;try{for(var s=e[Symbol.iterator](),o;!(n=(o=s.next()).done)&&(r.push(o.value),!(t&&r.length===t));n=!0);}catch(c){a=!0,i=c}finally{try{!n&&s.return!=null&&s.return()}finally{if(a)throw i}}return r}}function ire(e){if(Array.isArray(e))return e}function gF(e){var t=vf(e,2),r=t[0],n=t[1],a=r,i=n;return r>n&&(a=n,i=r),[a,i]}function xF(e,t,r){if(e.lte(0))return new fr(0);var n=Lp.getDigitCount(e.toNumber()),a=new fr(10).pow(n),i=e.div(a),s=n!==1?.05:.1,o=new fr(Math.ceil(i.div(s).toNumber())).add(r).mul(s),c=o.mul(a);return t?c:new fr(Math.ceil(c))}function sre(e,t,r){var n=1,a=new fr(e);if(!a.isint()&&r){var i=Math.abs(e);i<1?(n=new fr(10).pow(Lp.getDigitCount(e)-1),a=new fr(Math.floor(a.div(n).toNumber())).mul(n)):i>1&&(a=new fr(Math.floor(e)))}else e===0?a=new fr(Math.floor((t-1)/2)):r||(a=new fr(Math.floor(e)));var s=Math.floor((t-1)/2),o=Gte(Xte(function(c){return a.add(new fr(c-s).mul(n)).toNumber()}),uw);return o(0,t)}function yF(e,t,r,n){var a=arguments.length>4&&arguments[4]!==void 0?arguments[4]:0;if(!Number.isFinite((t-e)/(r-1)))return{step:new fr(0),tickMin:new fr(0),tickMax:new fr(0)};var i=xF(new fr(t).sub(e).div(r-1),n,a),s;e<=0&&t>=0?s=new fr(0):(s=new fr(e).add(t).div(2),s=s.sub(new fr(s).mod(i)));var o=Math.ceil(s.sub(e).div(i).toNumber()),c=Math.ceil(new fr(t).sub(s).div(i).toNumber()),u=o+c+1;return u>r?yF(e,t,r,n,a+1):(u<r&&(c=t>0?c+(r-u):c,o=t>0?o:o+(r-u)),{step:i,tickMin:s.sub(new fr(o).mul(i)),tickMax:s.add(new fr(c).mul(i))})}function ore(e){var t=vf(e,2),r=t[0],n=t[1],a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:6,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,s=Math.max(a,2),o=gF([r,n]),c=vf(o,2),u=c[0],d=c[1];if(u===-1/0||d===1/0){var h=d===1/0?[u].concat(dw(uw(0,a-1).map(function(){return 1/0}))):[].concat(dw(uw(0,a-1).map(function(){return-1/0})),[d]);return r>n?fw(h):h}if(u===d)return sre(u,a,i);var p=yF(u,d,s,i),v=p.step,x=p.tickMin,w=p.tickMax,y=Lp.rangeStep(x,w.add(new fr(.1).mul(v)),v);return r>n?fw(y):y}function lre(e,t){var r=vf(e,2),n=r[0],a=r[1],i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,s=gF([n,a]),o=vf(s,2),c=o[0],u=o[1];if(c===-1/0||u===1/0)return[n,a];if(c===u)return[c];var d=Math.max(t,2),h=xF(new fr(u).sub(c).div(d-1),i,0),p=[].concat(dw(Lp.rangeStep(new fr(c),new fr(u).sub(new fr(.99).mul(h)),h)),[u]);return n>a?fw(p):p}var cre=mF(ore),ure=mF(lre),fre="Invariant failed";function tc(e,t){throw new Error(fre)}var dre=["offset","layout","width","dataKey","data","dataPointFormatter","xAxis","yAxis"];function Ih(){return Ih=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Ih.apply(this,arguments)}function hre(e,t){return gre(e)||vre(e,t)||mre(e,t)||pre()}function pre(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function mre(e,t){if(e){if(typeof e=="string")return L3(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return L3(e,t)}}function L3(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function vre(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,a,i,s,o=[],c=!0,u=!1;try{if(i=(r=r.call(e)).next,t!==0)for(;!(c=(n=i.call(r)).done)&&(o.push(n.value),o.length!==t);c=!0);}catch(d){u=!0,a=d}finally{try{if(!c&&r.return!=null&&(s=r.return(),Object(s)!==s))return}finally{if(u)throw a}}return o}}function gre(e){if(Array.isArray(e))return e}function xre(e,t){if(e==null)return{};var r=yre(e,t),n,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function yre(e,t){if(e==null)return{};var r={},n=Object.keys(e),a,i;for(i=0;i<n.length;i++)a=n[i],!(t.indexOf(a)>=0)&&(r[a]=e[a]);return r}function F_(e){var t=e.offset,r=e.layout,n=e.width,a=e.dataKey,i=e.data,s=e.dataPointFormatter,o=e.xAxis,c=e.yAxis,u=xre(e,dre),d=Mt(u,!1);e.direction==="x"&&o.type!=="number"&&tc();var h=i.map(function(p){var v=s(p,a),x=v.x,w=v.y,y=v.value,_=v.errorVal;if(!_)return null;var S=[],k,E;if(Array.isArray(_)){var T=hre(_,2);k=T[0],E=T[1]}else k=E=_;if(r==="vertical"){var N=o.scale,C=w+t,P=C+n,j=C-n,R=N(y-k),I=N(y+E);S.push({x1:I,y1:P,x2:I,y2:j}),S.push({x1:R,y1:C,x2:I,y2:C}),S.push({x1:R,y1:P,x2:R,y2:j})}else if(r==="horizontal"){var F=c.scale,L=x+t,H=L-n,V=L+n,J=F(y-k),te=F(y+E);S.push({x1:H,y1:te,x2:V,y2:te}),S.push({x1:L,y1:J,x2:L,y2:te}),S.push({x1:H,y1:J,x2:V,y2:J})}return me.createElement(Fr,Ih({className:"recharts-errorBar",key:"bar-".concat(S.map(function(q){return"".concat(q.x1,"-").concat(q.x2,"-").concat(q.y1,"-").concat(q.y2)}))},d),S.map(function(q){return me.createElement("line",Ih({},q,{key:"line-".concat(q.x1,"-").concat(q.x2,"-").concat(q.y1,"-").concat(q.y2)}))}))});return me.createElement(Fr,{className:"recharts-errorBars"},h)}F_.defaultProps={stroke:"black",strokeWidth:1.5,width:5,offset:0,layout:"horizontal"};F_.displayName="ErrorBar";function gf(e){"@babel/helpers - typeof";return gf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},gf(e)}function B3(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function ky(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?B3(Object(r),!0).forEach(function(n){wre(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):B3(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function wre(e,t,r){return t=bre(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function bre(e){var t=_re(e,"string");return gf(t)=="symbol"?t:String(t)}function _re(e,t){if(gf(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(gf(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var wF=function(t){var r=t.children,n=t.formattedGraphicalItems,a=t.legendWidth,i=t.legendContent,s=Ma(r,nf);if(!s)return null;var o;return s.props&&s.props.payload?o=s.props&&s.props.payload:i==="children"?o=(n||[]).reduce(function(c,u){var d=u.item,h=u.props,p=h.sectors||h.data||[];return c.concat(p.map(function(v){return{type:s.props.iconType||d.props.legendType,value:v.name,color:v.fill,payload:v}}))},[]):o=(n||[]).map(function(c){var u=c.item,d=u.props,h=d.dataKey,p=d.name,v=d.legendType,x=d.hide;return{inactive:x,dataKey:h,type:s.props.iconType||v||"square",color:D_(u),value:p||h,payload:u.props}}),ky(ky(ky({},s.props),nf.getWithHeight(s,a)),{},{payload:o,item:s})};function xf(e){"@babel/helpers - typeof";return xf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},xf(e)}function $3(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function La(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?$3(Object(r),!0).forEach(function(n){Ul(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):$3(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Ul(e,t,r){return t=Sre(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Sre(e){var t=kre(e,"string");return xf(t)=="symbol"?t:String(t)}function kre(e,t){if(xf(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(xf(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function U3(e){return Cre(e)||Are(e)||Tre(e)||Ere()}function Ere(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Tre(e,t){if(e){if(typeof e=="string")return pw(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return pw(e,t)}}function Are(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function Cre(e){if(Array.isArray(e))return pw(e)}function pw(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function fa(e,t,r){return Vt(e)||Vt(t)?r:en(t)?ui(e,t,r):$t(t)?t(e):r}function Iu(e,t,r,n){var a=Dte(e,function(o){return fa(o,t)});if(r==="number"){var i=a.filter(function(o){return ot(o)||parseFloat(o)});return i.length?[Rp(i),jp(i)]:[1/0,-1/0]}var s=n?a.filter(function(o){return!Vt(o)}):a;return s.map(function(o){return en(o)||o instanceof Date?o:""})}var Ore=function(t){var r,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],a=arguments.length>2?arguments[2]:void 0,i=arguments.length>3?arguments[3]:void 0,s=-1,o=(r=n==null?void 0:n.length)!==null&&r!==void 0?r:0;if(o<=1)return 0;if(i&&i.axisType==="angleAxis"&&Math.abs(Math.abs(i.range[1]-i.range[0])-360)<=1e-6)for(var c=i.range,u=0;u<o;u++){var d=u>0?a[u-1].coordinate:a[o-1].coordinate,h=a[u].coordinate,p=u>=o-1?a[0].coordinate:a[u+1].coordinate,v=void 0;if(za(h-d)!==za(p-h)){var x=[];if(za(p-h)===za(c[1]-c[0])){v=p;var w=h+c[1]-c[0];x[0]=Math.min(w,(w+d)/2),x[1]=Math.max(w,(w+d)/2)}else{v=d;var y=p+c[1]-c[0];x[0]=Math.min(h,(y+h)/2),x[1]=Math.max(h,(y+h)/2)}var _=[Math.min(h,(v+h)/2),Math.max(h,(v+h)/2)];if(t>_[0]&&t<=_[1]||t>=x[0]&&t<=x[1]){s=a[u].index;break}}else{var S=Math.min(d,p),k=Math.max(d,p);if(t>(S+h)/2&&t<=(k+h)/2){s=a[u].index;break}}}else for(var E=0;E<o;E++)if(E===0&&t<=(n[E].coordinate+n[E+1].coordinate)/2||E>0&&E<o-1&&t>(n[E].coordinate+n[E-1].coordinate)/2&&t<=(n[E].coordinate+n[E+1].coordinate)/2||E===o-1&&t>(n[E].coordinate+n[E-1].coordinate)/2){s=n[E].index;break}return s},D_=function(t){var r=t,n=r.type.displayName,a=t.props,i=a.stroke,s=a.fill,o;switch(n){case"Line":o=i;break;case"Area":case"Radar":o=i&&i!=="none"?i:s;break;default:o=s;break}return o},Nre=function(t){var r=t.barSize,n=t.totalSize,a=t.stackGroups,i=a===void 0?{}:a;if(!i)return{};for(var s={},o=Object.keys(i),c=0,u=o.length;c<u;c++)for(var d=i[o[c]].stackGroups,h=Object.keys(d),p=0,v=h.length;p<v;p++){var x=d[h[p]],w=x.items,y=x.cateAxisId,_=w.filter(function(T){return rs(T.type).indexOf("Bar")>=0});if(_&&_.length){var S=_[0].props.barSize,k=_[0].props[y];s[k]||(s[k]=[]);var E=Vt(S)?r:S;s[k].push({item:_[0],stackList:_.slice(1),barSize:Vt(E)?void 0:Jn(E,n,0)})}}return s},Pre=function(t){var r=t.barGap,n=t.barCategoryGap,a=t.bandSize,i=t.sizeList,s=i===void 0?[]:i,o=t.maxBarSize,c=s.length;if(c<1)return null;var u=Jn(r,a,0,!0),d,h=[];if(s[0].barSize===+s[0].barSize){var p=!1,v=a/c,x=s.reduce(function(E,T){return E+T.barSize||0},0);x+=(c-1)*u,x>=a&&(x-=(c-1)*u,u=0),x>=a&&v>0&&(p=!0,v*=.9,x=c*v);var w=(a-x)/2>>0,y={offset:w-u,size:0};d=s.reduce(function(E,T){var N={item:T.item,position:{offset:y.offset+y.size+u,size:p?v:T.barSize}},C=[].concat(U3(E),[N]);return y=C[C.length-1].position,T.stackList&&T.stackList.length&&T.stackList.forEach(function(P){C.push({item:P,position:y})}),C},h)}else{var _=Jn(n,a,0,!0);a-2*_-(c-1)*u<=0&&(u=0);var S=(a-2*_-(c-1)*u)/c;S>1&&(S>>=0);var k=o===+o?Math.min(S,o):S;d=s.reduce(function(E,T,N){var C=[].concat(U3(E),[{item:T.item,position:{offset:_+(S+u)*N+(S-k)/2,size:k}}]);return T.stackList&&T.stackList.length&&T.stackList.forEach(function(P){C.push({item:P,position:C[C.length-1].position})}),C},h)}return d},Ire=function(t,r,n,a){var i=n.children,s=n.width,o=n.margin,c=s-(o.left||0)-(o.right||0),u=wF({children:i,legendWidth:c});if(u){var d=a||{},h=d.width,p=d.height,v=u.align,x=u.verticalAlign,w=u.layout;if((w==="vertical"||w==="horizontal"&&x==="middle")&&v!=="center"&&ot(t[v]))return La(La({},t),{},Ul({},v,t[v]+(h||0)));if((w==="horizontal"||w==="vertical"&&v==="center")&&x!=="middle"&&ot(t[x]))return La(La({},t),{},Ul({},x,t[x]+(p||0)))}return t},Fre=function(t,r,n){return Vt(r)?!0:t==="horizontal"?r==="yAxis":t==="vertical"||n==="x"?r==="xAxis":n==="y"?r==="yAxis":!0},bF=function(t,r,n,a,i){var s=r.props.children,o=Ai(s,F_).filter(function(u){return Fre(a,i,u.props.direction)});if(o&&o.length){var c=o.map(function(u){return u.props.dataKey});return t.reduce(function(u,d){var h=fa(d,n);if(Vt(h))return u;var p=Array.isArray(h)?[Rp(h),jp(h)]:[h,h],v=c.reduce(function(x,w){var y=fa(d,w,0),_=p[0]-Math.abs(Array.isArray(y)?y[0]:y),S=p[1]+Math.abs(Array.isArray(y)?y[1]:y);return[Math.min(_,x[0]),Math.max(S,x[1])]},[1/0,-1/0]);return[Math.min(v[0],u[0]),Math.max(v[1],u[1])]},[1/0,-1/0])}return null},Dre=function(t,r,n,a,i){var s=r.map(function(o){return bF(t,o,n,i,a)}).filter(function(o){return!Vt(o)});return s&&s.length?s.reduce(function(o,c){return[Math.min(o[0],c[0]),Math.max(o[1],c[1])]},[1/0,-1/0]):null},_F=function(t,r,n,a,i){var s=r.map(function(c){var u=c.props.dataKey;return n==="number"&&u&&bF(t,c,u,a)||Iu(t,u,n,i)});if(n==="number")return s.reduce(function(c,u){return[Math.min(c[0],u[0]),Math.max(c[1],u[1])]},[1/0,-1/0]);var o={};return s.reduce(function(c,u){for(var d=0,h=u.length;d<h;d++)o[u[d]]||(o[u[d]]=!0,c.push(u[d]));return c},[])},SF=function(t,r){return t==="horizontal"&&r==="xAxis"||t==="vertical"&&r==="yAxis"||t==="centric"&&r==="angleAxis"||t==="radial"&&r==="radiusAxis"},vu=function(t,r,n){if(!t)return null;var a=t.scale,i=t.duplicateDomain,s=t.type,o=t.range,c=t.realScaleType==="scaleBand"?a.bandwidth()/2:2,u=(r||n)&&s==="category"&&a.bandwidth?a.bandwidth()/c:0;if(u=t.axisType==="angleAxis"&&(o==null?void 0:o.length)>=2?za(o[0]-o[1])*2*u:u,r&&(t.ticks||t.niceTicks)){var d=(t.ticks||t.niceTicks).map(function(h){var p=i?i.indexOf(h):h;return{coordinate:a(p)+u,value:h,offset:u}});return d.filter(function(h){return!Jf(h.coordinate)})}return t.isCategorical&&t.categoricalDomain?t.categoricalDomain.map(function(h,p){return{coordinate:a(h)+u,value:h,index:p,offset:u}}):a.ticks&&!n?a.ticks(t.tickCount).map(function(h){return{coordinate:a(h)+u,value:h,offset:u}}):a.domain().map(function(h,p){return{coordinate:a(h)+u,value:i?i[h]:h,index:p,offset:u}})},Ey=new WeakMap,jd=function(t,r){if(typeof r!="function")return t;Ey.has(t)||Ey.set(t,new WeakMap);var n=Ey.get(t);if(n.has(r))return n.get(r);var a=function(){t.apply(void 0,arguments),r.apply(void 0,arguments)};return n.set(r,a),a},jre=function(t,r,n){var a=t.scale,i=t.type,s=t.layout,o=t.axisType;if(a==="auto")return s==="radial"&&o==="radiusAxis"?{scale:uf(),realScaleType:"band"}:s==="radial"&&o==="angleAxis"?{scale:Ah(),realScaleType:"linear"}:i==="category"&&r&&(r.indexOf("LineChart")>=0||r.indexOf("AreaChart")>=0||r.indexOf("ComposedChart")>=0)?{scale:Pu(),realScaleType:"point"}:i==="category"?{scale:uf(),realScaleType:"band"}:{scale:Ah(),realScaleType:"linear"};if(Qf(a)){var c="scale".concat(wp(a));return{scale:(T3[c]||Pu)(),realScaleType:T3[c]?c:"point"}}return $t(a)?{scale:a}:{scale:Pu(),realScaleType:"point"}},z3=1e-4,Rre=function(t){var r=t.domain();if(!(!r||r.length<=2)){var n=r.length,a=t.range(),i=Math.min(a[0],a[1])-z3,s=Math.max(a[0],a[1])+z3,o=t(r[0]),c=t(r[n-1]);(o<i||o>s||c<i||c>s)&&t.domain([r[0],r[n-1]])}},Mre=function(t){var r=t.length;if(!(r<=0))for(var n=0,a=t[0].length;n<a;++n)for(var i=0,s=0,o=0;o<r;++o){var c=Jf(t[o][n][1])?t[o][n][0]:t[o][n][1];c>=0?(t[o][n][0]=i,t[o][n][1]=i+c,i=t[o][n][1]):(t[o][n][0]=s,t[o][n][1]=s+c,s=t[o][n][1])}},Lre=function(t){var r=t.length;if(!(r<=0))for(var n=0,a=t[0].length;n<a;++n)for(var i=0,s=0;s<r;++s){var o=Jf(t[s][n][1])?t[s][n][0]:t[s][n][1];o>=0?(t[s][n][0]=i,t[s][n][1]=i+o,i=t[s][n][1]):(t[s][n][0]=0,t[s][n][1]=0)}},Bre={sign:Mre,expand:jK,none:Vl,silhouette:RK,wiggle:MK,positive:Lre},$re=function(t,r,n){var a=r.map(function(o){return o.props.dataKey}),i=Bre[n],s=DK().keys(a).value(function(o,c){return+fa(o,c,0)}).order(H2).offset(i);return s(t)},Ure=function(t,r,n,a,i,s){if(!t)return null;var o=s?r.reverse():r,c={},u=o.reduce(function(h,p){var v=p.props,x=v.stackId,w=v.hide;if(w)return h;var y=p.props[n],_=h[y]||{hasStack:!1,stackGroups:{}};if(en(x)){var S=_.stackGroups[x]||{numericAxisId:n,cateAxisId:a,items:[]};S.items.push(p),_.hasStack=!0,_.stackGroups[x]=S}else _.stackGroups[xp("_stackId_")]={numericAxisId:n,cateAxisId:a,items:[p]};return La(La({},h),{},Ul({},y,_))},c),d={};return Object.keys(u).reduce(function(h,p){var v=u[p];if(v.hasStack){var x={};v.stackGroups=Object.keys(v.stackGroups).reduce(function(w,y){var _=v.stackGroups[y];return La(La({},w),{},Ul({},y,{numericAxisId:n,cateAxisId:a,items:_.items,stackedData:$re(t,_.items,i)}))},x)}return La(La({},h),{},Ul({},p,v))},d)},zre=function(t,r){var n=r.realScaleType,a=r.type,i=r.tickCount,s=r.originalDomain,o=r.allowDecimals,c=n||r.scale;if(c!=="auto"&&c!=="linear")return null;if(i&&a==="number"&&s&&(s[0]==="auto"||s[1]==="auto")){var u=t.domain();if(!u.length)return null;var d=cre(u,i,o);return t.domain([Rp(d),jp(d)]),{niceTicks:d}}if(i&&a==="number"){var h=t.domain(),p=ure(h,i,o);return{niceTicks:p}}return null},Wre=function(t,r){var n=t.props.stackId;if(en(n)){var a=r[n];if(a){var i=a.items.indexOf(t);return i>=0?a.stackedData[i]:null}}return null},Hre=function(t){return t.reduce(function(r,n){return[Rp(n.concat([r[0]]).filter(ot)),jp(n.concat([r[1]]).filter(ot))]},[1/0,-1/0])},kF=function(t,r,n){return Object.keys(t).reduce(function(a,i){var s=t[i],o=s.stackedData,c=o.reduce(function(u,d){var h=Hre(d.slice(r,n+1));return[Math.min(u[0],h[0]),Math.max(u[1],h[1])]},[1/0,-1/0]);return[Math.min(c[0],a[0]),Math.max(c[1],a[1])]},[1/0,-1/0]).map(function(a){return a===1/0||a===-1/0?0:a})},W3=/^dataMin[\s]*-[\s]*([0-9]+([.]{1}[0-9]+){0,1})$/,H3=/^dataMax[\s]*\+[\s]*([0-9]+([.]{1}[0-9]+){0,1})$/,mw=function(t,r,n){if($t(t))return t(r,n);if(!Array.isArray(t))return r;var a=[];if(ot(t[0]))a[0]=n?t[0]:Math.min(t[0],r[0]);else if(W3.test(t[0])){var i=+W3.exec(t[0])[1];a[0]=r[0]-i}else $t(t[0])?a[0]=t[0](r[0]):a[0]=r[0];if(ot(t[1]))a[1]=n?t[1]:Math.max(t[1],r[1]);else if(H3.test(t[1])){var s=+H3.exec(t[1])[1];a[1]=r[1]+s}else $t(t[1])?a[1]=t[1](r[1]):a[1]=r[1];return a},vw=function(t,r,n){if(t&&t.scale&&t.scale.bandwidth){var a=t.scale.bandwidth();if(!n||a>0)return a}if(t&&r&&r.length>=2){for(var i=i_(r,function(h){return h.coordinate}),s=1/0,o=1,c=i.length;o<c;o++){var u=i[o],d=i[o-1];s=Math.min((u.coordinate||0)-(d.coordinate||0),s)}return s===1/0?0:s}return n?void 0:0},q3=function(t,r,n){return!t||!t.length||N_(t,ui(n,"type.defaultProps.domain"))?r:t},qre=function(t,r){var n=t.props,a=n.dataKey,i=n.name,s=n.unit,o=n.formatter,c=n.tooltipType,u=n.chartType,d=n.hide;return La(La({},Mt(t,!1)),{},{dataKey:a,unit:s,formatter:o,name:i||a,color:D_(t),value:fa(r,a),type:c,payload:r,chartType:u,hide:d})};function yf(e){"@babel/helpers - typeof";return yf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},yf(e)}function V3(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Vi(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?V3(Object(r),!0).forEach(function(n){EF(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):V3(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function EF(e,t,r){return t=Vre(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Vre(e){var t=Xre(e,"string");return yf(t)=="symbol"?t:String(t)}function Xre(e,t){if(yf(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(yf(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Gre(e,t){return Qre(e)||Zre(e,t)||Yre(e,t)||Kre()}function Kre(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Yre(e,t){if(e){if(typeof e=="string")return X3(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return X3(e,t)}}function X3(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Zre(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,a,i,s,o=[],c=!0,u=!1;try{if(i=(r=r.call(e)).next,t!==0)for(;!(c=(n=i.call(r)).done)&&(o.push(n.value),o.length!==t);c=!0);}catch(d){u=!0,a=d}finally{try{if(!c&&r.return!=null&&(s=r.return(),Object(s)!==s))return}finally{if(u)throw a}}return o}}function Qre(e){if(Array.isArray(e))return e}var Fh=Math.PI/180,Jre=function(t){return t*180/Math.PI},xr=function(t,r,n,a){return{x:t+Math.cos(-Fh*a)*n,y:r+Math.sin(-Fh*a)*n}},TF=function(t,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{top:0,right:0,bottom:0,left:0};return Math.min(Math.abs(t-(n.left||0)-(n.right||0)),Math.abs(r-(n.top||0)-(n.bottom||0)))/2},ene=function(t,r,n,a,i){var s=t.width,o=t.height,c=t.startAngle,u=t.endAngle,d=Jn(t.cx,s,s/2),h=Jn(t.cy,o,o/2),p=TF(s,o,n),v=Jn(t.innerRadius,p,0),x=Jn(t.outerRadius,p,p*.8),w=Object.keys(r);return w.reduce(function(y,_){var S=r[_],k=S.domain,E=S.reversed,T;if(Vt(S.range))a==="angleAxis"?T=[c,u]:a==="radiusAxis"&&(T=[v,x]),E&&(T=[T[1],T[0]]);else{T=S.range;var N=T,C=Gre(N,2);c=C[0],u=C[1]}var P=jre(S,i),j=P.realScaleType,R=P.scale;R.domain(k).range(T),Rre(R);var I=zre(R,Vi(Vi({},S),{},{realScaleType:j})),F=Vi(Vi(Vi({},S),I),{},{range:T,radius:x,realScaleType:j,scale:R,cx:d,cy:h,innerRadius:v,outerRadius:x,startAngle:c,endAngle:u});return Vi(Vi({},y),{},EF({},_,F))},{})},tne=function(t,r){var n=t.x,a=t.y,i=r.x,s=r.y;return Math.sqrt(Math.pow(n-i,2)+Math.pow(a-s,2))},rne=function(t,r){var n=t.x,a=t.y,i=r.cx,s=r.cy,o=tne({x:n,y:a},{x:i,y:s});if(o<=0)return{radius:o};var c=(n-i)/o,u=Math.acos(c);return a>s&&(u=2*Math.PI-u),{radius:o,angle:Jre(u),angleInRadian:u}},nne=function(t){var r=t.startAngle,n=t.endAngle,a=Math.floor(r/360),i=Math.floor(n/360),s=Math.min(a,i);return{startAngle:r-s*360,endAngle:n-s*360}},ane=function(t,r){var n=r.startAngle,a=r.endAngle,i=Math.floor(n/360),s=Math.floor(a/360),o=Math.min(i,s);return t+o*360},G3=function(t,r){var n=t.x,a=t.y,i=rne({x:n,y:a},r),s=i.radius,o=i.angle,c=r.innerRadius,u=r.outerRadius;if(s<c||s>u)return!1;if(s===0)return!0;var d=nne(r),h=d.startAngle,p=d.endAngle,v=o,x;if(h<=p){for(;v>p;)v-=360;for(;v<h;)v+=360;x=v>=h&&v<=p}else{for(;v>h;)v-=360;for(;v<p;)v+=360;x=v>=p&&v<=h}return x?Vi(Vi({},r),{},{radius:s,angle:ane(v,r)}):null},AF=function(t){return!D.isValidElement(t)&&!$t(t)&&typeof t!="boolean"?t.className:""};function wf(e){"@babel/helpers - typeof";return wf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},wf(e)}var ine=["offset"];function sne(e){return une(e)||cne(e)||lne(e)||one()}function one(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function lne(e,t){if(e){if(typeof e=="string")return gw(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return gw(e,t)}}function cne(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function une(e){if(Array.isArray(e))return gw(e)}function gw(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function fne(e,t){if(e==null)return{};var r=dne(e,t),n,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function dne(e,t){if(e==null)return{};var r={},n=Object.keys(e),a,i;for(i=0;i<n.length;i++)a=n[i],!(t.indexOf(a)>=0)&&(r[a]=e[a]);return r}function K3(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Kr(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?K3(Object(r),!0).forEach(function(n){hne(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):K3(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function hne(e,t,r){return t=pne(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function pne(e){var t=mne(e,"string");return wf(t)=="symbol"?t:String(t)}function mne(e,t){if(wf(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(wf(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function bf(){return bf=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},bf.apply(this,arguments)}var vne=function(t){var r=t.value,n=t.formatter,a=Vt(t.children)?r:t.children;return $t(n)?n(a):a},gne=function(t,r){var n=za(r-t),a=Math.min(Math.abs(r-t),360);return n*a},xne=function(t,r,n){var a=t.position,i=t.viewBox,s=t.offset,o=t.className,c=i,u=c.cx,d=c.cy,h=c.innerRadius,p=c.outerRadius,v=c.startAngle,x=c.endAngle,w=c.clockWise,y=(h+p)/2,_=gne(v,x),S=_>=0?1:-1,k,E;a==="insideStart"?(k=v+S*s,E=w):a==="insideEnd"?(k=x-S*s,E=!w):a==="end"&&(k=x+S*s,E=w),E=_<=0?E:!E;var T=xr(u,d,y,k),N=xr(u,d,y,k+(E?1:-1)*359),C="M".concat(T.x,",").concat(T.y,`
    A`).concat(y,",").concat(y,",0,1,").concat(E?0:1,`,
    `).concat(N.x,",").concat(N.y),P=Vt(t.id)?xp("recharts-radial-line-"):t.id;return me.createElement("text",bf({},n,{dominantBaseline:"central",className:Qt("recharts-radial-bar-label",o)}),me.createElement("defs",null,me.createElement("path",{id:P,d:C})),me.createElement("textPath",{xlinkHref:"#".concat(P)},r))},yne=function(t){var r=t.viewBox,n=t.offset,a=t.position,i=r,s=i.cx,o=i.cy,c=i.innerRadius,u=i.outerRadius,d=i.startAngle,h=i.endAngle,p=(d+h)/2;if(a==="outside"){var v=xr(s,o,u+n,p),x=v.x,w=v.y;return{x,y:w,textAnchor:x>=s?"start":"end",verticalAnchor:"middle"}}if(a==="center")return{x:s,y:o,textAnchor:"middle",verticalAnchor:"middle"};if(a==="centerTop")return{x:s,y:o,textAnchor:"middle",verticalAnchor:"start"};if(a==="centerBottom")return{x:s,y:o,textAnchor:"middle",verticalAnchor:"end"};var y=(c+u)/2,_=xr(s,o,y,p),S=_.x,k=_.y;return{x:S,y:k,textAnchor:"middle",verticalAnchor:"middle"}},wne=function(t){var r=t.viewBox,n=t.parentViewBox,a=t.offset,i=t.position,s=r,o=s.x,c=s.y,u=s.width,d=s.height,h=d>=0?1:-1,p=h*a,v=h>0?"end":"start",x=h>0?"start":"end",w=u>=0?1:-1,y=w*a,_=w>0?"end":"start",S=w>0?"start":"end";if(i==="top"){var k={x:o+u/2,y:c-h*a,textAnchor:"middle",verticalAnchor:v};return Kr(Kr({},k),n?{height:Math.max(c-n.y,0),width:u}:{})}if(i==="bottom"){var E={x:o+u/2,y:c+d+p,textAnchor:"middle",verticalAnchor:x};return Kr(Kr({},E),n?{height:Math.max(n.y+n.height-(c+d),0),width:u}:{})}if(i==="left"){var T={x:o-y,y:c+d/2,textAnchor:_,verticalAnchor:"middle"};return Kr(Kr({},T),n?{width:Math.max(T.x-n.x,0),height:d}:{})}if(i==="right"){var N={x:o+u+y,y:c+d/2,textAnchor:S,verticalAnchor:"middle"};return Kr(Kr({},N),n?{width:Math.max(n.x+n.width-N.x,0),height:d}:{})}var C=n?{width:u,height:d}:{};return i==="insideLeft"?Kr({x:o+y,y:c+d/2,textAnchor:S,verticalAnchor:"middle"},C):i==="insideRight"?Kr({x:o+u-y,y:c+d/2,textAnchor:_,verticalAnchor:"middle"},C):i==="insideTop"?Kr({x:o+u/2,y:c+p,textAnchor:"middle",verticalAnchor:x},C):i==="insideBottom"?Kr({x:o+u/2,y:c+d-p,textAnchor:"middle",verticalAnchor:v},C):i==="insideTopLeft"?Kr({x:o+y,y:c+p,textAnchor:S,verticalAnchor:x},C):i==="insideTopRight"?Kr({x:o+u-y,y:c+p,textAnchor:_,verticalAnchor:x},C):i==="insideBottomLeft"?Kr({x:o+y,y:c+d-p,textAnchor:S,verticalAnchor:v},C):i==="insideBottomRight"?Kr({x:o+u-y,y:c+d-p,textAnchor:_,verticalAnchor:v},C):vc(i)&&(ot(i.x)||Eo(i.x))&&(ot(i.y)||Eo(i.y))?Kr({x:o+Jn(i.x,u),y:c+Jn(i.y,d),textAnchor:"end",verticalAnchor:"end"},C):Kr({x:o+u/2,y:c+d/2,textAnchor:"middle",verticalAnchor:"middle"},C)},bne=function(t){return"cx"in t&&ot(t.cx)};function yn(e){var t=e.offset,r=t===void 0?5:t,n=fne(e,ine),a=Kr({offset:r},n),i=a.viewBox,s=a.position,o=a.value,c=a.children,u=a.content,d=a.className,h=d===void 0?"":d,p=a.textBreakAll;if(!i||Vt(o)&&Vt(c)&&!D.isValidElement(u)&&!$t(u))return null;if(D.isValidElement(u))return D.cloneElement(u,a);var v;if($t(u)){if(v=D.createElement(u,a),D.isValidElement(v))return v}else v=vne(a);var x=bne(i),w=Mt(a,!0);if(x&&(s==="insideStart"||s==="insideEnd"||s==="end"))return xne(a,v,w);var y=x?yne(a):wne(a);return me.createElement(Zl,bf({className:Qt("recharts-label",h)},w,y,{breakAll:p}),v)}yn.displayName="Label";var CF=function(t){var r=t.cx,n=t.cy,a=t.angle,i=t.startAngle,s=t.endAngle,o=t.r,c=t.radius,u=t.innerRadius,d=t.outerRadius,h=t.x,p=t.y,v=t.top,x=t.left,w=t.width,y=t.height,_=t.clockWise,S=t.labelViewBox;if(S)return S;if(ot(w)&&ot(y)){if(ot(h)&&ot(p))return{x:h,y:p,width:w,height:y};if(ot(v)&&ot(x))return{x:v,y:x,width:w,height:y}}return ot(h)&&ot(p)?{x:h,y:p,width:0,height:0}:ot(r)&&ot(n)?{cx:r,cy:n,startAngle:i||a||0,endAngle:s||a||0,innerRadius:u||0,outerRadius:d||c||o||0,clockWise:_}:t.viewBox?t.viewBox:{}},_ne=function(t,r){return t?t===!0?me.createElement(yn,{key:"label-implicit",viewBox:r}):en(t)?me.createElement(yn,{key:"label-implicit",viewBox:r,value:t}):D.isValidElement(t)?t.type===yn?D.cloneElement(t,{key:"label-implicit",viewBox:r}):me.createElement(yn,{key:"label-implicit",content:t,viewBox:r}):$t(t)?me.createElement(yn,{key:"label-implicit",content:t,viewBox:r}):vc(t)?me.createElement(yn,bf({viewBox:r},t,{key:"label-implicit"})):null:null},Sne=function(t,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;if(!t||!t.children&&n&&!t.label)return null;var a=t.children,i=CF(t),s=Ai(a,yn).map(function(c,u){return D.cloneElement(c,{viewBox:r||i,key:"label-".concat(u)})});if(!n)return s;var o=_ne(t.label,r||i);return[o].concat(sne(s))};yn.parseViewBox=CF;yn.renderCallByParent=Sne;var Ty,Y3;function kne(){if(Y3)return Ty;Y3=1;function e(t){var r=t==null?0:t.length;return r?t[r-1]:void 0}return Ty=e,Ty}var Ene=kne();const Tne=rr(Ene);function _f(e){"@babel/helpers - typeof";return _f=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_f(e)}var Ane=["valueAccessor"],Cne=["data","dataKey","clockWise","id","textBreakAll"];function One(e){return Fne(e)||Ine(e)||Pne(e)||Nne()}function Nne(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Pne(e,t){if(e){if(typeof e=="string")return xw(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return xw(e,t)}}function Ine(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function Fne(e){if(Array.isArray(e))return xw(e)}function xw(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Dh(){return Dh=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Dh.apply(this,arguments)}function Z3(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Q3(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Z3(Object(r),!0).forEach(function(n){Dne(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Z3(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Dne(e,t,r){return t=jne(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function jne(e){var t=Rne(e,"string");return _f(t)=="symbol"?t:String(t)}function Rne(e,t){if(_f(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(_f(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function J3(e,t){if(e==null)return{};var r=Mne(e,t),n,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function Mne(e,t){if(e==null)return{};var r={},n=Object.keys(e),a,i;for(i=0;i<n.length;i++)a=n[i],!(t.indexOf(a)>=0)&&(r[a]=e[a]);return r}var Lne=function(t){return Array.isArray(t.value)?Tne(t.value):t.value};function Mo(e){var t=e.valueAccessor,r=t===void 0?Lne:t,n=J3(e,Ane),a=n.data,i=n.dataKey,s=n.clockWise,o=n.id,c=n.textBreakAll,u=J3(n,Cne);return!a||!a.length?null:me.createElement(Fr,{className:"recharts-label-list"},a.map(function(d,h){var p=Vt(i)?r(d,h):fa(d&&d.payload,i),v=Vt(o)?{}:{id:"".concat(o,"-").concat(h)};return me.createElement(yn,Dh({},Mt(d,!0),u,v,{parentViewBox:d.parentViewBox,value:p,textBreakAll:c,viewBox:yn.parseViewBox(Vt(s)?d:Q3(Q3({},d),{},{clockWise:s})),key:"label-".concat(h),index:h}))}))}Mo.displayName="LabelList";function Bne(e,t){return e?e===!0?me.createElement(Mo,{key:"labelList-implicit",data:t}):me.isValidElement(e)||$t(e)?me.createElement(Mo,{key:"labelList-implicit",data:t,content:e}):vc(e)?me.createElement(Mo,Dh({data:t},e,{key:"labelList-implicit"})):null:null}function $ne(e,t){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;if(!e||!e.children&&r&&!e.label)return null;var n=e.children,a=Ai(n,Mo).map(function(s,o){return D.cloneElement(s,{data:t,key:"labelList-".concat(o)})});if(!r)return a;var i=Bne(e.label,t);return[i].concat(One(a))}Mo.renderCallByParent=$ne;function Sf(e){"@babel/helpers - typeof";return Sf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Sf(e)}function yw(){return yw=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},yw.apply(this,arguments)}function eO(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function tO(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?eO(Object(r),!0).forEach(function(n){Une(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):eO(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Une(e,t,r){return t=zne(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function zne(e){var t=Wne(e,"string");return Sf(t)=="symbol"?t:String(t)}function Wne(e,t){if(Sf(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Sf(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Hne=function(t,r){var n=za(r-t),a=Math.min(Math.abs(r-t),359.999);return n*a},Rd=function(t){var r=t.cx,n=t.cy,a=t.radius,i=t.angle,s=t.sign,o=t.isExternal,c=t.cornerRadius,u=t.cornerIsExternal,d=c*(o?1:-1)+a,h=Math.asin(c/d)/Fh,p=u?i:i+s*h,v=xr(r,n,d,p),x=xr(r,n,a,p),w=u?i-s*h:i,y=xr(r,n,d*Math.cos(h*Fh),w);return{center:v,circleTangency:x,lineTangency:y,theta:h}},OF=function(t){var r=t.cx,n=t.cy,a=t.innerRadius,i=t.outerRadius,s=t.startAngle,o=t.endAngle,c=Hne(s,o),u=s+c,d=xr(r,n,i,s),h=xr(r,n,i,u),p="M ".concat(d.x,",").concat(d.y,`
    A `).concat(i,",").concat(i,`,0,
    `).concat(+(Math.abs(c)>180),",").concat(+(s>u),`,
    `).concat(h.x,",").concat(h.y,`
  `);if(a>0){var v=xr(r,n,a,s),x=xr(r,n,a,u);p+="L ".concat(x.x,",").concat(x.y,`
            A `).concat(a,",").concat(a,`,0,
            `).concat(+(Math.abs(c)>180),",").concat(+(s<=u),`,
            `).concat(v.x,",").concat(v.y," Z")}else p+="L ".concat(r,",").concat(n," Z");return p},qne=function(t){var r=t.cx,n=t.cy,a=t.innerRadius,i=t.outerRadius,s=t.cornerRadius,o=t.forceCornerRadius,c=t.cornerIsExternal,u=t.startAngle,d=t.endAngle,h=za(d-u),p=Rd({cx:r,cy:n,radius:i,angle:u,sign:h,cornerRadius:s,cornerIsExternal:c}),v=p.circleTangency,x=p.lineTangency,w=p.theta,y=Rd({cx:r,cy:n,radius:i,angle:d,sign:-h,cornerRadius:s,cornerIsExternal:c}),_=y.circleTangency,S=y.lineTangency,k=y.theta,E=c?Math.abs(u-d):Math.abs(u-d)-w-k;if(E<0)return o?"M ".concat(x.x,",").concat(x.y,`
        a`).concat(s,",").concat(s,",0,0,1,").concat(s*2,`,0
        a`).concat(s,",").concat(s,",0,0,1,").concat(-s*2,`,0
      `):OF({cx:r,cy:n,innerRadius:a,outerRadius:i,startAngle:u,endAngle:d});var T="M ".concat(x.x,",").concat(x.y,`
    A`).concat(s,",").concat(s,",0,0,").concat(+(h<0),",").concat(v.x,",").concat(v.y,`
    A`).concat(i,",").concat(i,",0,").concat(+(E>180),",").concat(+(h<0),",").concat(_.x,",").concat(_.y,`
    A`).concat(s,",").concat(s,",0,0,").concat(+(h<0),",").concat(S.x,",").concat(S.y,`
  `);if(a>0){var N=Rd({cx:r,cy:n,radius:a,angle:u,sign:h,isExternal:!0,cornerRadius:s,cornerIsExternal:c}),C=N.circleTangency,P=N.lineTangency,j=N.theta,R=Rd({cx:r,cy:n,radius:a,angle:d,sign:-h,isExternal:!0,cornerRadius:s,cornerIsExternal:c}),I=R.circleTangency,F=R.lineTangency,L=R.theta,H=c?Math.abs(u-d):Math.abs(u-d)-j-L;if(H<0&&s===0)return"".concat(T,"L").concat(r,",").concat(n,"Z");T+="L".concat(F.x,",").concat(F.y,`
      A`).concat(s,",").concat(s,",0,0,").concat(+(h<0),",").concat(I.x,",").concat(I.y,`
      A`).concat(a,",").concat(a,",0,").concat(+(H>180),",").concat(+(h>0),",").concat(C.x,",").concat(C.y,`
      A`).concat(s,",").concat(s,",0,0,").concat(+(h<0),",").concat(P.x,",").concat(P.y,"Z")}else T+="L".concat(r,",").concat(n,"Z");return T},Vne={cx:0,cy:0,innerRadius:0,outerRadius:0,startAngle:0,endAngle:0,cornerRadius:0,forceCornerRadius:!1,cornerIsExternal:!1},j_=function(t){var r=tO(tO({},Vne),t),n=r.cx,a=r.cy,i=r.innerRadius,s=r.outerRadius,o=r.cornerRadius,c=r.forceCornerRadius,u=r.cornerIsExternal,d=r.startAngle,h=r.endAngle,p=r.className;if(s<i||d===h)return null;var v=Qt("recharts-sector",p),x=s-i,w=Jn(o,x,0,!0),y;return w>0&&Math.abs(d-h)<360?y=qne({cx:n,cy:a,innerRadius:i,outerRadius:s,cornerRadius:Math.min(w,x/2),forceCornerRadius:c,cornerIsExternal:u,startAngle:d,endAngle:h}):y=OF({cx:n,cy:a,innerRadius:i,outerRadius:s,startAngle:d,endAngle:h}),me.createElement("path",yw({},Mt(r,!0),{className:v,d:y,role:"img"}))};function kf(e){"@babel/helpers - typeof";return kf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},kf(e)}function ww(){return ww=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},ww.apply(this,arguments)}function rO(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function nO(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?rO(Object(r),!0).forEach(function(n){Xne(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):rO(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Xne(e,t,r){return t=Gne(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Gne(e){var t=Kne(e,"string");return kf(t)=="symbol"?t:String(t)}function Kne(e,t){if(kf(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(kf(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var aO={curveBasisClosed:SK,curveBasisOpen:kK,curveBasis:_K,curveBumpX:lK,curveBumpY:cK,curveLinearClosed:EK,curveLinear:_p,curveMonotoneX:TK,curveMonotoneY:AK,curveNatural:CK,curveStep:OK,curveStepAfter:PK,curveStepBefore:NK},Md=function(t){return t.x===+t.x&&t.y===+t.y},lu=function(t){return t.x},cu=function(t){return t.y},Yne=function(t,r){if($t(t))return t;var n="curve".concat(wp(t));return(n==="curveMonotone"||n==="curveBump")&&r?aO["".concat(n).concat(r==="vertical"?"Y":"X")]:aO[n]||_p},Zne=function(t){var r=t.type,n=r===void 0?"linear":r,a=t.points,i=a===void 0?[]:a,s=t.baseLine,o=t.layout,c=t.connectNulls,u=c===void 0?!1:c,d=Yne(n,o),h=u?i.filter(function(w){return Md(w)}):i,p;if(Array.isArray(s)){var v=u?s.filter(function(w){return Md(w)}):s,x=h.map(function(w,y){return nO(nO({},w),{},{base:v[y]})});return o==="vertical"?p=Cd().y(cu).x1(lu).x0(function(w){return w.base.x}):p=Cd().x(lu).y1(cu).y0(function(w){return w.base.y}),p.defined(Md).curve(d),p(x)}return o==="vertical"&&ot(s)?p=Cd().y(cu).x1(lu).x0(s):ot(s)?p=Cd().x(lu).y1(cu).y0(s):p=jI().x(lu).y(cu),p.defined(Md).curve(d),p(h)},bw=function(t){var r=t.className,n=t.points,a=t.path,i=t.pathRef;if((!n||!n.length)&&!a)return null;var s=n&&n.length?Zne(t):a;return me.createElement("path",ww({},Mt(t,!1),uh(t),{className:Qt("recharts-curve",r),d:s,ref:i}))},Ay={exports:{}},Cy,iO;function Qne(){if(iO)return Cy;iO=1;var e="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED";return Cy=e,Cy}var Oy,sO;function Jne(){if(sO)return Oy;sO=1;var e=Qne();function t(){}function r(){}return r.resetWarningCache=t,Oy=function(){function n(s,o,c,u,d,h){if(h!==e){var p=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw p.name="Invariant Violation",p}}n.isRequired=n;function a(){return n}var i={array:n,bigint:n,bool:n,func:n,number:n,object:n,string:n,symbol:n,any:n,arrayOf:a,element:n,elementType:n,instanceOf:a,node:n,objectOf:a,oneOf:a,oneOfType:a,shape:a,exact:a,checkPropTypes:r,resetWarningCache:t};return i.PropTypes=i,i},Oy}var oO;function R_(){return oO||(oO=1,Ay.exports=Jne()()),Ay.exports}var eae=R_();const ar=rr(eae);var tae=Object.getOwnPropertyNames,rae=Object.getOwnPropertySymbols,nae=Object.prototype.hasOwnProperty;function lO(e,t){return function(n,a,i){return e(n,a,i)&&t(n,a,i)}}function Ld(e){return function(r,n,a){if(!r||!n||typeof r!="object"||typeof n!="object")return e(r,n,a);var i=a.cache,s=i.get(r),o=i.get(n);if(s&&o)return s===n&&o===r;i.set(r,n),i.set(n,r);var c=e(r,n,a);return i.delete(r),i.delete(n),c}}function aae(e){return e!=null?e[Symbol.toStringTag]:void 0}function cO(e){return tae(e).concat(rae(e))}var iae=Object.hasOwn||(function(e,t){return nae.call(e,t)});function el(e,t){return e===t||!e&&!t&&e!==e&&t!==t}var sae="__v",oae="__o",lae="_owner",uO=Object.getOwnPropertyDescriptor,fO=Object.keys;function cae(e,t,r){var n=e.length;if(t.length!==n)return!1;for(;n-- >0;)if(!r.equals(e[n],t[n],n,n,e,t,r))return!1;return!0}function uae(e,t){return el(e.getTime(),t.getTime())}function fae(e,t){return e.name===t.name&&e.message===t.message&&e.cause===t.cause&&e.stack===t.stack}function dae(e,t){return e===t}function dO(e,t,r){var n=e.size;if(n!==t.size)return!1;if(!n)return!0;for(var a=new Array(n),i=e.entries(),s,o,c=0;(s=i.next())&&!s.done;){for(var u=t.entries(),d=!1,h=0;(o=u.next())&&!o.done;){if(a[h]){h++;continue}var p=s.value,v=o.value;if(r.equals(p[0],v[0],c,h,e,t,r)&&r.equals(p[1],v[1],p[0],v[0],e,t,r)){d=a[h]=!0;break}h++}if(!d)return!1;c++}return!0}var hae=el;function pae(e,t,r){var n=fO(e),a=n.length;if(fO(t).length!==a)return!1;for(;a-- >0;)if(!NF(e,t,r,n[a]))return!1;return!0}function uu(e,t,r){var n=cO(e),a=n.length;if(cO(t).length!==a)return!1;for(var i,s,o;a-- >0;)if(i=n[a],!NF(e,t,r,i)||(s=uO(e,i),o=uO(t,i),(s||o)&&(!s||!o||s.configurable!==o.configurable||s.enumerable!==o.enumerable||s.writable!==o.writable)))return!1;return!0}function mae(e,t){return el(e.valueOf(),t.valueOf())}function vae(e,t){return e.source===t.source&&e.flags===t.flags}function hO(e,t,r){var n=e.size;if(n!==t.size)return!1;if(!n)return!0;for(var a=new Array(n),i=e.values(),s,o;(s=i.next())&&!s.done;){for(var c=t.values(),u=!1,d=0;(o=c.next())&&!o.done;){if(!a[d]&&r.equals(s.value,o.value,s.value,o.value,e,t,r)){u=a[d]=!0;break}d++}if(!u)return!1}return!0}function gae(e,t){var r=e.length;if(t.length!==r)return!1;for(;r-- >0;)if(e[r]!==t[r])return!1;return!0}function xae(e,t){return e.hostname===t.hostname&&e.pathname===t.pathname&&e.protocol===t.protocol&&e.port===t.port&&e.hash===t.hash&&e.username===t.username&&e.password===t.password}function NF(e,t,r,n){return(n===lae||n===oae||n===sae)&&(e.$$typeof||t.$$typeof)?!0:iae(t,n)&&r.equals(e[n],t[n],n,n,e,t,r)}var yae="[object Arguments]",wae="[object Boolean]",bae="[object Date]",_ae="[object Error]",Sae="[object Map]",kae="[object Number]",Eae="[object Object]",Tae="[object RegExp]",Aae="[object Set]",Cae="[object String]",Oae="[object URL]",Nae=Array.isArray,pO=typeof ArrayBuffer<"u"&&typeof ArrayBuffer.isView=="function"?ArrayBuffer.isView:null,mO=Object.assign,Pae=Object.prototype.toString.call.bind(Object.prototype.toString);function Iae(e){var t=e.areArraysEqual,r=e.areDatesEqual,n=e.areErrorsEqual,a=e.areFunctionsEqual,i=e.areMapsEqual,s=e.areNumbersEqual,o=e.areObjectsEqual,c=e.arePrimitiveWrappersEqual,u=e.areRegExpsEqual,d=e.areSetsEqual,h=e.areTypedArraysEqual,p=e.areUrlsEqual,v=e.unknownTagComparators;return function(w,y,_){if(w===y)return!0;if(w==null||y==null)return!1;var S=typeof w;if(S!==typeof y)return!1;if(S!=="object")return S==="number"?s(w,y,_):S==="function"?a(w,y,_):!1;var k=w.constructor;if(k!==y.constructor)return!1;if(k===Object)return o(w,y,_);if(Nae(w))return t(w,y,_);if(pO!=null&&pO(w))return h(w,y,_);if(k===Date)return r(w,y,_);if(k===RegExp)return u(w,y,_);if(k===Map)return i(w,y,_);if(k===Set)return d(w,y,_);var E=Pae(w);if(E===bae)return r(w,y,_);if(E===Tae)return u(w,y,_);if(E===Sae)return i(w,y,_);if(E===Aae)return d(w,y,_);if(E===Eae)return typeof w.then!="function"&&typeof y.then!="function"&&o(w,y,_);if(E===Oae)return p(w,y,_);if(E===_ae)return n(w,y,_);if(E===yae)return o(w,y,_);if(E===wae||E===kae||E===Cae)return c(w,y,_);if(v){var T=v[E];if(!T){var N=aae(w);N&&(T=v[N])}if(T)return T(w,y,_)}return!1}}function Fae(e){var t=e.circular,r=e.createCustomConfig,n=e.strict,a={areArraysEqual:n?uu:cae,areDatesEqual:uae,areErrorsEqual:fae,areFunctionsEqual:dae,areMapsEqual:n?lO(dO,uu):dO,areNumbersEqual:hae,areObjectsEqual:n?uu:pae,arePrimitiveWrappersEqual:mae,areRegExpsEqual:vae,areSetsEqual:n?lO(hO,uu):hO,areTypedArraysEqual:n?uu:gae,areUrlsEqual:xae,unknownTagComparators:void 0};if(r&&(a=mO({},a,r(a))),t){var i=Ld(a.areArraysEqual),s=Ld(a.areMapsEqual),o=Ld(a.areObjectsEqual),c=Ld(a.areSetsEqual);a=mO({},a,{areArraysEqual:i,areMapsEqual:s,areObjectsEqual:o,areSetsEqual:c})}return a}function Dae(e){return function(t,r,n,a,i,s,o){return e(t,r,o)}}function jae(e){var t=e.circular,r=e.comparator,n=e.createState,a=e.equals,i=e.strict;if(n)return function(c,u){var d=n(),h=d.cache,p=h===void 0?t?new WeakMap:void 0:h,v=d.meta;return r(c,u,{cache:p,equals:a,meta:v,strict:i})};if(t)return function(c,u){return r(c,u,{cache:new WeakMap,equals:a,meta:void 0,strict:i})};var s={cache:void 0,equals:a,meta:void 0,strict:i};return function(c,u){return r(c,u,s)}}var Rae=to();to({strict:!0});to({circular:!0});to({circular:!0,strict:!0});to({createInternalComparator:function(){return el}});to({strict:!0,createInternalComparator:function(){return el}});to({circular:!0,createInternalComparator:function(){return el}});to({circular:!0,createInternalComparator:function(){return el},strict:!0});function to(e){e===void 0&&(e={});var t=e.circular,r=t===void 0?!1:t,n=e.createInternalComparator,a=e.createState,i=e.strict,s=i===void 0?!1:i,o=Fae(e),c=Iae(o),u=n?n(c):Dae(c);return jae({circular:r,comparator:c,createState:a,equals:u,strict:s})}function Mae(e){typeof requestAnimationFrame<"u"&&requestAnimationFrame(e)}function vO(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,r=-1,n=function a(i){r<0&&(r=i),i-r>t?(e(i),r=-1):Mae(a)};requestAnimationFrame(n)}function _w(e){"@babel/helpers - typeof";return _w=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_w(e)}function Lae(e){return zae(e)||Uae(e)||$ae(e)||Bae()}function Bae(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function $ae(e,t){if(e){if(typeof e=="string")return gO(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return gO(e,t)}}function gO(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Uae(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function zae(e){if(Array.isArray(e))return e}function Wae(){var e={},t=function(){return null},r=!1,n=function a(i){if(!r){if(Array.isArray(i)){if(!i.length)return;var s=i,o=Lae(s),c=o[0],u=o.slice(1);if(typeof c=="number"){vO(a.bind(null,u),c);return}a(c),vO(a.bind(null,u));return}_w(i)==="object"&&(e=i,t(e)),typeof i=="function"&&i()}};return{stop:function(){r=!0},start:function(i){r=!1,n(i)},subscribe:function(i){return t=i,function(){t=function(){return null}}}}}function Ef(e){"@babel/helpers - typeof";return Ef=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ef(e)}function xO(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function yO(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?xO(Object(r),!0).forEach(function(n){PF(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):xO(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function PF(e,t,r){return t=Hae(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Hae(e){var t=qae(e,"string");return Ef(t)==="symbol"?t:String(t)}function qae(e,t){if(Ef(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Ef(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Vae=function(t,r){return[Object.keys(t),Object.keys(r)].reduce(function(n,a){return n.filter(function(i){return a.includes(i)})})},Xae=function(t){return t},Gae=function(t){return t.replace(/([A-Z])/g,function(r){return"-".concat(r.toLowerCase())})},Fu=function(t,r){return Object.keys(r).reduce(function(n,a){return yO(yO({},n),{},PF({},a,t(a,r[a])))},{})},wO=function(t,r,n){return t.map(function(a){return"".concat(Gae(a)," ").concat(r,"ms ").concat(n)}).join(",")};function Kae(e,t){return Qae(e)||Zae(e,t)||IF(e,t)||Yae()}function Yae(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Zae(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,a,i,s,o=[],c=!0,u=!1;try{if(i=(r=r.call(e)).next,t!==0)for(;!(c=(n=i.call(r)).done)&&(o.push(n.value),o.length!==t);c=!0);}catch(d){u=!0,a=d}finally{try{if(!c&&r.return!=null&&(s=r.return(),Object(s)!==s))return}finally{if(u)throw a}}return o}}function Qae(e){if(Array.isArray(e))return e}function Jae(e){return rie(e)||tie(e)||IF(e)||eie()}function eie(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function IF(e,t){if(e){if(typeof e=="string")return Sw(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Sw(e,t)}}function tie(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function rie(e){if(Array.isArray(e))return Sw(e)}function Sw(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var jh=1e-4,FF=function(t,r){return[0,3*t,3*r-6*t,3*t-3*r+1]},DF=function(t,r){return t.map(function(n,a){return n*Math.pow(r,a)}).reduce(function(n,a){return n+a})},bO=function(t,r){return function(n){var a=FF(t,r);return DF(a,n)}},nie=function(t,r){return function(n){var a=FF(t,r),i=[].concat(Jae(a.map(function(s,o){return s*o}).slice(1)),[0]);return DF(i,n)}},_O=function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];var a=r[0],i=r[1],s=r[2],o=r[3];if(r.length===1)switch(r[0]){case"linear":a=0,i=0,s=1,o=1;break;case"ease":a=.25,i=.1,s=.25,o=1;break;case"ease-in":a=.42,i=0,s=1,o=1;break;case"ease-out":a=.42,i=0,s=.58,o=1;break;case"ease-in-out":a=0,i=0,s=.58,o=1;break;default:{var c=r[0].split("(");if(c[0]==="cubic-bezier"&&c[1].split(")")[0].split(",").length===4){var u=c[1].split(")")[0].split(",").map(function(y){return parseFloat(y)}),d=Kae(u,4);a=d[0],i=d[1],s=d[2],o=d[3]}}}var h=bO(a,s),p=bO(i,o),v=nie(a,s),x=function(_){return _>1?1:_<0?0:_},w=function(_){for(var S=_>1?1:_,k=S,E=0;E<8;++E){var T=h(k)-S,N=v(k);if(Math.abs(T-S)<jh||N<jh)return p(k);k=x(k-T/N)}return p(k)};return w.isStepper=!1,w},aie=function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},r=t.stiff,n=r===void 0?100:r,a=t.damping,i=a===void 0?8:a,s=t.dt,o=s===void 0?17:s,c=function(d,h,p){var v=-(d-h)*n,x=p*i,w=p+(v-x)*o/1e3,y=p*o/1e3+d;return Math.abs(y-h)<jh&&Math.abs(w)<jh?[h,0]:[y,w]};return c.isStepper=!0,c.dt=o,c},iie=function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];var a=r[0];if(typeof a=="string")switch(a){case"ease":case"ease-in-out":case"ease-out":case"ease-in":case"linear":return _O(a);case"spring":return aie();default:if(a.split("(")[0]==="cubic-bezier")return _O(a)}return typeof a=="function"?a:null};function Tf(e){"@babel/helpers - typeof";return Tf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Tf(e)}function SO(e){return lie(e)||oie(e)||jF(e)||sie()}function sie(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function oie(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function lie(e){if(Array.isArray(e))return Ew(e)}function kO(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function xn(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?kO(Object(r),!0).forEach(function(n){kw(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):kO(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function kw(e,t,r){return t=cie(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function cie(e){var t=uie(e,"string");return Tf(t)==="symbol"?t:String(t)}function uie(e,t){if(Tf(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Tf(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function fie(e,t){return pie(e)||hie(e,t)||jF(e,t)||die()}function die(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function jF(e,t){if(e){if(typeof e=="string")return Ew(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Ew(e,t)}}function Ew(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function hie(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,a,i,s,o=[],c=!0,u=!1;try{if(i=(r=r.call(e)).next,t!==0)for(;!(c=(n=i.call(r)).done)&&(o.push(n.value),o.length!==t);c=!0);}catch(d){u=!0,a=d}finally{try{if(!c&&r.return!=null&&(s=r.return(),Object(s)!==s))return}finally{if(u)throw a}}return o}}function pie(e){if(Array.isArray(e))return e}var Rh=function(t,r,n){return t+(r-t)*n},Tw=function(t){var r=t.from,n=t.to;return r!==n},mie=function e(t,r,n){var a=Fu(function(i,s){if(Tw(s)){var o=t(s.from,s.to,s.velocity),c=fie(o,2),u=c[0],d=c[1];return xn(xn({},s),{},{from:u,velocity:d})}return s},r);return n<1?Fu(function(i,s){return Tw(s)?xn(xn({},s),{},{velocity:Rh(s.velocity,a[i].velocity,n),from:Rh(s.from,a[i].from,n)}):s},r):e(t,a,n-1)};const vie=(function(e,t,r,n,a){var i=Vae(e,t),s=i.reduce(function(y,_){return xn(xn({},y),{},kw({},_,[e[_],t[_]]))},{}),o=i.reduce(function(y,_){return xn(xn({},y),{},kw({},_,{from:e[_],velocity:0,to:t[_]}))},{}),c=-1,u,d,h=function(){return null},p=function(){return Fu(function(_,S){return S.from},o)},v=function(){return!Object.values(o).filter(Tw).length},x=function(_){u||(u=_);var S=_-u,k=S/r.dt;o=mie(r,o,k),a(xn(xn(xn({},e),t),p())),u=_,v()||(c=requestAnimationFrame(h))},w=function(_){d||(d=_);var S=(_-d)/n,k=Fu(function(T,N){return Rh.apply(void 0,SO(N).concat([r(S)]))},s);if(a(xn(xn(xn({},e),t),k)),S<1)c=requestAnimationFrame(h);else{var E=Fu(function(T,N){return Rh.apply(void 0,SO(N).concat([r(1)]))},s);a(xn(xn(xn({},e),t),E))}};return h=r.isStepper?x:w,function(){return requestAnimationFrame(h),function(){cancelAnimationFrame(c)}}});function rc(e){"@babel/helpers - typeof";return rc=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},rc(e)}var gie=["children","begin","duration","attributeName","easing","isActive","steps","from","to","canBegin","onAnimationEnd","shouldReAnimate","onAnimationReStart"];function xie(e,t){if(e==null)return{};var r=yie(e,t),n,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function yie(e,t){if(e==null)return{};var r={},n=Object.keys(e),a,i;for(i=0;i<n.length;i++)a=n[i],!(t.indexOf(a)>=0)&&(r[a]=e[a]);return r}function Ny(e){return Sie(e)||_ie(e)||bie(e)||wie()}function wie(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function bie(e,t){if(e){if(typeof e=="string")return Aw(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Aw(e,t)}}function _ie(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function Sie(e){if(Array.isArray(e))return Aw(e)}function Aw(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function EO(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function ri(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?EO(Object(r),!0).forEach(function(n){gu(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):EO(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function gu(e,t,r){return t=RF(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function kie(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Eie(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,RF(n.key),n)}}function Tie(e,t,r){return t&&Eie(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function RF(e){var t=Aie(e,"string");return rc(t)==="symbol"?t:String(t)}function Aie(e,t){if(rc(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(rc(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Cie(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Cw(e,t)}function Cw(e,t){return Cw=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},Cw(e,t)}function Oie(e){var t=Nie();return function(){var n=Mh(e),a;if(t){var i=Mh(this).constructor;a=Reflect.construct(n,arguments,i)}else a=n.apply(this,arguments);return Ow(this,a)}}function Ow(e,t){if(t&&(rc(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Nw(e)}function Nw(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Nie(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Mh(e){return Mh=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Mh(e)}var Ks=(function(e){Cie(r,e);var t=Oie(r);function r(n,a){var i;kie(this,r),i=t.call(this,n,a);var s=i.props,o=s.isActive,c=s.attributeName,u=s.from,d=s.to,h=s.steps,p=s.children,v=s.duration;if(i.handleStyleChange=i.handleStyleChange.bind(Nw(i)),i.changeStyle=i.changeStyle.bind(Nw(i)),!o||v<=0)return i.state={style:{}},typeof p=="function"&&(i.state={style:d}),Ow(i);if(h&&h.length)i.state={style:h[0].style};else if(u){if(typeof p=="function")return i.state={style:u},Ow(i);i.state={style:c?gu({},c,u):u}}else i.state={style:{}};return i}return Tie(r,[{key:"componentDidMount",value:function(){var a=this.props,i=a.isActive,s=a.canBegin;this.mounted=!0,!(!i||!s)&&this.runAnimation(this.props)}},{key:"componentDidUpdate",value:function(a){var i=this.props,s=i.isActive,o=i.canBegin,c=i.attributeName,u=i.shouldReAnimate,d=i.to,h=i.from,p=this.state.style;if(o){if(!s){var v={style:c?gu({},c,d):d};this.state&&p&&(c&&p[c]!==d||!c&&p!==d)&&this.setState(v);return}if(!(Rae(a.to,d)&&a.canBegin&&a.isActive)){var x=!a.canBegin||!a.isActive;this.manager&&this.manager.stop(),this.stopJSAnimation&&this.stopJSAnimation();var w=x||u?h:a.to;if(this.state&&p){var y={style:c?gu({},c,w):w};(c&&p[c]!==w||!c&&p!==w)&&this.setState(y)}this.runAnimation(ri(ri({},this.props),{},{from:w,begin:0}))}}}},{key:"componentWillUnmount",value:function(){this.mounted=!1;var a=this.props.onAnimationEnd;this.unSubscribe&&this.unSubscribe(),this.manager&&(this.manager.stop(),this.manager=null),this.stopJSAnimation&&this.stopJSAnimation(),a&&a()}},{key:"handleStyleChange",value:function(a){this.changeStyle(a)}},{key:"changeStyle",value:function(a){this.mounted&&this.setState({style:a})}},{key:"runJSAnimation",value:function(a){var i=this,s=a.from,o=a.to,c=a.duration,u=a.easing,d=a.begin,h=a.onAnimationEnd,p=a.onAnimationStart,v=vie(s,o,iie(u),c,this.changeStyle),x=function(){i.stopJSAnimation=v()};this.manager.start([p,d,x,c,h])}},{key:"runStepAnimation",value:function(a){var i=this,s=a.steps,o=a.begin,c=a.onAnimationStart,u=s[0],d=u.style,h=u.duration,p=h===void 0?0:h,v=function(w,y,_){if(_===0)return w;var S=y.duration,k=y.easing,E=k===void 0?"ease":k,T=y.style,N=y.properties,C=y.onAnimationEnd,P=_>0?s[_-1]:y,j=N||Object.keys(T);if(typeof E=="function"||E==="spring")return[].concat(Ny(w),[i.runJSAnimation.bind(i,{from:P.style,to:T,duration:S,easing:E}),S]);var R=wO(j,S,E),I=ri(ri(ri({},P.style),T),{},{transition:R});return[].concat(Ny(w),[I,S,C]).filter(Xae)};return this.manager.start([c].concat(Ny(s.reduce(v,[d,Math.max(p,o)])),[a.onAnimationEnd]))}},{key:"runAnimation",value:function(a){this.manager||(this.manager=Wae());var i=a.begin,s=a.duration,o=a.attributeName,c=a.to,u=a.easing,d=a.onAnimationStart,h=a.onAnimationEnd,p=a.steps,v=a.children,x=this.manager;if(this.unSubscribe=x.subscribe(this.handleStyleChange),typeof u=="function"||typeof v=="function"||u==="spring"){this.runJSAnimation(a);return}if(p.length>1){this.runStepAnimation(a);return}var w=o?gu({},o,c):c,y=wO(Object.keys(w),s,u);x.start([d,i,ri(ri({},w),{},{transition:y}),s,h])}},{key:"render",value:function(){var a=this.props,i=a.children;a.begin;var s=a.duration;a.attributeName,a.easing;var o=a.isActive;a.steps,a.from,a.to,a.canBegin,a.onAnimationEnd,a.shouldReAnimate,a.onAnimationReStart;var c=xie(a,gie),u=D.Children.count(i),d=this.state.style;if(typeof i=="function")return i(d);if(!o||u===0||s<=0)return i;var h=function(v){var x=v.props,w=x.style,y=w===void 0?{}:w,_=x.className,S=D.cloneElement(v,ri(ri({},c),{},{style:ri(ri({},y),d),className:_}));return S};return u===1?h(D.Children.only(i)):me.createElement("div",null,D.Children.map(i,function(p){return h(p)}))}}]),r})(D.PureComponent);Ks.displayName="Animate";Ks.defaultProps={begin:0,duration:1e3,from:"",to:"",attributeName:"",easing:"ease",isActive:!0,canBegin:!0,steps:[],onAnimationEnd:function(){},onAnimationStart:function(){}};Ks.propTypes={from:ar.oneOfType([ar.object,ar.string]),to:ar.oneOfType([ar.object,ar.string]),attributeName:ar.string,duration:ar.number,begin:ar.number,easing:ar.oneOfType([ar.string,ar.func]),steps:ar.arrayOf(ar.shape({duration:ar.number.isRequired,style:ar.object.isRequired,easing:ar.oneOfType([ar.oneOf(["ease","ease-in","ease-out","ease-in-out","linear"]),ar.func]),properties:ar.arrayOf("string"),onAnimationEnd:ar.func})),children:ar.oneOfType([ar.node,ar.func]),isActive:ar.bool,canBegin:ar.bool,onAnimationEnd:ar.func,shouldReAnimate:ar.bool,onAnimationStart:ar.func,onAnimationReStart:ar.func};var Bp=i6();const Pie=rr(Bp);function Af(e){"@babel/helpers - typeof";return Af=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Af(e)}function Lh(){return Lh=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Lh.apply(this,arguments)}function Iie(e,t){return Rie(e)||jie(e,t)||Die(e,t)||Fie()}function Fie(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Die(e,t){if(e){if(typeof e=="string")return TO(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return TO(e,t)}}function TO(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function jie(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,a,i,s,o=[],c=!0,u=!1;try{if(i=(r=r.call(e)).next,t!==0)for(;!(c=(n=i.call(r)).done)&&(o.push(n.value),o.length!==t);c=!0);}catch(d){u=!0,a=d}finally{try{if(!c&&r.return!=null&&(s=r.return(),Object(s)!==s))return}finally{if(u)throw a}}return o}}function Rie(e){if(Array.isArray(e))return e}function AO(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function CO(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?AO(Object(r),!0).forEach(function(n){Mie(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):AO(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Mie(e,t,r){return t=Lie(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Lie(e){var t=Bie(e,"string");return Af(t)=="symbol"?t:String(t)}function Bie(e,t){if(Af(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Af(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var OO=function(t,r,n,a,i){var s=Math.min(Math.abs(n)/2,Math.abs(a)/2),o=a>=0?1:-1,c=n>=0?1:-1,u=a>=0&&n>=0||a<0&&n<0?1:0,d;if(s>0&&i instanceof Array){for(var h=[0,0,0,0],p=0,v=4;p<v;p++)h[p]=i[p]>s?s:i[p];d="M".concat(t,",").concat(r+o*h[0]),h[0]>0&&(d+="A ".concat(h[0],",").concat(h[0],",0,0,").concat(u,",").concat(t+c*h[0],",").concat(r)),d+="L ".concat(t+n-c*h[1],",").concat(r),h[1]>0&&(d+="A ".concat(h[1],",").concat(h[1],",0,0,").concat(u,`,
        `).concat(t+n,",").concat(r+o*h[1])),d+="L ".concat(t+n,",").concat(r+a-o*h[2]),h[2]>0&&(d+="A ".concat(h[2],",").concat(h[2],",0,0,").concat(u,`,
        `).concat(t+n-c*h[2],",").concat(r+a)),d+="L ".concat(t+c*h[3],",").concat(r+a),h[3]>0&&(d+="A ".concat(h[3],",").concat(h[3],",0,0,").concat(u,`,
        `).concat(t,",").concat(r+a-o*h[3])),d+="Z"}else if(s>0&&i===+i&&i>0){var x=Math.min(s,i);d="M ".concat(t,",").concat(r+o*x,`
            A `).concat(x,",").concat(x,",0,0,").concat(u,",").concat(t+c*x,",").concat(r,`
            L `).concat(t+n-c*x,",").concat(r,`
            A `).concat(x,",").concat(x,",0,0,").concat(u,",").concat(t+n,",").concat(r+o*x,`
            L `).concat(t+n,",").concat(r+a-o*x,`
            A `).concat(x,",").concat(x,",0,0,").concat(u,",").concat(t+n-c*x,",").concat(r+a,`
            L `).concat(t+c*x,",").concat(r+a,`
            A `).concat(x,",").concat(x,",0,0,").concat(u,",").concat(t,",").concat(r+a-o*x," Z")}else d="M ".concat(t,",").concat(r," h ").concat(n," v ").concat(a," h ").concat(-n," Z");return d},$ie=function(t,r){if(!t||!r)return!1;var n=t.x,a=t.y,i=r.x,s=r.y,o=r.width,c=r.height;if(Math.abs(o)>0&&Math.abs(c)>0){var u=Math.min(i,i+o),d=Math.max(i,i+o),h=Math.min(s,s+c),p=Math.max(s,s+c);return n>=u&&n<=d&&a>=h&&a<=p}return!1},Uie={x:0,y:0,width:0,height:0,radius:0,isAnimationActive:!1,isUpdateAnimationActive:!1,animationBegin:0,animationDuration:1500,animationEasing:"ease"},M_=function(t){var r=CO(CO({},Uie),t),n=D.useRef(),a=D.useState(-1),i=Iie(a,2),s=i[0],o=i[1];D.useEffect(function(){if(n.current&&n.current.getTotalLength)try{var E=n.current.getTotalLength();E&&o(E)}catch{}},[]);var c=r.x,u=r.y,d=r.width,h=r.height,p=r.radius,v=r.className,x=r.animationEasing,w=r.animationDuration,y=r.animationBegin,_=r.isAnimationActive,S=r.isUpdateAnimationActive;if(c!==+c||u!==+u||d!==+d||h!==+h||d===0||h===0)return null;var k=Qt("recharts-rectangle",v);return S?me.createElement(Ks,{canBegin:s>0,from:{width:d,height:h,x:c,y:u},to:{width:d,height:h,x:c,y:u},duration:w,animationEasing:x,isActive:S},function(E){var T=E.width,N=E.height,C=E.x,P=E.y;return me.createElement(Ks,{canBegin:s>0,from:"0px ".concat(s===-1?1:s,"px"),to:"".concat(s,"px 0px"),attributeName:"strokeDasharray",begin:y,duration:w,isActive:_,easing:x},me.createElement("path",Lh({},Mt(r,!0),{className:k,d:OO(C,P,T,N,p),ref:n})))}):me.createElement("path",Lh({},Mt(r,!0),{className:k,d:OO(c,u,d,h,p)}))},zie=["points","className","baseLinePoints","connectNulls"];function Il(){return Il=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Il.apply(this,arguments)}function Wie(e,t){if(e==null)return{};var r=Hie(e,t),n,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function Hie(e,t){if(e==null)return{};var r={},n=Object.keys(e),a,i;for(i=0;i<n.length;i++)a=n[i],!(t.indexOf(a)>=0)&&(r[a]=e[a]);return r}function NO(e){return Gie(e)||Xie(e)||Vie(e)||qie()}function qie(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Vie(e,t){if(e){if(typeof e=="string")return Pw(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Pw(e,t)}}function Xie(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function Gie(e){if(Array.isArray(e))return Pw(e)}function Pw(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var PO=function(t){return t&&t.x===+t.x&&t.y===+t.y},Kie=function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],r=[[]];return t.forEach(function(n){PO(n)?r[r.length-1].push(n):r[r.length-1].length>0&&r.push([])}),PO(t[0])&&r[r.length-1].push(t[0]),r[r.length-1].length<=0&&(r=r.slice(0,-1)),r},Du=function(t,r){var n=Kie(t);r&&(n=[n.reduce(function(i,s){return[].concat(NO(i),NO(s))},[])]);var a=n.map(function(i){return i.reduce(function(s,o,c){return"".concat(s).concat(c===0?"M":"L").concat(o.x,",").concat(o.y)},"")}).join("");return n.length===1?"".concat(a,"Z"):a},Yie=function(t,r,n){var a=Du(t,n);return"".concat(a.slice(-1)==="Z"?a.slice(0,-1):a,"L").concat(Du(r.reverse(),n).slice(1))},Zie=function(t){var r=t.points,n=t.className,a=t.baseLinePoints,i=t.connectNulls,s=Wie(t,zie);if(!r||!r.length)return null;var o=Qt("recharts-polygon",n);if(a&&a.length){var c=s.stroke&&s.stroke!=="none",u=Yie(r,a,i);return me.createElement("g",{className:o},me.createElement("path",Il({},Mt(s,!0),{fill:u.slice(-1)==="Z"?s.fill:"none",stroke:"none",d:u})),c?me.createElement("path",Il({},Mt(s,!0),{fill:"none",d:Du(r,i)})):null,c?me.createElement("path",Il({},Mt(s,!0),{fill:"none",d:Du(a,i)})):null)}var d=Du(r,i);return me.createElement("path",Il({},Mt(s,!0),{fill:d.slice(-1)==="Z"?s.fill:"none",className:o,d}))};function Iw(){return Iw=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Iw.apply(this,arguments)}var L_=function(t){var r=t.cx,n=t.cy,a=t.r,i=t.className,s=Qt("recharts-dot",i);return r===+r&&n===+n&&a===+a?me.createElement("circle",Iw({},Mt(t,!1),uh(t),{className:s,cx:r,cy:n,r:a})):null};function Cf(e){"@babel/helpers - typeof";return Cf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Cf(e)}var Qie=["x","y","top","left","width","height","className"];function Fw(){return Fw=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Fw.apply(this,arguments)}function IO(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Jie(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?IO(Object(r),!0).forEach(function(n){ese(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):IO(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function ese(e,t,r){return t=tse(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function tse(e){var t=rse(e,"string");return Cf(t)=="symbol"?t:String(t)}function rse(e,t){if(Cf(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Cf(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function nse(e,t){if(e==null)return{};var r=ase(e,t),n,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function ase(e,t){if(e==null)return{};var r={},n=Object.keys(e),a,i;for(i=0;i<n.length;i++)a=n[i],!(t.indexOf(a)>=0)&&(r[a]=e[a]);return r}var ise=function(t,r,n,a,i,s){return"M".concat(t,",").concat(i,"v").concat(a,"M").concat(s,",").concat(r,"h").concat(n)},sse=function(t){var r=t.x,n=r===void 0?0:r,a=t.y,i=a===void 0?0:a,s=t.top,o=s===void 0?0:s,c=t.left,u=c===void 0?0:c,d=t.width,h=d===void 0?0:d,p=t.height,v=p===void 0?0:p,x=t.className,w=nse(t,Qie),y=Jie({x:n,y:i,top:o,left:u,width:h,height:v},w);return!ot(n)||!ot(i)||!ot(h)||!ot(v)||!ot(o)||!ot(u)?null:me.createElement("path",Fw({},Mt(y,!0),{className:Qt("recharts-cross",x),d:ise(n,i,h,v,o,u)}))},Py,FO;function ose(){if(FO)return Py;FO=1;var e=Dp(),t=sF(),r=ji();function n(a,i){return a&&a.length?e(a,r(i,2),t):void 0}return Py=n,Py}var lse=ose();const cse=rr(lse);var Iy,DO;function use(){if(DO)return Iy;DO=1;var e=Dp(),t=ji(),r=oF();function n(a,i){return a&&a.length?e(a,t(i,2),r):void 0}return Iy=n,Iy}var fse=use();const dse=rr(fse);var hse=["cx","cy","angle","ticks","axisLine"],pse=["ticks","tick","angle","tickFormatter","stroke"];function nc(e){"@babel/helpers - typeof";return nc=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},nc(e)}function ju(){return ju=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},ju.apply(this,arguments)}function jO(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function yo(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?jO(Object(r),!0).forEach(function(n){$p(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):jO(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function RO(e,t){if(e==null)return{};var r=mse(e,t),n,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function mse(e,t){if(e==null)return{};var r={},n=Object.keys(e),a,i;for(i=0;i<n.length;i++)a=n[i],!(t.indexOf(a)>=0)&&(r[a]=e[a]);return r}function vse(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function MO(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,LF(n.key),n)}}function gse(e,t,r){return t&&MO(e.prototype,t),r&&MO(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function xse(e,t,r){return t=Bh(t),yse(e,MF()?Reflect.construct(t,r||[],Bh(e).constructor):t.apply(e,r))}function yse(e,t){if(t&&(nc(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return wse(e)}function wse(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function MF(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(MF=function(){return!!e})()}function Bh(e){return Bh=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Bh(e)}function bse(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Dw(e,t)}function Dw(e,t){return Dw=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},Dw(e,t)}function $p(e,t,r){return t=LF(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function LF(e){var t=_se(e,"string");return nc(t)=="symbol"?t:String(t)}function _se(e,t){if(nc(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(nc(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Up=(function(e){bse(t,e);function t(){return vse(this,t),xse(this,t,arguments)}return gse(t,[{key:"getTickValueCoord",value:function(n){var a=n.coordinate,i=this.props,s=i.angle,o=i.cx,c=i.cy;return xr(o,c,a,s)}},{key:"getTickTextAnchor",value:function(){var n=this.props.orientation,a;switch(n){case"left":a="end";break;case"right":a="start";break;default:a="middle";break}return a}},{key:"getViewBox",value:function(){var n=this.props,a=n.cx,i=n.cy,s=n.angle,o=n.ticks,c=cse(o,function(d){return d.coordinate||0}),u=dse(o,function(d){return d.coordinate||0});return{cx:a,cy:i,startAngle:s,endAngle:s,innerRadius:u.coordinate||0,outerRadius:c.coordinate||0}}},{key:"renderAxisLine",value:function(){var n=this.props,a=n.cx,i=n.cy,s=n.angle,o=n.ticks,c=n.axisLine,u=RO(n,hse),d=o.reduce(function(x,w){return[Math.min(x[0],w.coordinate),Math.max(x[1],w.coordinate)]},[1/0,-1/0]),h=xr(a,i,d[0],s),p=xr(a,i,d[1],s),v=yo(yo(yo({},Mt(u,!1)),{},{fill:"none"},Mt(c,!1)),{},{x1:h.x,y1:h.y,x2:p.x,y2:p.y});return me.createElement("line",ju({className:"recharts-polar-radius-axis-line"},v))}},{key:"renderTicks",value:function(){var n=this,a=this.props,i=a.ticks,s=a.tick,o=a.angle,c=a.tickFormatter,u=a.stroke,d=RO(a,pse),h=this.getTickTextAnchor(),p=Mt(d,!1),v=Mt(s,!1),x=i.map(function(w,y){var _=n.getTickValueCoord(w),S=yo(yo(yo(yo({textAnchor:h,transform:"rotate(".concat(90-o,", ").concat(_.x,", ").concat(_.y,")")},p),{},{stroke:"none",fill:u},v),{},{index:y},_),{},{payload:w});return me.createElement(Fr,ju({className:Qt("recharts-polar-radius-axis-tick",AF(s)),key:"tick-".concat(w.coordinate)},yp(n.props,w,y)),t.renderTickItem(s,S,c?c(w.value,y):w.value))});return me.createElement(Fr,{className:"recharts-polar-radius-axis-ticks"},x)}},{key:"render",value:function(){var n=this.props,a=n.ticks,i=n.axisLine,s=n.tick;return!a||!a.length?null:me.createElement(Fr,{className:Qt("recharts-polar-radius-axis",this.props.className)},i&&this.renderAxisLine(),s&&this.renderTicks(),yn.renderCallByParent(this.props,this.getViewBox()))}}],[{key:"renderTickItem",value:function(n,a,i){var s;return me.isValidElement(n)?s=me.cloneElement(n,a):$t(n)?s=n(a):s=me.createElement(Zl,ju({},a,{className:"recharts-polar-radius-axis-tick-value"}),i),s}}]),t})(D.PureComponent);$p(Up,"displayName","PolarRadiusAxis");$p(Up,"axisType","radiusAxis");$p(Up,"defaultProps",{type:"number",radiusAxisId:0,cx:0,cy:0,angle:0,orientation:"right",stroke:"#ccc",axisLine:!0,tick:!0,tickCount:5,allowDataOverflow:!1,scale:"auto",allowDuplicatedCategory:!0});function ac(e){"@babel/helpers - typeof";return ac=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ac(e)}function ko(){return ko=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},ko.apply(this,arguments)}function LO(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function wo(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?LO(Object(r),!0).forEach(function(n){zp(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):LO(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Sse(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function BO(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,$F(n.key),n)}}function kse(e,t,r){return t&&BO(e.prototype,t),r&&BO(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Ese(e,t,r){return t=$h(t),Tse(e,BF()?Reflect.construct(t,r||[],$h(e).constructor):t.apply(e,r))}function Tse(e,t){if(t&&(ac(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Ase(e)}function Ase(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function BF(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(BF=function(){return!!e})()}function $h(e){return $h=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},$h(e)}function Cse(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&jw(e,t)}function jw(e,t){return jw=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},jw(e,t)}function zp(e,t,r){return t=$F(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function $F(e){var t=Ose(e,"string");return ac(t)=="symbol"?t:String(t)}function Ose(e,t){if(ac(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(ac(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Nse=Math.PI/180,$O=1e-5,Wp=(function(e){Cse(t,e);function t(){return Sse(this,t),Ese(this,t,arguments)}return kse(t,[{key:"getTickLineCoord",value:function(n){var a=this.props,i=a.cx,s=a.cy,o=a.radius,c=a.orientation,u=a.tickSize,d=u||8,h=xr(i,s,o,n.coordinate),p=xr(i,s,o+(c==="inner"?-1:1)*d,n.coordinate);return{x1:h.x,y1:h.y,x2:p.x,y2:p.y}}},{key:"getTickTextAnchor",value:function(n){var a=this.props.orientation,i=Math.cos(-n.coordinate*Nse),s;return i>$O?s=a==="outer"?"start":"end":i<-$O?s=a==="outer"?"end":"start":s="middle",s}},{key:"renderAxisLine",value:function(){var n=this.props,a=n.cx,i=n.cy,s=n.radius,o=n.axisLine,c=n.axisLineType,u=wo(wo({},Mt(this.props,!1)),{},{fill:"none"},Mt(o,!1));if(c==="circle")return me.createElement(L_,ko({className:"recharts-polar-angle-axis-line"},u,{cx:a,cy:i,r:s}));var d=this.props.ticks,h=d.map(function(p){return xr(a,i,s,p.coordinate)});return me.createElement(Zie,ko({className:"recharts-polar-angle-axis-line"},u,{points:h}))}},{key:"renderTicks",value:function(){var n=this,a=this.props,i=a.ticks,s=a.tick,o=a.tickLine,c=a.tickFormatter,u=a.stroke,d=Mt(this.props,!1),h=Mt(s,!1),p=wo(wo({},d),{},{fill:"none"},Mt(o,!1)),v=i.map(function(x,w){var y=n.getTickLineCoord(x),_=n.getTickTextAnchor(x),S=wo(wo(wo({textAnchor:_},d),{},{stroke:"none",fill:u},h),{},{index:w,payload:x,x:y.x2,y:y.y2});return me.createElement(Fr,ko({className:Qt("recharts-polar-angle-axis-tick",AF(s)),key:"tick-".concat(x.coordinate)},yp(n.props,x,w)),o&&me.createElement("line",ko({className:"recharts-polar-angle-axis-tick-line"},p,y)),s&&t.renderTickItem(s,S,c?c(x.value,w):x.value))});return me.createElement(Fr,{className:"recharts-polar-angle-axis-ticks"},v)}},{key:"render",value:function(){var n=this.props,a=n.ticks,i=n.radius,s=n.axisLine;return i<=0||!a||!a.length?null:me.createElement(Fr,{className:Qt("recharts-polar-angle-axis",this.props.className)},s&&this.renderAxisLine(),this.renderTicks())}}],[{key:"renderTickItem",value:function(n,a,i){var s;return me.isValidElement(n)?s=me.cloneElement(n,a):$t(n)?s=n(a):s=me.createElement(Zl,ko({},a,{className:"recharts-polar-angle-axis-tick-value"}),i),s}}]),t})(D.PureComponent);zp(Wp,"displayName","PolarAngleAxis");zp(Wp,"axisType","angleAxis");zp(Wp,"defaultProps",{type:"category",angleAxisId:0,scale:"auto",cx:0,cy:0,orientation:"outer",axisLine:!0,tickLine:!0,tickSize:8,tick:!0,hide:!1,allowDuplicatedCategory:!0});var Fy,UO;function Pse(){if(UO)return Fy;UO=1;var e=a8(),t=e(Object.getPrototypeOf,Object);return Fy=t,Fy}var Dy,zO;function Ise(){if(zO)return Dy;zO=1;var e=ds(),t=Pse(),r=hs(),n="[object Object]",a=Function.prototype,i=Object.prototype,s=a.toString,o=i.hasOwnProperty,c=s.call(Object);function u(d){if(!r(d)||e(d)!=n)return!1;var h=t(d);if(h===null)return!0;var p=o.call(h,"constructor")&&h.constructor;return typeof p=="function"&&p instanceof p&&s.call(p)==c}return Dy=u,Dy}var Fse=Ise();const Dse=rr(Fse);var jy,WO;function jse(){if(WO)return jy;WO=1;var e=ds(),t=hs(),r="[object Boolean]";function n(a){return a===!0||a===!1||t(a)&&e(a)==r}return jy=n,jy}var Rse=jse();const Mse=rr(Rse);function Of(e){"@babel/helpers - typeof";return Of=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Of(e)}function Uh(){return Uh=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Uh.apply(this,arguments)}function Lse(e,t){return zse(e)||Use(e,t)||$se(e,t)||Bse()}function Bse(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function $se(e,t){if(e){if(typeof e=="string")return HO(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return HO(e,t)}}function HO(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Use(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,a,i,s,o=[],c=!0,u=!1;try{if(i=(r=r.call(e)).next,t!==0)for(;!(c=(n=i.call(r)).done)&&(o.push(n.value),o.length!==t);c=!0);}catch(d){u=!0,a=d}finally{try{if(!c&&r.return!=null&&(s=r.return(),Object(s)!==s))return}finally{if(u)throw a}}return o}}function zse(e){if(Array.isArray(e))return e}function qO(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function VO(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?qO(Object(r),!0).forEach(function(n){Wse(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):qO(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Wse(e,t,r){return t=Hse(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Hse(e){var t=qse(e,"string");return Of(t)=="symbol"?t:String(t)}function qse(e,t){if(Of(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Of(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var XO=function(t,r,n,a,i){var s=n-a,o;return o="M ".concat(t,",").concat(r),o+="L ".concat(t+n,",").concat(r),o+="L ".concat(t+n-s/2,",").concat(r+i),o+="L ".concat(t+n-s/2-a,",").concat(r+i),o+="L ".concat(t,",").concat(r," Z"),o},Vse={x:0,y:0,upperWidth:0,lowerWidth:0,height:0,isUpdateAnimationActive:!1,animationBegin:0,animationDuration:1500,animationEasing:"ease"},Xse=function(t){var r=VO(VO({},Vse),t),n=D.useRef(),a=D.useState(-1),i=Lse(a,2),s=i[0],o=i[1];D.useEffect(function(){if(n.current&&n.current.getTotalLength)try{var k=n.current.getTotalLength();k&&o(k)}catch{}},[]);var c=r.x,u=r.y,d=r.upperWidth,h=r.lowerWidth,p=r.height,v=r.className,x=r.animationEasing,w=r.animationDuration,y=r.animationBegin,_=r.isUpdateAnimationActive;if(c!==+c||u!==+u||d!==+d||h!==+h||p!==+p||d===0&&h===0||p===0)return null;var S=Qt("recharts-trapezoid",v);return _?me.createElement(Ks,{canBegin:s>0,from:{upperWidth:0,lowerWidth:0,height:p,x:c,y:u},to:{upperWidth:d,lowerWidth:h,height:p,x:c,y:u},duration:w,animationEasing:x,isActive:_},function(k){var E=k.upperWidth,T=k.lowerWidth,N=k.height,C=k.x,P=k.y;return me.createElement(Ks,{canBegin:s>0,from:"0px ".concat(s===-1?1:s,"px"),to:"".concat(s,"px 0px"),attributeName:"strokeDasharray",begin:y,duration:w,easing:x},me.createElement("path",Uh({},Mt(r,!0),{className:S,d:XO(C,P,E,T,N),ref:n})))}):me.createElement("g",null,me.createElement("path",Uh({},Mt(r,!0),{className:S,d:XO(c,u,d,h,p)})))},Gse=["option","shapeType","propTransformer","activeClassName","isActive"];function Nf(e){"@babel/helpers - typeof";return Nf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Nf(e)}function Kse(e,t){if(e==null)return{};var r=Yse(e,t),n,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function Yse(e,t){if(e==null)return{};var r={},n=Object.keys(e),a,i;for(i=0;i<n.length;i++)a=n[i],!(t.indexOf(a)>=0)&&(r[a]=e[a]);return r}function GO(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function zh(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?GO(Object(r),!0).forEach(function(n){Zse(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):GO(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Zse(e,t,r){return t=Qse(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Qse(e){var t=Jse(e,"string");return Nf(t)=="symbol"?t:String(t)}function Jse(e,t){if(Nf(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Nf(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function eoe(e,t){return zh(zh({},t),e)}function toe(e,t){return e==="symbols"}function KO(e){var t=e.shapeType,r=e.elementProps;switch(t){case"rectangle":return me.createElement(M_,r);case"trapezoid":return me.createElement(Xse,r);case"sector":return me.createElement(j_,r);case"symbols":if(toe(t))return me.createElement(Zb,r);break;default:return null}}function roe(e){return D.isValidElement(e)?e.props:e}function noe(e){var t=e.option,r=e.shapeType,n=e.propTransformer,a=n===void 0?eoe:n,i=e.activeClassName,s=i===void 0?"recharts-active-shape":i,o=e.isActive,c=Kse(e,Gse),u;if(D.isValidElement(t))u=D.cloneElement(t,zh(zh({},c),roe(t)));else if($t(t))u=t(c);else if(Dse(t)&&!Mse(t)){var d=a(t,c);u=me.createElement(KO,{shapeType:r,elementProps:d})}else{var h=c;u=me.createElement(KO,{shapeType:r,elementProps:h})}return o?me.createElement(Fr,{className:s},u):u}function Hp(e,t){return t!=null&&"trapezoids"in e.props}function qp(e,t){return t!=null&&"sectors"in e.props}function Pf(e,t){return t!=null&&"points"in e.props}function aoe(e,t){var r,n,a=e.x===(t==null||(r=t.labelViewBox)===null||r===void 0?void 0:r.x)||e.x===t.x,i=e.y===(t==null||(n=t.labelViewBox)===null||n===void 0?void 0:n.y)||e.y===t.y;return a&&i}function ioe(e,t){var r=e.endAngle===t.endAngle,n=e.startAngle===t.startAngle;return r&&n}function soe(e,t){var r=e.x===t.x,n=e.y===t.y,a=e.z===t.z;return r&&n&&a}function ooe(e,t){var r;return Hp(e,t)?r=aoe:qp(e,t)?r=ioe:Pf(e,t)&&(r=soe),r}function loe(e,t){var r;return Hp(e,t)?r="trapezoids":qp(e,t)?r="sectors":Pf(e,t)&&(r="points"),r}function coe(e,t){if(Hp(e,t)){var r;return(r=t.tooltipPayload)===null||r===void 0||(r=r[0])===null||r===void 0||(r=r.payload)===null||r===void 0?void 0:r.payload}if(qp(e,t)){var n;return(n=t.tooltipPayload)===null||n===void 0||(n=n[0])===null||n===void 0||(n=n.payload)===null||n===void 0?void 0:n.payload}return Pf(e,t)?t.payload:{}}function uoe(e){var t=e.activeTooltipItem,r=e.graphicalItem,n=e.itemData,a=loe(r,t),i=coe(r,t),s=n.filter(function(c,u){var d=N_(i,c),h=r.props[a].filter(function(x){var w=ooe(r,t);return w(x,t)}),p=r.props[a].indexOf(h[h.length-1]),v=u===p;return d&&v}),o=n.indexOf(s[s.length-1]);return o}var Gd;function ic(e){"@babel/helpers - typeof";return ic=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ic(e)}function Fl(){return Fl=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Fl.apply(this,arguments)}function YO(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function kr(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?YO(Object(r),!0).forEach(function(n){$a(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):YO(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function foe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function ZO(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,zF(n.key),n)}}function doe(e,t,r){return t&&ZO(e.prototype,t),r&&ZO(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function hoe(e,t,r){return t=Wh(t),poe(e,UF()?Reflect.construct(t,r||[],Wh(e).constructor):t.apply(e,r))}function poe(e,t){if(t&&(ic(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Ol(e)}function UF(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(UF=function(){return!!e})()}function Wh(e){return Wh=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Wh(e)}function Ol(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function moe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Rw(e,t)}function Rw(e,t){return Rw=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},Rw(e,t)}function $a(e,t,r){return t=zF(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function zF(e){var t=voe(e,"string");return ic(t)=="symbol"?t:String(t)}function voe(e,t){if(ic(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(ic(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var ms=(function(e){moe(t,e);function t(r){var n;return foe(this,t),n=hoe(this,t,[r]),$a(Ol(n),"pieRef",null),$a(Ol(n),"sectorRefs",[]),$a(Ol(n),"id",xp("recharts-pie-")),$a(Ol(n),"handleAnimationEnd",function(){var a=n.props.onAnimationEnd;n.setState({isAnimationFinished:!0}),$t(a)&&a()}),$a(Ol(n),"handleAnimationStart",function(){var a=n.props.onAnimationStart;n.setState({isAnimationFinished:!1}),$t(a)&&a()}),n.state={isAnimationFinished:!r.isAnimationActive,prevIsAnimationActive:r.isAnimationActive,prevAnimationId:r.animationId,sectorToFocus:0},n}return doe(t,[{key:"isActiveIndex",value:function(n){var a=this.props.activeIndex;return Array.isArray(a)?a.indexOf(n)!==-1:n===a}},{key:"hasActiveIndex",value:function(){var n=this.props.activeIndex;return Array.isArray(n)?n.length!==0:n||n===0}},{key:"renderLabels",value:function(n){var a=this.props.isAnimationActive;if(a&&!this.state.isAnimationFinished)return null;var i=this.props,s=i.label,o=i.labelLine,c=i.dataKey,u=i.valueKey,d=Mt(this.props,!1),h=Mt(s,!1),p=Mt(o,!1),v=s&&s.offsetRadius||20,x=n.map(function(w,y){var _=(w.startAngle+w.endAngle)/2,S=xr(w.cx,w.cy,w.outerRadius+v,_),k=kr(kr(kr(kr({},d),w),{},{stroke:"none"},h),{},{index:y,textAnchor:t.getTextAnchor(S.x,w.cx)},S),E=kr(kr(kr(kr({},d),w),{},{fill:"none",stroke:w.fill},p),{},{index:y,points:[xr(w.cx,w.cy,w.outerRadius,_),S],key:"line"}),T=c;return Vt(c)&&Vt(u)?T="value":Vt(c)&&(T=u),me.createElement(Fr,{key:"label-".concat(w.startAngle,"-").concat(w.endAngle,"-").concat(w.midAngle,"-").concat(y)},o&&t.renderLabelLineItem(o,E),t.renderLabelItem(s,k,fa(w,T)))});return me.createElement(Fr,{className:"recharts-pie-labels"},x)}},{key:"renderSectorsStatically",value:function(n){var a=this,i=this.props,s=i.activeShape,o=i.blendStroke,c=i.inactiveShape;return n.map(function(u,d){if((u==null?void 0:u.startAngle)===0&&(u==null?void 0:u.endAngle)===0&&n.length!==1)return null;var h=a.isActiveIndex(d),p=c&&a.hasActiveIndex()?c:null,v=h?s:p,x=kr(kr({},u),{},{stroke:o?u.fill:u.stroke,tabIndex:-1});return me.createElement(Fr,Fl({ref:function(y){y&&!a.sectorRefs.includes(y)&&a.sectorRefs.push(y)},tabIndex:-1,className:"recharts-pie-sector"},yp(a.props,u,d),{key:"sector-".concat(u==null?void 0:u.startAngle,"-").concat(u==null?void 0:u.endAngle,"-").concat(u.midAngle,"-").concat(d)}),me.createElement(noe,Fl({option:v,isActive:h,shapeType:"sector"},x)))})}},{key:"renderSectorsWithAnimation",value:function(){var n=this,a=this.props,i=a.sectors,s=a.isAnimationActive,o=a.animationBegin,c=a.animationDuration,u=a.animationEasing,d=a.animationId,h=this.state,p=h.prevSectors,v=h.prevIsAnimationActive;return me.createElement(Ks,{begin:o,duration:c,isActive:s,easing:u,from:{t:0},to:{t:1},key:"pie-".concat(d,"-").concat(v),onAnimationStart:this.handleAnimationStart,onAnimationEnd:this.handleAnimationEnd},function(x){var w=x.t,y=[],_=i&&i[0],S=_.startAngle;return i.forEach(function(k,E){var T=p&&p[E],N=E>0?ui(k,"paddingAngle",0):0;if(T){var C=t5(T.endAngle-T.startAngle,k.endAngle-k.startAngle),P=kr(kr({},k),{},{startAngle:S+N,endAngle:S+C(w)+N});y.push(P),S=P.endAngle}else{var j=k.endAngle,R=k.startAngle,I=t5(0,j-R),F=I(w),L=kr(kr({},k),{},{startAngle:S+N,endAngle:S+F+N});y.push(L),S=L.endAngle}}),me.createElement(Fr,null,n.renderSectorsStatically(y))})}},{key:"attachKeyboardHandlers",value:function(n){var a=this;n.onkeydown=function(i){if(!i.altKey)switch(i.key){case"ArrowLeft":{var s=++a.state.sectorToFocus%a.sectorRefs.length;a.sectorRefs[s].focus(),a.setState({sectorToFocus:s});break}case"ArrowRight":{var o=--a.state.sectorToFocus<0?a.sectorRefs.length-1:a.state.sectorToFocus%a.sectorRefs.length;a.sectorRefs[o].focus(),a.setState({sectorToFocus:o});break}case"Escape":{a.sectorRefs[a.state.sectorToFocus].blur(),a.setState({sectorToFocus:0});break}}}}},{key:"renderSectors",value:function(){var n=this.props,a=n.sectors,i=n.isAnimationActive,s=this.state.prevSectors;return i&&a&&a.length&&(!s||!N_(s,a))?this.renderSectorsWithAnimation():this.renderSectorsStatically(a)}},{key:"componentDidMount",value:function(){this.pieRef&&this.attachKeyboardHandlers(this.pieRef)}},{key:"render",value:function(){var n=this,a=this.props,i=a.hide,s=a.sectors,o=a.className,c=a.label,u=a.cx,d=a.cy,h=a.innerRadius,p=a.outerRadius,v=a.isAnimationActive,x=this.state.isAnimationFinished;if(i||!s||!s.length||!ot(u)||!ot(d)||!ot(h)||!ot(p))return null;var w=Qt("recharts-pie",o);return me.createElement(Fr,{tabIndex:this.props.rootTabIndex,className:w,ref:function(_){n.pieRef=_}},this.renderSectors(),c&&this.renderLabels(s),yn.renderCallByParent(this.props,null,!1),(!v||x)&&Mo.renderCallByParent(this.props,s,!1))}}],[{key:"getDerivedStateFromProps",value:function(n,a){return a.prevIsAnimationActive!==n.isAnimationActive?{prevIsAnimationActive:n.isAnimationActive,prevAnimationId:n.animationId,curSectors:n.sectors,prevSectors:[],isAnimationFinished:!0}:n.isAnimationActive&&n.animationId!==a.prevAnimationId?{prevAnimationId:n.animationId,curSectors:n.sectors,prevSectors:a.curSectors,isAnimationFinished:!0}:n.sectors!==a.curSectors?{curSectors:n.sectors,isAnimationFinished:!0}:null}},{key:"getTextAnchor",value:function(n,a){return n>a?"start":n<a?"end":"middle"}},{key:"renderLabelLineItem",value:function(n,a){if(me.isValidElement(n))return me.cloneElement(n,a);if($t(n))return n(a);var i=Qt("recharts-pie-label-line",typeof n!="boolean"?n.className:"");return me.createElement(bw,Fl({},a,{type:"linear",className:i}))}},{key:"renderLabelItem",value:function(n,a,i){if(me.isValidElement(n))return me.cloneElement(n,a);var s=i;if($t(n)&&(s=n(a),me.isValidElement(s)))return s;var o=Qt("recharts-pie-label-text",typeof n!="boolean"&&!$t(n)?n.className:"");return me.createElement(Zl,Fl({},a,{alignmentBaseline:"middle",className:o}),s)}}]),t})(D.PureComponent);Gd=ms;$a(ms,"displayName","Pie");$a(ms,"defaultProps",{stroke:"#fff",fill:"#808080",legendType:"rect",cx:"50%",cy:"50%",startAngle:0,endAngle:360,innerRadius:0,outerRadius:"80%",paddingAngle:0,labelLine:!0,hide:!1,minAngle:0,isAnimationActive:!Ap.isSsr,animationBegin:400,animationDuration:1500,animationEasing:"ease",nameKey:"name",blendStroke:!1,rootTabIndex:0});$a(ms,"parseDeltaAngle",function(e,t){var r=za(t-e),n=Math.min(Math.abs(t-e),360);return r*n});$a(ms,"getRealPieData",function(e){var t=e.props,r=t.data,n=t.children,a=Mt(e.props,!1),i=Ai(n,o_);return r&&r.length?r.map(function(s,o){return kr(kr(kr({payload:s},a),s),i&&i[o]&&i[o].props)}):i&&i.length?i.map(function(s){return kr(kr({},a),s.props)}):[]});$a(ms,"parseCoordinateOfPie",function(e,t){var r=t.top,n=t.left,a=t.width,i=t.height,s=TF(a,i),o=n+Jn(e.props.cx,a,a/2),c=r+Jn(e.props.cy,i,i/2),u=Jn(e.props.innerRadius,s,0),d=Jn(e.props.outerRadius,s,s*.8),h=e.props.maxRadius||Math.sqrt(a*a+i*i)/2;return{cx:o,cy:c,innerRadius:u,outerRadius:d,maxRadius:h}});$a(ms,"getComposedData",function(e){var t=e.item,r=e.offset,n=Gd.getRealPieData(t);if(!n||!n.length)return null;var a=t.props,i=a.cornerRadius,s=a.startAngle,o=a.endAngle,c=a.paddingAngle,u=a.dataKey,d=a.nameKey,h=a.valueKey,p=a.tooltipType,v=Math.abs(t.props.minAngle),x=Gd.parseCoordinateOfPie(t,r),w=Gd.parseDeltaAngle(s,o),y=Math.abs(w),_=u;Vt(u)&&Vt(h)?(ns(!1,`Use "dataKey" to specify the value of pie,
      the props "valueKey" will be deprecated in 1.1.0`),_="value"):Vt(u)&&(ns(!1,`Use "dataKey" to specify the value of pie,
      the props "valueKey" will be deprecated in 1.1.0`),_=h);var S=n.filter(function(P){return fa(P,_,0)!==0}).length,k=(y>=360?S:S-1)*c,E=y-S*v-k,T=n.reduce(function(P,j){var R=fa(j,_,0);return P+(ot(R)?R:0)},0),N;if(T>0){var C;N=n.map(function(P,j){var R=fa(P,_,0),I=fa(P,d,j),F=(ot(R)?R:0)/T,L;j?L=C.endAngle+za(w)*c*(R!==0?1:0):L=s;var H=L+za(w)*((R!==0?v:0)+F*E),V=(L+H)/2,J=(x.innerRadius+x.outerRadius)/2,te=[{name:I,value:R,payload:P,dataKey:_,type:p}],q=xr(x.cx,x.cy,J,V);return C=kr(kr(kr({percent:F,cornerRadius:i,name:I,tooltipPayload:te,midAngle:V,middleRadius:J,tooltipPosition:q},P),x),{},{value:fa(P,_),startAngle:L,endAngle:H,payload:P,paddingAngle:za(w)*c}),C})}return kr(kr({},x),{},{sectors:N,data:n})});var Ry,QO;function goe(){if(QO)return Ry;QO=1;var e=Math.ceil,t=Math.max;function r(n,a,i,s){for(var o=-1,c=t(e((a-n)/(i||1)),0),u=Array(c);c--;)u[s?c:++o]=n,n+=i;return u}return Ry=r,Ry}var My,JO;function WF(){if(JO)return My;JO=1;var e=b8(),t=1/0,r=17976931348623157e292;function n(a){if(!a)return a===0?a:0;if(a=e(a),a===t||a===-t){var i=a<0?-1:1;return i*r}return a===a?a:0}return My=n,My}var Ly,eN;function xoe(){if(eN)return Ly;eN=1;var e=goe(),t=Tp(),r=WF();function n(a){return function(i,s,o){return o&&typeof o!="number"&&t(i,s,o)&&(s=o=void 0),i=r(i),s===void 0?(s=i,i=0):s=r(s),o=o===void 0?i<s?1:-1:r(o),e(i,s,o,a)}}return Ly=n,Ly}var By,tN;function yoe(){if(tN)return By;tN=1;var e=xoe(),t=e();return By=t,By}var woe=yoe();const Hh=rr(woe);function If(e){"@babel/helpers - typeof";return If=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},If(e)}function rN(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function nN(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?rN(Object(r),!0).forEach(function(n){HF(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):rN(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function HF(e,t,r){return t=boe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function boe(e){var t=_oe(e,"string");return If(t)=="symbol"?t:String(t)}function _oe(e,t){if(If(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(If(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Soe=["Webkit","Moz","O","ms"],koe=function(t,r){var n=t.replace(/(\w)/,function(i){return i.toUpperCase()}),a=Soe.reduce(function(i,s){return nN(nN({},i),{},HF({},s+n,r))},{});return a[t]=r,a};function sc(e){"@babel/helpers - typeof";return sc=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},sc(e)}function qh(){return qh=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},qh.apply(this,arguments)}function aN(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function $y(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?aN(Object(r),!0).forEach(function(n){oa(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):aN(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Eoe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function iN(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,VF(n.key),n)}}function Toe(e,t,r){return t&&iN(e.prototype,t),r&&iN(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Aoe(e,t,r){return t=Vh(t),Coe(e,qF()?Reflect.construct(t,r||[],Vh(e).constructor):t.apply(e,r))}function Coe(e,t){if(t&&(sc(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return bi(e)}function qF(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(qF=function(){return!!e})()}function Vh(e){return Vh=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Vh(e)}function bi(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Ooe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Mw(e,t)}function Mw(e,t){return Mw=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},Mw(e,t)}function oa(e,t,r){return t=VF(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function VF(e){var t=Noe(e,"string");return sc(t)=="symbol"?t:String(t)}function Noe(e,t){if(sc(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(sc(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Poe=function(t){var r=t.data,n=t.startIndex,a=t.endIndex,i=t.x,s=t.width,o=t.travellerWidth;if(!r||!r.length)return{};var c=r.length,u=Pu().domain(Hh(0,c)).range([i,i+s-o]),d=u.domain().map(function(h){return u(h)});return{isTextActive:!1,isSlideMoving:!1,isTravellerMoving:!1,isTravellerFocused:!1,startX:u(n),endX:u(a),scale:u,scaleValues:d}},sN=function(t){return t.changedTouches&&!!t.changedTouches.length},oc=(function(e){Ooe(t,e);function t(r){var n;return Eoe(this,t),n=Aoe(this,t,[r]),oa(bi(n),"handleDrag",function(a){n.leaveTimer&&(clearTimeout(n.leaveTimer),n.leaveTimer=null),n.state.isTravellerMoving?n.handleTravellerMove(a):n.state.isSlideMoving&&n.handleSlideDrag(a)}),oa(bi(n),"handleTouchMove",function(a){a.changedTouches!=null&&a.changedTouches.length>0&&n.handleDrag(a.changedTouches[0])}),oa(bi(n),"handleDragEnd",function(){n.setState({isTravellerMoving:!1,isSlideMoving:!1},function(){var a=n.props,i=a.endIndex,s=a.onDragEnd,o=a.startIndex;s==null||s({endIndex:i,startIndex:o})}),n.detachDragEndListener()}),oa(bi(n),"handleLeaveWrapper",function(){(n.state.isTravellerMoving||n.state.isSlideMoving)&&(n.leaveTimer=window.setTimeout(n.handleDragEnd,n.props.leaveTimeOut))}),oa(bi(n),"handleEnterSlideOrTraveller",function(){n.setState({isTextActive:!0})}),oa(bi(n),"handleLeaveSlideOrTraveller",function(){n.setState({isTextActive:!1})}),oa(bi(n),"handleSlideDragStart",function(a){var i=sN(a)?a.changedTouches[0]:a;n.setState({isTravellerMoving:!1,isSlideMoving:!0,slideMoveStartX:i.pageX}),n.attachDragEndListener()}),n.travellerDragStartHandlers={startX:n.handleTravellerDragStart.bind(bi(n),"startX"),endX:n.handleTravellerDragStart.bind(bi(n),"endX")},n.state={},n}return Toe(t,[{key:"componentWillUnmount",value:function(){this.leaveTimer&&(clearTimeout(this.leaveTimer),this.leaveTimer=null),this.detachDragEndListener()}},{key:"getIndex",value:function(n){var a=n.startX,i=n.endX,s=this.state.scaleValues,o=this.props,c=o.gap,u=o.data,d=u.length-1,h=Math.min(a,i),p=Math.max(a,i),v=t.getIndexInRange(s,h),x=t.getIndexInRange(s,p);return{startIndex:v-v%c,endIndex:x===d?d:x-x%c}}},{key:"getTextOfTick",value:function(n){var a=this.props,i=a.data,s=a.tickFormatter,o=a.dataKey,c=fa(i[n],o,n);return $t(s)?s(c,n):c}},{key:"attachDragEndListener",value:function(){window.addEventListener("mouseup",this.handleDragEnd,!0),window.addEventListener("touchend",this.handleDragEnd,!0),window.addEventListener("mousemove",this.handleDrag,!0)}},{key:"detachDragEndListener",value:function(){window.removeEventListener("mouseup",this.handleDragEnd,!0),window.removeEventListener("touchend",this.handleDragEnd,!0),window.removeEventListener("mousemove",this.handleDrag,!0)}},{key:"handleSlideDrag",value:function(n){var a=this.state,i=a.slideMoveStartX,s=a.startX,o=a.endX,c=this.props,u=c.x,d=c.width,h=c.travellerWidth,p=c.startIndex,v=c.endIndex,x=c.onChange,w=n.pageX-i;w>0?w=Math.min(w,u+d-h-o,u+d-h-s):w<0&&(w=Math.max(w,u-s,u-o));var y=this.getIndex({startX:s+w,endX:o+w});(y.startIndex!==p||y.endIndex!==v)&&x&&x(y),this.setState({startX:s+w,endX:o+w,slideMoveStartX:n.pageX})}},{key:"handleTravellerDragStart",value:function(n,a){var i=sN(a)?a.changedTouches[0]:a;this.setState({isSlideMoving:!1,isTravellerMoving:!0,movingTravellerId:n,brushMoveStartX:i.pageX}),this.attachDragEndListener()}},{key:"handleTravellerMove",value:function(n){var a=this.state,i=a.brushMoveStartX,s=a.movingTravellerId,o=a.endX,c=a.startX,u=this.state[s],d=this.props,h=d.x,p=d.width,v=d.travellerWidth,x=d.onChange,w=d.gap,y=d.data,_={startX:this.state.startX,endX:this.state.endX},S=n.pageX-i;S>0?S=Math.min(S,h+p-v-u):S<0&&(S=Math.max(S,h-u)),_[s]=u+S;var k=this.getIndex(_),E=k.startIndex,T=k.endIndex,N=function(){var P=y.length-1;return s==="startX"&&(o>c?E%w===0:T%w===0)||o<c&&T===P||s==="endX"&&(o>c?T%w===0:E%w===0)||o>c&&T===P};this.setState(oa(oa({},s,u+S),"brushMoveStartX",n.pageX),function(){x&&N()&&x(k)})}},{key:"handleTravellerMoveKeyboard",value:function(n,a){var i=this,s=this.state,o=s.scaleValues,c=s.startX,u=s.endX,d=this.state[a],h=o.indexOf(d);if(h!==-1){var p=h+n;if(!(p===-1||p>=o.length)){var v=o[p];a==="startX"&&v>=u||a==="endX"&&v<=c||this.setState(oa({},a,v),function(){i.props.onChange(i.getIndex({startX:i.state.startX,endX:i.state.endX}))})}}}},{key:"renderBackground",value:function(){var n=this.props,a=n.x,i=n.y,s=n.width,o=n.height,c=n.fill,u=n.stroke;return me.createElement("rect",{stroke:u,fill:c,x:a,y:i,width:s,height:o})}},{key:"renderPanorama",value:function(){var n=this.props,a=n.x,i=n.y,s=n.width,o=n.height,c=n.data,u=n.children,d=n.padding,h=D.Children.only(u);return h?me.cloneElement(h,{x:a,y:i,width:s,height:o,margin:d,compact:!0,data:c}):null}},{key:"renderTravellerLayer",value:function(n,a){var i,s,o=this,c=this.props,u=c.y,d=c.travellerWidth,h=c.height,p=c.traveller,v=c.ariaLabel,x=c.data,w=c.startIndex,y=c.endIndex,_=Math.max(n,this.props.x),S=$y($y({},Mt(this.props,!1)),{},{x:_,y:u,width:d,height:h}),k=v||"Min value: ".concat((i=x[w])===null||i===void 0?void 0:i.name,", Max value: ").concat((s=x[y])===null||s===void 0?void 0:s.name);return me.createElement(Fr,{tabIndex:0,role:"slider","aria-label":k,"aria-valuenow":n,className:"recharts-brush-traveller",onMouseEnter:this.handleEnterSlideOrTraveller,onMouseLeave:this.handleLeaveSlideOrTraveller,onMouseDown:this.travellerDragStartHandlers[a],onTouchStart:this.travellerDragStartHandlers[a],onKeyDown:function(T){["ArrowLeft","ArrowRight"].includes(T.key)&&(T.preventDefault(),T.stopPropagation(),o.handleTravellerMoveKeyboard(T.key==="ArrowRight"?1:-1,a))},onFocus:function(){o.setState({isTravellerFocused:!0})},onBlur:function(){o.setState({isTravellerFocused:!1})},style:{cursor:"col-resize"}},t.renderTraveller(p,S))}},{key:"renderSlide",value:function(n,a){var i=this.props,s=i.y,o=i.height,c=i.stroke,u=i.travellerWidth,d=Math.min(n,a)+u,h=Math.max(Math.abs(a-n)-u,0);return me.createElement("rect",{className:"recharts-brush-slide",onMouseEnter:this.handleEnterSlideOrTraveller,onMouseLeave:this.handleLeaveSlideOrTraveller,onMouseDown:this.handleSlideDragStart,onTouchStart:this.handleSlideDragStart,style:{cursor:"move"},stroke:"none",fill:c,fillOpacity:.2,x:d,y:s,width:h,height:o})}},{key:"renderText",value:function(){var n=this.props,a=n.startIndex,i=n.endIndex,s=n.y,o=n.height,c=n.travellerWidth,u=n.stroke,d=this.state,h=d.startX,p=d.endX,v=5,x={pointerEvents:"none",fill:u};return me.createElement(Fr,{className:"recharts-brush-texts"},me.createElement(Zl,qh({textAnchor:"end",verticalAnchor:"middle",x:Math.min(h,p)-v,y:s+o/2},x),this.getTextOfTick(a)),me.createElement(Zl,qh({textAnchor:"start",verticalAnchor:"middle",x:Math.max(h,p)+c+v,y:s+o/2},x),this.getTextOfTick(i)))}},{key:"render",value:function(){var n=this.props,a=n.data,i=n.className,s=n.children,o=n.x,c=n.y,u=n.width,d=n.height,h=n.alwaysShowText,p=this.state,v=p.startX,x=p.endX,w=p.isTextActive,y=p.isSlideMoving,_=p.isTravellerMoving,S=p.isTravellerFocused;if(!a||!a.length||!ot(o)||!ot(c)||!ot(u)||!ot(d)||u<=0||d<=0)return null;var k=Qt("recharts-brush",i),E=me.Children.count(s)===1,T=koe("userSelect","none");return me.createElement(Fr,{className:k,onMouseLeave:this.handleLeaveWrapper,onTouchMove:this.handleTouchMove,style:T},this.renderBackground(),E&&this.renderPanorama(),this.renderSlide(v,x),this.renderTravellerLayer(v,"startX"),this.renderTravellerLayer(x,"endX"),(w||y||_||S||h)&&this.renderText())}}],[{key:"renderDefaultTraveller",value:function(n){var a=n.x,i=n.y,s=n.width,o=n.height,c=n.stroke,u=Math.floor(i+o/2)-1;return me.createElement(me.Fragment,null,me.createElement("rect",{x:a,y:i,width:s,height:o,fill:c,stroke:"none"}),me.createElement("line",{x1:a+1,y1:u,x2:a+s-1,y2:u,fill:"none",stroke:"#fff"}),me.createElement("line",{x1:a+1,y1:u+2,x2:a+s-1,y2:u+2,fill:"none",stroke:"#fff"}))}},{key:"renderTraveller",value:function(n,a){var i;return me.isValidElement(n)?i=me.cloneElement(n,a):$t(n)?i=n(a):i=t.renderDefaultTraveller(a),i}},{key:"getDerivedStateFromProps",value:function(n,a){var i=n.data,s=n.width,o=n.x,c=n.travellerWidth,u=n.updateId,d=n.startIndex,h=n.endIndex;if(i!==a.prevData||u!==a.prevUpdateId)return $y({prevData:i,prevTravellerWidth:c,prevUpdateId:u,prevX:o,prevWidth:s},i&&i.length?Poe({data:i,width:s,x:o,travellerWidth:c,startIndex:d,endIndex:h}):{scale:null,scaleValues:null});if(a.scale&&(s!==a.prevWidth||o!==a.prevX||c!==a.prevTravellerWidth)){a.scale.range([o,o+s-c]);var p=a.scale.domain().map(function(v){return a.scale(v)});return{prevData:i,prevTravellerWidth:c,prevUpdateId:u,prevX:o,prevWidth:s,startX:a.scale(n.startIndex),endX:a.scale(n.endIndex),scaleValues:p}}return null}},{key:"getIndexInRange",value:function(n,a){for(var i=n.length,s=0,o=i-1;o-s>1;){var c=Math.floor((s+o)/2);n[c]>a?o=c:s=c}return a>=n[o]?o:s}}]),t})(D.PureComponent);oa(oc,"displayName","Brush");oa(oc,"defaultProps",{height:40,travellerWidth:5,gap:1,fill:"#fff",stroke:"#666",padding:{top:1,right:1,bottom:1,left:1},leaveTimeOut:1e3,alwaysShowText:!1});var Uy,oN;function Ioe(){if(oN)return Uy;oN=1;var e=a_();function t(r,n){var a;return e(r,function(i,s,o){return a=n(i,s,o),!a}),!!a}return Uy=t,Uy}var zy,lN;function Foe(){if(lN)return zy;lN=1;var e=ZI(),t=ji(),r=Ioe(),n=ra(),a=Tp();function i(s,o,c){var u=n(s)?e:r;return c&&a(s,o,c)&&(o=void 0),u(s,t(o,3))}return zy=i,zy}var Doe=Foe();const joe=rr(Doe);var Oi=function(t,r){var n=t.alwaysShow,a=t.ifOverflow;return n&&(a="extendDomain"),a===r},Wy,cN;function Roe(){if(cN)return Wy;cN=1;var e=v8();function t(r,n,a){n=="__proto__"&&e?e(r,n,{configurable:!0,enumerable:!0,value:a,writable:!0}):r[n]=a}return Wy=t,Wy}var Hy,uN;function Moe(){if(uN)return Hy;uN=1;var e=Roe(),t=p8(),r=ji();function n(a,i){var s={};return i=r(i,3),t(a,function(o,c,u){e(s,c,i(o,c,u))}),s}return Hy=n,Hy}var Loe=Moe();const Boe=rr(Loe);var qy,fN;function $oe(){if(fN)return qy;fN=1;function e(t,r){for(var n=-1,a=t==null?0:t.length;++n<a;)if(!r(t[n],n,t))return!1;return!0}return qy=e,qy}var Vy,dN;function Uoe(){if(dN)return Vy;dN=1;var e=a_();function t(r,n){var a=!0;return e(r,function(i,s,o){return a=!!n(i,s,o),a}),a}return Vy=t,Vy}var Xy,hN;function zoe(){if(hN)return Xy;hN=1;var e=$oe(),t=Uoe(),r=ji(),n=ra(),a=Tp();function i(s,o,c){var u=n(s)?e:t;return c&&a(s,o,c)&&(o=void 0),u(s,r(o,3))}return Xy=i,Xy}var Woe=zoe();const Hoe=rr(Woe);function Ff(e){"@babel/helpers - typeof";return Ff=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ff(e)}function qoe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function pN(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,XF(n.key),n)}}function Voe(e,t,r){return t&&pN(e.prototype,t),r&&pN(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function mN(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Bd(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?mN(Object(r),!0).forEach(function(n){B_(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):mN(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function B_(e,t,r){return t=XF(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function XF(e){var t=Xoe(e,"string");return Ff(t)=="symbol"?t:String(t)}function Xoe(e,t){if(Ff(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Ff(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var GF=function(t,r){var n=t.x,a=t.y,i=r.x,s=r.y;return{x:Math.min(n,i),y:Math.min(a,s),width:Math.abs(i-n),height:Math.abs(s-a)}},Goe=function(t){var r=t.x1,n=t.y1,a=t.x2,i=t.y2;return GF({x:r,y:n},{x:a,y:i})},KF=(function(){function e(t){qoe(this,e),this.scale=t}return Voe(e,[{key:"domain",get:function(){return this.scale.domain}},{key:"range",get:function(){return this.scale.range}},{key:"rangeMin",get:function(){return this.range()[0]}},{key:"rangeMax",get:function(){return this.range()[1]}},{key:"bandwidth",get:function(){return this.scale.bandwidth}},{key:"apply",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},a=n.bandAware,i=n.position;if(r!==void 0){if(i)switch(i){case"start":return this.scale(r);case"middle":{var s=this.bandwidth?this.bandwidth()/2:0;return this.scale(r)+s}case"end":{var o=this.bandwidth?this.bandwidth():0;return this.scale(r)+o}default:return this.scale(r)}if(a){var c=this.bandwidth?this.bandwidth()/2:0;return this.scale(r)+c}return this.scale(r)}}},{key:"isInRange",value:function(r){var n=this.range(),a=n[0],i=n[n.length-1];return a<=i?r>=a&&r<=i:r>=i&&r<=a}}],[{key:"create",value:function(r){return new e(r)}}]),e})();B_(KF,"EPS",1e-4);var $_=function(t){var r=Object.keys(t).reduce(function(n,a){return Bd(Bd({},n),{},B_({},a,KF.create(t[a])))},{});return Bd(Bd({},r),{},{apply:function(a){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},s=i.bandAware,o=i.position;return Boe(a,function(c,u){return r[u].apply(c,{bandAware:s,position:o})})},isInRange:function(a){return Hoe(a,function(i,s){return r[s].isInRange(i)})}})},Gy,vN;function Koe(){if(vN)return Gy;vN=1;var e=ji(),t=e0(),r=kp();function n(a){return function(i,s,o){var c=Object(i);if(!t(i)){var u=e(s,3);i=r(i),s=function(h){return u(c[h],h,c)}}var d=a(i,s,o);return d>-1?c[u?i[d]:d]:void 0}}return Gy=n,Gy}var Ky,gN;function Yoe(){if(gN)return Ky;gN=1;var e=WF();function t(r){var n=e(r),a=n%1;return n===n?a?n-a:n:0}return Ky=t,Ky}var Yy,xN;function Zoe(){if(xN)return Yy;xN=1;var e=l8(),t=ji(),r=Yoe(),n=Math.max;function a(i,s,o){var c=i==null?0:i.length;if(!c)return-1;var u=o==null?0:r(o);return u<0&&(u=n(c+u,0)),e(i,t(s,3),u)}return Yy=a,Yy}var Zy,yN;function Qoe(){if(yN)return Zy;yN=1;var e=Koe(),t=Zoe(),r=e(t);return Zy=r,Zy}Qoe();var Joe=kI();const ele=rr(Joe);var tle=ele(function(e){return{x:e.left,y:e.top,width:e.width,height:e.height}},function(e){return["l",e.left,"t",e.top,"w",e.width,"h",e.height].join("")}),YF=D.createContext(void 0),ZF=D.createContext(void 0),QF=D.createContext(void 0),rle=D.createContext({}),JF=D.createContext(void 0),nle=D.createContext(0),ale=D.createContext(0),wN=function(t){var r=t.state,n=r.xAxisMap,a=r.yAxisMap,i=r.offset,s=t.clipPathId,o=t.children,c=t.width,u=t.height,d=tle(i);return me.createElement(YF.Provider,{value:n},me.createElement(ZF.Provider,{value:a},me.createElement(rle.Provider,{value:i},me.createElement(QF.Provider,{value:d},me.createElement(JF.Provider,{value:s},me.createElement(nle.Provider,{value:u},me.createElement(ale.Provider,{value:c},o)))))))},ile=function(){return D.useContext(JF)},sle=function(t){var r=D.useContext(YF);r==null&&tc();var n=r[t];return n==null&&tc(),n},ole=function(t){var r=D.useContext(ZF);r==null&&tc();var n=r[t];return n==null&&tc(),n},lle=function(){var t=D.useContext(QF);return t};function Df(e){"@babel/helpers - typeof";return Df=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Df(e)}function bN(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function _N(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?bN(Object(r),!0).forEach(function(n){cle(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):bN(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function cle(e,t,r){return t=ule(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function ule(e){var t=fle(e,"string");return Df(t)=="symbol"?t:String(t)}function fle(e,t){if(Df(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Df(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function dle(e,t){return vle(e)||mle(e,t)||ple(e,t)||hle()}function hle(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function ple(e,t){if(e){if(typeof e=="string")return SN(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return SN(e,t)}}function SN(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function mle(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,a,i,s,o=[],c=!0,u=!1;try{if(i=(r=r.call(e)).next,t!==0)for(;!(c=(n=i.call(r)).done)&&(o.push(n.value),o.length!==t);c=!0);}catch(d){u=!0,a=d}finally{try{if(!c&&r.return!=null&&(s=r.return(),Object(s)!==s))return}finally{if(u)throw a}}return o}}function vle(e){if(Array.isArray(e))return e}function Lw(){return Lw=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Lw.apply(this,arguments)}var gle=function(t,r){var n;return me.isValidElement(t)?n=me.cloneElement(t,r):$t(t)?n=t(r):n=me.createElement("line",Lw({},r,{className:"recharts-reference-line-line"})),n},xle=function(t,r,n,a,i,s,o,c,u){var d=i.x,h=i.y,p=i.width,v=i.height;if(n){var x=u.y,w=t.y.apply(x,{position:s});if(Oi(u,"discard")&&!t.y.isInRange(w))return null;var y=[{x:d+p,y:w},{x:d,y:w}];return c==="left"?y.reverse():y}if(r){var _=u.x,S=t.x.apply(_,{position:s});if(Oi(u,"discard")&&!t.x.isInRange(S))return null;var k=[{x:S,y:h+v},{x:S,y:h}];return o==="top"?k.reverse():k}if(a){var E=u.segment,T=E.map(function(N){return t.apply(N,{position:s})});return Oi(u,"discard")&&joe(T,function(N){return!t.isInRange(N)})?null:T}return null};function U_(e){var t=e.x,r=e.y,n=e.segment,a=e.xAxisId,i=e.yAxisId,s=e.shape,o=e.className,c=e.alwaysShow,u=ile(),d=sle(a),h=ole(i),p=lle();if(!u||!p)return null;ns(c===void 0,'The alwaysShow prop is deprecated. Please use ifOverflow="extendDomain" instead.');var v=$_({x:d.scale,y:h.scale}),x=en(t),w=en(r),y=n&&n.length===2,_=xle(v,x,w,y,p,e.position,d.orientation,h.orientation,e);if(!_)return null;var S=dle(_,2),k=S[0],E=k.x,T=k.y,N=S[1],C=N.x,P=N.y,j=Oi(e,"hidden")?"url(#".concat(u,")"):void 0,R=_N(_N({clipPath:j},Mt(e,!0)),{},{x1:E,y1:T,x2:C,y2:P});return me.createElement(Fr,{className:Qt("recharts-reference-line",o)},gle(s,R),yn.renderCallByParent(e,Goe({x1:E,y1:T,x2:C,y2:P})))}U_.displayName="ReferenceLine";U_.defaultProps={isFront:!1,ifOverflow:"discard",xAxisId:0,yAxisId:0,fill:"none",stroke:"#ccc",fillOpacity:1,strokeWidth:1,position:"middle"};function jf(e){"@babel/helpers - typeof";return jf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},jf(e)}function Bw(){return Bw=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Bw.apply(this,arguments)}function kN(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function EN(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?kN(Object(r),!0).forEach(function(n){yle(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):kN(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function yle(e,t,r){return t=wle(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function wle(e){var t=ble(e,"string");return jf(t)=="symbol"?t:String(t)}function ble(e,t){if(jf(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(jf(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var _le=function(t){var r=t.x,n=t.y,a=t.xAxis,i=t.yAxis,s=$_({x:a.scale,y:i.scale}),o=s.apply({x:r,y:n},{bandAware:!0});return Oi(t,"discard")&&!s.isInRange(o)?null:o};function i0(e){var t=e.x,r=e.y,n=e.r,a=e.alwaysShow,i=e.clipPathId,s=en(t),o=en(r);if(ns(a===void 0,'The alwaysShow prop is deprecated. Please use ifOverflow="extendDomain" instead.'),!s||!o)return null;var c=_le(e);if(!c)return null;var u=c.x,d=c.y,h=e.shape,p=e.className,v=Oi(e,"hidden")?"url(#".concat(i,")"):void 0,x=EN(EN({clipPath:v},Mt(e,!0)),{},{cx:u,cy:d});return me.createElement(Fr,{className:Qt("recharts-reference-dot",p)},i0.renderDot(h,x),yn.renderCallByParent(e,{x:u-n,y:d-n,width:2*n,height:2*n}))}i0.displayName="ReferenceDot";i0.defaultProps={isFront:!1,ifOverflow:"discard",xAxisId:0,yAxisId:0,r:10,fill:"#fff",stroke:"#ccc",fillOpacity:1,strokeWidth:1};i0.renderDot=function(e,t){var r;return me.isValidElement(e)?r=me.cloneElement(e,t):$t(e)?r=e(t):r=me.createElement(L_,Bw({},t,{cx:t.cx,cy:t.cy,className:"recharts-reference-dot-dot"})),r};function Rf(e){"@babel/helpers - typeof";return Rf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Rf(e)}function $w(){return $w=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},$w.apply(this,arguments)}function TN(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function AN(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?TN(Object(r),!0).forEach(function(n){Sle(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):TN(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Sle(e,t,r){return t=kle(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function kle(e){var t=Ele(e,"string");return Rf(t)=="symbol"?t:String(t)}function Ele(e,t){if(Rf(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Rf(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Tle=function(t,r,n,a,i){var s=i.x1,o=i.x2,c=i.y1,u=i.y2,d=i.xAxis,h=i.yAxis;if(!d||!h)return null;var p=$_({x:d.scale,y:h.scale}),v={x:t?p.x.apply(s,{position:"start"}):p.x.rangeMin,y:n?p.y.apply(c,{position:"start"}):p.y.rangeMin},x={x:r?p.x.apply(o,{position:"end"}):p.x.rangeMax,y:a?p.y.apply(u,{position:"end"}):p.y.rangeMax};return Oi(i,"discard")&&(!p.isInRange(v)||!p.isInRange(x))?null:GF(v,x)};function s0(e){var t=e.x1,r=e.x2,n=e.y1,a=e.y2,i=e.className,s=e.alwaysShow,o=e.clipPathId;ns(s===void 0,'The alwaysShow prop is deprecated. Please use ifOverflow="extendDomain" instead.');var c=en(t),u=en(r),d=en(n),h=en(a),p=e.shape;if(!c&&!u&&!d&&!h&&!p)return null;var v=Tle(c,u,d,h,e);if(!v&&!p)return null;var x=Oi(e,"hidden")?"url(#".concat(o,")"):void 0;return me.createElement(Fr,{className:Qt("recharts-reference-area",i)},s0.renderRect(p,AN(AN({clipPath:x},Mt(e,!0)),v)),yn.renderCallByParent(e,v))}s0.displayName="ReferenceArea";s0.defaultProps={isFront:!1,ifOverflow:"discard",xAxisId:0,yAxisId:0,r:10,fill:"#ccc",fillOpacity:.5,stroke:"none",strokeWidth:1};s0.renderRect=function(e,t){var r;return me.isValidElement(e)?r=me.cloneElement(e,t):$t(e)?r=e(t):r=me.createElement(M_,$w({},t,{className:"recharts-reference-area-rect"})),r};function CN(e){return Nle(e)||Ole(e)||Cle(e)||Ale()}function Ale(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Cle(e,t){if(e){if(typeof e=="string")return Uw(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Uw(e,t)}}function Ole(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function Nle(e){if(Array.isArray(e))return Uw(e)}function Uw(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var zw=function(t,r,n,a,i){var s=Ai(t,U_),o=Ai(t,i0),c=[].concat(CN(s),CN(o)),u=Ai(t,s0),d="".concat(a,"Id"),h=a[0],p=r;if(c.length&&(p=c.reduce(function(w,y){if(y.props[d]===n&&Oi(y.props,"extendDomain")&&ot(y.props[h])){var _=y.props[h];return[Math.min(w[0],_),Math.max(w[1],_)]}return w},p)),u.length){var v="".concat(h,"1"),x="".concat(h,"2");p=u.reduce(function(w,y){if(y.props[d]===n&&Oi(y.props,"extendDomain")&&ot(y.props[v])&&ot(y.props[x])){var _=y.props[v],S=y.props[x];return[Math.min(w[0],_,S),Math.max(w[1],_,S)]}return w},p)}return i&&i.length&&(p=i.reduce(function(w,y){return ot(y)?[Math.min(w[0],y),Math.max(w[1],y)]:w},p)),p},Qy={exports:{}},ON;function Ple(){return ON||(ON=1,(function(e){var t=Object.prototype.hasOwnProperty,r="~";function n(){}Object.create&&(n.prototype=Object.create(null),new n().__proto__||(r=!1));function a(c,u,d){this.fn=c,this.context=u,this.once=d||!1}function i(c,u,d,h,p){if(typeof d!="function")throw new TypeError("The listener must be a function");var v=new a(d,h||c,p),x=r?r+u:u;return c._events[x]?c._events[x].fn?c._events[x]=[c._events[x],v]:c._events[x].push(v):(c._events[x]=v,c._eventsCount++),c}function s(c,u){--c._eventsCount===0?c._events=new n:delete c._events[u]}function o(){this._events=new n,this._eventsCount=0}o.prototype.eventNames=function(){var u=[],d,h;if(this._eventsCount===0)return u;for(h in d=this._events)t.call(d,h)&&u.push(r?h.slice(1):h);return Object.getOwnPropertySymbols?u.concat(Object.getOwnPropertySymbols(d)):u},o.prototype.listeners=function(u){var d=r?r+u:u,h=this._events[d];if(!h)return[];if(h.fn)return[h.fn];for(var p=0,v=h.length,x=new Array(v);p<v;p++)x[p]=h[p].fn;return x},o.prototype.listenerCount=function(u){var d=r?r+u:u,h=this._events[d];return h?h.fn?1:h.length:0},o.prototype.emit=function(u,d,h,p,v,x){var w=r?r+u:u;if(!this._events[w])return!1;var y=this._events[w],_=arguments.length,S,k;if(y.fn){switch(y.once&&this.removeListener(u,y.fn,void 0,!0),_){case 1:return y.fn.call(y.context),!0;case 2:return y.fn.call(y.context,d),!0;case 3:return y.fn.call(y.context,d,h),!0;case 4:return y.fn.call(y.context,d,h,p),!0;case 5:return y.fn.call(y.context,d,h,p,v),!0;case 6:return y.fn.call(y.context,d,h,p,v,x),!0}for(k=1,S=new Array(_-1);k<_;k++)S[k-1]=arguments[k];y.fn.apply(y.context,S)}else{var E=y.length,T;for(k=0;k<E;k++)switch(y[k].once&&this.removeListener(u,y[k].fn,void 0,!0),_){case 1:y[k].fn.call(y[k].context);break;case 2:y[k].fn.call(y[k].context,d);break;case 3:y[k].fn.call(y[k].context,d,h);break;case 4:y[k].fn.call(y[k].context,d,h,p);break;default:if(!S)for(T=1,S=new Array(_-1);T<_;T++)S[T-1]=arguments[T];y[k].fn.apply(y[k].context,S)}}return!0},o.prototype.on=function(u,d,h){return i(this,u,d,h,!1)},o.prototype.once=function(u,d,h){return i(this,u,d,h,!0)},o.prototype.removeListener=function(u,d,h,p){var v=r?r+u:u;if(!this._events[v])return this;if(!d)return s(this,v),this;var x=this._events[v];if(x.fn)x.fn===d&&(!p||x.once)&&(!h||x.context===h)&&s(this,v);else{for(var w=0,y=[],_=x.length;w<_;w++)(x[w].fn!==d||p&&!x[w].once||h&&x[w].context!==h)&&y.push(x[w]);y.length?this._events[v]=y.length===1?y[0]:y:s(this,v)}return this},o.prototype.removeAllListeners=function(u){var d;return u?(d=r?r+u:u,this._events[d]&&s(this,d)):(this._events=new n,this._eventsCount=0),this},o.prototype.off=o.prototype.removeListener,o.prototype.addListener=o.prototype.on,o.prefixed=r,o.EventEmitter=o,e.exports=o})(Qy)),Qy.exports}var Ile=Ple();const Fle=rr(Ile);var Jy=new Fle,e2="recharts.syncMouseEvents";function Mf(e){"@babel/helpers - typeof";return Mf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Mf(e)}function Dle(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function jle(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,eD(n.key),n)}}function Rle(e,t,r){return t&&jle(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function t2(e,t,r){return t=eD(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function eD(e){var t=Mle(e,"string");return Mf(t)=="symbol"?t:String(t)}function Mle(e,t){if(Mf(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Mf(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Lle=(function(){function e(){Dle(this,e),t2(this,"activeIndex",0),t2(this,"coordinateList",[]),t2(this,"layout","horizontal")}return Rle(e,[{key:"setDetails",value:function(r){var n,a=r.coordinateList,i=a===void 0?null:a,s=r.container,o=s===void 0?null:s,c=r.layout,u=c===void 0?null:c,d=r.offset,h=d===void 0?null:d,p=r.mouseHandlerCallback,v=p===void 0?null:p;this.coordinateList=(n=i??this.coordinateList)!==null&&n!==void 0?n:[],this.container=o??this.container,this.layout=u??this.layout,this.offset=h??this.offset,this.mouseHandlerCallback=v??this.mouseHandlerCallback,this.activeIndex=Math.min(Math.max(this.activeIndex,0),this.coordinateList.length-1)}},{key:"focus",value:function(){this.spoofMouse()}},{key:"keyboardEvent",value:function(r){if(this.coordinateList.length!==0)switch(r.key){case"ArrowRight":{if(this.layout!=="horizontal")return;this.activeIndex=Math.min(this.activeIndex+1,this.coordinateList.length-1),this.spoofMouse();break}case"ArrowLeft":{if(this.layout!=="horizontal")return;this.activeIndex=Math.max(this.activeIndex-1,0),this.spoofMouse();break}}}},{key:"setIndex",value:function(r){this.activeIndex=r}},{key:"spoofMouse",value:function(){var r,n;if(this.layout==="horizontal"&&this.coordinateList.length!==0){var a=this.container.getBoundingClientRect(),i=a.x,s=a.y,o=a.height,c=this.coordinateList[this.activeIndex].coordinate,u=((r=window)===null||r===void 0?void 0:r.scrollX)||0,d=((n=window)===null||n===void 0?void 0:n.scrollY)||0,h=i+c+u,p=s+this.offset.top+o/2+d;this.mouseHandlerCallback({pageX:h,pageY:p})}}}]),e})();function Ble(e,t,r){if(r==="number"&&t===!0&&Array.isArray(e)){var n=e==null?void 0:e[0],a=e==null?void 0:e[1];if(n&&a&&ot(n)&&ot(a))return!0}return!1}function $le(e,t,r,n){var a=n/2;return{stroke:"none",fill:"#ccc",x:e==="horizontal"?t.x-a:r.left+.5,y:e==="horizontal"?r.top+.5:t.y-a,width:e==="horizontal"?n:r.width-1,height:e==="horizontal"?r.height-1:n}}function tD(e){var t=e.cx,r=e.cy,n=e.radius,a=e.startAngle,i=e.endAngle,s=xr(t,r,n,a),o=xr(t,r,n,i);return{points:[s,o],cx:t,cy:r,radius:n,startAngle:a,endAngle:i}}function Ule(e,t,r){var n,a,i,s;if(e==="horizontal")n=t.x,i=n,a=r.top,s=r.top+r.height;else if(e==="vertical")a=t.y,s=a,n=r.left,i=r.left+r.width;else if(t.cx!=null&&t.cy!=null)if(e==="centric"){var o=t.cx,c=t.cy,u=t.innerRadius,d=t.outerRadius,h=t.angle,p=xr(o,c,u,h),v=xr(o,c,d,h);n=p.x,a=p.y,i=v.x,s=v.y}else return tD(t);return[{x:n,y:a},{x:i,y:s}]}function Lf(e){"@babel/helpers - typeof";return Lf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Lf(e)}function NN(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function $d(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?NN(Object(r),!0).forEach(function(n){zle(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):NN(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function zle(e,t,r){return t=Wle(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Wle(e){var t=Hle(e,"string");return Lf(t)=="symbol"?t:String(t)}function Hle(e,t){if(Lf(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Lf(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function qle(e){var t=e.element,r=e.tooltipEventType,n=e.isActive,a=e.activeCoordinate,i=e.activePayload,s=e.offset,o=e.activeTooltipIndex,c=e.tooltipAxisBandSize,u=e.layout,d=e.chartName;if(!t||!t.props.cursor||!n||!a||d!=="ScatterChart"&&r!=="axis")return null;var h,p=bw;if(d==="ScatterChart")h=a,p=sse;else if(d==="BarChart")h=$le(u,a,s,c),p=M_;else if(u==="radial"){var v=tD(a),x=v.cx,w=v.cy,y=v.radius,_=v.startAngle,S=v.endAngle;h={cx:x,cy:w,startAngle:_,endAngle:S,innerRadius:y,outerRadius:y},p=j_}else h={points:Ule(u,a,s)},p=bw;var k=$d($d($d($d({stroke:"#ccc",pointerEvents:"none"},s),h),Mt(t.props.cursor,!1)),{},{payload:i,payloadIndex:o,className:Qt("recharts-tooltip-cursor",t.props.cursor.className)});return D.isValidElement(t.props.cursor)?D.cloneElement(t.props.cursor,k):D.createElement(p,k)}var Vle=["item"],Xle=["children","className","width","height","style","compact","title","desc"];function lc(e){"@babel/helpers - typeof";return lc=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},lc(e)}function Ru(){return Ru=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Ru.apply(this,arguments)}function PN(e,t){return Yle(e)||Kle(e,t)||nD(e,t)||Gle()}function Gle(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Kle(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,a,i,s,o=[],c=!0,u=!1;try{if(i=(r=r.call(e)).next,t!==0)for(;!(c=(n=i.call(r)).done)&&(o.push(n.value),o.length!==t);c=!0);}catch(d){u=!0,a=d}finally{try{if(!c&&r.return!=null&&(s=r.return(),Object(s)!==s))return}finally{if(u)throw a}}return o}}function Yle(e){if(Array.isArray(e))return e}function IN(e,t){if(e==null)return{};var r=Zle(e,t),n,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function Zle(e,t){if(e==null)return{};var r={},n=Object.keys(e),a,i;for(i=0;i<n.length;i++)a=n[i],!(t.indexOf(a)>=0)&&(r[a]=e[a]);return r}function Qle(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Jle(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,aD(n.key),n)}}function ece(e,t,r){return t&&Jle(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function tce(e,t,r){return t=Xh(t),rce(e,rD()?Reflect.construct(t,r||[],Xh(e).constructor):t.apply(e,r))}function rce(e,t){if(t&&(lc(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Gt(e)}function rD(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(rD=function(){return!!e})()}function Xh(e){return Xh=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Xh(e)}function Gt(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function nce(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Ww(e,t)}function Ww(e,t){return Ww=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},Ww(e,t)}function cc(e){return sce(e)||ice(e)||nD(e)||ace()}function ace(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function nD(e,t){if(e){if(typeof e=="string")return Hw(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Hw(e,t)}}function ice(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function sce(e){if(Array.isArray(e))return Hw(e)}function Hw(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function FN(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Le(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?FN(Object(r),!0).forEach(function(n){Et(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):FN(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Et(e,t,r){return t=aD(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function aD(e){var t=oce(e,"string");return lc(t)=="symbol"?t:String(t)}function oce(e,t){if(lc(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(lc(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var lce={xAxis:["bottom","top"],yAxis:["left","right"]},cce={width:"100%",height:"100%"},iD={x:0,y:0};function Ud(e){return e}var uce=function(t,r){return r==="horizontal"?t.x:r==="vertical"?t.y:r==="centric"?t.angle:t.radius},fce=function(t,r,n,a){var i=r.find(function(d){return d&&d.index===n});if(i){if(t==="horizontal")return{x:i.coordinate,y:a.y};if(t==="vertical")return{x:a.x,y:i.coordinate};if(t==="centric"){var s=i.coordinate,o=a.radius;return Le(Le(Le({},a),xr(a.cx,a.cy,o,s)),{},{angle:s,radius:o})}var c=i.coordinate,u=a.angle;return Le(Le(Le({},a),xr(a.cx,a.cy,c,u)),{},{angle:u,radius:c})}return iD},Vp=function(t,r){var n=r.graphicalItems,a=r.dataStartIndex,i=r.dataEndIndex,s=(n??[]).reduce(function(o,c){var u=c.props.data;return u&&u.length?[].concat(cc(o),cc(u)):o},[]);return s.length>0?s:t&&t.length&&ot(a)&&ot(i)?t.slice(a,i+1):[]};function sD(e){return e==="number"?[0,"auto"]:void 0}var qw=function(t,r,n,a){var i=t.graphicalItems,s=t.tooltipAxis,o=Vp(r,t);return n<0||!i||!i.length||n>=o.length?null:i.reduce(function(c,u){var d,h=(d=u.props.data)!==null&&d!==void 0?d:r;h&&t.dataStartIndex+t.dataEndIndex!==0&&(h=h.slice(t.dataStartIndex,t.dataEndIndex+1));var p;if(s.dataKey&&!s.allowDuplicatedCategory){var v=h===void 0?o:h;p=D2(v,s.dataKey,a)}else p=h&&h[n]||o[n];return p?[].concat(cc(c),[qre(u,p)]):c},[])},DN=function(t,r,n,a){var i=a||{x:t.chartX,y:t.chartY},s=uce(i,n),o=t.orderedTooltipTicks,c=t.tooltipAxis,u=t.tooltipTicks,d=Ore(s,o,u,c);if(d>=0&&u){var h=u[d]&&u[d].value,p=qw(t,r,d,h),v=fce(n,o,d,i);return{activeTooltipIndex:d,activeLabel:h,activePayload:p,activeCoordinate:v}}return null},dce=function(t,r){var n=r.axes,a=r.graphicalItems,i=r.axisType,s=r.axisIdKey,o=r.stackGroups,c=r.dataStartIndex,u=r.dataEndIndex,d=t.layout,h=t.children,p=t.stackOffset,v=SF(d,i);return n.reduce(function(x,w){var y,_=w.props,S=_.type,k=_.dataKey,E=_.allowDataOverflow,T=_.allowDuplicatedCategory,N=_.scale,C=_.ticks,P=_.includeHidden,j=w.props[s];if(x[j])return x;var R=Vp(t.data,{graphicalItems:a.filter(function(ee){return ee.props[s]===j}),dataStartIndex:c,dataEndIndex:u}),I=R.length,F,L,H;Ble(w.props.domain,E,S)&&(F=mw(w.props.domain,null,E),v&&(S==="number"||N!=="auto")&&(H=Iu(R,k,"category")));var V=sD(S);if(!F||F.length===0){var J,te=(J=w.props.domain)!==null&&J!==void 0?J:V;if(k){if(F=Iu(R,k,S),S==="category"&&v){var q=FG(F);T&&q?(L=F,F=Hh(0,I)):T||(F=q3(te,F,w).reduce(function(ee,ce){return ee.indexOf(ce)>=0?ee:[].concat(cc(ee),[ce])},[]))}else if(S==="category")T?F=F.filter(function(ee){return ee!==""&&!Vt(ee)}):F=q3(te,F,w).reduce(function(ee,ce){return ee.indexOf(ce)>=0||ce===""||Vt(ce)?ee:[].concat(cc(ee),[ce])},[]);else if(S==="number"){var oe=Dre(R,a.filter(function(ee){return ee.props[s]===j&&(P||!ee.props.hide)}),k,i,d);oe&&(F=oe)}v&&(S==="number"||N!=="auto")&&(H=Iu(R,k,"category"))}else v?F=Hh(0,I):o&&o[j]&&o[j].hasStack&&S==="number"?F=p==="expand"?[0,1]:kF(o[j].stackGroups,c,u):F=_F(R,a.filter(function(ee){return ee.props[s]===j&&(P||!ee.props.hide)}),S,d,!0);if(S==="number")F=zw(h,F,j,i,C),te&&(F=mw(te,F,E));else if(S==="category"&&te){var Q=te,Z=F.every(function(ee){return Q.indexOf(ee)>=0});Z&&(F=Q)}}return Le(Le({},x),{},Et({},j,Le(Le({},w.props),{},{axisType:i,domain:F,categoricalDomain:H,duplicateDomain:L,originalDomain:(y=w.props.domain)!==null&&y!==void 0?y:V,isCategorical:v,layout:d})))},{})},hce=function(t,r){var n=r.graphicalItems,a=r.Axis,i=r.axisType,s=r.axisIdKey,o=r.stackGroups,c=r.dataStartIndex,u=r.dataEndIndex,d=t.layout,h=t.children,p=Vp(t.data,{graphicalItems:n,dataStartIndex:c,dataEndIndex:u}),v=p.length,x=SF(d,i),w=-1;return n.reduce(function(y,_){var S=_.props[s],k=sD("number");if(!y[S]){w++;var E;return x?E=Hh(0,v):o&&o[S]&&o[S].hasStack?(E=kF(o[S].stackGroups,c,u),E=zw(h,E,S,i)):(E=mw(k,_F(p,n.filter(function(T){return T.props[s]===S&&!T.props.hide}),"number",d),a.defaultProps.allowDataOverflow),E=zw(h,E,S,i)),Le(Le({},y),{},Et({},S,Le(Le({axisType:i},a.defaultProps),{},{hide:!0,orientation:ui(lce,"".concat(i,".").concat(w%2),null),domain:E,originalDomain:k,isCategorical:x,layout:d})))}return y},{})},pce=function(t,r){var n=r.axisType,a=n===void 0?"xAxis":n,i=r.AxisComp,s=r.graphicalItems,o=r.stackGroups,c=r.dataStartIndex,u=r.dataEndIndex,d=t.children,h="".concat(a,"Id"),p=Ai(d,i),v={};return p&&p.length?v=dce(t,{axes:p,graphicalItems:s,axisType:a,axisIdKey:h,stackGroups:o,dataStartIndex:c,dataEndIndex:u}):s&&s.length&&(v=hce(t,{Axis:i,graphicalItems:s,axisType:a,axisIdKey:h,stackGroups:o,dataStartIndex:c,dataEndIndex:u})),v},mce=function(t){var r=Cl(t),n=vu(r,!1,!0);return{tooltipTicks:n,orderedTooltipTicks:i_(n,function(a){return a.coordinate}),tooltipAxis:r,tooltipAxisBandSize:vw(r,n)}},jN=function(t){var r=t.children,n=t.defaultShowTooltip,a=Ma(r,oc),i=0,s=0;return t.data&&t.data.length!==0&&(s=t.data.length-1),a&&a.props&&(a.props.startIndex>=0&&(i=a.props.startIndex),a.props.endIndex>=0&&(s=a.props.endIndex)),{chartX:0,chartY:0,dataStartIndex:i,dataEndIndex:s,activeTooltipIndex:-1,isTooltipActive:!!n}},vce=function(t){return!t||!t.length?!1:t.some(function(r){var n=rs(r&&r.type);return n&&n.indexOf("Bar")>=0})},RN=function(t){return t==="horizontal"?{numericAxisName:"yAxis",cateAxisName:"xAxis"}:t==="vertical"?{numericAxisName:"xAxis",cateAxisName:"yAxis"}:t==="centric"?{numericAxisName:"radiusAxis",cateAxisName:"angleAxis"}:{numericAxisName:"angleAxis",cateAxisName:"radiusAxis"}},gce=function(t,r){var n=t.props,a=t.graphicalItems,i=t.xAxisMap,s=i===void 0?{}:i,o=t.yAxisMap,c=o===void 0?{}:o,u=n.width,d=n.height,h=n.children,p=n.margin||{},v=Ma(h,oc),x=Ma(h,nf),w=Object.keys(c).reduce(function(T,N){var C=c[N],P=C.orientation;return!C.mirror&&!C.hide?Le(Le({},T),{},Et({},P,T[P]+C.width)):T},{left:p.left||0,right:p.right||0}),y=Object.keys(s).reduce(function(T,N){var C=s[N],P=C.orientation;return!C.mirror&&!C.hide?Le(Le({},T),{},Et({},P,ui(T,"".concat(P))+C.height)):T},{top:p.top||0,bottom:p.bottom||0}),_=Le(Le({},y),w),S=_.bottom;v&&(_.bottom+=v.props.height||oc.defaultProps.height),x&&r&&(_=Ire(_,a,n,r));var k=u-_.left-_.right,E=d-_.top-_.bottom;return Le(Le({brushBottom:S},_),{},{width:Math.max(k,0),height:Math.max(E,0)})},xce=function(t,r){if(r==="xAxis")return t[r].width;if(r==="yAxis")return t[r].height},yce=function(t){var r,n=t.chartName,a=t.GraphicalChild,i=t.defaultTooltipEventType,s=i===void 0?"axis":i,o=t.validateTooltipEventTypes,c=o===void 0?["axis"]:o,u=t.axisComponents,d=t.legendContent,h=t.formatAxisMap,p=t.defaultProps,v=function(y,_){var S=_.graphicalItems,k=_.stackGroups,E=_.offset,T=_.updateId,N=_.dataStartIndex,C=_.dataEndIndex,P=y.barSize,j=y.layout,R=y.barGap,I=y.barCategoryGap,F=y.maxBarSize,L=RN(j),H=L.numericAxisName,V=L.cateAxisName,J=vce(S),te=[];return S.forEach(function(q,oe){var Q=Vp(y.data,{graphicalItems:[q],dataStartIndex:N,dataEndIndex:C}),Z=q.props,ee=Z.dataKey,ce=Z.maxBarSize,de=q.props["".concat(H,"Id")],Te=q.props["".concat(V,"Id")],Ie={},Ne=u.reduce(function(xt,mt){var Ee=_["".concat(mt.axisType,"Map")],ve=q.props["".concat(mt.axisType,"Id")];Ee&&Ee[ve]||mt.axisType==="zAxis"||tc();var fe=Ee[ve];return Le(Le({},xt),{},Et(Et({},mt.axisType,fe),"".concat(mt.axisType,"Ticks"),vu(fe)))},Ie),W=Ne[V],z=Ne["".concat(V,"Ticks")],G=k&&k[de]&&k[de].hasStack&&Wre(q,k[de].stackGroups),X=rs(q.type).indexOf("Bar")>=0,ie=vw(W,z),M=[],le=J&&Nre({barSize:P,stackGroups:k,totalSize:xce(Ne,V)});if(X){var ye,Ce,ze=Vt(ce)?F:ce,Ze=(ye=(Ce=vw(W,z,!0))!==null&&Ce!==void 0?Ce:ze)!==null&&ye!==void 0?ye:0;M=Pre({barGap:R,barCategoryGap:I,bandSize:Ze!==ie?Ze:ie,sizeList:le[Te],maxBarSize:ze}),Ze!==ie&&(M=M.map(function(xt){return Le(Le({},xt),{},{position:Le(Le({},xt.position),{},{offset:xt.position.offset-Ze/2})})}))}var rt=q&&q.type&&q.type.getComposedData;rt&&te.push({props:Le(Le({},rt(Le(Le({},Ne),{},{displayedData:Q,props:y,dataKey:ee,item:q,bandSize:ie,barPosition:M,offset:E,stackedData:G,layout:j,dataStartIndex:N,dataEndIndex:C}))),{},Et(Et(Et({key:q.key||"item-".concat(oe)},H,Ne[H]),V,Ne[V]),"animationId",T)),childIndex:HG(q,y.children),item:q})}),te},x=function(y,_){var S=y.props,k=y.dataStartIndex,E=y.dataEndIndex,T=y.updateId;if(!s5({props:S}))return null;var N=S.children,C=S.layout,P=S.stackOffset,j=S.data,R=S.reverseStackOrder,I=RN(C),F=I.numericAxisName,L=I.cateAxisName,H=Ai(N,a),V=Ure(j,H,"".concat(F,"Id"),"".concat(L,"Id"),P,R),J=u.reduce(function(Z,ee){var ce="".concat(ee.axisType,"Map");return Le(Le({},Z),{},Et({},ce,pce(S,Le(Le({},ee),{},{graphicalItems:H,stackGroups:ee.axisType===F&&V,dataStartIndex:k,dataEndIndex:E}))))},{}),te=gce(Le(Le({},J),{},{props:S,graphicalItems:H}),_==null?void 0:_.legendBBox);Object.keys(J).forEach(function(Z){J[Z]=h(S,J[Z],te,Z.replace("Map",""),n)});var q=J["".concat(L,"Map")],oe=mce(q),Q=v(S,Le(Le({},J),{},{dataStartIndex:k,dataEndIndex:E,updateId:T,graphicalItems:H,stackGroups:V,offset:te}));return Le(Le({formattedGraphicalItems:Q,graphicalItems:H,offset:te,stackGroups:V},oe),J)};return r=(function(w){nce(y,w);function y(_){var S,k,E;return Qle(this,y),E=tce(this,y,[_]),Et(Gt(E),"eventEmitterSymbol",Symbol("rechartsEventEmitter")),Et(Gt(E),"accessibilityManager",new Lle),Et(Gt(E),"handleLegendBBoxUpdate",function(T){if(T){var N=E.state,C=N.dataStartIndex,P=N.dataEndIndex,j=N.updateId;E.setState(Le({legendBBox:T},x({props:E.props,dataStartIndex:C,dataEndIndex:P,updateId:j},Le(Le({},E.state),{},{legendBBox:T}))))}}),Et(Gt(E),"handleReceiveSyncEvent",function(T,N,C){if(E.props.syncId===T){if(C===E.eventEmitterSymbol&&typeof E.props.syncMethod!="function")return;E.applySyncEvent(N)}}),Et(Gt(E),"handleBrushChange",function(T){var N=T.startIndex,C=T.endIndex;if(N!==E.state.dataStartIndex||C!==E.state.dataEndIndex){var P=E.state.updateId;E.setState(function(){return Le({dataStartIndex:N,dataEndIndex:C},x({props:E.props,dataStartIndex:N,dataEndIndex:C,updateId:P},E.state))}),E.triggerSyncEvent({dataStartIndex:N,dataEndIndex:C})}}),Et(Gt(E),"handleMouseEnter",function(T){var N=E.getMouseInfo(T);if(N){var C=Le(Le({},N),{},{isTooltipActive:!0});E.setState(C),E.triggerSyncEvent(C);var P=E.props.onMouseEnter;$t(P)&&P(C,T)}}),Et(Gt(E),"triggeredAfterMouseMove",function(T){var N=E.getMouseInfo(T),C=N?Le(Le({},N),{},{isTooltipActive:!0}):{isTooltipActive:!1};E.setState(C),E.triggerSyncEvent(C);var P=E.props.onMouseMove;$t(P)&&P(C,T)}),Et(Gt(E),"handleItemMouseEnter",function(T){E.setState(function(){return{isTooltipActive:!0,activeItem:T,activePayload:T.tooltipPayload,activeCoordinate:T.tooltipPosition||{x:T.cx,y:T.cy}}})}),Et(Gt(E),"handleItemMouseLeave",function(){E.setState(function(){return{isTooltipActive:!1}})}),Et(Gt(E),"handleMouseMove",function(T){T.persist(),E.throttleTriggeredAfterMouseMove(T)}),Et(Gt(E),"handleMouseLeave",function(T){E.throttleTriggeredAfterMouseMove.cancel();var N={isTooltipActive:!1};E.setState(N),E.triggerSyncEvent(N);var C=E.props.onMouseLeave;$t(C)&&C(N,T)}),Et(Gt(E),"handleOuterEvent",function(T){var N=WG(T),C=ui(E.props,"".concat(N));if(N&&$t(C)){var P,j;/.*touch.*/i.test(N)?j=E.getMouseInfo(T.changedTouches[0]):j=E.getMouseInfo(T),C((P=j)!==null&&P!==void 0?P:{},T)}}),Et(Gt(E),"handleClick",function(T){var N=E.getMouseInfo(T);if(N){var C=Le(Le({},N),{},{isTooltipActive:!0});E.setState(C),E.triggerSyncEvent(C);var P=E.props.onClick;$t(P)&&P(C,T)}}),Et(Gt(E),"handleMouseDown",function(T){var N=E.props.onMouseDown;if($t(N)){var C=E.getMouseInfo(T);N(C,T)}}),Et(Gt(E),"handleMouseUp",function(T){var N=E.props.onMouseUp;if($t(N)){var C=E.getMouseInfo(T);N(C,T)}}),Et(Gt(E),"handleTouchMove",function(T){T.changedTouches!=null&&T.changedTouches.length>0&&E.throttleTriggeredAfterMouseMove(T.changedTouches[0])}),Et(Gt(E),"handleTouchStart",function(T){T.changedTouches!=null&&T.changedTouches.length>0&&E.handleMouseDown(T.changedTouches[0])}),Et(Gt(E),"handleTouchEnd",function(T){T.changedTouches!=null&&T.changedTouches.length>0&&E.handleMouseUp(T.changedTouches[0])}),Et(Gt(E),"triggerSyncEvent",function(T){E.props.syncId!==void 0&&Jy.emit(e2,E.props.syncId,T,E.eventEmitterSymbol)}),Et(Gt(E),"applySyncEvent",function(T){var N=E.props,C=N.layout,P=N.syncMethod,j=E.state.updateId,R=T.dataStartIndex,I=T.dataEndIndex;if(T.dataStartIndex!==void 0||T.dataEndIndex!==void 0)E.setState(Le({dataStartIndex:R,dataEndIndex:I},x({props:E.props,dataStartIndex:R,dataEndIndex:I,updateId:j},E.state)));else if(T.activeTooltipIndex!==void 0){var F=T.chartX,L=T.chartY,H=T.activeTooltipIndex,V=E.state,J=V.offset,te=V.tooltipTicks;if(!J)return;if(typeof P=="function")H=P(te,T);else if(P==="value"){H=-1;for(var q=0;q<te.length;q++)if(te[q].value===T.activeLabel){H=q;break}}var oe=Le(Le({},J),{},{x:J.left,y:J.top}),Q=Math.min(F,oe.x+oe.width),Z=Math.min(L,oe.y+oe.height),ee=te[H]&&te[H].value,ce=qw(E.state,E.props.data,H),de=te[H]?{x:C==="horizontal"?te[H].coordinate:Q,y:C==="horizontal"?Z:te[H].coordinate}:iD;E.setState(Le(Le({},T),{},{activeLabel:ee,activeCoordinate:de,activePayload:ce,activeTooltipIndex:H}))}else E.setState(T)}),Et(Gt(E),"renderCursor",function(T){var N,C=E.state,P=C.isTooltipActive,j=C.activeCoordinate,R=C.activePayload,I=C.offset,F=C.activeTooltipIndex,L=C.tooltipAxisBandSize,H=E.getTooltipEventType(),V=(N=T.props.active)!==null&&N!==void 0?N:P,J=E.props.layout,te=T.key||"_recharts-cursor";return me.createElement(qle,{key:te,activeCoordinate:j,activePayload:R,activeTooltipIndex:F,chartName:n,element:T,isActive:V,layout:J,offset:I,tooltipAxisBandSize:L,tooltipEventType:H})}),Et(Gt(E),"renderPolarAxis",function(T,N,C){var P=ui(T,"type.axisType"),j=ui(E.state,"".concat(P,"Map")),R=j&&j[T.props["".concat(P,"Id")]];return D.cloneElement(T,Le(Le({},R),{},{className:Qt(P,R.className),key:T.key||"".concat(N,"-").concat(C),ticks:vu(R,!0)}))}),Et(Gt(E),"renderPolarGrid",function(T){var N=T.props,C=N.radialLines,P=N.polarAngles,j=N.polarRadius,R=E.state,I=R.radiusAxisMap,F=R.angleAxisMap,L=Cl(I),H=Cl(F),V=H.cx,J=H.cy,te=H.innerRadius,q=H.outerRadius;return D.cloneElement(T,{polarAngles:Array.isArray(P)?P:vu(H,!0).map(function(oe){return oe.coordinate}),polarRadius:Array.isArray(j)?j:vu(L,!0).map(function(oe){return oe.coordinate}),cx:V,cy:J,innerRadius:te,outerRadius:q,key:T.key||"polar-grid",radialLines:C})}),Et(Gt(E),"renderLegend",function(){var T=E.state.formattedGraphicalItems,N=E.props,C=N.children,P=N.width,j=N.height,R=E.props.margin||{},I=P-(R.left||0)-(R.right||0),F=wF({children:C,formattedGraphicalItems:T,legendWidth:I,legendContent:d});if(!F)return null;var L=F.item,H=IN(F,Vle);return D.cloneElement(L,Le(Le({},H),{},{chartWidth:P,chartHeight:j,margin:R,onBBoxUpdate:E.handleLegendBBoxUpdate}))}),Et(Gt(E),"renderTooltip",function(){var T,N=E.props,C=N.children,P=N.accessibilityLayer,j=Ma(C,qi);if(!j)return null;var R=E.state,I=R.isTooltipActive,F=R.activeCoordinate,L=R.activePayload,H=R.activeLabel,V=R.offset,J=(T=j.props.active)!==null&&T!==void 0?T:I;return D.cloneElement(j,{viewBox:Le(Le({},V),{},{x:V.left,y:V.top}),active:J,label:H,payload:J?L:[],coordinate:F,accessibilityLayer:P})}),Et(Gt(E),"renderBrush",function(T){var N=E.props,C=N.margin,P=N.data,j=E.state,R=j.offset,I=j.dataStartIndex,F=j.dataEndIndex,L=j.updateId;return D.cloneElement(T,{key:T.key||"_recharts-brush",onChange:jd(E.handleBrushChange,T.props.onChange),data:P,x:ot(T.props.x)?T.props.x:R.left,y:ot(T.props.y)?T.props.y:R.top+R.height+R.brushBottom-(C.bottom||0),width:ot(T.props.width)?T.props.width:R.width,startIndex:I,endIndex:F,updateId:"brush-".concat(L)})}),Et(Gt(E),"renderReferenceElement",function(T,N,C){if(!T)return null;var P=Gt(E),j=P.clipPathId,R=E.state,I=R.xAxisMap,F=R.yAxisMap,L=R.offset,H=T.props,V=H.xAxisId,J=H.yAxisId;return D.cloneElement(T,{key:T.key||"".concat(N,"-").concat(C),xAxis:I[V],yAxis:F[J],viewBox:{x:L.left,y:L.top,width:L.width,height:L.height},clipPathId:j})}),Et(Gt(E),"renderActivePoints",function(T){var N=T.item,C=T.activePoint,P=T.basePoint,j=T.childIndex,R=T.isRange,I=[],F=N.props.key,L=N.item.props,H=L.activeDot,V=L.dataKey,J=Le(Le({index:j,dataKey:V,cx:C.x,cy:C.y,r:4,fill:D_(N.item),strokeWidth:2,stroke:"#fff",payload:C.payload,value:C.value,key:"".concat(F,"-activePoint-").concat(j)},Mt(H,!1)),uh(H));return I.push(y.renderActiveDot(H,J)),P?I.push(y.renderActiveDot(H,Le(Le({},J),{},{cx:P.x,cy:P.y,key:"".concat(F,"-basePoint-").concat(j)}))):R&&I.push(null),I}),Et(Gt(E),"renderGraphicChild",function(T,N,C){var P=E.filterFormatItem(T,N,C);if(!P)return null;var j=E.getTooltipEventType(),R=E.state,I=R.isTooltipActive,F=R.tooltipAxis,L=R.activeTooltipIndex,H=R.activeLabel,V=E.props.children,J=Ma(V,qi),te=P.props,q=te.points,oe=te.isRange,Q=te.baseLine,Z=P.item.props,ee=Z.activeDot,ce=Z.hide,de=Z.activeBar,Te=Z.activeShape,Ie=!!(!ce&&I&&J&&(ee||de||Te)),Ne={};j!=="axis"&&J&&J.props.trigger==="click"?Ne={onClick:jd(E.handleItemMouseEnter,T.props.onClick)}:j!=="axis"&&(Ne={onMouseLeave:jd(E.handleItemMouseLeave,T.props.onMouseLeave),onMouseEnter:jd(E.handleItemMouseEnter,T.props.onMouseEnter)});var W=D.cloneElement(T,Le(Le({},P.props),Ne));function z(mt){return typeof F.dataKey=="function"?F.dataKey(mt.payload):null}if(Ie)if(L>=0){var G,X;if(F.dataKey&&!F.allowDuplicatedCategory){var ie=typeof F.dataKey=="function"?z:"payload.".concat(F.dataKey.toString());G=D2(q,ie,H),X=oe&&Q&&D2(Q,ie,H)}else G=q==null?void 0:q[L],X=oe&&Q&&Q[L];if(Te||de){var M=T.props.activeIndex!==void 0?T.props.activeIndex:L;return[D.cloneElement(T,Le(Le(Le({},P.props),Ne),{},{activeIndex:M})),null,null]}if(!Vt(G))return[W].concat(cc(E.renderActivePoints({item:P,activePoint:G,basePoint:X,childIndex:L,isRange:oe})))}else{var le,ye=(le=E.getItemByXY(E.state.activeCoordinate))!==null&&le!==void 0?le:{graphicalItem:W},Ce=ye.graphicalItem,ze=Ce.item,Ze=ze===void 0?T:ze,rt=Ce.childIndex,xt=Le(Le(Le({},P.props),Ne),{},{activeIndex:rt});return[D.cloneElement(Ze,xt),null,null]}return oe?[W,null,null]:[W,null]}),Et(Gt(E),"renderCustomized",function(T,N,C){return D.cloneElement(T,Le(Le({key:"recharts-customized-".concat(C)},E.props),E.state))}),Et(Gt(E),"renderMap",{CartesianGrid:{handler:Ud,once:!0},ReferenceArea:{handler:E.renderReferenceElement},ReferenceLine:{handler:Ud},ReferenceDot:{handler:E.renderReferenceElement},XAxis:{handler:Ud},YAxis:{handler:Ud},Brush:{handler:E.renderBrush,once:!0},Bar:{handler:E.renderGraphicChild},Line:{handler:E.renderGraphicChild},Area:{handler:E.renderGraphicChild},Radar:{handler:E.renderGraphicChild},RadialBar:{handler:E.renderGraphicChild},Scatter:{handler:E.renderGraphicChild},Pie:{handler:E.renderGraphicChild},Funnel:{handler:E.renderGraphicChild},Tooltip:{handler:E.renderCursor,once:!0},PolarGrid:{handler:E.renderPolarGrid,once:!0},PolarAngleAxis:{handler:E.renderPolarAxis},PolarRadiusAxis:{handler:E.renderPolarAxis},Customized:{handler:E.renderCustomized}}),E.clipPathId="".concat((S=_.id)!==null&&S!==void 0?S:xp("recharts"),"-clip"),E.throttleTriggeredAfterMouseMove=_8(E.triggeredAfterMouseMove,(k=_.throttleDelay)!==null&&k!==void 0?k:1e3/60),E.state={},E}return ece(y,[{key:"componentDidMount",value:function(){var S,k;this.addListener(),this.accessibilityManager.setDetails({container:this.container,offset:{left:(S=this.props.margin.left)!==null&&S!==void 0?S:0,top:(k=this.props.margin.top)!==null&&k!==void 0?k:0},coordinateList:this.state.tooltipTicks,mouseHandlerCallback:this.triggeredAfterMouseMove,layout:this.props.layout}),this.displayDefaultTooltip()}},{key:"displayDefaultTooltip",value:function(){var S=this.props,k=S.children,E=S.data,T=S.height,N=S.layout,C=Ma(k,qi);if(C){var P=C.props.defaultIndex;if(!(typeof P!="number"||P<0||P>this.state.tooltipTicks.length)){var j=this.state.tooltipTicks[P]&&this.state.tooltipTicks[P].value,R=qw(this.state,E,P,j),I=this.state.tooltipTicks[P].coordinate,F=(this.state.offset.top+T)/2,L=N==="horizontal",H=L?{x:I,y:F}:{y:I,x:F},V=this.state.formattedGraphicalItems.find(function(te){var q=te.item;return q.type.name==="Scatter"});V&&(H=Le(Le({},H),V.props.points[P].tooltipPosition),R=V.props.points[P].tooltipPayload);var J={activeTooltipIndex:P,isTooltipActive:!0,activeLabel:j,activePayload:R,activeCoordinate:H};this.setState(J),this.renderCursor(C),this.accessibilityManager.setIndex(P)}}}},{key:"getSnapshotBeforeUpdate",value:function(S,k){if(!this.props.accessibilityLayer)return null;if(this.state.tooltipTicks!==k.tooltipTicks&&this.accessibilityManager.setDetails({coordinateList:this.state.tooltipTicks}),this.props.layout!==S.layout&&this.accessibilityManager.setDetails({layout:this.props.layout}),this.props.margin!==S.margin){var E,T;this.accessibilityManager.setDetails({offset:{left:(E=this.props.margin.left)!==null&&E!==void 0?E:0,top:(T=this.props.margin.top)!==null&&T!==void 0?T:0}})}return null}},{key:"componentDidUpdate",value:function(S){M2([Ma(S.children,qi)],[Ma(this.props.children,qi)])||this.displayDefaultTooltip()}},{key:"componentWillUnmount",value:function(){this.removeListener(),this.throttleTriggeredAfterMouseMove.cancel()}},{key:"getTooltipEventType",value:function(){var S=Ma(this.props.children,qi);if(S&&typeof S.props.shared=="boolean"){var k=S.props.shared?"axis":"item";return c.indexOf(k)>=0?k:s}return s}},{key:"getMouseInfo",value:function(S){if(!this.container)return null;var k=this.container,E=k.getBoundingClientRect(),T=OQ(E),N={chartX:Math.round(S.pageX-T.left),chartY:Math.round(S.pageY-T.top)},C=E.width/k.offsetWidth||1,P=this.inRange(N.chartX,N.chartY,C);if(!P)return null;var j=this.state,R=j.xAxisMap,I=j.yAxisMap,F=this.getTooltipEventType();if(F!=="axis"&&R&&I){var L=Cl(R).scale,H=Cl(I).scale,V=L&&L.invert?L.invert(N.chartX):null,J=H&&H.invert?H.invert(N.chartY):null;return Le(Le({},N),{},{xValue:V,yValue:J})}var te=DN(this.state,this.props.data,this.props.layout,P);return te?Le(Le({},N),te):null}},{key:"inRange",value:function(S,k){var E=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,T=this.props.layout,N=S/E,C=k/E;if(T==="horizontal"||T==="vertical"){var P=this.state.offset,j=N>=P.left&&N<=P.left+P.width&&C>=P.top&&C<=P.top+P.height;return j?{x:N,y:C}:null}var R=this.state,I=R.angleAxisMap,F=R.radiusAxisMap;if(I&&F){var L=Cl(I);return G3({x:N,y:C},L)}return null}},{key:"parseEventsOfWrapper",value:function(){var S=this.props.children,k=this.getTooltipEventType(),E=Ma(S,qi),T={};E&&k==="axis"&&(E.props.trigger==="click"?T={onClick:this.handleClick}:T={onMouseEnter:this.handleMouseEnter,onMouseMove:this.handleMouseMove,onMouseLeave:this.handleMouseLeave,onTouchMove:this.handleTouchMove,onTouchStart:this.handleTouchStart,onTouchEnd:this.handleTouchEnd});var N=uh(this.props,this.handleOuterEvent);return Le(Le({},N),T)}},{key:"addListener",value:function(){Jy.on(e2,this.handleReceiveSyncEvent)}},{key:"removeListener",value:function(){Jy.removeListener(e2,this.handleReceiveSyncEvent)}},{key:"filterFormatItem",value:function(S,k,E){for(var T=this.state.formattedGraphicalItems,N=0,C=T.length;N<C;N++){var P=T[N];if(P.item===S||P.props.key===S.key||k===rs(P.item.type)&&E===P.childIndex)return P}return null}},{key:"renderClipPath",value:function(){var S=this.clipPathId,k=this.state.offset,E=k.left,T=k.top,N=k.height,C=k.width;return me.createElement("defs",null,me.createElement("clipPath",{id:S},me.createElement("rect",{x:E,y:T,height:N,width:C})))}},{key:"getXScales",value:function(){var S=this.state.xAxisMap;return S?Object.entries(S).reduce(function(k,E){var T=PN(E,2),N=T[0],C=T[1];return Le(Le({},k),{},Et({},N,C.scale))},{}):null}},{key:"getYScales",value:function(){var S=this.state.yAxisMap;return S?Object.entries(S).reduce(function(k,E){var T=PN(E,2),N=T[0],C=T[1];return Le(Le({},k),{},Et({},N,C.scale))},{}):null}},{key:"getXScaleByAxisId",value:function(S){var k;return(k=this.state.xAxisMap)===null||k===void 0||(k=k[S])===null||k===void 0?void 0:k.scale}},{key:"getYScaleByAxisId",value:function(S){var k;return(k=this.state.yAxisMap)===null||k===void 0||(k=k[S])===null||k===void 0?void 0:k.scale}},{key:"getItemByXY",value:function(S){var k=this.state,E=k.formattedGraphicalItems,T=k.activeItem;if(E&&E.length)for(var N=0,C=E.length;N<C;N++){var P=E[N],j=P.props,R=P.item,I=rs(R.type);if(I==="Bar"){var F=(j.data||[]).find(function(J){return $ie(S,J)});if(F)return{graphicalItem:P,payload:F}}else if(I==="RadialBar"){var L=(j.data||[]).find(function(J){return G3(S,J)});if(L)return{graphicalItem:P,payload:L}}else if(Hp(P,T)||qp(P,T)||Pf(P,T)){var H=uoe({graphicalItem:P,activeTooltipItem:T,itemData:R.props.data}),V=R.props.activeIndex===void 0?H:R.props.activeIndex;return{graphicalItem:Le(Le({},P),{},{childIndex:V}),payload:Pf(P,T)?R.props.data[H]:P.props.data[H]}}}return null}},{key:"render",value:function(){var S=this;if(!s5(this))return null;var k=this.props,E=k.children,T=k.className,N=k.width,C=k.height,P=k.style,j=k.compact,R=k.title,I=k.desc,F=IN(k,Xle),L=Mt(F,!1);if(j)return me.createElement(wN,{state:this.state,width:this.props.width,height:this.props.height,clipPathId:this.clipPathId},me.createElement(B2,Ru({},L,{width:N,height:C,title:R,desc:I}),this.renderClipPath(),l5(E,this.renderMap)));if(this.props.accessibilityLayer){var H,V;L.tabIndex=(H=this.props.tabIndex)!==null&&H!==void 0?H:0,L.role=(V=this.props.role)!==null&&V!==void 0?V:"application",L.onKeyDown=function(te){S.accessibilityManager.keyboardEvent(te)},L.onFocus=function(){S.accessibilityManager.focus()}}var J=this.parseEventsOfWrapper();return me.createElement(wN,{state:this.state,width:this.props.width,height:this.props.height,clipPathId:this.clipPathId},me.createElement("div",Ru({className:Qt("recharts-wrapper",T),style:Le({position:"relative",cursor:"default",width:N,height:C},P)},J,{ref:function(q){S.container=q}}),me.createElement(B2,Ru({},L,{width:N,height:C,title:R,desc:I,style:cce}),this.renderClipPath(),l5(E,this.renderMap)),this.renderLegend(),this.renderTooltip()))}}]),y})(D.Component),Et(r,"displayName",n),Et(r,"defaultProps",Le({layout:"horizontal",stackOffset:"none",barCategoryGap:"10%",barGap:4,margin:{top:5,right:5,bottom:5,left:5},reverseStackOrder:!1,syncMethod:"index"},p)),Et(r,"getDerivedStateFromProps",function(w,y){var _=w.dataKey,S=w.data,k=w.children,E=w.width,T=w.height,N=w.layout,C=w.stackOffset,P=w.margin,j=y.dataStartIndex,R=y.dataEndIndex;if(y.updateId===void 0){var I=jN(w);return Le(Le(Le({},I),{},{updateId:0},x(Le(Le({props:w},I),{},{updateId:0}),y)),{},{prevDataKey:_,prevData:S,prevWidth:E,prevHeight:T,prevLayout:N,prevStackOffset:C,prevMargin:P,prevChildren:k})}if(_!==y.prevDataKey||S!==y.prevData||E!==y.prevWidth||T!==y.prevHeight||N!==y.prevLayout||C!==y.prevStackOffset||!j2(P,y.prevMargin)){var F=jN(w),L={chartX:y.chartX,chartY:y.chartY,isTooltipActive:y.isTooltipActive},H=Le(Le({},DN(y,S,N)),{},{updateId:y.updateId+1}),V=Le(Le(Le({},F),L),H);return Le(Le(Le({},V),x(Le({props:w},V),y)),{},{prevDataKey:_,prevData:S,prevWidth:E,prevHeight:T,prevLayout:N,prevStackOffset:C,prevMargin:P,prevChildren:k})}if(!M2(k,y.prevChildren)){var J,te,q,oe,Q=Ma(k,oc),Z=Q&&(J=(te=Q.props)===null||te===void 0?void 0:te.startIndex)!==null&&J!==void 0?J:j,ee=Q&&(q=(oe=Q.props)===null||oe===void 0?void 0:oe.endIndex)!==null&&q!==void 0?q:R,ce=Z!==j||ee!==R,de=!Vt(S),Te=de&&!ce?y.updateId:y.updateId+1;return Le(Le({updateId:Te},x(Le(Le({props:w},y),{},{updateId:Te,dataStartIndex:Z,dataEndIndex:ee}),y)),{},{prevChildren:k,dataStartIndex:Z,dataEndIndex:ee})}return null}),Et(r,"renderActiveDot",function(w,y){var _;return D.isValidElement(w)?_=D.cloneElement(w,y):$t(w)?_=w(y):_=me.createElement(L_,y),me.createElement(Fr,{className:"recharts-active-dot",key:y.key},_)}),r},wce=yce({chartName:"PieChart",GraphicalChild:ms,validateTooltipEventTypes:["item"],defaultTooltipEventType:"item",legendContent:"children",axisComponents:[{axisType:"angleAxis",AxisComp:Wp},{axisType:"radiusAxis",AxisComp:Up}],formatAxisMap:ene,defaultProps:{layout:"centric",startAngle:0,endAngle:360,cx:"50%",cy:"50%",innerRadius:0,outerRadius:"80%"}});const Ti=e=>{const t=typeof e=="number"&&!isNaN(e)?e:0,r=t%1===0,n={style:"decimal"};return r?(n.minimumFractionDigits=0,n.maximumFractionDigits=0):(n.minimumFractionDigits=2,n.maximumFractionDigits=2),` ${new Intl.NumberFormat("it-IT",n).format(t)}`},oD=e=>{const t={year:"2-digit",month:"short",day:"numeric"};return new Intl.DateTimeFormat("it-IT",t).formatToParts(e).map(({type:n,value:a})=>n==="month"?`${a}.`:a).join("")},bce=e=>g.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...e,children:g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3.75 6.75h16.5M3.75 12h16.5m-16.5 5.25h16.5"})}),_ce=e=>g.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...e,children:g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M2.25 3h1.386c.51 0 .955.343 1.087.835l.383 1.437M7.5 14.25a3 3 0 0 0-3 3h15.75m-12.75-3h11.218c.51 0 .962-.343 1.087-.835l.383-1.437M7.5 14.25V5.106c0-.612.501-1.106 1.106-1.106H15.894c.612 0 1.106.501 1.106 1.106v9.144M7.5 14.25h6.75"})}),Sce=e=>g.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...e,children:g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M8.25 18.75a1.5 1.5 0 0 1-3 0m3 0a1.5 1.5 0 0 0-3 0m3 0h6m-9 0H3.375a1.125 1.125 0 0 1-1.125-1.125V14.25m17.25 4.5a1.5 1.5 0 0 1-3 0m3 0a1.5 1.5 0 0 0-3 0m3 0h1.125c.621 0 1.125-.504 1.125-1.125V14.25m-17.25 4.5v-1.875a3.375 3.375 0 0 1 3.375-3.375h9.75a3.375 3.375 0 0 1 3.375 3.375v1.875M3.375 14.25v-2.625A3.375 3.375 0 0 1 6.75 8.25h9.75a3.375 3.375 0 0 1 3.375 3.375v2.625m-16.5 0h16.5"})}),kce=e=>g.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...e,children:g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m2.25 12 8.954-8.955c.44-.439 1.152-.439 1.591 0L21.75 12M4.5 9.75v10.125c0 .621.504 1.125 1.125 1.125H9.75v-4.875c0-.621.504-1.125 1.125-1.125h2.25c.621 0 1.125.504 1.125 1.125V21h4.125c.621 0 1.125-.504 1.125-1.125V9.75M8.25 21h8.25"})}),Ece=e=>g.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...e,children:g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15.75 10.5V6a3.75 3.75 0 1 0-7.5 0v4.5m11.356-1.993 1.263 12c.07.658-.463 1.243-1.119 1.243H4.25a1.125 1.125 0 0 1-1.12-1.243l1.264-12A1.125 1.125 0 0 1 5.513 7.5h12.974c.576 0 1.059.435 1.119 1.007ZM8.625 10.5a.375.375 0 1 1-.75 0 .375.375 0 0 1 .75 0Zm7.5 0a.375.375 0 1 1-.75 0 .375.375 0 0 1 .75 0Z"})}),Tce=e=>g.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...e,children:g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 12.75 11.25 15 15 9.75M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"})}),Ace=e=>g.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...e,children:g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M21 8.25c0-2.485-2.099-4.5-4.688-4.5-1.935 0-3.597 1.126-4.312 2.733-.715-1.607-2.377-2.733-4.313-2.733C5.1 3.75 3 5.765 3 8.25c0 7.22 9 12 9 12s9-4.78 9-12Z"})}),Cce=e=>g.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...e,children:[g.jsx("path",{d:"M12 14l9-5-9-5-9 5 9 5z"}),g.jsx("path",{d:"M12 14l6.16-3.422a12.083 12.083 0 01.665 6.479A11.952 11.952 0 0012 20.055a11.952 11.952 0 00-6.824-2.998 12.078 12.078 0 01.665-6.479L12 14z"}),g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 14v6m-6-3.837V11.163m12 0v2.674"})]}),Oce=e=>g.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...e,children:g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M20.25 14.15v4.05a2.25 2.25 0 0 1-2.25 2.25h-15a2.25 2.25 0 0 1-2.25-2.25V8.25a2.25 2.25 0 0 1 2.25-2.25h15.5a2.25 2.25 0 0 1 2.25 2.25v2.15m-15.75-6.04 4.03-3.11a2.25 2.25 0 0 1 2.86 0l4.03 3.11M18 9a3 3 0 1 0-6 0 3 3 0 0 0 6 0Z"})}),Nce=e=>g.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...e,children:g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3.75 6A2.25 2.25 0 0 1 6 3.75h2.25A2.25 2.25 0 0 1 10.5 6v2.25a2.25 2.25 0 0 1-2.25 2.25H6A2.25 2.25 0 0 1 3.75 8.25V6ZM3.75 15.75A2.25 2.25 0 0 1 6 13.5h2.25a2.25 2.25 0 0 1 2.25 2.25v2.25A2.25 2.25 0 0 1 8.25 20.25H6A2.25 2.25 0 0 1 3.75 18v-2.25ZM13.5 6A2.25 2.25 0 0 1 15.75 3.75h2.25A2.25 2.25 0 0 1 20.25 6v2.25a2.25 2.25 0 0 1-2.25 2.25H15.75A2.25 2.25 0 0 1 13.5 8.25V6ZM13.5 15.75A2.25 2.25 0 0 1 15.75 13.5h2.25a2.25 2.25 0 0 1 2.25 2.25v2.25A2.25 2.25 0 0 1 18 20.25h-2.25A2.25 2.25 0 0 1 13.5 18v-2.25Z"})}),MN={all:{label:"Tutte",Icon:bce,color:"text-slate-600",bgColor:"bg-slate-200"},Alimentari:{label:"Alimentari",Icon:_ce,color:"text-green-600",bgColor:"bg-green-100"},Trasporti:{label:"Trasporti",Icon:Sce,color:"text-blue-600",bgColor:"bg-blue-100"},Casa:{label:"Casa",Icon:kce,color:"text-orange-600",bgColor:"bg-orange-100"},Shopping:{label:"Shopping",Icon:Ece,color:"text-pink-600",bgColor:"bg-pink-100"},"Tempo Libero":{label:"Tempo Libero",Icon:Tce,color:"text-purple-600",bgColor:"bg-purple-100"},Salute:{label:"Salute",Icon:Ace,color:"text-red-600",bgColor:"bg-red-100"},Istruzione:{label:"Istruzione",Icon:Cce,color:"text-yellow-600",bgColor:"bg-yellow-100"},Lavoro:{label:"Lavoro",Icon:Oce,color:"text-indigo-600",bgColor:"bg-indigo-100"},Altro:{label:"Altro",Icon:Nce,color:"text-gray-600",bgColor:"bg-gray-200"}},Qr=e=>MN[e]||MN.Altro,lD=e=>g.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...e,children:g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3 7.5L7.5 3m0 0L12 7.5M7.5 3v13.5m13.5 0L16.5 21m0 0L12 16.5m4.5 4.5V7.5"})}),Pce=e=>g.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...e,children:g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3 16.5v2.25A2.25 2.25 0 0 0 5.25 21h13.5A2.25 2.25 0 0 0 21 18.75V16.5M16.5 12 12 16.5m0 0L7.5 12m4.5 4.5V3"})}),Ice=e=>g.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...e,children:g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3 16.5v2.25A2.25 2.25 0 0 0 5.25 21h13.5A2.25 2.25 0 0 0 21 18.75V16.5m-13.5-9L12 3m0 0 4.5 4.5M12 3v13.5"})}),fn=e=>g.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...e,children:g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6 18 18 6M6 6l12 12"})}),us=e=>g.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...e,children:g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M10.5 19.5 3 12m0 0 7.5-7.5M3 12h18"})});function vs(e={}){const t=e.slopPx??10,r=e.tapMs??350,n=D.useRef({id:null,t0:0,x0:0,y0:0,target:null}),a=D.useCallback(()=>{const d=h=>{h.isTrusted&&(h.stopPropagation(),h.preventDefault(),window.removeEventListener("click",d,!0))};window.addEventListener("click",d,{capture:!0,once:!1}),setTimeout(()=>{window.removeEventListener("click",d,!0)},600)},[]),i=D.useCallback(d=>{const h=n.current;h.id!==null&&d.pointerId!==h.id||(h.id=d.pointerId,h.t0=performance.now(),h.x0=d.clientX,h.y0=d.clientY,h.target=d.target)},[]),s=D.useCallback(d=>{n.current.id,d.pointerId},[]),o=D.useCallback(d=>{var _;const h=n.current;if(h.id!==d.pointerId)return;const p=performance.now()-h.t0,v=Math.abs(d.clientX-h.x0),x=Math.abs(d.clientY-h.y0),w=h.target;if(h.id=null,p<r&&v<=t&&x<=t&&w&&!((_=w.closest)!=null&&_.call(w,"[data-no-synthetic-click]"))){d.cancelable&&d.preventDefault(),a(),(w instanceof HTMLInputElement||w instanceof HTMLTextAreaElement||w.isContentEditable)&&document.activeElement!==w&&w.focus();const S=new MouseEvent("click",{bubbles:!0,cancelable:!0,view:window});w.dispatchEvent(S)}h.target=null},[t,r,a]),c=D.useCallback(d=>{const h=n.current;h.id===d.pointerId&&(h.id=null,h.target=null)},[]),u=D.useCallback(d=>{},[]);return{onPointerDown:i,onPointerMove:s,onPointerUp:o,onPointerCancel:c,onClickCapture:u}}const cD=e=>g.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...e,children:g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15.75 19.5 8.25 12l7.5-7.5"})}),Vw=e=>g.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...e,children:g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m8.25 4.5 7.5 7.5-7.5 7.5"})}),Ua=e=>g.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...e,children:g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m19.5 8.25-7.5 7.5-7.5-7.5"})}),Xp=e=>g.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...e,children:g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M2.25 8.25h19.5M2.25 9h19.5m-16.5 5.25h6m-6 2.25h3m-3.75 3h15a2.25 2.25 0 0 0 2.25-2.25V6.75A2.25 2.25 0 0 0 19.5 4.5h-15A2.25 2.25 0 0 0 2.25 6.75v10.5A2.25 2.25 0 0 0 4.5 19.5Z"})}),Bf=e=>g.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...e,children:[g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9.568 3H5.25A2.25 2.25 0 0 0 3 5.25v4.318c0 .597.237 1.17.659 1.591l9.581 9.581c.699.699 1.78.872 2.607.33a18.095 18.095 0 0 0 5.223-5.223c.542-.827.369-1.908-.33-2.607L11.16 3.66A2.25 2.25 0 0 0 9.568 3Z"}),g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6 6h.008v.008H6V6Z"})]}),Xw=e=>g.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...e,children:g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M14.25 7.756a4.5 4.5 0 1 0 0 8.488M7.5 10.5h5.25m-5.25 3h5.25M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"})}),Fce=e=>g.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...e,children:g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m21 21-5.197-5.197m0 0A7.5 7.5 0 1 0 5.196 5.196a7.5 7.5 0 0 0 10.607 10.607Z"})});function uD({width:e=192,height:t=64,fill:r="currentColor",stroke:n="none",strokeWidth:a=0}){const i=Number(e),s=Number(t),o="smooth-pull-tab-shadow-filter",c=i*.35,u=i*.25,d=(i-c)/2,h=d+c,p=[`M 0 ${s}`,`C ${u} ${s}, ${d-u} 0, ${d} 0`,`L ${h} 0`,`C ${h+u} 0, ${i-u} ${s}, ${i} ${s}`,"Z"].join(" ");return g.jsxs("svg",{width:e,height:t,viewBox:`0 0 ${i} ${s}`,xmlns:"http://www.w3.org/2000/svg",role:"img","aria-label":"Linguetta morbida con effetto rilievo",style:{overflow:"visible"},children:[g.jsx("defs",{children:g.jsx("filter",{id:o,x:"-50%",y:"-50%",width:"200%",height:"200%",children:g.jsx("feDropShadow",{dx:"0",dy:"-3",stdDeviation:"2",floodColor:"#475569",floodOpacity:"0.6"})})}),g.jsx("g",{filter:`url(#${o})`,children:g.jsx("path",{d:p,fill:r,stroke:n,strokeWidth:a,vectorEffect:"non-scaling-stroke"})})]})}const Ni=e=>g.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:3,stroke:"currentColor",...e,children:g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m4.5 12.75 6 6 9-13.5"})}),LN=({checked:e,onChange:t})=>g.jsx("div",{className:`w-6 h-6 rounded border flex items-center justify-center transition-colors cursor-pointer ${e?"bg-indigo-600 border-black":"bg-white border-black"}`,onClick:r=>{r.stopPropagation(),t()},onPointerDown:r=>r.stopPropagation(),children:e&&g.jsx(Ni,{className:"w-4 h-4 text-white",strokeWidth:3})}),fD=({onSelect:e,currentValue:t,isActive:r,compact:n,tapBridge:a})=>{const i=[{value:"7d",label:"7G"},{value:"30d",label:"30G"},{value:"6m",label:"6M"},{value:"1y",label:"1A"}];return g.jsx("div",{className:`w-full ${n?"h-8":"h-10"} flex border rounded-lg overflow-hidden transition-colors border-indigo-600`,children:i.map((s,o)=>{const c=r&&t===s.value;return g.jsx("button",{onClick:()=>e(s.value),type:"button","data-no-drag":!0,className:`flex-1 flex items-center justify-center px-2 text-center font-semibold ${n?"text-xs":"text-sm"} transition-colors duration-200 focus:outline-none `+(o>0?"border-l ":"")+(c?"bg-indigo-600 text-white border-indigo-600":`bg-slate-100 text-slate-700 hover:bg-slate-200 ${r?"border-indigo-600":"border-indigo-200"}`),...a,children:s.label},s.value)})})},dD=({range:e,onChange:t,isActive:r,compact:n,tapBridge:a})=>{const i="text-indigo-700",s="text-sm font-semibold",o=d=>{if(!d)return"";const[h,p,v]=d.split("-").map(Number);return new Date(h,p-1,v).toLocaleDateString("it-IT",{day:"numeric",month:"short",year:"2-digit"})},c=(d,h)=>{t({...e,[d]:h||null})},u=d=>{try{typeof d.currentTarget.showPicker=="function"&&d.currentTarget.showPicker()}catch{}};return g.jsxs("div",{className:`w-full ${n?"h-8":"h-10"} flex border rounded-lg overflow-hidden transition-colors relative border-indigo-600 bg-indigo-50`,children:[g.jsxs("label",{className:"relative flex-1 h-full group cursor-pointer block","data-no-drag":!0,children:[g.jsx("div",{className:`absolute inset-0 flex items-center justify-center z-0 pointer-events-none ${s} ${i}`,children:e.start?o(e.start):"Dal"}),g.jsx("input",{type:"date",value:e.start||"",onChange:d=>c("start",d.target.value),onClick:u,onBlur:d=>d.target.blur(),className:"absolute inset-0 w-full h-full opacity-0 z-20 cursor-pointer",style:{touchAction:"none"},...a})]}),g.jsx("div",{className:"w-px my-1 bg-indigo-200"}),g.jsxs("label",{className:"relative flex-1 h-full group cursor-pointer block","data-no-drag":!0,children:[g.jsx("div",{className:`absolute inset-0 flex items-center justify-center z-0 pointer-events-none ${s} ${i}`,children:e.end?o(e.end):"Al"}),g.jsx("input",{type:"date",value:e.end||"",onChange:d=>c("end",d.target.value),onClick:u,onBlur:d=>d.target.blur(),className:"absolute inset-0 w-full h-full opacity-0 z-20 cursor-pointer",style:{touchAction:"none"},...a})]})]})},hD=({periodType:e,periodDate:t,onTypeChange:r,onDateChange:n,isActive:a,onActivate:i,isMenuOpen:s,onMenuToggle:o,isPanelOpen:c,compact:u,tapBridge:d})=>{const h=D.useRef(null);D.useEffect(()=>{const x=w=>{h.current&&!h.current.contains(w.target)&&o(!1)};return s&&document.addEventListener("pointerdown",x,{capture:!0}),()=>{document.removeEventListener("pointerdown",x,{capture:!0})}},[s,o]);const p=x=>{i();const w=new Date(t);e==="day"?w.setDate(w.getDate()+x):e==="week"?w.setDate(w.getDate()+7*x):e==="month"?w.setMonth(w.getMonth()+x):w.setFullYear(w.getFullYear()+x),n(w)},v=(()=>{const x=new Date;x.setHours(0,0,0,0);const w=new Date(t);if(w.setHours(0,0,0,0),e==="day"){if(+w==+x)return"Oggi";const P=new Date(x);return P.setDate(x.getDate()-1),+w==+P?"Ieri":t.toLocaleDateString("it-IT",{day:"numeric",month:"short",year:"numeric"}).replace(".","")}if(e==="month"){const P=x.getMonth(),j=x.getFullYear();if(t.getMonth()===P&&t.getFullYear()===j)return"Questo Mese";const R=P===0?11:P-1,I=P===0?j-1:j;return t.getMonth()===R&&t.getFullYear()===I?"Mese Scorso":t.toLocaleDateString("it-IT",{month:"long",year:"numeric"})}if(e==="year")return t.getFullYear()===x.getFullYear()?"Quest'Anno":t.getFullYear()===x.getFullYear()-1?"Anno Scorso":String(t.getFullYear());const y=new Date(t),_=y.getDay(),S=y.getDate()-_+(_===0?-6:1);y.setDate(S),y.setHours(0,0,0,0);const k=new Date(y);k.setDate(y.getDate()+6);const E=new Date(x),T=E.getDay(),N=E.getDate()-T+(T===0?-6:1);if(E.setDate(N),E.setHours(0,0,0,0),+y==+E)return"Questa Settimana";const C=new Date(E);return C.setDate(E.getDate()-7),+y==+C?"Settimana Scorsa":`${y.toLocaleDateString("it-IT",{day:"numeric",month:"short"})} - ${k.toLocaleDateString("it-IT",{day:"numeric",month:"short",year:"numeric"})}`})();return g.jsxs("div",{ref:h,className:`relative w-full ${u?"h-8":"h-10"} flex items-center justify-between border rounded-lg bg-white border-indigo-600`,children:[g.jsx("button",{onClick:()=>p(-1),type:"button",className:`h-full px-4 rounded-l-lg ${u?"":"hover:bg-slate-100"}`,"aria-label":"Periodo precedente","data-no-drag":!0,...d,children:g.jsx(cD,{className:"w-5 h-5 text-slate-700"})}),g.jsx("button",{onClick:()=>o(!s),type:"button",className:"flex-1 h-full text-sm font-semibold bg-indigo-100 text-indigo-700 "+(u?"":" hover:bg-indigo-200"),"data-no-drag":!0,...d,children:v}),g.jsx("button",{onClick:()=>p(1),type:"button",className:`h-full px-4 rounded-r-lg ${u?"":"hover:bg-slate-100"}`,"aria-label":"Periodo successivo","data-no-drag":!0,...d,children:g.jsx(Vw,{className:"w-5 h-5 text-slate-700"})}),s&&g.jsx("div",{className:`absolute left-0 right-0 mx-auto w-40 bg-white border border-slate-200 shadow-lg rounded-lg z-[1000] p-2 space-y-1 ${c?"top-full mt-1":"bottom-full mb-10"}`,children:["day","week","month","year"].map(x=>g.jsx("button",{onClick:w=>{w.stopPropagation(),i(),r(x),o(!1)},type:"button","data-no-drag":!0,className:"w-full text-left px-4 py-2 text-sm font-semibold rounded-lg "+(a&&e===x?"bg-indigo-100 text-indigo-800":"bg-slate-50 text-slate-800 hover:bg-slate-200"),...d,children:x==="day"?"Giorno":x==="week"?"Settimana":x==="month"?"Mese":"Anno"},x))})]})},BN=78,Dce=16,jce=e=>{var ve;const[t,r]=D.useState(!1),[n,a]=D.useState(0),[i,s]=D.useState("main"),[o,c]=D.useState(null),[u,d]=D.useState(!1),h=vs(),[p,v]=D.useState(0),[x,w]=D.useState(0),[y,_]=D.useState(0),[S,k]=D.useState(!1),[E,T]=D.useState(!1),N=D.useRef(!1),[C,P]=D.useState(0),[j,R]=D.useState(!1),I=S&&y<(x||0)/2;D.useEffect(()=>{N.current=I},[I]),D.useEffect(()=>{r(!1)},[n]),D.useEffect(()=>{if(i==="category_selection"&&e.selectedCategoryFilters.size===1&&o===null){const fe=Array.from(e.selectedCategoryFilters)[0],[pe]=fe.split(":");da[pe]&&da[pe].length>0&&c(pe)}},[i,e.selectedCategoryFilters,o]);const F=fe=>{const pe=fe.target;pe.tagName==="INPUT"&&["text","number","password","email","search"].includes(pe.type)&&d(!0)},L=fe=>{fe.currentTarget.contains(fe.relatedTarget)||d(!1)},H=D.useRef({active:!1,direction:"none",startX:0,startY:0,startTranslateY:0,lastY:0,lastT:0,canSwipeHorizontal:!1});D.useLayoutEffect(()=>{var pe;if(!e.isActive){k(!1);return}const fe=()=>{const nt=window.visualViewport,De=nt?nt.height:window.innerHeight,Oe=window.innerHeight,kt=De<Oe*.8;let Re;i==="category_selection"?Re=92:kt?Re=96:Re=40;let at=Re/100*De;i==="main"&&!kt&&(at=Math.max(at,320),at=Math.min(at,De*.85)),at=Math.max(at-Dce,BN+10);const bt=Math.max(at-BN,0);v(at),w(bt),_(Yt=>S&&(u||N.current)?0:bt),k(!0)};return fe(),window.addEventListener("resize",fe),(pe=window.visualViewport)==null||pe.addEventListener("resize",fe),()=>{var nt;window.removeEventListener("resize",fe),(nt=window.visualViewport)==null||nt.removeEventListener("resize",fe)}},[e.isActive,i,u]);const V=.05,J=10,te=D.useCallback(fe=>Math.max(0,Math.min(x||0,fe)),[x]),q=D.useCallback((fe,pe)=>{if(!S)return;const nt=x||0,De=te(typeof pe=="number"?pe:y),Oe=nt>0?De/nt:1;let Qe;fe<=-V?Qe=0:fe>=V?Qe=nt:Qe=Oe<.5?0:nt,T(!0),_(Qe)},[x,y,S,V,te]),{onOpenStateChange:oe}=e;D.useEffect(()=>{oe(I)},[I,oe]);const Q=fe=>{if(!e.isActive)return;h.onPointerDown(fe);const nt=!!fe.target.closest("[data-swipe-area]");H.current={active:!0,direction:"none",startX:fe.clientX,startY:fe.clientY,startTranslateY:y,lastY:fe.clientY,lastT:performance.now(),canSwipeHorizontal:nt},E&&T(!1),j&&R(!1)},Z=fe=>{if(h.onPointerMove(fe),!e.isActive)return;const pe=H.current;if(!pe.active)return;const nt=fe.clientX-pe.startX,De=fe.clientY-pe.startY;if(pe.direction==="none"){if(nt*nt+De*De<100)return;if(Math.abs(De)>Math.abs(nt))pe.direction="vertical";else{if(t||i!=="main"||!pe.canSwipeHorizontal){pe.active=!1;return}pe.direction="horizontal"}}if(pe.direction==="vertical"){fe.cancelable&&fe.preventDefault();const Oe=performance.now(),Qe=te(pe.startTranslateY+De);_(Qe),pe.lastY=fe.clientY,pe.lastT=Oe}else pe.direction==="horizontal"&&(fe.cancelable&&fe.preventDefault(),P(nt))},ee=fe=>{h.onPointerUp(fe);const pe=H.current;if(!pe.active){pe.direction="none";return}if(pe.active=!1,pe.direction==="vertical"){const nt=fe.clientY-pe.startY,De=pe.startTranslateY,Oe=x||0,Qe=te(De+nt);if(Math.abs(nt)>=J){if(nt<0&&De>=Oe*.7){pe.direction="none",T(!0),_(0);return}if(nt>0&&De<=Oe*.3){pe.direction="none",T(!0),_(Oe);return}}const kt=performance.now(),Re=Math.max(1,kt-pe.lastT),at=(fe.clientY-pe.lastY)/Re;q(at,Qe)}else if(pe.direction==="horizontal"){const nt=fe.clientX-pe.startX,De=40;nt<-De&&n<2?a(Oe=>Oe+1):nt>De&&n>0&&a(Oe=>Oe-1),R(!0),P(0)}pe.direction="none"},ce=fe=>{var nt;(nt=h.onPointerCancel)==null||nt.call(h,fe);const pe=H.current;pe.active=!1,pe.direction="none",q(0),R(!0),P(0)},de=fe=>{h.onClickCapture(fe)},Te=D.useCallback(fe=>e.onSelectQuickFilter(fe),[e]),Ie=D.useCallback(fe=>e.onSetPeriodDate(fe),[e]),Ne=D.useCallback(fe=>e.onSelectPeriodType(fe),[e]),W=D.useCallback(fe=>e.onCustomRangeChange(fe),[e]),z=fe=>{setTimeout(()=>{fe.target.scrollIntoView({behavior:"smooth",block:"center"})},300)},G=S?te(y):p||(typeof window<"u"?window.innerHeight*40/100:0),ie=`translateX(calc(${-n*(100/3)}% + ${C}px))`,M=!e.isPeriodFilterActive&&!e.isCustomRangeActive,le=e.selectedAccountId?(ve=e.accounts.find(fe=>fe.id===e.selectedAccountId))==null?void 0:ve.name:"Conto",ye=D.useMemo(()=>{const fe=e.selectedCategoryFilters.size;if(fe===0)return"Categoria";if(fe===1){const pe=Array.from(e.selectedCategoryFilters)[0],[nt,De]=pe.split(":"),Oe=Qr(nt);return De?`${Oe.label}, ${De}`:Oe.label}return`${fe} Categorie`},[e.selectedCategoryFilters]),Ce=D.useMemo(()=>{if(e.selectedCategoryFilters.size===1){const fe=Array.from(e.selectedCategoryFilters)[0],[pe]=fe.split(":");return Qr(pe).Icon}return Bf},[e.selectedCategoryFilters]),ze=fe=>{c(pe=>pe===fe?null:fe)},Ze=()=>g.jsxs("div",{className:"px-4 pb-2 space-y-3",children:[g.jsxs("div",{className:"relative",children:[g.jsx("div",{className:"pointer-events-none absolute inset-y-0 left-0 flex items-center pl-3",children:g.jsx(Fce,{className:"h-5 w-5 text-slate-400"})}),g.jsx("input",{id:"filter-desc",type:"text",value:e.descriptionQuery,onChange:fe=>e.onDescriptionChange(fe.target.value),onFocus:z,placeholder:"Descrizione...",className:"w-full rounded-lg border border-slate-300 bg-white py-2 pl-10 pr-3 text-sm text-slate-900 placeholder:text-slate-400 focus:outline-none focus:border-indigo-500 focus:ring-1 focus:ring-indigo-500",onPointerDown:fe=>fe.stopPropagation(),...h})]}),g.jsxs("div",{className:"flex gap-3",children:[g.jsxs("div",{className:"relative flex-1",children:[g.jsx("div",{className:"pointer-events-none absolute inset-y-0 left-0 flex items-center pl-3",children:g.jsx(Xw,{className:`h-5 w-5 ${e.amountRange.min?"text-indigo-600":"text-slate-400"}`})}),g.jsx("input",{id:"filter-amount-min",type:"number",value:e.amountRange.min,onChange:fe=>e.onAmountRangeChange({...e.amountRange,min:fe.target.value}),onFocus:z,placeholder:"Da",className:`w-full rounded-lg border py-2 pl-10 pr-3 text-sm text-slate-900 placeholder:text-slate-400 focus:outline-none focus:border-indigo-500 focus:ring-1 focus:ring-indigo-500 ${e.amountRange.min?"bg-indigo-50 border-indigo-200 text-indigo-700 font-medium":"bg-white border-slate-300"}`,onPointerDown:fe=>fe.stopPropagation(),...h})]}),g.jsxs("div",{className:"relative flex-1",children:[g.jsx("div",{className:"pointer-events-none absolute inset-y-0 left-0 flex items-center pl-3",children:g.jsx(Xw,{className:`h-5 w-5 ${e.amountRange.max?"text-indigo-600":"text-slate-400"}`})}),g.jsx("input",{id:"filter-amount-max",type:"number",value:e.amountRange.max,onChange:fe=>e.onAmountRangeChange({...e.amountRange,max:fe.target.value}),onFocus:z,placeholder:"A",className:`w-full rounded-lg border py-2 pl-10 pr-3 text-sm text-slate-900 placeholder:text-slate-400 focus:outline-none focus:border-indigo-500 focus:ring-1 focus:ring-indigo-500 ${e.amountRange.max?"bg-indigo-50 border-indigo-200 text-indigo-700 font-medium":"bg-white border-slate-300"}`,onPointerDown:fe=>fe.stopPropagation(),...h})]})]})]}),rt=()=>g.jsxs("div",{className:"space-y-3 pt-2 px-4 pb-4",children:[g.jsxs("button",{type:"button",onClick:()=>s("account_selection"),className:`w-full flex items-center justify-between gap-2 px-3 py-2 text-sm rounded-lg border shadow-sm focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 transition-colors text-left ${e.selectedAccountId?"bg-indigo-50 border-indigo-200 text-indigo-700":"bg-white border-slate-300 text-slate-700 hover:bg-slate-50"}`,...h,children:[g.jsxs("div",{className:"flex items-center gap-2 overflow-hidden",children:[g.jsx(Xp,{className:`h-5 w-5 flex-shrink-0 ${e.selectedAccountId?"text-indigo-600":"text-slate-400"}`}),g.jsx("span",{className:"truncate font-medium",children:le})]}),g.jsx(Vw,{className:`w-5 h-5 flex-shrink-0 ${e.selectedAccountId?"text-indigo-400":"text-slate-400"}`})]}),g.jsxs("button",{type:"button",onClick:()=>s("category_selection"),className:`w-full flex items-center justify-between gap-2 px-3 py-2 text-sm rounded-lg border shadow-sm focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 transition-colors text-left ${e.selectedCategoryFilters.size>0?"bg-indigo-50 border-indigo-200 text-indigo-700":"bg-white border-slate-300 text-slate-700 hover:bg-slate-50"}`,...h,children:[g.jsxs("div",{className:"flex items-center gap-2 overflow-hidden",children:[g.jsx(Ce,{className:`h-5 w-5 flex-shrink-0 ${e.selectedCategoryFilters.size>0?"text-indigo-600":"text-slate-400"}`}),g.jsx("span",{className:"truncate font-medium text-base font-bold",children:ye})]}),g.jsx(Vw,{className:`w-5 h-5 flex-shrink-0 ${e.selectedCategoryFilters.size>0?"text-indigo-400":"text-slate-400"}`})]})]}),xt=()=>g.jsxs("div",{className:"space-y-2",children:[g.jsxs("div",{className:"flex items-center gap-2 mb-3 pb-2 border-b border-slate-100",children:[g.jsx("button",{onClick:()=>s("main"),className:"p-1 -ml-1 rounded-full hover:bg-slate-100 text-slate-500",onPointerDown:fe=>fe.stopPropagation(),children:g.jsx(us,{className:"w-5 h-5"})}),g.jsx("h3",{className:"text-base font-bold text-slate-800",children:"Seleziona Conto"})]}),g.jsxs("div",{className:"space-y-1",children:[g.jsxs("button",{onClick:()=>{e.onSelectAccount(null),s("main")},className:`w-full flex items-center justify-between px-3 py-3 rounded-lg text-left text-sm transition-colors ${e.selectedAccountId===null?"bg-indigo-50 text-indigo-700 font-semibold":"text-slate-700 hover:bg-slate-50"}`,onPointerDown:fe=>fe.stopPropagation(),children:[g.jsx("span",{children:"Tutti"}),e.selectedAccountId===null&&g.jsx(Ni,{className:"w-5 h-5"})]}),e.accounts.map(fe=>g.jsxs("button",{onClick:()=>{e.onSelectAccount(fe.id),s("main")},className:`w-full flex items-center justify-between px-3 py-3 rounded-lg text-left text-sm transition-colors ${e.selectedAccountId===fe.id?"bg-indigo-50 text-indigo-700 font-semibold":"text-slate-700 hover:bg-slate-50"}`,onPointerDown:pe=>pe.stopPropagation(),children:[g.jsx("span",{children:fe.name}),e.selectedAccountId===fe.id&&g.jsx(Ni,{className:"w-5 h-5"})]},fe.id))]})]}),mt=()=>g.jsxs("div",{className:"space-y-2",children:[g.jsxs("div",{className:"flex items-center gap-2 mb-3 pb-2 border-b border-slate-100 sticky top-0 bg-white z-10",children:[g.jsx("button",{onClick:()=>s("main"),className:"p-1 -ml-1 rounded-full hover:bg-slate-100 text-slate-500",onPointerDown:fe=>fe.stopPropagation(),children:g.jsx(us,{className:"w-5 h-5"})}),g.jsxs("div",{className:"flex-1",children:[g.jsx("h3",{className:"text-base font-bold text-slate-800",children:"Seleziona Categorie"}),e.selectedCategoryFilters.size>0&&g.jsxs("p",{className:"text-xs text-indigo-600 font-semibold",children:[e.selectedCategoryFilters.size," selezionate"]})]}),e.selectedCategoryFilters.size>0&&g.jsx("button",{onClick:e.onClearCategoryFilters,className:"text-xs font-semibold text-slate-500 hover:text-red-600 px-2 py-1 rounded bg-slate-100 hover:bg-red-50",onPointerDown:fe=>fe.stopPropagation(),children:"Reset"})]}),g.jsx("div",{className:"space-y-1 pb-4",children:Object.keys(da).map(fe=>{const pe=Qr(fe),nt=o===fe,De=e.selectedCategoryFilters.has(fe),Oe=Array.from(e.selectedCategoryFilters).some(Re=>Re.startsWith(fe+":")),Qe=De||Oe,kt=da[fe]||[];return g.jsxs("div",{className:"rounded-lg overflow-hidden border border-transparent hover:border-slate-100",children:[g.jsxs("div",{className:`w-full flex items-center px-3 py-2 gap-3 transition-colors ${Qe?"bg-indigo-50":"hover:bg-slate-50"}`,children:[g.jsxs("button",{onClick:()=>ze(fe),className:"flex items-center gap-3 flex-1 text-left min-w-0",onPointerDown:Re=>Re.stopPropagation(),children:[g.jsx("div",{className:`w-10 h-10 rounded-full flex items-center justify-center flex-shrink-0 ${pe.bgColor}`,children:g.jsx(pe.Icon,{className:`w-5 h-5 ${pe.color}`})}),g.jsx("span",{className:`text-base font-bold truncate ${Qe?"text-indigo-800":"text-slate-700"}`,children:pe.label}),kt.length>0&&g.jsx(Ua,{className:`w-5 h-5 text-slate-400 transition-transform ${nt?"rotate-180":""}`})]}),g.jsx(LN,{checked:Qe,onChange:()=>e.onToggleCategoryFilter(fe)})]}),nt&&kt.length>0&&g.jsx("div",{className:"bg-slate-50 pl-16 pr-4 py-3 space-y-3 border-t border-slate-100 animate-fade-in-down",children:kt.map(Re=>{const at=`${fe}:${Re}`,bt=De||e.selectedCategoryFilters.has(at);return g.jsxs("div",{className:"flex items-center justify-between",children:[g.jsx("span",{className:`text-base font-bold ${bt?"text-indigo-700":"text-slate-600"}`,children:Re}),g.jsx(LN,{checked:bt,onChange:()=>{De&&e.onToggleCategoryFilter(fe),e.onToggleCategoryFilter(at)}})]},Re)})})]},fe)})})]}),Ee=g.jsxs("div",{onPointerDown:Q,onPointerMove:Z,onPointerUp:ee,onPointerCancel:ce,onClickCapture:de,onFocus:F,onBlur:L,"data-no-page-swipe":"true",className:"fixed bottom-0 left-0 right-0 bg-white rounded-t-2xl shadow-[0_-3px_4px_rgba(71,85,105,0.6)] z-[1000] flex flex-col",style:{height:`${p}px`,transform:`translate3d(0, ${G}px, 0)`,transition:E?"transform 0.08s cubic-bezier(0.22, 0.61, 0.36, 1)":"transform 0.3s cubic-bezier(0.22, 0.61, 0.36, 1), height 0.3s cubic-bezier(0.22, 0.61, 0.36, 1)",touchAction:"none",backfaceVisibility:"hidden",willChange:"transform, height",opacity:S?1:0,pointerEvents:S?"auto":"none",display:"flex",flexDirection:"column"},onTransitionEnd:()=>T(!1),children:[g.jsxs("div",{className:"absolute top-0 left-1/2 -translate-x-1/2 w-[88px] h-auto flex justify-center cursor-grab z-50",style:{transform:"translateX(-50%) translateY(-19px)"},"aria-hidden":"true",children:[g.jsx(uD,{width:"88",height:"19",fill:"white"}),g.jsx(Ua,{className:"absolute w-5 h-5 text-slate-400 transition-transform duration-300 "+(I?"rotate-0":"rotate-180"),style:{top:"2px"}})]}),g.jsxs("div",{className:"flex-shrink-0 z-20 relative bg-white rounded-t-2xl",children:[g.jsxs("div",{className:"pt-2 pb-1 relative z-30","data-swipe-area":!0,children:[g.jsx("div",{className:"relative "+(t?"overflow-visible":"overflow-hidden"),children:g.jsxs("div",{className:"w-[300%] flex",style:{transform:ie,transition:j?"transform 0.2s cubic-bezier(0.22, 0.61, 0.36, 1)":"none"},onTransitionEnd:()=>R(!1),children:[g.jsx("div",{className:"w-1/3 px-4 py-1",children:g.jsx(fD,{onSelect:Te,currentValue:e.currentQuickFilter,isActive:M})}),g.jsx("div",{className:"w-1/3 px-4 py-1",children:g.jsx(hD,{periodType:e.periodType,periodDate:e.periodDate,onTypeChange:Ne,onDateChange:Ie,isActive:e.isPeriodFilterActive,onActivate:e.onActivatePeriodFilter,isMenuOpen:t,onMenuToggle:r,isPanelOpen:I,compact:!1})}),g.jsx("div",{className:"w-1/3 px-4 py-1",children:g.jsx(dD,{range:e.currentCustomRange,onChange:W,isActive:e.isCustomRangeActive})})]})}),g.jsx("div",{className:"flex justify-center items-center pt-1 pb-1 gap-2",children:[0,1,2].map(fe=>g.jsx("button",{onClick:()=>a(fe),type:"button",className:"w-2.5 h-2.5 rounded-full transition-colors "+(n===fe?"bg-indigo-600":"bg-slate-300 hover:bg-slate-400"),"aria-label":"Vai al filtro "+(fe+1)},fe))})]}),i==="main"&&g.jsxs("div",{className:"pt-1.5 relative z-20",children:[Ze(),rt()]})]}),g.jsx("div",{className:"w-full h-px bg-slate-200 mb-2 flex-shrink-0 relative z-10"}),g.jsxs("div",{className:"flex-1 overflow-y-auto px-4 pb-4 relative z-10",onPointerDown:fe=>fe.stopPropagation(),style:{overscrollBehaviorY:"contain",touchAction:"pan-y"},children:[i==="account_selection"&&xt(),i==="category_selection"&&mt(),g.jsx("div",{style:{height:"env(safe-area-inset-bottom, 20px)"}})]})]});return typeof window>"u"?null:Bp.createPortal(Ee,document.body)};function pD(e,t,r={}){const{enabled:n=!0,slop:a=10,threshold:i=80,ignoreSelector:s,disableDrag:o}=r,[c,u]=D.useState(0),[d,h]=D.useState(!1),p=D.useRef({pointerId:null,startX:0,startY:0,isSwiping:!1,dir:null,blockedByIgnore:!1,blockedByDisable:!1}),v=D.useCallback(()=>{const x=p.current;x.pointerId=null,x.startX=0,x.startY=0,x.isSwiping=!1,x.dir=null,x.blockedByIgnore=!1,x.blockedByDisable=!1,u(0),h(!1)},[]);return D.useEffect(()=>{const x=e.current;if(!x)return;if(!n){v();return}const w=k=>{if(!n)return;const E=p.current;if(E.pointerId!==null)return;const T=k.target;if(s&&T&&T.closest(s)){E.pointerId=k.pointerId,E.blockedByIgnore=!0,E.blockedByDisable=!1,E.isSwiping=!1,E.dir=null;return}E.pointerId=k.pointerId,E.startX=k.clientX,E.startY=k.clientY,E.isSwiping=!1,E.dir=null,E.blockedByIgnore=!1,E.blockedByDisable=!1},y=k=>{var P;const E=p.current;if(E.pointerId!==k.pointerId||E.blockedByIgnore||E.blockedByDisable||!n)return;const T=k.clientX-E.startX,N=k.clientY-E.startY;if(!E.isSwiping){if(Math.hypot(T,N)<a)return;if(Math.abs(N)>Math.abs(T)*2){v();return}const R=T<0?"left":"right";if(o&&o(R)){E.blockedByDisable=!0,v();return}E.isSwiping=!0,E.dir=R,h(!0)}if(!E.isSwiping)return;const C=((P=e.current)==null?void 0:P.offsetWidth)||window.innerWidth;if(C>0){const R=(k.clientX-E.startX)/C;u(R)}},_=k=>{const E=p.current;if(E.pointerId!==k.pointerId)return;if(E.isSwiping&&!E.blockedByIgnore&&!E.blockedByDisable){const N=k.clientX-E.startX;Math.abs(N)>=i&&(N<0&&t.onSwipeLeft?t.onSwipeLeft():N>0&&t.onSwipeRight&&t.onSwipeRight())}v()},S=k=>{p.current.pointerId===k.pointerId&&v()};return x.addEventListener("pointerdown",w,{passive:!0}),x.addEventListener("pointermove",y,{passive:!0}),x.addEventListener("pointerup",_,{passive:!0}),x.addEventListener("pointercancel",S,{passive:!0}),()=>{x.removeEventListener("pointerdown",w),x.removeEventListener("pointermove",y),x.removeEventListener("pointerup",_),x.removeEventListener("pointercancel",S)}},[e,n,a,i,s,o,t.onSwipeLeft,t.onSwipeRight,v]),{progress:c,isSwiping:d}}const Rce={Alimentari:"#16a34a",Trasporti:"#2563eb",Casa:"#ea580c",Shopping:"#db2777","Tempo Libero":"#9333ea",Salute:"#dc2626",Istruzione:"#ca8a04",Lavoro:"#4f46e5",Altro:"#4b5563"},Mce="#4b5563",Lce=e=>{const{cx:t,cy:r,innerRadius:n,outerRadius:a,startAngle:i,endAngle:s,fill:o,payload:c,percent:u}=e;return c?g.jsxs("g",{children:[g.jsx("text",{x:t,y:r-12,textAnchor:"middle",fill:"#1e293b",className:"text-base font-bold",children:c.name}),g.jsx("text",{x:t,y:r+12,textAnchor:"middle",fill:o,className:"text-lg font-extrabold",children:Ti(c.value)}),g.jsx("text",{x:t,y:r+32,textAnchor:"middle",fill:"#334155",className:"text-sm font-bold",children:`(${(u*100).toFixed(2)}%)`}),g.jsx(j_,{cx:t,cy:r,innerRadius:n,outerRadius:a+6,startAngle:i,endAngle:s,fill:o,stroke:"none"})]}):null},zd=e=>{const t=e.split("-").map(Number);return new Date(t[0],t[1]-1,t[2])},Wd=e=>{const t=e.getFullYear(),r=String(e.getMonth()+1).padStart(2,"0"),n=String(e.getDate()).padStart(2,"0");return`${t}-${r}-${n}`},Bce=(e,t)=>{if(e.frequency!=="recurring"||!e.recurrence)return null;const r=e.recurrenceInterval||1,n=new Date(t);switch(e.recurrence){case"daily":n.setDate(n.getDate()+r);break;case"weekly":n.setDate(n.getDate()+7*r);break;case"monthly":n.setMonth(n.getMonth()+r);break;case"yearly":n.setFullYear(n.getFullYear()+r);break;default:return null}return n},$ce=({expenses:e,recurringExpenses:t,onNavigateToRecurring:r,onNavigateToHistory:n,onImportFile:a})=>{const i=vs(),[s,o]=D.useState(null),[c,u]=D.useState(1),[d,h]=D.useState("30d"),[p,v]=D.useState("month"),[x,w]=D.useState(new Date),[y,_]=D.useState({start:null,end:null}),[S,k]=D.useState(!1),[E,T]=D.useState(!1),[N,C]=D.useState(!1),[P,j]=D.useState(!1),R=s,I=D.useRef(null),F=D.useRef(null),L=(z,G)=>{G.stopPropagation(),o(X=>X===z?null:z)},H=()=>{o(null)},V=z=>{z.target.files&&z.target.files[0]&&a(z.target.files[0]),I.current&&(I.current.value="")};D.useEffect(()=>{const z=G=>{var ie;const X=(ie=G.state)==null?void 0:ie.modal;X==="import_export_main"?(C(!0),j(!1)):X==="import_export_format"?(C(!0),j(!0)):(C(!1),j(!1))};return window.addEventListener("popstate",z),()=>window.removeEventListener("popstate",z)},[]);const J=()=>{window.history.pushState({modal:"import_export_main"},""),C(!0),j(!1)},te=()=>{window.history.pushState({modal:"import_export_format"},""),j(!0)},q=()=>{window.history.back()},oe=()=>{P?window.history.go(-2):window.history.back()},Q=()=>{window.history.back(),setTimeout(()=>{var z;return(z=I.current)==null?void 0:z.click()},100)},Z=z=>{gI(e,z),window.history.go(-2)};D.useEffect(()=>{N||setTimeout(()=>j(!1),300)},[N]),pD(F,{onSwipeLeft:()=>{c<2&&!S&&(u(z=>z+1),T(!0))},onSwipeRight:()=>{c>0&&!S&&(u(z=>z-1),T(!0))}},{threshold:40,slop:10,enabled:!S}),D.useEffect(()=>{if(E){const z=setTimeout(()=>T(!1),200);return()=>clearTimeout(z)}},[E]),D.useEffect(()=>{k(!1)},[c]);const{totalExpenses:ee,dailyTotal:ce,categoryData:de,recurringCountInPeriod:Te,periodLabel:Ie,dateRangeLabel:Ne}=D.useMemo(()=>{const z=e||[],G=z.filter(ve=>ve.amount!=null&&!isNaN(Number(ve.amount))),X=new Date,ie=Wd(X),M=G.filter(ve=>ve.date===ie).reduce((ve,fe)=>ve+Number(fe.amount),0);let le,ye,Ce,ze="";if(c===0){switch(ye=new Date(X),ye.setHours(23,59,59,999),le=new Date(X),le.setHours(0,0,0,0),d){case"7d":le.setDate(le.getDate()-6),Ce="Ultimi 7 Giorni";break;case"30d":le.setDate(le.getDate()-29),Ce="Ultimi 30 Giorni";break;case"6m":le.setMonth(le.getMonth()-6),Ce="Ultimi 6 Mesi";break;case"1y":le.setFullYear(le.getFullYear()-1),Ce="Ultimo Anno";break;default:Ce="Tutto",le=new Date(0);break}const ve={day:"numeric",month:"short"};ze=`${le.toLocaleDateString("it-IT",ve)} - Oggi`}else if(c===2)if(y.start&&y.end){le=zd(y.start),ye=zd(y.end),ye.setHours(23,59,59,999),Ce="Periodo Personalizzato";const ve={day:"numeric",month:"short"},fe={year:"2-digit"};ze=`${le.toLocaleDateString("it-IT",ve)} - ${ye.toLocaleDateString("it-IT",ve)} '${ye.toLocaleDateString("it-IT",fe)}`}else le=new Date,ye=new Date,Ce="Seleziona Date",ze="-";else if(le=new Date(x),le.setHours(0,0,0,0),ye=new Date(x),ye.setHours(23,59,59,999),p==="day")Ce=Wd(le)===Wd(X)?"Spesa di Oggi":"Spesa Giornaliera",ze=le.toLocaleDateString("it-IT",{weekday:"short",day:"numeric",month:"long"});else if(p==="week"){const ve=le.getDay(),fe=le.getDate()-ve+(ve===0?-6:1);le.setDate(fe),ye=new Date(le),ye.setDate(le.getDate()+6),ye.setHours(23,59,59,999),Ce="Spesa Settimanale",ze=`${le.getDate()} ${le.toLocaleString("it-IT",{month:"short"})} - ${ye.getDate()} ${ye.toLocaleString("it-IT",{month:"short"})}`}else p==="month"?(le.setDate(1),ye=new Date(le),ye.setMonth(ye.getMonth()+1),ye.setDate(0),ye.setHours(23,59,59,999),Ce="Spesa Mensile",ze=le.toLocaleString("it-IT",{month:"long",year:"numeric"})):(le.setMonth(0,1),ye=new Date(le),ye.setFullYear(ye.getFullYear()+1),ye.setMonth(0,0),ye.setHours(23,59,59,999),Ce="Spesa Annuale",ze=le.getFullYear().toString());const Ze=G.filter(ve=>{const fe=zd(ve.date);return fe>=le&&fe<=ye}),rt=Ze.reduce((ve,fe)=>ve+Number(fe.amount),0);let xt=0;!isNaN(le.getTime())&&!isNaN(ye.getTime())&&t.forEach(ve=>{if(!ve.date)return;const fe=z.filter(De=>De.recurringExpenseId===ve.id).length;if(ve.recurrenceEndType==="count"&&ve.recurrenceCount&&fe>=ve.recurrenceCount||ve.recurrenceEndType==="date"&&ve.recurrenceEndDate&&ve.lastGeneratedDate&&ve.lastGeneratedDate>=ve.recurrenceEndDate)return;let pe=zd(ve.date),nt=0;for(;pe&&!(pe>ye||ve.recurrenceEndType==="date"&&ve.recurrenceEndDate&&Wd(pe)>ve.recurrenceEndDate||ve.recurrenceEndType==="count"&&ve.recurrenceCount&&nt>=ve.recurrenceCount);)pe>=le&&xt++,nt++,pe=Bce(ve,pe)});const mt=Ze.reduce((ve,fe)=>{const pe=fe.category||"Altro";return ve[pe]=(ve[pe]||0)+Number(fe.amount),ve},{}),Ee=Object.entries(mt).map(([ve,fe])=>({name:ve,value:fe})).sort((ve,fe)=>fe.value-ve.value);return{totalExpenses:rt,dailyTotal:M,categoryData:Ee,recurringCountInPeriod:xt,periodLabel:Ce,dateRangeLabel:ze}},[e,t,c,d,p,x,y]),W=-c*(100/3);return g.jsxs(g.Fragment,{children:[g.jsxs("div",{className:"p-4 md:p-6 space-y-6",...i,children:[g.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[g.jsxs("div",{className:"lg:col-span-1 flex flex-col gap-4",children:[g.jsxs("div",{className:"bg-white p-6 rounded-2xl shadow-lg flex flex-col justify-between relative",children:[g.jsxs("div",{className:"text-center mb-2 relative z-10",children:[g.jsx("h3",{className:"text-lg font-bold text-black leading-tight uppercase tracking-wide",children:Ie}),g.jsx("p",{className:"text-sm font-medium text-slate-400 capitalize mb-1",children:Ne}),g.jsxs("div",{className:"relative flex justify-center items-center text-indigo-600 mt-1",children:[g.jsxs("div",{className:"relative flex items-baseline",children:[g.jsx("span",{className:"absolute right-full mr-2 text-3xl font-semibold opacity-80 top-1/2 -translate-y-1/2",children:""}),g.jsx("span",{className:"text-5xl font-extrabold tracking-tight",children:Ti(ee).replace("","").trim()})]}),Te>0&&g.jsx("div",{className:"absolute right-0 top-1/2 -translate-y-1/2",children:g.jsxs("span",{className:"w-8 h-8 flex items-center justify-center text-xs font-bold text-slate-900 bg-amber-100 border border-amber-400 rounded-lg shadow-sm",title:"Spese programmate in arrivo",children:[Te,"P"]})})]})]}),g.jsxs("div",{className:"mb-2 relative z-20 mx-5",ref:F,style:{touchAction:"pan-y"},children:[g.jsx("div",{className:`relative ${S?"overflow-visible":"overflow-hidden"}`,children:g.jsxs("div",{className:"w-[300%] flex transition-transform duration-300 ease-out",style:{transform:`translateX(${W}%)`},children:[g.jsx("div",{className:`w-1/3 px-1 ${S?"opacity-0 pointer-events-none":"opacity-100"}`,children:g.jsx(fD,{isActive:c===0,currentValue:d,onSelect:z=>{h(z),u(0)},compact:!0})}),g.jsx("div",{className:"w-1/3 px-1 relative z-20",children:g.jsx(hD,{isActive:c===1,periodType:p,periodDate:x,onTypeChange:v,onDateChange:w,onActivate:()=>u(1),isMenuOpen:S,onMenuToggle:k,isPanelOpen:!0,compact:!0})}),g.jsx("div",{className:`w-1/3 px-1 ${S?"opacity-0 pointer-events-none":"opacity-100"}`,children:g.jsx(dD,{isActive:c===2,range:y,onChange:z=>{_(z),u(2)},compact:!0})})]})}),g.jsx("div",{className:"flex justify-center items-center mt-3 gap-2",children:[0,1,2].map(z=>g.jsx("button",{onClick:()=>u(z),className:`w-2 h-2 rounded-full transition-colors ${c===z?"bg-indigo-600":"bg-slate-300 hover:bg-slate-400"}`,"aria-label":`Vai alla pagina filtri ${z+1}`},z))})]}),g.jsxs("div",{className:"mt-4 pt-4 border-t border-slate-200 relative z-10",children:[g.jsxs("div",{children:[g.jsx("h4",{className:"text-sm font-medium text-slate-500",children:"Spesa Oggi"}),g.jsx("p",{className:"text-xl font-bold text-slate-800",children:Ti(ce)})]}),g.jsxs("div",{className:"mt-4 grid grid-cols-2 gap-3",children:[g.jsx("button",{onClick:r,style:{touchAction:"manipulation"},className:"flex items-center justify-center py-2 px-3 text-center font-semibold text-slate-900 bg-amber-100 rounded-xl hover:bg-amber-200 focus:outline-none active:scale-95 active:bg-amber-200 active:ring-2 active:ring-offset-2 active:ring-amber-500 transition-all border border-amber-400",children:g.jsx("span",{className:"text-sm",children:"S. Programmate"})}),g.jsx("button",{onClick:n,style:{touchAction:"manipulation"},className:"flex items-center justify-center py-2 px-3 text-center font-semibold text-slate-900 bg-amber-100 rounded-xl hover:bg-amber-200 focus:outline-none active:scale-95 active:bg-amber-200 active:ring-2 active:ring-offset-2 active:ring-amber-500 transition-all border border-amber-400",children:g.jsx("span",{className:"text-sm",children:"Storico Spese"})})]})]})]}),g.jsx("input",{type:"file",ref:I,className:"hidden",accept:".csv, .xlsx, .xls, .json",onChange:V}),g.jsxs("button",{onClick:J,className:"w-full flex items-center justify-center gap-3 py-3 px-4 bg-indigo-50 text-indigo-700 font-bold rounded-2xl border border-indigo-100 shadow-sm hover:bg-indigo-100 transition-colors",children:[g.jsx(lD,{className:"w-6 h-6"}),"Imp/Exp (CSV/Excel/JSON)"]})]}),g.jsxs("div",{className:"lg:col-span-2 bg-white p-6 rounded-2xl shadow-lg flex flex-col",children:[g.jsxs("div",{className:"mb-4",children:[g.jsx("h3",{className:"text-xl font-bold text-slate-700",children:"Riepilogo Categorie"}),g.jsx("p",{className:"text-sm text-slate-500 font-medium capitalize",children:Ne})]}),de.length>0?g.jsx("div",{className:"space-y-4 flex-grow",children:de.map(z=>{const G=Qr(z.name),X=ee>0?z.value/ee*100:0;return g.jsxs("div",{className:"flex items-center gap-4 text-base",children:[g.jsx("span",{className:`w-10 h-10 rounded-xl flex items-center justify-center ${G.bgColor}`,children:g.jsx(G.Icon,{className:`w-6 h-6 ${G.color}`})}),g.jsxs("div",{className:"flex-grow",children:[g.jsxs("div",{className:"flex justify-between items-center mb-1",children:[g.jsx("span",{className:"font-semibold text-slate-700",children:G.label}),g.jsx("span",{className:"font-bold text-slate-800",children:Ti(z.value)})]}),g.jsx("div",{className:"w-full bg-slate-200 rounded-full h-2.5",children:g.jsx("div",{className:"bg-indigo-500 h-2.5 rounded-full",style:{width:`${X}%`}})})]})]},z.name)})}):g.jsx("p",{className:"text-center text-slate-500 flex-grow flex items-center justify-center",children:"Nessuna spesa registrata in questo periodo."})]})]}),g.jsxs("div",{className:"bg-white p-6 rounded-2xl shadow-lg",children:[g.jsxs("div",{className:"mb-2 text-center",children:[g.jsx("h3",{className:"text-xl font-bold text-slate-700",children:"Spese per Categoria"}),g.jsx("p",{className:"text-sm text-slate-500 font-medium capitalize",children:Ne})]}),de.length>0?g.jsxs("div",{className:"relative cursor-pointer",onClick:H,children:[g.jsx(_Q,{width:"100%",height:300,children:g.jsx(wce,{children:g.jsx(ms,{data:de,cx:"50%",cy:"50%",innerRadius:68,outerRadius:102,fill:"#8884d8",paddingAngle:2,dataKey:"value",nameKey:"name",activeIndex:R??void 0,activeShape:Lce,children:de.map(z=>g.jsx(o_,{fill:Rce[z.name]||Mce},`cell-${z.name}`))})})}),R===null&&g.jsxs("div",{className:"absolute inset-0 flex flex-col justify-center items-center pointer-events-none",children:[g.jsx("span",{className:"text-slate-800 text-base font-bold",children:"Totale"}),g.jsx("span",{className:"text-2xl font-extrabold text-slate-800 mt-1",children:Ti(ee)})]})]}):g.jsx("p",{className:"text-center text-slate-500 py-16",children:"Nessun dato da visualizzare."}),de.length>0&&g.jsx("div",{className:"mt-4 pt-4 border-t border-slate-200",children:g.jsx("div",{className:"flex flex-wrap justify-center gap-x-4 gap-y-3",children:de.map((z,G)=>{const X=Qr(z.name);return g.jsxs("button",{onClick:ie=>L(G,ie),style:{touchAction:"manipulation"},"data-legend-item":!0,className:"flex items-center gap-3 p-2 rounded-full text-left transition-all duration-200 bg-slate-100 hover:bg-slate-200",children:[g.jsx("span",{className:`w-7 h-7 rounded-full flex items-center justify-center flex-shrink-0 ${X.bgColor}`,children:g.jsx(X.Icon,{className:`w-4 h-4 ${X.color}`})}),g.jsx("div",{className:"min-w-0 pr-2",children:g.jsx("p",{className:"font-semibold text-sm truncate text-slate-700",children:X.label})})]},`item-${G}`)})})})]})]}),N&&g.jsx("div",{className:"fixed inset-0 z-[60] flex items-center justify-center p-4 bg-slate-900/60 backdrop-blur-sm transition-opacity",onClick:oe,children:g.jsxs("div",{className:"bg-white rounded-2xl shadow-xl w-full max-w-sm overflow-hidden animate-fade-in-up",onClick:z=>z.stopPropagation(),onPointerDown:z=>z.stopPropagation(),onPointerUp:z=>z.stopPropagation(),children:[g.jsxs("div",{className:"flex justify-between items-center p-4 border-b border-slate-100",children:[P&&g.jsx("button",{onClick:q,className:"p-2 -ml-2 rounded-full hover:bg-slate-100 text-slate-500","aria-label":"Indietro",onPointerDown:z=>z.stopPropagation(),children:g.jsx(us,{className:"w-5 h-5"})}),g.jsx("h3",{className:`text-lg font-bold text-slate-800 flex-1 text-center ${P?"":"pl-8"}`,children:P?"Scegli Formato":"Gestione Dati"}),g.jsx("button",{onClick:oe,className:"p-2 text-slate-400 hover:text-slate-600 rounded-full hover:bg-slate-100 transition-colors",onPointerDown:z=>z.stopPropagation(),children:g.jsx(fn,{className:"w-6 h-6"})})]}),g.jsx("div",{className:"p-4 space-y-3",children:P?g.jsxs(g.Fragment,{children:[g.jsxs("button",{onClick:()=>Z("excel"),onPointerDown:z=>z.stopPropagation(),className:"w-full flex items-center gap-4 p-4 rounded-xl bg-slate-50 hover:bg-slate-100 transition-colors text-left group",children:[g.jsx("div",{className:"w-12 h-12 flex-shrink-0 rounded-full bg-emerald-100 flex items-center justify-center text-emerald-600 group-hover:scale-110 transition-transform",children:g.jsx("span",{className:"font-bold text-sm",children:"XLSX"})}),g.jsxs("div",{className:"flex flex-col",children:[g.jsx("span",{className:"font-semibold text-slate-700 text-lg",children:"Excel (.xlsx)"}),g.jsx("span",{className:"text-xs text-slate-500",children:"Le ricevute non verranno salvate"})]})]}),g.jsxs("button",{onClick:()=>Z("json"),onPointerDown:z=>z.stopPropagation(),className:"w-full flex items-center gap-4 p-4 rounded-xl bg-slate-50 hover:bg-slate-100 transition-colors text-left group",children:[g.jsx("div",{className:"w-12 h-12 flex-shrink-0 rounded-full bg-yellow-100 flex items-center justify-center text-yellow-600 group-hover:scale-110 transition-transform",children:g.jsx("span",{className:"font-bold text-sm",children:"JSON"})}),g.jsxs("div",{className:"flex flex-col",children:[g.jsx("span",{className:"font-semibold text-slate-700 text-lg",children:"JSON (.json)"}),g.jsx("span",{className:"text-xs text-slate-500",children:"Backup completo dell'app"})]})]})]}):g.jsxs(g.Fragment,{children:[g.jsxs("button",{onClick:Q,onPointerDown:z=>z.stopPropagation(),className:"w-full flex items-center gap-4 p-4 rounded-xl bg-slate-50 hover:bg-slate-100 transition-colors text-left group",children:[g.jsx("div",{className:"w-12 h-12 rounded-full bg-green-100 flex items-center justify-center text-green-600 group-hover:scale-110 transition-transform",children:g.jsx(Pce,{className:"w-6 h-6"})}),g.jsx("span",{className:"font-semibold text-slate-700 text-lg",children:"Importa (CSV/Excel/JSON)"})]}),g.jsxs("button",{onClick:te,onPointerDown:z=>z.stopPropagation(),className:"w-full flex items-center gap-4 p-4 rounded-xl bg-slate-50 hover:bg-slate-100 transition-colors text-left group",children:[g.jsx("div",{className:"w-12 h-12 rounded-full bg-blue-100 flex items-center justify-center text-blue-600 group-hover:scale-110 transition-transform",children:g.jsx(Ice,{className:"w-6 h-6"})}),g.jsx("span",{className:"font-semibold text-slate-700 text-lg",children:"Esporta (Excel/JSON)"})]})]})})]})})]})},z_=e=>g.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...e,children:g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M19.5 14.25v-2.625a3.375 3.375 0 0 0-3.375-3.375h-1.5A1.125 1.125 0 0 1 13.5 7.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H8.25m0 12.75h7.5m-7.5 3H12M10.5 2.25H5.625c-.621 0-1.125.504-1.125 1.125v17.25c0 .621.504 1.125 1.125 1.125h12.75c.621 0 1.125-.504 1.125-1.125V11.25a9 9 0 0 0-9-9Z"})}),Gw=e=>g.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...e,children:g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6.75 3v2.25M17.25 3v2.25M3 18.75V7.5a2.25 2.25 0 0 1 2.25-2.25h13.5A2.25 2.25 0 0 1 21 7.5v11.25m-18 0A2.25 2.25 0 0 0 5.25 21h13.5A2.25 2.25 0 0 0 21 18.75m-18 0h18"})}),mD=e=>g.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...e,children:g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 12.75 11.25 15 15 9.75M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"})});function Uce(e,t){if(!e)return null;if(t){const n=e.querySelector(t);if(n)return n}const r=[e];for(;r.length;){const n=r.shift();if(n!==e){const a=getComputedStyle(n);if((a.overflowY==="auto"||a.overflowY==="scroll")&&n.scrollHeight>n.clientHeight)return n}r.push(...Array.from(n.children))}return null}function zce(e,{onClose:t},r={}){const{triggerPercent:n=.25,elastic:a=.92,closeSpeedPxMs:i=2.2,openSpeedPxMs:s=2.8,topGuardPx:o=2,scrollableSelector:c}=r,[u,d]=D.useState(0),[h,p]=D.useState(0),v="cubic-bezier(0.22, 0.61, 0.36, 1)",x=D.useRef({active:!1,tookOver:!1,startX:0,startY:0,lastY:0,lastT:0,vy:0,scroller:null,closing:!1,isLocked:!1}).current,w=()=>{var S;return((S=e.current)==null?void 0:S.clientHeight)||1},y=(S,k,E,T)=>{const N=Math.max(1,Math.abs(k-S)),C=Math.max(100,Math.min(420,Math.round(N/E)));x.closing=T,p(0),d(S),requestAnimationFrame(()=>{p(C),d(k)})},_=S=>{S&&S.propertyName&&S.propertyName!=="transform"||(x.closing?(x.closing=!1,p(0),d(0),t()):p(0))};return D.useEffect(()=>{const S=e.current;if(!S)return;const k=(H,V)=>{x.active=!0,x.tookOver=!1,x.isLocked=!1,x.startX=H,x.startY=V,x.lastY=V,x.lastT=performance.now(),x.vy=0,x.scroller=Uce(S,c)},E=(H,V,J)=>{if(!x.active)return;const te=performance.now(),q=te-x.lastT,oe=V-x.lastY;if(q>1){const de=oe/q;x.vy=x.vy*.8+de*.2}x.lastY=V,x.lastT=te;const Q=H-x.startX,Z=V-x.startY;if(!x.isLocked){if(Math.abs(Q)<=10&&Math.abs(Z)<=10)return;if(!(Math.abs(Z)>Math.abs(Q))){x.active=!1;return}x.isLocked=!0}const ee=!x.scroller||x.scroller.scrollTop<=o,ce=Z>0;if(!x.tookOver&&ce&&ee&&(x.tookOver=!0),x.tookOver){"preventDefault"in J&&J.cancelable&&J.preventDefault(),p(0);const de=Math.max(0,Z)*a;d(Math.min(de,w()*.98))}},T=()=>{if(x.active&&(x.active=!1,x.tookOver)){const H=w(),V=u,te=x.vy>.3;if(V>=H*n||te){const Q=te?i*1.5:i;y(V,H,Q,!0)}else y(V,0,s,!1)}},N=H=>{H.touches.length===1&&k(H.touches[0].clientX,H.touches[0].clientY)},C=H=>{!x.active||H.touches.length!==1||E(H.touches[0].clientX,H.touches[0].clientY,H)},P=()=>T(),j=()=>T(),R=H=>k(H.clientX,H.clientY),I=H=>E(H.clientX,H.clientY,H),F=()=>T(),L=()=>T();return S.addEventListener("touchstart",N,{passive:!0}),S.addEventListener("touchmove",C,{passive:!1}),S.addEventListener("touchend",P,{passive:!0}),S.addEventListener("touchcancel",j,{passive:!0}),S.addEventListener("pointerdown",R,{passive:!0}),S.addEventListener("pointermove",I,{passive:!1}),S.addEventListener("pointerup",F,{passive:!0}),S.addEventListener("pointercancel",L,{passive:!0}),()=>{S.removeEventListener("touchstart",N),S.removeEventListener("touchmove",C),S.removeEventListener("touchend",P),S.removeEventListener("touchcancel",j),S.removeEventListener("pointerdown",R),S.removeEventListener("pointermove",I),S.removeEventListener("pointerup",F),S.removeEventListener("pointercancel",L)}},[e,t,n,a,o,c,u,i,s]),{dragY:u,transitionMs:h,easing:v,handleTransitionEnd:_}}const oi=({isOpen:e,onClose:t,title:r,options:n,selectedValue:a,onSelect:i})=>{var E;const[s,o]=D.useState(!1),c=D.useRef(null),u=vs(),{dragY:d,transitionMs:h,easing:p,handleTransitionEnd:v}=zce(c,{onClose:t},{triggerPercent:.25,elastic:1,topGuardPx:2,scrollableSelector:"[data-scrollable]"});D.useEffect(()=>{e?requestAnimationFrame(()=>o(!0)):o(!1)},[e]);const x=()=>o(!1),w=T=>{T.target===T.currentTarget&&T.propertyName==="transform"&&(v(T.nativeEvent),s||t())};if(!e)return null;const y=d>0||h>0;let _,S;const k="cubic-bezier(0.22, 0.61, 0.36, 1)";if(y)_=`translate3d(0, ${d}px, 0)`,S=`transform ${h}ms ${p}`;else{const T=((E=c.current)==null?void 0:E.clientHeight)??window.innerHeight;_=`translate3d(0, ${s?0:T}px, 0)`,S=`transform 250ms ${k}`}return g.jsxs("div",{className:"absolute inset-0 z-[60]","aria-modal":"true",role:"dialog",children:[g.jsx("div",{className:`absolute inset-0 bg-slate-900/60 transition-opacity duration-300 ease-in-out ${s?"opacity-100":"opacity-0"}`,onClick:x}),g.jsxs("div",{ref:c,onTransitionEnd:w,onClick:T=>T.stopPropagation(),className:"absolute bottom-0 left-0 right-0 z-10 bg-slate-50 rounded-t-2xl shadow-xl max-h-[80vh] flex flex-col",style:{transform:_,transition:S,touchAction:"pan-y",willChange:"transform",overscrollBehaviorY:"contain"},...u,children:[g.jsxs("header",{className:"flex justify-between items-center p-4 border-b border-slate-200 flex-shrink-0",children:[g.jsxs("div",{className:"flex-1 text-center",children:[g.jsx("div",{className:"inline-block h-1.5 w-10 rounded-full bg-slate-300 absolute top-2 left-1/2 -translate-x-1/2"}),g.jsx("h2",{className:"text-lg font-bold text-slate-800 pointer-events-none mt-2",children:r})]}),g.jsx("button",{type:"button",onClick:x,className:"text-slate-500 hover:text-slate-800 transition-colors p-2 rounded-full hover:bg-slate-200 focus:outline-none focus:ring-2 focus:ring-indigo-500 absolute top-2 right-2","aria-label":"Chiudi",children:g.jsx(fn,{className:"w-6 h-6"})})]}),g.jsx("div",{"data-scrollable":!0,className:"overflow-y-auto p-2",style:{overscrollBehavior:"contain"},children:g.jsx("ul",{children:n.map(T=>{const N=a===T.value;return g.jsx("li",{children:g.jsxs("button",{onClick:()=>i(T.value),style:{touchAction:"manipulation"},className:`w-full text-left p-4 flex items-center justify-between gap-4 transition-colors rounded-lg ${N?"bg-indigo-100":"hover:bg-slate-200"}`,children:[g.jsxs("span",{className:"flex items-center gap-4 min-w-0",children:[T.Icon&&T.bgColor&&g.jsx("span",{className:`w-12 h-12 rounded-xl flex items-center justify-center flex-shrink-0 ${T.bgColor}`,children:g.jsx(T.Icon,{className:`w-7 h-7 ${T.color}`})}),g.jsx("span",{className:`font-medium text-lg truncate ${N?"text-indigo-700":"text-slate-800"}`,children:T.label})]}),N&&g.jsx(mD,{className:"w-7 h-7 text-indigo-600 flex-shrink-0"})]})},T.value)})})})]})]})},vD=e=>g.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...e,children:g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 6v6h4.5m4.5 0a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"})}),W_=e=>g.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...e,children:g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 9v3.75m-9.303 3.376c-.866 1.5.217 3.374 1.948 3.374h14.71c1.73 0 2.813-1.874 1.948-3.374L13.949 3.378c-.866-1.5-3.032-1.5-3.898 0L2.697 16.126zM12 15.75h.007v.008H12v-.008z"})}),H_=e=>g.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...e,children:g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m11.25 11.25.041-.02a.75.75 0 0 1 1.063.852l-.708 2.836a.75.75 0 0 0 1.063.853l.041-.021M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Zm-9-3.75h.008v.008H12V8.25Z"})}),uc=({isOpen:e,onClose:t,onConfirm:r,title:n,message:a,variant:i="danger",confirmButtonText:s="Conferma",cancelButtonText:o="Annulla"})=>{const[c,u]=D.useState(!1);if(D.useEffect(()=>{if(e){const w=setTimeout(()=>u(!0),10);return()=>clearTimeout(w)}else u(!1)},[e]),!e)return null;const d={danger:{icon:W_,iconColor:"text-red-600",bgColor:"bg-red-100",confirmButtonClasses:"bg-red-600 hover:bg-red-700 focus:ring-red-500"},info:{icon:H_,iconColor:"text-indigo-600",bgColor:"bg-indigo-100",confirmButtonClasses:"bg-indigo-600 hover:bg-indigo-700 focus:ring-indigo-500"}},{icon:h,iconColor:p,bgColor:v,confirmButtonClasses:x}=d[i];return g.jsx("div",{className:`fixed inset-0 z-[5100] flex justify-center items-center p-4 transition-opacity duration-75 ease-in-out ${c?"opacity-100":"opacity-0"} bg-slate-900/60 backdrop-blur-sm`,onClick:t,"aria-modal":"true",role:"dialog","aria-labelledby":"modal-title",children:g.jsxs("div",{className:`bg-white rounded-lg shadow-xl w-full max-w-md transform transition-all duration-75 ease-in-out ${c?"scale-100 opacity-100":"scale-95 opacity-0"}`,onClick:w=>w.stopPropagation(),children:[g.jsx("div",{className:"p-6",children:g.jsxs("div",{className:"sm:flex sm:items-start",children:[g.jsx("div",{className:`mx-auto flex h-12 w-12 flex-shrink-0 items-center justify-center rounded-full ${v} sm:mx-0 sm:h-10 sm:w-10`,children:g.jsx(h,{className:`h-6 w-6 ${p}`,"aria-hidden":"true"})}),g.jsxs("div",{className:"mt-3 text-center sm:ml-4 sm:mt-0 sm:text-left",children:[g.jsx("h3",{className:"text-lg font-semibold leading-6 text-slate-900",id:"modal-title",children:n}),g.jsx("div",{className:"mt-2",children:g.jsx("p",{className:"text-sm text-slate-500",children:a})})]})]})}),g.jsxs("div",{className:"px-6 py-4 bg-slate-50 flex flex-col-reverse sm:flex-row sm:justify-end gap-3",children:[g.jsx("button",{type:"button",onClick:t,className:"w-full sm:w-auto px-4 py-2 text-sm font-semibold text-slate-700 bg-white border border-slate-300 rounded-lg shadow-sm hover:bg-slate-100 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2 transition-colors",children:o}),g.jsx("button",{type:"button",onClick:r,className:`w-full sm:w-auto px-4 py-2 text-sm font-semibold text-white rounded-lg shadow-sm focus:outline-none focus:ring-2 focus:ring-offset-2 transition-colors ${x}`,children:s})]})]})})},gD=e=>g.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...e,children:g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m18.375 12.739-7.693 7.693a4.5 4.5 0 0 1-6.364-6.364l10.94-10.94A3 3 0 1 1 19.5 7.372L8.552 18.32m.009-.01-.01.01m5.699-9.941-7.81 7.81a1.5 1.5 0 0 0 2.112 2.13"})}),q_=e=>g.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...e,children:[g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6.827 6.175A2.31 2.31 0 0 1 5.186 7.23c-.38.054-.757.112-1.134.175C2.999 7.58 2.25 8.507 2.25 9.574V18a2.25 2.25 0 0 0 2.25 2.25h15A2.25 2.25 0 0 0 21.75 18V9.574c0-1.067-.75-1.994-1.802-2.169a47.865 47.865 0 0 0-1.134-.175 2.31 2.31 0 0 1-1.64-1.055l-.822-1.316a2.192 2.192 0 0 0-1.736-1.039 48.776 48.776 0 0 0-5.232 0 2.192 2.192 0 0 0-1.736 1.039l-.821 1.316Z"}),g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M16.5 12.75a4.5 4.5 0 1 1-9 0 4.5 4.5 0 0 1 9 0ZM18.75 10.5h.008v.008h-.008V10.5Z"})]}),xD=e=>{const t=e.getFullYear(),r=String(e.getMonth()+1).padStart(2,"0"),n=String(e.getDate()).padStart(2,"0");return`${t}-${r}-${n}`},r2=()=>new Date().toLocaleTimeString("it-IT",{hour:"2-digit",minute:"2-digit"}),n2=()=>xD(new Date),Kw=me.memo(me.forwardRef(({id:e,name:t,label:r,value:n,onChange:a,icon:i,...s},o)=>g.jsxs("div",{children:[g.jsx("label",{htmlFor:e,className:"block text-base font-medium text-slate-700 mb-1",children:r}),g.jsxs("div",{className:"relative",children:[g.jsx("div",{className:"pointer-events-none absolute inset-y-0 left-0 flex items-center pl-3",children:i}),g.jsx("input",{ref:o,id:e,name:t,value:n||"",onChange:a,className:"block w-full rounded-md border border-slate-300 bg-white py-2.5 pl-10 pr-3 text-slate-900 placeholder:text-slate-400 focus:outline-none focus:border-indigo-500 focus:ring-1 focus:ring-indigo-500 text-base",...s})]})]})));Kw.displayName="FormInput";const Gh=e=>{if(!e)return null;const t=e.split("-").map(Number);return new Date(t[0],t[1]-1,t[2])},Kd={daily:"Giornaliera",weekly:"Settimanale",monthly:"Mensile",yearly:"Annuale"},Wce={0:"Dom",1:"Lun",2:"Mar",3:"Mer",4:"Gio",5:"Ven",6:"Sab"},yD=["domenica","luned","marted","mercoled","gioved","venerd","sabato"],wD=["primo","secondo","terzo","quarto","ultimo"],Hce=e=>{if(!e)return"";const t=Gh(e);return t?new Intl.DateTimeFormat("it-IT",{day:"numeric",month:"short"}).format(t):""},qce=e=>{if(e.frequency!=="recurring"||!e.recurrence)return"Imposta ricorrenza";const{recurrence:t,recurrenceInterval:r=1,recurrenceDays:n,monthlyRecurrenceType:a,date:i,recurrenceEndType:s="forever",recurrenceEndDate:o,recurrenceCount:c}=e;let u="";if(r===1)u=Kd[t];else switch(t){case"daily":u=`Ogni ${r} giorni`;break;case"weekly":u=`Ogni ${r} sett.`;break;case"monthly":u=`Ogni ${r} mesi`;break;case"yearly":u=`Ogni ${r} anni`;break}if(t==="weekly"&&n&&n.length>0){const h=[...n].sort((p,v)=>(p===0?7:p)-(v===0?7:v)).map(p=>Wce[p]);u+=`: ${h.join(", ")}`}if(t==="monthly"&&a==="dayOfWeek"&&i){const d=Gh(i);if(d){const h=d.getDate(),p=d.getDay(),v=Math.floor((h-1)/7),x=yD[p].substring(0,3),w=wD[v];u+=` (${w} ${x}.)`}}return s==="date"&&o?u+=`, fino al ${Hce(o)}`:s==="count"&&c&&c>0&&(u+=`, ${c} volte`),u},Vce=(e,t)=>{const r=t||1;switch(e){case"daily":return r===1?"giorno":"giorni";case"weekly":return r===1?"settimana":"settimane";case"monthly":return r===1?"mese":"mesi";case"yearly":return r===1?"anno":"anni";default:return"mese"}},Xce=[{label:"Lun",value:1},{label:"Mar",value:2},{label:"Mer",value:3},{label:"Gio",value:4},{label:"Ven",value:5},{label:"Sab",value:6},{label:"Dom",value:0}],Gce=({isOpen:e,onClose:t,onSubmit:r,initialData:n,prefilledData:a,accounts:i,isForRecurringTemplate:s=!1})=>{var ba;const o=i||[],[c,u]=D.useState(!1),[d,h]=D.useState(!1),[p,v]=D.useState({}),[x,w]=D.useState(null),[y,_]=D.useState(null),[S,k]=D.useState(null),[E,T]=D.useState(!1),[N,C]=D.useState(!1),[P,j]=D.useState(!1),[R,I]=D.useState(!1),[F,L]=D.useState(!1),[H,V]=D.useState(!1),[J,te]=D.useState(p.recurrence),[q,oe]=D.useState(p.recurrenceInterval),[Q,Z]=D.useState(p.recurrenceDays),[ee,ce]=D.useState(p.monthlyRecurrenceType),[de,Te]=D.useState(!1),[Ie,Ne]=D.useState(!1),W=D.useRef(0),[z,G]=D.useState(null),X=D.useRef(null),ie=D.useRef(null),M=D.useRef(null),le=!!n,ye=p.frequency==="recurring"&&p.recurrenceEndType==="count"&&p.recurrenceCount===1,Ce=D.useMemo(()=>{const Me=p.date;if(!Me)return"Seleziona una data di inizio valida";const et=Gh(Me);if(!et)return"Data non valida";const Fe=et.getDate(),Xe=et.getDay(),tt=Math.floor((Fe-1)/7);return`Ogni ${wD[tt]} ${yD[Xe]} del mese`},[p.date]),ze=D.useCallback(()=>{const Me=o.length>0?o[0].id:"";v({description:"",amount:"",date:n2(),time:r2(),category:"",subcategory:"",accountId:Me,frequency:"single",tags:[],receipts:[]}),w(null),k(null)},[o]),Ze=()=>{u(!1),setTimeout(t,300)},rt=()=>{le&&E?C(!0):Ze()},xt=()=>{d&&rt()};D.useEffect(()=>{if(e){if(n){const Fe={...n,time:n.time||r2(),frequency:s?"recurring":n.frequency||"single"};v(Fe),k(Fe)}else if(a){const Fe=o.length>0?o[0].id:"";v({description:a.description||"",amount:a.amount||"",date:a.date||n2(),time:a.time||r2(),category:a.category||"",subcategory:a.subcategory||"",accountId:a.accountId||Fe,frequency:"single",tags:a.tags||[],receipts:a.receipts||[]}),k(null)}else ze();T(!1);const Me=setTimeout(()=>{var Fe;u(!0),(Fe=M.current)==null||Fe.focus()},50),et=setTimeout(()=>{h(!0)},300);return()=>{clearTimeout(Me),clearTimeout(et),h(!1)}}else u(!1),h(!1)},[e,n,a,ze,o,s]),D.useEffect(()=>{if(P){te(p.recurrence||"monthly"),oe(p.recurrenceInterval||1),Z(p.recurrenceDays||[]),ce(p.monthlyRecurrenceType||"dayOfMonth"),L(!1);const Me=setTimeout(()=>I(!0),10);return()=>clearTimeout(Me)}else I(!1)},[P,p.recurrence,p.recurrenceInterval,p.recurrenceDays,p.monthlyRecurrenceType]),D.useEffect(()=>{if(de){const Me=setTimeout(()=>Ne(!0),10);return()=>clearTimeout(Me)}else Ne(!1)},[de]),D.useEffect(()=>{if(!le||!S){T(!1);return}const Me=parseFloat(String(p.amount||"0").replace(",",".")),et=S.amount||0,Fe=Math.abs(Me-et)>.001,Xe=(p.description||"")!==(S.description||""),tt=p.date!==S.date,pt=!s&&(p.time||"")!==(S.time||""),Dt=(p.category||"")!==(S.category||""),hr=(p.subcategory||"")!==(S.subcategory||""),Nr=p.accountId!==S.accountId,Wt=p.frequency!==S.frequency,Ht=p.recurrence!==S.recurrence||p.recurrenceInterval!==S.recurrenceInterval||JSON.stringify(p.recurrenceDays)!==JSON.stringify(S.recurrenceDays)||p.monthlyRecurrenceType!==S.monthlyRecurrenceType||p.recurrenceEndType!==S.recurrenceEndType||p.recurrenceEndDate!==S.recurrenceEndDate||p.recurrenceCount!==S.recurrenceCount,or=JSON.stringify(p.receipts)!==JSON.stringify(S.receipts);T(Fe||Xe||tt||pt||Dt||hr||Nr||Wt||Ht||or)},[p,S,le,s]);const mt=D.useCallback(Me=>{const{name:et,value:Fe}=Me.target;if(et==="recurrenceEndDate"&&Fe===""){v(Xe=>({...Xe,recurrenceEndType:"forever",recurrenceEndDate:void 0}));return}if(et==="recurrenceCount"){const Xe=parseInt(Fe,10);v(tt=>({...tt,[et]:isNaN(Xe)||Xe<=0?void 0:Xe}))}else v(Xe=>({...Xe,[et]:Fe}))},[]),Ee=(Me,et)=>{v(Fe=>{const Xe={...Fe,[Me]:et};return Me==="category"&&(Xe.subcategory=""),Xe}),_(null)},ve=Me=>{const et={};Me==="none"?(et.frequency="single",et.recurrence=void 0,et.recurrenceInterval=void 0,et.recurrenceDays=void 0,et.recurrenceEndType=void 0,et.recurrenceEndDate=void 0,et.recurrenceCount=void 0,et.monthlyRecurrenceType=void 0):Me==="single"?(et.frequency="recurring",et.recurrence=void 0,et.recurrenceInterval=void 0,et.recurrenceDays=void 0,et.monthlyRecurrenceType=void 0,et.recurrenceEndType="count",et.recurrenceCount=1,et.recurrenceEndDate=void 0):(et.frequency="recurring",et.recurrence=p.recurrence||"monthly",et.recurrenceEndType="forever",et.recurrenceCount=void 0,et.recurrenceEndDate=void 0),v(Fe=>({...Fe,...et})),_(null)},fe=()=>{I(!1),j(!1)},pe=()=>{v(Me=>({...Me,recurrence:J,recurrenceInterval:q||1,recurrenceDays:J==="weekly"?Q:void 0,monthlyRecurrenceType:J==="monthly"?ee:void 0})),fe()},nt=Me=>{const et={recurrenceEndType:Me};Me==="forever"?(et.recurrenceEndDate=void 0,et.recurrenceCount=void 0):Me==="date"?(et.recurrenceEndDate=p.recurrenceEndDate||xD(new Date),et.recurrenceCount=void 0):Me==="count"&&(et.recurrenceEndDate=void 0,et.recurrenceCount=p.recurrenceCount||1),v(Fe=>({...Fe,...et})),V(!1)},De=Me=>{Z(et=>{const Fe=et||[];return(Fe.includes(Me)?Fe.filter(tt=>tt!==Me):[...Fe,Me]).sort((tt,pt)=>(tt===0?7:tt)-(pt===0?7:pt))})},Oe=()=>{Te(!1),Ne(!1),W.current=Date.now()},Qe=async Me=>{try{const et=await up(Me),{base64:Fe}=await ql(et);v(Xe=>({...Xe,receipts:[...Xe.receipts||[],Fe]})),setTimeout(Oe,500)}catch(et){console.error(et)}},kt=Me=>{v(et=>{const Xe=(et.receipts||[]).filter((tt,pt)=>pt!==Me);return{...et,receipts:Xe}})},Re=Me=>{Me.preventDefault();const et=String(p.amount).replace(",",".").trim(),Fe=parseFloat(et);if(et===""||isNaN(Fe)||Fe<=0){w("Inserisci un importo valido.");return}const Xe=p.date||n2();if(!p.accountId){w("Seleziona un conto.");return}w(null);const tt={...p,amount:Fe,date:Xe,time:p.time||void 0,description:p.description||"",category:p.category||"",subcategory:p.subcategory||void 0,tags:p.tags||[],receipts:p.receipts||[]};tt.frequency==="recurring"&&delete tt.time,r(le?{...n,...tt}:tt)},at=D.useCallback(Me=>{if(Me.key!=="Enter")return;Me.preventDefault(),Me.currentTarget.blur()},[]),bt=()=>z?Bp.createPortal(g.jsxs("div",{className:"fixed inset-0 z-[6000] bg-black/95 flex items-center justify-center p-4 animate-fade-in-up",onClick:()=>G(null),children:[g.jsx("button",{className:"absolute top-4 right-4 text-white/80 hover:text-white p-2 transition-colors z-50",onClick:Me=>{Me.stopPropagation(),G(null)},onPointerDown:Me=>Me.stopPropagation(),children:g.jsx(fn,{className:"w-8 h-8"})}),g.jsx("img",{src:`data:image/png;base64,${z}`,className:"max-w-full max-h-full object-contain rounded-sm shadow-2xl",alt:"Ricevuta Full Screen",onClick:Me=>Me.stopPropagation()})]}),document.body):null;if(!e)return null;const Yt=Object.keys(da).map(Me=>{const et=Qr(Me);return{value:Me,label:et.label,Icon:et.Icon,color:et.color,bgColor:et.bgColor}}),mn=p.category&&da[p.category]?da[p.category].map(Me=>({value:Me,label:Me})):[],Mn=o.map(Me=>({value:Me.id,label:Me.name})),va=[{value:"none",label:"Nessuna"},{value:"single",label:"Singolo"},{value:"recurring",label:"Ricorrente"}],ga=!p.category||p.category==="Altro"||mn.length===0,Vr=({label:Me,value:et,onClick:Fe,placeholder:Xe,ariaLabel:tt,disabled:pt,icon:Dt})=>{const hr=et&&et!==Xe&&et!=="";return g.jsxs("div",{children:[g.jsx("label",{className:`block text-base font-medium mb-1 transition-colors ${pt?"text-slate-400":"text-slate-700"}`,children:Me}),g.jsxs("button",{type:"button",onClick:Nr=>{Nr.stopPropagation(),Fe()},"aria-label":tt,disabled:pt,className:`w-full flex items-center justify-center text-center gap-2 px-3 py-2.5 text-base font-semibold rounded-lg border shadow-sm focus:outline-none focus:ring-0 transition-colors ${pt?"bg-slate-100 border-slate-200 text-slate-400 cursor-not-allowed":hr?"bg-indigo-50 border-indigo-200 text-indigo-700 hover:bg-indigo-100":"bg-white border-slate-300 text-slate-500 hover:bg-slate-50"}`,children:[Dt,g.jsx("span",{className:"truncate",children:et||Xe})]})]})},xa=()=>{const{recurrenceEndType:Me}=p;return!Me||Me==="forever"?"Per sempre":Me==="date"?"Fino a":Me==="count"?"Numero di volte":"Per sempre"},ya=(ba=o.find(Me=>Me.id===p.accountId))==null?void 0:ba.name,wa=p.category?Qr(p.category).label:void 0;return g.jsx(g.Fragment,{children:g.jsxs("div",{className:`fixed inset-0 z-[5000] transition-opacity duration-300 ease-in-out ${c?"opacity-100":"opacity-0"} bg-slate-900/60 backdrop-blur-sm`,onClick:xt,"aria-modal":"true",role:"dialog",children:[g.jsxs("div",{className:`bg-slate-50 w-full h-full flex flex-col absolute bottom-0 transform transition-transform duration-300 ease-in-out ${c?"translate-y-0":"translate-y-full"}`,onClick:Me=>Me.stopPropagation(),style:{touchAction:"pan-y"},children:[g.jsxs("header",{className:"flex justify-between items-center p-6 border-b border-slate-200 flex-shrink-0",children:[g.jsx("h2",{ref:M,tabIndex:-1,className:"text-2xl font-bold text-slate-800 focus:outline-none",children:le?"Modifica Spesa":"Aggiungi Spesa"}),g.jsx("button",{type:"button",onClick:rt,className:"text-slate-500 hover:text-slate-800 transition-colors p-1 rounded-full hover:bg-slate-200 focus:outline-none focus:ring-2 focus:ring-indigo-500","aria-label":"Chiudi",children:g.jsx(fn,{className:"w-6 h-6"})})]}),g.jsxs("form",{onSubmit:Re,noValidate:!0,className:"flex-1 flex flex-col overflow-hidden",children:[g.jsxs("div",{className:"p-6 space-y-4 flex-1 overflow-y-auto",children:[g.jsx(Kw,{ref:ie,id:"description",name:"description",label:"Descrizione (opzionale)",value:p.description||"",onChange:mt,icon:g.jsx(z_,{className:"h-5 w-5 text-slate-400"}),type:"text",placeholder:"Es. Caff al bar"}),g.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[g.jsx(Kw,{ref:X,id:"amount",name:"amount",label:"Importo",value:p.amount||"",onChange:mt,onKeyDown:at,icon:g.jsx(Xw,{className:"h-5 w-5 text-slate-400"}),type:"text",inputMode:"decimal",pattern:"[0-9]*[.,]?[0-9]*",placeholder:"0.00",required:!0,autoComplete:"off"}),g.jsxs("div",{className:`grid ${p.frequency==="recurring"?"grid-cols-1":"grid-cols-2"} gap-2`,children:[g.jsxs("div",{children:[g.jsx("label",{htmlFor:"date",className:"block text-base font-medium text-slate-700 mb-1",children:ye?"Data del Pagamento":p.frequency==="recurring"?"Data di Inizio":"Data"}),g.jsxs("div",{className:"relative",children:[g.jsx("div",{className:"pointer-events-none absolute inset-y-0 left-0 flex items-center pl-3",children:g.jsx(Gw,{className:"h-5 w-5 text-slate-400"})}),g.jsx("input",{id:"date",name:"date",value:p.date||"",onChange:mt,className:"block w-full rounded-md border border-slate-300 bg-white py-2.5 pl-10 pr-3 text-slate-900 placeholder:text-slate-400 focus:outline-none focus:border-indigo-500 focus:ring-1 focus:ring-indigo-500 text-base",type:"date"})]})]}),p.frequency!=="recurring"&&g.jsxs("div",{children:[g.jsx("label",{htmlFor:"time",className:"block text-base font-medium text-slate-700 mb-1",children:"Ora (opz.)"}),g.jsxs("div",{className:"relative",children:[g.jsx("div",{className:"pointer-events-none absolute inset-y-0 left-0 flex items-center pl-3",children:g.jsx(vD,{className:"h-5 w-5 text-slate-400"})}),g.jsx("input",{id:"time",name:"time",value:p.time||"",onChange:mt,className:"block w-full rounded-md border border-slate-300 bg-white py-2.5 pl-10 pr-3 text-slate-900 placeholder:text-slate-400 focus:outline-none focus:border-indigo-500 focus:ring-1 focus:ring-indigo-500 text-base",type:"time"})]})]})]})]}),g.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-4",children:[g.jsx(Vr,{label:"Conto",value:ya,onClick:()=>_("account"),placeholder:"Seleziona",ariaLabel:"Seleziona conto di pagamento",icon:g.jsx(Xp,{className:"h-5 w-5"})}),g.jsx(Vr,{label:"Categoria (opzionale)",value:wa,onClick:()=>_("category"),placeholder:"Seleziona",ariaLabel:"Seleziona categoria",icon:g.jsx(Bf,{className:"h-5 w-5"})}),g.jsx(Vr,{label:"Sottocategoria (opzionale)",value:p.subcategory,onClick:()=>_("subcategory"),placeholder:"Seleziona",ariaLabel:"Seleziona sottocategoria",disabled:ga,icon:g.jsx(Bf,{className:"h-5 w-5"})})]}),g.jsxs("div",{className:"animate-fade-in-up",children:[g.jsx("label",{className:"block text-base font-medium text-slate-700 mb-1",children:"Ricevute"}),p.receipts&&p.receipts.length>0&&g.jsx("div",{className:"grid grid-cols-2 gap-3 mb-3",children:p.receipts.map((Me,et)=>g.jsxs("div",{className:"relative rounded-lg overflow-hidden border border-slate-200 shadow-sm aspect-video bg-slate-50 cursor-pointer hover:border-indigo-300 transition-colors",onClick:()=>G(Me),children:[g.jsx("img",{src:`data:image/png;base64,${Me}`,alt:"Ricevuta",className:"w-full h-full object-cover"}),g.jsx("button",{type:"button",onClick:Fe=>{Fe.stopPropagation(),kt(et)},onPointerDown:Fe=>Fe.stopPropagation(),className:"absolute top-1 right-1 p-1 bg-white/90 text-red-600 rounded-full shadow-md hover:bg-red-50 hover:text-red-700 transition-colors z-10 flex items-center justify-center","aria-label":"Rimuovi ricevuta",children:g.jsx(fn,{className:"w-5 h-5"})})]},et))}),g.jsxs("button",{type:"button",onClick:()=>{Date.now()-W.current<500||Te(!0)},className:"w-full flex items-center justify-center gap-2 px-3 py-2.5 text-base rounded-lg border border-dashed border-indigo-300 bg-indigo-50 text-indigo-600 hover:bg-indigo-100 hover:border-indigo-400 transition-colors focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500",children:[g.jsx(gD,{className:"w-5 h-5"}),g.jsx("span",{children:p.receipts&&p.receipts.length>0?"Aggiungi un'altra ricevuta":"Allega Ricevuta"})]})]}),s&&g.jsxs("div",{className:"bg-white p-4 rounded-lg border border-slate-200 space-y-4",children:[g.jsxs("div",{children:[g.jsx("label",{className:"block text-base font-medium text-slate-700 mb-1",children:"Frequenza"}),g.jsxs("button",{type:"button",onClick:()=>_("frequency"),className:"w-full flex items-center justify-between text-left gap-2 px-3 py-2.5 text-base rounded-lg border shadow-sm focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 transition-colors bg-white border-slate-300 text-slate-800 hover:bg-slate-50",children:[g.jsx("span",{className:"truncate flex-1 capitalize",children:ye?"Singolo":p.frequency!=="recurring"?"Nessuna":"Ricorrente"}),g.jsx(Ua,{className:"w-5 h-5 text-slate-500"})]})]}),p.frequency==="recurring"&&!ye&&g.jsxs("div",{className:"animate-fade-in-up",children:[g.jsx("label",{className:"block text-base font-medium text-slate-700 mb-1",children:"Ricorrenza"}),g.jsxs("button",{type:"button",onClick:()=>j(!0),className:"w-full flex items-center justify-between text-left gap-2 px-3 py-2.5 text-base rounded-lg border shadow-sm focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 transition-colors bg-white border-slate-300 text-slate-800 hover:bg-slate-50",children:[g.jsx("span",{className:"truncate flex-1",children:qce(p)}),g.jsx(Ua,{className:"w-5 h-5 text-slate-500"})]})]})]}),x&&g.jsx("p",{className:"text-base text-red-600 bg-red-100 p-3 rounded-md",children:x})]}),g.jsx("footer",{className:`px-6 py-4 bg-slate-100 border-t border-slate-200 flex flex-shrink-0 ${le&&!E?"justify-stretch":"justify-end gap-3"}`,children:le&&!E?g.jsx("button",{type:"button",onClick:rt,className:"w-full px-4 py-2 text-base font-semibold text-slate-700 bg-white border border-slate-300 rounded-lg shadow-sm hover:bg-slate-100 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2 transition-colors",children:"Chiudi"}):g.jsxs(g.Fragment,{children:[g.jsx("button",{type:"button",onClick:rt,className:"px-4 py-2 text-base font-semibold text-slate-700 bg-white border border-slate-300 rounded-lg shadow-sm hover:bg-slate-100 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2 transition-colors",children:"Annulla"}),g.jsx("button",{type:"submit",className:"px-4 py-2 text-base font-semibold text-white bg-indigo-600 rounded-lg shadow-sm hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2 transition-colors",children:le?"Salva Modifiche":"Aggiungi Spesa"})]})})]})]}),g.jsx(oi,{isOpen:y==="account",onClose:()=>_(null),title:"Seleziona un Conto",options:Mn,selectedValue:p.accountId||"",onSelect:Me=>Ee("accountId",Me)}),g.jsx(oi,{isOpen:y==="category",onClose:()=>_(null),title:"Seleziona una Categoria",options:Yt,selectedValue:p.category||"",onSelect:Me=>Ee("category",Me)}),g.jsx(oi,{isOpen:y==="subcategory",onClose:()=>_(null),title:"Seleziona Sottocategoria",options:mn,selectedValue:p.subcategory||"",onSelect:Me=>Ee("subcategory",Me)}),g.jsx(oi,{isOpen:y==="frequency",onClose:()=>_(null),title:"Imposta Frequenza",options:va,selectedValue:ye?"single":p.frequency!=="recurring"?"none":"recurring",onSelect:ve}),P&&g.jsx("div",{className:`fixed inset-0 z-[60] flex justify-center items-center p-4 transition-opacity duration-300 ease-in-out ${R?"opacity-100":"opacity-0"} bg-slate-900/60 backdrop-blur-sm`,onClick:fe,"aria-modal":"true",role:"dialog",children:g.jsxs("div",{className:`bg-white rounded-lg shadow-xl w-full max-w-sm transform transition-all duration-300 ease-in-out ${R?"scale-100 opacity-100":"scale-95 opacity-0"}`,onClick:Me=>Me.stopPropagation(),children:[g.jsxs("header",{className:"flex justify-between items-center p-4 border-b border-slate-200",children:[g.jsx("h2",{className:"text-lg font-bold text-slate-800",children:"Imposta Ricorrenza"}),g.jsx("button",{type:"button",onClick:fe,className:"text-slate-500 hover:text-slate-800 transition-colors p-1 rounded-full hover:bg-slate-200 focus:outline-none focus:ring-2 focus:ring-indigo-500","aria-label":"Chiudi",children:g.jsx(fn,{className:"w-6 h-6"})})]}),g.jsxs("main",{className:"p-4 space-y-4",children:[g.jsxs("div",{className:"relative",children:[g.jsxs("button",{onClick:()=>{L(Me=>!Me),V(!1)},className:"w-full flex items-center justify-between text-left gap-2 px-3 py-2.5 text-base rounded-lg border shadow-sm focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 transition-colors bg-white border-slate-300 text-slate-800 hover:bg-slate-50",children:[g.jsx("span",{className:"truncate flex-1 capitalize",children:Kd[J]||"Seleziona"}),g.jsx(Ua,{className:`w-5 h-5 text-slate-500 transition-transform ${F?"rotate-180":""}`})]}),F&&g.jsx("div",{className:"absolute top-full mt-1 w-full bg-white border border-slate-200 shadow-lg rounded-lg z-20 p-2 space-y-1 animate-fade-in-down",children:Object.keys(Kd).map(Me=>g.jsx("button",{onClick:()=>{te(Me),L(!1)},className:"w-full text-left px-4 py-3 text-base font-semibold rounded-lg transition-colors bg-slate-50 text-slate-800 hover:bg-indigo-100 hover:text-indigo-800",children:Kd[Me]},Me))})]}),g.jsx("div",{className:"animate-fade-in-up pt-2",children:g.jsxs("div",{className:"flex items-center justify-center gap-2 bg-slate-100 p-3 rounded-lg",children:[g.jsx("span",{className:"text-base text-slate-700",children:"Ogni"}),g.jsx("input",{type:"number",value:q||"",onChange:Me=>{const et=Me.target.value;if(et==="")oe(void 0);else{const Fe=parseInt(et,10);!isNaN(Fe)&&Fe>0&&oe(Fe)}},onFocus:Me=>Me.currentTarget.select(),className:"w-12 text-center text-lg font-bold text-slate-800 bg-transparent border-0 border-b-2 border-slate-400 focus:ring-0 focus:outline-none focus:border-indigo-600 p-0",min:"1"}),g.jsx("span",{className:"text-base text-slate-700",children:Vce(J,q)})]})}),J==="weekly"&&g.jsx("div",{className:"animate-fade-in-up pt-2",children:g.jsx("div",{className:"flex flex-wrap justify-center gap-2",children:Xce.map(Me=>g.jsx("button",{onClick:()=>De(Me.value),className:`w-14 h-14 rounded-full text-sm font-semibold transition-colors focus:outline-none border-2 ${(Q||[]).includes(Me.value)?"bg-indigo-600 text-white border-indigo-600":"bg-white text-slate-800 border-indigo-400 hover:bg-indigo-50"}`,children:Me.label},Me.value))})}),J==="monthly"&&g.jsxs("div",{className:"animate-fade-in-up pt-4 space-y-2 border-t border-slate-200",children:[g.jsxs("div",{role:"radio","aria-checked":ee==="dayOfMonth",onClick:()=>ce("dayOfMonth"),className:"flex items-center gap-3 p-2 cursor-pointer rounded-lg hover:bg-slate-100",children:[g.jsx("div",{className:"w-5 h-5 rounded-full border-2 border-slate-400 flex items-center justify-center flex-shrink-0",children:ee==="dayOfMonth"&&g.jsx("div",{className:"w-2.5 h-2.5 bg-indigo-600 rounded-full"})}),g.jsx("label",{className:"text-sm font-medium text-slate-700 cursor-pointer",children:"Lo stesso giorno di ogni mese"})]}),g.jsxs("div",{role:"radio","aria-checked":ee==="dayOfWeek",onClick:()=>ce("dayOfWeek"),className:"flex items-center gap-3 p-2 cursor-pointer rounded-lg hover:bg-slate-100",children:[g.jsx("div",{className:"w-5 h-5 rounded-full border-2 border-slate-400 flex items-center justify-center flex-shrink-0",children:ee==="dayOfWeek"&&g.jsx("div",{className:"w-2.5 h-2.5 bg-indigo-600 rounded-full"})}),g.jsx("label",{className:"text-sm font-medium text-slate-700 cursor-pointer",children:Ce})]})]}),g.jsx("div",{className:"pt-4 border-t border-slate-200",children:g.jsxs("div",{className:"grid grid-cols-2 gap-4 items-end",children:[g.jsxs("div",{className:`relative ${!p.recurrenceEndType||p.recurrenceEndType==="forever"?"col-span-2":""}`,children:[g.jsxs("button",{type:"button",onClick:()=>{V(Me=>!Me),L(!1)},className:"w-full flex items-center justify-between text-left gap-2 px-3 py-2.5 text-base rounded-lg border shadow-sm focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 transition-colors bg-white border-slate-300 text-slate-800 hover:bg-slate-50",children:[g.jsx("span",{className:"truncate flex-1 capitalize",children:xa()}),g.jsx(Ua,{className:`w-5 h-5 text-slate-500 transition-transform ${H?"rotate-180":""}`})]}),H&&g.jsx("div",{className:"absolute top-full mt-1 w-full bg-white border border-slate-200 shadow-lg rounded-lg z-10 p-2 space-y-1 animate-fade-in-down",children:["forever","date","count"].map(Me=>g.jsx("button",{onClick:()=>nt(Me),className:"w-full text-left px-4 py-3 text-base font-semibold rounded-lg transition-colors bg-slate-50 text-slate-800 hover:bg-indigo-100 hover:text-indigo-800",children:Me==="forever"?"Per sempre":Me==="date"?"Fino a":"Numero di volte"},Me))})]}),p.recurrenceEndType==="date"&&g.jsx("div",{className:"animate-fade-in-up",children:g.jsxs("label",{htmlFor:"recurrence-end-date",className:"relative w-full flex items-center justify-center gap-2 px-3 py-2.5 text-base rounded-lg focus-within:ring-2 focus-within:ring-offset-2 focus-within:ring-indigo-500 text-indigo-600 hover:bg-indigo-100 font-semibold cursor-pointer h-[46.5px]",children:[g.jsx(Gw,{className:"w-5 h-5"}),g.jsx("span",{children:p.recurrenceEndDate?oD(Gh(p.recurrenceEndDate)):"Seleziona"}),g.jsx("input",{type:"date",id:"recurrence-end-date",name:"recurrenceEndDate",value:p.recurrenceEndDate||"",onChange:Me=>v(et=>({...et,recurrenceEndDate:Me.target.value,recurrenceEndType:"date"})),className:"absolute inset-0 opacity-0 w-full h-full cursor-pointer"})]})}),p.recurrenceEndType==="count"&&g.jsx("div",{className:"animate-fade-in-up",children:g.jsx("div",{className:"relative",children:g.jsx("input",{type:"number",id:"recurrence-count",name:"recurrenceCount",value:p.recurrenceCount||"",onChange:mt,className:"block w-full text-center rounded-md border border-slate-300 bg-white py-2.5 text-slate-900 placeholder:text-slate-400 focus:outline-none focus:border-indigo-500 focus:ring-1 focus:ring-indigo-500 text-base",placeholder:"N.",min:"1"})})})]})})]}),g.jsx("footer",{className:"p-4 bg-slate-100 border-t border-slate-200 flex justify-end",children:g.jsx("button",{type:"button",onClick:pe,className:"px-4 py-2 text-sm font-semibold text-white bg-indigo-600 rounded-lg shadow-sm hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2 transition-colors",children:"Applica"})})]})}),de&&g.jsx("div",{className:`fixed inset-0 z-[5200] flex justify-center items-center p-4 bg-slate-900/60 backdrop-blur-sm transition-opacity duration-300 ease-in-out ${Ie?"opacity-100":"opacity-0"}`,onClick:Oe,children:g.jsxs("div",{className:"bg-slate-50 rounded-lg shadow-xl w-full max-w-sm",onClick:Me=>Me.stopPropagation(),children:[g.jsxs("header",{className:"flex justify-between items-center p-4 border-b border-slate-200",children:[g.jsx("h2",{className:"text-lg font-bold text-slate-800",children:"Allega Ricevuta"}),g.jsx("button",{onClick:Oe,className:"p-1 rounded-full hover:bg-slate-200",children:g.jsx(fn,{className:"w-6 h-6"})})]}),g.jsxs("div",{className:"p-4 grid grid-cols-2 gap-4",children:[g.jsxs("button",{onClick:()=>Qe("camera"),className:"flex flex-col items-center justify-center gap-2 p-4 rounded-xl bg-white border border-slate-200 hover:bg-indigo-50 hover:border-indigo-200 transition-colors",children:[g.jsx("div",{className:"w-10 h-10 rounded-full bg-indigo-100 flex items-center justify-center text-indigo-600",children:g.jsx(q_,{className:"w-6 h-6"})}),g.jsx("span",{className:"font-semibold text-slate-700 text-sm",children:"Fotocamera"})]}),g.jsxs("button",{onClick:()=>Qe("gallery"),className:"flex flex-col items-center justify-center gap-2 p-4 rounded-xl bg-white border border-slate-200 hover:bg-indigo-50 hover:border-indigo-200 transition-colors",children:[g.jsx("div",{className:"w-10 h-10 rounded-full bg-purple-100 flex items-center justify-center text-purple-600",children:g.jsx(dp,{className:"w-6 h-6"})}),g.jsx("span",{className:"font-semibold text-slate-700 text-sm",children:"Galleria"})]})]})]})}),bt(),g.jsx(uc,{isOpen:N,onClose:()=>C(!1),onConfirm:()=>{C(!1),Ze()},title:"Annullare le modifiche?",message:"Sei sicuro di voler chiudere senza salvare? Le modifiche andranno perse.",variant:"danger",confirmButtonText:"S, annulla",cancelButtonText:"No, continua"})]})})},Kce=e=>g.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:2,stroke:"currentColor",...e,children:g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 4.5v15m7.5-7.5h-15"})}),bD=e=>g.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...e,children:g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 18.75a6 6 0 0 0 6-6v-1.5m-6 7.5a6 6 0 0 1-6-6v-1.5m6 7.5v3.75m-3.75 0h7.5M12 15.75a3 3 0 0 1-3-3V4.5a3 3 0 0 1 6 0v8.25a3 3 0 0 1-3 3Z"})}),Yce=e=>g.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...e,children:g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m16.862 4.487 1.687-1.688a1.875 1.875 0 1 1 2.652 2.652L6.832 19.82a4.5 4.5 0 0 1-1.897 1.13l-2.685.8.8-2.685a4.5 4.5 0 0 1 1.13-1.897L16.863 4.487Zm0 0L19.5 7.125"})}),Zce=({onAddManually:e,onAddFromImage:t,onAddFromVoice:r,style:n})=>{const[a,i]=D.useState(!1),[s,o]=D.useState(!1),[c,u]=D.useState(!1),d=D.useRef(null),h=D.useRef(null);D.useEffect(()=>{const y=setTimeout(()=>o(!0),100);return()=>clearTimeout(y)},[]),D.useEffect(()=>(a?u(!0):(h.current&&clearTimeout(h.current),h.current=window.setTimeout(()=>{u(!1)},300)),()=>{h.current&&clearTimeout(h.current)}),[a]),D.useEffect(()=>(d.current&&clearTimeout(d.current),a&&(d.current=window.setTimeout(()=>{i(!1)},5e3)),()=>{d.current&&clearTimeout(d.current)}),[a]);const p=y=>{y(),i(!1)},v=[{label:"Aggiungi Manualmente",icon:g.jsx(Yce,{className:"w-7 h-7"}),onClick:()=>p(e),bgColor:"bg-indigo-500",hoverBgColor:"hover:bg-indigo-600"},{label:"Aggiungi da Immagine",icon:g.jsx(dp,{className:"w-7 h-7"}),onClick:()=>p(t),bgColor:"bg-sky-600",hoverBgColor:"hover:bg-sky-700"},{label:"Aggiungi con Voce",icon:g.jsx(bD,{className:"w-7 h-7"}),onClick:()=>p(r),bgColor:"bg-purple-600",hoverBgColor:"hover:bg-purple-700"}],w={...{bottom:"calc(1.5rem + env(safe-area-inset-bottom, 0px))",right:"calc(1.5rem + env(safe-area-inset-right, 0px))",transition:"bottom 300ms cubic-bezier(0.22, 0.61, 0.36, 1)"},...n};return g.jsxs("div",{className:"fixed z-[1050] flex flex-col items-center",style:w,children:[g.jsx("div",{className:"flex flex-col-reverse items-center gap-4 mb-4",children:c&&v.map((y,_)=>g.jsx("div",{className:`transition-all duration-300 ease-in-out ${a?"opacity-100 translate-y-0":"opacity-0 translate-y-4"}`,style:{transitionDelay:a?`${(v.length-1-_)*50}ms`:"0ms"},children:g.jsx("button",{onClick:y.onClick,tabIndex:a?0:-1,className:`flex justify-center items-center w-14 h-14 ${y.bgColor} text-white rounded-full shadow-lg ${y.hoverBgColor} focus:outline-none`,"aria-label":y.label,children:y.icon})},y.label))}),g.jsx("button",{onClick:()=>i(!a),className:`pointer-events-auto flex justify-center items-center w-16 h-16 bg-indigo-600 text-white rounded-full shadow-lg hover:bg-indigo-700 transition-all transform duration-500 ease-in-out focus:outline-none ${s?"opacity-100 translate-y-0 scale-100":"opacity-0 translate-y-16 scale-90"}`,"aria-expanded":a,"aria-label":a?"Chiudi menu azioni":"Apri menu azioni",children:g.jsx("div",{className:`transition-transform duration-300 ease-in-out ${a?"rotate-45":""}`,children:g.jsx(Kce,{className:"w-8 h-8"})})})]})},Qce="https://script.google.com/macros/s/AKfycbyZpH2rET4JNs35Ye_tewdpszsHLLRfLr6C-7qFKH_Xe1zg_vhHB8kaRyWQjAqG7-frVg/exec",Jce=3e4;async function _D(e){const t=new AbortController,r=setTimeout(()=>t.abort(),Jce);try{console.log(`[AI] Invio richiesta... Payload size: ${JSON.stringify(e).length}`);const n=await fetch(Qce,{method:"POST",mode:"cors",cache:"no-cache",credentials:"omit",headers:{"Content-Type":"text/plain;charset=utf-8"},body:JSON.stringify(e),signal:t.signal});if(clearTimeout(r),!n.ok){const i=await n.text();throw console.error(`[AI] Errore HTTP ${n.status}:`,i),new Error(`Errore server: ${n.status}`)}const a=await n.text();try{return JSON.parse(a)}catch{throw console.error("[AI] Errore parsing JSON. Risposta grezza:",a),new Error("Il server ha restituito una risposta non valida.")}}catch(n){throw clearTimeout(r),console.error("AI Call Error:",n),n.name==="AbortError"?new Error("Tempo scaduto. Il server ci sta mettendo troppo tempo."):n}}async function eue(e){return new Promise((t,r)=>{const n=new FileReader;n.onloadend=()=>{const a=n.result,i=a.indexOf(",");t(i===-1?a:a.slice(i+1))},n.onerror=r,n.readAsDataURL(e)})}async function tue(e,t){const r=await _D({action:"parseImage",imageBase64:e,mimeType:t});if(!r.ok)throw new Error(r.error||"Errore analisi immagine.");return r.expenses||[]}async function SD(e){if(!e||e.size===0)throw new Error("Registrazione vuota o non valida.");const t=e.type||"audio/webm",r=await eue(e),n=await _D({action:"parseVoice",audioBase64:r,mimeType:t});if(!n.ok)throw new Error(n.error||"Errore analisi vocale.");return n.expense||null}const rue=Object.freeze(Object.defineProperty({__proto__:null,parseExpenseFromAudio:SD,parseExpensesFromImage:tue},Symbol.toStringTag,{value:"Module"})),nue=({isOpen:e,onClose:t,onParsed:r})=>{const[n,a]=D.useState(!1),[i,s]=D.useState("idle"),[o,c]=D.useState(""),[u,d]=D.useState(null),h=D.useRef(null),p=D.useRef(null),v=D.useRef([]),x=D.useRef(!1),w=D.useRef(null),y=D.useRef(null),_=D.useRef(null),S=D.useRef(null),k=D.useRef(null),E=()=>{if(S.current!==null&&(cancelAnimationFrame(S.current),S.current=null),y.current=null,_.current=null,w.current){try{w.current.close()}catch{}w.current=null}},T=()=>{try{h.current&&h.current.state!=="inactive"&&h.current.stop()}catch(H){console.warn("Errore nello stop del MediaRecorder:",H)}p.current&&p.current.getTracks().forEach(H=>H.stop()),h.current=null,p.current=null,v.current=[],E()},N=async H=>{try{const V=window.AudioContext||window.webkitAudioContext;if(!V){console.warn("AudioContext non supportato: niente visualizzazione onda.");return}const J=new V;if(w.current=J,J.state==="suspended")try{await J.resume()}catch{}const te=J.createMediaStreamSource(H),q=J.createAnalyser();q.fftSize=256,te.connect(q),y.current=q;const oe=q.frequencyBinCount;_.current=new Uint8Array(oe);const Q=()=>{if(!y.current||!_.current||!k.current)return;y.current.getByteTimeDomainData(_.current);let Z=0;for(let de=0;de<oe;de++){const Te=_.current[de];Z+=Math.abs(Te-128)}const ce=.2+Z/oe/128*1.8;k.current.style.transform=`scaleY(${ce})`,S.current=requestAnimationFrame(Q)};Q()}catch(V){console.warn("Errore inizializzando la visualizzazione audio:",V)}},C=async()=>{d(null),c(""),x.current=!1;try{const H=await navigator.mediaDevices.getUserMedia({audio:!0});p.current=H;const V=MediaRecorder.isTypeSupported("audio/webm;codecs=opus")?"audio/webm;codecs=opus":"audio/webm",J=new MediaRecorder(H,{mimeType:V});h.current=J,v.current=[],J.ondataavailable=te=>{te.data&&te.data.size>0&&v.current.push(te.data)},J.onstop=async()=>{if(x.current)return;const te=new Blob(v.current,{type:V});s("processing");try{const q=await SD(te);if(x.current)return;if(q&&typeof q.amount=="number"&&!Number.isNaN(q.amount))c(q.description??""),r({description:q.description??"",amount:q.amount,category:q.category||void 0});else if(q&&q.description)c(q.description),r({description:q.description,amount:q.amount,category:q.category||void 0});else{d('Non sono riuscito a capire la spesa. Prova a dire, ad esempio: "25 euro per spesa al supermercato, categoria Spesa".'),s("error");return}}catch(q){if(x.current)return;console.error("[Voice] Errore durante analisi audio:",q),d("Si  verificato un errore durante l'analisi vocale."),s("error");return}finally{T()}},J.start(),s("listening"),await N(H)}catch(H){console.error("[Voice] Accesso microfono fallito:",H),d("Accesso al microfono negato. Controlla le autorizzazioni del browser / PWA."),s("error")}},P=()=>{i==="listening"&&(h.current&&h.current.state==="recording"&&h.current.stop(),p.current&&p.current.getTracks().forEach(H=>H.stop()))},j=()=>{x.current=!0,T(),s("idle"),d(null),c(""),t()};if(D.useEffect(()=>{if(e){const H=setTimeout(()=>a(!0),10);return C(),()=>{clearTimeout(H),x.current=!0,T()}}else a(!1),s("idle"),d(null),c(""),x.current=!0,T()},[e]),!e)return null;const R=()=>{switch(i){case"listening":return{icon:g.jsxs("button",{type:"button",onClick:P,className:"relative w-28 h-28 flex items-center justify-center focus:outline-none","aria-label":"Termina registrazione e analizza",children:[g.jsx("div",{className:"absolute inset-0 rounded-full bg-red-500/30 animate-ping"}),g.jsx("div",{className:"relative w-24 h-24 rounded-full bg-red-500 flex items-center justify-center shadow-lg",children:g.jsx(bD,{className:"w-12 h-12 text-white"})}),g.jsx("div",{className:"absolute -right-6 h-20 w-3 rounded-full bg-red-200 overflow-hidden flex items-end",children:g.jsx("div",{ref:k,className:"w-full bg-red-600 origin-bottom",style:{transform:"scaleY(0.2)"}})})]}),text:"In ascolto...",subtext:"Parla vicino al microfono. Quando hai finito, tocca il cerchio rosso per analizzare la spesa."};case"processing":return{icon:g.jsx("div",{className:"w-24 h-24 rounded-full bg-indigo-500 flex items-center justify-center",children:g.jsx("div",{className:"w-12 h-12 animate-spin rounded-full border-4 border-t-transparent border-white"})}),text:"Elaborazione...",subtext:"Sto analizzando la tua registrazione."};case"error":return{icon:g.jsx("div",{className:"w-24 h-24 rounded-full bg-red-100 flex items-center justify-center",children:g.jsx(fn,{className:"w-12 h-12 text-red-500"})}),text:"Errore",subtext:u||"Qualcosa  andato storto."};default:return{icon:null,text:"",subtext:""}}},{icon:I,text:F,subtext:L}=R();return g.jsx("div",{className:`fixed inset-0 z-50 flex justify-center items-center p-4 transition-opacity duration-300 ease-in-out ${n?"opacity-100":"opacity-0"} bg-slate-900/50 backdrop-blur-sm`,onClick:j,"aria-modal":"true",role:"dialog",children:g.jsxs("div",{className:`bg-slate-50 rounded-lg shadow-xl w-full max-w-lg transform transition-all duration-300 ease-in-out ${n?"scale-100 opacity-100":"scale-95 opacity-0"}`,onClick:H=>H.stopPropagation(),children:[g.jsxs("div",{className:"flex justify-between items-center p-6 border-b border-slate-200",children:[g.jsx("h2",{className:"text-xl font-bold text-slate-800",children:"Aggiungi con Voce"}),g.jsx("button",{type:"button",onClick:j,className:"text-slate-500 hover:text-slate-800 transition-colors p-1 rounded-full hover:bg-slate-200 focus:outline-none focus:ring-2 focus:ring-indigo-500","aria-label":"Chiudi",children:g.jsx(fn,{className:"w-6 h-6"})})]}),g.jsxs("div",{className:"p-6 flex flex-col items-center justify-center min-h-[300px] text-center",children:[I,g.jsx("p",{className:"text-xl font-semibold text-slate-800 mt-6",children:F}),g.jsx("p",{className:"text-slate-500 mt-2",children:L}),o&&g.jsxs("div",{className:"mt-6 p-3 bg-slate-100 rounded-md w-full text-left",children:[g.jsx("p",{className:"text-sm text-slate-600 font-medium",children:"Descrizione rilevata:"}),g.jsx("p",{className:"text-slate-800 break-words",children:o})]}),i==="error"&&g.jsx("button",{type:"button",onClick:C,className:"mt-6 px-4 py-2 rounded-lg bg-indigo-600 text-white font-semibold hover:bg-indigo-700 transition-colors",children:"Riprova registrazione"})]})]})})},aue=e=>g.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...e,children:g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m16.862 4.487 1.687-1.688a1.875 1.875 0 1 1 2.652 2.652L10.582 16.07a4.5 4.5 0 0 1-1.897 1.13L6 18l.8-2.685a4.5 4.5 0 0 1 1.13-1.897l8.932-8.931Zm0 0L19.5 7.125M18 14v4.75A2.25 2.25 0 0 1 15.75 21H5.25A2.25 2.25 0 0 1 3 18.75V8.25A2.25 2.25 0 0 1 5.25 6H10"})}),$N=e=>{const t=e.getFullYear(),r=String(e.getMonth()+1).padStart(2,"0"),n=String(e.getDate()).padStart(2,"0");return`${t}-${r}-${n}`},iue=()=>new Date().toLocaleTimeString("it-IT",{hour:"2-digit",minute:"2-digit"}),UN=({checked:e,onChange:t,id:r,label:n})=>g.jsxs("div",{className:"flex items-center",children:[g.jsx("input",{id:r,type:"checkbox",checked:e,onChange:t,className:"h-5 w-5 rounded border-slate-300 text-indigo-600 focus:ring-indigo-500 cursor-pointer"}),g.jsx("label",{htmlFor:r,className:"ml-2 text-sm font-medium text-slate-700 sr-only",children:n})]}),a2=({label:e,value:t,onClick:r,placeholder:n,ariaLabel:a,disabled:i,icon:s})=>{const o=t&&t!==n&&t!=="";return g.jsxs("div",{children:[g.jsx("label",{className:`block text-sm font-medium text-slate-700 mb-1 transition-colors ${i?"text-slate-400":"text-slate-700"}`,children:e}),g.jsx("button",{type:"button",onClick:r,"aria-label":a,disabled:i,className:`w-full flex items-center justify-between text-left gap-2 px-3 py-2.5 text-sm rounded-lg border shadow-sm focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 transition-colors ${i?"bg-slate-100 border-slate-200 text-slate-400 cursor-not-allowed":o?"bg-indigo-50 border-indigo-200 text-indigo-700 hover:bg-indigo-100":"bg-white border-slate-300 text-slate-500 hover:bg-slate-50"}`,children:g.jsxs("div",{className:"flex items-center gap-2 min-w-0",children:[s,g.jsx("span",{className:"truncate",children:t||n})]})})]})},sue=({isOpen:e,onClose:t,expenses:r,accounts:n,onConfirm:a})=>{var I;const[i,s]=D.useState(!1),[o,c]=D.useState([]),[u,d]=D.useState(new Set),[h,p]=D.useState(null),[v,x]=D.useState(null);D.useEffect(()=>{if(e){const F=n.length>0?n[0].id:"",L=r.map(V=>({...V,accountId:V.accountId||F}));c(L),d(new Set(r.map((V,J)=>J))),p(null),x(null);const H=setTimeout(()=>s(!0),10);return()=>clearTimeout(H)}else s(!1)},[e,r,n]);const w=F=>{const L=new Set(u);L.has(F)?L.delete(F):L.add(F),d(L)},y=()=>{u.size===o.length?d(new Set):d(new Set(o.map((F,L)=>L)))},_=(F,L,H)=>{c(V=>V.map((J,te)=>{if(te!==F)return J;const q={...J,[L]:H};return L==="category"&&(q.subcategory=""),q}))},S=(F,L)=>{v&&(_(v.index,F,L),x(null))},k=F=>{p(L=>L===F?null:F)},E=()=>{const F=o.filter((L,H)=>u.has(H)).map(L=>({description:L.description||"Senza descrizione",amount:L.amount,date:L.date||$N(new Date),time:L.time||iue(),category:L.category||"Altro",subcategory:L.subcategory||void 0,accountId:L.accountId,tags:L.tags||[],receipts:[]})).filter(L=>L.amount>0);F.length>0&&a(F),t()};if(!e)return null;const T=u.size===o.length&&o.length>0,N=$N(new Date),C=Object.keys(da).map(F=>({value:F,label:Qr(F).label,Icon:Qr(F).Icon,color:Qr(F).color,bgColor:Qr(F).bgColor})),P=n.map(F=>({value:F.id,label:F.name})),j=v?o[v.index]:null,R=j!=null&&j.category?((I=da[j.category])==null?void 0:I.map(F=>({value:F,label:F})))||[]:[];return g.jsxs("div",{className:`fixed inset-0 z-[5200] flex justify-center items-center p-4 transition-opacity duration-75 ease-in-out ${i?"opacity-100":"opacity-0"} bg-slate-900/60 backdrop-blur-sm overflow-y-auto`,onClick:t,"aria-modal":"true",role:"dialog",children:[g.jsxs("div",{className:`bg-slate-50 rounded-lg shadow-xl w-full max-w-3xl transform transition-all duration-75 ease-in-out ${i?"scale-100 opacity-100":"scale-95 opacity-0"}`,onClick:F=>F.stopPropagation(),style:{maxHeight:"90vh",display:"flex",flexDirection:"column"},children:[g.jsxs("div",{className:"flex justify-between items-center p-6 border-b border-slate-200 sticky top-0 bg-slate-50/80 backdrop-blur-sm rounded-t-lg z-20 flex-shrink-0",children:[g.jsxs("div",{children:[g.jsx("h2",{className:"text-xl font-bold text-slate-800",children:"Spese Rilevate"}),g.jsxs("p",{className:"text-sm text-slate-500",children:["Abbiamo trovato ",r.length," spese. Seleziona e modifica i dettagli prima di aggiungerle."]})]}),g.jsx("button",{type:"button",onClick:t,className:"text-slate-500 hover:text-slate-800 transition-colors p-1 rounded-full hover:bg-slate-200 focus:outline-none focus:ring-2 focus:ring-indigo-500","aria-label":"Chiudi",children:g.jsx(fn,{className:"w-6 h-6"})})]}),g.jsxs("div",{className:"p-6 overflow-y-auto flex-1",children:[g.jsxs("div",{className:"flex items-center bg-slate-100 p-2 rounded-md mb-4 border border-slate-200",children:[g.jsx(UN,{id:"select-all",checked:T,onChange:y,label:"Seleziona tutto"}),g.jsx("label",{htmlFor:"select-all",className:"ml-3 text-sm font-medium text-slate-700 cursor-pointer",children:"Seleziona / Deseleziona tutto"})]}),g.jsx("div",{className:"space-y-3",children:o.map((F,L)=>{var oe;const H=u.has(L),V=h===L,J=F.category&&da[F.category]||[],te=(oe=n.find(Q=>Q.id===F.accountId))==null?void 0:oe.name,q=F.category?Qr(F.category).label:void 0;return g.jsxs("div",{className:`bg-white rounded-lg shadow-sm border ${H?"border-indigo-400":"border-slate-200"} transition-all duration-300 animate-fade-in-up`,style:{animationDelay:`${L*50}ms`,zIndex:V?10:1},children:[g.jsxs("div",{className:"p-3 flex items-center gap-3",children:[g.jsx(UN,{id:`expense-${L}`,checked:H,onChange:()=>w(L),label:`Seleziona spesa ${F.description}`}),g.jsx("input",{type:"date",value:F.date||"",onChange:Q=>_(L,"date",Q.target.value),max:N,className:"text-sm rounded-md border border-slate-300 bg-white py-1.5 px-2 text-slate-900 placeholder:text-slate-400 focus:outline-none focus:border-indigo-500 focus:ring-1 focus:ring-indigo-500"}),g.jsx("div",{className:"flex-grow"}),g.jsx("p",{className:"text-lg font-bold text-indigo-600 shrink-0",children:Ti(F.amount||0)}),g.jsx("button",{onClick:()=>k(L),className:"p-2 text-slate-500 hover:text-indigo-600 hover:bg-indigo-100 rounded-full transition-colors flex-shrink-0","aria-label":"Modifica dettagli spesa",children:g.jsx(aue,{className:"w-5 h-5"})})]}),V&&g.jsxs("div",{className:"p-4 border-t border-slate-200 bg-slate-50/70 space-y-4",children:[g.jsxs("div",{children:[g.jsx("label",{htmlFor:`description-${L}`,className:"block text-sm font-medium text-slate-700 mb-1",children:"Descrizione"}),g.jsxs("div",{className:"relative",children:[g.jsx("div",{className:"pointer-events-none absolute inset-y-0 left-0 flex items-center pl-3",children:g.jsx(z_,{className:"h-5 w-5 text-slate-400","aria-hidden":"true"})}),g.jsx("input",{type:"text",id:`description-${L}`,value:F.description||"",onChange:Q=>_(L,"description",Q.target.value),className:"block w-full rounded-md border border-slate-300 bg-white py-2 pl-10 pr-3 text-slate-900 placeholder:text-slate-400 focus:outline-none focus:border-indigo-500 focus:ring-1 focus:ring-indigo-500 sm:text-sm",placeholder:"Es. Spesa al supermercato"})]})]}),g.jsxs("div",{className:"grid grid-cols-1 gap-4 sm:grid-cols-3",children:[g.jsx(a2,{label:"Conto",value:te,onClick:()=>x({index:L,type:"account"}),placeholder:"Seleziona",ariaLabel:"Seleziona conto di pagamento",icon:g.jsx(Xp,{className:"h-5 w-5 text-slate-400"})}),g.jsx(a2,{label:"Categoria",value:q,onClick:()=>x({index:L,type:"category"}),placeholder:"Seleziona",ariaLabel:"Seleziona categoria",icon:g.jsx(Bf,{className:"h-5 w-5 text-slate-400"})}),g.jsx(a2,{label:"Sottocategoria",value:F.subcategory,onClick:()=>x({index:L,type:"subcategory"}),placeholder:"Nessuna",ariaLabel:"Seleziona sottocategoria",icon:g.jsx(Bf,{className:"h-5 w-5 text-slate-400"}),disabled:!F.category||J.length===0})]})]})]},L)})})]}),g.jsxs("div",{className:"px-6 py-4 bg-slate-100 border-t border-slate-200 flex justify-end gap-3 sticky bottom-0 rounded-b-lg flex-shrink-0",children:[g.jsx("button",{type:"button",onClick:t,className:"px-4 py-2 text-sm font-semibold text-slate-700 bg-white border border-slate-300 rounded-lg shadow-sm hover:bg-slate-100 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2 transition-colors",children:"Annulla"}),g.jsxs("button",{type:"button",onClick:E,disabled:u.size===0,className:"px-4 py-2 text-sm font-semibold text-white bg-indigo-600 rounded-lg shadow-sm hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2 transition-colors disabled:bg-indigo-300 disabled:cursor-not-allowed",children:["Aggiungi ",u.size," Spes",u.size!==1?"e":"a"]})]})]}),g.jsx(oi,{isOpen:(v==null?void 0:v.type)==="account",onClose:()=>x(null),title:"Seleziona un Conto",options:P,selectedValue:(j==null?void 0:j.accountId)||"",onSelect:F=>S("accountId",F)}),g.jsx(oi,{isOpen:(v==null?void 0:v.type)==="category",onClose:()=>x(null),title:"Seleziona una Categoria",options:C,selectedValue:(j==null?void 0:j.category)||"",onSelect:F=>S("category",F)}),g.jsx(oi,{isOpen:(v==null?void 0:v.type)==="subcategory",onClose:()=>x(null),title:"Seleziona Sottocategoria",options:R,selectedValue:(j==null?void 0:j.subcategory)||"",onSelect:F=>S("subcategory",F)})]})},fc=e=>g.jsxs("svg",{className:"animate-spin",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",...e,children:[g.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),g.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),o0=e=>g.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...e,children:g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m14.74 9-.346 9m-4.788 0L9.26 9m9.968-3.21c.342.052.682.107 1.022.166m-1.022-.165L18.16 19.673a2.25 2.25 0 0 1-2.244 2.077H8.084a2.25 2.25 0 0 1-2.244-2.077L4.772 5.79m14.456 0a48.108 48.108 0 0 0-3.478-.397m-12 .562c.34-.059.68-.114 1.022-.165m0 0a48.11 48.11 0 0 1 3.478-.397m7.5 0v-.916c0-1.18-.91-2.164-2.09-2.201a51.964 51.964 0 0 0-3.32 0c-1.18.037-2.09 1.022-2.09 2.201v.916m7.5 0a48.667 48.667 0 0 0-7.5 0"})}),oue=({images:e,onAnalyze:t,onDelete:r,isOnline:n,syncingImageId:a})=>{const[i,s]=D.useState(!1),o=vs();if(!e||e.length===0)return null;const c=!!a;return g.jsxs("div",{className:"bg-white rounded-2xl shadow-lg",children:[g.jsxs("button",{className:"w-full flex items-center justify-between p-6 focus:outline-none focus:ring-2 focus:ring-indigo-500/50 rounded-2xl",onClick:()=>s(!i),"aria-expanded":i,...o,children:[g.jsxs("div",{className:"flex items-center gap-3",children:[g.jsx("h2",{className:"text-xl font-bold text-slate-700",children:"Immagini in Attesa"}),g.jsx("span",{className:"flex items-center justify-center min-w-[24px] h-6 px-2 text-sm font-semibold text-white bg-indigo-500 rounded-full",children:e.length})]}),g.jsx(Ua,{className:`w-6 h-6 text-slate-500 transition-transform duration-300 ${i?"rotate-180":""}`})]}),i&&g.jsxs("div",{className:"px-6 pb-6 animate-fade-in-up",style:{animationDuration:"300ms"},children:[g.jsx("p",{className:"text-sm text-slate-500 mb-6 border-t border-slate-200 pt-6",children:'Queste immagini sono state salvate mentre eri offline. Clicca su "Analizza" per processarle ora che sei online.'}),g.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 gap-4",children:e.map(u=>g.jsxs("div",{className:"border border-slate-200 shadow-sm flex flex-col group rounded-lg",children:[g.jsxs("div",{className:"relative",children:[g.jsx("img",{src:`data:${u.mimeType};base64,${u.base64Image}`,alt:"Anteprima spesa offline",className:"w-full h-24 object-cover bg-slate-100 rounded-t-lg"}),a===u.id&&g.jsxs("div",{className:"absolute inset-0 bg-white/80 backdrop-blur-sm flex items-center justify-center rounded-t-lg",children:[g.jsx(fc,{className:"w-8 h-8 text-indigo-600"}),g.jsx("span",{className:"sr-only",children:"Analisi in corso..."})]})]}),g.jsxs("div",{className:"p-2 mt-auto flex items-center justify-center gap-2 bg-slate-50 rounded-b-lg",children:[g.jsx("button",{onClick:()=>t(u),disabled:!n||c,className:"flex-1 px-2 py-1.5 text-xs font-semibold text-white bg-indigo-600 rounded-md shadow-sm hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2 transition-colors disabled:bg-indigo-400 disabled:cursor-not-allowed",title:n?"Analizza immagine":"Connettiti a internet per analizzare",...o,children:"Analizza"}),g.jsx("button",{onClick:()=>r(u.id),disabled:c,className:"p-1.5 text-slate-500 hover:text-red-600 hover:bg-red-100 rounded-md transition-colors disabled:opacity-50 disabled:cursor-not-allowed","aria-label":"Elimina immagine in attesa",...o,children:g.jsx(o0,{className:"w-5 h-5"})})]})]},u.id))})]})]})},lue={success:{icon:mD,bgColor:"bg-green-600",textColor:"text-white",iconColor:"text-white",ringColor:"focus:ring-green-400"},info:{icon:H_,bgColor:"bg-sky-600",textColor:"text-white",iconColor:"text-white",ringColor:"focus:ring-sky-400"},error:{icon:W_,bgColor:"bg-red-600",textColor:"text-white",iconColor:"text-white",ringColor:"focus:ring-red-400"}},cue=({message:e,type:t,onClose:r})=>{const[n,a]=D.useState(!1),[i,s]=D.useState(null);D.useEffect(()=>{s(document.getElementById("toast-portal"))},[]);const{icon:o,bgColor:c,textColor:u,iconColor:d,ringColor:h}=lue[t],p=D.useCallback(()=>{a(!0),setTimeout(r,300)},[r]);D.useEffect(()=>{const x=setTimeout(p,3e3);return()=>clearTimeout(x)},[p]);const v=g.jsx("div",{role:"alert","aria-live":"assertive",className:`fixed transition-all duration-300 ease-in-out transform ${n?"translate-y-full opacity-0":"translate-y-0 opacity-100"} animate-fade-in-up`,style:{zIndex:9999,bottom:"calc(1.5rem + env(safe-area-inset-bottom, 0px))",left:"calc(1.5rem + env(safe-area-inset-left, 0px))",right:"calc(1.5rem + env(safe-area-inset-right, 0px))",pointerEvents:"auto",maxWidth:"400px",marginLeft:"auto",marginRight:"auto"},children:g.jsxs("div",{className:`rounded-lg shadow-lg p-2 grid grid-cols-[auto_1fr_auto] items-center gap-2 ${c}`,children:[g.jsx("div",{className:"flex-shrink-0",children:g.jsx(o,{className:`h-5 w-5 ${d}`,"aria-hidden":"true"})}),g.jsx("div",{className:"min-w-0",children:g.jsx("p",{className:`text-sm font-medium break-words ${u}`,children:e})}),g.jsx("div",{className:"flex-shrink-0 flex",children:g.jsxs("button",{type:"button",onClick:p,className:`inline-flex rounded-md p-1 transition-colors active:bg-black/20 focus:outline-none focus:ring-2 focus:ring-offset-2 ${h} ${c.replace("bg-","focus:ring-offset-")}`,children:[g.jsx("span",{className:"sr-only",children:"Chiudi"}),g.jsx(fn,{className:`h-5 w-5 ${u}`,"aria-hidden":"true"})]})})]})});return i?Pie.createPortal(v,i):null},uue=({expense:e,accounts:t,onEdit:r,onDelete:n,isOpen:a,onOpen:i,isSelectionMode:s,isSelected:o,onToggleSelection:c,onLongPress:u})=>{var R;const d=Qr(e.category),h=((R=t.find(I=>I.id===e.accountId))==null?void 0:R.name)||"Sconosciuto",p=D.useRef(null),v=vs(),x=!!e.recurringExpenseId,w=o?"bg-indigo-50 ring-1 ring-inset ring-indigo-200":x?"bg-amber-50":"bg-white",y=D.useRef(null),_=I=>{s||(y.current=window.setTimeout(()=>{u(e.id),navigator.vibrate&&navigator.vibrate(50)},500))},S=()=>{y.current&&(clearTimeout(y.current),y.current=null)},k=D.useRef({isDragging:!1,isLocked:!1,startX:0,startY:0,startTime:0,initialTranslateX:0,pointerId:null,wasHorizontal:!1}),E=D.useCallback((I,F)=>{p.current&&(p.current.style.transition=F?"transform 0.2s cubic-bezier(0.22,0.61,0.36,1)":"none",p.current.style.transform=`translateX(${I}px)`)},[]);D.useEffect(()=>{k.current.isDragging||E(a&&!s?-72:0,!0)},[a,s,E]);const T=I=>{if(_(),I.target.closest("button")||!p.current||s)return;p.current.style.transition="none";const L=new DOMMatrixReadOnly(window.getComputedStyle(p.current).transform).m41;k.current={isDragging:!1,isLocked:!1,startX:I.clientX,startY:I.clientY,startTime:performance.now(),initialTranslateX:L,pointerId:I.pointerId,wasHorizontal:!1};try{p.current.setPointerCapture(I.pointerId)}catch(H){console.warn("Could not capture pointer: ",H)}},N=I=>{var V;const F=k.current;if(y.current&&Math.hypot(I.clientX-F.startX,I.clientY-F.startY)>10&&S(),F.pointerId!==I.pointerId||s)return;const L=I.clientX-F.startX,H=I.clientY-F.startY;if(!F.isDragging)if(Math.hypot(L,H)>8)if(F.isDragging=!0,F.isLocked=Math.abs(L)>Math.abs(H)*2,F.isLocked)I.stopPropagation();else{F.pointerId!==null&&((V=p.current)==null||V.releasePointerCapture(F.pointerId)),F.pointerId=null,F.isDragging=!1;return}else return;if(F.isDragging&&F.isLocked){F.wasHorizontal=!0,I.cancelable&&I.preventDefault(),I.stopPropagation();let J=F.initialTranslateX+L;J>0&&(J=0),J<-72&&(J=-72),E(J,!1)}},C=I=>{var V;S();const F=k.current;if(F.pointerId!==I.pointerId)return;F.pointerId!==null&&((V=p.current)==null||V.releasePointerCapture(F.pointerId));const L=F.isDragging,H=F.wasHorizontal;if(F.isDragging=!1,F.pointerId=null,L&&H){const J=performance.now()-F.startTime,te=I.clientX-F.startX,q=new DOMMatrixReadOnly(window.getComputedStyle(p.current).transform).m41,oe=te/(J||1),Q=q<-72/2||oe<-.3&&te<-20;i(Q?e.id:""),E(Q?-72:0,!0)}setTimeout(()=>{k.current.wasHorizontal=!1},0)},P=I=>{var L;S();const F=k.current;F.pointerId===I.pointerId&&(F.pointerId!==null&&((L=p.current)==null||L.releasePointerCapture(F.pointerId)),F.isDragging=!1,F.isLocked=!1,F.pointerId=null,F.wasHorizontal=!1,E(a?-72:0,!0))},j=I=>{I.stopPropagation(),!(k.current.isDragging||k.current.wasHorizontal)&&(s?c(e.id):a?i(""):r(e))};return g.jsxs("div",{className:`relative ${w} overflow-hidden transition-colors duration-200 select-none`,children:[g.jsx("div",{className:"absolute top-0 right-0 h-full flex items-center z-0",children:g.jsxs("button",{onClick:()=>n(e.id),className:"w-[72px] h-full flex flex-col items-center justify-center bg-red-600 text-white text-xs font-semibold focus:outline-none focus:visible:ring-2 focus:visible:ring-inset focus:visible:ring-white","aria-label":"Elimina spesa",...v,children:[g.jsx(o0,{className:"w-6 h-6"}),g.jsx("span",{className:"text-xs mt-1",children:"Elimina"})]})}),g.jsxs("div",{ref:p,"data-expense-swipe":"1",onPointerDown:T,onPointerMove:N,onPointerUp:C,onPointerCancel:P,onClick:j,className:`relative flex items-center gap-4 py-3 px-4 ${w} z-10 cursor-pointer transition-colors duration-200 select-none`,style:{touchAction:"pan-y"},children:[x&&!s&&g.jsx("span",{className:"absolute top-1.5 right-1.5 w-5 h-5 text-slate-900 bg-amber-100 border border-amber-400 text-[10px] font-bold rounded-full flex items-center justify-center z-20",title:"Spesa Programmata",children:"P"}),o?g.jsx("span",{className:"w-10 h-10 rounded-xl flex-shrink-0 flex items-center justify-center bg-indigo-600 text-white transition-transform duration-200 transform scale-100",children:g.jsx(Ni,{className:"w-6 h-6",strokeWidth:3})}):g.jsx("span",{className:`w-10 h-10 rounded-xl flex-shrink-0 flex items-center justify-center ${d.bgColor} transition-transform duration-200`,children:g.jsx(d.Icon,{className:`w-6 h-6 ${d.color}`})}),g.jsxs("div",{className:"flex-grow min-w-0",children:[g.jsxs("p",{className:`font-semibold truncate ${o?"text-indigo-900":"text-slate-800"}`,children:[e.subcategory||d.label,"  ",h]}),g.jsx("p",{className:`text-sm truncate ${o?"text-indigo-700":"text-slate-500"}`,title:e.description,children:e.description||"Senza descrizione"})]}),g.jsx("p",{className:`font-bold text-lg text-right shrink-0 whitespace-nowrap min-w-[90px] ${o?"text-indigo-900":"text-slate-900"}`,children:Ti(Number(e.amount)||0)})]})]})},kD=e=>{const t=new Date(Date.UTC(e.getFullYear(),e.getMonth(),e.getDate())),r=t.getUTCDay()||7;t.setUTCDate(t.getUTCDate()+4-r);const n=new Date(Date.UTC(t.getUTCFullYear(),0,1));return[t.getUTCFullYear(),Math.ceil(((t.getTime()-n.getTime())/864e5+1)/7)]},fue=(e,t)=>{const r=new Date(Date.UTC(e,0,4)),n=r.getUTCDay()||7,a=new Date(r);a.setUTCDate(r.getUTCDate()-(n-1)+(t-1)*7);const i=new Date(a);i.setUTCDate(a.getUTCDate()+6);const s=o=>{const c=String(o.getUTCDate()).padStart(2,"0"),u=o.toLocaleString("it-IT",{month:"short",timeZone:"UTC"}).replace(".","");return`${c}${u}`};return`(${s(a)}-${s(i)} ${e})`},due=(e,t)=>{const r=new Date,[n,a]=kD(r);if(e===n){if(t===a)return"Questa Settimana";if(t===a-1)return"Settimana Scorsa"}return`Settimana ${t}`},Ls=e=>{const t=e.split("-").map(Number);return new Date(t[0],t[1]-1,t[2])},hue=({expenses:e,accounts:t,onEditExpense:r,onDeleteExpense:n,onDeleteExpenses:a,isEditingOrDeleting:i,onDateModalStateChange:s,onClose:o,onCloseStart:c,onFilterPanelOpenStateChange:u,isOverlayed:d})=>{const[h,p]=D.useState(!1),v=vs(),[x,w]=D.useState("quick"),[y,_]=D.useState("all"),[S,k]=D.useState({start:null,end:null}),[E,T]=D.useState("week"),[N,C]=D.useState(()=>{const De=new Date;return De.setHours(0,0,0,0),De}),[P,j]=D.useState(null),[R,I]=D.useState(new Set),[F,L]=D.useState(""),[H,V]=D.useState({min:"",max:""}),[J,te]=D.useState("date"),[q,oe]=D.useState(!1),Q=D.useRef(null),Z=D.useRef(null),[ee,ce]=D.useState(null),[de,Te]=D.useState(!1),[Ie,Ne]=D.useState(new Set),[W,z]=D.useState(!1),G=D.useRef(null),X=D.useRef(i),ie=Ie.size>0;D.useEffect(()=>{const De=setTimeout(()=>p(!0),10);return()=>clearTimeout(De)},[]);const M=()=>{ce(null),c&&c(),p(!1),setTimeout(o,300)},le=D.useCallback(De=>{Te(De),s(De)},[s]);D.useEffect(()=>{X.current&&!i&&ce(null),X.current=i},[i]),D.useEffect(()=>{h||ce(null)},[h]),D.useEffect(()=>(G.current&&clearTimeout(G.current),ee&&!i&&(G.current=window.setTimeout(()=>ce(null),5e3)),()=>{G.current&&clearTimeout(G.current)}),[ee,i]),D.useEffect(()=>{const De=Oe=>{q&&Z.current&&!Z.current.contains(Oe.target)&&Q.current&&!Q.current.contains(Oe.target)&&oe(!1)};return document.addEventListener("mousedown",De),()=>document.removeEventListener("mousedown",De)},[q]);const ye=D.useMemo(()=>{let De=e||[];if(x==="period"){const Oe=new Date(N);Oe.setHours(0,0,0,0);const Qe=new Date(N);switch(Qe.setHours(23,59,59,999),E){case"day":break;case"week":{const at=Oe.getDay(),bt=Oe.getDate()-at+(at===0?-6:1);Oe.setDate(bt),Qe.setDate(Oe.getDate()+6);break}case"month":Oe.setDate(1),Qe.setMonth(Qe.getMonth()+1),Qe.setDate(0);break;case"year":Oe.setMonth(0,1),Qe.setFullYear(Qe.getFullYear()+1),Qe.setMonth(0,0);break}const kt=Oe.getTime(),Re=Qe.getTime();De=De.filter(at=>{const bt=Ls(at.date);if(isNaN(bt.getTime()))return!1;const Yt=bt.getTime();return Yt>=kt&&Yt<=Re})}else if(x==="custom"&&S.start&&S.end){const Oe=Ls(S.start).getTime(),Qe=Ls(S.end);Qe.setDate(Qe.getDate()+1);const kt=Qe.getTime();De=De.filter(Re=>{const at=Ls(Re.date);if(isNaN(at.getTime()))return!1;const bt=at.getTime();return bt>=Oe&&bt<kt})}else if(y!=="all"){const Oe=new Date;switch(Oe.setHours(0,0,0,0),y){case"7d":Oe.setDate(Oe.getDate()-6);break;case"30d":Oe.setDate(Oe.getDate()-29);break;case"6m":Oe.setMonth(Oe.getMonth()-6);break;case"1y":Oe.setFullYear(Oe.getFullYear()-1);break}const Qe=Oe.getTime();De=De.filter(kt=>{const Re=Ls(kt.date);return!isNaN(Re.getTime())&&Re.getTime()>=Qe})}if(P&&(De=De.filter(Oe=>Oe.accountId===P)),R.size>0&&(De=De.filter(Oe=>{const Qe=Oe.category,kt=`${Oe.category}:${Oe.subcategory||""}`;return!!(R.has(Qe)||Oe.subcategory&&R.has(kt))})),F.trim()){const Oe=F.toLowerCase();De=De.filter(Qe=>(Qe.description||"").toLowerCase().includes(Oe))}if(H.min){const Oe=parseFloat(H.min);isNaN(Oe)||(De=De.filter(Qe=>Qe.amount>=Oe))}if(H.max){const Oe=parseFloat(H.max);isNaN(Oe)||(De=De.filter(Qe=>Qe.amount<=Oe))}return De},[e,x,y,S,E,N,P,R,F,H]),Ce=D.useMemo(()=>{const De=[...ye||[]].sort((Oe,Qe)=>{if(J==="amount-desc")return Qe.amount-Oe.amount;if(J==="amount-asc")return Oe.amount-Qe.amount;if(J==="category")return Oe.category.localeCompare(Qe.category);{const kt=Ls(Qe.date),Re=Ls(Oe.date);if(Qe.time){const[at,bt]=Qe.time.split(":").map(Number);!isNaN(at)&&!isNaN(bt)&&kt.setHours(at,bt)}if(Oe.time){const[at,bt]=Oe.time.split(":").map(Number);!isNaN(at)&&!isNaN(bt)&&Re.setHours(at,bt)}return kt.getTime()-Re.getTime()}});if(J!=="date"){const Oe=De.reduce((kt,Re)=>kt+(Number(Re.amount)||0),0);let Qe="Tutte le spese";return J==="amount-desc"&&(Qe="Per Importo (Decrescente)"),J==="amount-asc"&&(Qe="Per Importo (Crescente)"),J==="category"&&(Qe="Per Categoria"),{global:{year:0,week:0,label:Qe,dateRange:`${De.length} risultati`,expenses:De,total:Oe}}}return De.reduce((Oe,Qe)=>{const kt=Ls(Qe.date);if(isNaN(kt.getTime()))return Oe;const[Re,at]=kD(kt),bt=`${Re}-${at}`;return Oe[bt]||(Oe[bt]={year:Re,week:at,label:due(Re,at),dateRange:fue(Re,at),expenses:[],total:0}),Oe[bt].expenses.push(Qe),Oe[bt].total+=Number(Qe.amount)||0,Oe},{})},[ye,J]),ze=Object.values(Ce).sort((De,Oe)=>De.year!==Oe.year?Oe.year-De.year:Oe.week-De.week),Ze=De=>ce(De||null),rt=De=>{I(Oe=>{const Qe=new Set(Oe);return Qe.has(De)?Qe.delete(De):Qe.add(De),Qe})},xt=()=>I(new Set),mt=De=>{Ne(new Set([De])),navigator.vibrate&&navigator.vibrate(50)},Ee=De=>{Ne(Oe=>{const Qe=new Set(Oe);return Qe.has(De)?Qe.delete(De):Qe.add(De),Qe})},ve=()=>{Ne(new Set)},fe=()=>{Ie.size>0&&z(!0)},pe=()=>{a(Array.from(Ie)),z(!1),Ne(new Set)},nt=De=>{te(De==="amount"?Oe=>Oe==="amount-desc"?"amount-asc":"amount-desc":De),oe(!1)};return g.jsxs("div",{className:`fixed inset-0 z-20 bg-slate-100 transform transition-transform duration-300 ease-in-out ${h?"translate-y-0 pointer-events-auto":"translate-y-full pointer-events-none"}`,style:{touchAction:"pan-y",willChange:"transform",visibility:h?"visible":"hidden",transitionProperty:"transform, visibility",transitionDuration:"300ms, 0s",transitionDelay:h?"0s, 0s":"0s, 300ms"},onClick:()=>{ee&&ce(null)},...v,children:[g.jsx("header",{className:"sticky top-0 z-20 flex items-center gap-4 p-4 bg-white/80 backdrop-blur-sm shadow-sm h-[60px]",children:ie?g.jsxs(g.Fragment,{children:[g.jsx("button",{onClick:ve,className:"p-2 -ml-2 rounded-full hover:bg-slate-200 transition-colors text-slate-600","aria-label":"Annulla selezione",children:g.jsx(us,{className:"w-6 h-6"})}),g.jsxs("h1",{className:"text-xl font-bold text-indigo-800 flex-1",children:[Ie.size," Selezionati"]}),g.jsx("button",{onClick:fe,className:"p-2 rounded-full hover:bg-red-100 text-red-600 transition-colors","aria-label":"Elimina selezionati",children:g.jsx(o0,{className:"w-6 h-6"})})]}):g.jsxs(g.Fragment,{children:[g.jsx("button",{onClick:M,className:"p-2 -ml-2 rounded-full hover:bg-slate-200 transition-colors","aria-label":"Indietro",children:g.jsx(us,{className:"w-6 h-6 text-slate-700"})}),g.jsx("h1",{className:"text-xl font-bold text-slate-800 flex-1",children:"Storico Spese"}),g.jsxs("div",{className:"relative",children:[g.jsx("button",{ref:Q,onClick:De=>{De.stopPropagation(),oe(!q)},className:`p-2 rounded-full transition-colors ${J!=="date"?"bg-indigo-100 text-indigo-700":"hover:bg-slate-200 text-slate-600"}`,"aria-label":"Ordina spese",children:g.jsx(lD,{className:"w-6 h-6"})}),q&&g.jsx("div",{ref:Z,className:"absolute top-full right-0 mt-2 w-48 bg-white rounded-lg shadow-xl border border-slate-100 z-50 overflow-hidden animate-fade-in-up",style:{animationDuration:"150ms"},onPointerDown:De=>De.stopPropagation(),children:g.jsxs("div",{className:"py-1",children:[g.jsxs("button",{onClick:()=>nt("amount"),className:`w-full text-left px-4 py-2.5 text-sm font-semibold flex items-center justify-between hover:bg-slate-50 ${J==="amount-desc"||J==="amount-asc"?"text-indigo-600 bg-indigo-50":"text-slate-700"}`,children:[g.jsxs("span",{children:["Per Importo ",J==="amount-asc"?"(Crescente)":"(Decrescente)"]}),(J==="amount-desc"||J==="amount-asc")&&g.jsx(Ni,{className:"w-4 h-4"})]}),g.jsxs("button",{onClick:()=>nt("category"),className:`w-full text-left px-4 py-2.5 text-sm font-semibold flex items-center justify-between hover:bg-slate-50 ${J==="category"?"text-indigo-600 bg-indigo-50":"text-slate-700"}`,children:[g.jsx("span",{children:"Per Categoria"}),J==="category"&&g.jsx(Ni,{className:"w-4 h-4"})]}),g.jsx("div",{className:"border-t border-slate-100 my-1"}),g.jsxs("button",{onClick:()=>nt("date"),className:`w-full text-left px-4 py-2.5 text-sm font-semibold flex items-center justify-between hover:bg-slate-50 ${J==="date"?"text-indigo-600 bg-indigo-50":"text-slate-500"}`,children:[g.jsx("span",{children:"Per Data (Default)"}),J==="date"&&g.jsx(Ni,{className:"w-4 h-4"})]})]})})]})]})}),g.jsx("main",{className:"overflow-y-auto h-[calc(100%-60px)]",style:{touchAction:"pan-y"},children:g.jsx("div",{className:"flex-1 overflow-y-auto pb-36",style:{touchAction:"pan-y"},children:ze.length>0?ze.map(De=>g.jsxs("div",{className:"mb-6 last:mb-0",children:[g.jsxs("div",{className:"flex items-center justify-between font-bold text-slate-800 text-lg px-4 py-2 sticky top-0 bg-slate-100/80 backdrop-blur-sm z-10",children:[g.jsxs("h2",{className:"flex items-baseline flex-wrap gap-x-2",children:[g.jsxs("span",{children:[De.label,De.label.startsWith("Settimana")&&/\d/.test(De.label)?",":""]}),g.jsx("span",{className:"text-sm font-normal text-slate-500",children:De.dateRange})]}),g.jsx("p",{className:"font-bold text-indigo-600 text-xl",children:Ti(De.total)})]}),g.jsx("div",{className:"bg-white rounded-xl shadow-md mx-2 overflow-hidden",children:De.expenses.map((Oe,Qe)=>g.jsxs(me.Fragment,{children:[Qe>0&&g.jsx("hr",{className:"border-t border-slate-200 ml-16"}),g.jsx(uue,{expense:Oe,accounts:t,onEdit:r,onDelete:n,isOpen:ee===Oe.id,onOpen:Ze,isSelectionMode:ie,isSelected:Ie.has(Oe.id),onToggleSelection:Ee,onLongPress:mt})]},Oe.id))})]},De.label)):g.jsxs("div",{className:"text-center text-slate-500 pt-20 px-6",children:[g.jsx("p",{className:"text-lg font-semibold",children:"Nessuna spesa trovata"}),g.jsx("p",{className:"mt-2",children:"Prova a modificare i filtri o aggiungi una nuova spesa dalla schermata Home."})]})})}),g.jsx(jce,{isActive:h&&!de&&!d&&!ie,onSelectQuickFilter:De=>{_(De),w("quick")},currentQuickFilter:y,onCustomRangeChange:De=>{k(De),w("custom")},currentCustomRange:S,isCustomRangeActive:x==="custom",onDateModalStateChange:le,periodType:E,periodDate:N,onSelectPeriodType:De=>{T(De),C(()=>{const Oe=new Date;return Oe.setHours(0,0,0,0),Oe}),w("period")},onSetPeriodDate:C,isPeriodFilterActive:x==="period",onActivatePeriodFilter:()=>w("period"),onOpenStateChange:u,accounts:t,selectedAccountId:P,selectedCategoryFilters:R,onToggleCategoryFilter:rt,onClearCategoryFilters:xt,descriptionQuery:F,onDescriptionChange:L,amountRange:H,onAmountRangeChange:V,onSelectAccount:j}),g.jsx(uc,{isOpen:W,onClose:()=>z(!1),onConfirm:pe,title:"Elimina Selezionati",message:`Sei sicuro di voler eliminare ${Ie.size} elementi? L'azione  irreversibile.`,variant:"danger",confirmButtonText:"Elimina",cancelButtonText:"Annulla"})]})},pue=e=>g.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...e,children:g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6.75 3v2.25M17.25 3v2.25M3 18.75V7.5a2.25 2.25 0 0 1 2.25-2.25h13.5A2.25 2.25 0 0 1 21 7.5v11.25m-18 0A2.25 2.25 0 0 0 5.25 21h13.5A2.25 2.25 0 0 0 21 18.75m-18 0h18M7.5 12h.008v.008H7.5V12Zm3 0h.008v.008H10.5V12Zm3 0h.008v.008H13.5V12Z"})}),Bs=72,Yw=e=>{if(!e)return null;const t=e.split("-").map(Number);return new Date(t[0],t[1]-1,t[2])},ED=(e,t)=>{if(e.frequency!=="recurring"||!e.recurrence)return null;const r=e.recurrenceInterval||1,n=new Date(t);switch(e.recurrence){case"daily":n.setDate(n.getDate()+r);break;case"weekly":n.setDate(n.getDate()+7*r);break;case"monthly":n.setMonth(n.getMonth()+r);break;case"yearly":n.setFullYear(n.getFullYear()+r);break;default:return null}return n},mue={daily:"Ogni Giorno",weekly:"Ogni Settimana",monthly:"Ogni Mese",yearly:"Ogni Anno"},vue=e=>{if(e.frequency!=="recurring"||!e.recurrence)return"Non programmata";const{recurrence:t,recurrenceInterval:r=1}=e;return r>1?`Ogni ${r} ${t==="daily"?"giorni":t==="weekly"?"settimane":t==="monthly"?"mesi":"anni"}`:mue[t]||"Ricorrente"},gue=({expense:e,accounts:t,onEdit:r,onDeleteRequest:n,isOpen:a,onOpen:i,isSelectionMode:s,isSelected:o,onToggleSelection:c,onLongPress:u,isFinished:d})=>{var j;const h=Qr(e.category),p=((j=t.find(R=>R.id===e.accountId))==null?void 0:j.name)||"Sconosciuto",v=D.useRef(null),x=D.useMemo(()=>{if(d)return null;const R=Yw(e.lastGeneratedDate||e.date);return R?e.lastGeneratedDate?ED(e,R):R:null},[e,d]),w=D.useRef(null),y=R=>{s||(w.current=window.setTimeout(()=>{u(e.id),navigator.vibrate&&navigator.vibrate(50)},500))},_=()=>{w.current&&(clearTimeout(w.current),w.current=null)},S=D.useRef({isDragging:!1,isLocked:!1,startX:0,startY:0,startTime:0,initialTranslateX:0,pointerId:null,wasHorizontal:!1}),k=D.useCallback((R,I)=>{v.current&&(v.current.style.transition=I?"transform 0.2s cubic-bezier(0.22,0.61,0.36,1)":"none",v.current.style.transform=`translateX(${R}px)`)},[]);D.useEffect(()=>{S.current.isDragging||k(a&&!s?-Bs:0,!0)},[a,s,k]);const E=R=>{if(y(),R.target.closest("button")||!v.current||s)return;v.current.style.transition="none";const F=new DOMMatrixReadOnly(window.getComputedStyle(v.current).transform).m41;S.current={isDragging:!1,isLocked:!1,startX:R.clientX,startY:R.clientY,startTime:performance.now(),initialTranslateX:F,pointerId:R.pointerId,wasHorizontal:!1};try{v.current.setPointerCapture(R.pointerId)}catch(L){console.warn("Could not capture pointer: ",L)}},T=R=>{var H;const I=S.current;if(w.current&&Math.hypot(R.clientX-I.startX,R.clientY-I.startY)>10&&_(),I.pointerId!==R.pointerId||s)return;const F=R.clientX-I.startX,L=R.clientY-I.startY;if(!I.isDragging)if(Math.hypot(F,L)>8){if(I.isDragging=!0,I.isLocked=Math.abs(F)>Math.abs(L)*2,!I.isLocked){I.pointerId!==null&&((H=v.current)==null||H.releasePointerCapture(I.pointerId)),I.pointerId=null,I.isDragging=!1;return}}else return;if(I.isDragging&&I.isLocked){I.wasHorizontal=!0,R.cancelable&&R.preventDefault();let V=I.initialTranslateX+F;V>0&&(V=Math.tanh(V/50)*25),V<-Bs&&(V=-Bs-Math.tanh((Math.abs(V)-Bs)/50)*25),k(V,!1)}},N=R=>{var L;_();const I=S.current;if(I.pointerId!==R.pointerId)return;I.pointerId!==null&&((L=v.current)==null||L.releasePointerCapture(I.pointerId));const F=I.isDragging;if(I.isDragging=!1,I.pointerId=null,!!F)if(I.wasHorizontal){const H=performance.now()-I.startTime,V=R.clientX-I.startX,J=new DOMMatrixReadOnly(window.getComputedStyle(v.current).transform).m41,te=V/(H||1),q=J<-Bs/2||te<-.3&&V<-20;i(q?e.id:""),k(q?-Bs:0,!0)}else k(a?-Bs:0,!0)},C=R=>{var F;_();const I=S.current;I.pointerId===R.pointerId&&(I.pointerId!==null&&((F=v.current)==null||F.releasePointerCapture(I.pointerId)),I.isDragging=!1,I.isLocked=!1,I.pointerId=null,k(a?-Bs:0,!0))},P=R=>{R.stopPropagation(),!(S.current.isDragging||S.current.wasHorizontal)&&(s?c(e.id):a?i(""):r(e))};return g.jsxs("div",{className:`relative overflow-hidden transition-colors duration-200 select-none ${o?"bg-indigo-50 ring-1 ring-inset ring-indigo-200":d?"bg-slate-50 opacity-75":"bg-amber-50"}`,children:[g.jsx("div",{className:"absolute top-0 right-0 h-full flex items-center z-0",children:g.jsxs("button",{onClick:()=>n(e.id),className:"w-[72px] h-full flex flex-col items-center justify-center bg-red-500 text-white hover:bg-red-600 transition-colors focus:outline-none focus:visible:ring-2 focus-visible:ring-inset focus:visible:ring-white","aria-label":"Elimina spesa programmata",children:[g.jsx(o0,{className:"w-6 h-6"}),g.jsx("span",{className:"text-xs mt-1",children:"Elimina"})]})}),g.jsxs("div",{ref:v,onPointerDown:E,onPointerMove:T,onPointerUp:N,onPointerCancel:C,onClick:P,className:`relative flex items-center gap-4 py-3 px-4 ${o?"bg-indigo-50":d?"bg-slate-50":"bg-amber-50"} z-10 cursor-pointer transition-colors duration-200 select-none`,style:{touchAction:"pan-y"},children:[o?g.jsx("span",{className:"w-10 h-10 rounded-xl flex-shrink-0 flex items-center justify-center bg-indigo-600 text-white transition-transform duration-200 transform scale-100",children:g.jsx(Ni,{className:"w-6 h-6",strokeWidth:3})}):g.jsx("span",{className:`w-10 h-10 rounded-xl flex-shrink-0 flex items-center justify-center ${h.bgColor} transition-transform duration-200 ${d?"grayscale":""}`,children:g.jsx(h.Icon,{className:`w-6 h-6 ${h.color}`})}),g.jsxs("div",{className:"flex-grow min-w-0",children:[g.jsx("p",{className:`font-semibold truncate ${o?"text-indigo-900":d?"text-slate-500 line-through":"text-slate-800"}`,children:e.description||"Senza descrizione"}),g.jsxs("p",{className:`text-sm truncate ${o?"text-indigo-700":"text-slate-500"}`,children:[vue(e),"  ",p]})]}),g.jsxs("div",{className:"flex flex-col items-end shrink-0 min-w-[90px]",children:[g.jsx("p",{className:`font-bold text-lg text-right whitespace-nowrap ${o?"text-indigo-900":d?"text-slate-400":"text-slate-900"}`,children:Ti(Number(e.amount)||0)}),d?g.jsx("div",{className:"text-xs font-bold text-slate-400 mt-1 uppercase tracking-wider bg-slate-200 px-2 py-0.5 rounded-full",children:"Completata"}):x&&g.jsx("div",{className:`text-sm font-medium mt-1 whitespace-nowrap ${o?"text-indigo-600":"text-slate-500"}`,children:oD(x)})]})]})]})},xue=({recurringExpenses:e,expenses:t,accounts:r,onClose:n,onCloseStart:a,onEdit:i,onDelete:s,onDeleteRecurringExpenses:o})=>{const[c,u]=D.useState(!1),[d,h]=D.useState(null),[p,v]=D.useState(null),[x,w]=D.useState(!1),y=D.useRef(null),_=vs(),[S,k]=D.useState(new Set),[E,T]=D.useState(!1),N=S.size>0,C=D.useMemo(()=>{const q=t||[];return e.map(oe=>{if(oe.frequency!=="recurring")return null;let Q=!1;if(oe.recurrenceEndType==="count")oe.recurrenceCount&&oe.recurrenceCount>0&&q.filter(ee=>ee.recurringExpenseId===oe.id).length>=oe.recurrenceCount&&(Q=!0);else if(oe.recurrenceEndType==="date"){const Z=Yw(oe.recurrenceEndDate);if(Z){const ee=Yw(oe.lastGeneratedDate||oe.date);if(ee)if(ee.getTime()>Z.getTime())Q=!0;else{const ce=ED(oe,ee);(!ce||ce.getTime()>Z.getTime())&&(Q=!0)}}}return{...oe,isFinished:Q}}).filter(oe=>oe!==null&&!oe.isFinished)},[e,t]);D.useEffect(()=>{const q=setTimeout(()=>u(!0),10);return()=>clearTimeout(q)},[]),D.useEffect(()=>{!c&&d&&h(null)},[c,d]),D.useEffect(()=>(y.current&&clearTimeout(y.current),d&&!x&&(y.current=window.setTimeout(()=>h(null),5e3)),()=>{y.current&&clearTimeout(y.current)}),[d,x]);const P=()=>{h(null),a&&a(),u(!1),setTimeout(n,300)},j=q=>{v(q),w(!0)},R=()=>{p&&(s(p),v(null),w(!1),h(null))},I=()=>{w(!1),v(null)},F=q=>{k(new Set([q])),navigator.vibrate&&navigator.vibrate(50)},L=q=>{k(oe=>{const Q=new Set(oe);return Q.has(q)?Q.delete(q):Q.add(q),Q})},H=()=>{k(new Set)},V=()=>{S.size>0&&T(!0)},J=()=>{o(Array.from(S)),T(!1),k(new Set)},te=[...C].sort((q,oe)=>new Date(oe.date).getTime()-new Date(q.date).getTime());return g.jsxs("div",{className:`fixed inset-0 z-50 bg-slate-100 transform transition-transform duration-300 ease-in-out ${c?"translate-y-0":"translate-y-full"}`,style:{touchAction:"pan-y"},onClick:()=>{d&&h(null)},..._,children:[g.jsx("header",{className:"sticky top-0 z-20 flex items-center gap-4 p-4 bg-white/80 backdrop-blur-sm shadow-sm h-[60px]",children:N?g.jsxs(g.Fragment,{children:[g.jsx("button",{onClick:H,className:"p-2 -ml-2 rounded-full hover:bg-slate-200 transition-colors text-slate-600","aria-label":"Annulla selezione",children:g.jsx(us,{className:"w-6 h-6"})}),g.jsxs("h1",{className:"text-xl font-bold text-indigo-800 flex-1",children:[S.size," Selezionati"]}),g.jsx("button",{onClick:V,className:"p-2 rounded-full hover:bg-red-100 text-red-600 transition-colors","aria-label":"Elimina selezionati",children:g.jsx(o0,{className:"w-6 h-6"})})]}):g.jsxs(g.Fragment,{children:[g.jsx("button",{onClick:P,className:"p-2 rounded-full hover:bg-slate-200 transition-colors","aria-label":"Indietro",children:g.jsx(us,{className:"w-6 h-6 text-slate-700"})}),g.jsx("h1",{className:"text-xl font-bold text-slate-800 flex-1",children:"Spese Programmate"})]})}),g.jsx("main",{className:"overflow-y-auto h-[calc(100%-60px)] p-2",style:{touchAction:"pan-y"},children:te.length>0?g.jsx("div",{className:"bg-white rounded-xl shadow-md overflow-hidden my-4",children:te.map((q,oe)=>g.jsxs(me.Fragment,{children:[oe>0&&g.jsx("hr",{className:"border-t border-slate-200 ml-16"}),g.jsx(gue,{expense:q,accounts:r,onEdit:i,onDeleteRequest:j,isOpen:d===q.id,onOpen:h,isSelectionMode:N,isSelected:S.has(q.id),onToggleSelection:L,onLongPress:F,isFinished:q.isFinished})]},q.id))}):g.jsxs("div",{className:"text-center text-slate-500 pt-20 px-6",children:[g.jsx(pue,{className:"w-16 h-16 mx-auto text-slate-400"}),g.jsx("p",{className:"text-lg font-semibold mt-4",children:"Nessuna spesa programmata attiva"}),g.jsx("p",{className:"mt-2",children:"Puoi creare una spesa ricorrente quando aggiungi una nuova spesa."})]})}),g.jsx(uc,{isOpen:x,onClose:I,onConfirm:R,title:"Conferma Eliminazione",message:g.jsxs(g.Fragment,{children:["Sei sicuro di voler eliminare questa spesa programmata? ",g.jsx("br",{}),"Le spese gi generate non verranno cancellate."]}),variant:"danger"}),g.jsx(uc,{isOpen:E,onClose:()=>T(!1),onConfirm:J,title:"Elimina Selezionati",message:`Sei sicuro di voler eliminare ${S.size} elementi?`,variant:"danger",confirmButtonText:"Elimina",cancelButtonText:"Annulla"})]})},zN=({icon:e,title:t,description:r,onClick:n})=>g.jsxs("button",{onClick:n,className:"bg-white p-6 rounded-lg shadow-md hover:shadow-lg hover:ring-2 hover:ring-indigo-500 transition-all duration-200 text-left w-full flex flex-col items-center text-center",children:[g.jsx("div",{className:"text-indigo-600 bg-indigo-100 p-4 rounded-full mb-4",children:e}),g.jsx("h3",{className:"text-lg font-bold text-slate-800",children:t}),g.jsx("p",{className:"text-sm text-slate-500 mt-1",children:r})]});var Tl={},i2,WN;function TD(){return WN||(WN=1,i2={L:1,M:0,Q:3,H:2}),i2}var s2,HN;function AD(){return HN||(HN=1,s2={MODE_NUMBER:1,MODE_ALPHA_NUM:2,MODE_8BIT_BYTE:4,MODE_KANJI:8}),s2}var o2,qN;function yue(){if(qN)return o2;qN=1;var e=AD();function t(r){this.mode=e.MODE_8BIT_BYTE,this.data=r}return t.prototype={getLength:function(r){return this.data.length},write:function(r){for(var n=0;n<this.data.length;n++)r.put(this.data.charCodeAt(n),8)}},o2=t,o2}var l2,VN;function wue(){if(VN)return l2;VN=1;var e=TD();function t(r,n){this.totalCount=r,this.dataCount=n}return t.RS_BLOCK_TABLE=[[1,26,19],[1,26,16],[1,26,13],[1,26,9],[1,44,34],[1,44,28],[1,44,22],[1,44,16],[1,70,55],[1,70,44],[2,35,17],[2,35,13],[1,100,80],[2,50,32],[2,50,24],[4,25,9],[1,134,108],[2,67,43],[2,33,15,2,34,16],[2,33,11,2,34,12],[2,86,68],[4,43,27],[4,43,19],[4,43,15],[2,98,78],[4,49,31],[2,32,14,4,33,15],[4,39,13,1,40,14],[2,121,97],[2,60,38,2,61,39],[4,40,18,2,41,19],[4,40,14,2,41,15],[2,146,116],[3,58,36,2,59,37],[4,36,16,4,37,17],[4,36,12,4,37,13],[2,86,68,2,87,69],[4,69,43,1,70,44],[6,43,19,2,44,20],[6,43,15,2,44,16],[4,101,81],[1,80,50,4,81,51],[4,50,22,4,51,23],[3,36,12,8,37,13],[2,116,92,2,117,93],[6,58,36,2,59,37],[4,46,20,6,47,21],[7,42,14,4,43,15],[4,133,107],[8,59,37,1,60,38],[8,44,20,4,45,21],[12,33,11,4,34,12],[3,145,115,1,146,116],[4,64,40,5,65,41],[11,36,16,5,37,17],[11,36,12,5,37,13],[5,109,87,1,110,88],[5,65,41,5,66,42],[5,54,24,7,55,25],[11,36,12],[5,122,98,1,123,99],[7,73,45,3,74,46],[15,43,19,2,44,20],[3,45,15,13,46,16],[1,135,107,5,136,108],[10,74,46,1,75,47],[1,50,22,15,51,23],[2,42,14,17,43,15],[5,150,120,1,151,121],[9,69,43,4,70,44],[17,50,22,1,51,23],[2,42,14,19,43,15],[3,141,113,4,142,114],[3,70,44,11,71,45],[17,47,21,4,48,22],[9,39,13,16,40,14],[3,135,107,5,136,108],[3,67,41,13,68,42],[15,54,24,5,55,25],[15,43,15,10,44,16],[4,144,116,4,145,117],[17,68,42],[17,50,22,6,51,23],[19,46,16,6,47,17],[2,139,111,7,140,112],[17,74,46],[7,54,24,16,55,25],[34,37,13],[4,151,121,5,152,122],[4,75,47,14,76,48],[11,54,24,14,55,25],[16,45,15,14,46,16],[6,147,117,4,148,118],[6,73,45,14,74,46],[11,54,24,16,55,25],[30,46,16,2,47,17],[8,132,106,4,133,107],[8,75,47,13,76,48],[7,54,24,22,55,25],[22,45,15,13,46,16],[10,142,114,2,143,115],[19,74,46,4,75,47],[28,50,22,6,51,23],[33,46,16,4,47,17],[8,152,122,4,153,123],[22,73,45,3,74,46],[8,53,23,26,54,24],[12,45,15,28,46,16],[3,147,117,10,148,118],[3,73,45,23,74,46],[4,54,24,31,55,25],[11,45,15,31,46,16],[7,146,116,7,147,117],[21,73,45,7,74,46],[1,53,23,37,54,24],[19,45,15,26,46,16],[5,145,115,10,146,116],[19,75,47,10,76,48],[15,54,24,25,55,25],[23,45,15,25,46,16],[13,145,115,3,146,116],[2,74,46,29,75,47],[42,54,24,1,55,25],[23,45,15,28,46,16],[17,145,115],[10,74,46,23,75,47],[10,54,24,35,55,25],[19,45,15,35,46,16],[17,145,115,1,146,116],[14,74,46,21,75,47],[29,54,24,19,55,25],[11,45,15,46,46,16],[13,145,115,6,146,116],[14,74,46,23,75,47],[44,54,24,7,55,25],[59,46,16,1,47,17],[12,151,121,7,152,122],[12,75,47,26,76,48],[39,54,24,14,55,25],[22,45,15,41,46,16],[6,151,121,14,152,122],[6,75,47,34,76,48],[46,54,24,10,55,25],[2,45,15,64,46,16],[17,152,122,4,153,123],[29,74,46,14,75,47],[49,54,24,10,55,25],[24,45,15,46,46,16],[4,152,122,18,153,123],[13,74,46,32,75,47],[48,54,24,14,55,25],[42,45,15,32,46,16],[20,147,117,4,148,118],[40,75,47,7,76,48],[43,54,24,22,55,25],[10,45,15,67,46,16],[19,148,118,6,149,119],[18,75,47,31,76,48],[34,54,24,34,55,25],[20,45,15,61,46,16]],t.getRSBlocks=function(r,n){var a=t.getRsBlockTable(r,n);if(a==null)throw new Error("bad rs block @ typeNumber:"+r+"/errorCorrectLevel:"+n);for(var i=a.length/3,s=new Array,o=0;o<i;o++)for(var c=a[o*3+0],u=a[o*3+1],d=a[o*3+2],h=0;h<c;h++)s.push(new t(u,d));return s},t.getRsBlockTable=function(r,n){switch(n){case e.L:return t.RS_BLOCK_TABLE[(r-1)*4+0];case e.M:return t.RS_BLOCK_TABLE[(r-1)*4+1];case e.Q:return t.RS_BLOCK_TABLE[(r-1)*4+2];case e.H:return t.RS_BLOCK_TABLE[(r-1)*4+3];default:return}},l2=t,l2}var c2,XN;function bue(){if(XN)return c2;XN=1;function e(){this.buffer=new Array,this.length=0}return e.prototype={get:function(t){var r=Math.floor(t/8);return(this.buffer[r]>>>7-t%8&1)==1},put:function(t,r){for(var n=0;n<r;n++)this.putBit((t>>>r-n-1&1)==1)},getLengthInBits:function(){return this.length},putBit:function(t){var r=Math.floor(this.length/8);this.buffer.length<=r&&this.buffer.push(0),t&&(this.buffer[r]|=128>>>this.length%8),this.length++}},c2=e,c2}var u2,GN;function CD(){if(GN)return u2;GN=1;for(var e={glog:function(r){if(r<1)throw new Error("glog("+r+")");return e.LOG_TABLE[r]},gexp:function(r){for(;r<0;)r+=255;for(;r>=256;)r-=255;return e.EXP_TABLE[r]},EXP_TABLE:new Array(256),LOG_TABLE:new Array(256)},t=0;t<8;t++)e.EXP_TABLE[t]=1<<t;for(var t=8;t<256;t++)e.EXP_TABLE[t]=e.EXP_TABLE[t-4]^e.EXP_TABLE[t-5]^e.EXP_TABLE[t-6]^e.EXP_TABLE[t-8];for(var t=0;t<255;t++)e.LOG_TABLE[e.EXP_TABLE[t]]=t;return u2=e,u2}var f2,KN;function OD(){if(KN)return f2;KN=1;var e=CD();function t(r,n){if(r.length==null)throw new Error(r.length+"/"+n);for(var a=0;a<r.length&&r[a]==0;)a++;this.num=new Array(r.length-a+n);for(var i=0;i<r.length-a;i++)this.num[i]=r[i+a]}return t.prototype={get:function(r){return this.num[r]},getLength:function(){return this.num.length},multiply:function(r){for(var n=new Array(this.getLength()+r.getLength()-1),a=0;a<this.getLength();a++)for(var i=0;i<r.getLength();i++)n[a+i]^=e.gexp(e.glog(this.get(a))+e.glog(r.get(i)));return new t(n,0)},mod:function(r){if(this.getLength()-r.getLength()<0)return this;for(var n=e.glog(this.get(0))-e.glog(r.get(0)),a=new Array(this.getLength()),i=0;i<this.getLength();i++)a[i]=this.get(i);for(var i=0;i<r.getLength();i++)a[i]^=e.gexp(e.glog(r.get(i))+n);return new t(a,0).mod(r)}},f2=t,f2}var d2,YN;function _ue(){if(YN)return d2;YN=1;var e=AD(),t=OD(),r=CD(),n={PATTERN000:0,PATTERN001:1,PATTERN010:2,PATTERN011:3,PATTERN100:4,PATTERN101:5,PATTERN110:6,PATTERN111:7},a={PATTERN_POSITION_TABLE:[[],[6,18],[6,22],[6,26],[6,30],[6,34],[6,22,38],[6,24,42],[6,26,46],[6,28,50],[6,30,54],[6,32,58],[6,34,62],[6,26,46,66],[6,26,48,70],[6,26,50,74],[6,30,54,78],[6,30,56,82],[6,30,58,86],[6,34,62,90],[6,28,50,72,94],[6,26,50,74,98],[6,30,54,78,102],[6,28,54,80,106],[6,32,58,84,110],[6,30,58,86,114],[6,34,62,90,118],[6,26,50,74,98,122],[6,30,54,78,102,126],[6,26,52,78,104,130],[6,30,56,82,108,134],[6,34,60,86,112,138],[6,30,58,86,114,142],[6,34,62,90,118,146],[6,30,54,78,102,126,150],[6,24,50,76,102,128,154],[6,28,54,80,106,132,158],[6,32,58,84,110,136,162],[6,26,54,82,110,138,166],[6,30,58,86,114,142,170]],G15:1335,G18:7973,G15_MASK:21522,getBCHTypeInfo:function(i){for(var s=i<<10;a.getBCHDigit(s)-a.getBCHDigit(a.G15)>=0;)s^=a.G15<<a.getBCHDigit(s)-a.getBCHDigit(a.G15);return(i<<10|s)^a.G15_MASK},getBCHTypeNumber:function(i){for(var s=i<<12;a.getBCHDigit(s)-a.getBCHDigit(a.G18)>=0;)s^=a.G18<<a.getBCHDigit(s)-a.getBCHDigit(a.G18);return i<<12|s},getBCHDigit:function(i){for(var s=0;i!=0;)s++,i>>>=1;return s},getPatternPosition:function(i){return a.PATTERN_POSITION_TABLE[i-1]},getMask:function(i,s,o){switch(i){case n.PATTERN000:return(s+o)%2==0;case n.PATTERN001:return s%2==0;case n.PATTERN010:return o%3==0;case n.PATTERN011:return(s+o)%3==0;case n.PATTERN100:return(Math.floor(s/2)+Math.floor(o/3))%2==0;case n.PATTERN101:return s*o%2+s*o%3==0;case n.PATTERN110:return(s*o%2+s*o%3)%2==0;case n.PATTERN111:return(s*o%3+(s+o)%2)%2==0;default:throw new Error("bad maskPattern:"+i)}},getErrorCorrectPolynomial:function(i){for(var s=new t([1],0),o=0;o<i;o++)s=s.multiply(new t([1,r.gexp(o)],0));return s},getLengthInBits:function(i,s){if(1<=s&&s<10)switch(i){case e.MODE_NUMBER:return 10;case e.MODE_ALPHA_NUM:return 9;case e.MODE_8BIT_BYTE:return 8;case e.MODE_KANJI:return 8;default:throw new Error("mode:"+i)}else if(s<27)switch(i){case e.MODE_NUMBER:return 12;case e.MODE_ALPHA_NUM:return 11;case e.MODE_8BIT_BYTE:return 16;case e.MODE_KANJI:return 10;default:throw new Error("mode:"+i)}else if(s<41)switch(i){case e.MODE_NUMBER:return 14;case e.MODE_ALPHA_NUM:return 13;case e.MODE_8BIT_BYTE:return 16;case e.MODE_KANJI:return 12;default:throw new Error("mode:"+i)}else throw new Error("type:"+s)},getLostPoint:function(i){for(var s=i.getModuleCount(),o=0,c=0;c<s;c++)for(var u=0;u<s;u++){for(var d=0,h=i.isDark(c,u),p=-1;p<=1;p++)if(!(c+p<0||s<=c+p))for(var v=-1;v<=1;v++)u+v<0||s<=u+v||p==0&&v==0||h==i.isDark(c+p,u+v)&&d++;d>5&&(o+=3+d-5)}for(var c=0;c<s-1;c++)for(var u=0;u<s-1;u++){var x=0;i.isDark(c,u)&&x++,i.isDark(c+1,u)&&x++,i.isDark(c,u+1)&&x++,i.isDark(c+1,u+1)&&x++,(x==0||x==4)&&(o+=3)}for(var c=0;c<s;c++)for(var u=0;u<s-6;u++)i.isDark(c,u)&&!i.isDark(c,u+1)&&i.isDark(c,u+2)&&i.isDark(c,u+3)&&i.isDark(c,u+4)&&!i.isDark(c,u+5)&&i.isDark(c,u+6)&&(o+=40);for(var u=0;u<s;u++)for(var c=0;c<s-6;c++)i.isDark(c,u)&&!i.isDark(c+1,u)&&i.isDark(c+2,u)&&i.isDark(c+3,u)&&i.isDark(c+4,u)&&!i.isDark(c+5,u)&&i.isDark(c+6,u)&&(o+=40);for(var w=0,u=0;u<s;u++)for(var c=0;c<s;c++)i.isDark(c,u)&&w++;var y=Math.abs(100*w/s/s-50)/5;return o+=y*10,o}};return d2=a,d2}var h2,ZN;function Sue(){if(ZN)return h2;ZN=1;var e=yue(),t=wue(),r=bue(),n=_ue(),a=OD();function i(o,c){this.typeNumber=o,this.errorCorrectLevel=c,this.modules=null,this.moduleCount=0,this.dataCache=null,this.dataList=[]}var s=i.prototype;return s.addData=function(o){var c=new e(o);this.dataList.push(c),this.dataCache=null},s.isDark=function(o,c){if(o<0||this.moduleCount<=o||c<0||this.moduleCount<=c)throw new Error(o+","+c);return this.modules[o][c]},s.getModuleCount=function(){return this.moduleCount},s.make=function(){if(this.typeNumber<1){var o=1;for(o=1;o<40;o++){for(var c=t.getRSBlocks(o,this.errorCorrectLevel),u=new r,d=0,h=0;h<c.length;h++)d+=c[h].dataCount;for(var h=0;h<this.dataList.length;h++){var p=this.dataList[h];u.put(p.mode,4),u.put(p.getLength(),n.getLengthInBits(p.mode,o)),p.write(u)}if(u.getLengthInBits()<=d*8)break}this.typeNumber=o}this.makeImpl(!1,this.getBestMaskPattern())},s.makeImpl=function(o,c){this.moduleCount=this.typeNumber*4+17,this.modules=new Array(this.moduleCount);for(var u=0;u<this.moduleCount;u++){this.modules[u]=new Array(this.moduleCount);for(var d=0;d<this.moduleCount;d++)this.modules[u][d]=null}this.setupPositionProbePattern(0,0),this.setupPositionProbePattern(this.moduleCount-7,0),this.setupPositionProbePattern(0,this.moduleCount-7),this.setupPositionAdjustPattern(),this.setupTimingPattern(),this.setupTypeInfo(o,c),this.typeNumber>=7&&this.setupTypeNumber(o),this.dataCache==null&&(this.dataCache=i.createData(this.typeNumber,this.errorCorrectLevel,this.dataList)),this.mapData(this.dataCache,c)},s.setupPositionProbePattern=function(o,c){for(var u=-1;u<=7;u++)if(!(o+u<=-1||this.moduleCount<=o+u))for(var d=-1;d<=7;d++)c+d<=-1||this.moduleCount<=c+d||(0<=u&&u<=6&&(d==0||d==6)||0<=d&&d<=6&&(u==0||u==6)||2<=u&&u<=4&&2<=d&&d<=4?this.modules[o+u][c+d]=!0:this.modules[o+u][c+d]=!1)},s.getBestMaskPattern=function(){for(var o=0,c=0,u=0;u<8;u++){this.makeImpl(!0,u);var d=n.getLostPoint(this);(u==0||o>d)&&(o=d,c=u)}return c},s.createMovieClip=function(o,c,u){var d=o.createEmptyMovieClip(c,u),h=1;this.make();for(var p=0;p<this.modules.length;p++)for(var v=p*h,x=0;x<this.modules[p].length;x++){var w=x*h,y=this.modules[p][x];y&&(d.beginFill(0,100),d.moveTo(w,v),d.lineTo(w+h,v),d.lineTo(w+h,v+h),d.lineTo(w,v+h),d.endFill())}return d},s.setupTimingPattern=function(){for(var o=8;o<this.moduleCount-8;o++)this.modules[o][6]==null&&(this.modules[o][6]=o%2==0);for(var c=8;c<this.moduleCount-8;c++)this.modules[6][c]==null&&(this.modules[6][c]=c%2==0)},s.setupPositionAdjustPattern=function(){for(var o=n.getPatternPosition(this.typeNumber),c=0;c<o.length;c++)for(var u=0;u<o.length;u++){var d=o[c],h=o[u];if(this.modules[d][h]==null)for(var p=-2;p<=2;p++)for(var v=-2;v<=2;v++)p==-2||p==2||v==-2||v==2||p==0&&v==0?this.modules[d+p][h+v]=!0:this.modules[d+p][h+v]=!1}},s.setupTypeNumber=function(o){for(var c=n.getBCHTypeNumber(this.typeNumber),u=0;u<18;u++){var d=!o&&(c>>u&1)==1;this.modules[Math.floor(u/3)][u%3+this.moduleCount-8-3]=d}for(var u=0;u<18;u++){var d=!o&&(c>>u&1)==1;this.modules[u%3+this.moduleCount-8-3][Math.floor(u/3)]=d}},s.setupTypeInfo=function(o,c){for(var u=this.errorCorrectLevel<<3|c,d=n.getBCHTypeInfo(u),h=0;h<15;h++){var p=!o&&(d>>h&1)==1;h<6?this.modules[h][8]=p:h<8?this.modules[h+1][8]=p:this.modules[this.moduleCount-15+h][8]=p}for(var h=0;h<15;h++){var p=!o&&(d>>h&1)==1;h<8?this.modules[8][this.moduleCount-h-1]=p:h<9?this.modules[8][15-h-1+1]=p:this.modules[8][15-h-1]=p}this.modules[this.moduleCount-8][8]=!o},s.mapData=function(o,c){for(var u=-1,d=this.moduleCount-1,h=7,p=0,v=this.moduleCount-1;v>0;v-=2)for(v==6&&v--;;){for(var x=0;x<2;x++)if(this.modules[d][v-x]==null){var w=!1;p<o.length&&(w=(o[p]>>>h&1)==1);var y=n.getMask(c,d,v-x);y&&(w=!w),this.modules[d][v-x]=w,h--,h==-1&&(p++,h=7)}if(d+=u,d<0||this.moduleCount<=d){d-=u,u=-u;break}}},i.PAD0=236,i.PAD1=17,i.createData=function(o,c,u){for(var d=t.getRSBlocks(o,c),h=new r,p=0;p<u.length;p++){var v=u[p];h.put(v.mode,4),h.put(v.getLength(),n.getLengthInBits(v.mode,o)),v.write(h)}for(var x=0,p=0;p<d.length;p++)x+=d[p].dataCount;if(h.getLengthInBits()>x*8)throw new Error("code length overflow. ("+h.getLengthInBits()+">"+x*8+")");for(h.getLengthInBits()+4<=x*8&&h.put(0,4);h.getLengthInBits()%8!=0;)h.putBit(!1);for(;!(h.getLengthInBits()>=x*8||(h.put(i.PAD0,8),h.getLengthInBits()>=x*8));)h.put(i.PAD1,8);return i.createBytes(h,d)},i.createBytes=function(o,c){for(var u=0,d=0,h=0,p=new Array(c.length),v=new Array(c.length),x=0;x<c.length;x++){var w=c[x].dataCount,y=c[x].totalCount-w;d=Math.max(d,w),h=Math.max(h,y),p[x]=new Array(w);for(var _=0;_<p[x].length;_++)p[x][_]=255&o.buffer[_+u];u+=w;var S=n.getErrorCorrectPolynomial(y),k=new a(p[x],S.getLength()-1),E=k.mod(S);v[x]=new Array(S.getLength()-1);for(var _=0;_<v[x].length;_++){var T=_+E.getLength()-v[x].length;v[x][_]=T>=0?E.get(T):0}}for(var N=0,_=0;_<c.length;_++)N+=c[_].totalCount;for(var C=new Array(N),P=0,_=0;_<d;_++)for(var x=0;x<c.length;x++)_<p[x].length&&(C[P++]=p[x][_]);for(var _=0;_<h;_++)for(var x=0;x<c.length;x++)_<v[x].length&&(C[P++]=v[x][_]);return C},h2=i,h2}var Hd={},QN;function kue(){if(QN)return Hd;QN=1,Object.defineProperty(Hd,"__esModule",{value:!0});var e=Object.assign||function(u){for(var d=1;d<arguments.length;d++){var h=arguments[d];for(var p in h)Object.prototype.hasOwnProperty.call(h,p)&&(u[p]=h[p])}return u},t=R_(),r=i(t),n=$f(),a=i(n);function i(u){return u&&u.__esModule?u:{default:u}}function s(u,d){var h={};for(var p in u)d.indexOf(p)>=0||Object.prototype.hasOwnProperty.call(u,p)&&(h[p]=u[p]);return h}var o={bgColor:r.default.oneOfType([r.default.object,r.default.string]).isRequired,bgD:r.default.string.isRequired,fgColor:r.default.oneOfType([r.default.object,r.default.string]).isRequired,fgD:r.default.string.isRequired,size:r.default.number.isRequired,title:r.default.string,viewBoxSize:r.default.number.isRequired,xmlns:r.default.string},c=(0,n.forwardRef)(function(u,d){var h=u.bgColor,p=u.bgD,v=u.fgD,x=u.fgColor,w=u.size,y=u.title,_=u.viewBoxSize,S=u.xmlns,k=S===void 0?"http://www.w3.org/2000/svg":S,E=s(u,["bgColor","bgD","fgD","fgColor","size","title","viewBoxSize","xmlns"]);return a.default.createElement("svg",e({},E,{height:w,ref:d,viewBox:"0 0 "+_+" "+_,width:w,xmlns:k}),y?a.default.createElement("title",null,y):null,a.default.createElement("path",{d:p,fill:h}),a.default.createElement("path",{d:v,fill:x}))});return c.displayName="QRCodeSvg",c.propTypes=o,Hd.default=c,Hd}var JN;function Eue(){if(JN)return Tl;JN=1,Object.defineProperty(Tl,"__esModule",{value:!0}),Tl.QRCode=void 0;var e=Object.assign||function(w){for(var y=1;y<arguments.length;y++){var _=arguments[y];for(var S in _)Object.prototype.hasOwnProperty.call(_,S)&&(w[S]=_[S])}return w},t=R_(),r=h(t),n=TD(),a=h(n),i=Sue(),s=h(i),o=$f(),c=h(o),u=kue(),d=h(u);function h(w){return w&&w.__esModule?w:{default:w}}function p(w,y){var _={};for(var S in w)y.indexOf(S)>=0||Object.prototype.hasOwnProperty.call(w,S)&&(_[S]=w[S]);return _}var v={bgColor:r.default.oneOfType([r.default.object,r.default.string]),fgColor:r.default.oneOfType([r.default.object,r.default.string]),level:r.default.string,size:r.default.number,value:r.default.string.isRequired},x=(0,o.forwardRef)(function(w,y){var _=w.bgColor,S=_===void 0?"#FFFFFF":_,k=w.fgColor,E=k===void 0?"#000000":k,T=w.level,N=T===void 0?"L":T,C=w.size,P=C===void 0?256:C,j=w.value,R=p(w,["bgColor","fgColor","level","size","value"]),I=new s.default(-1,a.default[N]);I.addData(j),I.make();var F=I.modules;return c.default.createElement(d.default,e({},R,{bgColor:S,bgD:F.map(function(L,H){return L.map(function(V,J){return V?"":"M "+J+" "+H+" l 1 0 0 1 -1 0 Z"}).join(" ")}).join(" "),fgColor:E,fgD:F.map(function(L,H){return L.map(function(V,J){return V?"M "+J+" "+H+" l 1 0 0 1 -1 0 Z":""}).join(" ")}).join(" "),ref:y,size:P,viewBoxSize:F.length}))});return Tl.QRCode=x,x.displayName="QRCode",x.propTypes=v,Tl.default=x,Tl}var Tue=Eue();const Aue=rr(Tue),Cue=({isOpen:e,onClose:t})=>{const[r,n]=D.useState(!1),a=typeof window<"u"?window.location.href:"";return D.useEffect(()=>{if(e){const i=setTimeout(()=>n(!0),10);return()=>clearTimeout(i)}else n(!1)},[e]),e?g.jsx("div",{className:`fixed inset-0 z-[6000] flex justify-center items-center p-4 transition-opacity duration-300 ease-in-out ${r?"opacity-100":"opacity-0"} bg-slate-900/60 backdrop-blur-sm`,onClick:t,"aria-modal":"true",role:"dialog",children:g.jsxs("div",{className:`bg-white rounded-lg shadow-xl w-full max-w-sm transform transition-all duration-300 ease-in-out ${r?"scale-100 opacity-100":"scale-95 opacity-0"}`,onClick:i=>i.stopPropagation(),children:[g.jsxs("div",{className:"flex justify-between items-center p-6 border-b border-slate-200",children:[g.jsx("h2",{className:"text-xl font-bold text-slate-800",children:"Condividi App"}),g.jsx("button",{onClick:t,className:"text-slate-400 hover:text-slate-700 p-1 rounded-full hover:bg-slate-200",children:g.jsx(fn,{className:"w-6 h-6"})})]}),g.jsxs("div",{className:"p-8 flex flex-col items-center justify-center space-y-6",children:[g.jsx("div",{className:"p-4 bg-white border-2 border-slate-100 rounded-xl shadow-sm",children:g.jsx(Aue,{value:a,size:200,style:{height:"auto",maxWidth:"100%",width:"100%"},viewBox:"0 0 256 256"})}),g.jsx("p",{className:"text-center text-slate-600 text-sm",children:"Scansiona questo codice per aprire e installare l'app su un altro dispositivo."})]})]})}):null},Oue=e=>g.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...e,children:g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15.666 3.888A2.25 2.25 0 0 0 13.5 2.25h-3c-1.03 0-1.9.693-2.166 1.638m7.332 0c.055.194.084.4.084.612v0a2.25 2.25 0 0 1-2.25 2.25h-1.5a2.25 2.25 0 0 1-2.25-2.25v0c0-.212.03-.418.084-.612m7.332 0c.646.049 1.288.11 1.927.184 1.1.128 1.907 1.077 1.907 2.185V19.5a2.25 2.25 0 0 1-2.25 2.25H6.75A2.25 2.25 0 0 1 4.5 19.5V6.257c0-1.108.806-2.057 1.907-2.185a48.208 48.208 0 0 1 1.927-.184"})}),Nue=e=>g.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...e,children:g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M10.125 2.25h-4.5c-.621 0-1.125.504-1.125 1.125v17.25c0 .621.504 1.125 1.125 1.125h12.75c.621 0 1.125-.504 1.125-1.125v-9M10.125 2.25h.375a9 9 0 0 1 9 9v.375M10.125 2.25A3.375 3.375 0 0 1 13.5 5.625v1.5c0 .621.504 1.125 1.125 1.125h1.5a3.375 3.375 0 0 1 3.375 3.375M9 15l2.25 2.25L15 12"})}),Pue=({isOpen:e,onClose:t})=>{const[r,n]=D.useState(!1),[a,i]=D.useState(!1);D.useEffect(()=>{if(e){i(!1);const d=setTimeout(()=>n(!0),10);return()=>clearTimeout(d)}else n(!1)},[e]);const s=()=>{navigator.clipboard.writeText(window.location.href).then(()=>{i(!0),setTimeout(()=>i(!1),2e3)})};if(!e)return null;const o=/iPad|iPhone|iPod/.test(navigator.userAgent)&&!window.MSStream,c=/Android/.test(navigator.userAgent),u=()=>o?g.jsxs(g.Fragment,{children:["Tocca l'icona ",g.jsx("strong",{children:"Condividi"})," ",g.jsx("img",{src:"https://img.icons8.com/ios-glyphs/30/000000/share--v1.png",alt:"Share Icon",className:"inline w-5 h-5 mx-1 align-text-bottom"})," e poi seleziona ",g.jsx("strong",{children:'"Aggiungi alla schermata Home"'}),"."]}):c?g.jsxs(g.Fragment,{children:["Tocca i tre puntini ",g.jsx("strong",{className:"text-xl align-middle mx-1",children:""})," nel menu del browser e seleziona ",g.jsx("strong",{children:'"Installa app"'})," o ",g.jsx("strong",{children:'"Aggiungi a schermata Home"'}),"."]}):"Usa il menu del tuo browser per aggiungere questo sito alla tua schermata principale o per installare l'app.";return g.jsx("div",{className:`fixed inset-0 z-50 flex justify-center items-center p-4 transition-opacity duration-300 ease-in-out ${r?"opacity-100":"opacity-0"} bg-slate-900/60 backdrop-blur-sm`,onClick:t,"aria-modal":"true",role:"dialog",children:g.jsxs("div",{className:`bg-white rounded-lg shadow-xl w-full max-w-lg transform transition-all duration-300 ease-in-out ${r?"scale-100 opacity-100":"scale-95 opacity-0"}`,onClick:d=>d.stopPropagation(),children:[g.jsxs("div",{className:"flex justify-between items-center p-6 border-b border-slate-200",children:[g.jsx("h2",{className:"text-xl font-bold text-slate-800",children:"Installa l'App"}),g.jsx("button",{onClick:t,className:"text-slate-400 hover:text-slate-700 p-1 rounded-full hover:bg-slate-200",children:g.jsx(fn,{className:"w-6 h-6"})})]}),g.jsxs("div",{className:"p-6 space-y-4",children:[g.jsxs("div",{className:"text-sm text-slate-600 bg-slate-100 p-3 rounded-md flex items-start gap-2",children:[g.jsx(H_,{className:"w-5 h-5 text-slate-500 flex-shrink-0 mt-0.5"}),g.jsx("span",{children:"L'ambiente di anteprima pu limitare l'installazione diretta. Per un'esperienza ottimale, apri l'app nel tuo browser principale seguendo questi passaggi."})]}),g.jsxs("div",{className:"bg-white p-4 rounded-lg border border-slate-200",children:[g.jsx("p",{className:"font-bold text-slate-800 mb-2",children:"1. Copia l'URL dell'App"}),g.jsxs("div",{className:"flex gap-2",children:[g.jsx("input",{type:"text",value:window.location.href,readOnly:!0,className:"flex-grow bg-slate-100 text-slate-700 rounded-md border border-slate-300 px-3 py-2 text-sm focus:outline-none focus:ring-1 focus:ring-indigo-500"}),g.jsxs("button",{onClick:s,className:`w-[110px] flex-shrink-0 flex items-center justify-center gap-2 px-4 py-2 text-sm font-semibold rounded-md transition-all duration-200 ${a?"bg-green-600 text-white":"bg-indigo-600 text-white hover:bg-indigo-700"}`,children:[a?g.jsx(Nue,{className:"w-5 h-5"}):g.jsx(Oue,{className:"w-5 h-5"}),g.jsx("span",{children:a?"Copiato!":"Copia"})]})]})]}),g.jsxs("div",{className:"bg-white p-4 rounded-lg border border-slate-200",children:[g.jsx("p",{className:"font-bold text-slate-800 mb-2",children:"2. Apri in una nuova scheda"}),g.jsxs("p",{className:"text-sm text-slate-600",children:["Apri una nuova scheda nel tuo browser e ",g.jsx("strong",{children:"incolla l'URL"}),"."]})]}),g.jsxs("div",{className:"bg-indigo-100 p-4 rounded-lg border border-indigo-200",children:[g.jsx("p",{className:"font-bold text-indigo-800 mb-2",children:"3. Aggiungi alla Home"}),g.jsx("p",{className:"text-sm text-indigo-700",children:u()})]})]}),g.jsx("div",{className:"px-6 py-4 bg-slate-50 flex justify-end",children:g.jsx("button",{type:"button",onClick:t,className:"px-4 py-2 text-base font-semibold text-slate-700 bg-white border border-slate-300 rounded-lg shadow-sm hover:bg-slate-100 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2 transition-colors",children:"Ho Capito"})})]})})},Iue=e=>g.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...e,children:g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 17.25v1.007a3 3 0 0 1-.879 2.122L7.5 21h9l-.621-.621A3 3 0 0 1 15 18.257V17.25m6-12V15a2.25 2.25 0 0 1-2.25 2.25H5.25A2.25 2.25 0 0 1 3 15V5.25A2.25 2.25 0 0 1 5.25 3h13.5A2.25 2.25 0 0 1 21 5.25Z"})}),ND=e=>g.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...e,children:g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 9.75 14.25 12m0 0 2.25 2.25M14.25 12l2.25-2.25M14.25 12 12 14.25m-2.58 4.92-6.374-6.375a1.125 1.125 0 0 1 0-1.59L9.42 4.83c.21-.211.497-.33.795-.33H19.5a2.25 2.25 0 0 1 2.25 2.25v10.5a2.25 2.25 0 0 1-2.25 2.25h-9.284c-.298 0-.585-.119-.795-.33Z"})}),e6=e=>{const t=String(e||"0").replace(".",","),[r,n]=t.split(","),a=(r||"0").replace(/\B(?=(\d{3})+(?!\d))/g,".");return n!==void 0?`${a},${n}`:a},Fue=e=>{const t=e.length;return t<=4?"text-9xl":t<=6?"text-8xl":t<=8?"text-7xl":t<=11?"text-6xl":"text-5xl"},Ia=({children:e,onClick:t,className:r="",...n})=>{const a=i=>{i&&i.blur&&i.blur()};return g.jsx("div",{role:"button",tabIndex:0,"aria-label":typeof e=="string"?`Tasto ${e}`:"Tasto","aria-pressed":"false",onClick:i=>{t==null||t(),a(i.currentTarget)},onKeyDown:i=>{(i.key==="Enter"||i.key===" ")&&t&&(i.preventDefault(),t(),a(i.currentTarget))},onPointerUp:i=>a(i.currentTarget),onMouseDown:i=>i.preventDefault(),className:`flex items-center justify-center text-5xl font-light focus:outline-none focus-visible:ring-2 focus-visible:ring-inset focus-visible:ring-indigo-400 transition-colors duration-150 select-none cursor-pointer active:scale-95 ${r}`,style:{WebkitTapHighlightColor:"transparent",touchAction:"manipulation",WebkitTouchCallout:"none",userSelect:"none"},...n,children:g.jsx("span",{className:"pointer-events-none",children:e})})},fu=({children:e,onClick:t})=>{const r=n=>{n&&n.blur&&n.blur()};return g.jsx("div",{role:"button",tabIndex:0,"aria-label":`Operatore ${e}`,"aria-pressed":"false",onClick:n=>{t(),r(n.currentTarget)},onKeyDown:n=>{(n.key==="Enter"||n.key===" ")&&(n.preventDefault(),t(),r(n.currentTarget))},onPointerUp:n=>r(n.currentTarget),onMouseDown:n=>n.preventDefault(),className:"flex-1 w-full text-5xl text-indigo-600 font-light active:bg-slate-300/80 transition-colors duration-150 flex items-center justify-center focus:outline-none focus-visible:ring-2 focus-visible:ring-inset focus-visible:ring-indigo-400 select-none cursor-pointer active:scale-95",style:{WebkitTapHighlightColor:"transparent",touchAction:"manipulation"},children:g.jsx("span",{className:"pointer-events-none",children:e})})},PD=me.forwardRef(({onClose:e,onSubmit:t,accounts:r,formData:n,onFormChange:a,onMenuStateChange:i,isDesktop:s,onNavigateToDetails:o},c)=>{var ie;const[u,d]=D.useState("0"),[h,p]=D.useState(null),[v,x]=D.useState(null),[w,y]=D.useState(!1),[_,S]=D.useState(!1),[k,E]=D.useState(null),T=D.useRef(!1),N=D.useRef(!1);D.useEffect(()=>{i(k!==null)},[k,i]),D.useEffect(()=>{const M=le=>{le.detail==="calculator"&&(N.current=!1,y(!1),S(!1))};return window.addEventListener("page-activated",M),()=>window.removeEventListener("page-activated",M)},[]);const C=D.useRef(null);D.useEffect(()=>{const M=n.amount??0,le=parseFloat(u.replace(/\./g,"").replace(",","."))||0;Math.abs(M-le)>.01&&!N.current&&(T.current=!0,d(String(M).replace(".",",")),p(null),x(null),y(!1),S(!1))},[n.amount,u]),D.useEffect(()=>{if(T.current){T.current=!1;return}return C.current&&clearTimeout(C.current),C.current=window.setTimeout(()=>{const M=parseFloat(u.replace(/\./g,"").replace(",","."))||0;Math.abs(M-(n.amount??0))>.01&&a({amount:M})},300),()=>{C.current&&clearTimeout(C.current)}},[u,n.amount,a]);const P=D.useCallback(()=>{N.current=!0,d("0"),S(!1)},[]),j=D.useCallback(()=>{if(N.current=!0,_){P();return}if(w){d("0"),p(null),x(null),y(!1);return}d(M=>{const le=M.replace(/\./g,"");return le.length>1?le.slice(0,-1):"0"})},[_,w,P]),R=D.useRef(null),I=D.useRef(!1),F=D.useRef(0),L=D.useRef(0),H=450,V=8,J=D.useCallback(()=>{R.current!==null&&(window.clearTimeout(R.current),R.current=null)},[]),te=D.useCallback(M=>{var le,ye;I.current=!1,F.current=M.clientX??0,L.current=M.clientY??0;try{(ye=(le=M.currentTarget).setPointerCapture)==null||ye.call(le,M.pointerId??1)}catch{}J(),R.current=window.setTimeout(()=>{I.current=!0,J(),P(),navigator.vibrate&&navigator.vibrate(10)},H)},[J,P]),q=D.useCallback(M=>{if(!R.current)return;const le=Math.abs((M.clientX??0)-F.current),ye=Math.abs((M.clientY??0)-L.current);(le>V||ye>V)&&J()},[J]),oe=D.useCallback(()=>{const M=I.current;if(J(),M){I.current=!1;return}j()},[J,j]),Q=D.useCallback(()=>{J()},[J]);D.useEffect(()=>{const M=()=>J();return window.addEventListener("numPad:cancelLongPress",M),()=>window.removeEventListener("numPad:cancelLongPress",M)},[J]);const Z=D.useCallback(()=>{const M=parseFloat((h||"0").replace(/\./g,"").replace(",",".")),le=parseFloat(u.replace(/\./g,"").replace(",","."));let ye=0;switch(v){case"+":ye=M+le;break;case"-":ye=M-le;break;case"":ye=M*le;break;case"":if(le===0)return"Error";ye=M/le;break;default:return u.replace(".",",")}return S(!0),String(parseFloat(ye.toPrecision(12))).replace(".",",")},[u,h,v]),ee=D.useCallback(M=>{if(N.current=!0,["","","-","+"].includes(M)){if(v&&h&&!w){const le=Z();p(le),d(le)}else p(u);x(M),y(!0),S(!1)}else if(M==="="){if(v&&h){const le=Z();d(le),p(null),x(null),y(!0)}}else{if(S(!1),w){d(M===","?"0,":M),y(!1);return}d(le=>{var ze;const ye=le.replace(/\./g,"");return M===","&&ye.includes(",")||ye.replace(",","").length>=12?le:ye==="0"&&M!==","?M:ye.includes(",")&&((ze=ye.split(",")[1])==null?void 0:ze.length)>=2?le:ye+M})}},[u,v,h,w,Z]),ce=D.useMemo(()=>(parseFloat(u.replace(/\./g,"").replace(",","."))||0)>0,[u]),de=D.useCallback(()=>{const M=parseFloat(u.replace(/\./g,"").replace(",","."))||0;M>0&&t({...n,amount:M,category:n.category||"Altro"})},[u,n,t]),Te=D.useCallback((M,le)=>{const ye={[M]:le};M==="category"&&(ye.subcategory=""),a(ye),E(null)},[a]),Ie=D.useMemo(()=>Object.keys(da).map(M=>({value:M,label:Qr(M).label,Icon:Qr(M).Icon,color:Qr(M).color,bgColor:Qr(M).bgColor})),[]),Ne=D.useMemo(()=>{var M;return n.category?((M=da[n.category])==null?void 0:M.map(le=>({value:le,label:le})))||[]:[]},[n.category]),W=D.useMemo(()=>r.map(M=>({value:M.id,label:M.name})),[r]),z=D.useMemo(()=>e6(u),[u]),G=D.useMemo(()=>h&&v?`${e6(h)} ${v}`:" ",[h,v]),X=D.useMemo(()=>Fue(z),[z]);return g.jsxs("div",{ref:c,tabIndex:-1,className:"bg-slate-100 w-full h-full flex flex-col focus:outline-none",style:{touchAction:"pan-y"},children:[g.jsxs("div",{className:"flex-1 flex flex-col",children:[g.jsxs("header",{className:"flex items-center justify-between p-4 flex-shrink-0",children:[g.jsx("button",{onClick:()=>e(),onPointerDown:M=>M.stopPropagation(),"data-no-synthetic-click":!0,"aria-label":"Chiudi calcolatrice",className:"w-11 h-11 flex items-center justify-center border border-red-300 text-red-600 bg-red-50 hover:bg-red-100 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500 rounded-full transition-colors cursor-pointer",children:g.jsx(fn,{className:"w-6 h-6"})}),g.jsx("h2",{className:"text-xl font-bold text-slate-800",children:"Nuova Spesa"}),g.jsx("button",{onClick:M=>{M.stopPropagation(),M.preventDefault();const le=ye=>{ye.stopPropagation(),ye.preventDefault()};window.addEventListener("click",le,{capture:!0,once:!0}),setTimeout(()=>window.removeEventListener("click",le,{capture:!0}),600),de()},onPointerDown:M=>M.stopPropagation(),"data-no-synthetic-click":!0,disabled:!ce,"aria-label":"Conferma spesa",className:`w-11 h-11 flex items-center justify-center border rounded-full transition-colors
              border-green-500 bg-green-200 text-green-800 hover:bg-green-300 
              focus:outline-none focus:ring-2 focus:ring-green-500 
              disabled:bg-slate-100 disabled:border-slate-200 disabled:text-slate-400 disabled:cursor-not-allowed
              ${s?"hidden":""}`,children:g.jsx(Ni,{className:"w-7 h-7"})}),s&&g.jsx("div",{className:"w-11 h-11"})]}),g.jsxs("main",{className:"flex-1 flex flex-col overflow-hidden relative",style:{touchAction:"pan-y"},children:[g.jsx("div",{className:"flex-1 flex flex-col justify-center items-center p-4 pt-0",children:g.jsxs("div",{className:"w-full px-4 text-center",children:[g.jsx("span",{className:"text-slate-500 text-2xl font-light h-8 block",children:G}),g.jsxs("div",{className:`relative inline-block text-slate-800 font-light tracking-tighter whitespace-nowrap transition-all leading-none ${X}`,children:[z,g.jsx("span",{className:"absolute right-full top-1/2 -translate-y-1/2 opacity-75",style:{fontSize:"0.6em",marginRight:"0.2em"},children:""})]})]})}),g.jsxs("div",{role:"button",tabIndex:0,"aria-label":"Aggiungi dettagli alla spesa","aria-hidden":s,onClick:o,onKeyDown:M=>{(M.key==="Enter"||M.key===" ")&&o()},className:`absolute top-1/2 -right-px w-8 h-[148px] flex items-center justify-center cursor-pointer ${s?"hidden":""}`,style:{transform:"translateY(calc(-50% + 2px))"},children:[g.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:g.jsx("div",{className:"transform -rotate-90",children:g.jsx(uD,{width:"148",height:"32",fill:"rgba(199, 210, 254, 0.8)"})})}),g.jsx(cD,{className:"relative z-10 w-6 h-6 text-indigo-600 transition-colors"})]})]})]}),g.jsxs("div",{className:"flex-shrink-0 flex flex-col",style:{height:"52vh"},children:[g.jsxs("div",{className:"flex justify-between items-center my-2 w-full px-4",style:{touchAction:"pan-y"},children:[g.jsx("button",{onClick:()=>E("account"),className:"font-semibold text-indigo-600 hover:text-indigo-800 text-lg w-1/3 truncate p-2 rounded-lg focus:outline-none focus:ring-0 text-left","aria-label":"Seleziona conto",children:((ie=r.find(M=>M.id===n.accountId))==null?void 0:ie.name)||"Conto"}),g.jsx("button",{onClick:()=>E("category"),className:"font-semibold text-indigo-600 hover:text-indigo-800 text-lg w-1/3 truncate p-2 rounded-lg focus:outline-none focus:ring-0 text-center","aria-label":"Seleziona categoria",children:n.category?Qr(n.category).label:"Categoria"}),g.jsx("button",{onClick:()=>E("subcategory"),disabled:!n.category||Ne.length===0,className:"font-semibold text-lg w-1/3 truncate p-2 rounded-lg focus:outline-none focus:ring-0 disabled:cursor-not-allowed disabled:text-slate-400 text-indigo-600 hover:text-indigo-800 transition-colors text-right","aria-label":"Seleziona sottocategoria","aria-disabled":!n.category||Ne.length===0,children:n.subcategory||"Sottocateg."})]}),g.jsxs("div",{className:"flex-1 p-2 flex flex-row gap-2 px-4 pb-4",children:[g.jsxs("div",{className:"h-full w-4/5 grid grid-cols-3 grid-rows-4 gap-2 num-pad",children:[g.jsx(Ia,{className:"text-slate-800",onClick:()=>ee("7"),children:"7"}),g.jsx(Ia,{className:"text-slate-800",onClick:()=>ee("8"),children:"8"}),g.jsx(Ia,{className:"text-slate-800",onClick:()=>ee("9"),children:"9"}),g.jsx(Ia,{className:"text-slate-800",onClick:()=>ee("4"),children:"4"}),g.jsx(Ia,{className:"text-slate-800",onClick:()=>ee("5"),children:"5"}),g.jsx(Ia,{className:"text-slate-800",onClick:()=>ee("6"),children:"6"}),g.jsx(Ia,{className:"text-slate-800",onClick:()=>ee("1"),children:"1"}),g.jsx(Ia,{className:"text-slate-800",onClick:()=>ee("2"),children:"2"}),g.jsx(Ia,{className:"text-slate-800",onClick:()=>ee("3"),children:"3"}),g.jsx(Ia,{className:"text-slate-800",onClick:()=>ee(","),children:","}),g.jsx(Ia,{className:"text-slate-800",onClick:()=>ee("0"),children:"0"}),g.jsx(Ia,{title:"Tocca: cancella una cifra  Tieni premuto: cancella tutto","aria-label":"Cancella",onPointerDownCapture:te,onPointerMoveCapture:q,onPointerUpCapture:oe,onPointerCancelCapture:Q,onContextMenu:M=>M.preventDefault(),children:g.jsx(ND,{className:"w-8 h-8 text-slate-800"})})]}),g.jsxs("div",{className:"h-full w-1/5 flex flex-col gap-2 bg-slate-200 rounded-2xl p-1",style:{touchAction:"pan-y"},children:[g.jsx(fu,{onClick:()=>ee(""),children:""}),g.jsx(fu,{onClick:()=>ee(""),children:""}),g.jsx(fu,{onClick:()=>ee("-"),children:"-"}),g.jsx(fu,{onClick:()=>ee("+"),children:"+"}),g.jsx(fu,{onClick:()=>ee("="),children:"="})]})]})]}),g.jsx(oi,{isOpen:k==="account",onClose:()=>E(null),title:"Seleziona un Conto",options:W,selectedValue:n.accountId||"",onSelect:M=>Te("accountId",M)}),g.jsx(oi,{isOpen:k==="category",onClose:()=>E(null),title:"Seleziona una Categoria",options:Ie,selectedValue:n.category||"",onSelect:M=>Te("category",M)}),g.jsx(oi,{isOpen:k==="subcategory",onClose:()=>E(null),title:"Seleziona Sottocategoria",options:Ne,selectedValue:n.subcategory||"",onSelect:M=>Te("subcategory",M)})]})});PD.displayName="CalculatorInputScreen";const t6=e=>{const t=e.getFullYear(),r=String(e.getMonth()+1).padStart(2,"0"),n=String(e.getDate()).padStart(2,"0");return`${t}-${r}-${n}`},V_=e=>{if(!e)return null;const[t,r,n]=e.split("-").map(Number);return new Date(Date.UTC(t,r-1,n))},Yd={daily:"Giornaliera",weekly:"Settimanale",monthly:"Mensile",yearly:"Annuale"},Due={0:"Dom",1:"Lun",2:"Mar",3:"Mer",4:"Gio",5:"Ven",6:"Sab"},ID=["domenica","luned","marted","mercoled","gioved","venerd","sabato"],FD=["primo","secondo","terzo","quarto","ultimo"],jue=e=>{const t=V_(e);return t?new Intl.DateTimeFormat("it-IT",{day:"numeric",month:"short",timeZone:"UTC"}).format(t).replace(".",""):""},Zd=D.memo(({isOpen:e,isAnimating:t,onClose:r,title:n,children:a,className:i})=>!e&&!t?null:g.jsx("div",{className:`absolute inset-0 z-[60] flex justify-center items-center p-4 transition-opacity duration-300 ${t?"opacity-100":"opacity-0"} bg-slate-900/60 backdrop-blur-sm`,onClick:s=>{s.stopPropagation(),r()},onPointerDown:s=>s.stopPropagation(),onPointerUp:s=>s.stopPropagation(),onPointerMove:s=>s.stopPropagation(),"aria-modal":"true",role:"dialog",children:g.jsxs("div",{className:`bg-white rounded-lg shadow-xl w-full max-w-sm transform transition-all duration-300 ${t?"scale-100 opacity-100":"scale-95 opacity-0"} ${i||""}`,onClick:s=>s.stopPropagation(),children:[g.jsxs("div",{className:"flex justify-between items-center p-4 border-b border-slate-200",children:[g.jsx("h2",{className:"text-lg font-bold text-slate-800",children:n}),g.jsx("button",{type:"button",onClick:r,className:"text-slate-500 hover:text-slate-800 p-1 rounded-full hover:bg-slate-200 focus:outline-none focus:ring-2 focus:ring-indigo-500","aria-label":"Chiudi",children:g.jsx(fn,{className:"w-6 h-6"})})]}),a]})}));Zd.displayName="Modal";const Rue=[{label:"Lun",value:1},{label:"Mar",value:2},{label:"Mer",value:3},{label:"Gio",value:4},{label:"Ven",value:5},{label:"Sab",value:6},{label:"Dom",value:0}],Mue=e=>{if(e.frequency!=="recurring"||!e.recurrence)return"Imposta ricorrenza";const{recurrence:t,recurrenceInterval:r=1,recurrenceDays:n,monthlyRecurrenceType:a,date:i,recurrenceEndType:s="forever",recurrenceEndDate:o,recurrenceCount:c}=e;let u="";if(r===1?u=Yd[t]:u=t==="daily"?`Ogni ${r} giorni`:t==="weekly"?`Ogni ${r} sett.`:t==="monthly"?`Ogni ${r} mesi`:`Ogni ${r} anni`,t==="weekly"&&(n!=null&&n.length)){const h=[...n].sort((p,v)=>(p===0?7:p)-(v===0?7:v)).map(p=>Due[p]);u+=`: ${h.join(", ")}`}if(t==="monthly"&&a==="dayOfWeek"&&i){const d=V_(i);if(d){const h=d.getUTCDate(),p=d.getUTCDay(),v=Math.floor((h-1)/7);u+=` (${FD[v]} ${ID[p].slice(0,3)}.)`}}return s==="date"&&o?u+=`, fino al ${jue(o)}`:s==="count"&&c&&c>0&&(u+=`, ${c} volte`),u},Lue=(e,t)=>{const r=t||1;switch(e){case"daily":return r===1?"giorno":"giorni";case"weekly":return r===1?"settimana":"settimane";case"monthly":return r===1?"mese":"mesi";case"yearly":return r===1?"anno":"anni";default:return"mese"}},Bue=({formData:e,onFormChange:t,accounts:r,onClose:n,onSubmit:a,isDesktop:i,onMenuStateChange:s,dateError:o})=>{var mt;const c=D.useRef(null),u=D.useRef(null),d=vs(),[h,p]=D.useState(null),[v,x]=D.useState(!1),[w,y]=D.useState(!1),[_,S]=D.useState(!1),[k,E]=D.useState(!1),[T,N]=D.useState(!1),[C,P]=D.useState(!1),[j,R]=D.useState(!1),[I,F]=D.useState(!1),L=D.useRef(0),[H,V]=D.useState(null),[J,te]=D.useState(e.recurrence),[q,oe]=D.useState(e.recurrenceInterval),[Q,Z]=D.useState(e.recurrenceDays),[ee,ce]=D.useState(e.monthlyRecurrenceType),de=D.useRef(e);D.useEffect(()=>{de.current=e},[e]);const Te=e.frequency==="recurring"&&e.recurrenceEndType==="count"&&e.recurrenceCount===1;D.useEffect(()=>{if(!e.time&&!e.frequency){const Ee=new Date().toLocaleTimeString("it-IT",{hour:"2-digit",minute:"2-digit"});t({time:Ee})}},[]);const Ie=D.useRef(null);D.useEffect(()=>{Ie.current=()=>{const Ee=document.activeElement;Ee===u.current&&Ee.blur()}},[]),D.useEffect(()=>{const Ee=window.visualViewport;if(!Ee)return;let ve=Ee.height;const fe=()=>{Ee.height-ve>100&&Ie.current&&Ie.current(),ve=Ee.height};return Ee.addEventListener("resize",fe),()=>Ee.removeEventListener("resize",fe)},[]),D.useEffect(()=>{s(!!(h||v||_||j))},[h,v,_,j,s]),D.useEffect(()=>{if(v){const Ee=setTimeout(()=>y(!0),10);return()=>clearTimeout(Ee)}else y(!1)},[v]),D.useEffect(()=>{if(j){const Ee=setTimeout(()=>F(!0),10);return()=>clearTimeout(Ee)}else F(!1)},[j]),D.useEffect(()=>{if(_){te(e.recurrence||"monthly"),oe(e.recurrenceInterval||1),Z(e.recurrenceDays||[]),ce(e.monthlyRecurrenceType||"dayOfMonth"),N(!1);const Ee=setTimeout(()=>E(!0),10);return()=>clearTimeout(Ee)}else E(!1)},[_,e.recurrence,e.recurrenceInterval,e.recurrenceDays,e.monthlyRecurrenceType]);const Ne=Ee=>{const{name:ve,value:fe}=Ee.target;if(ve==="recurrenceEndDate"){t(fe===""?{recurrenceEndType:"forever",recurrenceEndDate:void 0}:{recurrenceEndDate:fe});return}if(ve==="recurrenceCount"){const pe=parseInt(fe,10);t({[ve]:isNaN(pe)||pe<=0?void 0:pe});return}t({[ve]:fe})},W=Ee=>{t({accountId:Ee}),p(null)},z=Ee=>{const ve={};Ee==="none"?Object.assign(ve,{frequency:void 0,date:t6(new Date),time:void 0,recurrence:void 0,monthlyRecurrenceType:void 0,recurrenceInterval:void 0,recurrenceDays:void 0,recurrenceEndType:"forever",recurrenceEndDate:void 0,recurrenceCount:void 0}):Ee==="single"?(ve.frequency="recurring",ve.recurrence=void 0,ve.recurrenceInterval=void 0,ve.recurrenceDays=void 0,ve.monthlyRecurrenceType=void 0,ve.recurrenceEndType="count",ve.recurrenceCount=1,ve.recurrenceEndDate=void 0):(ve.frequency="recurring",ve.time=void 0,e.recurrence||(ve.recurrence="monthly"),ve.recurrenceEndType="forever",ve.recurrenceCount=void 0,ve.recurrenceEndDate=void 0),t(ve),x(!1),y(!1)},G=()=>{t({recurrence:J,recurrenceInterval:q||1,recurrenceDays:J==="weekly"?Q:void 0,monthlyRecurrenceType:J==="monthly"?ee:void 0}),S(!1),E(!1)},X=D.useCallback(()=>{R(!1),F(!1),L.current=Date.now()},[]),ie=(Ee,ve)=>{Ee.stopPropagation(),Ee.preventDefault();const fe=up(ve);setTimeout(()=>{X()},500),fe.then(async pe=>{const{base64:nt}=await ql(pe),De=de.current.receipts||[];t({receipts:[...De,nt]})}).catch(pe=>{})},M=Ee=>{const fe=(e.receipts||[]).filter((pe,nt)=>nt!==Ee);t({receipts:fe})},le=D.useMemo(()=>{const Ee=e.date;if(!Ee)return"Seleziona una data di inizio valida";const ve=V_(Ee);if(!ve)return"Data non valida";const fe=ve.getUTCDate(),pe=ve.getUTCDay(),nt=Math.floor((fe-1)/7);return`Ogni ${FD[nt]} ${ID[pe]} del mese`},[e.date]),ye=()=>{const Ee=e.recurrenceEndType;return!Ee||Ee==="forever"?"Per sempre":Ee==="date"?"Fino a...":Ee==="count"?"Numero di volte":"Per sempre"},Ce=()=>H?Bp.createPortal(g.jsxs("div",{className:"fixed inset-0 z-[6000] bg-black/95 flex items-center justify-center p-4 animate-fade-in-up",onClick:()=>V(null),children:[g.jsx("button",{className:"absolute top-4 right-4 text-white/80 hover:text-white p-2 transition-colors z-50",onClick:()=>V(null),children:g.jsx(fn,{className:"w-8 h-8"})}),g.jsx("img",{src:`data:image/png;base64,${H}`,className:"max-w-full max-h-full object-contain rounded-sm shadow-2xl",alt:"Ricevuta Full Screen",onClick:Ee=>Ee.stopPropagation()})]}),document.body):null;if(typeof e.amount!="number")return g.jsxs("div",{ref:c,tabIndex:-1,className:"flex flex-col h-full bg-slate-100 items-center justify-center p-4",...d,children:[g.jsxs("header",{className:"p-4 flex items-center gap-4 text-slate-800 bg-white shadow-sm absolute top-0 left-0 right-0 z-10",children:[!i&&g.jsx("button",{onClick:n,className:"p-2 rounded-full hover:bg-slate-200","aria-label":"Torna alla calcolatrice",children:g.jsx(us,{className:"w-6 h-6"})}),g.jsx("h2",{className:"text-xl font-bold",children:"Aggiungi Dettagli"})]}),g.jsx("p",{className:"text-slate-500 text-center",children:"Nessun dato dall'importo. Torna indietro e inserisci una spesa."})]});const ze=!!e.frequency,Ze=(mt=r.find(Ee=>Ee.id===e.accountId))==null?void 0:mt.name,rt=D.useMemo(()=>r.map(Ee=>({value:Ee.id,label:Ee.name})),[r]),xt=D.useMemo(()=>g.jsxs("div",{className:`grid ${e.frequency?"grid-cols-1":"grid-cols-2"} gap-4`,children:[g.jsxs("div",{children:[g.jsx("label",{htmlFor:"date",className:`block text-base font-medium mb-1 ${o?"text-red-600":"text-slate-700"}`,children:Te?"Data del Pagamento":e.frequency==="recurring"?"Data di inizio":"Data"}),g.jsxs("div",{className:"relative",children:[g.jsx("div",{className:"pointer-events-none absolute inset-y-0 left-0 flex items-center pl-3",children:g.jsx(Gw,{className:"h-5 w-5 text-slate-400"})}),g.jsx("input",{id:"date",name:"date",type:"date",value:e.date||"",onChange:Ne,className:`block w-full rounded-md bg-white py-2.5 pl-10 pr-3 text-base text-slate-900 placeholder:text-slate-400 focus:outline-none ${o?"border-red-500 ring-1 ring-red-500":"border border-slate-300 focus:border-indigo-500 focus:ring-1 focus:ring-indigo-500"}`,enterKeyHint:"done",onKeyDown:Ee=>{Ee.key==="Enter"&&(Ee.currentTarget.blur(),Ee.preventDefault())},onFocus:Ee=>Ee.currentTarget.scrollIntoView({behavior:"smooth",block:"center"})})]}),o&&g.jsx("p",{className:"mt-1 text-sm text-red-600",children:"Per favore, imposta una data."})]}),!e.frequency&&g.jsxs("div",{children:[g.jsx("label",{htmlFor:"time",className:"block text-base font-medium text-slate-700 mb-1",children:"Ora"}),g.jsxs("div",{className:"relative",children:[g.jsx("div",{className:"pointer-events-none absolute inset-y-0 left-0 flex items-center pl-3",children:g.jsx(vD,{className:"h-5 w-5 text-slate-400"})}),g.jsx("input",{id:"time",name:"time",type:"time",value:e.time||"",onChange:Ne,className:"block w-full rounded-md border border-slate-300 bg-white py-2.5 pl-10 pr-3 text-base text-slate-900 placeholder:text-slate-400 focus:outline-none focus:border-indigo-500 focus:ring-1 focus:ring-indigo-500",enterKeyHint:"done",onKeyDown:Ee=>{Ee.key==="Enter"&&(Ee.currentTarget.blur(),Ee.preventDefault())},onFocus:Ee=>Ee.currentTarget.scrollIntoView({behavior:"smooth",block:"center"})})]})]})]}),[e.frequency,e.date,o,e.time,Te]);return g.jsxs("div",{ref:c,tabIndex:-1,className:"flex flex-col h-full bg-slate-100 focus:outline-none",style:{touchAction:"pan-y"},...d,children:[g.jsxs("header",{className:"p-4 flex items-center justify-between gap-4 text-slate-800 bg-white shadow-sm sticky top-0 z-10",children:[g.jsxs("div",{className:"flex items-center gap-4",children:[!i&&g.jsx("button",{onClick:n,className:"p-2 rounded-full hover:bg-slate-200","aria-label":"Torna alla calcolatrice",children:g.jsx(us,{className:"w-6 h-6"})}),g.jsx("h2",{className:"text-xl font-bold",children:"Aggiungi Dettagli"})]}),g.jsx("div",{className:"w-11 h-11"})]}),g.jsxs("main",{className:"flex-1 p-4 flex flex-col overflow-y-auto",style:{touchAction:"pan-y"},children:[g.jsxs("div",{className:"space-y-2",children:[g.jsx("div",{className:"flex justify-center items-center py-0",children:g.jsxs("div",{className:"relative flex items-baseline justify-center text-indigo-600",children:[g.jsx("span",{className:"text-[2.6rem] leading-none font-bold tracking-tighter relative z-10",children:Ti(e.amount||0).replace(/[^0-9,.]/g,"")}),g.jsx("span",{className:"text-3xl font-medium text-indigo-400 opacity-70 absolute",style:{right:"100%",marginRight:"8px",top:"4px"},children:""})]})}),g.jsxs("div",{children:[g.jsx("label",{htmlFor:"description",className:"block text-base font-medium text-slate-700 mb-1",children:"Descrizione"}),g.jsxs("div",{className:"relative",children:[g.jsx("div",{className:"pointer-events-none absolute inset-y-0 left-0 flex items-center pl-3",children:g.jsx(z_,{className:"h-5 w-5 text-slate-400"})}),g.jsx("input",{ref:u,id:"description",name:"description",type:"text",value:e.description||"",onChange:Ne,className:"block w-full rounded-md border border-slate-300 bg-white py-2.5 pl-10 pr-3 text-base text-slate-900 placeholder:text-slate-400 focus:outline-none focus:border-indigo-500 focus:ring-1 focus:ring-indigo-500",placeholder:"Es. Caff al bar",enterKeyHint:"done",onKeyDown:Ee=>{Ee.key==="Enter"&&(Ee.currentTarget.blur(),Ee.preventDefault())}})]})]}),g.jsxs("div",{children:[g.jsx("label",{className:"block text-base font-medium text-slate-700 mb-1",children:"Conto"}),g.jsxs("button",{type:"button",onClick:()=>p("account"),className:"w-full flex items-center text-left gap-2 px-3 py-2.5 text-base rounded-lg border shadow-sm focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 transition-colors bg-white border-slate-300 text-slate-800 hover:bg-slate-50",children:[g.jsx(Xp,{className:"h-5 w-5 text-slate-400"}),g.jsx("span",{className:"truncate flex-1",children:Ze||"Seleziona"}),g.jsx(Ua,{className:"w-5 h-5 text-slate-500"})]})]}),!ze&&xt,g.jsxs("div",{children:[g.jsx("label",{className:"block text-base font-medium text-slate-700 mb-1",children:"Ricevuta"}),e.receipts&&e.receipts.length>0&&g.jsx("div",{className:"grid grid-cols-2 gap-2 mb-2",children:e.receipts.map((Ee,ve)=>g.jsxs("div",{className:"relative rounded-lg overflow-hidden border border-slate-200 shadow-sm aspect-video bg-slate-50 cursor-pointer hover:border-indigo-300 transition-colors",onClick:()=>V(Ee),children:[g.jsx("img",{src:`data:image/png;base64,${Ee}`,alt:"Ricevuta",className:"w-full h-full object-cover"}),g.jsx("button",{type:"button",onClick:fe=>{fe.stopPropagation(),M(ve)},onPointerDown:fe=>fe.stopPropagation(),className:"absolute top-1 right-1 p-1.5 bg-white/90 text-red-600 rounded-full shadow-md hover:bg-red-50 hover:text-red-700 transition-colors z-10 flex items-center justify-center","aria-label":"Rimuovi ricevuta",children:g.jsx(fn,{className:"w-5 h-5"})})]},ve))}),g.jsxs("button",{type:"button",onClick:()=>{Date.now()-L.current<500||R(!0)},className:"w-full flex items-center justify-center gap-2 px-3 py-2.5 text-base rounded-lg border border-dashed border-indigo-300 bg-indigo-50 text-indigo-600 hover:bg-indigo-100 hover:border-indigo-400 transition-colors focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500",children:[g.jsx(gD,{className:"w-5 h-5"}),g.jsx("span",{children:e.receipts&&e.receipts.length>0?"Aggiungi un'altra ricevuta":"Allega Ricevuta"})]})]}),g.jsxs("div",{className:"bg-white p-4 rounded-lg border border-slate-200 space-y-4",children:[g.jsxs("div",{children:[g.jsx("label",{className:"block text-base font-medium text-slate-700 mb-1",children:"Frequenza"}),g.jsxs("button",{type:"button",onClick:()=>x(!0),className:`w-full flex items-center justify-between text-left gap-2 px-3 py-2.5 text-base rounded-lg border shadow-sm focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 transition-colors ${ze?"bg-white border-slate-300 text-slate-800 hover:bg-slate-50":"bg-slate-100 border-slate-200 text-slate-500 hover:bg-slate-200"}`,children:[g.jsx("span",{className:"truncate flex-1 capitalize",children:Te?"Singolo":e.frequency==="recurring"?"Ricorrente":"Nessuna"}),g.jsx(Ua,{className:"w-5 h-5 text-slate-500"})]})]}),ze&&xt,e.frequency==="recurring"&&!Te&&g.jsxs("div",{children:[g.jsx("label",{className:"block text-base font-medium text-slate-700 mb-1",children:"Ricorrenza"}),g.jsxs("button",{type:"button",onClick:()=>S(!0),className:"w-full flex items-center justify-between text-left gap-2 px-3 py-2.5 text-base rounded-lg border shadow-sm focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 transition-colors bg-white border-slate-300 text-slate-800 hover:bg-slate-50",children:[g.jsx("span",{className:"truncate flex-1",children:Mue(e)}),g.jsx(Ua,{className:"w-5 h-5 text-slate-500"})]})]})]})]}),g.jsx("div",{className:"mt-auto pt-6",children:g.jsx("button",{type:"button",onClick:()=>a(e),disabled:(e.amount??0)<=0,className:"w-full px-4 py-3 text-base font-semibold text-white bg-indigo-600 rounded-lg shadow-sm hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2 transition-colors disabled:bg-indigo-300 disabled:cursor-not-allowed disabled:active:scale-100",children:"Aggiungi Spesa"})})]}),g.jsx(oi,{isOpen:h==="account",onClose:()=>p(null),title:"Seleziona un Conto",options:rt,selectedValue:e.accountId||"",onSelect:W}),g.jsx(Zd,{isOpen:v,isAnimating:w,onClose:()=>{x(!1),y(!1)},title:"Seleziona Frequenza",children:g.jsxs("div",{className:"p-4 space-y-2",children:[g.jsx("button",{onClick:()=>z("none"),className:"w-full px-4 py-3 text-base font-semibold rounded-lg bg-slate-100 text-slate-800 hover:bg-indigo-100 hover:text-indigo-800",children:"Nessuna"}),g.jsx("button",{onClick:()=>z("single"),className:"w-full px-4 py-3 text-base font-semibold rounded-lg bg-slate-100 text-slate-800 hover:bg-indigo-100 hover:text-indigo-800",children:"Singolo"}),g.jsx("button",{onClick:()=>z("recurring"),className:"w-full px-4 py-3 text-base font-semibold rounded-lg bg-slate-100 text-slate-800 hover:bg-indigo-100 hover:text-indigo-800",children:"Ricorrente"})]})}),g.jsx(Zd,{isOpen:j,isAnimating:I,onClose:X,title:"Allega Ricevuta",children:g.jsxs("div",{className:"p-4 grid grid-cols-2 gap-4",children:[g.jsxs("button",{onClick:Ee=>ie(Ee,"camera"),className:"flex flex-col items-center justify-center gap-3 p-4 rounded-xl bg-slate-50 border border-slate-200 hover:bg-indigo-50 hover:border-indigo-200 transition-colors",children:[g.jsx("div",{className:"w-12 h-12 rounded-full bg-white flex items-center justify-center shadow-sm text-indigo-600",children:g.jsx(q_,{className:"w-7 h-7"})}),g.jsx("span",{className:"font-semibold text-slate-700",children:"Fotocamera"})]}),g.jsxs("button",{onClick:Ee=>ie(Ee,"gallery"),className:"flex flex-col items-center justify-center gap-3 p-4 rounded-xl bg-slate-50 border border-slate-200 hover:bg-indigo-50 hover:border-indigo-200 transition-colors",children:[g.jsx("div",{className:"w-12 h-12 rounded-full bg-white flex items-center justify-center shadow-sm text-purple-600",children:g.jsx(dp,{className:"w-7 h-7"})}),g.jsx("span",{className:"font-semibold text-slate-700",children:"Galleria"})]})]})}),g.jsxs(Zd,{isOpen:_,isAnimating:k,onClose:()=>{S(!1),E(!1)},title:"Imposta Ricorrenza",children:[g.jsxs("main",{className:"p-4 space-y-4",children:[g.jsxs("div",{className:"relative",children:[g.jsxs("button",{onClick:()=>{N(Ee=>!Ee),P(!1)},className:"w-full flex items-center justify-between text-left gap-2 px-3 py-2.5 text-base rounded-lg border shadow-sm focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 bg-white border-slate-300 text-slate-800 hover:bg-slate-50",children:[g.jsx("span",{className:"truncate flex-1 capitalize",children:Yd[J||"monthly"]}),g.jsx(Ua,{className:`w-5 h-5 text-slate-500 transition-transform ${T?"rotate-180":""}`})]}),T&&g.jsx("div",{className:"absolute top-full mt-1 w-full bg-white border border-slate-200 shadow-lg rounded-lg z-20 p-2 space-y-1 animate-fade-in-down",children:Object.keys(Yd).map(Ee=>g.jsx("button",{onClick:()=>{te(Ee),N(!1)},className:"w-full text-left px-4 py-3 text-base font-semibold rounded-lg bg-slate-50 text-slate-800 hover:bg-indigo-100 hover:text-indigo-800",children:Yd[Ee]},Ee))})]}),g.jsx("div",{className:"pt-2",children:g.jsxs("div",{className:"flex items-center justify-center gap-2 bg-slate-100 p-3 rounded-lg",children:[g.jsx("span",{className:"text-base text-slate-700",children:"Ogni"}),g.jsx("input",{type:"number",value:q||"",onChange:Ee=>{const ve=Ee.target.value;if(ve==="")oe(void 0);else{const fe=parseInt(ve,10);!isNaN(fe)&&fe>0&&oe(fe)}},onFocus:Ee=>Ee.currentTarget.select(),className:"w-12 text-center text-lg font-bold text-slate-800 bg-transparent border-0 border-b-2 border-slate-400 focus:ring-0 focus:outline-none focus:border-indigo-600 p-0",min:1}),g.jsx("span",{className:"text-base text-slate-700",children:Lue(J,q)})]})}),J==="weekly"&&g.jsx("div",{className:"pt-2",children:g.jsx("div",{className:"flex flex-wrap justify-center gap-2",children:Rue.map(Ee=>g.jsx("button",{onClick:()=>{Z(ve=>{const fe=ve||[];return(fe.includes(Ee.value)?fe.filter(nt=>nt!==Ee.value):[...fe,Ee.value]).sort((nt,De)=>(nt===0?7:nt)-(De===0?7:De))})},className:`w-14 h-14 rounded-full text-sm font-semibold border-2 transition-colors ${(Q||[]).includes(Ee.value)?"bg-indigo-600 text-white border-indigo-600":"bg-white text-slate-800 border-indigo-400 hover:bg-indigo-50"}`,children:Ee.label},Ee.value))})}),J==="monthly"&&g.jsxs("div",{className:"pt-4 space-y-2 border-t border-slate-200",children:[g.jsxs("div",{role:"radio","aria-checked":ee==="dayOfMonth",onClick:()=>ce("dayOfMonth"),className:"flex items-center gap-3 p-2 cursor-pointer rounded-lg hover:bg-slate-100",children:[g.jsx("div",{className:"w-5 h-5 rounded-full border-2 border-slate-400 flex items-center justify-center flex-shrink-0",children:ee==="dayOfMonth"&&g.jsx("div",{className:"w-2.5 h-2.5 bg-indigo-600 rounded-full"})}),g.jsx("span",{className:"text-sm font-medium text-slate-700",children:"Lo stesso giorno di ogni mese"})]}),g.jsxs("div",{role:"radio","aria-checked":ee==="dayOfWeek",onClick:()=>ce("dayOfWeek"),className:"flex items-center gap-3 p-2 cursor-pointer rounded-lg hover:bg-slate-100",children:[g.jsx("div",{className:"w-5 h-5 rounded-full border-2 border-slate-400 flex items-center justify-center flex-shrink-0",children:ee==="dayOfWeek"&&g.jsx("div",{className:"w-2.5 h-2.5 bg-indigo-600 rounded-full"})}),g.jsx("span",{className:"text-sm font-medium text-slate-700",children:le})]})]}),g.jsx("div",{className:"pt-4 border-t border-slate-200",children:g.jsxs("div",{className:"grid grid-cols-2 gap-4 items-end",children:[g.jsxs("div",{className:`relative ${!e.recurrenceEndType||e.recurrenceEndType==="forever"?"col-span-2":""}`,children:[g.jsxs("button",{type:"button",onClick:()=>{P(Ee=>!Ee),N(!1)},className:"w-full flex items-center justify-between text-left gap-2 px-3 py-2.5 text-base rounded-lg border shadow-sm focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 bg-white border-slate-300 text-slate-800 hover:bg-slate-50",children:[g.jsx("span",{className:"truncate flex-1 capitalize",children:ye()}),g.jsx(Ua,{className:`w-5 h-5 text-slate-500 transition-transform ${C?"rotate-180":""}`})]}),C&&g.jsx("div",{className:"absolute top-full mt-1 w-full bg-white border border-slate-200 shadow-lg rounded-lg z-20 p-2 space-y-1 animate-fade-in-down",children:["forever","date","count"].map(Ee=>g.jsx("button",{onClick:()=>{Ee==="forever"&&t({recurrenceEndType:"forever",recurrenceEndDate:void 0,recurrenceCount:void 0}),Ee==="date"&&t({recurrenceEndType:"date",recurrenceEndDate:e.recurrenceEndDate||t6(new Date),recurrenceCount:void 0}),Ee==="count"&&t({recurrenceEndType:"count",recurrenceCount:e.recurrenceCount||1,recurrenceEndDate:void 0}),P(!1)},className:"w-full text-left px-4 py-3 text-base font-semibold rounded-lg bg-slate-50 text-slate-800 hover:bg-indigo-100 hover:text-indigo-800",children:Ee==="forever"?"Per sempre":Ee==="date"?"Fino a...":"Numero di volte"},Ee))})]}),e.recurrenceEndType==="date"&&g.jsxs("div",{children:[g.jsx("label",{htmlFor:"recurrence-end-date",className:"block text-sm font-medium text-slate-700 mb-1",children:"Data fine"}),g.jsx("input",{id:"recurrence-end-date",name:"recurrenceEndDate",type:"date",value:e.recurrenceEndDate||"",onChange:Ne,className:"block w-full rounded-md border border-slate-300 bg-white py-2.5 px-3 text-base text-slate-900 placeholder:text-slate-400 focus:outline-none focus:border-indigo-500 focus:ring-1 focus:ring-indigo-500",enterKeyHint:"done",onKeyDown:Ee=>{Ee.key==="Enter"&&(Ee.currentTarget.blur(),Ee.preventDefault())}})]}),e.recurrenceEndType==="count"&&g.jsxs("div",{children:[g.jsx("label",{htmlFor:"recurrence-count",className:"block text-sm font-medium text-slate-700 mb-1",children:"N. volte"}),g.jsx("input",{id:"recurrence-count",name:"recurrenceCount",type:"number",value:e.recurrenceCount||"",onChange:Ne,className:"block w-full rounded-md border border-slate-300 bg-white py-2.5 px-3 text-base text-slate-900 placeholder:text-slate-400 focus:outline-none focus:border-indigo-500 focus:ring-1 focus:ring-indigo-500",min:1,enterKeyHint:"done",onKeyDown:Ee=>{Ee.key==="Enter"&&(Ee.currentTarget.blur(),Ee.preventDefault())}})]})]})})]}),g.jsx("footer",{className:"p-4 bg-slate-100 border-t border-slate-200 flex justify-end",children:g.jsx("button",{type:"button",onClick:G,className:"px-4 py-2 text-sm font-semibold text-white bg-indigo-600 rounded-lg shadow-sm hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2",children:"Applica"})})]}),Ce()]})},$ue=e=>{const[t,r]=D.useState(()=>typeof window<"u"?window.matchMedia(e).matches:!1);return D.useEffect(()=>{const n=window.matchMedia(e),a=()=>r(n.matches);return n.addEventListener("change",a),()=>n.removeEventListener("change",a)},[e]),t},Uue=e=>{const t=e.getUTCFullYear(),r=String(e.getUTCMonth()+1).padStart(2,"0"),n=String(e.getUTCDate()).padStart(2,"0");return`${t}-${r}-${n}`},zue=()=>new Date().toLocaleTimeString("it-IT",{hour:"2-digit",minute:"2-digit",timeZone:"UTC"}),Wue=({isOpen:e,onClose:t,onSubmit:r,accounts:n,onMenuStateChange:a=i=>{}})=>{const[i,s]=D.useState(!1),[o,c]=D.useState("calculator"),[u,d]=D.useState(!1),[h,p]=D.useState(!1),[v,x]=D.useState(!1),[w,y]=D.useState(!1),_=D.useRef(!1),[S,k]=D.useState(!1),[E,T]=D.useState(!1),N=D.useRef([]),C=vs(),P=D.useCallback(ce=>(N.current.push(ce),ce),[]),j=D.useCallback(()=>{var ce;return{amount:0,description:"",date:Uue(new Date),time:zue(),accountId:((ce=n[0])==null?void 0:ce.id)||"",category:"",subcategory:void 0,frequency:void 0,recurrence:void 0,monthlyRecurrenceType:"dayOfMonth",recurrenceInterval:void 0,recurrenceDays:void 0,recurrenceEndType:"forever",recurrenceEndDate:void 0,recurrenceCount:void 0}},[n]),[R,I]=D.useState(j),F=$ue("(min-width: 768px)");D.useEffect(()=>{const ce=window.visualViewport;if(!ce||!e)return;d(!1);const de=()=>{const Te=window.innerHeight-ce.height>120;d(Te)};return ce.addEventListener("resize",de),()=>ce.removeEventListener("resize",de)},[e]),D.useEffect(()=>{if(e){I(j()),x(!1),y(!1),_.current=!1,c("calculator"),k(!1),T(!1);const ce=P(window.setTimeout(()=>s(!0),10)),de=P(window.setTimeout(()=>k(!0),50)),Te=P(window.setTimeout(()=>T(!0),300));return()=>{clearTimeout(ce),clearTimeout(de),clearTimeout(Te)}}else{s(!1),k(!1),T(!1);const ce=P(window.setTimeout(()=>{I(j()),x(!1),y(!1),_.current=!1},300));return()=>clearTimeout(ce)}},[e,j,P]),D.useEffect(()=>{if(!e)return;const ce=de=>{if(o==="details"){const Te=de.state;(!Te||Te.modal!=="calculator_details")&&c("calculator")}};return window.addEventListener("popstate",ce),()=>window.removeEventListener("popstate",ce)},[e,o]),D.useEffect(()=>()=>N.current.forEach(clearTimeout),[]);const L=D.useRef(null),H=D.useCallback(ce=>{var de,Te;if(o!==ce){if((Te=(de=document.activeElement)==null?void 0:de.blur)==null||Te.call(de),ce==="details")window.history.pushState({modal:"calculator_details"},"");else if(ce==="calculator"&&o==="details"){window.history.back();return}c(ce),window.dispatchEvent(new CustomEvent("page-activated",{detail:ce})),setTimeout(()=>{const Ie=window.visualViewport,Ne=Date.now(),W=()=>{!Ie||Date.now()-Ne>200||requestAnimationFrame(W)};W()},0)}},[o]),{progress:V,isSwiping:J}=pD(L,{onSwipeLeft:o==="calculator"?()=>H("details"):void 0,onSwipeRight:o==="details"?()=>H("calculator"):void 0},{enabled:S&&!F&&e&&!h&&!u,threshold:36,slop:10});D.useEffect(()=>{a(h||u)},[h,u,a]);const te=D.useCallback(ce=>{"date"in ce&&ce.date&&x(!1),I(de=>({...de,...ce}))},[]),q=D.useCallback(ce=>{if(!_.current){if(!ce.date){H("details"),x(!0),P(window.setTimeout(()=>{var de;return(de=document.getElementById("date"))==null?void 0:de.focus()},150));return}_.current=!0,y(!0),x(!1),o==="details"&&window.history.back(),r(ce)}},[o,H,r,P]);if(!e)return null;const oe=o==="calculator"?0:-50,Q=V*50,Z=oe+Q,ee=F?{}:{transform:`translateX(${Z}%)`,transition:J||!E?"none":"transform 0.25s ease-out",willChange:"transform"};return g.jsx("div",{className:`fixed inset-0 z-[5000] bg-slate-100 transform transition-transform duration-300 ease-in-out ${i?"translate-y-0":"translate-y-full"}`,"aria-modal":"true",role:"dialog",style:{touchAction:"pan-y"},...C,children:g.jsx("div",{ref:L,className:"relative h-full w-full overflow-hidden",style:{touchAction:"pan-y"},children:g.jsxs("div",{className:"absolute inset-0 flex w-[200%] md:w-full md:grid md:grid-cols-2",style:ee,children:[g.jsx("div",{className:`w-1/2 md:w-auto h-full relative overflow-hidden ${o==="calculator"?"z-10":"z-0"}`,"aria-hidden":!F&&o!=="calculator",children:g.jsx(PD,{formData:R,onFormChange:te,onClose:t,onSubmit:q,accounts:n,onNavigateToDetails:()=>H("details"),onMenuStateChange:p,isDesktop:F})}),g.jsx("div",{className:`w-1/2 md:w-auto h-full relative overflow-hidden ${o==="details"?"z-10":"z-0"}`,"aria-hidden":!F&&o!=="details",children:g.jsx(Bue,{formData:R,onFormChange:te,accounts:n,onClose:()=>H("calculator"),onSubmit:q,isDesktop:F,onMenuStateChange:p,dateError:v})})]})})})},Hue=({show:e})=>g.jsx("div",{role:"status","aria-live":"polite",className:`fixed flex items-center justify-center w-12 h-12 bg-green-400 text-white rounded-full shadow-lg z-30
        ${e?"opacity-100 scale-100":"opacity-0 scale-90 pointer-events-none"}`,style:{bottom:"calc(2rem + env(safe-area-inset-bottom, 0px))",right:"calc(6.5rem + env(safe-area-inset-right, 0px))",transition:"transform 0.25s cubic-bezier(0.22, 0.61, 0.36, 1), opacity 0.25s ease-in-out, transform 0.25s ease-in-out"},children:g.jsx(Ni,{className:"w-10 h-10"})}),qd=e=>{const t=e.split("-").map(Number);return new Date(t[0],t[1]-1,t[2])},p2=e=>{const t=e.getFullYear(),r=String(e.getMonth()+1).padStart(2,"0"),n=String(e.getDate()).padStart(2,"0");return`${t}-${r}-${n}`},que=({onLogout:e,currentEmail:t})=>{const[r,n]=yu("expenses_v2",[]),[a,i]=yu("recurring_expenses_v1",[]),[s]=yu("accounts_v1",QR),o=s||[],[c,u]=D.useState(!1),[d,h]=D.useState(!1),[p,v]=D.useState(!1),[x,w]=D.useState(!1),[y,_]=D.useState(!1),[S,k]=D.useState(!1),[E,T]=D.useState(!1),[N,C]=D.useState(!1),[P,j]=D.useState(!1),[R,I]=D.useState(!1),[F,L]=D.useState(!1),[H,V]=D.useState(!1),[J,te]=D.useState(!1),[q,oe]=D.useState(!1),[Q,Z]=D.useState(void 0),[ee,ce]=D.useState(void 0),[de,Te]=D.useState(void 0),[Ie,Ne]=D.useState(null),[W,z]=D.useState([]),[G,X]=D.useState(null),ie=MR(),[M,le]=D.useState([]),[ye,Ce]=D.useState(null),[ze,Ze]=D.useState(null),rt=D.useCallback(Fe=>Ze(Fe),[]),[xt,mt]=D.useState(!1),[Ee,ve]=D.useState(null),fe=D.useRef(0),pe=D.useRef(null),nt=D.useRef(new URLSearchParams(window.location.search).get("shared")==="true"),De=D.useRef(0),Oe=D.useCallback(async()=>{try{const Fe=await j1();le(Fe||[]),fe.current=(Fe||[]).length}catch{le([])}},[]);D.useEffect(()=>{const Fe=setTimeout(()=>{if(!a||a.length===0)return;const Xe=new Date;Xe.setHours(0,0,0,0);let tt=!1,pt=!1;const Dt=[...r||[]],hr=[];a.forEach(Nr=>{let Wt={...Nr},Ht=!1,or;if(Wt.lastGeneratedDate){or=qd(Wt.lastGeneratedDate);const Y=Wt.recurrenceInterval||1;switch(Wt.recurrence){case"daily":or.setDate(or.getDate()+Y);break;case"weekly":or.setDate(or.getDate()+7*Y);break;case"monthly":or.setMonth(or.getMonth()+Y);break;case"yearly":or.setFullYear(or.getFullYear()+Y);break}}else or=qd(Wt.date);let U=0,re=(r||[]).filter(Y=>Y.recurringExpenseId===Wt.id).length;for(;or<=Xe&&U<1e3;){U++;let Y=!1;if(Wt.recurrenceEndType==="date"&&Wt.recurrenceEndDate){const Pe=qd(Wt.recurrenceEndDate);or>Pe&&(Y=!0)}if(Wt.recurrenceEndType==="count"&&Wt.recurrenceCount&&re>=Wt.recurrenceCount&&(Y=!0),Y)break;const ne={...Wt,id:crypto.randomUUID(),date:p2(or),recurringExpenseId:Wt.id,frequency:"single",recurrence:void 0,recurrenceInterval:void 0,recurrenceDays:void 0,recurrenceEndType:void 0,recurrenceEndDate:void 0,recurrenceCount:void 0,monthlyRecurrenceType:void 0,lastGeneratedDate:void 0};Dt.push(ne),tt=!0,Wt.lastGeneratedDate=p2(or),Ht=!0,re++;const ae=Wt.recurrenceInterval||1,ge=new Date(or);switch(Wt.recurrence){case"daily":ge.setDate(ge.getDate()+ae);break;case"weekly":ge.setDate(ge.getDate()+7*ae);break;case"monthly":ge.setMonth(ge.getMonth()+ae);break;case"yearly":ge.setFullYear(ge.getFullYear()+ae);break}or=ge}let K=!1;if(Wt.recurrenceEndType==="date"&&Wt.recurrenceEndDate){const Y=qd(Wt.recurrenceEndDate);or>Y&&(K=!0)}Wt.recurrenceEndType==="count"&&Wt.recurrenceCount&&re>=Wt.recurrenceCount&&(K=!0),K?pt=!0:(Ht&&(pt=!0),hr.push(Wt))}),tt&&n(Dt),pt&&i(hr)},1e3);return()=>clearTimeout(Fe)},[a,r,n,i]);const Qe=(Fe,Xe)=>{if(!Fe)return{};let tt=Fe.category||"Altro";da[tt]||(tt="Altro");let pt=Fe.amount;typeof pt=="string"&&(pt=parseFloat(pt.replace(",","."))),(typeof pt!="number"||isNaN(pt))&&(pt=0);const Dt=s||[];return{description:Fe.description||"",amount:pt,category:tt,date:Fe.date||new Date().toISOString().split("T")[0],tags:Array.isArray(Fe.tags)?Fe.tags:[],receipts:Array.isArray(Fe.receipts)?Fe.receipts:Xe?[Xe]:[],accountId:Fe.accountId||(Dt.length>0?Dt[0].id:"")}},kt=async Fe=>{try{rt({message:"Elaborazione immagine condivisa...",type:"info"});const{base64:Xe,mimeType:tt}=await ql(Fe),pt={id:crypto.randomUUID(),base64Image:Xe,mimeType:tt,timestamp:Date.now()};ie?X(pt):(await pd(pt),Oe(),rt({message:"Salvata in coda (offline).",type:"info"}))}catch(Xe){console.error(Xe),rt({message:"Errore file condiviso.",type:"error"})}},Re=async Fe=>{try{if(rt({message:"Elaborazione file...",type:"info"}),Fe.type==="application/json"||Fe.name.toLowerCase().endsWith(".json"))try{const hr=await Fe.text(),Nr=JSON.parse(hr);if(Array.isArray(Nr)){const Wt=Nr.map(Ht=>{var or;return{id:Ht.id||crypto.randomUUID(),description:Ht.description||"",amount:Number(Ht.amount)||0,date:Ht.date||new Date().toISOString().split("T")[0],category:Ht.category||"Altro",subcategory:Ht.subcategory,accountId:Ht.accountId||((or=o[0])==null?void 0:or.id)||"cash",tags:Ht.tags||[],receipts:Ht.receipts||[],time:Ht.time,frequency:Ht.frequency,recurrence:Ht.recurrence,recurrenceInterval:Ht.recurrenceInterval,recurrenceDays:Ht.recurrenceDays,recurrenceEndType:Ht.recurrenceEndType,recurrenceEndDate:Ht.recurrenceEndDate,recurrenceCount:Ht.recurrenceCount,monthlyRecurrenceType:Ht.monthlyRecurrenceType,recurringExpenseId:Ht.recurringExpenseId,lastGeneratedDate:Ht.lastGeneratedDate}});n(Ht=>[...Ht,...Wt]),rt({message:`${Wt.length} spese importate da JSON.`,type:"success"});return}}catch{rt({message:"File JSON non valido.",type:"error"});return}const{processFileToImage:Xe}=await xu(async()=>{const{processFileToImage:hr}=await Promise.resolve().then(()=>DX);return{processFileToImage:hr}},void 0),{base64:tt,mimeType:pt}=await Xe(Fe),Dt={id:crypto.randomUUID(),base64Image:tt,mimeType:pt,timestamp:Date.now()};ie?X(Dt):(await pd(Dt),Oe(),rt({message:"File salvato in coda (offline).",type:"info"}))}catch{rt({message:"Errore importazione file.",type:"error"})}},at=async Fe=>{try{window.history.replaceState({modal:"home"},"")}catch{}v(!1),sessionStorage.setItem("preventAutoLock","true");try{const Xe=await up(Fe),{base64:tt,mimeType:pt}=await ql(Xe),Dt={id:crypto.randomUUID(),base64Image:tt,mimeType:pt,timestamp:Date.now()};ie?X(Dt):(await pd(Dt),Oe())}catch{}finally{setTimeout(()=>sessionStorage.removeItem("preventAutoLock"),2e3)}},bt=async Fe=>{if(!ie){rt({message:"Connettiti a internet per analizzare.",type:"error"});return}Ce(Fe.id),T(!0);try{const{parseExpensesFromImage:Xe}=await xu(async()=>{const{parseExpensesFromImage:pt}=await Promise.resolve().then(()=>rue);return{parseExpensesFromImage:pt}},void 0),tt=await Xe(Fe.base64Image,Fe.mimeType);(tt==null?void 0:tt.length)===1?(Te(Qe(tt[0],Fe.base64Image)),window.history.replaceState({modal:"form"},""),u(!0)):(tt==null?void 0:tt.length)>1?(z(tt.map(pt=>Qe(pt,void 0))),window.history.replaceState({modal:"multiple"},""),k(!0)):rt({message:"Nessuna spesa trovata.",type:"info"}),await LE(Fe.id),Oe()}catch{rt({message:"Errore analisi immagine. Riprova.",type:"error"})}finally{T(!1),Ce(null)}},Yt=Fe=>{try{window.history.replaceState({modal:"form"},"")}catch{}w(!1);const Xe=Qe(Fe);Te(Xe),u(!0)};D.useEffect(()=>{if(!t||!ie)return;const Fe=setTimeout(()=>{const tt=Yf()[t.toLowerCase()];tt&&(console.log(" Backup Cloud per:",t),RX(t,{expenses:r,recurringExpenses:a,accounts:s},tt.pinHash,tt.pinSalt).then(pt=>{pt&&console.log(" Backup completato")}).catch(pt=>console.warn("Cloud error",pt)))},5e3);return()=>clearTimeout(Fe)},[r,a,s,t,ie]),D.useEffect(()=>{nt.current||Oe()},[Oe]),D.useEffect(()=>{(async()=>{if(new URLSearchParams(window.location.search).get("shared")==="true"||nt.current){try{window.history.replaceState({modal:"home"},"",window.location.pathname)}catch{try{window.history.replaceState({modal:"home"},"")}catch{}}try{const tt=await j1(),pt=Array.isArray(tt)?tt:[];if(pt.length>0){pt.sort((Nr,Wt)=>(Wt.timestamp||0)-(Nr.timestamp||0));const Dt=pt[0];pe.current=Dt.id;const hr={...Dt,_isShared:!0};X(hr),le(pt.filter(Nr=>Nr.id!==Dt.id))}else le([])}catch(tt){console.error("Error checking shared file",tt)}}})()},[]);const mn=D.useRef(!1);D.useEffect(()=>{mn.current||(mn.current=!0)},[]),D.useEffect(()=>{var Xe;(Xe=window.history.state)!=null&&Xe.modal||(window.history.replaceState({modal:"exit_guard"},""),window.history.pushState({modal:"home"},"")),new URLSearchParams(window.location.search).get("install")==="true"&&setTimeout(()=>te(!0),500)},[]),D.useEffect(()=>{const Fe=Xe=>{Xe.preventDefault(),ve(Xe)};return window.addEventListener("beforeinstallprompt",Fe),()=>window.removeEventListener("beforeinstallprompt",Fe)},[]);const Mn=()=>{Ee?(Ee.prompt(),Ee.userChoice.then(Fe=>{ve(null)})):te(!0)},va=()=>{u(!1),h(!1),v(!1),w(!1),k(!1),V(!1),I(!1),oe(!1),C(!1),X(null)},ga=()=>{try{window.history.replaceState({modal:"home"},"",window.location.pathname)}catch{}window.dispatchEvent(new PopStateEvent("popstate",{state:{modal:"home"}}))},Vr=()=>{var Fe,Xe,tt;((Fe=window.history.state)==null?void 0:Fe.modal)==="history"&&(I(!1),L(!1)),((Xe=window.history.state)==null?void 0:Xe.modal)==="recurring"&&(C(!1),j(!1)),(tt=window.history.state)!=null&&tt.modal&&window.history.state.modal!=="home"&&window.history.state.modal!=="exit_guard"?window.history.back():ga()};D.useEffect(()=>{const Fe=Xe=>{var pt;const tt=(pt=Xe.state)==null?void 0:pt.modal;if(tt==="exit_guard"){const Dt=Date.now();if(Dt-De.current<2e3){window.history.back();return}else De.current=Dt,rt({message:"Premi di nuovo indietro per uscire",type:"info"}),window.history.pushState({modal:"home"},""),va();return}tt!=="form"&&u(!1),tt!=="voice"&&w(!1),tt!=="source"&&v(!1),tt!=="multiple"&&k(!1),tt!=="qr"&&V(!1),tt!=="calculator"&&tt!=="calculator_details"&&h(!1),!tt||tt==="home"?(I(!1),L(!1),oe(!1),C(!1),j(!1),X(null)):tt==="history"?(I(!0),F&&L(!1),C(!1),j(!1)):tt==="recurring"&&(C(!0),P&&j(!1),I(!1))};return window.addEventListener("popstate",Fe),()=>window.removeEventListener("popstate",Fe)},[rt,F,P]);const xa=Fe=>{let Xe={...Fe};const tt=p2(new Date);if(Xe.frequency==="recurring"&&Xe.recurrenceEndType==="count"&&Xe.recurrenceCount===1&&Xe.date<=tt&&(Xe.frequency="single",Xe.recurrence=void 0,Xe.recurrenceInterval=void 0,Xe.recurrenceDays=void 0,Xe.recurrenceEndType=void 0,Xe.recurrenceEndDate=void 0,Xe.recurrenceCount=void 0,Xe.monthlyRecurrenceType=void 0),"id"in Xe){const pt=Xe;n(Dt=>Dt.map(hr=>hr.id===pt.id?pt:hr)),pt.frequency==="single"?i(Dt=>Dt.filter(hr=>hr.id!==pt.id)):i(Dt=>Dt.map(hr=>hr.id===pt.id?pt:hr))}else{const pt={...Xe,id:crypto.randomUUID()};Xe.frequency==="recurring"?i(Dt=>[pt,...Dt]):n(Dt=>[pt,...Dt])}mt(!0),setTimeout(()=>mt(!1),2e3),c?window.history.back():ga()},ya=Fe=>{Ne(Fe),_(!0)},wa=()=>{n(Fe=>Fe.filter(Xe=>Xe.id!==Ie)),Ne(null),_(!1),rt({message:"Spesa eliminata.",type:"info"})},ba=async()=>{G&&(G.id===pe.current&&(pe.current=null),bt(G),X(null))},Me=async()=>{if(!G)return;let Fe=!!G._isShared||pe.current===G.id;Fe||(Fe=(await j1()).some(tt=>tt.id===G.id)),Fe||await pd(G),G.id===pe.current&&(pe.current=null),Oe(),X(null)},et=R&&!F?{bottom:"calc(90px + env(safe-area-inset-bottom, 0px))"}:void 0;return g.jsxs("div",{className:"h-full w-full bg-slate-100 flex flex-col font-sans",style:{touchAction:"pan-y"},children:[g.jsx("div",{className:"flex-shrink-0 z-20",children:g.jsx(VX,{pendingSyncs:M.length,isOnline:ie,onInstallClick:Mn,installPromptEvent:Ee,onLogout:e,onShowQr:()=>{window.history.pushState({modal:"qr"},""),V(!0)}})}),g.jsx("main",{className:"flex-grow bg-slate-100",children:g.jsxs("div",{className:"w-full h-full overflow-y-auto space-y-6",style:{touchAction:"pan-y"},children:[g.jsx($ce,{expenses:r||[],recurringExpenses:a||[],onNavigateToRecurring:()=>{window.history.pushState({modal:"recurring"},""),C(!0)},onNavigateToHistory:()=>{window.history.pushState({modal:"history"},""),L(!1),I(!0)},onReceiveSharedFile:kt,onImportFile:Re}),g.jsx(oue,{images:M,onAnalyze:bt,onDelete:async Fe=>{await LE(Fe),Oe()},isOnline:ie,syncingImageId:ye})]})}),!d&&!q&&g.jsx(Zce,{onAddManually:()=>{window.history.pushState({modal:"calculator"},""),h(!0)},onAddFromImage:()=>{window.history.pushState({modal:"source"},""),v(!0)},onAddFromVoice:()=>{window.history.pushState({modal:"voice"},""),w(!0)},style:et}),g.jsx(Hue,{show:xt}),g.jsx(Wue,{isOpen:d,onClose:Vr,onSubmit:xa,accounts:o,expenses:r,onEditExpense:Fe=>{Z(Fe),window.history.pushState({modal:"form"},""),u(!0)},onDeleteExpense:Fe=>{Ne(Fe),_(!0)},onMenuStateChange:()=>{}}),g.jsx(Gce,{isOpen:c,onClose:Vr,onSubmit:xa,initialData:Q||ee,prefilledData:de,accounts:o,isForRecurringTemplate:!!ee}),p&&g.jsx("div",{className:"fixed inset-0 z-[5200] flex justify-center items-center p-4 bg-slate-900/60 backdrop-blur-sm",onClick:Vr,children:g.jsx("div",{className:"bg-slate-50 rounded-lg shadow-xl w-full max-w-lg",onClick:Fe=>Fe.stopPropagation(),children:g.jsxs("div",{className:"p-6 grid grid-cols-1 md:grid-cols-2 gap-4",children:[g.jsx(zN,{icon:g.jsx(q_,{className:"w-8 h-8"}),title:"Scatta Foto",description:"Usa la fotocamera.",onClick:()=>at("camera")}),g.jsx(zN,{icon:g.jsx(Iue,{className:"w-8 h-8"}),title:"Galleria",description:"Carica da file.",onClick:()=>at("gallery")})]})})}),g.jsx(nue,{isOpen:x,onClose:Vr,onParsed:Yt}),g.jsx(uc,{isOpen:y,onClose:()=>_(!1),onConfirm:wa,title:"Conferma Eliminazione",message:"Azione irreversibile.",variant:"danger"}),g.jsx(uc,{isOpen:!!G,onClose:Me,onConfirm:ba,title:"Analizza Immagine",message:"Vuoi analizzare subito questa immagine?",confirmButtonText:"S, analizza",cancelButtonText:"No, in coda"}),g.jsx(sue,{isOpen:S,onClose:Vr,expenses:W,accounts:o,onConfirm:Fe=>{Fe.forEach(xa),ga()}}),R&&g.jsx(hue,{expenses:r,accounts:o,onClose:Vr,onCloseStart:()=>L(!0),onEditExpense:Fe=>{Z(Fe),window.history.pushState({modal:"form"},""),u(!0)},onDeleteExpense:ya,onDeleteExpenses:Fe=>{n(Xe=>(Xe||[]).filter(tt=>!Fe.includes(tt.id)))},isEditingOrDeleting:c||y,isOverlayed:c||y,onDateModalStateChange:()=>{},onFilterPanelOpenStateChange:oe}),(N||P)&&g.jsx(xue,{recurringExpenses:a,expenses:r,accounts:o,onClose:Vr,onCloseStart:()=>j(!0),onEdit:Fe=>{ce(Fe),window.history.pushState({modal:"form"},""),u(!0)},onDelete:Fe=>i(Xe=>(Xe||[]).filter(tt=>tt.id!==Fe)),onDeleteRecurringExpenses:Fe=>i(Xe=>(Xe||[]).filter(tt=>!Fe.includes(tt.id)))}),g.jsx(Cue,{isOpen:H,onClose:Vr}),g.jsx(Pue,{isOpen:J,onClose:()=>te(!1)}),ze&&g.jsx(cue,{message:ze.message,type:ze.type,onClose:()=>Ze(null)}),E&&g.jsx("div",{className:"fixed inset-0 bg-white/80 z-[100] flex items-center justify-center",children:g.jsx(fc,{className:"w-12 h-12 text-indigo-600"})})]})},Vue=e=>g.jsx("img",{src:"/gestore/logo.png",alt:"Gestore Spese Logo",...e}),Xue=()=>{me.useEffect(()=>{var t;const e=()=>{var n;const r=(((n=window.visualViewport)==null?void 0:n.height)??window.innerHeight)*.01;document.documentElement.style.setProperty("--vh",`${r}px`)};return e(),addEventListener("resize",e),addEventListener("orientationchange",e),(t=window.visualViewport)==null||t.addEventListener("resize",e),()=>{var r;removeEventListener("resize",e),removeEventListener("orientationchange",e),(r=window.visualViewport)==null||r.removeEventListener("resize",e)}},[])},Gue=()=>{const[e,t]=me.useState(!1);return me.useEffect(()=>{let r=typeof window.__FORCE_STUDIO__=="boolean"&&window.__FORCE_STUDIO__||new URLSearchParams(location.search).has("studio"),n=!1;try{n=window.self!==window.top}catch{n=!0}t(r||n)},[]),e},Kue=({children:e})=>g.jsx("div",{style:{background:"#fff",padding:24,borderRadius:16,boxShadow:"0 12px 28px rgba(0,0,0,0.12)",position:"relative",overflow:"visible",opacity:1},children:e}),Yue=()=>g.jsxs("div",{style:{textAlign:"center"},children:[g.jsx("div",{style:{margin:"0 auto 12px",width:120,height:120},children:g.jsx(Vue,{style:{width:"100%",height:"100%"},"aria-label":"Logo Gestore Spese"})}),g.jsx("h1",{style:{fontSize:28,fontWeight:800,color:"#0f172a",margin:0},children:"Gestore Spese"})]}),Gp=({children:e})=>{Xue();const t=Gue(),r={minHeight:"calc(var(--vh, 1vh) * 100)",height:"100dvh",background:"#f1f5f9",fontFamily:"system-ui, -apple-system, Segoe UI, Roboto, Ubuntu, Cantarell, Noto Sans, sans-serif",WebkitTapHighlightColor:"transparent",display:"flex",flexDirection:"column",padding:16,overflow:"auto"};return t&&(r.position="fixed",r.inset=0),g.jsx("div",{style:r,children:g.jsx("div",{style:{display:"flex",flex:1,alignItems:"center",justifyContent:"center",overflow:"visible",position:"relative"},children:g.jsxs("div",{style:{width:"100%",maxWidth:480},children:[g.jsx("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",marginBottom:32},children:g.jsx(Yue,{})}),g.jsx(Kue,{children:e})]})})})},DD=e=>g.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",...e,children:[g.jsx("path",{d:"M8.10008 21.221C6.71021 19.2375 5.89258 16.8243 5.89258 14.2187C5.89258 10.8443 8.6265 8.10938 11.9989 8.10938C15.3712 8.10938 18.1051 10.8443 18.1051 14.2187",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}),g.jsx("path",{d:"M18.4359 20.3118C18.3259 20.3179 18.218 20.3281 18.107 20.3281C14.7347 20.3281 12.0007 17.5931 12.0007 14.2188",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}),g.jsx("path",{d:"M13.2694 21.9999C10.675 20.382 8.94705 17.5024 8.94705 14.2187C8.94705 12.5315 10.3145 11.164 12.0007 11.164C13.6869 11.164 15.0543 12.5315 15.0543 14.2187C15.0543 15.9059 16.4218 17.2733 18.108 17.2733C19.7942 17.2733 21.1616 15.9059 21.1616 14.2187C21.1616 9.1571 17.0602 5.05469 12.0017 5.05469C6.94319 5.05469 2.8418 9.1571 2.8418 14.2187C2.8418 15.3469 2.96806 16.4455 3.20021 17.5045",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}),g.jsx("path",{d:"M20.5257 5.86313C18.4435 3.4978 15.399 2 12.0002 2C8.60136 2 5.55687 3.4978 3.47461 5.86313",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})]}),jD=({pin:e,onPinChange:t,pinLength:r=4,onBiometric:n,showBiometric:a})=>{const i=u=>{e.length<r&&t(e+u)},s=()=>{e.length>0&&t(e.slice(0,-1))},o=()=>g.jsx("div",{className:"flex justify-center space-x-4 mb-6",children:Array.from({length:r}).map((u,d)=>g.jsx("div",{className:`w-4 h-4 rounded-full border-2 transition-colors duration-200 ${d<e.length?"bg-indigo-600 border-indigo-600":"bg-white border-slate-300"}`},d))}),c=()=>{const u=["1","2","3","4","5","6","7","8","9","biometric","0","backspace"];return g.jsx("div",{className:"grid grid-cols-3 gap-4",children:u.map((d,h)=>d==="biometric"?a&&n?g.jsx("button",{type:"button",onClick:n,className:"w-16 h-16 mx-auto rounded-full text-white bg-indigo-600 active:bg-indigo-700 transition-colors flex justify-center items-center shadow-md focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2","aria-label":"Usa impronta digitale",children:g.jsx(DD,{className:"w-8 h-8"})},h):g.jsx("div",{},h):d==="backspace"?g.jsx("button",{type:"button",onClick:s,className:"w-16 h-16 mx-auto rounded-full text-slate-700 active:bg-slate-200 transition-colors flex justify-center items-center text-2xl font-semibold focus:outline-none focus:ring-2 focus:ring-indigo-500 border-2 border-slate-200","aria-label":"Cancella",children:g.jsx(ND,{className:"w-7 h-7"})},h):g.jsx("button",{type:"button",onClick:()=>i(d),className:"w-16 h-16 mx-auto rounded-full text-slate-700 active:bg-slate-200 transition-colors text-2xl font-semibold focus:outline-none focus:ring-2 focus:ring-indigo-500 border-2 border-slate-200",children:d},h))})};return g.jsxs("div",{children:[g.jsx(o,{}),g.jsx(c,{})]})},Zue=e=>/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(e);function Que({onSubmit:e}){const t=me.useRef(null),r=me.useRef(null),[n,a]=me.useState(""),i=o=>{var u;o.preventDefault();const c=(((u=t.current)==null?void 0:u.textContent)||"").trim();if(!Zue(c)){a("Inserisci unemail valida");return}r.current&&(r.current.value=c),a(""),e==null||e(c),console.log("LOGIN email:",c)},s=o=>{var u;o.preventDefault();const c=((u=o.clipboardData)==null?void 0:u.getData("text"))||"";document.execCommand("insertText",!1,c)};return g.jsxs("form",{onSubmit:i,autoComplete:"off","data-lpignore":"true","data-form-type":"other",style:{overflow:"visible"},children:[g.jsx("input",{type:"text",autoComplete:"off",tabIndex:-1,readOnly:!0,"aria-hidden":"true",style:{position:"absolute",left:-9999,top:-9999,height:0,width:0,opacity:0}}),g.jsx("input",{ref:r,type:"hidden",name:"email"}),g.jsx("label",{htmlFor:"ed-email",className:"block text-sm font-medium text-slate-700 mb-2",children:"Email"}),g.jsx("div",{id:"ed-email",ref:t,role:"textbox",contentEditable:!0,suppressContentEditableWarning:!0,inputMode:"email","aria-label":"Email",spellCheck:!1,autoCapitalize:"off",autoCorrect:"off",onPaste:s,onKeyDown:o=>{var c;o.key==="Enter"&&(o.preventDefault(),(c=o.currentTarget.closest("form"))==null||c.requestSubmit())},style:{display:"block",width:"100%",minHeight:44,fontSize:16,padding:"10px 12px",border:"1px solid #cbd5e1",borderRadius:10,outline:"none",background:"#fff",color:"#0f172a",WebkitUserModify:"read-write-plaintext-only"},"data-placeholder":"nome@dominio.it",onFocus:o=>{o.currentTarget.scrollIntoView({block:"center",behavior:"smooth"})}}),g.jsx("style",{children:`
        #ed-email:empty:before {
          content: attr(data-placeholder);
          color: #94a3b8; /* slate-400 */
        }
      `}),n&&g.jsx("p",{style:{color:"#dc2626",fontSize:13,marginTop:8},children:n}),g.jsx("button",{type:"submit",style:{marginTop:16,width:"100%",minHeight:44,borderRadius:10,border:"1px solid #4f46e5",background:"#4f46e5",color:"#fff",fontWeight:600},children:"Continua"})]})}const RD="bio.enabled",X_="bio.credId",r6="bio.userId",n6="bio.optOut",G_="bio.snooze",MD=location.hostname,a6=e=>{const t=String.fromCharCode(...new Uint8Array(e));return btoa(t).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/g,"")},LD=e=>{const t=atob(e.replace(/-/g,"+").replace(/_/g,"/")),r=new Uint8Array(t.length);for(let n=0;n<t.length;n++)r[n]=t.charCodeAt(n);return r.buffer};function Jue(){try{return sessionStorage.getItem(G_)==="1"}catch{return!1}}function Zw(){try{sessionStorage.setItem(G_,"1")}catch{}}function K_(){try{sessionStorage.removeItem(G_)}catch{}}async function l0(){var e,t;if(!("PublicKeyCredential"in window))return!1;try{return!!await((t=(e=window.PublicKeyCredential).isUserVerifyingPlatformAuthenticatorAvailable)==null?void 0:t.call(e))}catch{return!1}}function BD(){return localStorage.getItem(RD)==="1"&&!!localStorage.getItem(X_)}function Y_(e){e?localStorage.setItem(n6,"1"):localStorage.removeItem(n6)}async function Z_(e="Utente"){if(!await l0())throw new Error("Biometria non disponibile su questo dispositivo");let t=localStorage.getItem(r6);if(!t){const o=crypto.getRandomValues(new Uint8Array(32));t=a6(o.buffer),localStorage.setItem(r6,t)}const r=LD(t),a={challenge:crypto.getRandomValues(new Uint8Array(32)),rp:{name:"Gestore Spese",id:MD},user:{id:new Uint8Array(r),name:"local@gestore",displayName:e},pubKeyCredParams:[{type:"public-key",alg:-7},{type:"public-key",alg:-257}],timeout:6e4,attestation:"none",authenticatorSelection:{authenticatorAttachment:"platform",residentKey:"preferred",userVerification:"required"}},i=await navigator.credentials.create({publicKey:a});if(!i)throw new Error("Creazione passkey annullata");const s=a6(i.rawId);return localStorage.setItem(X_,s),localStorage.setItem(RD,"1"),K_(),Y_(!1),!0}async function Qw(e="Sblocca Gestore Spese"){var i,s;if(!await l0())throw new Error("Biometria non disponibile");const t=localStorage.getItem(X_);if(!t)throw new Error("Biometria non configurata");try{(s=(i=document.activeElement)==null?void 0:i.blur)==null||s.call(i)}catch{}const r=LD(t),a={challenge:crypto.getRandomValues(new Uint8Array(32)),rpId:MD,timeout:6e4,userVerification:"required",allowCredentials:[{id:new Uint8Array(r),type:"public-key"}]};try{if(!await navigator.credentials.get({publicKey:a}))throw Zw(),new DOMException("User cancelled","NotAllowedError");return K_(),!0}catch(o){const c=String((o==null?void 0:o.name)||""),u=String((o==null?void 0:o.message)||"");throw(c==="NotAllowedError"||c==="AbortError"||/timeout/i.test(u))&&Zw(),o}}const m2=Object.freeze(Object.defineProperty({__proto__:null,clearBiometricSnooze:K_,isBiometricSnoozed:Jue,isBiometricsAvailable:l0,isBiometricsEnabled:BD,registerBiometric:Z_,setBiometricSnooze:Zw,setBiometricsOptOut:Y_,unlockWithBiometric:Qw},Symbol.toStringTag,{value:"Module"})),$D="bio.autoprompt.lock",efe=()=>{try{return sessionStorage.getItem($D)==="1"}catch{return!1}},tfe=()=>{try{sessionStorage.setItem($D,"1")}catch{}},Vd="bio.last_email",rfe=({onLoginSuccess:e,onGoToRegister:t,onGoToForgotPassword:r,onGoToForgotEmail:n})=>{const[a,i]=yu("last_active_user_email",null),[s,o]=D.useState(""),[c,u]=D.useState(null),[d,h]=D.useState(!1),[p,v]=D.useState(!1),[x,w]=D.useState(!1),[y,_]=D.useState(!1),[S,k]=D.useState(!1),E=D.useRef(!1),[T,N]=D.useState(null);D.useEffect(()=>{if(a){N(a);return}try{if(typeof window>"u")return;const H=window.localStorage.getItem(Vd);N(!H||H==="null"||H==="undefined"?null:H)}catch{N(null)}},[a]),D.useEffect(()=>{let H=!0;return(async()=>{const V=await l0(),J=BD();let te=!1;V&&(J||a)&&(te=!0),H&&(v(V),w(J),_(te))})(),()=>{H=!1}},[a]);const C=a??T??null;D.useEffect(()=>{C&&(!p||!x||E.current||efe()||(E.current=!0,tfe(),(async()=>{const{isBiometricSnoozed:H,setBiometricSnooze:V,clearBiometricSnooze:J}=await xu(async()=>{const{isBiometricSnoozed:te,setBiometricSnooze:q,clearBiometricSnooze:oe}=await Promise.resolve().then(()=>m2);return{isBiometricSnoozed:te,setBiometricSnooze:q,clearBiometricSnooze:oe}},void 0);if(!H())try{k(!0);const te=await Qw("Sblocca con impronta / FaceID");if(k(!1),te){J();const q=C.toLowerCase();try{typeof window<"u"&&window.localStorage.setItem(Vd,q)}catch{}a||i(q),e("biometric-local",q)}}catch(te){k(!1);const q=(te==null?void 0:te.name)||"",oe=String((te==null?void 0:te.message)||"");(q==="NotAllowedError"||q==="AbortError"||/timeout/i.test(oe))&&V()}})()))},[C,a,p,x,e,i]),D.useEffect(()=>{s.length===4&&a&&j()},[s,a]);const P=async H=>{if(H){const V=H.toLowerCase(),J=Yf();if(J[V]){i(V),u(null),N(V);return}h(!0);try{const te=await MX(V);if(te){localStorage.setItem("expenses_v2",JSON.stringify(te.data.expenses)),localStorage.setItem("recurring_expenses_v1",JSON.stringify(te.data.recurringExpenses)),localStorage.setItem("accounts_v1",JSON.stringify(te.data.accounts));const q={email:V,pinHash:te.pinHash,pinSalt:te.pinSalt,createdAt:new Date().toISOString()};J[V]=q,Lb(J),i(V),u(null),N(V)}else u("Nessun account trovato (locale o cloud).")}catch{u("Errore di connessione cloud.")}finally{h(!1)}}},j=async()=>{if(d||!a)return;h(!0),u(null);const H=await yI(a,s);H.success&&H.token?e(H.token,a):(u(H.message),setTimeout(()=>{o(""),u(null),h(!1)},1500))},R=async()=>{const H=a??T;if(H)try{k(!0);const{clearBiometricSnooze:V,setBiometricSnooze:J}=await xu(async()=>{const{clearBiometricSnooze:q,setBiometricSnooze:oe}=await Promise.resolve().then(()=>m2);return{clearBiometricSnooze:q,setBiometricSnooze:oe}},void 0);V();const te=await Qw("Sblocca con impronta / FaceID");if(k(!1),te){const q=H.toLowerCase();try{typeof window<"u"&&window.localStorage.setItem(Vd,q)}catch{}a||i(q),N(q),e("biometric-local",q)}}catch(V){k(!1),console.error("Login biometrico fallito",V);const J=(V==null?void 0:V.name)||"",te=String((V==null?void 0:V.message)||"");if(J==="NotAllowedError"||J==="AbortError"||/timeout/i.test(te)){const{setBiometricSnooze:q}=await xu(async()=>{const{setBiometricSnooze:oe}=await Promise.resolve().then(()=>m2);return{setBiometricSnooze:oe}},void 0);q()}}},I=async()=>{const H=a??T;if(H)try{k(!0),await Z_("Profilo locale"),w(!0),k(!1);const V=H.toLowerCase();try{typeof window<"u"&&window.localStorage.setItem(Vd,V)}catch{}a||i(V),N(V),await R()}catch{k(!1)}},F=()=>{i(null),o(""),u(null),E.current=!1},L=()=>a?g.jsxs("div",{className:"text-center",children:[g.jsx("p",{className:"text-sm text-slate-600 mb-2 truncate",title:a,children:a}),g.jsx("h2",{className:"text-xl font-bold text-slate-800 mb-2",children:"Inserisci il PIN di 4 cifre"}),g.jsx("div",{className:`flex items-center justify-center transition-all duration-200 overflow-hidden ${c||d?"h-6 mb-2":"h-0"}`,children:d?g.jsx(fc,{className:"w-4 h-4 text-indigo-600"}):c?g.jsx("p",{className:"text-sm text-red-500",children:c}):null}),g.jsx(jD,{pin:s,onPinChange:o,showBiometric:y,onBiometric:x?R:I}),g.jsx("div",{className:"mt-6 flex flex-col items-center justify-center gap-y-3",children:g.jsxs("div",{className:"flex w-full items-center justify-between px-1",children:[g.jsx("button",{onClick:F,className:"text-sm font-semibold text-indigo-600 hover:text-indigo-500 transition-colors",children:"Cambia Utente"}),g.jsx("button",{onClick:r,className:"text-sm font-semibold text-indigo-600 hover:text-indigo-500 transition-colors",children:"PIN Dimenticato?"})]})})]}):g.jsxs("div",{className:"text-center",children:[g.jsx("h2",{className:"text-xl font-bold text-slate-800 mb-2",children:"Bentornato!"}),g.jsx("p",{className:"text-slate-500 mb-6",children:"Inserisci la tua email per continuare."}),g.jsx(Que,{onSubmit:P}),d&&g.jsx("div",{className:"mt-4 flex justify-center",children:g.jsx(fc,{className:"w-6 h-6 text-indigo-600"})}),c&&g.jsx("p",{className:"mt-4 text-sm text-red-500 bg-red-50 p-2 rounded",children:c}),p&&x&&T&&!d&&g.jsx("div",{className:"mt-6",children:g.jsxs("button",{type:"button",onClick:R,disabled:S,className:"flex items-center justify-center w-full gap-2 px-4 py-3 text-sm font-semibold text-indigo-700 bg-indigo-50 hover:bg-indigo-100 rounded-lg transition-colors disabled:opacity-50 shadow-sm border border-indigo-100",children:[g.jsx(DD,{className:"w-5 h-5"}),S?"Accesso in corso...":"Accedi con impronta"]})}),g.jsxs("div",{className:"mt-4 space-y-3",children:[g.jsx("a",{href:"https://t.me/mailsendreset_bot?start=recover",target:"_blank",rel:"noopener noreferrer",className:"inline-block text-sm font-semibold text-indigo-600 hover:text-indigo-500",children:"Email dimenticata?"}),g.jsxs("p",{className:"text-sm text-slate-500",children:["Non hai un account?"," ",g.jsx("button",{onClick:t,className:"font-semibold text-indigo-600 hover:text-indigo-500",children:"Registrati"})]})]})]});return g.jsx(Gp,{children:L()})},Q_=e=>g.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...e,children:g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M21.75 6.75v10.5a2.25 2.25 0 0 1-2.25 2.25h-15a2.25 2.25 0 0 1-2.25-2.25V6.75m19.5 0A2.25 2.25 0 0 0 19.5 4.5h-15a2.25 2.25 0 0 0-2.25 2.25m19.5 0v.243a2.25 2.25 0 0 1-1.07 1.916l-7.5 4.615a2.25 2.25 0 0 1-2.36 0L3.32 8.91a2.25 2.25 0 0 1-1.07-1.916V6.75"})}),nfe="bio.snooze",afe=()=>{try{sessionStorage.removeItem(nfe)}catch{}},ife=e=>g.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",...e,children:g.jsx("path",{d:"M11.944 0A12 12 0 0 0 0 12a12 12 0 0 0 12 12 12 12 0 0 0 12-12A12 12 0 0 0 11.944 0zm4.963 8.219-1.57 7.407c-.117.537-.442.67-.896.417l-2.48-1.828-1.197 1.152c-.132.133-.243.244-.496.244l.176-2.525 4.6-4.157c.2-.178-.043-.277-.31-.098l-5.685 3.58-2.45-.765c-.533-.166-.543-.533.112-.789l9.573-3.689c.444-.166.833.1.574.812z"})}),sfe=({onSetupSuccess:e,onGoToLogin:t})=>{const[r,n]=D.useState("email"),[a,i]=D.useState(""),[s,o]=D.useState(""),[c,u]=D.useState(""),[d,h]=D.useState(null),[p,v]=D.useState(!1),[x,w]=D.useState(null),[y,_]=D.useState(!1),[S,k]=D.useState(!1),[E,T]=D.useState(!1),N=()=>{if(!a)return"#";try{return`https://t.me/mailsendreset_bot?start=reg_${btoa(a).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}`}catch{return"#"}},C=async I=>{if(I.preventDefault(),h(null),!a.trim()||!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(a)){h("Inserisci un indirizzo email valido.");return}v(!0);try{if(await jX(a.toLowerCase())){h("Email gi registrata. Vai su 'Accedi' per recuperare i dati."),v(!1);return}}catch(F){console.error(F)}v(!1),!S&&!E?T(!0):n("pin_setup")},P=async()=>{n("processing"),v(!0),h(null);const I=a.toLowerCase(),F=await $X(I,s);if(!F.success){h(F.message),v(!1),setTimeout(()=>{o(""),u(""),h(null),n("email")},2e3);return}const L=await yI(I,s);L.success&&L.token?e(L.token,I):(v(!1),h("Login automatico fallito. Vai alla pagina di login."),setTimeout(()=>t(),2e3))};D.useEffect(()=>{r==="pin_setup"&&s.length===4&&n("pin_confirm")},[s,r]),D.useEffect(()=>{(async()=>{if(r==="pin_confirm"&&c.length===4)if(s===c){h(null);const I=await l0();w(I),I?n("bio_offer"):await P()}else h("I PIN non corrispondono. Riprova."),setTimeout(()=>{o(""),u(""),h(null),n("pin_setup")},1500)})()},[c,s,r]);const j="block w-full rounded-md border border-slate-300 bg-white py-2.5 pl-10 pr-3 text-slate-900 placeholder:text-slate-400 focus:outline-none focus:border-indigo-500 focus:ring-1 focus:ring-indigo-500 sm:text-sm",R=()=>{if(r==="processing"||p)return g.jsxs("div",{className:"text-center min-h-[300px] flex flex-col justify-center items-center",children:[g.jsx(fc,{className:"w-12 h-12 text-indigo-600 mx-auto"}),g.jsx("p",{className:"mt-4 text-slate-500",children:r==="processing"?"Creazione account...":"Verifica email..."})]});switch(r){case"email":return g.jsxs("div",{className:"text-center",children:[g.jsx("h2",{className:"text-xl font-bold text-slate-800 mb-2",children:"Crea un Account"}),g.jsx("p",{className:`text-slate-500 mb-6 h-10 flex items-center justify-center ${d?"text-red-500 text-sm":""}`,children:d||"Inizia inserendo i tuoi dati."}),E&&g.jsx("div",{className:"mb-6 bg-amber-50 border border-amber-200 rounded-lg p-3 text-left animate-fade-in-up relative",children:g.jsxs("div",{className:"flex gap-3",children:[g.jsx("div",{className:"flex-shrink-0",children:g.jsx(W_,{className:"h-5 w-5 text-amber-500"})}),g.jsxs("div",{className:"flex-1",children:[g.jsx("p",{className:"text-sm font-medium text-amber-800",children:"Attenzione"}),g.jsx("p",{className:"text-sm text-amber-700 mt-1",children:"Senza registrare la mail su Telegram non sar possibile recuperarla."})]}),g.jsx("button",{onClick:()=>n("pin_setup"),className:"flex-shrink-0 text-amber-400 hover:text-amber-600 transition-colors",title:"Ignora e procedi",children:g.jsx(fn,{className:"h-5 w-5"})})]})}),g.jsxs("form",{onSubmit:C,className:"space-y-4",children:[g.jsxs("div",{children:[g.jsx("label",{htmlFor:"email-register",className:"sr-only",children:"Email"}),g.jsxs("div",{className:"relative",children:[g.jsx("div",{className:"pointer-events-none absolute inset-y-0 left-0 flex items-center pl-3",children:g.jsx(Q_,{className:"h-5 w-5 text-slate-400","aria-hidden":"true"})}),g.jsx("input",{type:"email",id:"email-register",value:a,onChange:I=>i(I.target.value),className:j,placeholder:"La tua email",required:!0})]})]}),g.jsx("button",{type:"submit",disabled:!a,className:"w-full px-4 py-3 text-sm font-semibold text-white bg-indigo-600 rounded-lg shadow-sm hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2 transition-colors disabled:bg-indigo-300",children:"Continua"})]}),g.jsxs("p",{className:"text-sm text-slate-500 mt-6",children:["Hai gi un account?"," ",g.jsx("button",{onClick:t,className:"font-semibold text-indigo-600 hover:text-indigo-500",children:"Accedi"})]}),g.jsx("div",{className:"mt-8 pt-6 border-t border-slate-200",children:g.jsxs("a",{href:N(),target:"_blank",rel:"noopener noreferrer",onClick:I=>{a?k(!0):(I.preventDefault(),h("Inserisci prima la tua email."))},className:`inline-flex items-center gap-2 text-sm font-medium transition-colors bg-sky-50 px-4 py-2 rounded-full hover:bg-sky-100 ${a?"text-sky-600 hover:text-sky-700":"text-slate-400 cursor-not-allowed"}`,children:[g.jsx(ife,{className:"w-5 h-5"}),"Registra mail su telegram"]})})]});case"pin_setup":case"pin_confirm":{const I=r==="pin_confirm";return g.jsxs("div",{className:"text-center",children:[g.jsx("h2",{className:"text-xl font-bold text-slate-800 mb-2",children:I?"Conferma il tuo PIN":"Crea un PIN di 4 cifre"}),g.jsx("p",{className:`text-slate-500 h-10 flex items-center justify-center transition-colors ${d?"text-red-500":""}`,children:d||(I?"Inseriscilo di nuovo per conferma.":"Servir per accedere al tuo account.")}),g.jsx(jD,{pin:I?c:s,onPinChange:I?u:o})]})}case"bio_offer":return g.jsxs("div",{className:"text-center",children:[g.jsx("h2",{className:"text-xl font-bold text-slate-800 mb-2",children:"Vuoi abilitare limpronta / FaceID?"}),g.jsx("p",{className:"text-slate-500 h-10 flex items-center justify-center",children:"Potrai sbloccare lapp senza inserire il PIN."}),g.jsxs("div",{className:"mt-4 p-3 rounded-lg border border-slate-200 bg-slate-50 text-left inline-block",children:[g.jsx("p",{className:"text-sm text-slate-700",children:"Abilita ora lo sblocco biometrico?"}),g.jsxs("div",{className:"flex gap-3 mt-2",children:[g.jsx("button",{onClick:async()=>{if(!x){await P();return}try{_(!0),await Z_("Profilo locale"),afe(),_(!1)}catch{_(!1)}finally{await P()}},disabled:y,className:"px-4 py-2 text-sm font-semibold text-white bg-indigo-600 rounded-lg shadow-sm hover:bg-indigo-700 disabled:bg-indigo-300",children:y?"Attivo":"Abilita e continua"}),g.jsx("button",{onClick:async()=>{Y_(!0),await P()},disabled:y,className:"px-4 py-2 text-sm font-semibold text-slate-600 bg-white border border-slate-300 rounded-lg hover:bg-slate-100",children:"Non ora"})]})]})]})}};return g.jsx(Gp,{children:R()})},ofe=({onBackToLogin:e,onRequestSent:t})=>{const[r,n]=D.useState(""),[a,i]=D.useState(!1),[s,o]=D.useState(null),c=async d=>{if(d.preventDefault(),!r)return;i(!0),o(null);const h=await wI(r);i(!1),h.success?t(r):o(h.message)};return g.jsx(Gp,{children:g.jsxs("div",{className:"text-center",children:[g.jsx("h2",{className:"text-xl font-bold text-slate-800 mb-2",children:"Reimposta PIN"}),g.jsxs(g.Fragment,{children:[g.jsx("p",{className:"text-slate-500 mb-6",children:"Inserisci la tua email e ti invieremo un link per reimpostare il tuo PIN."}),s&&g.jsx("p",{className:"text-red-600 text-sm mb-4 bg-red-100 p-3 rounded-md",children:s}),g.jsxs("form",{onSubmit:c,children:[g.jsxs("div",{className:"mb-4",children:[g.jsx("label",{htmlFor:"email-forgot",className:"sr-only",children:"Email"}),g.jsxs("div",{className:"relative",children:[g.jsx("div",{className:"pointer-events-none absolute inset-y-0 left-0 flex items-center pl-3",children:g.jsx(Q_,{className:"h-5 w-5 text-slate-400","aria-hidden":"true"})}),g.jsx("input",{type:"email",id:"email-forgot",autoComplete:"email",value:r,onChange:d=>n(d.target.value),className:"block w-full rounded-md border border-slate-300 bg-white py-2.5 pl-10 pr-3 text-slate-900 placeholder:text-slate-400 focus:outline-none focus:border-indigo-500 focus:ring-1 focus:ring-indigo-500 sm:text-sm",placeholder:"La tua email",required:!0,disabled:a})]})]}),g.jsx("button",{type:"submit",disabled:a||!r,className:"w-full px-4 py-3 text-sm font-semibold text-white bg-indigo-600 rounded-lg shadow-sm hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2 transition-colors disabled:bg-indigo-300 flex justify-center items-center",children:a?g.jsx(fc,{className:"w-5 h-5"}):"Invia Link di Reset"})]}),g.jsx("button",{onClick:e,className:"mt-6 w-full text-center text-sm font-semibold text-indigo-600 hover:text-indigo-500",children:"Annulla"})]})]})})},lfe=60,cfe=({email:e,onBackToLogin:t})=>{const[r,n]=D.useState(0),[a,i]=D.useState(!1),s=D.useRef(null);D.useEffect(()=>()=>{s.current&&(window.clearInterval(s.current),s.current=null)},[]);const o=()=>{n(lfe),s.current&&window.clearInterval(s.current),s.current=window.setInterval(()=>{n(u=>u<=1?(s.current&&(window.clearInterval(s.current),s.current=null),0):u-1)},1e3)},c=async()=>{if(!(a||r>0))try{i(!0),await wI(e),o()}finally{i(!1)}};return g.jsx(Gp,{children:g.jsxs("div",{className:"text-center",children:[g.jsx("div",{className:"mx-auto flex h-12 w-12 items-center justify-center rounded-full bg-green-100 mb-4",children:g.jsx(Q_,{className:"h-6 w-6 text-green-600","aria-hidden":"true"})}),g.jsx("h2",{className:"text-xl font-bold text-slate-800 mb-2",children:"Controlla la tua Email"}),g.jsxs("p",{className:"text-slate-500 mb-6",children:["Abbiamo inviato un link per il reset del PIN a ",g.jsx("br",{}),g.jsx("strong",{className:"text-slate-700",children:e}),".",g.jsx("br",{}),g.jsx("br",{}),"Apri il link per continuare. Se non lo trovi, controlla la cartella spam."]}),g.jsxs("div",{className:"space-y-3",children:[g.jsx("button",{onClick:t,className:"w-full px-4 py-3 text-sm font-semibold text-white bg-indigo-600 rounded-lg shadow-sm hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2 transition-colors",children:"Torna al Login"}),g.jsxs("div",{className:"text-sm text-slate-600",children:["Non hai ricevuto lemail?"," ",g.jsx("button",{onClick:c,disabled:a||r>0,className:"font-semibold text-indigo-600 hover:text-indigo-700 disabled:opacity-50 disabled:cursor-not-allowed",children:a?"Invio":r>0?`Reinvia tra ${r}s`:"Reinvia link"})]})]})]})})},ufe=({email:e,token:t,onResetSuccess:r})=>{const[n,a]=D.useState("new_pin"),[i,s]=D.useState(""),[o,c]=D.useState(""),[u,d]=D.useState(null),[h,p]=D.useState(!1),[v,x]=D.useState(null),w=(e||"").trim().toLowerCase(),y=async k=>{k.preventDefault(),d(null);const E=i.trim(),T=o.trim();if(!/^\d{4}$/.test(E)){d("Inserisci un PIN di 4 cifre.");return}if(n==="new_pin"){a("confirm_pin");return}if(E!==T){d("I PIN non coincidono. Riprova.");return}if(!w){d("Email non valida nel link. Richiedi di nuovo il reset.");return}try{p(!0);const N=await zX(w,t||"",E);if(p(!1),!N.success){d(N.message||"Errore durante il reset del PIN.");return}x("PIN aggiornato con successo."),setTimeout(()=>{r()},800)}catch(N){console.error("[ResetPin] Errore inatteso:",N),p(!1),d("Errore imprevisto durante il reset del PIN.")}},_=n==="new_pin"?"Imposta un nuovo PIN":"Conferma il nuovo PIN",S=n==="new_pin"?`Stai reimpostando il PIN per laccount ${w||e}. Scegli un nuovo PIN a 4 cifre.`:"Reinserisci il nuovo PIN per conferma.";return g.jsx("div",{className:"min-h-screen bg-slate-100 flex items-center justify-center px-4",children:g.jsxs("div",{className:"w-full max-w-md bg-white rounded-2xl shadow-lg p-6",children:[g.jsx("h1",{className:"text-2xl font-bold text-slate-900 mb-2",children:_}),g.jsx("p",{className:"text-sm text-slate-500 mb-4",children:S}),g.jsxs("p",{className:"text-xs text-slate-400 mb-6 break-all",children:["Email: ",g.jsx("span",{className:"font-mono text-slate-700",children:w||"(sconosciuta)"})]}),g.jsxs("form",{onSubmit:y,className:"space-y-5",children:[n==="new_pin"&&g.jsxs("div",{children:[g.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Nuovo PIN (4 cifre)"}),g.jsx("input",{type:"password",inputMode:"numeric",maxLength:4,value:i,onChange:k=>s(k.target.value.replace(/\D/g,"").slice(0,4)),className:"w-full px-3 py-2 rounded-lg border border-slate-300 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 text-center tracking-[0.5em] text-lg",autoFocus:!0})]}),n==="confirm_pin"&&g.jsxs(g.Fragment,{children:[g.jsxs("div",{children:[g.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Nuovo PIN (4 cifre)"}),g.jsx("input",{type:"password",inputMode:"numeric",maxLength:4,value:i,onChange:k=>s(k.target.value.replace(/\D/g,"").slice(0,4)),className:"w-full px-3 py-2 rounded-lg border border-slate-300 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 text-center tracking-[0.5em] text-lg"})]}),g.jsxs("div",{children:[g.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Conferma PIN"}),g.jsx("input",{type:"password",inputMode:"numeric",maxLength:4,value:o,onChange:k=>c(k.target.value.replace(/\D/g,"").slice(0,4)),className:"w-full px-3 py-2 rounded-lg border border-slate-300 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 text-center tracking-[0.5em] text-lg",autoFocus:!0})]})]}),u&&g.jsx("div",{className:"text-sm text-red-600 bg-red-50 border border-red-100 rounded-md px-3 py-2",children:u}),v&&g.jsx("div",{className:"text-sm text-green-700 bg-green-50 border border-green-100 rounded-md px-3 py-2",children:v}),g.jsx("button",{type:"submit",disabled:h,className:"w-full inline-flex items-center justify-center px-4 py-2.5 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-indigo-600 hover:bg-indigo-700 disabled:opacity-60 disabled:cursor-not-allowed",children:h?"Salvataggio...":n==="new_pin"?"Continua":"Salva PIN"}),g.jsx("button",{type:"button",onClick:r,disabled:h,className:"w-full text-sm text-slate-500 hover:text-slate-700 mt-2",children:"Annulla e torna al login"})]})]})})},ffe=3e4,dfe=()=>{const[e,t]=D.useState(null),[r,n]=yu("last_active_user_email",null),[a,i]=D.useState(null),s=D.useRef(null),[o,c]=D.useState(""),u=()=>{try{const w=localStorage.getItem("users_db");return w!==null&&w!=="{}"}catch{return!1}},[d,h]=D.useState(u()?"login":"register");D.useEffect(()=>{const w=new URLSearchParams(window.location.search),y=w.get("resetToken"),_=w.get("email");if(y&&_){i({token:y,email:_});try{window.history.replaceState({},document.title,window.location.pathname)}catch{}}},[]);const p=(w,y)=>{t(w),n(y.toLowerCase())},v=()=>{i(null),h("login")},x=D.useCallback(()=>{t(null),n(null),h(u()?"login":"register")},[n]);if(D.useEffect(()=>{const w=()=>{if(document.visibilityState==="hidden")e&&(s.current=Date.now());else if(document.visibilityState==="visible"){if(sessionStorage.getItem("preventAutoLock")==="true"){sessionStorage.removeItem("preventAutoLock"),s.current=null;return}e&&s.current&&Date.now()-s.current>ffe&&x(),s.current=null}};return document.addEventListener("visibilitychange",w),()=>{document.removeEventListener("visibilitychange",w)}},[e,x]),a)return g.jsx(ufe,{email:a.email,token:a.token,onResetSuccess:v});if(e)return g.jsx(que,{onLogout:x,currentEmail:r||""});switch(d){case"register":return g.jsx(sfe,{onSetupSuccess:p,onGoToLogin:()=>h("login")});case"forgotPassword":return g.jsx(ofe,{onBackToLogin:()=>h("login"),onRequestSent:w=>{c(w),h("forgotPasswordSuccess")}});case"forgotPasswordSuccess":return g.jsx(cfe,{email:o,onBackToLogin:()=>h("login")});case"login":default:return g.jsx(rfe,{onLoginSuccess:p,onGoToRegister:()=>h("register"),onGoToForgotPassword:()=>h("forgotPassword"),onGoToForgotEmail:()=>h("forgotPassword")})}},UD=document.getElementById("root");if(!UD)throw new Error("Could not find root element to mount to");const hfe=DR.createRoot(UD);hfe.render(g.jsx(me.StrictMode,{children:g.jsx(dfe,{})}));"serviceWorker"in navigator&&window.addEventListener("load",()=>{navigator.serviceWorker.register("./service-worker.js").then(e=>{console.log(" SW Registrato con successo:",e.scope),e.waiting&&e.waiting.postMessage({type:"SKIP_WAITING"})}).catch(e=>{console.error(" Registrazione SW fallita:",e)}),navigator.serviceWorker.addEventListener("controllerchange",()=>{window.location.reload()})});
