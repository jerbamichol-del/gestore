(function(){const r=document.createElement("link").relList;if(r&&r.supports&&r.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))a(i);new MutationObserver(i=>{for(const o of i)if(o.type==="childList")for(const u of o.addedNodes)u.tagName==="LINK"&&u.rel==="modulepreload"&&a(u)}).observe(document,{childList:!0,subtree:!0});function t(i){const o={};return i.integrity&&(o.integrity=i.integrity),i.referrerPolicy&&(o.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?o.credentials="include":i.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function a(i){if(i.ep)return;i.ep=!0;const o=t(i);fetch(i.href,o)}})();function ac(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var J0={exports:{}},Mi={},eu={exports:{}},pt={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var i1;function qv(){if(i1)return pt;i1=1;var e=Symbol.for("react.element"),r=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),a=Symbol.for("react.strict_mode"),i=Symbol.for("react.profiler"),o=Symbol.for("react.provider"),u=Symbol.for("react.context"),c=Symbol.for("react.forward_ref"),h=Symbol.for("react.suspense"),x=Symbol.for("react.memo"),m=Symbol.for("react.lazy"),w=Symbol.iterator;function p(Q){return Q===null||typeof Q!="object"?null:(Q=w&&Q[w]||Q["@@iterator"],typeof Q=="function"?Q:null)}var v={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},y=Object.assign,T={};function E(Q,ie,ve){this.props=Q,this.context=ie,this.refs=T,this.updater=ve||v}E.prototype.isReactComponent={},E.prototype.setState=function(Q,ie){if(typeof Q!="object"&&typeof Q!="function"&&Q!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,Q,ie,"setState")},E.prototype.forceUpdate=function(Q){this.updater.enqueueForceUpdate(this,Q,"forceUpdate")};function _(){}_.prototype=E.prototype;function C(Q,ie,ve){this.props=Q,this.context=ie,this.refs=T,this.updater=ve||v}var S=C.prototype=new _;S.constructor=C,y(S,E.prototype),S.isPureReactComponent=!0;var N=Array.isArray,B=Object.prototype.hasOwnProperty,X={current:null},j={key:!0,ref:!0,__self:!0,__source:!0};function z(Q,ie,ve){var pe,Ae={},je=null,ze=null;if(ie!=null)for(pe in ie.ref!==void 0&&(ze=ie.ref),ie.key!==void 0&&(je=""+ie.key),ie)B.call(ie,pe)&&!j.hasOwnProperty(pe)&&(Ae[pe]=ie[pe]);var P=arguments.length-2;if(P===1)Ae.children=ve;else if(1<P){for(var ee=Array(P),J=0;J<P;J++)ee[J]=arguments[J+2];Ae.children=ee}if(Q&&Q.defaultProps)for(pe in P=Q.defaultProps,P)Ae[pe]===void 0&&(Ae[pe]=P[pe]);return{$$typeof:e,type:Q,key:je,ref:ze,props:Ae,_owner:X.current}}function M(Q,ie){return{$$typeof:e,type:Q.type,key:ie,ref:Q.ref,props:Q.props,_owner:Q._owner}}function U(Q){return typeof Q=="object"&&Q!==null&&Q.$$typeof===e}function D(Q){var ie={"=":"=0",":":"=2"};return"$"+Q.replace(/[=:]/g,function(ve){return ie[ve]})}var R=/\/+/g;function K(Q,ie){return typeof Q=="object"&&Q!==null&&Q.key!=null?D(""+Q.key):ie.toString(36)}function ae(Q,ie,ve,pe,Ae){var je=typeof Q;(je==="undefined"||je==="boolean")&&(Q=null);var ze=!1;if(Q===null)ze=!0;else switch(je){case"string":case"number":ze=!0;break;case"object":switch(Q.$$typeof){case e:case r:ze=!0}}if(ze)return ze=Q,Ae=Ae(ze),Q=pe===""?"."+K(ze,0):pe,N(Ae)?(ve="",Q!=null&&(ve=Q.replace(R,"$&/")+"/"),ae(Ae,ie,ve,"",function(J){return J})):Ae!=null&&(U(Ae)&&(Ae=M(Ae,ve+(!Ae.key||ze&&ze.key===Ae.key?"":(""+Ae.key).replace(R,"$&/")+"/")+Q)),ie.push(Ae)),1;if(ze=0,pe=pe===""?".":pe+":",N(Q))for(var P=0;P<Q.length;P++){je=Q[P];var ee=pe+K(je,P);ze+=ae(je,ie,ve,ee,Ae)}else if(ee=p(Q),typeof ee=="function")for(Q=ee.call(Q),P=0;!(je=Q.next()).done;)je=je.value,ee=pe+K(je,P++),ze+=ae(je,ie,ve,ee,Ae);else if(je==="object")throw ie=String(Q),Error("Objects are not valid as a React child (found: "+(ie==="[object Object]"?"object with keys {"+Object.keys(Q).join(", ")+"}":ie)+"). If you meant to render a collection of children, use an array instead.");return ze}function te(Q,ie,ve){if(Q==null)return Q;var pe=[],Ae=0;return ae(Q,pe,"","",function(je){return ie.call(ve,je,Ae++)}),pe}function oe(Q){if(Q._status===-1){var ie=Q._result;ie=ie(),ie.then(function(ve){(Q._status===0||Q._status===-1)&&(Q._status=1,Q._result=ve)},function(ve){(Q._status===0||Q._status===-1)&&(Q._status=2,Q._result=ve)}),Q._status===-1&&(Q._status=0,Q._result=ie)}if(Q._status===1)return Q._result.default;throw Q._result}var re={current:null},Z={transition:null},ge={ReactCurrentDispatcher:re,ReactCurrentBatchConfig:Z,ReactCurrentOwner:X};function q(){throw Error("act(...) is not supported in production builds of React.")}return pt.Children={map:te,forEach:function(Q,ie,ve){te(Q,function(){ie.apply(this,arguments)},ve)},count:function(Q){var ie=0;return te(Q,function(){ie++}),ie},toArray:function(Q){return te(Q,function(ie){return ie})||[]},only:function(Q){if(!U(Q))throw Error("React.Children.only expected to receive a single React element child.");return Q}},pt.Component=E,pt.Fragment=t,pt.Profiler=i,pt.PureComponent=C,pt.StrictMode=a,pt.Suspense=h,pt.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=ge,pt.act=q,pt.cloneElement=function(Q,ie,ve){if(Q==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+Q+".");var pe=y({},Q.props),Ae=Q.key,je=Q.ref,ze=Q._owner;if(ie!=null){if(ie.ref!==void 0&&(je=ie.ref,ze=X.current),ie.key!==void 0&&(Ae=""+ie.key),Q.type&&Q.type.defaultProps)var P=Q.type.defaultProps;for(ee in ie)B.call(ie,ee)&&!j.hasOwnProperty(ee)&&(pe[ee]=ie[ee]===void 0&&P!==void 0?P[ee]:ie[ee])}var ee=arguments.length-2;if(ee===1)pe.children=ve;else if(1<ee){P=Array(ee);for(var J=0;J<ee;J++)P[J]=arguments[J+2];pe.children=P}return{$$typeof:e,type:Q.type,key:Ae,ref:je,props:pe,_owner:ze}},pt.createContext=function(Q){return Q={$$typeof:u,_currentValue:Q,_currentValue2:Q,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},Q.Provider={$$typeof:o,_context:Q},Q.Consumer=Q},pt.createElement=z,pt.createFactory=function(Q){var ie=z.bind(null,Q);return ie.type=Q,ie},pt.createRef=function(){return{current:null}},pt.forwardRef=function(Q){return{$$typeof:c,render:Q}},pt.isValidElement=U,pt.lazy=function(Q){return{$$typeof:m,_payload:{_status:-1,_result:Q},_init:oe}},pt.memo=function(Q,ie){return{$$typeof:x,type:Q,compare:ie===void 0?null:ie}},pt.startTransition=function(Q){var ie=Z.transition;Z.transition={};try{Q()}finally{Z.transition=ie}},pt.unstable_act=q,pt.useCallback=function(Q,ie){return re.current.useCallback(Q,ie)},pt.useContext=function(Q){return re.current.useContext(Q)},pt.useDebugValue=function(){},pt.useDeferredValue=function(Q){return re.current.useDeferredValue(Q)},pt.useEffect=function(Q,ie){return re.current.useEffect(Q,ie)},pt.useId=function(){return re.current.useId()},pt.useImperativeHandle=function(Q,ie,ve){return re.current.useImperativeHandle(Q,ie,ve)},pt.useInsertionEffect=function(Q,ie){return re.current.useInsertionEffect(Q,ie)},pt.useLayoutEffect=function(Q,ie){return re.current.useLayoutEffect(Q,ie)},pt.useMemo=function(Q,ie){return re.current.useMemo(Q,ie)},pt.useReducer=function(Q,ie,ve){return re.current.useReducer(Q,ie,ve)},pt.useRef=function(Q){return re.current.useRef(Q)},pt.useState=function(Q){return re.current.useState(Q)},pt.useSyncExternalStore=function(Q,ie,ve){return re.current.useSyncExternalStore(Q,ie,ve)},pt.useTransition=function(){return re.current.useTransition()},pt.version="18.3.1",pt}var o1;function ho(){return o1||(o1=1,eu.exports=qv()),eu.exports}/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var l1;function Zv(){if(l1)return Mi;l1=1;var e=ho(),r=Symbol.for("react.element"),t=Symbol.for("react.fragment"),a=Object.prototype.hasOwnProperty,i=e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,o={key:!0,ref:!0,__self:!0,__source:!0};function u(c,h,x){var m,w={},p=null,v=null;x!==void 0&&(p=""+x),h.key!==void 0&&(p=""+h.key),h.ref!==void 0&&(v=h.ref);for(m in h)a.call(h,m)&&!o.hasOwnProperty(m)&&(w[m]=h[m]);if(c&&c.defaultProps)for(m in h=c.defaultProps,h)w[m]===void 0&&(w[m]=h[m]);return{$$typeof:r,type:c,key:p,ref:v,props:w,_owner:i.current}}return Mi.Fragment=t,Mi.jsx=u,Mi.jsxs=u,Mi}var c1;function Jv(){return c1||(c1=1,J0.exports=Zv()),J0.exports}var f=Jv(),I=ho();const Tn=ac(I);var bl={},tu={exports:{}},Xr={},ru={exports:{}},nu={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var u1;function e2(){return u1||(u1=1,(function(e){function r(Z,ge){var q=Z.length;Z.push(ge);e:for(;0<q;){var Q=q-1>>>1,ie=Z[Q];if(0<i(ie,ge))Z[Q]=ge,Z[q]=ie,q=Q;else break e}}function t(Z){return Z.length===0?null:Z[0]}function a(Z){if(Z.length===0)return null;var ge=Z[0],q=Z.pop();if(q!==ge){Z[0]=q;e:for(var Q=0,ie=Z.length,ve=ie>>>1;Q<ve;){var pe=2*(Q+1)-1,Ae=Z[pe],je=pe+1,ze=Z[je];if(0>i(Ae,q))je<ie&&0>i(ze,Ae)?(Z[Q]=ze,Z[je]=q,Q=je):(Z[Q]=Ae,Z[pe]=q,Q=pe);else if(je<ie&&0>i(ze,q))Z[Q]=ze,Z[je]=q,Q=je;else break e}}return ge}function i(Z,ge){var q=Z.sortIndex-ge.sortIndex;return q!==0?q:Z.id-ge.id}if(typeof performance=="object"&&typeof performance.now=="function"){var o=performance;e.unstable_now=function(){return o.now()}}else{var u=Date,c=u.now();e.unstable_now=function(){return u.now()-c}}var h=[],x=[],m=1,w=null,p=3,v=!1,y=!1,T=!1,E=typeof setTimeout=="function"?setTimeout:null,_=typeof clearTimeout=="function"?clearTimeout:null,C=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function S(Z){for(var ge=t(x);ge!==null;){if(ge.callback===null)a(x);else if(ge.startTime<=Z)a(x),ge.sortIndex=ge.expirationTime,r(h,ge);else break;ge=t(x)}}function N(Z){if(T=!1,S(Z),!y)if(t(h)!==null)y=!0,oe(B);else{var ge=t(x);ge!==null&&re(N,ge.startTime-Z)}}function B(Z,ge){y=!1,T&&(T=!1,_(z),z=-1),v=!0;var q=p;try{for(S(ge),w=t(h);w!==null&&(!(w.expirationTime>ge)||Z&&!D());){var Q=w.callback;if(typeof Q=="function"){w.callback=null,p=w.priorityLevel;var ie=Q(w.expirationTime<=ge);ge=e.unstable_now(),typeof ie=="function"?w.callback=ie:w===t(h)&&a(h),S(ge)}else a(h);w=t(h)}if(w!==null)var ve=!0;else{var pe=t(x);pe!==null&&re(N,pe.startTime-ge),ve=!1}return ve}finally{w=null,p=q,v=!1}}var X=!1,j=null,z=-1,M=5,U=-1;function D(){return!(e.unstable_now()-U<M)}function R(){if(j!==null){var Z=e.unstable_now();U=Z;var ge=!0;try{ge=j(!0,Z)}finally{ge?K():(X=!1,j=null)}}else X=!1}var K;if(typeof C=="function")K=function(){C(R)};else if(typeof MessageChannel<"u"){var ae=new MessageChannel,te=ae.port2;ae.port1.onmessage=R,K=function(){te.postMessage(null)}}else K=function(){E(R,0)};function oe(Z){j=Z,X||(X=!0,K())}function re(Z,ge){z=E(function(){Z(e.unstable_now())},ge)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(Z){Z.callback=null},e.unstable_continueExecution=function(){y||v||(y=!0,oe(B))},e.unstable_forceFrameRate=function(Z){0>Z||125<Z?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):M=0<Z?Math.floor(1e3/Z):5},e.unstable_getCurrentPriorityLevel=function(){return p},e.unstable_getFirstCallbackNode=function(){return t(h)},e.unstable_next=function(Z){switch(p){case 1:case 2:case 3:var ge=3;break;default:ge=p}var q=p;p=ge;try{return Z()}finally{p=q}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(Z,ge){switch(Z){case 1:case 2:case 3:case 4:case 5:break;default:Z=3}var q=p;p=Z;try{return ge()}finally{p=q}},e.unstable_scheduleCallback=function(Z,ge,q){var Q=e.unstable_now();switch(typeof q=="object"&&q!==null?(q=q.delay,q=typeof q=="number"&&0<q?Q+q:Q):q=Q,Z){case 1:var ie=-1;break;case 2:ie=250;break;case 5:ie=1073741823;break;case 4:ie=1e4;break;default:ie=5e3}return ie=q+ie,Z={id:m++,callback:ge,priorityLevel:Z,startTime:q,expirationTime:ie,sortIndex:-1},q>Q?(Z.sortIndex=q,r(x,Z),t(h)===null&&Z===t(x)&&(T?(_(z),z=-1):T=!0,re(N,q-Q))):(Z.sortIndex=ie,r(h,Z),y||v||(y=!0,oe(B))),Z},e.unstable_shouldYield=D,e.unstable_wrapCallback=function(Z){var ge=p;return function(){var q=p;p=ge;try{return Z.apply(this,arguments)}finally{p=q}}}})(nu)),nu}var f1;function t2(){return f1||(f1=1,ru.exports=e2()),ru.exports}/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var d1;function r2(){if(d1)return Xr;d1=1;var e=ho(),r=t2();function t(n){for(var s="https://reactjs.org/docs/error-decoder.html?invariant="+n,l=1;l<arguments.length;l++)s+="&args[]="+encodeURIComponent(arguments[l]);return"Minified React error #"+n+"; visit "+s+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var a=new Set,i={};function o(n,s){u(n,s),u(n+"Capture",s)}function u(n,s){for(i[n]=s,n=0;n<s.length;n++)a.add(s[n])}var c=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),h=Object.prototype.hasOwnProperty,x=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,m={},w={};function p(n){return h.call(w,n)?!0:h.call(m,n)?!1:x.test(n)?w[n]=!0:(m[n]=!0,!1)}function v(n,s,l,d){if(l!==null&&l.type===0)return!1;switch(typeof s){case"function":case"symbol":return!0;case"boolean":return d?!1:l!==null?!l.acceptsBooleans:(n=n.toLowerCase().slice(0,5),n!=="data-"&&n!=="aria-");default:return!1}}function y(n,s,l,d){if(s===null||typeof s>"u"||v(n,s,l,d))return!0;if(d)return!1;if(l!==null)switch(l.type){case 3:return!s;case 4:return s===!1;case 5:return isNaN(s);case 6:return isNaN(s)||1>s}return!1}function T(n,s,l,d,g,k,b){this.acceptsBooleans=s===2||s===3||s===4,this.attributeName=d,this.attributeNamespace=g,this.mustUseProperty=l,this.propertyName=n,this.type=s,this.sanitizeURL=k,this.removeEmptyString=b}var E={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(n){E[n]=new T(n,0,!1,n,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(n){var s=n[0];E[s]=new T(s,1,!1,n[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(n){E[n]=new T(n,2,!1,n.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(n){E[n]=new T(n,2,!1,n,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(n){E[n]=new T(n,3,!1,n.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(n){E[n]=new T(n,3,!0,n,null,!1,!1)}),["capture","download"].forEach(function(n){E[n]=new T(n,4,!1,n,null,!1,!1)}),["cols","rows","size","span"].forEach(function(n){E[n]=new T(n,6,!1,n,null,!1,!1)}),["rowSpan","start"].forEach(function(n){E[n]=new T(n,5,!1,n.toLowerCase(),null,!1,!1)});var _=/[\-:]([a-z])/g;function C(n){return n[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(n){var s=n.replace(_,C);E[s]=new T(s,1,!1,n,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(n){var s=n.replace(_,C);E[s]=new T(s,1,!1,n,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(n){var s=n.replace(_,C);E[s]=new T(s,1,!1,n,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(n){E[n]=new T(n,1,!1,n.toLowerCase(),null,!1,!1)}),E.xlinkHref=new T("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(n){E[n]=new T(n,1,!1,n.toLowerCase(),null,!0,!0)});function S(n,s,l,d){var g=E.hasOwnProperty(s)?E[s]:null;(g!==null?g.type!==0:d||!(2<s.length)||s[0]!=="o"&&s[0]!=="O"||s[1]!=="n"&&s[1]!=="N")&&(y(s,l,g,d)&&(l=null),d||g===null?p(s)&&(l===null?n.removeAttribute(s):n.setAttribute(s,""+l)):g.mustUseProperty?n[g.propertyName]=l===null?g.type===3?!1:"":l:(s=g.attributeName,d=g.attributeNamespace,l===null?n.removeAttribute(s):(g=g.type,l=g===3||g===4&&l===!0?"":""+l,d?n.setAttributeNS(d,s,l):n.setAttribute(s,l))))}var N=e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,B=Symbol.for("react.element"),X=Symbol.for("react.portal"),j=Symbol.for("react.fragment"),z=Symbol.for("react.strict_mode"),M=Symbol.for("react.profiler"),U=Symbol.for("react.provider"),D=Symbol.for("react.context"),R=Symbol.for("react.forward_ref"),K=Symbol.for("react.suspense"),ae=Symbol.for("react.suspense_list"),te=Symbol.for("react.memo"),oe=Symbol.for("react.lazy"),re=Symbol.for("react.offscreen"),Z=Symbol.iterator;function ge(n){return n===null||typeof n!="object"?null:(n=Z&&n[Z]||n["@@iterator"],typeof n=="function"?n:null)}var q=Object.assign,Q;function ie(n){if(Q===void 0)try{throw Error()}catch(l){var s=l.stack.trim().match(/\n( *(at )?)/);Q=s&&s[1]||""}return`
`+Q+n}var ve=!1;function pe(n,s){if(!n||ve)return"";ve=!0;var l=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(s)if(s=function(){throw Error()},Object.defineProperty(s.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(s,[])}catch(we){var d=we}Reflect.construct(n,[],s)}else{try{s.call()}catch(we){d=we}n.call(s.prototype)}else{try{throw Error()}catch(we){d=we}n()}}catch(we){if(we&&d&&typeof we.stack=="string"){for(var g=we.stack.split(`
`),k=d.stack.split(`
`),b=g.length-1,Y=k.length-1;1<=b&&0<=Y&&g[b]!==k[Y];)Y--;for(;1<=b&&0<=Y;b--,Y--)if(g[b]!==k[Y]){if(b!==1||Y!==1)do if(b--,Y--,0>Y||g[b]!==k[Y]){var ne=`
`+g[b].replace(" at new "," at ");return n.displayName&&ne.includes("<anonymous>")&&(ne=ne.replace("<anonymous>",n.displayName)),ne}while(1<=b&&0<=Y);break}}}finally{ve=!1,Error.prepareStackTrace=l}return(n=n?n.displayName||n.name:"")?ie(n):""}function Ae(n){switch(n.tag){case 5:return ie(n.type);case 16:return ie("Lazy");case 13:return ie("Suspense");case 19:return ie("SuspenseList");case 0:case 2:case 15:return n=pe(n.type,!1),n;case 11:return n=pe(n.type.render,!1),n;case 1:return n=pe(n.type,!0),n;default:return""}}function je(n){if(n==null)return null;if(typeof n=="function")return n.displayName||n.name||null;if(typeof n=="string")return n;switch(n){case j:return"Fragment";case X:return"Portal";case M:return"Profiler";case z:return"StrictMode";case K:return"Suspense";case ae:return"SuspenseList"}if(typeof n=="object")switch(n.$$typeof){case D:return(n.displayName||"Context")+".Consumer";case U:return(n._context.displayName||"Context")+".Provider";case R:var s=n.render;return n=n.displayName,n||(n=s.displayName||s.name||"",n=n!==""?"ForwardRef("+n+")":"ForwardRef"),n;case te:return s=n.displayName||null,s!==null?s:je(n.type)||"Memo";case oe:s=n._payload,n=n._init;try{return je(n(s))}catch{}}return null}function ze(n){var s=n.type;switch(n.tag){case 24:return"Cache";case 9:return(s.displayName||"Context")+".Consumer";case 10:return(s._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return n=s.render,n=n.displayName||n.name||"",s.displayName||(n!==""?"ForwardRef("+n+")":"ForwardRef");case 7:return"Fragment";case 5:return s;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return je(s);case 8:return s===z?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof s=="function")return s.displayName||s.name||null;if(typeof s=="string")return s}return null}function P(n){switch(typeof n){case"boolean":case"number":case"string":case"undefined":return n;case"object":return n;default:return""}}function ee(n){var s=n.type;return(n=n.nodeName)&&n.toLowerCase()==="input"&&(s==="checkbox"||s==="radio")}function J(n){var s=ee(n)?"checked":"value",l=Object.getOwnPropertyDescriptor(n.constructor.prototype,s),d=""+n[s];if(!n.hasOwnProperty(s)&&typeof l<"u"&&typeof l.get=="function"&&typeof l.set=="function"){var g=l.get,k=l.set;return Object.defineProperty(n,s,{configurable:!0,get:function(){return g.call(this)},set:function(b){d=""+b,k.call(this,b)}}),Object.defineProperty(n,s,{enumerable:l.enumerable}),{getValue:function(){return d},setValue:function(b){d=""+b},stopTracking:function(){n._valueTracker=null,delete n[s]}}}}function G(n){n._valueTracker||(n._valueTracker=J(n))}function _e(n){if(!n)return!1;var s=n._valueTracker;if(!s)return!0;var l=s.getValue(),d="";return n&&(d=ee(n)?n.checked?"true":"false":n.value),n=d,n!==l?(s.setValue(n),!0):!1}function F(n){if(n=n||(typeof document<"u"?document:void 0),typeof n>"u")return null;try{return n.activeElement||n.body}catch{return n.body}}function ke(n,s){var l=s.checked;return q({},s,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:l??n._wrapperState.initialChecked})}function Fe(n,s){var l=s.defaultValue==null?"":s.defaultValue,d=s.checked!=null?s.checked:s.defaultChecked;l=P(s.value!=null?s.value:l),n._wrapperState={initialChecked:d,initialValue:l,controlled:s.type==="checkbox"||s.type==="radio"?s.checked!=null:s.value!=null}}function De(n,s){s=s.checked,s!=null&&S(n,"checked",s,!1)}function Ge(n,s){De(n,s);var l=P(s.value),d=s.type;if(l!=null)d==="number"?(l===0&&n.value===""||n.value!=l)&&(n.value=""+l):n.value!==""+l&&(n.value=""+l);else if(d==="submit"||d==="reset"){n.removeAttribute("value");return}s.hasOwnProperty("value")?tt(n,s.type,l):s.hasOwnProperty("defaultValue")&&tt(n,s.type,P(s.defaultValue)),s.checked==null&&s.defaultChecked!=null&&(n.defaultChecked=!!s.defaultChecked)}function Ve(n,s,l){if(s.hasOwnProperty("value")||s.hasOwnProperty("defaultValue")){var d=s.type;if(!(d!=="submit"&&d!=="reset"||s.value!==void 0&&s.value!==null))return;s=""+n._wrapperState.initialValue,l||s===n.value||(n.value=s),n.defaultValue=s}l=n.name,l!==""&&(n.name=""),n.defaultChecked=!!n._wrapperState.initialChecked,l!==""&&(n.name=l)}function tt(n,s,l){(s!=="number"||F(n.ownerDocument)!==n)&&(l==null?n.defaultValue=""+n._wrapperState.initialValue:n.defaultValue!==""+l&&(n.defaultValue=""+l))}var ft=Array.isArray;function st(n,s,l,d){if(n=n.options,s){s={};for(var g=0;g<l.length;g++)s["$"+l[g]]=!0;for(l=0;l<n.length;l++)g=s.hasOwnProperty("$"+n[l].value),n[l].selected!==g&&(n[l].selected=g),g&&d&&(n[l].defaultSelected=!0)}else{for(l=""+P(l),s=null,g=0;g<n.length;g++){if(n[g].value===l){n[g].selected=!0,d&&(n[g].defaultSelected=!0);return}s!==null||n[g].disabled||(s=n[g])}s!==null&&(s.selected=!0)}}function ye(n,s){if(s.dangerouslySetInnerHTML!=null)throw Error(t(91));return q({},s,{value:void 0,defaultValue:void 0,children:""+n._wrapperState.initialValue})}function Ce(n,s){var l=s.value;if(l==null){if(l=s.children,s=s.defaultValue,l!=null){if(s!=null)throw Error(t(92));if(ft(l)){if(1<l.length)throw Error(t(93));l=l[0]}s=l}s==null&&(s=""),l=s}n._wrapperState={initialValue:P(l)}}function le(n,s){var l=P(s.value),d=P(s.defaultValue);l!=null&&(l=""+l,l!==n.value&&(n.value=l),s.defaultValue==null&&n.defaultValue!==l&&(n.defaultValue=l)),d!=null&&(n.defaultValue=""+d)}function ce(n){var s=n.textContent;s===n._wrapperState.initialValue&&s!==""&&s!==null&&(n.value=s)}function Ee(n){switch(n){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Se(n,s){return n==null||n==="http://www.w3.org/1999/xhtml"?Ee(s):n==="http://www.w3.org/2000/svg"&&s==="foreignObject"?"http://www.w3.org/1999/xhtml":n}var Re,at=(function(n){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(s,l,d,g){MSApp.execUnsafeLocalFunction(function(){return n(s,l,d,g)})}:n})(function(n,s){if(n.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in n)n.innerHTML=s;else{for(Re=Re||document.createElement("div"),Re.innerHTML="<svg>"+s.valueOf().toString()+"</svg>",s=Re.firstChild;n.firstChild;)n.removeChild(n.firstChild);for(;s.firstChild;)n.appendChild(s.firstChild)}});function it(n,s){if(s){var l=n.firstChild;if(l&&l===n.lastChild&&l.nodeType===3){l.nodeValue=s;return}}n.textContent=s}var Ne={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Ke=["Webkit","ms","Moz","O"];Object.keys(Ne).forEach(function(n){Ke.forEach(function(s){s=s+n.charAt(0).toUpperCase()+n.substring(1),Ne[s]=Ne[n]})});function mt(n,s,l){return s==null||typeof s=="boolean"||s===""?"":l||typeof s!="number"||s===0||Ne.hasOwnProperty(n)&&Ne[n]?(""+s).trim():s+"px"}function Nt(n,s){n=n.style;for(var l in s)if(s.hasOwnProperty(l)){var d=l.indexOf("--")===0,g=mt(l,s[l],d);l==="float"&&(l="cssFloat"),d?n.setProperty(l,g):n[l]=g}}var Er=q({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function _r(n,s){if(s){if(Er[n]&&(s.children!=null||s.dangerouslySetInnerHTML!=null))throw Error(t(137,n));if(s.dangerouslySetInnerHTML!=null){if(s.children!=null)throw Error(t(60));if(typeof s.dangerouslySetInnerHTML!="object"||!("__html"in s.dangerouslySetInnerHTML))throw Error(t(61))}if(s.style!=null&&typeof s.style!="object")throw Error(t(62))}}function ln(n,s){if(n.indexOf("-")===-1)return typeof s.is=="string";switch(n){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Un=null;function Br(n){return n=n.target||n.srcElement||window,n.correspondingUseElement&&(n=n.correspondingUseElement),n.nodeType===3?n.parentNode:n}var sr=null,Ur=null,cn=null;function un(n){if(n=_i(n)){if(typeof sr!="function")throw Error(t(280));var s=n.stateNode;s&&(s=Ho(s),sr(n.stateNode,n.type,s))}}function Ie(n){Ur?cn?cn.push(n):cn=[n]:Ur=n}function $e(){if(Ur){var n=Ur,s=cn;if(cn=Ur=null,un(n),s)for(n=0;n<s.length;n++)un(s[n])}}function ut(n,s){return n(s)}function be(){}var Ye=!1;function Xe(n,s,l){if(Ye)return n(s,l);Ye=!0;try{return ut(n,s,l)}finally{Ye=!1,(Ur!==null||cn!==null)&&(be(),$e())}}function ct(n,s){var l=n.stateNode;if(l===null)return null;var d=Ho(l);if(d===null)return null;l=d[s];e:switch(s){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(d=!d.disabled)||(n=n.type,d=!(n==="button"||n==="input"||n==="select"||n==="textarea")),n=!d;break e;default:n=!1}if(n)return null;if(l&&typeof l!="function")throw Error(t(231,s,typeof l));return l}var At=!1;if(c)try{var mr={};Object.defineProperty(mr,"passive",{get:function(){At=!0}}),window.addEventListener("test",mr,mr),window.removeEventListener("test",mr,mr)}catch{At=!1}function Kn(n,s,l,d,g,k,b,Y,ne){var we=Array.prototype.slice.call(arguments,3);try{s.apply(l,we)}catch(Le){this.onError(Le)}}var bn=!1,fa=null,A=!1,H=null,O={onError:function(n){bn=!0,fa=n}};function L(n,s,l,d,g,k,b,Y,ne){bn=!1,fa=null,Kn.apply(O,arguments)}function V(n,s,l,d,g,k,b,Y,ne){if(L.apply(this,arguments),bn){if(bn){var we=fa;bn=!1,fa=null}else throw Error(t(198));A||(A=!0,H=we)}}function W(n){var s=n,l=n;if(n.alternate)for(;s.return;)s=s.return;else{n=s;do s=n,(s.flags&4098)!==0&&(l=s.return),n=s.return;while(n)}return s.tag===3?l:null}function de(n){if(n.tag===13){var s=n.memoizedState;if(s===null&&(n=n.alternate,n!==null&&(s=n.memoizedState)),s!==null)return s.dehydrated}return null}function Te(n){if(W(n)!==n)throw Error(t(188))}function fe(n){var s=n.alternate;if(!s){if(s=W(n),s===null)throw Error(t(188));return s!==n?null:n}for(var l=n,d=s;;){var g=l.return;if(g===null)break;var k=g.alternate;if(k===null){if(d=g.return,d!==null){l=d;continue}break}if(g.child===k.child){for(k=g.child;k;){if(k===l)return Te(g),n;if(k===d)return Te(g),s;k=k.sibling}throw Error(t(188))}if(l.return!==d.return)l=g,d=k;else{for(var b=!1,Y=g.child;Y;){if(Y===l){b=!0,l=g,d=k;break}if(Y===d){b=!0,d=g,l=k;break}Y=Y.sibling}if(!b){for(Y=k.child;Y;){if(Y===l){b=!0,l=k,d=g;break}if(Y===d){b=!0,d=k,l=g;break}Y=Y.sibling}if(!b)throw Error(t(189))}}if(l.alternate!==d)throw Error(t(190))}if(l.tag!==3)throw Error(t(188));return l.stateNode.current===l?n:s}function he(n){return n=fe(n),n!==null?xe(n):null}function xe(n){if(n.tag===5||n.tag===6)return n;for(n=n.child;n!==null;){var s=xe(n);if(s!==null)return s;n=n.sibling}return null}var Me=r.unstable_scheduleCallback,We=r.unstable_cancelCallback,qe=r.unstable_shouldYield,Ue=r.unstable_requestPaint,Pe=r.unstable_now,xt=r.unstable_getCurrentPriorityLevel,Rt=r.unstable_ImmediatePriority,Ot=r.unstable_UserBlockingPriority,Wt=r.unstable_NormalPriority,Xa=r.unstable_LowPriority,da=r.unstable_IdlePriority,zn=null,ir=null;function ai(n){if(ir&&typeof ir.onCommitFiberRoot=="function")try{ir.onCommitFiberRoot(zn,n,void 0,(n.current.flags&128)===128)}catch{}}var $t=Math.clz32?Math.clz32:mg,hg=Math.log,xg=Math.LN2;function mg(n){return n>>>=0,n===0?32:31-(hg(n)/xg|0)|0}var To=64,So=4194304;function si(n){switch(n&-n){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return n&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return n&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return n}}function Co(n,s){var l=n.pendingLanes;if(l===0)return 0;var d=0,g=n.suspendedLanes,k=n.pingedLanes,b=l&268435455;if(b!==0){var Y=b&~g;Y!==0?d=si(Y):(k&=b,k!==0&&(d=si(k)))}else b=l&~g,b!==0?d=si(b):k!==0&&(d=si(k));if(d===0)return 0;if(s!==0&&s!==d&&(s&g)===0&&(g=d&-d,k=s&-s,g>=k||g===16&&(k&4194240)!==0))return s;if((d&4)!==0&&(d|=l&16),s=n.entangledLanes,s!==0)for(n=n.entanglements,s&=d;0<s;)l=31-$t(s),g=1<<l,d|=n[l],s&=~g;return d}function pg(n,s){switch(n){case 1:case 2:case 4:return s+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return s+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function gg(n,s){for(var l=n.suspendedLanes,d=n.pingedLanes,g=n.expirationTimes,k=n.pendingLanes;0<k;){var b=31-$t(k),Y=1<<b,ne=g[b];ne===-1?((Y&l)===0||(Y&d)!==0)&&(g[b]=pg(Y,s)):ne<=s&&(n.expiredLanes|=Y),k&=~Y}}function yc(n){return n=n.pendingLanes&-1073741825,n!==0?n:n&1073741824?1073741824:0}function Lf(){var n=To;return To<<=1,(To&4194240)===0&&(To=64),n}function kc(n){for(var s=[],l=0;31>l;l++)s.push(n);return s}function ii(n,s,l){n.pendingLanes|=s,s!==536870912&&(n.suspendedLanes=0,n.pingedLanes=0),n=n.eventTimes,s=31-$t(s),n[s]=l}function vg(n,s){var l=n.pendingLanes&~s;n.pendingLanes=s,n.suspendedLanes=0,n.pingedLanes=0,n.expiredLanes&=s,n.mutableReadLanes&=s,n.entangledLanes&=s,s=n.entanglements;var d=n.eventTimes;for(n=n.expirationTimes;0<l;){var g=31-$t(l),k=1<<g;s[g]=0,d[g]=-1,n[g]=-1,l&=~k}}function Ec(n,s){var l=n.entangledLanes|=s;for(n=n.entanglements;l;){var d=31-$t(l),g=1<<d;g&s|n[d]&s&&(n[d]|=s),l&=~g}}var Dt=0;function Mf(n){return n&=-n,1<n?4<n?(n&268435455)!==0?16:536870912:4:1}var Bf,_c,Uf,zf,Hf,Tc=!1,bo=[],ha=null,xa=null,ma=null,oi=new Map,li=new Map,pa=[],wg="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Vf(n,s){switch(n){case"focusin":case"focusout":ha=null;break;case"dragenter":case"dragleave":xa=null;break;case"mouseover":case"mouseout":ma=null;break;case"pointerover":case"pointerout":oi.delete(s.pointerId);break;case"gotpointercapture":case"lostpointercapture":li.delete(s.pointerId)}}function ci(n,s,l,d,g,k){return n===null||n.nativeEvent!==k?(n={blockedOn:s,domEventName:l,eventSystemFlags:d,nativeEvent:k,targetContainers:[g]},s!==null&&(s=_i(s),s!==null&&_c(s)),n):(n.eventSystemFlags|=d,s=n.targetContainers,g!==null&&s.indexOf(g)===-1&&s.push(g),n)}function yg(n,s,l,d,g){switch(s){case"focusin":return ha=ci(ha,n,s,l,d,g),!0;case"dragenter":return xa=ci(xa,n,s,l,d,g),!0;case"mouseover":return ma=ci(ma,n,s,l,d,g),!0;case"pointerover":var k=g.pointerId;return oi.set(k,ci(oi.get(k)||null,n,s,l,d,g)),!0;case"gotpointercapture":return k=g.pointerId,li.set(k,ci(li.get(k)||null,n,s,l,d,g)),!0}return!1}function Wf(n){var s=Ga(n.target);if(s!==null){var l=W(s);if(l!==null){if(s=l.tag,s===13){if(s=de(l),s!==null){n.blockedOn=s,Hf(n.priority,function(){Uf(l)});return}}else if(s===3&&l.stateNode.current.memoizedState.isDehydrated){n.blockedOn=l.tag===3?l.stateNode.containerInfo:null;return}}}n.blockedOn=null}function No(n){if(n.blockedOn!==null)return!1;for(var s=n.targetContainers;0<s.length;){var l=Cc(n.domEventName,n.eventSystemFlags,s[0],n.nativeEvent);if(l===null){l=n.nativeEvent;var d=new l.constructor(l.type,l);Un=d,l.target.dispatchEvent(d),Un=null}else return s=_i(l),s!==null&&_c(s),n.blockedOn=l,!1;s.shift()}return!0}function $f(n,s,l){No(n)&&l.delete(s)}function kg(){Tc=!1,ha!==null&&No(ha)&&(ha=null),xa!==null&&No(xa)&&(xa=null),ma!==null&&No(ma)&&(ma=null),oi.forEach($f),li.forEach($f)}function ui(n,s){n.blockedOn===s&&(n.blockedOn=null,Tc||(Tc=!0,r.unstable_scheduleCallback(r.unstable_NormalPriority,kg)))}function fi(n){function s(g){return ui(g,n)}if(0<bo.length){ui(bo[0],n);for(var l=1;l<bo.length;l++){var d=bo[l];d.blockedOn===n&&(d.blockedOn=null)}}for(ha!==null&&ui(ha,n),xa!==null&&ui(xa,n),ma!==null&&ui(ma,n),oi.forEach(s),li.forEach(s),l=0;l<pa.length;l++)d=pa[l],d.blockedOn===n&&(d.blockedOn=null);for(;0<pa.length&&(l=pa[0],l.blockedOn===null);)Wf(l),l.blockedOn===null&&pa.shift()}var ys=N.ReactCurrentBatchConfig,Ao=!0;function Eg(n,s,l,d){var g=Dt,k=ys.transition;ys.transition=null;try{Dt=1,Sc(n,s,l,d)}finally{Dt=g,ys.transition=k}}function _g(n,s,l,d){var g=Dt,k=ys.transition;ys.transition=null;try{Dt=4,Sc(n,s,l,d)}finally{Dt=g,ys.transition=k}}function Sc(n,s,l,d){if(Ao){var g=Cc(n,s,l,d);if(g===null)Vc(n,s,d,Fo,l),Vf(n,d);else if(yg(g,n,s,l,d))d.stopPropagation();else if(Vf(n,d),s&4&&-1<wg.indexOf(n)){for(;g!==null;){var k=_i(g);if(k!==null&&Bf(k),k=Cc(n,s,l,d),k===null&&Vc(n,s,d,Fo,l),k===g)break;g=k}g!==null&&d.stopPropagation()}else Vc(n,s,d,null,l)}}var Fo=null;function Cc(n,s,l,d){if(Fo=null,n=Br(d),n=Ga(n),n!==null)if(s=W(n),s===null)n=null;else if(l=s.tag,l===13){if(n=de(s),n!==null)return n;n=null}else if(l===3){if(s.stateNode.current.memoizedState.isDehydrated)return s.tag===3?s.stateNode.containerInfo:null;n=null}else s!==n&&(n=null);return Fo=n,null}function Xf(n){switch(n){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(xt()){case Rt:return 1;case Ot:return 4;case Wt:case Xa:return 16;case da:return 536870912;default:return 16}default:return 16}}var ga=null,bc=null,Io=null;function Gf(){if(Io)return Io;var n,s=bc,l=s.length,d,g="value"in ga?ga.value:ga.textContent,k=g.length;for(n=0;n<l&&s[n]===g[n];n++);var b=l-n;for(d=1;d<=b&&s[l-d]===g[k-d];d++);return Io=g.slice(n,1<d?1-d:void 0)}function Do(n){var s=n.keyCode;return"charCode"in n?(n=n.charCode,n===0&&s===13&&(n=13)):n=s,n===10&&(n=13),32<=n||n===13?n:0}function Ro(){return!0}function Yf(){return!1}function Qr(n){function s(l,d,g,k,b){this._reactName=l,this._targetInst=g,this.type=d,this.nativeEvent=k,this.target=b,this.currentTarget=null;for(var Y in n)n.hasOwnProperty(Y)&&(l=n[Y],this[Y]=l?l(k):k[Y]);return this.isDefaultPrevented=(k.defaultPrevented!=null?k.defaultPrevented:k.returnValue===!1)?Ro:Yf,this.isPropagationStopped=Yf,this}return q(s.prototype,{preventDefault:function(){this.defaultPrevented=!0;var l=this.nativeEvent;l&&(l.preventDefault?l.preventDefault():typeof l.returnValue!="unknown"&&(l.returnValue=!1),this.isDefaultPrevented=Ro)},stopPropagation:function(){var l=this.nativeEvent;l&&(l.stopPropagation?l.stopPropagation():typeof l.cancelBubble!="unknown"&&(l.cancelBubble=!0),this.isPropagationStopped=Ro)},persist:function(){},isPersistent:Ro}),s}var ks={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(n){return n.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Nc=Qr(ks),di=q({},ks,{view:0,detail:0}),Tg=Qr(di),Ac,Fc,hi,Po=q({},di,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Dc,button:0,buttons:0,relatedTarget:function(n){return n.relatedTarget===void 0?n.fromElement===n.srcElement?n.toElement:n.fromElement:n.relatedTarget},movementX:function(n){return"movementX"in n?n.movementX:(n!==hi&&(hi&&n.type==="mousemove"?(Ac=n.screenX-hi.screenX,Fc=n.screenY-hi.screenY):Fc=Ac=0,hi=n),Ac)},movementY:function(n){return"movementY"in n?n.movementY:Fc}}),Kf=Qr(Po),Sg=q({},Po,{dataTransfer:0}),Cg=Qr(Sg),bg=q({},di,{relatedTarget:0}),Ic=Qr(bg),Ng=q({},ks,{animationName:0,elapsedTime:0,pseudoElement:0}),Ag=Qr(Ng),Fg=q({},ks,{clipboardData:function(n){return"clipboardData"in n?n.clipboardData:window.clipboardData}}),Ig=Qr(Fg),Dg=q({},ks,{data:0}),Qf=Qr(Dg),Rg={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Pg={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Og={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function jg(n){var s=this.nativeEvent;return s.getModifierState?s.getModifierState(n):(n=Og[n])?!!s[n]:!1}function Dc(){return jg}var Lg=q({},di,{key:function(n){if(n.key){var s=Rg[n.key]||n.key;if(s!=="Unidentified")return s}return n.type==="keypress"?(n=Do(n),n===13?"Enter":String.fromCharCode(n)):n.type==="keydown"||n.type==="keyup"?Pg[n.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Dc,charCode:function(n){return n.type==="keypress"?Do(n):0},keyCode:function(n){return n.type==="keydown"||n.type==="keyup"?n.keyCode:0},which:function(n){return n.type==="keypress"?Do(n):n.type==="keydown"||n.type==="keyup"?n.keyCode:0}}),Mg=Qr(Lg),Bg=q({},Po,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),qf=Qr(Bg),Ug=q({},di,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Dc}),zg=Qr(Ug),Hg=q({},ks,{propertyName:0,elapsedTime:0,pseudoElement:0}),Vg=Qr(Hg),Wg=q({},Po,{deltaX:function(n){return"deltaX"in n?n.deltaX:"wheelDeltaX"in n?-n.wheelDeltaX:0},deltaY:function(n){return"deltaY"in n?n.deltaY:"wheelDeltaY"in n?-n.wheelDeltaY:"wheelDelta"in n?-n.wheelDelta:0},deltaZ:0,deltaMode:0}),$g=Qr(Wg),Xg=[9,13,27,32],Rc=c&&"CompositionEvent"in window,xi=null;c&&"documentMode"in document&&(xi=document.documentMode);var Gg=c&&"TextEvent"in window&&!xi,Zf=c&&(!Rc||xi&&8<xi&&11>=xi),Jf=" ",ed=!1;function td(n,s){switch(n){case"keyup":return Xg.indexOf(s.keyCode)!==-1;case"keydown":return s.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function rd(n){return n=n.detail,typeof n=="object"&&"data"in n?n.data:null}var Es=!1;function Yg(n,s){switch(n){case"compositionend":return rd(s);case"keypress":return s.which!==32?null:(ed=!0,Jf);case"textInput":return n=s.data,n===Jf&&ed?null:n;default:return null}}function Kg(n,s){if(Es)return n==="compositionend"||!Rc&&td(n,s)?(n=Gf(),Io=bc=ga=null,Es=!1,n):null;switch(n){case"paste":return null;case"keypress":if(!(s.ctrlKey||s.altKey||s.metaKey)||s.ctrlKey&&s.altKey){if(s.char&&1<s.char.length)return s.char;if(s.which)return String.fromCharCode(s.which)}return null;case"compositionend":return Zf&&s.locale!=="ko"?null:s.data;default:return null}}var Qg={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function nd(n){var s=n&&n.nodeName&&n.nodeName.toLowerCase();return s==="input"?!!Qg[n.type]:s==="textarea"}function ad(n,s,l,d){Ie(d),s=Bo(s,"onChange"),0<s.length&&(l=new Nc("onChange","change",null,l,d),n.push({event:l,listeners:s}))}var mi=null,pi=null;function qg(n){Ed(n,0)}function Oo(n){var s=bs(n);if(_e(s))return n}function Zg(n,s){if(n==="change")return s}var sd=!1;if(c){var Pc;if(c){var Oc="oninput"in document;if(!Oc){var id=document.createElement("div");id.setAttribute("oninput","return;"),Oc=typeof id.oninput=="function"}Pc=Oc}else Pc=!1;sd=Pc&&(!document.documentMode||9<document.documentMode)}function od(){mi&&(mi.detachEvent("onpropertychange",ld),pi=mi=null)}function ld(n){if(n.propertyName==="value"&&Oo(pi)){var s=[];ad(s,pi,n,Br(n)),Xe(qg,s)}}function Jg(n,s,l){n==="focusin"?(od(),mi=s,pi=l,mi.attachEvent("onpropertychange",ld)):n==="focusout"&&od()}function ev(n){if(n==="selectionchange"||n==="keyup"||n==="keydown")return Oo(pi)}function tv(n,s){if(n==="click")return Oo(s)}function rv(n,s){if(n==="input"||n==="change")return Oo(s)}function nv(n,s){return n===s&&(n!==0||1/n===1/s)||n!==n&&s!==s}var Nn=typeof Object.is=="function"?Object.is:nv;function gi(n,s){if(Nn(n,s))return!0;if(typeof n!="object"||n===null||typeof s!="object"||s===null)return!1;var l=Object.keys(n),d=Object.keys(s);if(l.length!==d.length)return!1;for(d=0;d<l.length;d++){var g=l[d];if(!h.call(s,g)||!Nn(n[g],s[g]))return!1}return!0}function cd(n){for(;n&&n.firstChild;)n=n.firstChild;return n}function ud(n,s){var l=cd(n);n=0;for(var d;l;){if(l.nodeType===3){if(d=n+l.textContent.length,n<=s&&d>=s)return{node:l,offset:s-n};n=d}e:{for(;l;){if(l.nextSibling){l=l.nextSibling;break e}l=l.parentNode}l=void 0}l=cd(l)}}function fd(n,s){return n&&s?n===s?!0:n&&n.nodeType===3?!1:s&&s.nodeType===3?fd(n,s.parentNode):"contains"in n?n.contains(s):n.compareDocumentPosition?!!(n.compareDocumentPosition(s)&16):!1:!1}function dd(){for(var n=window,s=F();s instanceof n.HTMLIFrameElement;){try{var l=typeof s.contentWindow.location.href=="string"}catch{l=!1}if(l)n=s.contentWindow;else break;s=F(n.document)}return s}function jc(n){var s=n&&n.nodeName&&n.nodeName.toLowerCase();return s&&(s==="input"&&(n.type==="text"||n.type==="search"||n.type==="tel"||n.type==="url"||n.type==="password")||s==="textarea"||n.contentEditable==="true")}function av(n){var s=dd(),l=n.focusedElem,d=n.selectionRange;if(s!==l&&l&&l.ownerDocument&&fd(l.ownerDocument.documentElement,l)){if(d!==null&&jc(l)){if(s=d.start,n=d.end,n===void 0&&(n=s),"selectionStart"in l)l.selectionStart=s,l.selectionEnd=Math.min(n,l.value.length);else if(n=(s=l.ownerDocument||document)&&s.defaultView||window,n.getSelection){n=n.getSelection();var g=l.textContent.length,k=Math.min(d.start,g);d=d.end===void 0?k:Math.min(d.end,g),!n.extend&&k>d&&(g=d,d=k,k=g),g=ud(l,k);var b=ud(l,d);g&&b&&(n.rangeCount!==1||n.anchorNode!==g.node||n.anchorOffset!==g.offset||n.focusNode!==b.node||n.focusOffset!==b.offset)&&(s=s.createRange(),s.setStart(g.node,g.offset),n.removeAllRanges(),k>d?(n.addRange(s),n.extend(b.node,b.offset)):(s.setEnd(b.node,b.offset),n.addRange(s)))}}for(s=[],n=l;n=n.parentNode;)n.nodeType===1&&s.push({element:n,left:n.scrollLeft,top:n.scrollTop});for(typeof l.focus=="function"&&l.focus(),l=0;l<s.length;l++)n=s[l],n.element.scrollLeft=n.left,n.element.scrollTop=n.top}}var sv=c&&"documentMode"in document&&11>=document.documentMode,_s=null,Lc=null,vi=null,Mc=!1;function hd(n,s,l){var d=l.window===l?l.document:l.nodeType===9?l:l.ownerDocument;Mc||_s==null||_s!==F(d)||(d=_s,"selectionStart"in d&&jc(d)?d={start:d.selectionStart,end:d.selectionEnd}:(d=(d.ownerDocument&&d.ownerDocument.defaultView||window).getSelection(),d={anchorNode:d.anchorNode,anchorOffset:d.anchorOffset,focusNode:d.focusNode,focusOffset:d.focusOffset}),vi&&gi(vi,d)||(vi=d,d=Bo(Lc,"onSelect"),0<d.length&&(s=new Nc("onSelect","select",null,s,l),n.push({event:s,listeners:d}),s.target=_s)))}function jo(n,s){var l={};return l[n.toLowerCase()]=s.toLowerCase(),l["Webkit"+n]="webkit"+s,l["Moz"+n]="moz"+s,l}var Ts={animationend:jo("Animation","AnimationEnd"),animationiteration:jo("Animation","AnimationIteration"),animationstart:jo("Animation","AnimationStart"),transitionend:jo("Transition","TransitionEnd")},Bc={},xd={};c&&(xd=document.createElement("div").style,"AnimationEvent"in window||(delete Ts.animationend.animation,delete Ts.animationiteration.animation,delete Ts.animationstart.animation),"TransitionEvent"in window||delete Ts.transitionend.transition);function Lo(n){if(Bc[n])return Bc[n];if(!Ts[n])return n;var s=Ts[n],l;for(l in s)if(s.hasOwnProperty(l)&&l in xd)return Bc[n]=s[l];return n}var md=Lo("animationend"),pd=Lo("animationiteration"),gd=Lo("animationstart"),vd=Lo("transitionend"),wd=new Map,yd="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function va(n,s){wd.set(n,s),o(s,[n])}for(var Uc=0;Uc<yd.length;Uc++){var zc=yd[Uc],iv=zc.toLowerCase(),ov=zc[0].toUpperCase()+zc.slice(1);va(iv,"on"+ov)}va(md,"onAnimationEnd"),va(pd,"onAnimationIteration"),va(gd,"onAnimationStart"),va("dblclick","onDoubleClick"),va("focusin","onFocus"),va("focusout","onBlur"),va(vd,"onTransitionEnd"),u("onMouseEnter",["mouseout","mouseover"]),u("onMouseLeave",["mouseout","mouseover"]),u("onPointerEnter",["pointerout","pointerover"]),u("onPointerLeave",["pointerout","pointerover"]),o("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),o("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),o("onBeforeInput",["compositionend","keypress","textInput","paste"]),o("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),o("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),o("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var wi="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),lv=new Set("cancel close invalid load scroll toggle".split(" ").concat(wi));function kd(n,s,l){var d=n.type||"unknown-event";n.currentTarget=l,V(d,s,void 0,n),n.currentTarget=null}function Ed(n,s){s=(s&4)!==0;for(var l=0;l<n.length;l++){var d=n[l],g=d.event;d=d.listeners;e:{var k=void 0;if(s)for(var b=d.length-1;0<=b;b--){var Y=d[b],ne=Y.instance,we=Y.currentTarget;if(Y=Y.listener,ne!==k&&g.isPropagationStopped())break e;kd(g,Y,we),k=ne}else for(b=0;b<d.length;b++){if(Y=d[b],ne=Y.instance,we=Y.currentTarget,Y=Y.listener,ne!==k&&g.isPropagationStopped())break e;kd(g,Y,we),k=ne}}}if(A)throw n=H,A=!1,H=null,n}function Lt(n,s){var l=s[Kc];l===void 0&&(l=s[Kc]=new Set);var d=n+"__bubble";l.has(d)||(_d(s,n,2,!1),l.add(d))}function Hc(n,s,l){var d=0;s&&(d|=4),_d(l,n,d,s)}var Mo="_reactListening"+Math.random().toString(36).slice(2);function yi(n){if(!n[Mo]){n[Mo]=!0,a.forEach(function(l){l!=="selectionchange"&&(lv.has(l)||Hc(l,!1,n),Hc(l,!0,n))});var s=n.nodeType===9?n:n.ownerDocument;s===null||s[Mo]||(s[Mo]=!0,Hc("selectionchange",!1,s))}}function _d(n,s,l,d){switch(Xf(s)){case 1:var g=Eg;break;case 4:g=_g;break;default:g=Sc}l=g.bind(null,s,l,n),g=void 0,!At||s!=="touchstart"&&s!=="touchmove"&&s!=="wheel"||(g=!0),d?g!==void 0?n.addEventListener(s,l,{capture:!0,passive:g}):n.addEventListener(s,l,!0):g!==void 0?n.addEventListener(s,l,{passive:g}):n.addEventListener(s,l,!1)}function Vc(n,s,l,d,g){var k=d;if((s&1)===0&&(s&2)===0&&d!==null)e:for(;;){if(d===null)return;var b=d.tag;if(b===3||b===4){var Y=d.stateNode.containerInfo;if(Y===g||Y.nodeType===8&&Y.parentNode===g)break;if(b===4)for(b=d.return;b!==null;){var ne=b.tag;if((ne===3||ne===4)&&(ne=b.stateNode.containerInfo,ne===g||ne.nodeType===8&&ne.parentNode===g))return;b=b.return}for(;Y!==null;){if(b=Ga(Y),b===null)return;if(ne=b.tag,ne===5||ne===6){d=k=b;continue e}Y=Y.parentNode}}d=d.return}Xe(function(){var we=k,Le=Br(l),Be=[];e:{var Oe=wd.get(n);if(Oe!==void 0){var Qe=Nc,et=n;switch(n){case"keypress":if(Do(l)===0)break e;case"keydown":case"keyup":Qe=Mg;break;case"focusin":et="focus",Qe=Ic;break;case"focusout":et="blur",Qe=Ic;break;case"beforeblur":case"afterblur":Qe=Ic;break;case"click":if(l.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":Qe=Kf;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":Qe=Cg;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":Qe=zg;break;case md:case pd:case gd:Qe=Ag;break;case vd:Qe=Vg;break;case"scroll":Qe=Tg;break;case"wheel":Qe=$g;break;case"copy":case"cut":case"paste":Qe=Ig;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":Qe=qf}var rt=(s&4)!==0,Xt=!rt&&n==="scroll",ue=rt?Oe!==null?Oe+"Capture":null:Oe;rt=[];for(var se=we,me;se!==null;){me=se;var He=me.stateNode;if(me.tag===5&&He!==null&&(me=He,ue!==null&&(He=ct(se,ue),He!=null&&rt.push(ki(se,He,me)))),Xt)break;se=se.return}0<rt.length&&(Oe=new Qe(Oe,et,null,l,Le),Be.push({event:Oe,listeners:rt}))}}if((s&7)===0){e:{if(Oe=n==="mouseover"||n==="pointerover",Qe=n==="mouseout"||n==="pointerout",Oe&&l!==Un&&(et=l.relatedTarget||l.fromElement)&&(Ga(et)||et[Qn]))break e;if((Qe||Oe)&&(Oe=Le.window===Le?Le:(Oe=Le.ownerDocument)?Oe.defaultView||Oe.parentWindow:window,Qe?(et=l.relatedTarget||l.toElement,Qe=we,et=et?Ga(et):null,et!==null&&(Xt=W(et),et!==Xt||et.tag!==5&&et.tag!==6)&&(et=null)):(Qe=null,et=we),Qe!==et)){if(rt=Kf,He="onMouseLeave",ue="onMouseEnter",se="mouse",(n==="pointerout"||n==="pointerover")&&(rt=qf,He="onPointerLeave",ue="onPointerEnter",se="pointer"),Xt=Qe==null?Oe:bs(Qe),me=et==null?Oe:bs(et),Oe=new rt(He,se+"leave",Qe,l,Le),Oe.target=Xt,Oe.relatedTarget=me,He=null,Ga(Le)===we&&(rt=new rt(ue,se+"enter",et,l,Le),rt.target=me,rt.relatedTarget=Xt,He=rt),Xt=He,Qe&&et)t:{for(rt=Qe,ue=et,se=0,me=rt;me;me=Ss(me))se++;for(me=0,He=ue;He;He=Ss(He))me++;for(;0<se-me;)rt=Ss(rt),se--;for(;0<me-se;)ue=Ss(ue),me--;for(;se--;){if(rt===ue||ue!==null&&rt===ue.alternate)break t;rt=Ss(rt),ue=Ss(ue)}rt=null}else rt=null;Qe!==null&&Td(Be,Oe,Qe,rt,!1),et!==null&&Xt!==null&&Td(Be,Xt,et,rt,!0)}}e:{if(Oe=we?bs(we):window,Qe=Oe.nodeName&&Oe.nodeName.toLowerCase(),Qe==="select"||Qe==="input"&&Oe.type==="file")var nt=Zg;else if(nd(Oe))if(sd)nt=rv;else{nt=ev;var ot=Jg}else(Qe=Oe.nodeName)&&Qe.toLowerCase()==="input"&&(Oe.type==="checkbox"||Oe.type==="radio")&&(nt=tv);if(nt&&(nt=nt(n,we))){ad(Be,nt,l,Le);break e}ot&&ot(n,Oe,we),n==="focusout"&&(ot=Oe._wrapperState)&&ot.controlled&&Oe.type==="number"&&tt(Oe,"number",Oe.value)}switch(ot=we?bs(we):window,n){case"focusin":(nd(ot)||ot.contentEditable==="true")&&(_s=ot,Lc=we,vi=null);break;case"focusout":vi=Lc=_s=null;break;case"mousedown":Mc=!0;break;case"contextmenu":case"mouseup":case"dragend":Mc=!1,hd(Be,l,Le);break;case"selectionchange":if(sv)break;case"keydown":case"keyup":hd(Be,l,Le)}var lt;if(Rc)e:{switch(n){case"compositionstart":var dt="onCompositionStart";break e;case"compositionend":dt="onCompositionEnd";break e;case"compositionupdate":dt="onCompositionUpdate";break e}dt=void 0}else Es?td(n,l)&&(dt="onCompositionEnd"):n==="keydown"&&l.keyCode===229&&(dt="onCompositionStart");dt&&(Zf&&l.locale!=="ko"&&(Es||dt!=="onCompositionStart"?dt==="onCompositionEnd"&&Es&&(lt=Gf()):(ga=Le,bc="value"in ga?ga.value:ga.textContent,Es=!0)),ot=Bo(we,dt),0<ot.length&&(dt=new Qf(dt,n,null,l,Le),Be.push({event:dt,listeners:ot}),lt?dt.data=lt:(lt=rd(l),lt!==null&&(dt.data=lt)))),(lt=Gg?Yg(n,l):Kg(n,l))&&(we=Bo(we,"onBeforeInput"),0<we.length&&(Le=new Qf("onBeforeInput","beforeinput",null,l,Le),Be.push({event:Le,listeners:we}),Le.data=lt))}Ed(Be,s)})}function ki(n,s,l){return{instance:n,listener:s,currentTarget:l}}function Bo(n,s){for(var l=s+"Capture",d=[];n!==null;){var g=n,k=g.stateNode;g.tag===5&&k!==null&&(g=k,k=ct(n,l),k!=null&&d.unshift(ki(n,k,g)),k=ct(n,s),k!=null&&d.push(ki(n,k,g))),n=n.return}return d}function Ss(n){if(n===null)return null;do n=n.return;while(n&&n.tag!==5);return n||null}function Td(n,s,l,d,g){for(var k=s._reactName,b=[];l!==null&&l!==d;){var Y=l,ne=Y.alternate,we=Y.stateNode;if(ne!==null&&ne===d)break;Y.tag===5&&we!==null&&(Y=we,g?(ne=ct(l,k),ne!=null&&b.unshift(ki(l,ne,Y))):g||(ne=ct(l,k),ne!=null&&b.push(ki(l,ne,Y)))),l=l.return}b.length!==0&&n.push({event:s,listeners:b})}var cv=/\r\n?/g,uv=/\u0000|\uFFFD/g;function Sd(n){return(typeof n=="string"?n:""+n).replace(cv,`
`).replace(uv,"")}function Uo(n,s,l){if(s=Sd(s),Sd(n)!==s&&l)throw Error(t(425))}function zo(){}var Wc=null,$c=null;function Xc(n,s){return n==="textarea"||n==="noscript"||typeof s.children=="string"||typeof s.children=="number"||typeof s.dangerouslySetInnerHTML=="object"&&s.dangerouslySetInnerHTML!==null&&s.dangerouslySetInnerHTML.__html!=null}var Gc=typeof setTimeout=="function"?setTimeout:void 0,fv=typeof clearTimeout=="function"?clearTimeout:void 0,Cd=typeof Promise=="function"?Promise:void 0,dv=typeof queueMicrotask=="function"?queueMicrotask:typeof Cd<"u"?function(n){return Cd.resolve(null).then(n).catch(hv)}:Gc;function hv(n){setTimeout(function(){throw n})}function Yc(n,s){var l=s,d=0;do{var g=l.nextSibling;if(n.removeChild(l),g&&g.nodeType===8)if(l=g.data,l==="/$"){if(d===0){n.removeChild(g),fi(s);return}d--}else l!=="$"&&l!=="$?"&&l!=="$!"||d++;l=g}while(l);fi(s)}function wa(n){for(;n!=null;n=n.nextSibling){var s=n.nodeType;if(s===1||s===3)break;if(s===8){if(s=n.data,s==="$"||s==="$!"||s==="$?")break;if(s==="/$")return null}}return n}function bd(n){n=n.previousSibling;for(var s=0;n;){if(n.nodeType===8){var l=n.data;if(l==="$"||l==="$!"||l==="$?"){if(s===0)return n;s--}else l==="/$"&&s++}n=n.previousSibling}return null}var Cs=Math.random().toString(36).slice(2),Hn="__reactFiber$"+Cs,Ei="__reactProps$"+Cs,Qn="__reactContainer$"+Cs,Kc="__reactEvents$"+Cs,xv="__reactListeners$"+Cs,mv="__reactHandles$"+Cs;function Ga(n){var s=n[Hn];if(s)return s;for(var l=n.parentNode;l;){if(s=l[Qn]||l[Hn]){if(l=s.alternate,s.child!==null||l!==null&&l.child!==null)for(n=bd(n);n!==null;){if(l=n[Hn])return l;n=bd(n)}return s}n=l,l=n.parentNode}return null}function _i(n){return n=n[Hn]||n[Qn],!n||n.tag!==5&&n.tag!==6&&n.tag!==13&&n.tag!==3?null:n}function bs(n){if(n.tag===5||n.tag===6)return n.stateNode;throw Error(t(33))}function Ho(n){return n[Ei]||null}var Qc=[],Ns=-1;function ya(n){return{current:n}}function Mt(n){0>Ns||(n.current=Qc[Ns],Qc[Ns]=null,Ns--)}function jt(n,s){Ns++,Qc[Ns]=n.current,n.current=s}var ka={},Tr=ya(ka),zr=ya(!1),Ya=ka;function As(n,s){var l=n.type.contextTypes;if(!l)return ka;var d=n.stateNode;if(d&&d.__reactInternalMemoizedUnmaskedChildContext===s)return d.__reactInternalMemoizedMaskedChildContext;var g={},k;for(k in l)g[k]=s[k];return d&&(n=n.stateNode,n.__reactInternalMemoizedUnmaskedChildContext=s,n.__reactInternalMemoizedMaskedChildContext=g),g}function Hr(n){return n=n.childContextTypes,n!=null}function Vo(){Mt(zr),Mt(Tr)}function Nd(n,s,l){if(Tr.current!==ka)throw Error(t(168));jt(Tr,s),jt(zr,l)}function Ad(n,s,l){var d=n.stateNode;if(s=s.childContextTypes,typeof d.getChildContext!="function")return l;d=d.getChildContext();for(var g in d)if(!(g in s))throw Error(t(108,ze(n)||"Unknown",g));return q({},l,d)}function Wo(n){return n=(n=n.stateNode)&&n.__reactInternalMemoizedMergedChildContext||ka,Ya=Tr.current,jt(Tr,n),jt(zr,zr.current),!0}function Fd(n,s,l){var d=n.stateNode;if(!d)throw Error(t(169));l?(n=Ad(n,s,Ya),d.__reactInternalMemoizedMergedChildContext=n,Mt(zr),Mt(Tr),jt(Tr,n)):Mt(zr),jt(zr,l)}var qn=null,$o=!1,qc=!1;function Id(n){qn===null?qn=[n]:qn.push(n)}function pv(n){$o=!0,Id(n)}function Ea(){if(!qc&&qn!==null){qc=!0;var n=0,s=Dt;try{var l=qn;for(Dt=1;n<l.length;n++){var d=l[n];do d=d(!0);while(d!==null)}qn=null,$o=!1}catch(g){throw qn!==null&&(qn=qn.slice(n+1)),Me(Rt,Ea),g}finally{Dt=s,qc=!1}}return null}var Fs=[],Is=0,Xo=null,Go=0,fn=[],dn=0,Ka=null,Zn=1,Jn="";function Qa(n,s){Fs[Is++]=Go,Fs[Is++]=Xo,Xo=n,Go=s}function Dd(n,s,l){fn[dn++]=Zn,fn[dn++]=Jn,fn[dn++]=Ka,Ka=n;var d=Zn;n=Jn;var g=32-$t(d)-1;d&=~(1<<g),l+=1;var k=32-$t(s)+g;if(30<k){var b=g-g%5;k=(d&(1<<b)-1).toString(32),d>>=b,g-=b,Zn=1<<32-$t(s)+g|l<<g|d,Jn=k+n}else Zn=1<<k|l<<g|d,Jn=n}function Zc(n){n.return!==null&&(Qa(n,1),Dd(n,1,0))}function Jc(n){for(;n===Xo;)Xo=Fs[--Is],Fs[Is]=null,Go=Fs[--Is],Fs[Is]=null;for(;n===Ka;)Ka=fn[--dn],fn[dn]=null,Jn=fn[--dn],fn[dn]=null,Zn=fn[--dn],fn[dn]=null}var qr=null,Zr=null,Bt=!1,An=null;function Rd(n,s){var l=pn(5,null,null,0);l.elementType="DELETED",l.stateNode=s,l.return=n,s=n.deletions,s===null?(n.deletions=[l],n.flags|=16):s.push(l)}function Pd(n,s){switch(n.tag){case 5:var l=n.type;return s=s.nodeType!==1||l.toLowerCase()!==s.nodeName.toLowerCase()?null:s,s!==null?(n.stateNode=s,qr=n,Zr=wa(s.firstChild),!0):!1;case 6:return s=n.pendingProps===""||s.nodeType!==3?null:s,s!==null?(n.stateNode=s,qr=n,Zr=null,!0):!1;case 13:return s=s.nodeType!==8?null:s,s!==null?(l=Ka!==null?{id:Zn,overflow:Jn}:null,n.memoizedState={dehydrated:s,treeContext:l,retryLane:1073741824},l=pn(18,null,null,0),l.stateNode=s,l.return=n,n.child=l,qr=n,Zr=null,!0):!1;default:return!1}}function e0(n){return(n.mode&1)!==0&&(n.flags&128)===0}function t0(n){if(Bt){var s=Zr;if(s){var l=s;if(!Pd(n,s)){if(e0(n))throw Error(t(418));s=wa(l.nextSibling);var d=qr;s&&Pd(n,s)?Rd(d,l):(n.flags=n.flags&-4097|2,Bt=!1,qr=n)}}else{if(e0(n))throw Error(t(418));n.flags=n.flags&-4097|2,Bt=!1,qr=n}}}function Od(n){for(n=n.return;n!==null&&n.tag!==5&&n.tag!==3&&n.tag!==13;)n=n.return;qr=n}function Yo(n){if(n!==qr)return!1;if(!Bt)return Od(n),Bt=!0,!1;var s;if((s=n.tag!==3)&&!(s=n.tag!==5)&&(s=n.type,s=s!=="head"&&s!=="body"&&!Xc(n.type,n.memoizedProps)),s&&(s=Zr)){if(e0(n))throw jd(),Error(t(418));for(;s;)Rd(n,s),s=wa(s.nextSibling)}if(Od(n),n.tag===13){if(n=n.memoizedState,n=n!==null?n.dehydrated:null,!n)throw Error(t(317));e:{for(n=n.nextSibling,s=0;n;){if(n.nodeType===8){var l=n.data;if(l==="/$"){if(s===0){Zr=wa(n.nextSibling);break e}s--}else l!=="$"&&l!=="$!"&&l!=="$?"||s++}n=n.nextSibling}Zr=null}}else Zr=qr?wa(n.stateNode.nextSibling):null;return!0}function jd(){for(var n=Zr;n;)n=wa(n.nextSibling)}function Ds(){Zr=qr=null,Bt=!1}function r0(n){An===null?An=[n]:An.push(n)}var gv=N.ReactCurrentBatchConfig;function Ti(n,s,l){if(n=l.ref,n!==null&&typeof n!="function"&&typeof n!="object"){if(l._owner){if(l=l._owner,l){if(l.tag!==1)throw Error(t(309));var d=l.stateNode}if(!d)throw Error(t(147,n));var g=d,k=""+n;return s!==null&&s.ref!==null&&typeof s.ref=="function"&&s.ref._stringRef===k?s.ref:(s=function(b){var Y=g.refs;b===null?delete Y[k]:Y[k]=b},s._stringRef=k,s)}if(typeof n!="string")throw Error(t(284));if(!l._owner)throw Error(t(290,n))}return n}function Ko(n,s){throw n=Object.prototype.toString.call(s),Error(t(31,n==="[object Object]"?"object with keys {"+Object.keys(s).join(", ")+"}":n))}function Ld(n){var s=n._init;return s(n._payload)}function Md(n){function s(ue,se){if(n){var me=ue.deletions;me===null?(ue.deletions=[se],ue.flags|=16):me.push(se)}}function l(ue,se){if(!n)return null;for(;se!==null;)s(ue,se),se=se.sibling;return null}function d(ue,se){for(ue=new Map;se!==null;)se.key!==null?ue.set(se.key,se):ue.set(se.index,se),se=se.sibling;return ue}function g(ue,se){return ue=Fa(ue,se),ue.index=0,ue.sibling=null,ue}function k(ue,se,me){return ue.index=me,n?(me=ue.alternate,me!==null?(me=me.index,me<se?(ue.flags|=2,se):me):(ue.flags|=2,se)):(ue.flags|=1048576,se)}function b(ue){return n&&ue.alternate===null&&(ue.flags|=2),ue}function Y(ue,se,me,He){return se===null||se.tag!==6?(se=G0(me,ue.mode,He),se.return=ue,se):(se=g(se,me),se.return=ue,se)}function ne(ue,se,me,He){var nt=me.type;return nt===j?Le(ue,se,me.props.children,He,me.key):se!==null&&(se.elementType===nt||typeof nt=="object"&&nt!==null&&nt.$$typeof===oe&&Ld(nt)===se.type)?(He=g(se,me.props),He.ref=Ti(ue,se,me),He.return=ue,He):(He=wl(me.type,me.key,me.props,null,ue.mode,He),He.ref=Ti(ue,se,me),He.return=ue,He)}function we(ue,se,me,He){return se===null||se.tag!==4||se.stateNode.containerInfo!==me.containerInfo||se.stateNode.implementation!==me.implementation?(se=Y0(me,ue.mode,He),se.return=ue,se):(se=g(se,me.children||[]),se.return=ue,se)}function Le(ue,se,me,He,nt){return se===null||se.tag!==7?(se=as(me,ue.mode,He,nt),se.return=ue,se):(se=g(se,me),se.return=ue,se)}function Be(ue,se,me){if(typeof se=="string"&&se!==""||typeof se=="number")return se=G0(""+se,ue.mode,me),se.return=ue,se;if(typeof se=="object"&&se!==null){switch(se.$$typeof){case B:return me=wl(se.type,se.key,se.props,null,ue.mode,me),me.ref=Ti(ue,null,se),me.return=ue,me;case X:return se=Y0(se,ue.mode,me),se.return=ue,se;case oe:var He=se._init;return Be(ue,He(se._payload),me)}if(ft(se)||ge(se))return se=as(se,ue.mode,me,null),se.return=ue,se;Ko(ue,se)}return null}function Oe(ue,se,me,He){var nt=se!==null?se.key:null;if(typeof me=="string"&&me!==""||typeof me=="number")return nt!==null?null:Y(ue,se,""+me,He);if(typeof me=="object"&&me!==null){switch(me.$$typeof){case B:return me.key===nt?ne(ue,se,me,He):null;case X:return me.key===nt?we(ue,se,me,He):null;case oe:return nt=me._init,Oe(ue,se,nt(me._payload),He)}if(ft(me)||ge(me))return nt!==null?null:Le(ue,se,me,He,null);Ko(ue,me)}return null}function Qe(ue,se,me,He,nt){if(typeof He=="string"&&He!==""||typeof He=="number")return ue=ue.get(me)||null,Y(se,ue,""+He,nt);if(typeof He=="object"&&He!==null){switch(He.$$typeof){case B:return ue=ue.get(He.key===null?me:He.key)||null,ne(se,ue,He,nt);case X:return ue=ue.get(He.key===null?me:He.key)||null,we(se,ue,He,nt);case oe:var ot=He._init;return Qe(ue,se,me,ot(He._payload),nt)}if(ft(He)||ge(He))return ue=ue.get(me)||null,Le(se,ue,He,nt,null);Ko(se,He)}return null}function et(ue,se,me,He){for(var nt=null,ot=null,lt=se,dt=se=0,cr=null;lt!==null&&dt<me.length;dt++){lt.index>dt?(cr=lt,lt=null):cr=lt.sibling;var bt=Oe(ue,lt,me[dt],He);if(bt===null){lt===null&&(lt=cr);break}n&&lt&&bt.alternate===null&&s(ue,lt),se=k(bt,se,dt),ot===null?nt=bt:ot.sibling=bt,ot=bt,lt=cr}if(dt===me.length)return l(ue,lt),Bt&&Qa(ue,dt),nt;if(lt===null){for(;dt<me.length;dt++)lt=Be(ue,me[dt],He),lt!==null&&(se=k(lt,se,dt),ot===null?nt=lt:ot.sibling=lt,ot=lt);return Bt&&Qa(ue,dt),nt}for(lt=d(ue,lt);dt<me.length;dt++)cr=Qe(lt,ue,dt,me[dt],He),cr!==null&&(n&&cr.alternate!==null&&lt.delete(cr.key===null?dt:cr.key),se=k(cr,se,dt),ot===null?nt=cr:ot.sibling=cr,ot=cr);return n&&lt.forEach(function(Ia){return s(ue,Ia)}),Bt&&Qa(ue,dt),nt}function rt(ue,se,me,He){var nt=ge(me);if(typeof nt!="function")throw Error(t(150));if(me=nt.call(me),me==null)throw Error(t(151));for(var ot=nt=null,lt=se,dt=se=0,cr=null,bt=me.next();lt!==null&&!bt.done;dt++,bt=me.next()){lt.index>dt?(cr=lt,lt=null):cr=lt.sibling;var Ia=Oe(ue,lt,bt.value,He);if(Ia===null){lt===null&&(lt=cr);break}n&&lt&&Ia.alternate===null&&s(ue,lt),se=k(Ia,se,dt),ot===null?nt=Ia:ot.sibling=Ia,ot=Ia,lt=cr}if(bt.done)return l(ue,lt),Bt&&Qa(ue,dt),nt;if(lt===null){for(;!bt.done;dt++,bt=me.next())bt=Be(ue,bt.value,He),bt!==null&&(se=k(bt,se,dt),ot===null?nt=bt:ot.sibling=bt,ot=bt);return Bt&&Qa(ue,dt),nt}for(lt=d(ue,lt);!bt.done;dt++,bt=me.next())bt=Qe(lt,ue,dt,bt.value,He),bt!==null&&(n&&bt.alternate!==null&&lt.delete(bt.key===null?dt:bt.key),se=k(bt,se,dt),ot===null?nt=bt:ot.sibling=bt,ot=bt);return n&&lt.forEach(function(Qv){return s(ue,Qv)}),Bt&&Qa(ue,dt),nt}function Xt(ue,se,me,He){if(typeof me=="object"&&me!==null&&me.type===j&&me.key===null&&(me=me.props.children),typeof me=="object"&&me!==null){switch(me.$$typeof){case B:e:{for(var nt=me.key,ot=se;ot!==null;){if(ot.key===nt){if(nt=me.type,nt===j){if(ot.tag===7){l(ue,ot.sibling),se=g(ot,me.props.children),se.return=ue,ue=se;break e}}else if(ot.elementType===nt||typeof nt=="object"&&nt!==null&&nt.$$typeof===oe&&Ld(nt)===ot.type){l(ue,ot.sibling),se=g(ot,me.props),se.ref=Ti(ue,ot,me),se.return=ue,ue=se;break e}l(ue,ot);break}else s(ue,ot);ot=ot.sibling}me.type===j?(se=as(me.props.children,ue.mode,He,me.key),se.return=ue,ue=se):(He=wl(me.type,me.key,me.props,null,ue.mode,He),He.ref=Ti(ue,se,me),He.return=ue,ue=He)}return b(ue);case X:e:{for(ot=me.key;se!==null;){if(se.key===ot)if(se.tag===4&&se.stateNode.containerInfo===me.containerInfo&&se.stateNode.implementation===me.implementation){l(ue,se.sibling),se=g(se,me.children||[]),se.return=ue,ue=se;break e}else{l(ue,se);break}else s(ue,se);se=se.sibling}se=Y0(me,ue.mode,He),se.return=ue,ue=se}return b(ue);case oe:return ot=me._init,Xt(ue,se,ot(me._payload),He)}if(ft(me))return et(ue,se,me,He);if(ge(me))return rt(ue,se,me,He);Ko(ue,me)}return typeof me=="string"&&me!==""||typeof me=="number"?(me=""+me,se!==null&&se.tag===6?(l(ue,se.sibling),se=g(se,me),se.return=ue,ue=se):(l(ue,se),se=G0(me,ue.mode,He),se.return=ue,ue=se),b(ue)):l(ue,se)}return Xt}var Rs=Md(!0),Bd=Md(!1),Qo=ya(null),qo=null,Ps=null,n0=null;function a0(){n0=Ps=qo=null}function s0(n){var s=Qo.current;Mt(Qo),n._currentValue=s}function i0(n,s,l){for(;n!==null;){var d=n.alternate;if((n.childLanes&s)!==s?(n.childLanes|=s,d!==null&&(d.childLanes|=s)):d!==null&&(d.childLanes&s)!==s&&(d.childLanes|=s),n===l)break;n=n.return}}function Os(n,s){qo=n,n0=Ps=null,n=n.dependencies,n!==null&&n.firstContext!==null&&((n.lanes&s)!==0&&(Vr=!0),n.firstContext=null)}function hn(n){var s=n._currentValue;if(n0!==n)if(n={context:n,memoizedValue:s,next:null},Ps===null){if(qo===null)throw Error(t(308));Ps=n,qo.dependencies={lanes:0,firstContext:n}}else Ps=Ps.next=n;return s}var qa=null;function o0(n){qa===null?qa=[n]:qa.push(n)}function Ud(n,s,l,d){var g=s.interleaved;return g===null?(l.next=l,o0(s)):(l.next=g.next,g.next=l),s.interleaved=l,ea(n,d)}function ea(n,s){n.lanes|=s;var l=n.alternate;for(l!==null&&(l.lanes|=s),l=n,n=n.return;n!==null;)n.childLanes|=s,l=n.alternate,l!==null&&(l.childLanes|=s),l=n,n=n.return;return l.tag===3?l.stateNode:null}var _a=!1;function l0(n){n.updateQueue={baseState:n.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function zd(n,s){n=n.updateQueue,s.updateQueue===n&&(s.updateQueue={baseState:n.baseState,firstBaseUpdate:n.firstBaseUpdate,lastBaseUpdate:n.lastBaseUpdate,shared:n.shared,effects:n.effects})}function ta(n,s){return{eventTime:n,lane:s,tag:0,payload:null,callback:null,next:null}}function Ta(n,s,l){var d=n.updateQueue;if(d===null)return null;if(d=d.shared,(St&2)!==0){var g=d.pending;return g===null?s.next=s:(s.next=g.next,g.next=s),d.pending=s,ea(n,l)}return g=d.interleaved,g===null?(s.next=s,o0(d)):(s.next=g.next,g.next=s),d.interleaved=s,ea(n,l)}function Zo(n,s,l){if(s=s.updateQueue,s!==null&&(s=s.shared,(l&4194240)!==0)){var d=s.lanes;d&=n.pendingLanes,l|=d,s.lanes=l,Ec(n,l)}}function Hd(n,s){var l=n.updateQueue,d=n.alternate;if(d!==null&&(d=d.updateQueue,l===d)){var g=null,k=null;if(l=l.firstBaseUpdate,l!==null){do{var b={eventTime:l.eventTime,lane:l.lane,tag:l.tag,payload:l.payload,callback:l.callback,next:null};k===null?g=k=b:k=k.next=b,l=l.next}while(l!==null);k===null?g=k=s:k=k.next=s}else g=k=s;l={baseState:d.baseState,firstBaseUpdate:g,lastBaseUpdate:k,shared:d.shared,effects:d.effects},n.updateQueue=l;return}n=l.lastBaseUpdate,n===null?l.firstBaseUpdate=s:n.next=s,l.lastBaseUpdate=s}function Jo(n,s,l,d){var g=n.updateQueue;_a=!1;var k=g.firstBaseUpdate,b=g.lastBaseUpdate,Y=g.shared.pending;if(Y!==null){g.shared.pending=null;var ne=Y,we=ne.next;ne.next=null,b===null?k=we:b.next=we,b=ne;var Le=n.alternate;Le!==null&&(Le=Le.updateQueue,Y=Le.lastBaseUpdate,Y!==b&&(Y===null?Le.firstBaseUpdate=we:Y.next=we,Le.lastBaseUpdate=ne))}if(k!==null){var Be=g.baseState;b=0,Le=we=ne=null,Y=k;do{var Oe=Y.lane,Qe=Y.eventTime;if((d&Oe)===Oe){Le!==null&&(Le=Le.next={eventTime:Qe,lane:0,tag:Y.tag,payload:Y.payload,callback:Y.callback,next:null});e:{var et=n,rt=Y;switch(Oe=s,Qe=l,rt.tag){case 1:if(et=rt.payload,typeof et=="function"){Be=et.call(Qe,Be,Oe);break e}Be=et;break e;case 3:et.flags=et.flags&-65537|128;case 0:if(et=rt.payload,Oe=typeof et=="function"?et.call(Qe,Be,Oe):et,Oe==null)break e;Be=q({},Be,Oe);break e;case 2:_a=!0}}Y.callback!==null&&Y.lane!==0&&(n.flags|=64,Oe=g.effects,Oe===null?g.effects=[Y]:Oe.push(Y))}else Qe={eventTime:Qe,lane:Oe,tag:Y.tag,payload:Y.payload,callback:Y.callback,next:null},Le===null?(we=Le=Qe,ne=Be):Le=Le.next=Qe,b|=Oe;if(Y=Y.next,Y===null){if(Y=g.shared.pending,Y===null)break;Oe=Y,Y=Oe.next,Oe.next=null,g.lastBaseUpdate=Oe,g.shared.pending=null}}while(!0);if(Le===null&&(ne=Be),g.baseState=ne,g.firstBaseUpdate=we,g.lastBaseUpdate=Le,s=g.shared.interleaved,s!==null){g=s;do b|=g.lane,g=g.next;while(g!==s)}else k===null&&(g.shared.lanes=0);es|=b,n.lanes=b,n.memoizedState=Be}}function Vd(n,s,l){if(n=s.effects,s.effects=null,n!==null)for(s=0;s<n.length;s++){var d=n[s],g=d.callback;if(g!==null){if(d.callback=null,d=l,typeof g!="function")throw Error(t(191,g));g.call(d)}}}var Si={},Vn=ya(Si),Ci=ya(Si),bi=ya(Si);function Za(n){if(n===Si)throw Error(t(174));return n}function c0(n,s){switch(jt(bi,s),jt(Ci,n),jt(Vn,Si),n=s.nodeType,n){case 9:case 11:s=(s=s.documentElement)?s.namespaceURI:Se(null,"");break;default:n=n===8?s.parentNode:s,s=n.namespaceURI||null,n=n.tagName,s=Se(s,n)}Mt(Vn),jt(Vn,s)}function js(){Mt(Vn),Mt(Ci),Mt(bi)}function Wd(n){Za(bi.current);var s=Za(Vn.current),l=Se(s,n.type);s!==l&&(jt(Ci,n),jt(Vn,l))}function u0(n){Ci.current===n&&(Mt(Vn),Mt(Ci))}var Ut=ya(0);function el(n){for(var s=n;s!==null;){if(s.tag===13){var l=s.memoizedState;if(l!==null&&(l=l.dehydrated,l===null||l.data==="$?"||l.data==="$!"))return s}else if(s.tag===19&&s.memoizedProps.revealOrder!==void 0){if((s.flags&128)!==0)return s}else if(s.child!==null){s.child.return=s,s=s.child;continue}if(s===n)break;for(;s.sibling===null;){if(s.return===null||s.return===n)return null;s=s.return}s.sibling.return=s.return,s=s.sibling}return null}var f0=[];function d0(){for(var n=0;n<f0.length;n++)f0[n]._workInProgressVersionPrimary=null;f0.length=0}var tl=N.ReactCurrentDispatcher,h0=N.ReactCurrentBatchConfig,Ja=0,zt=null,tr=null,or=null,rl=!1,Ni=!1,Ai=0,vv=0;function Sr(){throw Error(t(321))}function x0(n,s){if(s===null)return!1;for(var l=0;l<s.length&&l<n.length;l++)if(!Nn(n[l],s[l]))return!1;return!0}function m0(n,s,l,d,g,k){if(Ja=k,zt=s,s.memoizedState=null,s.updateQueue=null,s.lanes=0,tl.current=n===null||n.memoizedState===null?Ev:_v,n=l(d,g),Ni){k=0;do{if(Ni=!1,Ai=0,25<=k)throw Error(t(301));k+=1,or=tr=null,s.updateQueue=null,tl.current=Tv,n=l(d,g)}while(Ni)}if(tl.current=sl,s=tr!==null&&tr.next!==null,Ja=0,or=tr=zt=null,rl=!1,s)throw Error(t(300));return n}function p0(){var n=Ai!==0;return Ai=0,n}function Wn(){var n={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return or===null?zt.memoizedState=or=n:or=or.next=n,or}function xn(){if(tr===null){var n=zt.alternate;n=n!==null?n.memoizedState:null}else n=tr.next;var s=or===null?zt.memoizedState:or.next;if(s!==null)or=s,tr=n;else{if(n===null)throw Error(t(310));tr=n,n={memoizedState:tr.memoizedState,baseState:tr.baseState,baseQueue:tr.baseQueue,queue:tr.queue,next:null},or===null?zt.memoizedState=or=n:or=or.next=n}return or}function Fi(n,s){return typeof s=="function"?s(n):s}function g0(n){var s=xn(),l=s.queue;if(l===null)throw Error(t(311));l.lastRenderedReducer=n;var d=tr,g=d.baseQueue,k=l.pending;if(k!==null){if(g!==null){var b=g.next;g.next=k.next,k.next=b}d.baseQueue=g=k,l.pending=null}if(g!==null){k=g.next,d=d.baseState;var Y=b=null,ne=null,we=k;do{var Le=we.lane;if((Ja&Le)===Le)ne!==null&&(ne=ne.next={lane:0,action:we.action,hasEagerState:we.hasEagerState,eagerState:we.eagerState,next:null}),d=we.hasEagerState?we.eagerState:n(d,we.action);else{var Be={lane:Le,action:we.action,hasEagerState:we.hasEagerState,eagerState:we.eagerState,next:null};ne===null?(Y=ne=Be,b=d):ne=ne.next=Be,zt.lanes|=Le,es|=Le}we=we.next}while(we!==null&&we!==k);ne===null?b=d:ne.next=Y,Nn(d,s.memoizedState)||(Vr=!0),s.memoizedState=d,s.baseState=b,s.baseQueue=ne,l.lastRenderedState=d}if(n=l.interleaved,n!==null){g=n;do k=g.lane,zt.lanes|=k,es|=k,g=g.next;while(g!==n)}else g===null&&(l.lanes=0);return[s.memoizedState,l.dispatch]}function v0(n){var s=xn(),l=s.queue;if(l===null)throw Error(t(311));l.lastRenderedReducer=n;var d=l.dispatch,g=l.pending,k=s.memoizedState;if(g!==null){l.pending=null;var b=g=g.next;do k=n(k,b.action),b=b.next;while(b!==g);Nn(k,s.memoizedState)||(Vr=!0),s.memoizedState=k,s.baseQueue===null&&(s.baseState=k),l.lastRenderedState=k}return[k,d]}function $d(){}function Xd(n,s){var l=zt,d=xn(),g=s(),k=!Nn(d.memoizedState,g);if(k&&(d.memoizedState=g,Vr=!0),d=d.queue,w0(Kd.bind(null,l,d,n),[n]),d.getSnapshot!==s||k||or!==null&&or.memoizedState.tag&1){if(l.flags|=2048,Ii(9,Yd.bind(null,l,d,g,s),void 0,null),lr===null)throw Error(t(349));(Ja&30)!==0||Gd(l,s,g)}return g}function Gd(n,s,l){n.flags|=16384,n={getSnapshot:s,value:l},s=zt.updateQueue,s===null?(s={lastEffect:null,stores:null},zt.updateQueue=s,s.stores=[n]):(l=s.stores,l===null?s.stores=[n]:l.push(n))}function Yd(n,s,l,d){s.value=l,s.getSnapshot=d,Qd(s)&&qd(n)}function Kd(n,s,l){return l(function(){Qd(s)&&qd(n)})}function Qd(n){var s=n.getSnapshot;n=n.value;try{var l=s();return!Nn(n,l)}catch{return!0}}function qd(n){var s=ea(n,1);s!==null&&Rn(s,n,1,-1)}function Zd(n){var s=Wn();return typeof n=="function"&&(n=n()),s.memoizedState=s.baseState=n,n={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Fi,lastRenderedState:n},s.queue=n,n=n.dispatch=kv.bind(null,zt,n),[s.memoizedState,n]}function Ii(n,s,l,d){return n={tag:n,create:s,destroy:l,deps:d,next:null},s=zt.updateQueue,s===null?(s={lastEffect:null,stores:null},zt.updateQueue=s,s.lastEffect=n.next=n):(l=s.lastEffect,l===null?s.lastEffect=n.next=n:(d=l.next,l.next=n,n.next=d,s.lastEffect=n)),n}function Jd(){return xn().memoizedState}function nl(n,s,l,d){var g=Wn();zt.flags|=n,g.memoizedState=Ii(1|s,l,void 0,d===void 0?null:d)}function al(n,s,l,d){var g=xn();d=d===void 0?null:d;var k=void 0;if(tr!==null){var b=tr.memoizedState;if(k=b.destroy,d!==null&&x0(d,b.deps)){g.memoizedState=Ii(s,l,k,d);return}}zt.flags|=n,g.memoizedState=Ii(1|s,l,k,d)}function eh(n,s){return nl(8390656,8,n,s)}function w0(n,s){return al(2048,8,n,s)}function th(n,s){return al(4,2,n,s)}function rh(n,s){return al(4,4,n,s)}function nh(n,s){if(typeof s=="function")return n=n(),s(n),function(){s(null)};if(s!=null)return n=n(),s.current=n,function(){s.current=null}}function ah(n,s,l){return l=l!=null?l.concat([n]):null,al(4,4,nh.bind(null,s,n),l)}function y0(){}function sh(n,s){var l=xn();s=s===void 0?null:s;var d=l.memoizedState;return d!==null&&s!==null&&x0(s,d[1])?d[0]:(l.memoizedState=[n,s],n)}function ih(n,s){var l=xn();s=s===void 0?null:s;var d=l.memoizedState;return d!==null&&s!==null&&x0(s,d[1])?d[0]:(n=n(),l.memoizedState=[n,s],n)}function oh(n,s,l){return(Ja&21)===0?(n.baseState&&(n.baseState=!1,Vr=!0),n.memoizedState=l):(Nn(l,s)||(l=Lf(),zt.lanes|=l,es|=l,n.baseState=!0),s)}function wv(n,s){var l=Dt;Dt=l!==0&&4>l?l:4,n(!0);var d=h0.transition;h0.transition={};try{n(!1),s()}finally{Dt=l,h0.transition=d}}function lh(){return xn().memoizedState}function yv(n,s,l){var d=Na(n);if(l={lane:d,action:l,hasEagerState:!1,eagerState:null,next:null},ch(n))uh(s,l);else if(l=Ud(n,s,l,d),l!==null){var g=Or();Rn(l,n,d,g),fh(l,s,d)}}function kv(n,s,l){var d=Na(n),g={lane:d,action:l,hasEagerState:!1,eagerState:null,next:null};if(ch(n))uh(s,g);else{var k=n.alternate;if(n.lanes===0&&(k===null||k.lanes===0)&&(k=s.lastRenderedReducer,k!==null))try{var b=s.lastRenderedState,Y=k(b,l);if(g.hasEagerState=!0,g.eagerState=Y,Nn(Y,b)){var ne=s.interleaved;ne===null?(g.next=g,o0(s)):(g.next=ne.next,ne.next=g),s.interleaved=g;return}}catch{}finally{}l=Ud(n,s,g,d),l!==null&&(g=Or(),Rn(l,n,d,g),fh(l,s,d))}}function ch(n){var s=n.alternate;return n===zt||s!==null&&s===zt}function uh(n,s){Ni=rl=!0;var l=n.pending;l===null?s.next=s:(s.next=l.next,l.next=s),n.pending=s}function fh(n,s,l){if((l&4194240)!==0){var d=s.lanes;d&=n.pendingLanes,l|=d,s.lanes=l,Ec(n,l)}}var sl={readContext:hn,useCallback:Sr,useContext:Sr,useEffect:Sr,useImperativeHandle:Sr,useInsertionEffect:Sr,useLayoutEffect:Sr,useMemo:Sr,useReducer:Sr,useRef:Sr,useState:Sr,useDebugValue:Sr,useDeferredValue:Sr,useTransition:Sr,useMutableSource:Sr,useSyncExternalStore:Sr,useId:Sr,unstable_isNewReconciler:!1},Ev={readContext:hn,useCallback:function(n,s){return Wn().memoizedState=[n,s===void 0?null:s],n},useContext:hn,useEffect:eh,useImperativeHandle:function(n,s,l){return l=l!=null?l.concat([n]):null,nl(4194308,4,nh.bind(null,s,n),l)},useLayoutEffect:function(n,s){return nl(4194308,4,n,s)},useInsertionEffect:function(n,s){return nl(4,2,n,s)},useMemo:function(n,s){var l=Wn();return s=s===void 0?null:s,n=n(),l.memoizedState=[n,s],n},useReducer:function(n,s,l){var d=Wn();return s=l!==void 0?l(s):s,d.memoizedState=d.baseState=s,n={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:n,lastRenderedState:s},d.queue=n,n=n.dispatch=yv.bind(null,zt,n),[d.memoizedState,n]},useRef:function(n){var s=Wn();return n={current:n},s.memoizedState=n},useState:Zd,useDebugValue:y0,useDeferredValue:function(n){return Wn().memoizedState=n},useTransition:function(){var n=Zd(!1),s=n[0];return n=wv.bind(null,n[1]),Wn().memoizedState=n,[s,n]},useMutableSource:function(){},useSyncExternalStore:function(n,s,l){var d=zt,g=Wn();if(Bt){if(l===void 0)throw Error(t(407));l=l()}else{if(l=s(),lr===null)throw Error(t(349));(Ja&30)!==0||Gd(d,s,l)}g.memoizedState=l;var k={value:l,getSnapshot:s};return g.queue=k,eh(Kd.bind(null,d,k,n),[n]),d.flags|=2048,Ii(9,Yd.bind(null,d,k,l,s),void 0,null),l},useId:function(){var n=Wn(),s=lr.identifierPrefix;if(Bt){var l=Jn,d=Zn;l=(d&~(1<<32-$t(d)-1)).toString(32)+l,s=":"+s+"R"+l,l=Ai++,0<l&&(s+="H"+l.toString(32)),s+=":"}else l=vv++,s=":"+s+"r"+l.toString(32)+":";return n.memoizedState=s},unstable_isNewReconciler:!1},_v={readContext:hn,useCallback:sh,useContext:hn,useEffect:w0,useImperativeHandle:ah,useInsertionEffect:th,useLayoutEffect:rh,useMemo:ih,useReducer:g0,useRef:Jd,useState:function(){return g0(Fi)},useDebugValue:y0,useDeferredValue:function(n){var s=xn();return oh(s,tr.memoizedState,n)},useTransition:function(){var n=g0(Fi)[0],s=xn().memoizedState;return[n,s]},useMutableSource:$d,useSyncExternalStore:Xd,useId:lh,unstable_isNewReconciler:!1},Tv={readContext:hn,useCallback:sh,useContext:hn,useEffect:w0,useImperativeHandle:ah,useInsertionEffect:th,useLayoutEffect:rh,useMemo:ih,useReducer:v0,useRef:Jd,useState:function(){return v0(Fi)},useDebugValue:y0,useDeferredValue:function(n){var s=xn();return tr===null?s.memoizedState=n:oh(s,tr.memoizedState,n)},useTransition:function(){var n=v0(Fi)[0],s=xn().memoizedState;return[n,s]},useMutableSource:$d,useSyncExternalStore:Xd,useId:lh,unstable_isNewReconciler:!1};function Fn(n,s){if(n&&n.defaultProps){s=q({},s),n=n.defaultProps;for(var l in n)s[l]===void 0&&(s[l]=n[l]);return s}return s}function k0(n,s,l,d){s=n.memoizedState,l=l(d,s),l=l==null?s:q({},s,l),n.memoizedState=l,n.lanes===0&&(n.updateQueue.baseState=l)}var il={isMounted:function(n){return(n=n._reactInternals)?W(n)===n:!1},enqueueSetState:function(n,s,l){n=n._reactInternals;var d=Or(),g=Na(n),k=ta(d,g);k.payload=s,l!=null&&(k.callback=l),s=Ta(n,k,g),s!==null&&(Rn(s,n,g,d),Zo(s,n,g))},enqueueReplaceState:function(n,s,l){n=n._reactInternals;var d=Or(),g=Na(n),k=ta(d,g);k.tag=1,k.payload=s,l!=null&&(k.callback=l),s=Ta(n,k,g),s!==null&&(Rn(s,n,g,d),Zo(s,n,g))},enqueueForceUpdate:function(n,s){n=n._reactInternals;var l=Or(),d=Na(n),g=ta(l,d);g.tag=2,s!=null&&(g.callback=s),s=Ta(n,g,d),s!==null&&(Rn(s,n,d,l),Zo(s,n,d))}};function dh(n,s,l,d,g,k,b){return n=n.stateNode,typeof n.shouldComponentUpdate=="function"?n.shouldComponentUpdate(d,k,b):s.prototype&&s.prototype.isPureReactComponent?!gi(l,d)||!gi(g,k):!0}function hh(n,s,l){var d=!1,g=ka,k=s.contextType;return typeof k=="object"&&k!==null?k=hn(k):(g=Hr(s)?Ya:Tr.current,d=s.contextTypes,k=(d=d!=null)?As(n,g):ka),s=new s(l,k),n.memoizedState=s.state!==null&&s.state!==void 0?s.state:null,s.updater=il,n.stateNode=s,s._reactInternals=n,d&&(n=n.stateNode,n.__reactInternalMemoizedUnmaskedChildContext=g,n.__reactInternalMemoizedMaskedChildContext=k),s}function xh(n,s,l,d){n=s.state,typeof s.componentWillReceiveProps=="function"&&s.componentWillReceiveProps(l,d),typeof s.UNSAFE_componentWillReceiveProps=="function"&&s.UNSAFE_componentWillReceiveProps(l,d),s.state!==n&&il.enqueueReplaceState(s,s.state,null)}function E0(n,s,l,d){var g=n.stateNode;g.props=l,g.state=n.memoizedState,g.refs={},l0(n);var k=s.contextType;typeof k=="object"&&k!==null?g.context=hn(k):(k=Hr(s)?Ya:Tr.current,g.context=As(n,k)),g.state=n.memoizedState,k=s.getDerivedStateFromProps,typeof k=="function"&&(k0(n,s,k,l),g.state=n.memoizedState),typeof s.getDerivedStateFromProps=="function"||typeof g.getSnapshotBeforeUpdate=="function"||typeof g.UNSAFE_componentWillMount!="function"&&typeof g.componentWillMount!="function"||(s=g.state,typeof g.componentWillMount=="function"&&g.componentWillMount(),typeof g.UNSAFE_componentWillMount=="function"&&g.UNSAFE_componentWillMount(),s!==g.state&&il.enqueueReplaceState(g,g.state,null),Jo(n,l,g,d),g.state=n.memoizedState),typeof g.componentDidMount=="function"&&(n.flags|=4194308)}function Ls(n,s){try{var l="",d=s;do l+=Ae(d),d=d.return;while(d);var g=l}catch(k){g=`
Error generating stack: `+k.message+`
`+k.stack}return{value:n,source:s,stack:g,digest:null}}function _0(n,s,l){return{value:n,source:null,stack:l??null,digest:s??null}}function T0(n,s){try{console.error(s.value)}catch(l){setTimeout(function(){throw l})}}var Sv=typeof WeakMap=="function"?WeakMap:Map;function mh(n,s,l){l=ta(-1,l),l.tag=3,l.payload={element:null};var d=s.value;return l.callback=function(){hl||(hl=!0,B0=d),T0(n,s)},l}function ph(n,s,l){l=ta(-1,l),l.tag=3;var d=n.type.getDerivedStateFromError;if(typeof d=="function"){var g=s.value;l.payload=function(){return d(g)},l.callback=function(){T0(n,s)}}var k=n.stateNode;return k!==null&&typeof k.componentDidCatch=="function"&&(l.callback=function(){T0(n,s),typeof d!="function"&&(Ca===null?Ca=new Set([this]):Ca.add(this));var b=s.stack;this.componentDidCatch(s.value,{componentStack:b!==null?b:""})}),l}function gh(n,s,l){var d=n.pingCache;if(d===null){d=n.pingCache=new Sv;var g=new Set;d.set(s,g)}else g=d.get(s),g===void 0&&(g=new Set,d.set(s,g));g.has(l)||(g.add(l),n=Bv.bind(null,n,s,l),s.then(n,n))}function vh(n){do{var s;if((s=n.tag===13)&&(s=n.memoizedState,s=s!==null?s.dehydrated!==null:!0),s)return n;n=n.return}while(n!==null);return null}function wh(n,s,l,d,g){return(n.mode&1)===0?(n===s?n.flags|=65536:(n.flags|=128,l.flags|=131072,l.flags&=-52805,l.tag===1&&(l.alternate===null?l.tag=17:(s=ta(-1,1),s.tag=2,Ta(l,s,1))),l.lanes|=1),n):(n.flags|=65536,n.lanes=g,n)}var Cv=N.ReactCurrentOwner,Vr=!1;function Pr(n,s,l,d){s.child=n===null?Bd(s,null,l,d):Rs(s,n.child,l,d)}function yh(n,s,l,d,g){l=l.render;var k=s.ref;return Os(s,g),d=m0(n,s,l,d,k,g),l=p0(),n!==null&&!Vr?(s.updateQueue=n.updateQueue,s.flags&=-2053,n.lanes&=~g,ra(n,s,g)):(Bt&&l&&Zc(s),s.flags|=1,Pr(n,s,d,g),s.child)}function kh(n,s,l,d,g){if(n===null){var k=l.type;return typeof k=="function"&&!X0(k)&&k.defaultProps===void 0&&l.compare===null&&l.defaultProps===void 0?(s.tag=15,s.type=k,Eh(n,s,k,d,g)):(n=wl(l.type,null,d,s,s.mode,g),n.ref=s.ref,n.return=s,s.child=n)}if(k=n.child,(n.lanes&g)===0){var b=k.memoizedProps;if(l=l.compare,l=l!==null?l:gi,l(b,d)&&n.ref===s.ref)return ra(n,s,g)}return s.flags|=1,n=Fa(k,d),n.ref=s.ref,n.return=s,s.child=n}function Eh(n,s,l,d,g){if(n!==null){var k=n.memoizedProps;if(gi(k,d)&&n.ref===s.ref)if(Vr=!1,s.pendingProps=d=k,(n.lanes&g)!==0)(n.flags&131072)!==0&&(Vr=!0);else return s.lanes=n.lanes,ra(n,s,g)}return S0(n,s,l,d,g)}function _h(n,s,l){var d=s.pendingProps,g=d.children,k=n!==null?n.memoizedState:null;if(d.mode==="hidden")if((s.mode&1)===0)s.memoizedState={baseLanes:0,cachePool:null,transitions:null},jt(Bs,Jr),Jr|=l;else{if((l&1073741824)===0)return n=k!==null?k.baseLanes|l:l,s.lanes=s.childLanes=1073741824,s.memoizedState={baseLanes:n,cachePool:null,transitions:null},s.updateQueue=null,jt(Bs,Jr),Jr|=n,null;s.memoizedState={baseLanes:0,cachePool:null,transitions:null},d=k!==null?k.baseLanes:l,jt(Bs,Jr),Jr|=d}else k!==null?(d=k.baseLanes|l,s.memoizedState=null):d=l,jt(Bs,Jr),Jr|=d;return Pr(n,s,g,l),s.child}function Th(n,s){var l=s.ref;(n===null&&l!==null||n!==null&&n.ref!==l)&&(s.flags|=512,s.flags|=2097152)}function S0(n,s,l,d,g){var k=Hr(l)?Ya:Tr.current;return k=As(s,k),Os(s,g),l=m0(n,s,l,d,k,g),d=p0(),n!==null&&!Vr?(s.updateQueue=n.updateQueue,s.flags&=-2053,n.lanes&=~g,ra(n,s,g)):(Bt&&d&&Zc(s),s.flags|=1,Pr(n,s,l,g),s.child)}function Sh(n,s,l,d,g){if(Hr(l)){var k=!0;Wo(s)}else k=!1;if(Os(s,g),s.stateNode===null)ll(n,s),hh(s,l,d),E0(s,l,d,g),d=!0;else if(n===null){var b=s.stateNode,Y=s.memoizedProps;b.props=Y;var ne=b.context,we=l.contextType;typeof we=="object"&&we!==null?we=hn(we):(we=Hr(l)?Ya:Tr.current,we=As(s,we));var Le=l.getDerivedStateFromProps,Be=typeof Le=="function"||typeof b.getSnapshotBeforeUpdate=="function";Be||typeof b.UNSAFE_componentWillReceiveProps!="function"&&typeof b.componentWillReceiveProps!="function"||(Y!==d||ne!==we)&&xh(s,b,d,we),_a=!1;var Oe=s.memoizedState;b.state=Oe,Jo(s,d,b,g),ne=s.memoizedState,Y!==d||Oe!==ne||zr.current||_a?(typeof Le=="function"&&(k0(s,l,Le,d),ne=s.memoizedState),(Y=_a||dh(s,l,Y,d,Oe,ne,we))?(Be||typeof b.UNSAFE_componentWillMount!="function"&&typeof b.componentWillMount!="function"||(typeof b.componentWillMount=="function"&&b.componentWillMount(),typeof b.UNSAFE_componentWillMount=="function"&&b.UNSAFE_componentWillMount()),typeof b.componentDidMount=="function"&&(s.flags|=4194308)):(typeof b.componentDidMount=="function"&&(s.flags|=4194308),s.memoizedProps=d,s.memoizedState=ne),b.props=d,b.state=ne,b.context=we,d=Y):(typeof b.componentDidMount=="function"&&(s.flags|=4194308),d=!1)}else{b=s.stateNode,zd(n,s),Y=s.memoizedProps,we=s.type===s.elementType?Y:Fn(s.type,Y),b.props=we,Be=s.pendingProps,Oe=b.context,ne=l.contextType,typeof ne=="object"&&ne!==null?ne=hn(ne):(ne=Hr(l)?Ya:Tr.current,ne=As(s,ne));var Qe=l.getDerivedStateFromProps;(Le=typeof Qe=="function"||typeof b.getSnapshotBeforeUpdate=="function")||typeof b.UNSAFE_componentWillReceiveProps!="function"&&typeof b.componentWillReceiveProps!="function"||(Y!==Be||Oe!==ne)&&xh(s,b,d,ne),_a=!1,Oe=s.memoizedState,b.state=Oe,Jo(s,d,b,g);var et=s.memoizedState;Y!==Be||Oe!==et||zr.current||_a?(typeof Qe=="function"&&(k0(s,l,Qe,d),et=s.memoizedState),(we=_a||dh(s,l,we,d,Oe,et,ne)||!1)?(Le||typeof b.UNSAFE_componentWillUpdate!="function"&&typeof b.componentWillUpdate!="function"||(typeof b.componentWillUpdate=="function"&&b.componentWillUpdate(d,et,ne),typeof b.UNSAFE_componentWillUpdate=="function"&&b.UNSAFE_componentWillUpdate(d,et,ne)),typeof b.componentDidUpdate=="function"&&(s.flags|=4),typeof b.getSnapshotBeforeUpdate=="function"&&(s.flags|=1024)):(typeof b.componentDidUpdate!="function"||Y===n.memoizedProps&&Oe===n.memoizedState||(s.flags|=4),typeof b.getSnapshotBeforeUpdate!="function"||Y===n.memoizedProps&&Oe===n.memoizedState||(s.flags|=1024),s.memoizedProps=d,s.memoizedState=et),b.props=d,b.state=et,b.context=ne,d=we):(typeof b.componentDidUpdate!="function"||Y===n.memoizedProps&&Oe===n.memoizedState||(s.flags|=4),typeof b.getSnapshotBeforeUpdate!="function"||Y===n.memoizedProps&&Oe===n.memoizedState||(s.flags|=1024),d=!1)}return C0(n,s,l,d,k,g)}function C0(n,s,l,d,g,k){Th(n,s);var b=(s.flags&128)!==0;if(!d&&!b)return g&&Fd(s,l,!1),ra(n,s,k);d=s.stateNode,Cv.current=s;var Y=b&&typeof l.getDerivedStateFromError!="function"?null:d.render();return s.flags|=1,n!==null&&b?(s.child=Rs(s,n.child,null,k),s.child=Rs(s,null,Y,k)):Pr(n,s,Y,k),s.memoizedState=d.state,g&&Fd(s,l,!0),s.child}function Ch(n){var s=n.stateNode;s.pendingContext?Nd(n,s.pendingContext,s.pendingContext!==s.context):s.context&&Nd(n,s.context,!1),c0(n,s.containerInfo)}function bh(n,s,l,d,g){return Ds(),r0(g),s.flags|=256,Pr(n,s,l,d),s.child}var b0={dehydrated:null,treeContext:null,retryLane:0};function N0(n){return{baseLanes:n,cachePool:null,transitions:null}}function Nh(n,s,l){var d=s.pendingProps,g=Ut.current,k=!1,b=(s.flags&128)!==0,Y;if((Y=b)||(Y=n!==null&&n.memoizedState===null?!1:(g&2)!==0),Y?(k=!0,s.flags&=-129):(n===null||n.memoizedState!==null)&&(g|=1),jt(Ut,g&1),n===null)return t0(s),n=s.memoizedState,n!==null&&(n=n.dehydrated,n!==null)?((s.mode&1)===0?s.lanes=1:n.data==="$!"?s.lanes=8:s.lanes=1073741824,null):(b=d.children,n=d.fallback,k?(d=s.mode,k=s.child,b={mode:"hidden",children:b},(d&1)===0&&k!==null?(k.childLanes=0,k.pendingProps=b):k=yl(b,d,0,null),n=as(n,d,l,null),k.return=s,n.return=s,k.sibling=n,s.child=k,s.child.memoizedState=N0(l),s.memoizedState=b0,n):A0(s,b));if(g=n.memoizedState,g!==null&&(Y=g.dehydrated,Y!==null))return bv(n,s,b,d,Y,g,l);if(k){k=d.fallback,b=s.mode,g=n.child,Y=g.sibling;var ne={mode:"hidden",children:d.children};return(b&1)===0&&s.child!==g?(d=s.child,d.childLanes=0,d.pendingProps=ne,s.deletions=null):(d=Fa(g,ne),d.subtreeFlags=g.subtreeFlags&14680064),Y!==null?k=Fa(Y,k):(k=as(k,b,l,null),k.flags|=2),k.return=s,d.return=s,d.sibling=k,s.child=d,d=k,k=s.child,b=n.child.memoizedState,b=b===null?N0(l):{baseLanes:b.baseLanes|l,cachePool:null,transitions:b.transitions},k.memoizedState=b,k.childLanes=n.childLanes&~l,s.memoizedState=b0,d}return k=n.child,n=k.sibling,d=Fa(k,{mode:"visible",children:d.children}),(s.mode&1)===0&&(d.lanes=l),d.return=s,d.sibling=null,n!==null&&(l=s.deletions,l===null?(s.deletions=[n],s.flags|=16):l.push(n)),s.child=d,s.memoizedState=null,d}function A0(n,s){return s=yl({mode:"visible",children:s},n.mode,0,null),s.return=n,n.child=s}function ol(n,s,l,d){return d!==null&&r0(d),Rs(s,n.child,null,l),n=A0(s,s.pendingProps.children),n.flags|=2,s.memoizedState=null,n}function bv(n,s,l,d,g,k,b){if(l)return s.flags&256?(s.flags&=-257,d=_0(Error(t(422))),ol(n,s,b,d)):s.memoizedState!==null?(s.child=n.child,s.flags|=128,null):(k=d.fallback,g=s.mode,d=yl({mode:"visible",children:d.children},g,0,null),k=as(k,g,b,null),k.flags|=2,d.return=s,k.return=s,d.sibling=k,s.child=d,(s.mode&1)!==0&&Rs(s,n.child,null,b),s.child.memoizedState=N0(b),s.memoizedState=b0,k);if((s.mode&1)===0)return ol(n,s,b,null);if(g.data==="$!"){if(d=g.nextSibling&&g.nextSibling.dataset,d)var Y=d.dgst;return d=Y,k=Error(t(419)),d=_0(k,d,void 0),ol(n,s,b,d)}if(Y=(b&n.childLanes)!==0,Vr||Y){if(d=lr,d!==null){switch(b&-b){case 4:g=2;break;case 16:g=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:g=32;break;case 536870912:g=268435456;break;default:g=0}g=(g&(d.suspendedLanes|b))!==0?0:g,g!==0&&g!==k.retryLane&&(k.retryLane=g,ea(n,g),Rn(d,n,g,-1))}return $0(),d=_0(Error(t(421))),ol(n,s,b,d)}return g.data==="$?"?(s.flags|=128,s.child=n.child,s=Uv.bind(null,n),g._reactRetry=s,null):(n=k.treeContext,Zr=wa(g.nextSibling),qr=s,Bt=!0,An=null,n!==null&&(fn[dn++]=Zn,fn[dn++]=Jn,fn[dn++]=Ka,Zn=n.id,Jn=n.overflow,Ka=s),s=A0(s,d.children),s.flags|=4096,s)}function Ah(n,s,l){n.lanes|=s;var d=n.alternate;d!==null&&(d.lanes|=s),i0(n.return,s,l)}function F0(n,s,l,d,g){var k=n.memoizedState;k===null?n.memoizedState={isBackwards:s,rendering:null,renderingStartTime:0,last:d,tail:l,tailMode:g}:(k.isBackwards=s,k.rendering=null,k.renderingStartTime=0,k.last=d,k.tail=l,k.tailMode=g)}function Fh(n,s,l){var d=s.pendingProps,g=d.revealOrder,k=d.tail;if(Pr(n,s,d.children,l),d=Ut.current,(d&2)!==0)d=d&1|2,s.flags|=128;else{if(n!==null&&(n.flags&128)!==0)e:for(n=s.child;n!==null;){if(n.tag===13)n.memoizedState!==null&&Ah(n,l,s);else if(n.tag===19)Ah(n,l,s);else if(n.child!==null){n.child.return=n,n=n.child;continue}if(n===s)break e;for(;n.sibling===null;){if(n.return===null||n.return===s)break e;n=n.return}n.sibling.return=n.return,n=n.sibling}d&=1}if(jt(Ut,d),(s.mode&1)===0)s.memoizedState=null;else switch(g){case"forwards":for(l=s.child,g=null;l!==null;)n=l.alternate,n!==null&&el(n)===null&&(g=l),l=l.sibling;l=g,l===null?(g=s.child,s.child=null):(g=l.sibling,l.sibling=null),F0(s,!1,g,l,k);break;case"backwards":for(l=null,g=s.child,s.child=null;g!==null;){if(n=g.alternate,n!==null&&el(n)===null){s.child=g;break}n=g.sibling,g.sibling=l,l=g,g=n}F0(s,!0,l,null,k);break;case"together":F0(s,!1,null,null,void 0);break;default:s.memoizedState=null}return s.child}function ll(n,s){(s.mode&1)===0&&n!==null&&(n.alternate=null,s.alternate=null,s.flags|=2)}function ra(n,s,l){if(n!==null&&(s.dependencies=n.dependencies),es|=s.lanes,(l&s.childLanes)===0)return null;if(n!==null&&s.child!==n.child)throw Error(t(153));if(s.child!==null){for(n=s.child,l=Fa(n,n.pendingProps),s.child=l,l.return=s;n.sibling!==null;)n=n.sibling,l=l.sibling=Fa(n,n.pendingProps),l.return=s;l.sibling=null}return s.child}function Nv(n,s,l){switch(s.tag){case 3:Ch(s),Ds();break;case 5:Wd(s);break;case 1:Hr(s.type)&&Wo(s);break;case 4:c0(s,s.stateNode.containerInfo);break;case 10:var d=s.type._context,g=s.memoizedProps.value;jt(Qo,d._currentValue),d._currentValue=g;break;case 13:if(d=s.memoizedState,d!==null)return d.dehydrated!==null?(jt(Ut,Ut.current&1),s.flags|=128,null):(l&s.child.childLanes)!==0?Nh(n,s,l):(jt(Ut,Ut.current&1),n=ra(n,s,l),n!==null?n.sibling:null);jt(Ut,Ut.current&1);break;case 19:if(d=(l&s.childLanes)!==0,(n.flags&128)!==0){if(d)return Fh(n,s,l);s.flags|=128}if(g=s.memoizedState,g!==null&&(g.rendering=null,g.tail=null,g.lastEffect=null),jt(Ut,Ut.current),d)break;return null;case 22:case 23:return s.lanes=0,_h(n,s,l)}return ra(n,s,l)}var Ih,I0,Dh,Rh;Ih=function(n,s){for(var l=s.child;l!==null;){if(l.tag===5||l.tag===6)n.appendChild(l.stateNode);else if(l.tag!==4&&l.child!==null){l.child.return=l,l=l.child;continue}if(l===s)break;for(;l.sibling===null;){if(l.return===null||l.return===s)return;l=l.return}l.sibling.return=l.return,l=l.sibling}},I0=function(){},Dh=function(n,s,l,d){var g=n.memoizedProps;if(g!==d){n=s.stateNode,Za(Vn.current);var k=null;switch(l){case"input":g=ke(n,g),d=ke(n,d),k=[];break;case"select":g=q({},g,{value:void 0}),d=q({},d,{value:void 0}),k=[];break;case"textarea":g=ye(n,g),d=ye(n,d),k=[];break;default:typeof g.onClick!="function"&&typeof d.onClick=="function"&&(n.onclick=zo)}_r(l,d);var b;l=null;for(we in g)if(!d.hasOwnProperty(we)&&g.hasOwnProperty(we)&&g[we]!=null)if(we==="style"){var Y=g[we];for(b in Y)Y.hasOwnProperty(b)&&(l||(l={}),l[b]="")}else we!=="dangerouslySetInnerHTML"&&we!=="children"&&we!=="suppressContentEditableWarning"&&we!=="suppressHydrationWarning"&&we!=="autoFocus"&&(i.hasOwnProperty(we)?k||(k=[]):(k=k||[]).push(we,null));for(we in d){var ne=d[we];if(Y=g!=null?g[we]:void 0,d.hasOwnProperty(we)&&ne!==Y&&(ne!=null||Y!=null))if(we==="style")if(Y){for(b in Y)!Y.hasOwnProperty(b)||ne&&ne.hasOwnProperty(b)||(l||(l={}),l[b]="");for(b in ne)ne.hasOwnProperty(b)&&Y[b]!==ne[b]&&(l||(l={}),l[b]=ne[b])}else l||(k||(k=[]),k.push(we,l)),l=ne;else we==="dangerouslySetInnerHTML"?(ne=ne?ne.__html:void 0,Y=Y?Y.__html:void 0,ne!=null&&Y!==ne&&(k=k||[]).push(we,ne)):we==="children"?typeof ne!="string"&&typeof ne!="number"||(k=k||[]).push(we,""+ne):we!=="suppressContentEditableWarning"&&we!=="suppressHydrationWarning"&&(i.hasOwnProperty(we)?(ne!=null&&we==="onScroll"&&Lt("scroll",n),k||Y===ne||(k=[])):(k=k||[]).push(we,ne))}l&&(k=k||[]).push("style",l);var we=k;(s.updateQueue=we)&&(s.flags|=4)}},Rh=function(n,s,l,d){l!==d&&(s.flags|=4)};function Di(n,s){if(!Bt)switch(n.tailMode){case"hidden":s=n.tail;for(var l=null;s!==null;)s.alternate!==null&&(l=s),s=s.sibling;l===null?n.tail=null:l.sibling=null;break;case"collapsed":l=n.tail;for(var d=null;l!==null;)l.alternate!==null&&(d=l),l=l.sibling;d===null?s||n.tail===null?n.tail=null:n.tail.sibling=null:d.sibling=null}}function Cr(n){var s=n.alternate!==null&&n.alternate.child===n.child,l=0,d=0;if(s)for(var g=n.child;g!==null;)l|=g.lanes|g.childLanes,d|=g.subtreeFlags&14680064,d|=g.flags&14680064,g.return=n,g=g.sibling;else for(g=n.child;g!==null;)l|=g.lanes|g.childLanes,d|=g.subtreeFlags,d|=g.flags,g.return=n,g=g.sibling;return n.subtreeFlags|=d,n.childLanes=l,s}function Av(n,s,l){var d=s.pendingProps;switch(Jc(s),s.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Cr(s),null;case 1:return Hr(s.type)&&Vo(),Cr(s),null;case 3:return d=s.stateNode,js(),Mt(zr),Mt(Tr),d0(),d.pendingContext&&(d.context=d.pendingContext,d.pendingContext=null),(n===null||n.child===null)&&(Yo(s)?s.flags|=4:n===null||n.memoizedState.isDehydrated&&(s.flags&256)===0||(s.flags|=1024,An!==null&&(H0(An),An=null))),I0(n,s),Cr(s),null;case 5:u0(s);var g=Za(bi.current);if(l=s.type,n!==null&&s.stateNode!=null)Dh(n,s,l,d,g),n.ref!==s.ref&&(s.flags|=512,s.flags|=2097152);else{if(!d){if(s.stateNode===null)throw Error(t(166));return Cr(s),null}if(n=Za(Vn.current),Yo(s)){d=s.stateNode,l=s.type;var k=s.memoizedProps;switch(d[Hn]=s,d[Ei]=k,n=(s.mode&1)!==0,l){case"dialog":Lt("cancel",d),Lt("close",d);break;case"iframe":case"object":case"embed":Lt("load",d);break;case"video":case"audio":for(g=0;g<wi.length;g++)Lt(wi[g],d);break;case"source":Lt("error",d);break;case"img":case"image":case"link":Lt("error",d),Lt("load",d);break;case"details":Lt("toggle",d);break;case"input":Fe(d,k),Lt("invalid",d);break;case"select":d._wrapperState={wasMultiple:!!k.multiple},Lt("invalid",d);break;case"textarea":Ce(d,k),Lt("invalid",d)}_r(l,k),g=null;for(var b in k)if(k.hasOwnProperty(b)){var Y=k[b];b==="children"?typeof Y=="string"?d.textContent!==Y&&(k.suppressHydrationWarning!==!0&&Uo(d.textContent,Y,n),g=["children",Y]):typeof Y=="number"&&d.textContent!==""+Y&&(k.suppressHydrationWarning!==!0&&Uo(d.textContent,Y,n),g=["children",""+Y]):i.hasOwnProperty(b)&&Y!=null&&b==="onScroll"&&Lt("scroll",d)}switch(l){case"input":G(d),Ve(d,k,!0);break;case"textarea":G(d),ce(d);break;case"select":case"option":break;default:typeof k.onClick=="function"&&(d.onclick=zo)}d=g,s.updateQueue=d,d!==null&&(s.flags|=4)}else{b=g.nodeType===9?g:g.ownerDocument,n==="http://www.w3.org/1999/xhtml"&&(n=Ee(l)),n==="http://www.w3.org/1999/xhtml"?l==="script"?(n=b.createElement("div"),n.innerHTML="<script><\/script>",n=n.removeChild(n.firstChild)):typeof d.is=="string"?n=b.createElement(l,{is:d.is}):(n=b.createElement(l),l==="select"&&(b=n,d.multiple?b.multiple=!0:d.size&&(b.size=d.size))):n=b.createElementNS(n,l),n[Hn]=s,n[Ei]=d,Ih(n,s,!1,!1),s.stateNode=n;e:{switch(b=ln(l,d),l){case"dialog":Lt("cancel",n),Lt("close",n),g=d;break;case"iframe":case"object":case"embed":Lt("load",n),g=d;break;case"video":case"audio":for(g=0;g<wi.length;g++)Lt(wi[g],n);g=d;break;case"source":Lt("error",n),g=d;break;case"img":case"image":case"link":Lt("error",n),Lt("load",n),g=d;break;case"details":Lt("toggle",n),g=d;break;case"input":Fe(n,d),g=ke(n,d),Lt("invalid",n);break;case"option":g=d;break;case"select":n._wrapperState={wasMultiple:!!d.multiple},g=q({},d,{value:void 0}),Lt("invalid",n);break;case"textarea":Ce(n,d),g=ye(n,d),Lt("invalid",n);break;default:g=d}_r(l,g),Y=g;for(k in Y)if(Y.hasOwnProperty(k)){var ne=Y[k];k==="style"?Nt(n,ne):k==="dangerouslySetInnerHTML"?(ne=ne?ne.__html:void 0,ne!=null&&at(n,ne)):k==="children"?typeof ne=="string"?(l!=="textarea"||ne!=="")&&it(n,ne):typeof ne=="number"&&it(n,""+ne):k!=="suppressContentEditableWarning"&&k!=="suppressHydrationWarning"&&k!=="autoFocus"&&(i.hasOwnProperty(k)?ne!=null&&k==="onScroll"&&Lt("scroll",n):ne!=null&&S(n,k,ne,b))}switch(l){case"input":G(n),Ve(n,d,!1);break;case"textarea":G(n),ce(n);break;case"option":d.value!=null&&n.setAttribute("value",""+P(d.value));break;case"select":n.multiple=!!d.multiple,k=d.value,k!=null?st(n,!!d.multiple,k,!1):d.defaultValue!=null&&st(n,!!d.multiple,d.defaultValue,!0);break;default:typeof g.onClick=="function"&&(n.onclick=zo)}switch(l){case"button":case"input":case"select":case"textarea":d=!!d.autoFocus;break e;case"img":d=!0;break e;default:d=!1}}d&&(s.flags|=4)}s.ref!==null&&(s.flags|=512,s.flags|=2097152)}return Cr(s),null;case 6:if(n&&s.stateNode!=null)Rh(n,s,n.memoizedProps,d);else{if(typeof d!="string"&&s.stateNode===null)throw Error(t(166));if(l=Za(bi.current),Za(Vn.current),Yo(s)){if(d=s.stateNode,l=s.memoizedProps,d[Hn]=s,(k=d.nodeValue!==l)&&(n=qr,n!==null))switch(n.tag){case 3:Uo(d.nodeValue,l,(n.mode&1)!==0);break;case 5:n.memoizedProps.suppressHydrationWarning!==!0&&Uo(d.nodeValue,l,(n.mode&1)!==0)}k&&(s.flags|=4)}else d=(l.nodeType===9?l:l.ownerDocument).createTextNode(d),d[Hn]=s,s.stateNode=d}return Cr(s),null;case 13:if(Mt(Ut),d=s.memoizedState,n===null||n.memoizedState!==null&&n.memoizedState.dehydrated!==null){if(Bt&&Zr!==null&&(s.mode&1)!==0&&(s.flags&128)===0)jd(),Ds(),s.flags|=98560,k=!1;else if(k=Yo(s),d!==null&&d.dehydrated!==null){if(n===null){if(!k)throw Error(t(318));if(k=s.memoizedState,k=k!==null?k.dehydrated:null,!k)throw Error(t(317));k[Hn]=s}else Ds(),(s.flags&128)===0&&(s.memoizedState=null),s.flags|=4;Cr(s),k=!1}else An!==null&&(H0(An),An=null),k=!0;if(!k)return s.flags&65536?s:null}return(s.flags&128)!==0?(s.lanes=l,s):(d=d!==null,d!==(n!==null&&n.memoizedState!==null)&&d&&(s.child.flags|=8192,(s.mode&1)!==0&&(n===null||(Ut.current&1)!==0?rr===0&&(rr=3):$0())),s.updateQueue!==null&&(s.flags|=4),Cr(s),null);case 4:return js(),I0(n,s),n===null&&yi(s.stateNode.containerInfo),Cr(s),null;case 10:return s0(s.type._context),Cr(s),null;case 17:return Hr(s.type)&&Vo(),Cr(s),null;case 19:if(Mt(Ut),k=s.memoizedState,k===null)return Cr(s),null;if(d=(s.flags&128)!==0,b=k.rendering,b===null)if(d)Di(k,!1);else{if(rr!==0||n!==null&&(n.flags&128)!==0)for(n=s.child;n!==null;){if(b=el(n),b!==null){for(s.flags|=128,Di(k,!1),d=b.updateQueue,d!==null&&(s.updateQueue=d,s.flags|=4),s.subtreeFlags=0,d=l,l=s.child;l!==null;)k=l,n=d,k.flags&=14680066,b=k.alternate,b===null?(k.childLanes=0,k.lanes=n,k.child=null,k.subtreeFlags=0,k.memoizedProps=null,k.memoizedState=null,k.updateQueue=null,k.dependencies=null,k.stateNode=null):(k.childLanes=b.childLanes,k.lanes=b.lanes,k.child=b.child,k.subtreeFlags=0,k.deletions=null,k.memoizedProps=b.memoizedProps,k.memoizedState=b.memoizedState,k.updateQueue=b.updateQueue,k.type=b.type,n=b.dependencies,k.dependencies=n===null?null:{lanes:n.lanes,firstContext:n.firstContext}),l=l.sibling;return jt(Ut,Ut.current&1|2),s.child}n=n.sibling}k.tail!==null&&Pe()>Us&&(s.flags|=128,d=!0,Di(k,!1),s.lanes=4194304)}else{if(!d)if(n=el(b),n!==null){if(s.flags|=128,d=!0,l=n.updateQueue,l!==null&&(s.updateQueue=l,s.flags|=4),Di(k,!0),k.tail===null&&k.tailMode==="hidden"&&!b.alternate&&!Bt)return Cr(s),null}else 2*Pe()-k.renderingStartTime>Us&&l!==1073741824&&(s.flags|=128,d=!0,Di(k,!1),s.lanes=4194304);k.isBackwards?(b.sibling=s.child,s.child=b):(l=k.last,l!==null?l.sibling=b:s.child=b,k.last=b)}return k.tail!==null?(s=k.tail,k.rendering=s,k.tail=s.sibling,k.renderingStartTime=Pe(),s.sibling=null,l=Ut.current,jt(Ut,d?l&1|2:l&1),s):(Cr(s),null);case 22:case 23:return W0(),d=s.memoizedState!==null,n!==null&&n.memoizedState!==null!==d&&(s.flags|=8192),d&&(s.mode&1)!==0?(Jr&1073741824)!==0&&(Cr(s),s.subtreeFlags&6&&(s.flags|=8192)):Cr(s),null;case 24:return null;case 25:return null}throw Error(t(156,s.tag))}function Fv(n,s){switch(Jc(s),s.tag){case 1:return Hr(s.type)&&Vo(),n=s.flags,n&65536?(s.flags=n&-65537|128,s):null;case 3:return js(),Mt(zr),Mt(Tr),d0(),n=s.flags,(n&65536)!==0&&(n&128)===0?(s.flags=n&-65537|128,s):null;case 5:return u0(s),null;case 13:if(Mt(Ut),n=s.memoizedState,n!==null&&n.dehydrated!==null){if(s.alternate===null)throw Error(t(340));Ds()}return n=s.flags,n&65536?(s.flags=n&-65537|128,s):null;case 19:return Mt(Ut),null;case 4:return js(),null;case 10:return s0(s.type._context),null;case 22:case 23:return W0(),null;case 24:return null;default:return null}}var cl=!1,br=!1,Iv=typeof WeakSet=="function"?WeakSet:Set,Je=null;function Ms(n,s){var l=n.ref;if(l!==null)if(typeof l=="function")try{l(null)}catch(d){Ht(n,s,d)}else l.current=null}function D0(n,s,l){try{l()}catch(d){Ht(n,s,d)}}var Ph=!1;function Dv(n,s){if(Wc=Ao,n=dd(),jc(n)){if("selectionStart"in n)var l={start:n.selectionStart,end:n.selectionEnd};else e:{l=(l=n.ownerDocument)&&l.defaultView||window;var d=l.getSelection&&l.getSelection();if(d&&d.rangeCount!==0){l=d.anchorNode;var g=d.anchorOffset,k=d.focusNode;d=d.focusOffset;try{l.nodeType,k.nodeType}catch{l=null;break e}var b=0,Y=-1,ne=-1,we=0,Le=0,Be=n,Oe=null;t:for(;;){for(var Qe;Be!==l||g!==0&&Be.nodeType!==3||(Y=b+g),Be!==k||d!==0&&Be.nodeType!==3||(ne=b+d),Be.nodeType===3&&(b+=Be.nodeValue.length),(Qe=Be.firstChild)!==null;)Oe=Be,Be=Qe;for(;;){if(Be===n)break t;if(Oe===l&&++we===g&&(Y=b),Oe===k&&++Le===d&&(ne=b),(Qe=Be.nextSibling)!==null)break;Be=Oe,Oe=Be.parentNode}Be=Qe}l=Y===-1||ne===-1?null:{start:Y,end:ne}}else l=null}l=l||{start:0,end:0}}else l=null;for($c={focusedElem:n,selectionRange:l},Ao=!1,Je=s;Je!==null;)if(s=Je,n=s.child,(s.subtreeFlags&1028)!==0&&n!==null)n.return=s,Je=n;else for(;Je!==null;){s=Je;try{var et=s.alternate;if((s.flags&1024)!==0)switch(s.tag){case 0:case 11:case 15:break;case 1:if(et!==null){var rt=et.memoizedProps,Xt=et.memoizedState,ue=s.stateNode,se=ue.getSnapshotBeforeUpdate(s.elementType===s.type?rt:Fn(s.type,rt),Xt);ue.__reactInternalSnapshotBeforeUpdate=se}break;case 3:var me=s.stateNode.containerInfo;me.nodeType===1?me.textContent="":me.nodeType===9&&me.documentElement&&me.removeChild(me.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(t(163))}}catch(He){Ht(s,s.return,He)}if(n=s.sibling,n!==null){n.return=s.return,Je=n;break}Je=s.return}return et=Ph,Ph=!1,et}function Ri(n,s,l){var d=s.updateQueue;if(d=d!==null?d.lastEffect:null,d!==null){var g=d=d.next;do{if((g.tag&n)===n){var k=g.destroy;g.destroy=void 0,k!==void 0&&D0(s,l,k)}g=g.next}while(g!==d)}}function ul(n,s){if(s=s.updateQueue,s=s!==null?s.lastEffect:null,s!==null){var l=s=s.next;do{if((l.tag&n)===n){var d=l.create;l.destroy=d()}l=l.next}while(l!==s)}}function R0(n){var s=n.ref;if(s!==null){var l=n.stateNode;switch(n.tag){case 5:n=l;break;default:n=l}typeof s=="function"?s(n):s.current=n}}function Oh(n){var s=n.alternate;s!==null&&(n.alternate=null,Oh(s)),n.child=null,n.deletions=null,n.sibling=null,n.tag===5&&(s=n.stateNode,s!==null&&(delete s[Hn],delete s[Ei],delete s[Kc],delete s[xv],delete s[mv])),n.stateNode=null,n.return=null,n.dependencies=null,n.memoizedProps=null,n.memoizedState=null,n.pendingProps=null,n.stateNode=null,n.updateQueue=null}function jh(n){return n.tag===5||n.tag===3||n.tag===4}function Lh(n){e:for(;;){for(;n.sibling===null;){if(n.return===null||jh(n.return))return null;n=n.return}for(n.sibling.return=n.return,n=n.sibling;n.tag!==5&&n.tag!==6&&n.tag!==18;){if(n.flags&2||n.child===null||n.tag===4)continue e;n.child.return=n,n=n.child}if(!(n.flags&2))return n.stateNode}}function P0(n,s,l){var d=n.tag;if(d===5||d===6)n=n.stateNode,s?l.nodeType===8?l.parentNode.insertBefore(n,s):l.insertBefore(n,s):(l.nodeType===8?(s=l.parentNode,s.insertBefore(n,l)):(s=l,s.appendChild(n)),l=l._reactRootContainer,l!=null||s.onclick!==null||(s.onclick=zo));else if(d!==4&&(n=n.child,n!==null))for(P0(n,s,l),n=n.sibling;n!==null;)P0(n,s,l),n=n.sibling}function O0(n,s,l){var d=n.tag;if(d===5||d===6)n=n.stateNode,s?l.insertBefore(n,s):l.appendChild(n);else if(d!==4&&(n=n.child,n!==null))for(O0(n,s,l),n=n.sibling;n!==null;)O0(n,s,l),n=n.sibling}var pr=null,In=!1;function Sa(n,s,l){for(l=l.child;l!==null;)Mh(n,s,l),l=l.sibling}function Mh(n,s,l){if(ir&&typeof ir.onCommitFiberUnmount=="function")try{ir.onCommitFiberUnmount(zn,l)}catch{}switch(l.tag){case 5:br||Ms(l,s);case 6:var d=pr,g=In;pr=null,Sa(n,s,l),pr=d,In=g,pr!==null&&(In?(n=pr,l=l.stateNode,n.nodeType===8?n.parentNode.removeChild(l):n.removeChild(l)):pr.removeChild(l.stateNode));break;case 18:pr!==null&&(In?(n=pr,l=l.stateNode,n.nodeType===8?Yc(n.parentNode,l):n.nodeType===1&&Yc(n,l),fi(n)):Yc(pr,l.stateNode));break;case 4:d=pr,g=In,pr=l.stateNode.containerInfo,In=!0,Sa(n,s,l),pr=d,In=g;break;case 0:case 11:case 14:case 15:if(!br&&(d=l.updateQueue,d!==null&&(d=d.lastEffect,d!==null))){g=d=d.next;do{var k=g,b=k.destroy;k=k.tag,b!==void 0&&((k&2)!==0||(k&4)!==0)&&D0(l,s,b),g=g.next}while(g!==d)}Sa(n,s,l);break;case 1:if(!br&&(Ms(l,s),d=l.stateNode,typeof d.componentWillUnmount=="function"))try{d.props=l.memoizedProps,d.state=l.memoizedState,d.componentWillUnmount()}catch(Y){Ht(l,s,Y)}Sa(n,s,l);break;case 21:Sa(n,s,l);break;case 22:l.mode&1?(br=(d=br)||l.memoizedState!==null,Sa(n,s,l),br=d):Sa(n,s,l);break;default:Sa(n,s,l)}}function Bh(n){var s=n.updateQueue;if(s!==null){n.updateQueue=null;var l=n.stateNode;l===null&&(l=n.stateNode=new Iv),s.forEach(function(d){var g=zv.bind(null,n,d);l.has(d)||(l.add(d),d.then(g,g))})}}function Dn(n,s){var l=s.deletions;if(l!==null)for(var d=0;d<l.length;d++){var g=l[d];try{var k=n,b=s,Y=b;e:for(;Y!==null;){switch(Y.tag){case 5:pr=Y.stateNode,In=!1;break e;case 3:pr=Y.stateNode.containerInfo,In=!0;break e;case 4:pr=Y.stateNode.containerInfo,In=!0;break e}Y=Y.return}if(pr===null)throw Error(t(160));Mh(k,b,g),pr=null,In=!1;var ne=g.alternate;ne!==null&&(ne.return=null),g.return=null}catch(we){Ht(g,s,we)}}if(s.subtreeFlags&12854)for(s=s.child;s!==null;)Uh(s,n),s=s.sibling}function Uh(n,s){var l=n.alternate,d=n.flags;switch(n.tag){case 0:case 11:case 14:case 15:if(Dn(s,n),$n(n),d&4){try{Ri(3,n,n.return),ul(3,n)}catch(rt){Ht(n,n.return,rt)}try{Ri(5,n,n.return)}catch(rt){Ht(n,n.return,rt)}}break;case 1:Dn(s,n),$n(n),d&512&&l!==null&&Ms(l,l.return);break;case 5:if(Dn(s,n),$n(n),d&512&&l!==null&&Ms(l,l.return),n.flags&32){var g=n.stateNode;try{it(g,"")}catch(rt){Ht(n,n.return,rt)}}if(d&4&&(g=n.stateNode,g!=null)){var k=n.memoizedProps,b=l!==null?l.memoizedProps:k,Y=n.type,ne=n.updateQueue;if(n.updateQueue=null,ne!==null)try{Y==="input"&&k.type==="radio"&&k.name!=null&&De(g,k),ln(Y,b);var we=ln(Y,k);for(b=0;b<ne.length;b+=2){var Le=ne[b],Be=ne[b+1];Le==="style"?Nt(g,Be):Le==="dangerouslySetInnerHTML"?at(g,Be):Le==="children"?it(g,Be):S(g,Le,Be,we)}switch(Y){case"input":Ge(g,k);break;case"textarea":le(g,k);break;case"select":var Oe=g._wrapperState.wasMultiple;g._wrapperState.wasMultiple=!!k.multiple;var Qe=k.value;Qe!=null?st(g,!!k.multiple,Qe,!1):Oe!==!!k.multiple&&(k.defaultValue!=null?st(g,!!k.multiple,k.defaultValue,!0):st(g,!!k.multiple,k.multiple?[]:"",!1))}g[Ei]=k}catch(rt){Ht(n,n.return,rt)}}break;case 6:if(Dn(s,n),$n(n),d&4){if(n.stateNode===null)throw Error(t(162));g=n.stateNode,k=n.memoizedProps;try{g.nodeValue=k}catch(rt){Ht(n,n.return,rt)}}break;case 3:if(Dn(s,n),$n(n),d&4&&l!==null&&l.memoizedState.isDehydrated)try{fi(s.containerInfo)}catch(rt){Ht(n,n.return,rt)}break;case 4:Dn(s,n),$n(n);break;case 13:Dn(s,n),$n(n),g=n.child,g.flags&8192&&(k=g.memoizedState!==null,g.stateNode.isHidden=k,!k||g.alternate!==null&&g.alternate.memoizedState!==null||(M0=Pe())),d&4&&Bh(n);break;case 22:if(Le=l!==null&&l.memoizedState!==null,n.mode&1?(br=(we=br)||Le,Dn(s,n),br=we):Dn(s,n),$n(n),d&8192){if(we=n.memoizedState!==null,(n.stateNode.isHidden=we)&&!Le&&(n.mode&1)!==0)for(Je=n,Le=n.child;Le!==null;){for(Be=Je=Le;Je!==null;){switch(Oe=Je,Qe=Oe.child,Oe.tag){case 0:case 11:case 14:case 15:Ri(4,Oe,Oe.return);break;case 1:Ms(Oe,Oe.return);var et=Oe.stateNode;if(typeof et.componentWillUnmount=="function"){d=Oe,l=Oe.return;try{s=d,et.props=s.memoizedProps,et.state=s.memoizedState,et.componentWillUnmount()}catch(rt){Ht(d,l,rt)}}break;case 5:Ms(Oe,Oe.return);break;case 22:if(Oe.memoizedState!==null){Vh(Be);continue}}Qe!==null?(Qe.return=Oe,Je=Qe):Vh(Be)}Le=Le.sibling}e:for(Le=null,Be=n;;){if(Be.tag===5){if(Le===null){Le=Be;try{g=Be.stateNode,we?(k=g.style,typeof k.setProperty=="function"?k.setProperty("display","none","important"):k.display="none"):(Y=Be.stateNode,ne=Be.memoizedProps.style,b=ne!=null&&ne.hasOwnProperty("display")?ne.display:null,Y.style.display=mt("display",b))}catch(rt){Ht(n,n.return,rt)}}}else if(Be.tag===6){if(Le===null)try{Be.stateNode.nodeValue=we?"":Be.memoizedProps}catch(rt){Ht(n,n.return,rt)}}else if((Be.tag!==22&&Be.tag!==23||Be.memoizedState===null||Be===n)&&Be.child!==null){Be.child.return=Be,Be=Be.child;continue}if(Be===n)break e;for(;Be.sibling===null;){if(Be.return===null||Be.return===n)break e;Le===Be&&(Le=null),Be=Be.return}Le===Be&&(Le=null),Be.sibling.return=Be.return,Be=Be.sibling}}break;case 19:Dn(s,n),$n(n),d&4&&Bh(n);break;case 21:break;default:Dn(s,n),$n(n)}}function $n(n){var s=n.flags;if(s&2){try{e:{for(var l=n.return;l!==null;){if(jh(l)){var d=l;break e}l=l.return}throw Error(t(160))}switch(d.tag){case 5:var g=d.stateNode;d.flags&32&&(it(g,""),d.flags&=-33);var k=Lh(n);O0(n,k,g);break;case 3:case 4:var b=d.stateNode.containerInfo,Y=Lh(n);P0(n,Y,b);break;default:throw Error(t(161))}}catch(ne){Ht(n,n.return,ne)}n.flags&=-3}s&4096&&(n.flags&=-4097)}function Rv(n,s,l){Je=n,zh(n)}function zh(n,s,l){for(var d=(n.mode&1)!==0;Je!==null;){var g=Je,k=g.child;if(g.tag===22&&d){var b=g.memoizedState!==null||cl;if(!b){var Y=g.alternate,ne=Y!==null&&Y.memoizedState!==null||br;Y=cl;var we=br;if(cl=b,(br=ne)&&!we)for(Je=g;Je!==null;)b=Je,ne=b.child,b.tag===22&&b.memoizedState!==null?Wh(g):ne!==null?(ne.return=b,Je=ne):Wh(g);for(;k!==null;)Je=k,zh(k),k=k.sibling;Je=g,cl=Y,br=we}Hh(n)}else(g.subtreeFlags&8772)!==0&&k!==null?(k.return=g,Je=k):Hh(n)}}function Hh(n){for(;Je!==null;){var s=Je;if((s.flags&8772)!==0){var l=s.alternate;try{if((s.flags&8772)!==0)switch(s.tag){case 0:case 11:case 15:br||ul(5,s);break;case 1:var d=s.stateNode;if(s.flags&4&&!br)if(l===null)d.componentDidMount();else{var g=s.elementType===s.type?l.memoizedProps:Fn(s.type,l.memoizedProps);d.componentDidUpdate(g,l.memoizedState,d.__reactInternalSnapshotBeforeUpdate)}var k=s.updateQueue;k!==null&&Vd(s,k,d);break;case 3:var b=s.updateQueue;if(b!==null){if(l=null,s.child!==null)switch(s.child.tag){case 5:l=s.child.stateNode;break;case 1:l=s.child.stateNode}Vd(s,b,l)}break;case 5:var Y=s.stateNode;if(l===null&&s.flags&4){l=Y;var ne=s.memoizedProps;switch(s.type){case"button":case"input":case"select":case"textarea":ne.autoFocus&&l.focus();break;case"img":ne.src&&(l.src=ne.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(s.memoizedState===null){var we=s.alternate;if(we!==null){var Le=we.memoizedState;if(Le!==null){var Be=Le.dehydrated;Be!==null&&fi(Be)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(t(163))}br||s.flags&512&&R0(s)}catch(Oe){Ht(s,s.return,Oe)}}if(s===n){Je=null;break}if(l=s.sibling,l!==null){l.return=s.return,Je=l;break}Je=s.return}}function Vh(n){for(;Je!==null;){var s=Je;if(s===n){Je=null;break}var l=s.sibling;if(l!==null){l.return=s.return,Je=l;break}Je=s.return}}function Wh(n){for(;Je!==null;){var s=Je;try{switch(s.tag){case 0:case 11:case 15:var l=s.return;try{ul(4,s)}catch(ne){Ht(s,l,ne)}break;case 1:var d=s.stateNode;if(typeof d.componentDidMount=="function"){var g=s.return;try{d.componentDidMount()}catch(ne){Ht(s,g,ne)}}var k=s.return;try{R0(s)}catch(ne){Ht(s,k,ne)}break;case 5:var b=s.return;try{R0(s)}catch(ne){Ht(s,b,ne)}}}catch(ne){Ht(s,s.return,ne)}if(s===n){Je=null;break}var Y=s.sibling;if(Y!==null){Y.return=s.return,Je=Y;break}Je=s.return}}var Pv=Math.ceil,fl=N.ReactCurrentDispatcher,j0=N.ReactCurrentOwner,mn=N.ReactCurrentBatchConfig,St=0,lr=null,Kt=null,gr=0,Jr=0,Bs=ya(0),rr=0,Pi=null,es=0,dl=0,L0=0,Oi=null,Wr=null,M0=0,Us=1/0,na=null,hl=!1,B0=null,Ca=null,xl=!1,ba=null,ml=0,ji=0,U0=null,pl=-1,gl=0;function Or(){return(St&6)!==0?Pe():pl!==-1?pl:pl=Pe()}function Na(n){return(n.mode&1)===0?1:(St&2)!==0&&gr!==0?gr&-gr:gv.transition!==null?(gl===0&&(gl=Lf()),gl):(n=Dt,n!==0||(n=window.event,n=n===void 0?16:Xf(n.type)),n)}function Rn(n,s,l,d){if(50<ji)throw ji=0,U0=null,Error(t(185));ii(n,l,d),((St&2)===0||n!==lr)&&(n===lr&&((St&2)===0&&(dl|=l),rr===4&&Aa(n,gr)),$r(n,d),l===1&&St===0&&(s.mode&1)===0&&(Us=Pe()+500,$o&&Ea()))}function $r(n,s){var l=n.callbackNode;gg(n,s);var d=Co(n,n===lr?gr:0);if(d===0)l!==null&&We(l),n.callbackNode=null,n.callbackPriority=0;else if(s=d&-d,n.callbackPriority!==s){if(l!=null&&We(l),s===1)n.tag===0?pv(Xh.bind(null,n)):Id(Xh.bind(null,n)),dv(function(){(St&6)===0&&Ea()}),l=null;else{switch(Mf(d)){case 1:l=Rt;break;case 4:l=Ot;break;case 16:l=Wt;break;case 536870912:l=da;break;default:l=Wt}l=e1(l,$h.bind(null,n))}n.callbackPriority=s,n.callbackNode=l}}function $h(n,s){if(pl=-1,gl=0,(St&6)!==0)throw Error(t(327));var l=n.callbackNode;if(zs()&&n.callbackNode!==l)return null;var d=Co(n,n===lr?gr:0);if(d===0)return null;if((d&30)!==0||(d&n.expiredLanes)!==0||s)s=vl(n,d);else{s=d;var g=St;St|=2;var k=Yh();(lr!==n||gr!==s)&&(na=null,Us=Pe()+500,rs(n,s));do try{Lv();break}catch(Y){Gh(n,Y)}while(!0);a0(),fl.current=k,St=g,Kt!==null?s=0:(lr=null,gr=0,s=rr)}if(s!==0){if(s===2&&(g=yc(n),g!==0&&(d=g,s=z0(n,g))),s===1)throw l=Pi,rs(n,0),Aa(n,d),$r(n,Pe()),l;if(s===6)Aa(n,d);else{if(g=n.current.alternate,(d&30)===0&&!Ov(g)&&(s=vl(n,d),s===2&&(k=yc(n),k!==0&&(d=k,s=z0(n,k))),s===1))throw l=Pi,rs(n,0),Aa(n,d),$r(n,Pe()),l;switch(n.finishedWork=g,n.finishedLanes=d,s){case 0:case 1:throw Error(t(345));case 2:ns(n,Wr,na);break;case 3:if(Aa(n,d),(d&130023424)===d&&(s=M0+500-Pe(),10<s)){if(Co(n,0)!==0)break;if(g=n.suspendedLanes,(g&d)!==d){Or(),n.pingedLanes|=n.suspendedLanes&g;break}n.timeoutHandle=Gc(ns.bind(null,n,Wr,na),s);break}ns(n,Wr,na);break;case 4:if(Aa(n,d),(d&4194240)===d)break;for(s=n.eventTimes,g=-1;0<d;){var b=31-$t(d);k=1<<b,b=s[b],b>g&&(g=b),d&=~k}if(d=g,d=Pe()-d,d=(120>d?120:480>d?480:1080>d?1080:1920>d?1920:3e3>d?3e3:4320>d?4320:1960*Pv(d/1960))-d,10<d){n.timeoutHandle=Gc(ns.bind(null,n,Wr,na),d);break}ns(n,Wr,na);break;case 5:ns(n,Wr,na);break;default:throw Error(t(329))}}}return $r(n,Pe()),n.callbackNode===l?$h.bind(null,n):null}function z0(n,s){var l=Oi;return n.current.memoizedState.isDehydrated&&(rs(n,s).flags|=256),n=vl(n,s),n!==2&&(s=Wr,Wr=l,s!==null&&H0(s)),n}function H0(n){Wr===null?Wr=n:Wr.push.apply(Wr,n)}function Ov(n){for(var s=n;;){if(s.flags&16384){var l=s.updateQueue;if(l!==null&&(l=l.stores,l!==null))for(var d=0;d<l.length;d++){var g=l[d],k=g.getSnapshot;g=g.value;try{if(!Nn(k(),g))return!1}catch{return!1}}}if(l=s.child,s.subtreeFlags&16384&&l!==null)l.return=s,s=l;else{if(s===n)break;for(;s.sibling===null;){if(s.return===null||s.return===n)return!0;s=s.return}s.sibling.return=s.return,s=s.sibling}}return!0}function Aa(n,s){for(s&=~L0,s&=~dl,n.suspendedLanes|=s,n.pingedLanes&=~s,n=n.expirationTimes;0<s;){var l=31-$t(s),d=1<<l;n[l]=-1,s&=~d}}function Xh(n){if((St&6)!==0)throw Error(t(327));zs();var s=Co(n,0);if((s&1)===0)return $r(n,Pe()),null;var l=vl(n,s);if(n.tag!==0&&l===2){var d=yc(n);d!==0&&(s=d,l=z0(n,d))}if(l===1)throw l=Pi,rs(n,0),Aa(n,s),$r(n,Pe()),l;if(l===6)throw Error(t(345));return n.finishedWork=n.current.alternate,n.finishedLanes=s,ns(n,Wr,na),$r(n,Pe()),null}function V0(n,s){var l=St;St|=1;try{return n(s)}finally{St=l,St===0&&(Us=Pe()+500,$o&&Ea())}}function ts(n){ba!==null&&ba.tag===0&&(St&6)===0&&zs();var s=St;St|=1;var l=mn.transition,d=Dt;try{if(mn.transition=null,Dt=1,n)return n()}finally{Dt=d,mn.transition=l,St=s,(St&6)===0&&Ea()}}function W0(){Jr=Bs.current,Mt(Bs)}function rs(n,s){n.finishedWork=null,n.finishedLanes=0;var l=n.timeoutHandle;if(l!==-1&&(n.timeoutHandle=-1,fv(l)),Kt!==null)for(l=Kt.return;l!==null;){var d=l;switch(Jc(d),d.tag){case 1:d=d.type.childContextTypes,d!=null&&Vo();break;case 3:js(),Mt(zr),Mt(Tr),d0();break;case 5:u0(d);break;case 4:js();break;case 13:Mt(Ut);break;case 19:Mt(Ut);break;case 10:s0(d.type._context);break;case 22:case 23:W0()}l=l.return}if(lr=n,Kt=n=Fa(n.current,null),gr=Jr=s,rr=0,Pi=null,L0=dl=es=0,Wr=Oi=null,qa!==null){for(s=0;s<qa.length;s++)if(l=qa[s],d=l.interleaved,d!==null){l.interleaved=null;var g=d.next,k=l.pending;if(k!==null){var b=k.next;k.next=g,d.next=b}l.pending=d}qa=null}return n}function Gh(n,s){do{var l=Kt;try{if(a0(),tl.current=sl,rl){for(var d=zt.memoizedState;d!==null;){var g=d.queue;g!==null&&(g.pending=null),d=d.next}rl=!1}if(Ja=0,or=tr=zt=null,Ni=!1,Ai=0,j0.current=null,l===null||l.return===null){rr=1,Pi=s,Kt=null;break}e:{var k=n,b=l.return,Y=l,ne=s;if(s=gr,Y.flags|=32768,ne!==null&&typeof ne=="object"&&typeof ne.then=="function"){var we=ne,Le=Y,Be=Le.tag;if((Le.mode&1)===0&&(Be===0||Be===11||Be===15)){var Oe=Le.alternate;Oe?(Le.updateQueue=Oe.updateQueue,Le.memoizedState=Oe.memoizedState,Le.lanes=Oe.lanes):(Le.updateQueue=null,Le.memoizedState=null)}var Qe=vh(b);if(Qe!==null){Qe.flags&=-257,wh(Qe,b,Y,k,s),Qe.mode&1&&gh(k,we,s),s=Qe,ne=we;var et=s.updateQueue;if(et===null){var rt=new Set;rt.add(ne),s.updateQueue=rt}else et.add(ne);break e}else{if((s&1)===0){gh(k,we,s),$0();break e}ne=Error(t(426))}}else if(Bt&&Y.mode&1){var Xt=vh(b);if(Xt!==null){(Xt.flags&65536)===0&&(Xt.flags|=256),wh(Xt,b,Y,k,s),r0(Ls(ne,Y));break e}}k=ne=Ls(ne,Y),rr!==4&&(rr=2),Oi===null?Oi=[k]:Oi.push(k),k=b;do{switch(k.tag){case 3:k.flags|=65536,s&=-s,k.lanes|=s;var ue=mh(k,ne,s);Hd(k,ue);break e;case 1:Y=ne;var se=k.type,me=k.stateNode;if((k.flags&128)===0&&(typeof se.getDerivedStateFromError=="function"||me!==null&&typeof me.componentDidCatch=="function"&&(Ca===null||!Ca.has(me)))){k.flags|=65536,s&=-s,k.lanes|=s;var He=ph(k,Y,s);Hd(k,He);break e}}k=k.return}while(k!==null)}Qh(l)}catch(nt){s=nt,Kt===l&&l!==null&&(Kt=l=l.return);continue}break}while(!0)}function Yh(){var n=fl.current;return fl.current=sl,n===null?sl:n}function $0(){(rr===0||rr===3||rr===2)&&(rr=4),lr===null||(es&268435455)===0&&(dl&268435455)===0||Aa(lr,gr)}function vl(n,s){var l=St;St|=2;var d=Yh();(lr!==n||gr!==s)&&(na=null,rs(n,s));do try{jv();break}catch(g){Gh(n,g)}while(!0);if(a0(),St=l,fl.current=d,Kt!==null)throw Error(t(261));return lr=null,gr=0,rr}function jv(){for(;Kt!==null;)Kh(Kt)}function Lv(){for(;Kt!==null&&!qe();)Kh(Kt)}function Kh(n){var s=Jh(n.alternate,n,Jr);n.memoizedProps=n.pendingProps,s===null?Qh(n):Kt=s,j0.current=null}function Qh(n){var s=n;do{var l=s.alternate;if(n=s.return,(s.flags&32768)===0){if(l=Av(l,s,Jr),l!==null){Kt=l;return}}else{if(l=Fv(l,s),l!==null){l.flags&=32767,Kt=l;return}if(n!==null)n.flags|=32768,n.subtreeFlags=0,n.deletions=null;else{rr=6,Kt=null;return}}if(s=s.sibling,s!==null){Kt=s;return}Kt=s=n}while(s!==null);rr===0&&(rr=5)}function ns(n,s,l){var d=Dt,g=mn.transition;try{mn.transition=null,Dt=1,Mv(n,s,l,d)}finally{mn.transition=g,Dt=d}return null}function Mv(n,s,l,d){do zs();while(ba!==null);if((St&6)!==0)throw Error(t(327));l=n.finishedWork;var g=n.finishedLanes;if(l===null)return null;if(n.finishedWork=null,n.finishedLanes=0,l===n.current)throw Error(t(177));n.callbackNode=null,n.callbackPriority=0;var k=l.lanes|l.childLanes;if(vg(n,k),n===lr&&(Kt=lr=null,gr=0),(l.subtreeFlags&2064)===0&&(l.flags&2064)===0||xl||(xl=!0,e1(Wt,function(){return zs(),null})),k=(l.flags&15990)!==0,(l.subtreeFlags&15990)!==0||k){k=mn.transition,mn.transition=null;var b=Dt;Dt=1;var Y=St;St|=4,j0.current=null,Dv(n,l),Uh(l,n),av($c),Ao=!!Wc,$c=Wc=null,n.current=l,Rv(l),Ue(),St=Y,Dt=b,mn.transition=k}else n.current=l;if(xl&&(xl=!1,ba=n,ml=g),k=n.pendingLanes,k===0&&(Ca=null),ai(l.stateNode),$r(n,Pe()),s!==null)for(d=n.onRecoverableError,l=0;l<s.length;l++)g=s[l],d(g.value,{componentStack:g.stack,digest:g.digest});if(hl)throw hl=!1,n=B0,B0=null,n;return(ml&1)!==0&&n.tag!==0&&zs(),k=n.pendingLanes,(k&1)!==0?n===U0?ji++:(ji=0,U0=n):ji=0,Ea(),null}function zs(){if(ba!==null){var n=Mf(ml),s=mn.transition,l=Dt;try{if(mn.transition=null,Dt=16>n?16:n,ba===null)var d=!1;else{if(n=ba,ba=null,ml=0,(St&6)!==0)throw Error(t(331));var g=St;for(St|=4,Je=n.current;Je!==null;){var k=Je,b=k.child;if((Je.flags&16)!==0){var Y=k.deletions;if(Y!==null){for(var ne=0;ne<Y.length;ne++){var we=Y[ne];for(Je=we;Je!==null;){var Le=Je;switch(Le.tag){case 0:case 11:case 15:Ri(8,Le,k)}var Be=Le.child;if(Be!==null)Be.return=Le,Je=Be;else for(;Je!==null;){Le=Je;var Oe=Le.sibling,Qe=Le.return;if(Oh(Le),Le===we){Je=null;break}if(Oe!==null){Oe.return=Qe,Je=Oe;break}Je=Qe}}}var et=k.alternate;if(et!==null){var rt=et.child;if(rt!==null){et.child=null;do{var Xt=rt.sibling;rt.sibling=null,rt=Xt}while(rt!==null)}}Je=k}}if((k.subtreeFlags&2064)!==0&&b!==null)b.return=k,Je=b;else e:for(;Je!==null;){if(k=Je,(k.flags&2048)!==0)switch(k.tag){case 0:case 11:case 15:Ri(9,k,k.return)}var ue=k.sibling;if(ue!==null){ue.return=k.return,Je=ue;break e}Je=k.return}}var se=n.current;for(Je=se;Je!==null;){b=Je;var me=b.child;if((b.subtreeFlags&2064)!==0&&me!==null)me.return=b,Je=me;else e:for(b=se;Je!==null;){if(Y=Je,(Y.flags&2048)!==0)try{switch(Y.tag){case 0:case 11:case 15:ul(9,Y)}}catch(nt){Ht(Y,Y.return,nt)}if(Y===b){Je=null;break e}var He=Y.sibling;if(He!==null){He.return=Y.return,Je=He;break e}Je=Y.return}}if(St=g,Ea(),ir&&typeof ir.onPostCommitFiberRoot=="function")try{ir.onPostCommitFiberRoot(zn,n)}catch{}d=!0}return d}finally{Dt=l,mn.transition=s}}return!1}function qh(n,s,l){s=Ls(l,s),s=mh(n,s,1),n=Ta(n,s,1),s=Or(),n!==null&&(ii(n,1,s),$r(n,s))}function Ht(n,s,l){if(n.tag===3)qh(n,n,l);else for(;s!==null;){if(s.tag===3){qh(s,n,l);break}else if(s.tag===1){var d=s.stateNode;if(typeof s.type.getDerivedStateFromError=="function"||typeof d.componentDidCatch=="function"&&(Ca===null||!Ca.has(d))){n=Ls(l,n),n=ph(s,n,1),s=Ta(s,n,1),n=Or(),s!==null&&(ii(s,1,n),$r(s,n));break}}s=s.return}}function Bv(n,s,l){var d=n.pingCache;d!==null&&d.delete(s),s=Or(),n.pingedLanes|=n.suspendedLanes&l,lr===n&&(gr&l)===l&&(rr===4||rr===3&&(gr&130023424)===gr&&500>Pe()-M0?rs(n,0):L0|=l),$r(n,s)}function Zh(n,s){s===0&&((n.mode&1)===0?s=1:(s=So,So<<=1,(So&130023424)===0&&(So=4194304)));var l=Or();n=ea(n,s),n!==null&&(ii(n,s,l),$r(n,l))}function Uv(n){var s=n.memoizedState,l=0;s!==null&&(l=s.retryLane),Zh(n,l)}function zv(n,s){var l=0;switch(n.tag){case 13:var d=n.stateNode,g=n.memoizedState;g!==null&&(l=g.retryLane);break;case 19:d=n.stateNode;break;default:throw Error(t(314))}d!==null&&d.delete(s),Zh(n,l)}var Jh;Jh=function(n,s,l){if(n!==null)if(n.memoizedProps!==s.pendingProps||zr.current)Vr=!0;else{if((n.lanes&l)===0&&(s.flags&128)===0)return Vr=!1,Nv(n,s,l);Vr=(n.flags&131072)!==0}else Vr=!1,Bt&&(s.flags&1048576)!==0&&Dd(s,Go,s.index);switch(s.lanes=0,s.tag){case 2:var d=s.type;ll(n,s),n=s.pendingProps;var g=As(s,Tr.current);Os(s,l),g=m0(null,s,d,n,g,l);var k=p0();return s.flags|=1,typeof g=="object"&&g!==null&&typeof g.render=="function"&&g.$$typeof===void 0?(s.tag=1,s.memoizedState=null,s.updateQueue=null,Hr(d)?(k=!0,Wo(s)):k=!1,s.memoizedState=g.state!==null&&g.state!==void 0?g.state:null,l0(s),g.updater=il,s.stateNode=g,g._reactInternals=s,E0(s,d,n,l),s=C0(null,s,d,!0,k,l)):(s.tag=0,Bt&&k&&Zc(s),Pr(null,s,g,l),s=s.child),s;case 16:d=s.elementType;e:{switch(ll(n,s),n=s.pendingProps,g=d._init,d=g(d._payload),s.type=d,g=s.tag=Vv(d),n=Fn(d,n),g){case 0:s=S0(null,s,d,n,l);break e;case 1:s=Sh(null,s,d,n,l);break e;case 11:s=yh(null,s,d,n,l);break e;case 14:s=kh(null,s,d,Fn(d.type,n),l);break e}throw Error(t(306,d,""))}return s;case 0:return d=s.type,g=s.pendingProps,g=s.elementType===d?g:Fn(d,g),S0(n,s,d,g,l);case 1:return d=s.type,g=s.pendingProps,g=s.elementType===d?g:Fn(d,g),Sh(n,s,d,g,l);case 3:e:{if(Ch(s),n===null)throw Error(t(387));d=s.pendingProps,k=s.memoizedState,g=k.element,zd(n,s),Jo(s,d,null,l);var b=s.memoizedState;if(d=b.element,k.isDehydrated)if(k={element:d,isDehydrated:!1,cache:b.cache,pendingSuspenseBoundaries:b.pendingSuspenseBoundaries,transitions:b.transitions},s.updateQueue.baseState=k,s.memoizedState=k,s.flags&256){g=Ls(Error(t(423)),s),s=bh(n,s,d,l,g);break e}else if(d!==g){g=Ls(Error(t(424)),s),s=bh(n,s,d,l,g);break e}else for(Zr=wa(s.stateNode.containerInfo.firstChild),qr=s,Bt=!0,An=null,l=Bd(s,null,d,l),s.child=l;l;)l.flags=l.flags&-3|4096,l=l.sibling;else{if(Ds(),d===g){s=ra(n,s,l);break e}Pr(n,s,d,l)}s=s.child}return s;case 5:return Wd(s),n===null&&t0(s),d=s.type,g=s.pendingProps,k=n!==null?n.memoizedProps:null,b=g.children,Xc(d,g)?b=null:k!==null&&Xc(d,k)&&(s.flags|=32),Th(n,s),Pr(n,s,b,l),s.child;case 6:return n===null&&t0(s),null;case 13:return Nh(n,s,l);case 4:return c0(s,s.stateNode.containerInfo),d=s.pendingProps,n===null?s.child=Rs(s,null,d,l):Pr(n,s,d,l),s.child;case 11:return d=s.type,g=s.pendingProps,g=s.elementType===d?g:Fn(d,g),yh(n,s,d,g,l);case 7:return Pr(n,s,s.pendingProps,l),s.child;case 8:return Pr(n,s,s.pendingProps.children,l),s.child;case 12:return Pr(n,s,s.pendingProps.children,l),s.child;case 10:e:{if(d=s.type._context,g=s.pendingProps,k=s.memoizedProps,b=g.value,jt(Qo,d._currentValue),d._currentValue=b,k!==null)if(Nn(k.value,b)){if(k.children===g.children&&!zr.current){s=ra(n,s,l);break e}}else for(k=s.child,k!==null&&(k.return=s);k!==null;){var Y=k.dependencies;if(Y!==null){b=k.child;for(var ne=Y.firstContext;ne!==null;){if(ne.context===d){if(k.tag===1){ne=ta(-1,l&-l),ne.tag=2;var we=k.updateQueue;if(we!==null){we=we.shared;var Le=we.pending;Le===null?ne.next=ne:(ne.next=Le.next,Le.next=ne),we.pending=ne}}k.lanes|=l,ne=k.alternate,ne!==null&&(ne.lanes|=l),i0(k.return,l,s),Y.lanes|=l;break}ne=ne.next}}else if(k.tag===10)b=k.type===s.type?null:k.child;else if(k.tag===18){if(b=k.return,b===null)throw Error(t(341));b.lanes|=l,Y=b.alternate,Y!==null&&(Y.lanes|=l),i0(b,l,s),b=k.sibling}else b=k.child;if(b!==null)b.return=k;else for(b=k;b!==null;){if(b===s){b=null;break}if(k=b.sibling,k!==null){k.return=b.return,b=k;break}b=b.return}k=b}Pr(n,s,g.children,l),s=s.child}return s;case 9:return g=s.type,d=s.pendingProps.children,Os(s,l),g=hn(g),d=d(g),s.flags|=1,Pr(n,s,d,l),s.child;case 14:return d=s.type,g=Fn(d,s.pendingProps),g=Fn(d.type,g),kh(n,s,d,g,l);case 15:return Eh(n,s,s.type,s.pendingProps,l);case 17:return d=s.type,g=s.pendingProps,g=s.elementType===d?g:Fn(d,g),ll(n,s),s.tag=1,Hr(d)?(n=!0,Wo(s)):n=!1,Os(s,l),hh(s,d,g),E0(s,d,g,l),C0(null,s,d,!0,n,l);case 19:return Fh(n,s,l);case 22:return _h(n,s,l)}throw Error(t(156,s.tag))};function e1(n,s){return Me(n,s)}function Hv(n,s,l,d){this.tag=n,this.key=l,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=s,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=d,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function pn(n,s,l,d){return new Hv(n,s,l,d)}function X0(n){return n=n.prototype,!(!n||!n.isReactComponent)}function Vv(n){if(typeof n=="function")return X0(n)?1:0;if(n!=null){if(n=n.$$typeof,n===R)return 11;if(n===te)return 14}return 2}function Fa(n,s){var l=n.alternate;return l===null?(l=pn(n.tag,s,n.key,n.mode),l.elementType=n.elementType,l.type=n.type,l.stateNode=n.stateNode,l.alternate=n,n.alternate=l):(l.pendingProps=s,l.type=n.type,l.flags=0,l.subtreeFlags=0,l.deletions=null),l.flags=n.flags&14680064,l.childLanes=n.childLanes,l.lanes=n.lanes,l.child=n.child,l.memoizedProps=n.memoizedProps,l.memoizedState=n.memoizedState,l.updateQueue=n.updateQueue,s=n.dependencies,l.dependencies=s===null?null:{lanes:s.lanes,firstContext:s.firstContext},l.sibling=n.sibling,l.index=n.index,l.ref=n.ref,l}function wl(n,s,l,d,g,k){var b=2;if(d=n,typeof n=="function")X0(n)&&(b=1);else if(typeof n=="string")b=5;else e:switch(n){case j:return as(l.children,g,k,s);case z:b=8,g|=8;break;case M:return n=pn(12,l,s,g|2),n.elementType=M,n.lanes=k,n;case K:return n=pn(13,l,s,g),n.elementType=K,n.lanes=k,n;case ae:return n=pn(19,l,s,g),n.elementType=ae,n.lanes=k,n;case re:return yl(l,g,k,s);default:if(typeof n=="object"&&n!==null)switch(n.$$typeof){case U:b=10;break e;case D:b=9;break e;case R:b=11;break e;case te:b=14;break e;case oe:b=16,d=null;break e}throw Error(t(130,n==null?n:typeof n,""))}return s=pn(b,l,s,g),s.elementType=n,s.type=d,s.lanes=k,s}function as(n,s,l,d){return n=pn(7,n,d,s),n.lanes=l,n}function yl(n,s,l,d){return n=pn(22,n,d,s),n.elementType=re,n.lanes=l,n.stateNode={isHidden:!1},n}function G0(n,s,l){return n=pn(6,n,null,s),n.lanes=l,n}function Y0(n,s,l){return s=pn(4,n.children!==null?n.children:[],n.key,s),s.lanes=l,s.stateNode={containerInfo:n.containerInfo,pendingChildren:null,implementation:n.implementation},s}function Wv(n,s,l,d,g){this.tag=s,this.containerInfo=n,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=kc(0),this.expirationTimes=kc(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=kc(0),this.identifierPrefix=d,this.onRecoverableError=g,this.mutableSourceEagerHydrationData=null}function K0(n,s,l,d,g,k,b,Y,ne){return n=new Wv(n,s,l,Y,ne),s===1?(s=1,k===!0&&(s|=8)):s=0,k=pn(3,null,null,s),n.current=k,k.stateNode=n,k.memoizedState={element:d,isDehydrated:l,cache:null,transitions:null,pendingSuspenseBoundaries:null},l0(k),n}function $v(n,s,l){var d=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:X,key:d==null?null:""+d,children:n,containerInfo:s,implementation:l}}function t1(n){if(!n)return ka;n=n._reactInternals;e:{if(W(n)!==n||n.tag!==1)throw Error(t(170));var s=n;do{switch(s.tag){case 3:s=s.stateNode.context;break e;case 1:if(Hr(s.type)){s=s.stateNode.__reactInternalMemoizedMergedChildContext;break e}}s=s.return}while(s!==null);throw Error(t(171))}if(n.tag===1){var l=n.type;if(Hr(l))return Ad(n,l,s)}return s}function r1(n,s,l,d,g,k,b,Y,ne){return n=K0(l,d,!0,n,g,k,b,Y,ne),n.context=t1(null),l=n.current,d=Or(),g=Na(l),k=ta(d,g),k.callback=s??null,Ta(l,k,g),n.current.lanes=g,ii(n,g,d),$r(n,d),n}function kl(n,s,l,d){var g=s.current,k=Or(),b=Na(g);return l=t1(l),s.context===null?s.context=l:s.pendingContext=l,s=ta(k,b),s.payload={element:n},d=d===void 0?null:d,d!==null&&(s.callback=d),n=Ta(g,s,b),n!==null&&(Rn(n,g,b,k),Zo(n,g,b)),b}function El(n){if(n=n.current,!n.child)return null;switch(n.child.tag){case 5:return n.child.stateNode;default:return n.child.stateNode}}function n1(n,s){if(n=n.memoizedState,n!==null&&n.dehydrated!==null){var l=n.retryLane;n.retryLane=l!==0&&l<s?l:s}}function Q0(n,s){n1(n,s),(n=n.alternate)&&n1(n,s)}function Xv(){return null}var a1=typeof reportError=="function"?reportError:function(n){console.error(n)};function q0(n){this._internalRoot=n}_l.prototype.render=q0.prototype.render=function(n){var s=this._internalRoot;if(s===null)throw Error(t(409));kl(n,s,null,null)},_l.prototype.unmount=q0.prototype.unmount=function(){var n=this._internalRoot;if(n!==null){this._internalRoot=null;var s=n.containerInfo;ts(function(){kl(null,n,null,null)}),s[Qn]=null}};function _l(n){this._internalRoot=n}_l.prototype.unstable_scheduleHydration=function(n){if(n){var s=zf();n={blockedOn:null,target:n,priority:s};for(var l=0;l<pa.length&&s!==0&&s<pa[l].priority;l++);pa.splice(l,0,n),l===0&&Wf(n)}};function Z0(n){return!(!n||n.nodeType!==1&&n.nodeType!==9&&n.nodeType!==11)}function Tl(n){return!(!n||n.nodeType!==1&&n.nodeType!==9&&n.nodeType!==11&&(n.nodeType!==8||n.nodeValue!==" react-mount-point-unstable "))}function s1(){}function Gv(n,s,l,d,g){if(g){if(typeof d=="function"){var k=d;d=function(){var we=El(b);k.call(we)}}var b=r1(s,d,n,0,null,!1,!1,"",s1);return n._reactRootContainer=b,n[Qn]=b.current,yi(n.nodeType===8?n.parentNode:n),ts(),b}for(;g=n.lastChild;)n.removeChild(g);if(typeof d=="function"){var Y=d;d=function(){var we=El(ne);Y.call(we)}}var ne=K0(n,0,!1,null,null,!1,!1,"",s1);return n._reactRootContainer=ne,n[Qn]=ne.current,yi(n.nodeType===8?n.parentNode:n),ts(function(){kl(s,ne,l,d)}),ne}function Sl(n,s,l,d,g){var k=l._reactRootContainer;if(k){var b=k;if(typeof g=="function"){var Y=g;g=function(){var ne=El(b);Y.call(ne)}}kl(s,b,n,g)}else b=Gv(l,s,n,g,d);return El(b)}Bf=function(n){switch(n.tag){case 3:var s=n.stateNode;if(s.current.memoizedState.isDehydrated){var l=si(s.pendingLanes);l!==0&&(Ec(s,l|1),$r(s,Pe()),(St&6)===0&&(Us=Pe()+500,Ea()))}break;case 13:ts(function(){var d=ea(n,1);if(d!==null){var g=Or();Rn(d,n,1,g)}}),Q0(n,1)}},_c=function(n){if(n.tag===13){var s=ea(n,134217728);if(s!==null){var l=Or();Rn(s,n,134217728,l)}Q0(n,134217728)}},Uf=function(n){if(n.tag===13){var s=Na(n),l=ea(n,s);if(l!==null){var d=Or();Rn(l,n,s,d)}Q0(n,s)}},zf=function(){return Dt},Hf=function(n,s){var l=Dt;try{return Dt=n,s()}finally{Dt=l}},sr=function(n,s,l){switch(s){case"input":if(Ge(n,l),s=l.name,l.type==="radio"&&s!=null){for(l=n;l.parentNode;)l=l.parentNode;for(l=l.querySelectorAll("input[name="+JSON.stringify(""+s)+'][type="radio"]'),s=0;s<l.length;s++){var d=l[s];if(d!==n&&d.form===n.form){var g=Ho(d);if(!g)throw Error(t(90));_e(d),Ge(d,g)}}}break;case"textarea":le(n,l);break;case"select":s=l.value,s!=null&&st(n,!!l.multiple,s,!1)}},ut=V0,be=ts;var Yv={usingClientEntryPoint:!1,Events:[_i,bs,Ho,Ie,$e,V0]},Li={findFiberByHostInstance:Ga,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},Kv={bundleType:Li.bundleType,version:Li.version,rendererPackageName:Li.rendererPackageName,rendererConfig:Li.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:N.ReactCurrentDispatcher,findHostInstanceByFiber:function(n){return n=he(n),n===null?null:n.stateNode},findFiberByHostInstance:Li.findFiberByHostInstance||Xv,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Cl=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Cl.isDisabled&&Cl.supportsFiber)try{zn=Cl.inject(Kv),ir=Cl}catch{}}return Xr.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Yv,Xr.createPortal=function(n,s){var l=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Z0(s))throw Error(t(200));return $v(n,s,null,l)},Xr.createRoot=function(n,s){if(!Z0(n))throw Error(t(299));var l=!1,d="",g=a1;return s!=null&&(s.unstable_strictMode===!0&&(l=!0),s.identifierPrefix!==void 0&&(d=s.identifierPrefix),s.onRecoverableError!==void 0&&(g=s.onRecoverableError)),s=K0(n,1,!1,null,null,l,!1,d,g),n[Qn]=s.current,yi(n.nodeType===8?n.parentNode:n),new q0(s)},Xr.findDOMNode=function(n){if(n==null)return null;if(n.nodeType===1)return n;var s=n._reactInternals;if(s===void 0)throw typeof n.render=="function"?Error(t(188)):(n=Object.keys(n).join(","),Error(t(268,n)));return n=he(s),n=n===null?null:n.stateNode,n},Xr.flushSync=function(n){return ts(n)},Xr.hydrate=function(n,s,l){if(!Tl(s))throw Error(t(200));return Sl(null,n,s,!0,l)},Xr.hydrateRoot=function(n,s,l){if(!Z0(n))throw Error(t(405));var d=l!=null&&l.hydratedSources||null,g=!1,k="",b=a1;if(l!=null&&(l.unstable_strictMode===!0&&(g=!0),l.identifierPrefix!==void 0&&(k=l.identifierPrefix),l.onRecoverableError!==void 0&&(b=l.onRecoverableError)),s=r1(s,null,n,1,l??null,g,!1,k,b),n[Qn]=s.current,yi(n),d)for(n=0;n<d.length;n++)l=d[n],g=l._getVersion,g=g(l._source),s.mutableSourceEagerHydrationData==null?s.mutableSourceEagerHydrationData=[l,g]:s.mutableSourceEagerHydrationData.push(l,g);return new _l(s)},Xr.render=function(n,s,l){if(!Tl(s))throw Error(t(200));return Sl(null,n,s,!1,l)},Xr.unmountComponentAtNode=function(n){if(!Tl(n))throw Error(t(40));return n._reactRootContainer?(ts(function(){Sl(null,null,n,!1,function(){n._reactRootContainer=null,n[Qn]=null})}),!0):!1},Xr.unstable_batchedUpdates=V0,Xr.unstable_renderSubtreeIntoContainer=function(n,s,l,d){if(!Tl(l))throw Error(t(200));if(n==null||n._reactInternals===void 0)throw Error(t(38));return Sl(n,s,l,!1,d)},Xr.version="18.3.1-next-f1338f8080-20240426",Xr}var h1;function Qx(){if(h1)return tu.exports;h1=1;function e(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(r){console.error(r)}}return e(),tu.exports=r2(),tu.exports}var x1;function n2(){if(x1)return bl;x1=1;var e=Qx();return bl.createRoot=e.createRoot,bl.hydrateRoot=e.hydrateRoot,bl}var a2=n2();const s2=ac(a2),i2="modulepreload",o2=function(e){return"/gestore/"+e},m1={},Vi=function(r,t,a){let i=Promise.resolve();if(t&&t.length>0){let u=function(x){return Promise.all(x.map(m=>Promise.resolve(m).then(w=>({status:"fulfilled",value:w}),w=>({status:"rejected",reason:w}))))};document.getElementsByTagName("link");const c=document.querySelector("meta[property=csp-nonce]"),h=(c==null?void 0:c.nonce)||(c==null?void 0:c.getAttribute("nonce"));i=u(t.map(x=>{if(x=o2(x),x in m1)return;m1[x]=!0;const m=x.endsWith(".css"),w=m?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${x}"]${w}`))return;const p=document.createElement("link");if(p.rel=m?"stylesheet":i2,m||(p.as="script"),p.crossOrigin="",p.href=x,h&&p.setAttribute("nonce",h),document.head.appendChild(p),m)return new Promise((v,y)=>{p.addEventListener("load",v),p.addEventListener("error",()=>y(new Error(`Unable to preload CSS for ${x}`)))})}))}function o(u){const c=new Event("vite:preloadError",{cancelable:!0});if(c.payload=u,window.dispatchEvent(c),!c.defaultPrevented)throw u}return i.then(u=>{for(const c of u||[])c.status==="rejected"&&o(c.reason);return r().catch(o)})},nn={Alimentari:["Supermercato","Ristorante","Bar","Caff"],Trasporti:["Mezzi Pubblici","Benzina","Taxi","Manutenzione Auto","Pedaggio"],Casa:["Affitto/Mutuo","Bollette","Manutenzione","Arredamento"],Shopping:["Abbigliamento","Elettronica","Libri","Regali"],"Tempo Libero":["Cinema","Concerti","Sport","Viaggi"],Salute:["Farmacia","Visite Mediche","Assicurazione"],Istruzione:["Corsi","Libri","Tasse Scolastiche"],Lavoro:["Pranzi","Materiale Ufficio"],Altro:[]};function Wi(e,r){const[t,a]=I.useState(()=>{try{const i=window.localStorage.getItem(e);if(i==null)return r;const o=JSON.parse(i);return o==null&&r!==null?r:o}catch(i){return console.error(i),r}});return I.useEffect(()=>{try{t===void 0?window.localStorage.removeItem(e):window.localStorage.setItem(e,JSON.stringify(t))}catch(i){console.error(i)}},[e,t]),[t,a]}const l2=()=>{const[e,r]=I.useState(navigator.onLine);return I.useEffect(()=>{const t=()=>r(!0),a=()=>r(!1);return window.addEventListener("online",t),window.addEventListener("offline",a),()=>{window.removeEventListener("online",t),window.removeEventListener("offline",a)}},[]),e},Ru=(e,r)=>r.some(t=>e instanceof t);let p1,g1;function c2(){return p1||(p1=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function u2(){return g1||(g1=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const Pu=new WeakMap,au=new WeakMap,sc=new WeakMap;function f2(e){const r=new Promise((t,a)=>{const i=()=>{e.removeEventListener("success",o),e.removeEventListener("error",u)},o=()=>{t(os(e.result)),i()},u=()=>{a(e.error),i()};e.addEventListener("success",o),e.addEventListener("error",u)});return sc.set(r,e),r}function d2(e){if(Pu.has(e))return;const r=new Promise((t,a)=>{const i=()=>{e.removeEventListener("complete",o),e.removeEventListener("error",u),e.removeEventListener("abort",u)},o=()=>{t(),i()},u=()=>{a(e.error||new DOMException("AbortError","AbortError")),i()};e.addEventListener("complete",o),e.addEventListener("error",u),e.addEventListener("abort",u)});Pu.set(e,r)}let Ou={get(e,r,t){if(e instanceof IDBTransaction){if(r==="done")return Pu.get(e);if(r==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return os(e[r])},set(e,r,t){return e[r]=t,!0},has(e,r){return e instanceof IDBTransaction&&(r==="done"||r==="store")?!0:r in e}};function qx(e){Ou=e(Ou)}function h2(e){return u2().includes(e)?function(...r){return e.apply(ju(this),r),os(this.request)}:function(...r){return os(e.apply(ju(this),r))}}function x2(e){return typeof e=="function"?h2(e):(e instanceof IDBTransaction&&d2(e),Ru(e,c2())?new Proxy(e,Ou):e)}function os(e){if(e instanceof IDBRequest)return f2(e);if(au.has(e))return au.get(e);const r=x2(e);return r!==e&&(au.set(e,r),sc.set(r,e)),r}const ju=e=>sc.get(e);function m2(e,r,{blocked:t,upgrade:a,blocking:i,terminated:o}={}){const u=indexedDB.open(e,r),c=os(u);return a&&u.addEventListener("upgradeneeded",h=>{a(os(u.result),h.oldVersion,h.newVersion,os(u.transaction),h)}),t&&u.addEventListener("blocked",h=>t(h.oldVersion,h.newVersion,h)),c.then(h=>{o&&h.addEventListener("close",()=>o()),i&&h.addEventListener("versionchange",x=>i(x.oldVersion,x.newVersion,x))}).catch(()=>{}),c}const p2=["get","getKey","getAll","getAllKeys","count"],g2=["put","add","delete","clear"],su=new Map;function v1(e,r){if(!(e instanceof IDBDatabase&&!(r in e)&&typeof r=="string"))return;if(su.get(r))return su.get(r);const t=r.replace(/FromIndex$/,""),a=r!==t,i=g2.includes(t);if(!(t in(a?IDBIndex:IDBObjectStore).prototype)||!(i||p2.includes(t)))return;const o=async function(u,...c){const h=this.transaction(u,i?"readwrite":"readonly");let x=h.store;return a&&(x=x.index(c.shift())),(await Promise.all([x[t](...c),i&&h.done]))[0]};return su.set(r,o),o}qx(e=>({...e,get:(r,t,a)=>v1(r,t)||e.get(r,t,a),has:(r,t)=>!!v1(r,t)||e.has(r,t)}));const v2=["continue","continuePrimaryKey","advance"],w1={},Lu=new WeakMap,Zx=new WeakMap,w2={get(e,r){if(!v2.includes(r))return e[r];let t=w1[r];return t||(t=w1[r]=function(...a){Lu.set(this,Zx.get(this)[r](...a))}),t}};async function*y2(...e){let r=this;if(r instanceof IDBCursor||(r=await r.openCursor(...e)),!r)return;r=r;const t=new Proxy(r,w2);for(Zx.set(t,r),sc.set(t,ju(r));r;)yield t,r=await(Lu.get(t)||r.continue()),Lu.delete(t)}function y1(e,r){return r===Symbol.asyncIterator&&Ru(e,[IDBIndex,IDBObjectStore,IDBCursor])||r==="iterate"&&Ru(e,[IDBIndex,IDBObjectStore])}qx(e=>({...e,get(r,t,a){return y1(r,t)?y2:e.get(r,t,a)},has(r,t){return y1(r,t)||e.has(r,t)}}));const k2="expense-manager-db",ro="offline-images",E2=1;let Oa=null;const k1=()=>(Oa||(Oa=m2(k2,E2,{upgrade(e){e.objectStoreNames.contains(ro)||e.createObjectStore(ro,{keyPath:"id"})},blocked(){console.warn("Database blocked")},blocking(){Oa&&(Oa.then(e=>e.close()),Oa=null)},terminated(){Oa=null}})),Oa);async function qu(e){try{const r=await k1();return await e(r)}catch(r){if(r&&(r.message&&(r.message.includes("closing")||r.message.includes("closed"))||r.name==="InvalidStateError")){console.warn("Database connection issue, retrying...",r),Oa=null;const t=await k1();return await e(t)}throw r}}const Nl=async e=>{await qu(async r=>{await r.put(ro,e)})},iu=async()=>await qu(async e=>await e.getAll(ro)),E1=async e=>{await qu(async r=>{await r.delete(ro,e)})},_2=[{id:"cash",name:"Contanti"},{id:"credit-card",name:"Carta di Credito"},{id:"bank-account",name:"Conto Bancario"},{id:"paypal",name:"PayPal"},{id:"revolut",name:"Revolut"},{id:"poste",name:"PostePay"},{id:"crypto",name:"Cripto"}];/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var kn=1200,T2=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],Zu={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},Ju=function(e){T2.indexOf(e)!=-1&&(Zu[0]=e)};function S2(){Ju(1252)}var On=function(e){kn=e,Ju(e)};function Jx(){On(1200),S2()}function _1(e){for(var r=[],t=0,a=e.length;t<a;++t)r[t]=e.charCodeAt(t);return r}function em(e){for(var r=[],t=0;t<e.length>>1;++t)r[t]=String.fromCharCode(e.charCodeAt(2*t)+(e.charCodeAt(2*t+1)<<8));return r.join("")}function C2(e){for(var r=[],t=0;t<e.length>>1;++t)r[t]=String.fromCharCode(e[2*t]+(e[2*t+1]<<8));return r.join("")}function tm(e){for(var r=[],t=0;t<e.length>>1;++t)r[t]=String.fromCharCode(e.charCodeAt(2*t+1)+(e.charCodeAt(2*t)<<8));return r.join("")}var Ui=function(e){var r=e.charCodeAt(0),t=e.charCodeAt(1);return r==255&&t==254?em(e.slice(2)):r==254&&t==255?tm(e.slice(2)):r==65279?e.slice(1):e},Al=function(r){return String.fromCharCode(r)},T1=function(r){return String.fromCharCode(r)},b2=null,La="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function S1(e){for(var r="",t=0,a=0,i=0,o=0,u=0,c=0,h=0,x=0;x<e.length;)t=e.charCodeAt(x++),o=t>>2,a=e.charCodeAt(x++),u=(t&3)<<4|a>>4,i=e.charCodeAt(x++),c=(a&15)<<2|i>>6,h=i&63,isNaN(a)?c=h=64:isNaN(i)&&(h=64),r+=La.charAt(o)+La.charAt(u)+La.charAt(c)+La.charAt(h);return r}function sn(e){var r="",t=0,a=0,i=0,o=0,u=0,c=0,h=0;if(e.slice(0,5)=="data:"){var x=e.slice(0,1024).indexOf(";base64,");x>-1&&(e=e.slice(x+8))}e=e.replace(/[^\w\+\/\=]/g,"");for(var x=0;x<e.length;)o=La.indexOf(e.charAt(x++)),u=La.indexOf(e.charAt(x++)),t=o<<2|u>>4,r+=String.fromCharCode(t),c=La.indexOf(e.charAt(x++)),a=(u&15)<<4|c>>2,c!==64&&(r+=String.fromCharCode(a)),h=La.indexOf(e.charAt(x++)),i=(c&3)<<6|h,h!==64&&(r+=String.fromCharCode(i));return r}var vt=(function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node})(),Wa=(function(){if(typeof Buffer<"u"){var e=!Buffer.from;if(!e)try{Buffer.from("foo","utf8")}catch{e=!0}return e?function(r,t){return t?new Buffer(r,t):new Buffer(r)}:Buffer.from.bind(Buffer)}return function(){}})(),no=(function(){if(typeof Buffer>"u")return!1;var e=Wa([65,0]);if(!e)return!1;var r=e.toString("utf16le");return r.length==1})();function Ua(e){return vt?Buffer.alloc?Buffer.alloc(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}function C1(e){return vt?Buffer.allocUnsafe?Buffer.allocUnsafe(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}var tn=function(r){return vt?Wa(r,"binary"):r.split("").map(function(t){return t.charCodeAt(0)&255})};function ca(e){if(Array.isArray(e))return e.map(function(a){return String.fromCharCode(a)}).join("");for(var r=[],t=0;t<e.length;++t)r[t]=String.fromCharCode(e[t]);return r.join("")}function ef(e){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(e instanceof ArrayBuffer)return ef(new Uint8Array(e));for(var r=new Array(e.length),t=0;t<e.length;++t)r[t]=e[t];return r}var ja=vt?function(e){return Buffer.concat(e.map(function(r){return Buffer.isBuffer(r)?r:Wa(r)}))}:function(e){if(typeof Uint8Array<"u"){var r=0,t=0;for(r=0;r<e.length;++r)t+=e[r].length;var a=new Uint8Array(t),i=0;for(r=0,t=0;r<e.length;t+=i,++r)i=e[r].length,e[r]instanceof Uint8Array?a.set(e[r],t):typeof e[r]=="string"?a.set(new Uint8Array(tn(e[r])),t):a.set(new Uint8Array(e[r]),t);return a}return[].concat.apply([],e.map(function(o){return Array.isArray(o)?o:[].slice.call(o)}))};function N2(e){for(var r=[],t=0,a=e.length+250,i=Ua(e.length+255),o=0;o<e.length;++o){var u=e.charCodeAt(o);if(u<128)i[t++]=u;else if(u<2048)i[t++]=192|u>>6&31,i[t++]=128|u&63;else if(u>=55296&&u<57344){u=(u&1023)+64;var c=e.charCodeAt(++o)&1023;i[t++]=240|u>>8&7,i[t++]=128|u>>2&63,i[t++]=128|c>>6&15|(u&3)<<4,i[t++]=128|c&63}else i[t++]=224|u>>12&15,i[t++]=128|u>>6&63,i[t++]=128|u&63;t>a&&(r.push(i.slice(0,t)),t=0,i=Ua(65535),a=65530)}return r.push(i.slice(0,t)),ja(r)}var Yr=/\u0000/g,zi=/[\u0001-\u0006]/g;function Gs(e){for(var r="",t=e.length-1;t>=0;)r+=e.charAt(t--);return r}function jn(e,r){var t=""+e;return t.length>=r?t:kt("0",r-t.length)+t}function tf(e,r){var t=""+e;return t.length>=r?t:kt(" ",r-t.length)+t}function Wl(e,r){var t=""+e;return t.length>=r?t:t+kt(" ",r-t.length)}function A2(e,r){var t=""+Math.round(e);return t.length>=r?t:kt("0",r-t.length)+t}function F2(e,r){var t=""+e;return t.length>=r?t:kt("0",r-t.length)+t}var b1=Math.pow(2,32);function Hs(e,r){if(e>b1||e<-b1)return A2(e,r);var t=Math.round(e);return F2(t,r)}function $l(e,r){return r=r||0,e.length>=7+r&&(e.charCodeAt(r)|32)===103&&(e.charCodeAt(r+1)|32)===101&&(e.charCodeAt(r+2)|32)===110&&(e.charCodeAt(r+3)|32)===101&&(e.charCodeAt(r+4)|32)===114&&(e.charCodeAt(r+5)|32)===97&&(e.charCodeAt(r+6)|32)===108}var N1=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],ou=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function I2(e){return e||(e={}),e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"/ "hh""mm""ss" "',e}var ht={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},A1={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},D2={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function Xl(e,r,t){for(var a=e<0?-1:1,i=e*a,o=0,u=1,c=0,h=1,x=0,m=0,w=Math.floor(i);x<r&&(w=Math.floor(i),c=w*u+o,m=w*x+h,!(i-w<5e-8));)i=1/(i-w),o=u,u=c,h=x,x=m;if(m>r&&(x>r?(m=h,c=o):(m=x,c=u)),!t)return[0,a*c,m];var p=Math.floor(a*c/m);return[p,a*c-p*m,m]}function R2(e){var r=e.toPrecision(16);if(r.indexOf("e")>-1){var t=r.slice(0,r.indexOf("e"));return t=t.indexOf(".")>-1?t.slice(0,t.slice(0,2)=="0."?17:16):t.slice(0,15)+kt("0",t.length-15),t+r.slice(r.indexOf("e"))}var a=r.indexOf(".")>-1?r.slice(0,r.slice(0,2)=="0."?17:16):r.slice(0,15)+kt("0",r.length-15);return Number(a)}function aa(e,r,t){if(e>2958465||e<0)return null;e=R2(e);var a=e|0,i=Math.floor(86400*(e-a)),o=0,u=[],c={D:a,T:i,u:86400*(e-a)-i,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(c.u)<1e-6&&(c.u=0),r&&r.date1904&&(a+=1462),c.u>.9999&&(c.u=0,++i==86400&&(c.T=i=0,++a,++c.D)),a===60)u=t?[1317,10,29]:[1900,2,29],o=3;else if(a===0)u=t?[1317,8,29]:[1900,1,0],o=6;else{a>60&&--a;var h=new Date(1900,0,1);h.setDate(h.getDate()+a-1),u=[h.getFullYear(),h.getMonth()+1,h.getDate()],o=h.getDay(),a<60&&(o=(o+6)%7),t&&(o=L2(h,u))}return c.y=u[0],c.m=u[1],c.d=u[2],c.S=i%60,i=Math.floor(i/60),c.M=i%60,i=Math.floor(i/60),c.H=i,c.q=o,c}function rf(e){return e.indexOf(".")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function P2(e){return e.indexOf("E")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function O2(e){var r=e<0?12:11,t=rf(e.toFixed(12));return t.length<=r||(t=e.toPrecision(10),t.length<=r)?t:e.toExponential(5)}function j2(e){var r=rf(e.toFixed(11));return r.length>(e<0?12:11)||r==="0"||r==="-0"?e.toPrecision(6):r}function ao(e){if(!isFinite(e))return isNaN(e)?"#NUM!":"#DIV/0!";var r=Math.floor(Math.log(Math.abs(e))*Math.LOG10E),t;return r>=-4&&r<=-1?t=e.toPrecision(10+r):Math.abs(r)<=9?t=O2(e):r===10?t=e.toFixed(10).substr(0,12):t=j2(e),rf(P2(t.toUpperCase()))}function ds(e,r){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(e|0)===e?e.toString(10):ao(e);case"undefined":return"";case"object":if(e==null)return"";if(e instanceof Date)return on(14,ar(e,r&&r.date1904),r)}throw new Error("unsupported value in General format: "+e)}function L2(e,r){r[0]-=581;var t=e.getDay();return e<60&&(t=(t+6)%7),t}function M2(e,r,t,a){var i="",o=0,u=0,c=t.y,h,x=0;switch(e){case 98:c=t.y+543;case 121:switch(r.length){case 1:case 2:h=c%100,x=2;break;default:h=c%1e4,x=4;break}break;case 109:switch(r.length){case 1:case 2:h=t.m,x=r.length;break;case 3:return ou[t.m-1][1];case 5:return ou[t.m-1][0];default:return ou[t.m-1][2]}break;case 100:switch(r.length){case 1:case 2:h=t.d,x=r.length;break;case 3:return N1[t.q][0];default:return N1[t.q][1]}break;case 104:switch(r.length){case 1:case 2:h=1+(t.H+11)%12,x=r.length;break;default:throw"bad hour format: "+r}break;case 72:switch(r.length){case 1:case 2:h=t.H,x=r.length;break;default:throw"bad hour format: "+r}break;case 77:switch(r.length){case 1:case 2:h=t.M,x=r.length;break;default:throw"bad minute format: "+r}break;case 115:if(r!="s"&&r!="ss"&&r!=".0"&&r!=".00"&&r!=".000")throw"bad second format: "+r;return t.u===0&&(r=="s"||r=="ss")?jn(t.S,r.length):(a>=2?u=a===3?1e3:100:u=a===1?10:1,o=Math.round(u*(t.S+t.u)),o>=60*u&&(o=0),r==="s"?o===0?"0":""+o/u:(i=jn(o,2+a),r==="ss"?i.substr(0,2):"."+i.substr(2,r.length-1)));case 90:switch(r){case"[h]":case"[hh]":h=t.D*24+t.H;break;case"[m]":case"[mm]":h=(t.D*24+t.H)*60+t.M;break;case"[s]":case"[ss]":h=((t.D*24+t.H)*60+t.M)*60+(a==0?Math.round(t.S+t.u):t.S);break;default:throw"bad abstime format: "+r}x=r.length===3?1:2;break;case 101:h=c,x=1;break}var m=x>0?jn(h,x):"";return m}function sa(e){var r=3;if(e.length<=r)return e;for(var t=e.length%r,a=e.substr(0,t);t!=e.length;t+=r)a+=(a.length>0?",":"")+e.substr(t,r);return a}var rm=/%/g;function B2(e,r,t){var a=r.replace(rm,""),i=r.length-a.length;return oa(e,a,t*Math.pow(10,2*i))+kt("%",i)}function U2(e,r,t){for(var a=r.length-1;r.charCodeAt(a-1)===44;)--a;return oa(e,r.substr(0,a),t/Math.pow(10,3*(r.length-a)))}function nm(e,r){var t,a=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(r==0)return"0.0E+0";if(r<0)return"-"+nm(e,-r);var i=e.indexOf(".");i===-1&&(i=e.indexOf("E"));var o=Math.floor(Math.log(r)*Math.LOG10E)%i;if(o<0&&(o+=i),t=(r/Math.pow(10,o)).toPrecision(a+1+(i+o)%i),t.indexOf("e")===-1){var u=Math.floor(Math.log(r)*Math.LOG10E);for(t.indexOf(".")===-1?t=t.charAt(0)+"."+t.substr(1)+"E+"+(u-t.length+o):t+="E+"+(u-o);t.substr(0,2)==="0.";)t=t.charAt(0)+t.substr(2,i)+"."+t.substr(2+i),t=t.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");t=t.replace(/\+-/,"-")}t=t.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(c,h,x,m){return h+x+m.substr(0,(i+o)%i)+"."+m.substr(o)+"E"})}else t=r.toExponential(a);return e.match(/E\+00$/)&&t.match(/e[+-]\d$/)&&(t=t.substr(0,t.length-1)+"0"+t.charAt(t.length-1)),e.match(/E\-/)&&t.match(/e\+/)&&(t=t.replace(/e\+/,"e")),t.replace("e","E")}var am=/# (\?+)( ?)\/( ?)(\d+)/;function z2(e,r,t){var a=parseInt(e[4],10),i=Math.round(r*a),o=Math.floor(i/a),u=i-o*a,c=a;return t+(o===0?"":""+o)+" "+(u===0?kt(" ",e[1].length+1+e[4].length):tf(u,e[1].length)+e[2]+"/"+e[3]+jn(c,e[4].length))}function H2(e,r,t){return t+(r===0?"":""+r)+kt(" ",e[1].length+2+e[4].length)}var sm=/^#*0*\.([0#]+)/,im=/\)[^)]*[0#]/,om=/\(###\) ###\\?-####/;function jr(e){for(var r="",t,a=0;a!=e.length;++a)switch(t=e.charCodeAt(a)){case 35:break;case 63:r+=" ";break;case 48:r+="0";break;default:r+=String.fromCharCode(t)}return r}function F1(e,r){var t=Math.pow(10,r);return""+Math.round(e*t)/t}function I1(e,r){var t=e-Math.floor(e),a=Math.pow(10,r);return r<(""+Math.round(t*a)).length?0:Math.round(t*a)}function V2(e,r){return r<(""+Math.round((e-Math.floor(e))*Math.pow(10,r))).length?1:0}function W2(e){return e<2147483647&&e>-2147483648?""+(e>=0?e|0:e-1|0):""+Math.floor(e)}function wn(e,r,t){if(e.charCodeAt(0)===40&&!r.match(im)){var a=r.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return t>=0?wn("n",a,t):"("+wn("n",a,-t)+")"}if(r.charCodeAt(r.length-1)===44)return U2(e,r,t);if(r.indexOf("%")!==-1)return B2(e,r,t);if(r.indexOf("E")!==-1)return nm(r,t);if(r.charCodeAt(0)===36)return"$"+wn(e,r.substr(r.charAt(1)==" "?2:1),t);var i,o,u,c,h=Math.abs(t),x=t<0?"-":"";if(r.match(/^00+$/))return x+Hs(h,r.length);if(r.match(/^[#?]+$/))return i=Hs(t,0),i==="0"&&(i=""),i.length>r.length?i:jr(r.substr(0,r.length-i.length))+i;if(o=r.match(am))return z2(o,h,x);if(r.match(/^#+0+$/))return x+Hs(h,r.length-r.indexOf("0"));if(o=r.match(sm))return i=F1(t,o[1].length).replace(/^([^\.]+)$/,"$1."+jr(o[1])).replace(/\.$/,"."+jr(o[1])).replace(/\.(\d*)$/,function(y,T){return"."+T+kt("0",jr(o[1]).length-T.length)}),r.indexOf("0.")!==-1?i:i.replace(/^0\./,".");if(r=r.replace(/^#+([0.])/,"$1"),o=r.match(/^(0*)\.(#*)$/))return x+F1(h,o[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,o[1].length?"0.":".");if(o=r.match(/^#{1,3},##0(\.?)$/))return x+sa(Hs(h,0));if(o=r.match(/^#,##0\.([#0]*0)$/))return t<0?"-"+wn(e,r,-t):sa(""+(Math.floor(t)+V2(t,o[1].length)))+"."+jn(I1(t,o[1].length),o[1].length);if(o=r.match(/^#,#*,#0/))return wn(e,r.replace(/^#,#*,/,""),t);if(o=r.match(/^([0#]+)(\\?-([0#]+))+$/))return i=Gs(wn(e,r.replace(/[\\-]/g,""),t)),u=0,Gs(Gs(r.replace(/\\/g,"")).replace(/[0#]/g,function(y){return u<i.length?i.charAt(u++):y==="0"?"0":""}));if(r.match(om))return i=wn(e,"##########",t),"("+i.substr(0,3)+") "+i.substr(3,3)+"-"+i.substr(6);var m="";if(o=r.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return u=Math.min(o[4].length,7),c=Xl(h,Math.pow(10,u)-1,!1),i=""+x,m=oa("n",o[1],c[1]),m.charAt(m.length-1)==" "&&(m=m.substr(0,m.length-1)+"0"),i+=m+o[2]+"/"+o[3],m=Wl(c[2],u),m.length<o[4].length&&(m=jr(o[4].substr(o[4].length-m.length))+m),i+=m,i;if(o=r.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return u=Math.min(Math.max(o[1].length,o[4].length),7),c=Xl(h,Math.pow(10,u)-1,!0),x+(c[0]||(c[1]?"":"0"))+" "+(c[1]?tf(c[1],u)+o[2]+"/"+o[3]+Wl(c[2],u):kt(" ",2*u+1+o[2].length+o[3].length));if(o=r.match(/^[#0?]+$/))return i=Hs(t,0),r.length<=i.length?i:jr(r.substr(0,r.length-i.length))+i;if(o=r.match(/^([#0?]+)\.([#0]+)$/)){i=""+t.toFixed(Math.min(o[2].length,10)).replace(/([^0])0+$/,"$1"),u=i.indexOf(".");var w=r.indexOf(".")-u,p=r.length-i.length-w;return jr(r.substr(0,w)+i+r.substr(r.length-p))}if(o=r.match(/^00,000\.([#0]*0)$/))return u=I1(t,o[1].length),t<0?"-"+wn(e,r,-t):sa(W2(t)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(y){return"00,"+(y.length<3?jn(0,3-y.length):"")+y})+"."+jn(u,o[1].length);switch(r){case"###,##0.00":return wn(e,"#,##0.00",t);case"###,###":case"##,###":case"#,###":var v=sa(Hs(h,0));return v!=="0"?x+v:"";case"###,###.00":return wn(e,"###,##0.00",t).replace(/^0\./,".");case"#,###.00":return wn(e,"#,##0.00",t).replace(/^0\./,".")}throw new Error("unsupported format |"+r+"|")}function $2(e,r,t){for(var a=r.length-1;r.charCodeAt(a-1)===44;)--a;return oa(e,r.substr(0,a),t/Math.pow(10,3*(r.length-a)))}function X2(e,r,t){var a=r.replace(rm,""),i=r.length-a.length;return oa(e,a,t*Math.pow(10,2*i))+kt("%",i)}function lm(e,r){var t,a=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(r==0)return"0.0E+0";if(r<0)return"-"+lm(e,-r);var i=e.indexOf(".");i===-1&&(i=e.indexOf("E"));var o=Math.floor(Math.log(r)*Math.LOG10E)%i;if(o<0&&(o+=i),t=(r/Math.pow(10,o)).toPrecision(a+1+(i+o)%i),!t.match(/[Ee]/)){var u=Math.floor(Math.log(r)*Math.LOG10E);t.indexOf(".")===-1?t=t.charAt(0)+"."+t.substr(1)+"E+"+(u-t.length+o):t+="E+"+(u-o),t=t.replace(/\+-/,"-")}t=t.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(c,h,x,m){return h+x+m.substr(0,(i+o)%i)+"."+m.substr(o)+"E"})}else t=r.toExponential(a);return e.match(/E\+00$/)&&t.match(/e[+-]\d$/)&&(t=t.substr(0,t.length-1)+"0"+t.charAt(t.length-1)),e.match(/E\-/)&&t.match(/e\+/)&&(t=t.replace(/e\+/,"e")),t.replace("e","E")}function Gn(e,r,t){if(e.charCodeAt(0)===40&&!r.match(im)){var a=r.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return t>=0?Gn("n",a,t):"("+Gn("n",a,-t)+")"}if(r.charCodeAt(r.length-1)===44)return $2(e,r,t);if(r.indexOf("%")!==-1)return X2(e,r,t);if(r.indexOf("E")!==-1)return lm(r,t);if(r.charCodeAt(0)===36)return"$"+Gn(e,r.substr(r.charAt(1)==" "?2:1),t);var i,o,u,c,h=Math.abs(t),x=t<0?"-":"";if(r.match(/^00+$/))return x+jn(h,r.length);if(r.match(/^[#?]+$/))return i=""+t,t===0&&(i=""),i.length>r.length?i:jr(r.substr(0,r.length-i.length))+i;if(o=r.match(am))return H2(o,h,x);if(r.match(/^#+0+$/))return x+jn(h,r.length-r.indexOf("0"));if(o=r.match(sm))return i=(""+t).replace(/^([^\.]+)$/,"$1."+jr(o[1])).replace(/\.$/,"."+jr(o[1])),i=i.replace(/\.(\d*)$/,function(y,T){return"."+T+kt("0",jr(o[1]).length-T.length)}),r.indexOf("0.")!==-1?i:i.replace(/^0\./,".");if(r=r.replace(/^#+([0.])/,"$1"),o=r.match(/^(0*)\.(#*)$/))return x+(""+h).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,o[1].length?"0.":".");if(o=r.match(/^#{1,3},##0(\.?)$/))return x+sa(""+h);if(o=r.match(/^#,##0\.([#0]*0)$/))return t<0?"-"+Gn(e,r,-t):sa(""+t)+"."+kt("0",o[1].length);if(o=r.match(/^#,#*,#0/))return Gn(e,r.replace(/^#,#*,/,""),t);if(o=r.match(/^([0#]+)(\\?-([0#]+))+$/))return i=Gs(Gn(e,r.replace(/[\\-]/g,""),t)),u=0,Gs(Gs(r.replace(/\\/g,"")).replace(/[0#]/g,function(y){return u<i.length?i.charAt(u++):y==="0"?"0":""}));if(r.match(om))return i=Gn(e,"##########",t),"("+i.substr(0,3)+") "+i.substr(3,3)+"-"+i.substr(6);var m="";if(o=r.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return u=Math.min(o[4].length,7),c=Xl(h,Math.pow(10,u)-1,!1),i=""+x,m=oa("n",o[1],c[1]),m.charAt(m.length-1)==" "&&(m=m.substr(0,m.length-1)+"0"),i+=m+o[2]+"/"+o[3],m=Wl(c[2],u),m.length<o[4].length&&(m=jr(o[4].substr(o[4].length-m.length))+m),i+=m,i;if(o=r.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return u=Math.min(Math.max(o[1].length,o[4].length),7),c=Xl(h,Math.pow(10,u)-1,!0),x+(c[0]||(c[1]?"":"0"))+" "+(c[1]?tf(c[1],u)+o[2]+"/"+o[3]+Wl(c[2],u):kt(" ",2*u+1+o[2].length+o[3].length));if(o=r.match(/^[#0?]+$/))return i=""+t,r.length<=i.length?i:jr(r.substr(0,r.length-i.length))+i;if(o=r.match(/^([#0]+)\.([#0]+)$/)){i=""+t.toFixed(Math.min(o[2].length,10)).replace(/([^0])0+$/,"$1"),u=i.indexOf(".");var w=r.indexOf(".")-u,p=r.length-i.length-w;return jr(r.substr(0,w)+i+r.substr(r.length-p))}if(o=r.match(/^00,000\.([#0]*0)$/))return t<0?"-"+Gn(e,r,-t):sa(""+t).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(y){return"00,"+(y.length<3?jn(0,3-y.length):"")+y})+"."+jn(0,o[1].length);switch(r){case"###,###":case"##,###":case"#,###":var v=sa(""+h);return v!=="0"?x+v:"";default:if(r.match(/\.[0#?]*$/))return Gn(e,r.slice(0,r.lastIndexOf(".")),t)+jr(r.slice(r.lastIndexOf(".")))}throw new Error("unsupported format |"+r+"|")}function oa(e,r,t){return(t|0)===t?Gn(e,r,t):wn(e,r,t)}function G2(e){for(var r=[],t=!1,a=0,i=0;a<e.length;++a)switch(e.charCodeAt(a)){case 34:t=!t;break;case 95:case 42:case 92:++a;break;case 59:r[r.length]=e.substr(i,a-i),i=a+1}if(r[r.length]=e.substr(i),t===!0)throw new Error("Format |"+e+"| unterminated string ");return r}var cm=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function Mn(e){for(var r=0,t="",a="";r<e.length;)switch(t=e.charAt(r)){case"G":$l(e,r)&&(r+=6),r++;break;case'"':for(;e.charCodeAt(++r)!==34&&r<e.length;);++r;break;case"\\":r+=2;break;case"_":r+=2;break;case"@":++r;break;case"B":case"b":if(e.charAt(r+1)==="1"||e.charAt(r+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(e.substr(r,3).toUpperCase()==="A/P"||e.substr(r,5).toUpperCase()==="AM/PM"||e.substr(r,5).toUpperCase()==="/")return!0;++r;break;case"[":for(a=t;e.charAt(r++)!=="]"&&r<e.length;)a+=e.charAt(r);if(a.match(cm))return!0;break;case".":case"0":case"#":for(;r<e.length&&("0#?.,E+-%".indexOf(t=e.charAt(++r))>-1||t=="\\"&&e.charAt(r+1)=="-"&&"0#".indexOf(e.charAt(r+2))>-1););break;case"?":for(;e.charAt(++r)===t;);break;case"*":++r,(e.charAt(r)==" "||e.charAt(r)=="*")&&++r;break;case"(":case")":++r;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;r<e.length&&"0123456789".indexOf(e.charAt(++r))>-1;);break;case" ":++r;break;default:++r;break}return!1}function Y2(e,r,t,a){for(var i=[],o="",u=0,c="",h="t",x,m,w,p="H";u<e.length;)switch(c=e.charAt(u)){case"G":if(!$l(e,u))throw new Error("unrecognized character "+c+" in "+e);i[i.length]={t:"G",v:"General"},u+=7;break;case'"':for(o="";(w=e.charCodeAt(++u))!==34&&u<e.length;)o+=String.fromCharCode(w);i[i.length]={t:"t",v:o},++u;break;case"\\":var v=e.charAt(++u),y=v==="("||v===")"?v:"t";i[i.length]={t:y,v},++u;break;case"_":i[i.length]={t:"t",v:" "},u+=2;break;case"@":i[i.length]={t:"T",v:r},++u;break;case"B":case"b":if(e.charAt(u+1)==="1"||e.charAt(u+1)==="2"){if(x==null&&(x=aa(r,t,e.charAt(u+1)==="2"),x==null))return"";i[i.length]={t:"X",v:e.substr(u,2)},h=c,u+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":c=c.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(r<0||x==null&&(x=aa(r,t),x==null))return"";for(o=c;++u<e.length&&e.charAt(u).toLowerCase()===c;)o+=c;c==="m"&&h.toLowerCase()==="h"&&(c="M"),c==="h"&&(c=p),i[i.length]={t:c,v:o},h=c;break;case"A":case"a":case"":var T={t:c,v:c};if(x==null&&(x=aa(r,t)),e.substr(u,3).toUpperCase()==="A/P"?(x!=null&&(T.v=x.H>=12?e.charAt(u+2):c),T.t="T",p="h",u+=3):e.substr(u,5).toUpperCase()==="AM/PM"?(x!=null&&(T.v=x.H>=12?"PM":"AM"),T.t="T",u+=5,p="h"):e.substr(u,5).toUpperCase()==="/"?(x!=null&&(T.v=x.H>=12?"":""),T.t="T",u+=5,p="h"):(T.t="t",++u),x==null&&T.t==="T")return"";i[i.length]=T,h=c;break;case"[":for(o=c;e.charAt(u++)!=="]"&&u<e.length;)o+=e.charAt(u);if(o.slice(-1)!=="]")throw'unterminated "[" block: |'+o+"|";if(o.match(cm)){if(x==null&&(x=aa(r,t),x==null))return"";i[i.length]={t:"Z",v:o.toLowerCase()},h=o.charAt(1)}else o.indexOf("$")>-1&&(o=(o.match(/\$([^-\[\]]*)/)||[])[1]||"$",Mn(e)||(i[i.length]={t:"t",v:o}));break;case".":if(x!=null){for(o=c;++u<e.length&&(c=e.charAt(u))==="0";)o+=c;i[i.length]={t:"s",v:o};break}case"0":case"#":for(o=c;++u<e.length&&"0#?.,E+-%".indexOf(c=e.charAt(u))>-1;)o+=c;i[i.length]={t:"n",v:o};break;case"?":for(o=c;e.charAt(++u)===c;)o+=c;i[i.length]={t:c,v:o},h=c;break;case"*":++u,(e.charAt(u)==" "||e.charAt(u)=="*")&&++u;break;case"(":case")":i[i.length]={t:a===1?"t":c,v:c},++u;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(o=c;u<e.length&&"0123456789".indexOf(e.charAt(++u))>-1;)o+=e.charAt(u);i[i.length]={t:"D",v:o};break;case" ":i[i.length]={t:c,v:c},++u;break;case"$":i[i.length]={t:"t",v:"$"},++u;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(c)===-1)throw new Error("unrecognized character "+c+" in "+e);i[i.length]={t:"t",v:c},++u;break}var E=0,_=0,C;for(u=i.length-1,h="t";u>=0;--u)switch(i[u].t){case"h":case"H":i[u].t=p,h="h",E<1&&(E=1);break;case"s":(C=i[u].v.match(/\.0+$/))&&(_=Math.max(_,C[0].length-1),E=4),E<3&&(E=3);case"d":case"y":case"e":h=i[u].t;break;case"M":h=i[u].t,E<2&&(E=2);break;case"m":h==="s"&&(i[u].t="M",E<2&&(E=2));break;case"X":break;case"Z":E<1&&i[u].v.match(/[Hh]/)&&(E=1),E<2&&i[u].v.match(/[Mm]/)&&(E=2),E<3&&i[u].v.match(/[Ss]/)&&(E=3)}var S;switch(E){case 0:break;case 1:case 2:case 3:x.u>=.5&&(x.u=0,++x.S),x.S>=60&&(x.S=0,++x.M),x.M>=60&&(x.M=0,++x.H),x.H>=24&&(x.H=0,++x.D,S=aa(x.D),S.u=x.u,S.S=x.S,S.M=x.M,S.H=x.H,x=S);break;case 4:switch(_){case 1:x.u=Math.round(x.u*10)/10;break;case 2:x.u=Math.round(x.u*100)/100;break;case 3:x.u=Math.round(x.u*1e3)/1e3;break}x.u>=1&&(x.u=0,++x.S),x.S>=60&&(x.S=0,++x.M),x.M>=60&&(x.M=0,++x.H),x.H>=24&&(x.H=0,++x.D,S=aa(x.D),S.u=x.u,S.S=x.S,S.M=x.M,S.H=x.H,x=S);break}var N="",B;for(u=0;u<i.length;++u)switch(i[u].t){case"t":case"T":case" ":case"D":break;case"X":i[u].v="",i[u].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":i[u].v=M2(i[u].t.charCodeAt(0),i[u].v,x,_),i[u].t="t";break;case"n":case"?":for(B=u+1;i[B]!=null&&((c=i[B].t)==="?"||c==="D"||(c===" "||c==="t")&&i[B+1]!=null&&(i[B+1].t==="?"||i[B+1].t==="t"&&i[B+1].v==="/")||i[u].t==="("&&(c===" "||c==="n"||c===")")||c==="t"&&(i[B].v==="/"||i[B].v===" "&&i[B+1]!=null&&i[B+1].t=="?"));)i[u].v+=i[B].v,i[B]={v:"",t:";"},++B;N+=i[u].v,u=B-1;break;case"G":i[u].t="t",i[u].v=ds(r,t);break}var X="",j,z;if(N.length>0){N.charCodeAt(0)==40?(j=r<0&&N.charCodeAt(0)===45?-r:r,z=oa("n",N,j)):(j=r<0&&a>1?-r:r,z=oa("n",N,j),j<0&&i[0]&&i[0].t=="t"&&(z=z.substr(1),i[0].v="-"+i[0].v)),B=z.length-1;var M=i.length;for(u=0;u<i.length;++u)if(i[u]!=null&&i[u].t!="t"&&i[u].v.indexOf(".")>-1){M=u;break}var U=i.length;if(M===i.length&&z.indexOf("E")===-1){for(u=i.length-1;u>=0;--u)i[u]==null||"n?".indexOf(i[u].t)===-1||(B>=i[u].v.length-1?(B-=i[u].v.length,i[u].v=z.substr(B+1,i[u].v.length)):B<0?i[u].v="":(i[u].v=z.substr(0,B+1),B=-1),i[u].t="t",U=u);B>=0&&U<i.length&&(i[U].v=z.substr(0,B+1)+i[U].v)}else if(M!==i.length&&z.indexOf("E")===-1){for(B=z.indexOf(".")-1,u=M;u>=0;--u)if(!(i[u]==null||"n?".indexOf(i[u].t)===-1)){for(m=i[u].v.indexOf(".")>-1&&u===M?i[u].v.indexOf(".")-1:i[u].v.length-1,X=i[u].v.substr(m+1);m>=0;--m)B>=0&&(i[u].v.charAt(m)==="0"||i[u].v.charAt(m)==="#")&&(X=z.charAt(B--)+X);i[u].v=X,i[u].t="t",U=u}for(B>=0&&U<i.length&&(i[U].v=z.substr(0,B+1)+i[U].v),B=z.indexOf(".")+1,u=M;u<i.length;++u)if(!(i[u]==null||"n?(".indexOf(i[u].t)===-1&&u!==M)){for(m=i[u].v.indexOf(".")>-1&&u===M?i[u].v.indexOf(".")+1:0,X=i[u].v.substr(0,m);m<i[u].v.length;++m)B<z.length&&(X+=z.charAt(B++));i[u].v=X,i[u].t="t",U=u}}}for(u=0;u<i.length;++u)i[u]!=null&&"n?".indexOf(i[u].t)>-1&&(j=a>1&&r<0&&u>0&&i[u-1].v==="-"?-r:r,i[u].v=oa(i[u].t,i[u].v,j),i[u].t="t");var D="";for(u=0;u!==i.length;++u)i[u]!=null&&(D+=i[u].v);return D}var D1=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function R1(e,r){if(r==null)return!1;var t=parseFloat(r[2]);switch(r[1]){case"=":if(e==t)return!0;break;case">":if(e>t)return!0;break;case"<":if(e<t)return!0;break;case"<>":if(e!=t)return!0;break;case">=":if(e>=t)return!0;break;case"<=":if(e<=t)return!0;break}return!1}function K2(e,r){var t=G2(e),a=t.length,i=t[a-1].indexOf("@");if(a<4&&i>-1&&--a,t.length>4)throw new Error("cannot find right format for |"+t.join("|")+"|");if(typeof r!="number")return[4,t.length===4||i>-1?t[t.length-1]:"@"];switch(typeof r=="number"&&!isFinite(r)&&(r=0),t.length){case 1:t=i>-1?["General","General","General",t[0]]:[t[0],t[0],t[0],"@"];break;case 2:t=i>-1?[t[0],t[0],t[0],t[1]]:[t[0],t[1],t[0],"@"];break;case 3:t=i>-1?[t[0],t[1],t[0],t[2]]:[t[0],t[1],t[2],"@"];break}var o=r>0?t[0]:r<0?t[1]:t[2];if(t[0].indexOf("[")===-1&&t[1].indexOf("[")===-1)return[a,o];if(t[0].match(/\[[=<>]/)!=null||t[1].match(/\[[=<>]/)!=null){var u=t[0].match(D1),c=t[1].match(D1);return R1(r,u)?[a,t[0]]:R1(r,c)?[a,t[1]]:[a,t[u!=null&&c!=null?2:1]]}return[a,o]}function on(e,r,t){t==null&&(t={});var a="";switch(typeof e){case"string":e=="m/d/yy"&&t.dateNF?a=t.dateNF:a=e;break;case"number":e==14&&t.dateNF?a=t.dateNF:a=(t.table!=null?t.table:ht)[e],a==null&&(a=t.table&&t.table[A1[e]]||ht[A1[e]]),a==null&&(a=D2[e]||"General");break}if($l(a,0))return ds(r,t);r instanceof Date&&(r=ar(r,t.date1904));var i=K2(a,r);if($l(i[1]))return ds(r,t);if(r===!0)r="TRUE";else if(r===!1)r="FALSE";else{if(r===""||r==null)return"";if(isNaN(r)&&i[1].indexOf("0")>-1)return"#NUM!";if(!isFinite(r)&&i[1].indexOf("0")>-1)return"#DIV/0!"}return Y2(i[1],r,t,i[0])}function Q2(e,r){if(typeof r!="number"){r=+r||-1;for(var t=0;t<392;++t){if(ht[t]==null){r<0&&(r=t);continue}if(ht[t]==e){r=t;break}}r<0&&(r=391)}return ht[r]=e,r}function um(){ht=I2()}var q2={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},Gl=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function Z2(e){var r=typeof e=="number"?ht[e]:e;return r=r.replace(Gl,"(\\d+)"),Gl.lastIndex=0,new RegExp("^"+r+"$")}function J2(e,r,t){var a=-1,i=-1,o=-1,u=-1,c=-1,h=-1;(r.match(Gl)||[]).forEach(function(w,p){var v=parseInt(t[p+1],10);switch(w.toLowerCase().charAt(0)){case"y":a=v;break;case"d":o=v;break;case"h":u=v;break;case"s":h=v;break;case"m":u>=0?c=v:i=v;break}}),Gl.lastIndex=0,h>=0&&c==-1&&i>=0&&(c=i,i=-1);var x=(""+(a>=0?a:new Date().getFullYear())).slice(-4)+"-"+("00"+(i>=1?i:1)).slice(-2)+"-"+("00"+(o>=1?o:1)).slice(-2);x.length==7&&(x="0"+x),x.length==8&&(x="20"+x);var m=("00"+(u>=0?u:0)).slice(-2)+":"+("00"+(c>=0?c:0)).slice(-2)+":"+("00"+(h>=0?h:0)).slice(-2);return u==-1&&c==-1&&h==-1?x:a==-1&&i==-1&&o==-1?m:x+"T"+m}var ew={"d.m":"d\\.m"};function ls(e,r){return Q2(ew[e]||e,r)}var P1=(function(){var e={};e.version="1.2.0";function r(){for(var j=0,z=new Array(256),M=0;M!=256;++M)j=M,j=j&1?-306674912^j>>>1:j>>>1,j=j&1?-306674912^j>>>1:j>>>1,j=j&1?-306674912^j>>>1:j>>>1,j=j&1?-306674912^j>>>1:j>>>1,j=j&1?-306674912^j>>>1:j>>>1,j=j&1?-306674912^j>>>1:j>>>1,j=j&1?-306674912^j>>>1:j>>>1,j=j&1?-306674912^j>>>1:j>>>1,z[M]=j;return typeof Int32Array<"u"?new Int32Array(z):z}var t=r();function a(j){var z=0,M=0,U=0,D=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(U=0;U!=256;++U)D[U]=j[U];for(U=0;U!=256;++U)for(M=j[U],z=256+U;z<4096;z+=256)M=D[z]=M>>>8^j[M&255];var R=[];for(U=1;U!=16;++U)R[U-1]=typeof Int32Array<"u"&&typeof D.subarray=="function"?D.subarray(U*256,U*256+256):D.slice(U*256,U*256+256);return R}var i=a(t),o=i[0],u=i[1],c=i[2],h=i[3],x=i[4],m=i[5],w=i[6],p=i[7],v=i[8],y=i[9],T=i[10],E=i[11],_=i[12],C=i[13],S=i[14];function N(j,z){for(var M=z^-1,U=0,D=j.length;U<D;)M=M>>>8^t[(M^j.charCodeAt(U++))&255];return~M}function B(j,z){for(var M=z^-1,U=j.length-15,D=0;D<U;)M=S[j[D++]^M&255]^C[j[D++]^M>>8&255]^_[j[D++]^M>>16&255]^E[j[D++]^M>>>24]^T[j[D++]]^y[j[D++]]^v[j[D++]]^p[j[D++]]^w[j[D++]]^m[j[D++]]^x[j[D++]]^h[j[D++]]^c[j[D++]]^u[j[D++]]^o[j[D++]]^t[j[D++]];for(U+=15;D<U;)M=M>>>8^t[(M^j[D++])&255];return~M}function X(j,z){for(var M=z^-1,U=0,D=j.length,R=0,K=0;U<D;)R=j.charCodeAt(U++),R<128?M=M>>>8^t[(M^R)&255]:R<2048?(M=M>>>8^t[(M^(192|R>>6&31))&255],M=M>>>8^t[(M^(128|R&63))&255]):R>=55296&&R<57344?(R=(R&1023)+64,K=j.charCodeAt(U++)&1023,M=M>>>8^t[(M^(240|R>>8&7))&255],M=M>>>8^t[(M^(128|R>>2&63))&255],M=M>>>8^t[(M^(128|K>>6&15|(R&3)<<4))&255],M=M>>>8^t[(M^(128|K&63))&255]):(M=M>>>8^t[(M^(224|R>>12&15))&255],M=M>>>8^t[(M^(128|R>>6&63))&255],M=M>>>8^t[(M^(128|R&63))&255]);return~M}return e.table=t,e.bstr=N,e.buf=B,e.str=X,e})(),Et=(function(){var r={};r.version="1.2.2";function t(A,H){for(var O=A.split("/"),L=H.split("/"),V=0,W=0,de=Math.min(O.length,L.length);V<de;++V){if(W=O[V].length-L[V].length)return W;if(O[V]!=L[V])return O[V]<L[V]?-1:1}return O.length-L.length}function a(A){if(A.charAt(A.length-1)=="/")return A.slice(0,-1).indexOf("/")===-1?A:a(A.slice(0,-1));var H=A.lastIndexOf("/");return H===-1?A:A.slice(0,H+1)}function i(A){if(A.charAt(A.length-1)=="/")return i(A.slice(0,-1));var H=A.lastIndexOf("/");return H===-1?A:A.slice(H+1)}function o(A,H){typeof H=="string"&&(H=new Date(H));var O=H.getHours();O=O<<6|H.getMinutes(),O=O<<5|H.getSeconds()>>>1,A.write_shift(2,O);var L=H.getFullYear()-1980;L=L<<4|H.getMonth()+1,L=L<<5|H.getDate(),A.write_shift(2,L)}function u(A){var H=A.read_shift(2)&65535,O=A.read_shift(2)&65535,L=new Date,V=O&31;O>>>=5;var W=O&15;O>>>=4,L.setMilliseconds(0),L.setFullYear(O+1980),L.setMonth(W-1),L.setDate(V);var de=H&31;H>>>=5;var Te=H&63;return H>>>=6,L.setHours(H),L.setMinutes(Te),L.setSeconds(de<<1),L}function c(A){nr(A,0);for(var H={},O=0;A.l<=A.length-4;){var L=A.read_shift(2),V=A.read_shift(2),W=A.l+V,de={};switch(L){case 21589:O=A.read_shift(1),O&1&&(de.mtime=A.read_shift(4)),V>5&&(O&2&&(de.atime=A.read_shift(4)),O&4&&(de.ctime=A.read_shift(4))),de.mtime&&(de.mt=new Date(de.mtime*1e3));break;case 1:{var Te=A.read_shift(4),fe=A.read_shift(4);de.usz=fe*Math.pow(2,32)+Te,Te=A.read_shift(4),fe=A.read_shift(4),de.csz=fe*Math.pow(2,32)+Te}break}A.l=W,H[L]=de}return H}var h;function x(){return h||(h=tw)}function m(A,H){if(A[0]==80&&A[1]==75)return sr(A,H);if((A[0]|32)==109&&(A[1]|32)==105)return Xe(A,H);if(A.length<512)throw new Error("CFB file size "+A.length+" < 512");var O=3,L=512,V=0,W=0,de=0,Te=0,fe=0,he=[],xe=A.slice(0,512);nr(xe,0);var Me=w(xe);switch(O=Me[0],O){case 3:L=512;break;case 4:L=4096;break;case 0:if(Me[1]==0)return sr(A,H);default:throw new Error("Major Version: Expected 3 or 4 saw "+O)}L!==512&&(xe=A.slice(0,L),nr(xe,28));var We=A.slice(0,L);p(xe,O);var qe=xe.read_shift(4,"i");if(O===3&&qe!==0)throw new Error("# Directory Sectors: Expected 0 saw "+qe);xe.l+=4,de=xe.read_shift(4,"i"),xe.l+=4,xe.chk("00100000","Mini Stream Cutoff Size: "),Te=xe.read_shift(4,"i"),V=xe.read_shift(4,"i"),fe=xe.read_shift(4,"i"),W=xe.read_shift(4,"i");for(var Ue=-1,Pe=0;Pe<109&&(Ue=xe.read_shift(4,"i"),!(Ue<0));++Pe)he[Pe]=Ue;var xt=v(A,L);E(fe,W,xt,L,he);var Rt=C(xt,de,he,L);de<Rt.length&&(Rt[de].name="!Directory"),V>0&&Te!==K&&(Rt[Te].name="!MiniFAT"),Rt[he[0]].name="!FAT",Rt.fat_addrs=he,Rt.ssz=L;var Ot={},Wt=[],Xa=[],da=[];S(de,Rt,xt,Wt,V,Ot,Xa,Te),y(Xa,da,Wt),Wt.shift();var zn={FileIndex:Xa,FullPaths:da};return H&&H.raw&&(zn.raw={header:We,sectors:xt}),zn}function w(A){if(A[A.l]==80&&A[A.l+1]==75)return[0,0];A.chk(ae,"Header Signature: "),A.l+=16;var H=A.read_shift(2,"u");return[A.read_shift(2,"u"),H]}function p(A,H){var O=9;switch(A.l+=2,O=A.read_shift(2)){case 9:if(H!=3)throw new Error("Sector Shift: Expected 9 saw "+O);break;case 12:if(H!=4)throw new Error("Sector Shift: Expected 12 saw "+O);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+O)}A.chk("0600","Mini Sector Shift: "),A.chk("000000000000","Reserved: ")}function v(A,H){for(var O=Math.ceil(A.length/H)-1,L=[],V=1;V<O;++V)L[V-1]=A.slice(V*H,(V+1)*H);return L[O-1]=A.slice(O*H),L}function y(A,H,O){for(var L=0,V=0,W=0,de=0,Te=0,fe=O.length,he=[],xe=[];L<fe;++L)he[L]=xe[L]=L,H[L]=O[L];for(;Te<xe.length;++Te)L=xe[Te],V=A[L].L,W=A[L].R,de=A[L].C,he[L]===L&&(V!==-1&&he[V]!==V&&(he[L]=he[V]),W!==-1&&he[W]!==W&&(he[L]=he[W])),de!==-1&&(he[de]=L),V!==-1&&L!=he[L]&&(he[V]=he[L],xe.lastIndexOf(V)<Te&&xe.push(V)),W!==-1&&L!=he[L]&&(he[W]=he[L],xe.lastIndexOf(W)<Te&&xe.push(W));for(L=1;L<fe;++L)he[L]===L&&(W!==-1&&he[W]!==W?he[L]=he[W]:V!==-1&&he[V]!==V&&(he[L]=he[V]));for(L=1;L<fe;++L)if(A[L].type!==0){if(Te=L,Te!=he[Te])do Te=he[Te],H[L]=H[Te]+"/"+H[L];while(Te!==0&&he[Te]!==-1&&Te!=he[Te]);he[L]=-1}for(H[0]+="/",L=1;L<fe;++L)A[L].type!==2&&(H[L]+="/")}function T(A,H,O){for(var L=A.start,V=A.size,W=[],de=L;O&&V>0&&de>=0;)W.push(H.slice(de*R,de*R+R)),V-=R,de=is(O,de*4);return W.length===0?Jt(0):ja(W).slice(0,A.size)}function E(A,H,O,L,V){var W=K;if(A===K){if(H!==0)throw new Error("DIFAT chain shorter than expected")}else if(A!==-1){var de=O[A],Te=(L>>>2)-1;if(!de)return;for(var fe=0;fe<Te&&(W=is(de,fe*4))!==K;++fe)V.push(W);H>=1&&E(is(de,L-4),H-1,O,L,V)}}function _(A,H,O,L,V){var W=[],de=[];V||(V=[]);var Te=L-1,fe=0,he=0;for(fe=H;fe>=0;){V[fe]=!0,W[W.length]=fe,de.push(A[fe]);var xe=O[Math.floor(fe*4/L)];if(he=fe*4&Te,L<4+he)throw new Error("FAT boundary crossed: "+fe+" 4 "+L);if(!A[xe])break;fe=is(A[xe],he)}return{nodes:W,data:H1([de])}}function C(A,H,O,L){var V=A.length,W=[],de=[],Te=[],fe=[],he=L-1,xe=0,Me=0,We=0,qe=0;for(xe=0;xe<V;++xe)if(Te=[],We=xe+H,We>=V&&(We-=V),!de[We]){fe=[];var Ue=[];for(Me=We;Me>=0;){Ue[Me]=!0,de[Me]=!0,Te[Te.length]=Me,fe.push(A[Me]);var Pe=O[Math.floor(Me*4/L)];if(qe=Me*4&he,L<4+qe)throw new Error("FAT boundary crossed: "+Me+" 4 "+L);if(!A[Pe]||(Me=is(A[Pe],qe),Ue[Me]))break}W[We]={nodes:Te,data:H1([fe])}}return W}function S(A,H,O,L,V,W,de,Te){for(var fe=0,he=L.length?2:0,xe=H[A].data,Me=0,We=0,qe;Me<xe.length;Me+=128){var Ue=xe.slice(Me,Me+128);nr(Ue,64),We=Ue.read_shift(2),qe=lf(Ue,0,We-he),L.push(qe);var Pe={name:qe,type:Ue.read_shift(1),color:Ue.read_shift(1),L:Ue.read_shift(4,"i"),R:Ue.read_shift(4,"i"),C:Ue.read_shift(4,"i"),clsid:Ue.read_shift(16),state:Ue.read_shift(4,"i"),start:0,size:0},xt=Ue.read_shift(2)+Ue.read_shift(2)+Ue.read_shift(2)+Ue.read_shift(2);xt!==0&&(Pe.ct=N(Ue,Ue.l-8));var Rt=Ue.read_shift(2)+Ue.read_shift(2)+Ue.read_shift(2)+Ue.read_shift(2);Rt!==0&&(Pe.mt=N(Ue,Ue.l-8)),Pe.start=Ue.read_shift(4,"i"),Pe.size=Ue.read_shift(4,"i"),Pe.size<0&&Pe.start<0&&(Pe.size=Pe.type=0,Pe.start=K,Pe.name=""),Pe.type===5?(fe=Pe.start,V>0&&fe!==K&&(H[fe].name="!StreamData")):Pe.size>=4096?(Pe.storage="fat",H[Pe.start]===void 0&&(H[Pe.start]=_(O,Pe.start,H.fat_addrs,H.ssz)),H[Pe.start].name=Pe.name,Pe.content=H[Pe.start].data.slice(0,Pe.size)):(Pe.storage="minifat",Pe.size<0?Pe.size=0:fe!==K&&Pe.start!==K&&H[fe]&&(Pe.content=T(Pe,H[fe].data,(H[Te]||{}).data))),Pe.content&&nr(Pe.content,0),W[qe]=Pe,de.push(Pe)}}function N(A,H){return new Date((rn(A,H+4)/1e7*Math.pow(2,32)+rn(A,H)/1e7-11644473600)*1e3)}function B(A,H){return x(),m(h.readFileSync(A),H)}function X(A,H){var O=H&&H.type;switch(O||vt&&Buffer.isBuffer(A)&&(O="buffer"),O||"base64"){case"file":return B(A,H);case"base64":return m(tn(sn(A)),H);case"binary":return m(tn(A),H)}return m(A,H)}function j(A,H){var O=H||{},L=O.root||"Root Entry";if(A.FullPaths||(A.FullPaths=[]),A.FileIndex||(A.FileIndex=[]),A.FullPaths.length!==A.FileIndex.length)throw new Error("inconsistent CFB structure");A.FullPaths.length===0&&(A.FullPaths[0]=L+"/",A.FileIndex[0]={name:L,type:5}),O.CLSID&&(A.FileIndex[0].clsid=O.CLSID),z(A)}function z(A){var H="Sh33tJ5";if(!Et.find(A,"/"+H)){var O=Jt(4);O[0]=55,O[1]=O[3]=50,O[2]=54,A.FileIndex.push({name:H,type:2,content:O,size:4,L:69,R:69,C:69}),A.FullPaths.push(A.FullPaths[0]+H),M(A)}}function M(A,H){j(A);for(var O=!1,L=!1,V=A.FullPaths.length-1;V>=0;--V){var W=A.FileIndex[V];switch(W.type){case 0:L?O=!0:(A.FileIndex.pop(),A.FullPaths.pop());break;case 1:case 2:case 5:L=!0,isNaN(W.R*W.L*W.C)&&(O=!0),W.R>-1&&W.L>-1&&W.R==W.L&&(O=!0);break;default:O=!0;break}}if(!(!O&&!H)){var de=new Date(1987,1,19),Te=0,fe=Object.create?Object.create(null):{},he=[];for(V=0;V<A.FullPaths.length;++V)fe[A.FullPaths[V]]=!0,A.FileIndex[V].type!==0&&he.push([A.FullPaths[V],A.FileIndex[V]]);for(V=0;V<he.length;++V){var xe=a(he[V][0]);for(L=fe[xe];!L;){for(;a(xe)&&!fe[a(xe)];)xe=a(xe);he.push([xe,{name:i(xe).replace("/",""),type:1,clsid:oe,ct:de,mt:de,content:null}]),fe[xe]=!0,xe=a(he[V][0]),L=fe[xe]}}for(he.sort(function(qe,Ue){return t(qe[0],Ue[0])}),A.FullPaths=[],A.FileIndex=[],V=0;V<he.length;++V)A.FullPaths[V]=he[V][0],A.FileIndex[V]=he[V][1];for(V=0;V<he.length;++V){var Me=A.FileIndex[V],We=A.FullPaths[V];if(Me.name=i(We).replace("/",""),Me.L=Me.R=Me.C=-(Me.color=1),Me.size=Me.content?Me.content.length:0,Me.start=0,Me.clsid=Me.clsid||oe,V===0)Me.C=he.length>1?1:-1,Me.size=0,Me.type=5;else if(We.slice(-1)=="/"){for(Te=V+1;Te<he.length&&a(A.FullPaths[Te])!=We;++Te);for(Me.C=Te>=he.length?-1:Te,Te=V+1;Te<he.length&&a(A.FullPaths[Te])!=a(We);++Te);Me.R=Te>=he.length?-1:Te,Me.type=1}else a(A.FullPaths[V+1]||"")==a(We)&&(Me.R=V+1),Me.type=2}}}function U(A,H){var O=H||{};if(O.fileType=="mad")return ct(A,O);switch(M(A),O.fileType){case"zip":return cn(A,O)}var L=(function(qe){for(var Ue=0,Pe=0,xt=0;xt<qe.FileIndex.length;++xt){var Rt=qe.FileIndex[xt];if(Rt.content){var Ot=Rt.content.length;Ot>0&&(Ot<4096?Ue+=Ot+63>>6:Pe+=Ot+511>>9)}}for(var Wt=qe.FullPaths.length+3>>2,Xa=Ue+7>>3,da=Ue+127>>7,zn=Xa+Pe+Wt+da,ir=zn+127>>7,ai=ir<=109?0:Math.ceil((ir-109)/127);zn+ir+ai+127>>7>ir;)ai=++ir<=109?0:Math.ceil((ir-109)/127);var $t=[1,ai,ir,da,Wt,Pe,Ue,0];return qe.FileIndex[0].size=Ue<<6,$t[7]=(qe.FileIndex[0].start=$t[0]+$t[1]+$t[2]+$t[3]+$t[4]+$t[5])+($t[6]+7>>3),$t})(A),V=Jt(L[7]<<9),W=0,de=0;{for(W=0;W<8;++W)V.write_shift(1,te[W]);for(W=0;W<8;++W)V.write_shift(2,0);for(V.write_shift(2,62),V.write_shift(2,3),V.write_shift(2,65534),V.write_shift(2,9),V.write_shift(2,6),W=0;W<3;++W)V.write_shift(2,0);for(V.write_shift(4,0),V.write_shift(4,L[2]),V.write_shift(4,L[0]+L[1]+L[2]+L[3]-1),V.write_shift(4,0),V.write_shift(4,4096),V.write_shift(4,L[3]?L[0]+L[1]+L[2]-1:K),V.write_shift(4,L[3]),V.write_shift(-4,L[1]?L[0]-1:K),V.write_shift(4,L[1]),W=0;W<109;++W)V.write_shift(-4,W<L[2]?L[1]+W:-1)}if(L[1])for(de=0;de<L[1];++de){for(;W<236+de*127;++W)V.write_shift(-4,W<L[2]?L[1]+W:-1);V.write_shift(-4,de===L[1]-1?K:de+1)}var Te=function(qe){for(de+=qe;W<de-1;++W)V.write_shift(-4,W+1);qe&&(++W,V.write_shift(-4,K))};for(de=W=0,de+=L[1];W<de;++W)V.write_shift(-4,re.DIFSECT);for(de+=L[2];W<de;++W)V.write_shift(-4,re.FATSECT);Te(L[3]),Te(L[4]);for(var fe=0,he=0,xe=A.FileIndex[0];fe<A.FileIndex.length;++fe)xe=A.FileIndex[fe],xe.content&&(he=xe.content.length,!(he<4096)&&(xe.start=de,Te(he+511>>9)));for(Te(L[6]+7>>3);V.l&511;)V.write_shift(-4,re.ENDOFCHAIN);for(de=W=0,fe=0;fe<A.FileIndex.length;++fe)xe=A.FileIndex[fe],xe.content&&(he=xe.content.length,!(!he||he>=4096)&&(xe.start=de,Te(he+63>>6)));for(;V.l&511;)V.write_shift(-4,re.ENDOFCHAIN);for(W=0;W<L[4]<<2;++W){var Me=A.FullPaths[W];if(!Me||Me.length===0){for(fe=0;fe<17;++fe)V.write_shift(4,0);for(fe=0;fe<3;++fe)V.write_shift(4,-1);for(fe=0;fe<12;++fe)V.write_shift(4,0);continue}xe=A.FileIndex[W],W===0&&(xe.start=xe.size?xe.start-1:K);var We=W===0&&O.root||xe.name;if(We.length>31&&(console.error("Name "+We+" will be truncated to "+We.slice(0,31)),We=We.slice(0,31)),he=2*(We.length+1),V.write_shift(64,We,"utf16le"),V.write_shift(2,he),V.write_shift(1,xe.type),V.write_shift(1,xe.color),V.write_shift(-4,xe.L),V.write_shift(-4,xe.R),V.write_shift(-4,xe.C),xe.clsid)V.write_shift(16,xe.clsid,"hex");else for(fe=0;fe<4;++fe)V.write_shift(4,0);V.write_shift(4,xe.state||0),V.write_shift(4,0),V.write_shift(4,0),V.write_shift(4,0),V.write_shift(4,0),V.write_shift(4,xe.start),V.write_shift(4,xe.size),V.write_shift(4,0)}for(W=1;W<A.FileIndex.length;++W)if(xe=A.FileIndex[W],xe.size>=4096)if(V.l=xe.start+1<<9,vt&&Buffer.isBuffer(xe.content))xe.content.copy(V,V.l,0,xe.size),V.l+=xe.size+511&-512;else{for(fe=0;fe<xe.size;++fe)V.write_shift(1,xe.content[fe]);for(;fe&511;++fe)V.write_shift(1,0)}for(W=1;W<A.FileIndex.length;++W)if(xe=A.FileIndex[W],xe.size>0&&xe.size<4096)if(vt&&Buffer.isBuffer(xe.content))xe.content.copy(V,V.l,0,xe.size),V.l+=xe.size+63&-64;else{for(fe=0;fe<xe.size;++fe)V.write_shift(1,xe.content[fe]);for(;fe&63;++fe)V.write_shift(1,0)}if(vt)V.l=V.length;else for(;V.l<V.length;)V.write_shift(1,0);return V}function D(A,H){var O=A.FullPaths.map(function(fe){return fe.toUpperCase()}),L=O.map(function(fe){var he=fe.split("/");return he[he.length-(fe.slice(-1)=="/"?2:1)]}),V=!1;H.charCodeAt(0)===47?(V=!0,H=O[0].slice(0,-1)+H):V=H.indexOf("/")!==-1;var W=H.toUpperCase(),de=V===!0?O.indexOf(W):L.indexOf(W);if(de!==-1)return A.FileIndex[de];var Te=!W.match(zi);for(W=W.replace(Yr,""),Te&&(W=W.replace(zi,"!")),de=0;de<O.length;++de)if((Te?O[de].replace(zi,"!"):O[de]).replace(Yr,"")==W||(Te?L[de].replace(zi,"!"):L[de]).replace(Yr,"")==W)return A.FileIndex[de];return null}var R=64,K=-2,ae="d0cf11e0a1b11ae1",te=[208,207,17,224,161,177,26,225],oe="00000000000000000000000000000000",re={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:K,FREESECT:-1,HEADER_SIGNATURE:ae,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:oe,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function Z(A,H,O){x();var L=U(A,O);h.writeFileSync(H,L)}function ge(A){for(var H=new Array(A.length),O=0;O<A.length;++O)H[O]=String.fromCharCode(A[O]);return H.join("")}function q(A,H){var O=U(A,H);switch(H&&H.type||"buffer"){case"file":return x(),h.writeFileSync(H.filename,O),O;case"binary":return typeof O=="string"?O:ge(O);case"base64":return S1(typeof O=="string"?O:ge(O));case"buffer":if(vt)return Buffer.isBuffer(O)?O:Wa(O);case"array":return typeof O=="string"?tn(O):O}return O}var Q;function ie(A){try{var H=A.InflateRaw,O=new H;if(O._processChunk(new Uint8Array([3,0]),O._finishFlushFlag),O.bytesRead)Q=A;else throw new Error("zlib does not expose bytesRead")}catch(L){console.error("cannot use native zlib: "+(L.message||L))}}function ve(A,H){if(!Q)return Un(A,H);var O=Q.InflateRaw,L=new O,V=L._processChunk(A.slice(A.l),L._finishFlushFlag);return A.l+=L.bytesRead,V}function pe(A){return Q?Q.deflateRawSync(A):it(A)}var Ae=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],je=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],ze=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function P(A){var H=(A<<1|A<<11)&139536|(A<<5|A<<15)&558144;return(H>>16|H>>8|H)&255}for(var ee=typeof Uint8Array<"u",J=ee?new Uint8Array(256):[],G=0;G<256;++G)J[G]=P(G);function _e(A,H){var O=J[A&255];return H<=8?O>>>8-H:(O=O<<8|J[A>>8&255],H<=16?O>>>16-H:(O=O<<8|J[A>>16&255],O>>>24-H))}function F(A,H){var O=H&7,L=H>>>3;return(A[L]|(O<=6?0:A[L+1]<<8))>>>O&3}function ke(A,H){var O=H&7,L=H>>>3;return(A[L]|(O<=5?0:A[L+1]<<8))>>>O&7}function Fe(A,H){var O=H&7,L=H>>>3;return(A[L]|(O<=4?0:A[L+1]<<8))>>>O&15}function De(A,H){var O=H&7,L=H>>>3;return(A[L]|(O<=3?0:A[L+1]<<8))>>>O&31}function Ge(A,H){var O=H&7,L=H>>>3;return(A[L]|(O<=1?0:A[L+1]<<8))>>>O&127}function Ve(A,H,O){var L=H&7,V=H>>>3,W=(1<<O)-1,de=A[V]>>>L;return O<8-L||(de|=A[V+1]<<8-L,O<16-L)||(de|=A[V+2]<<16-L,O<24-L)||(de|=A[V+3]<<24-L),de&W}function tt(A,H,O){var L=H&7,V=H>>>3;return L<=5?A[V]|=(O&7)<<L:(A[V]|=O<<L&255,A[V+1]=(O&7)>>8-L),H+3}function ft(A,H,O){var L=H&7,V=H>>>3;return O=(O&1)<<L,A[V]|=O,H+1}function st(A,H,O){var L=H&7,V=H>>>3;return O<<=L,A[V]|=O&255,O>>>=8,A[V+1]=O,H+8}function ye(A,H,O){var L=H&7,V=H>>>3;return O<<=L,A[V]|=O&255,O>>>=8,A[V+1]=O&255,A[V+2]=O>>>8,H+16}function Ce(A,H){var O=A.length,L=2*O>H?2*O:H+5,V=0;if(O>=H)return A;if(vt){var W=C1(L);if(A.copy)A.copy(W);else for(;V<A.length;++V)W[V]=A[V];return W}else if(ee){var de=new Uint8Array(L);if(de.set)de.set(A);else for(;V<O;++V)de[V]=A[V];return de}return A.length=L,A}function le(A){for(var H=new Array(A),O=0;O<A;++O)H[O]=0;return H}function ce(A,H,O){var L=1,V=0,W=0,de=0,Te=0,fe=A.length,he=ee?new Uint16Array(32):le(32);for(W=0;W<32;++W)he[W]=0;for(W=fe;W<O;++W)A[W]=0;fe=A.length;var xe=ee?new Uint16Array(fe):le(fe);for(W=0;W<fe;++W)he[V=A[W]]++,L<V&&(L=V),xe[W]=0;for(he[0]=0,W=1;W<=L;++W)he[W+16]=Te=Te+he[W-1]<<1;for(W=0;W<fe;++W)Te=A[W],Te!=0&&(xe[W]=he[Te+16]++);var Me=0;for(W=0;W<fe;++W)if(Me=A[W],Me!=0)for(Te=_e(xe[W],L)>>L-Me,de=(1<<L+4-Me)-1;de>=0;--de)H[Te|de<<Me]=Me&15|W<<4;return L}var Ee=ee?new Uint16Array(512):le(512),Se=ee?new Uint16Array(32):le(32);if(!ee){for(var Re=0;Re<512;++Re)Ee[Re]=0;for(Re=0;Re<32;++Re)Se[Re]=0}(function(){for(var A=[],H=0;H<32;H++)A.push(5);ce(A,Se,32);var O=[];for(H=0;H<=143;H++)O.push(8);for(;H<=255;H++)O.push(9);for(;H<=279;H++)O.push(7);for(;H<=287;H++)O.push(8);ce(O,Ee,288)})();var at=(function(){for(var H=ee?new Uint8Array(32768):[],O=0,L=0;O<ze.length-1;++O)for(;L<ze[O+1];++L)H[L]=O;for(;L<32768;++L)H[L]=29;var V=ee?new Uint8Array(259):[];for(O=0,L=0;O<je.length-1;++O)for(;L<je[O+1];++L)V[L]=O;function W(Te,fe){for(var he=0;he<Te.length;){var xe=Math.min(65535,Te.length-he),Me=he+xe==Te.length;for(fe.write_shift(1,+Me),fe.write_shift(2,xe),fe.write_shift(2,~xe&65535);xe-- >0;)fe[fe.l++]=Te[he++]}return fe.l}function de(Te,fe){for(var he=0,xe=0,Me=ee?new Uint16Array(32768):[];xe<Te.length;){var We=Math.min(65535,Te.length-xe);if(We<10){for(he=tt(fe,he,+(xe+We==Te.length)),he&7&&(he+=8-(he&7)),fe.l=he/8|0,fe.write_shift(2,We),fe.write_shift(2,~We&65535);We-- >0;)fe[fe.l++]=Te[xe++];he=fe.l*8;continue}he=tt(fe,he,+(xe+We==Te.length)+2);for(var qe=0;We-- >0;){var Ue=Te[xe];qe=(qe<<5^Ue)&32767;var Pe=-1,xt=0;if((Pe=Me[qe])&&(Pe|=xe&-32768,Pe>xe&&(Pe-=32768),Pe<xe))for(;Te[Pe+xt]==Te[xe+xt]&&xt<250;)++xt;if(xt>2){Ue=V[xt],Ue<=22?he=st(fe,he,J[Ue+1]>>1)-1:(st(fe,he,3),he+=5,st(fe,he,J[Ue-23]>>5),he+=3);var Rt=Ue<8?0:Ue-4>>2;Rt>0&&(ye(fe,he,xt-je[Ue]),he+=Rt),Ue=H[xe-Pe],he=st(fe,he,J[Ue]>>3),he-=3;var Ot=Ue<4?0:Ue-2>>1;Ot>0&&(ye(fe,he,xe-Pe-ze[Ue]),he+=Ot);for(var Wt=0;Wt<xt;++Wt)Me[qe]=xe&32767,qe=(qe<<5^Te[xe])&32767,++xe;We-=xt-1}else Ue<=143?Ue=Ue+48:he=ft(fe,he,1),he=st(fe,he,J[Ue]),Me[qe]=xe&32767,++xe}he=st(fe,he,0)-1}return fe.l=(he+7)/8|0,fe.l}return function(fe,he){return fe.length<8?W(fe,he):de(fe,he)}})();function it(A){var H=Jt(50+Math.floor(A.length*1.1)),O=at(A,H);return H.slice(0,O)}var Ne=ee?new Uint16Array(32768):le(32768),Ke=ee?new Uint16Array(32768):le(32768),mt=ee?new Uint16Array(128):le(128),Nt=1,Er=1;function _r(A,H){var O=De(A,H)+257;H+=5;var L=De(A,H)+1;H+=5;var V=Fe(A,H)+4;H+=4;for(var W=0,de=ee?new Uint8Array(19):le(19),Te=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],fe=1,he=ee?new Uint8Array(8):le(8),xe=ee?new Uint8Array(8):le(8),Me=de.length,We=0;We<V;++We)de[Ae[We]]=W=ke(A,H),fe<W&&(fe=W),he[W]++,H+=3;var qe=0;for(he[0]=0,We=1;We<=fe;++We)xe[We]=qe=qe+he[We-1]<<1;for(We=0;We<Me;++We)(qe=de[We])!=0&&(Te[We]=xe[qe]++);var Ue=0;for(We=0;We<Me;++We)if(Ue=de[We],Ue!=0){qe=J[Te[We]]>>8-Ue;for(var Pe=(1<<7-Ue)-1;Pe>=0;--Pe)mt[qe|Pe<<Ue]=Ue&7|We<<3}var xt=[];for(fe=1;xt.length<O+L;)switch(qe=mt[Ge(A,H)],H+=qe&7,qe>>>=3){case 16:for(W=3+F(A,H),H+=2,qe=xt[xt.length-1];W-- >0;)xt.push(qe);break;case 17:for(W=3+ke(A,H),H+=3;W-- >0;)xt.push(0);break;case 18:for(W=11+Ge(A,H),H+=7;W-- >0;)xt.push(0);break;default:xt.push(qe),fe<qe&&(fe=qe);break}var Rt=xt.slice(0,O),Ot=xt.slice(O);for(We=O;We<286;++We)Rt[We]=0;for(We=L;We<30;++We)Ot[We]=0;return Nt=ce(Rt,Ne,286),Er=ce(Ot,Ke,30),H}function ln(A,H){if(A[0]==3&&!(A[1]&3))return[Ua(H),2];for(var O=0,L=0,V=C1(H||1<<18),W=0,de=V.length>>>0,Te=0,fe=0;(L&1)==0;){if(L=ke(A,O),O+=3,L>>>1)L>>1==1?(Te=9,fe=5):(O=_r(A,O),Te=Nt,fe=Er);else{O&7&&(O+=8-(O&7));var he=A[O>>>3]|A[(O>>>3)+1]<<8;if(O+=32,he>0)for(!H&&de<W+he&&(V=Ce(V,W+he),de=V.length);he-- >0;)V[W++]=A[O>>>3],O+=8;continue}for(;;){!H&&de<W+32767&&(V=Ce(V,W+32767),de=V.length);var xe=Ve(A,O,Te),Me=L>>>1==1?Ee[xe]:Ne[xe];if(O+=Me&15,Me>>>=4,(Me>>>8&255)===0)V[W++]=Me;else{if(Me==256)break;Me-=257;var We=Me<8?0:Me-4>>2;We>5&&(We=0);var qe=W+je[Me];We>0&&(qe+=Ve(A,O,We),O+=We),xe=Ve(A,O,fe),Me=L>>>1==1?Se[xe]:Ke[xe],O+=Me&15,Me>>>=4;var Ue=Me<4?0:Me-2>>1,Pe=ze[Me];for(Ue>0&&(Pe+=Ve(A,O,Ue),O+=Ue),!H&&de<qe&&(V=Ce(V,qe+100),de=V.length);W<qe;)V[W]=V[W-Pe],++W}}}return H?[V,O+7>>>3]:[V.slice(0,W),O+7>>>3]}function Un(A,H){var O=A.slice(A.l||0),L=ln(O,H);return A.l+=L[1],L[0]}function Br(A,H){if(A)typeof console<"u"&&console.error(H);else throw new Error(H)}function sr(A,H){var O=A;nr(O,0);var L=[],V=[],W={FileIndex:L,FullPaths:V};j(W,{root:H.root});for(var de=O.length-4;(O[de]!=80||O[de+1]!=75||O[de+2]!=5||O[de+3]!=6)&&de>=0;)--de;O.l=de+4,O.l+=4;var Te=O.read_shift(2);O.l+=6;var fe=O.read_shift(4);for(O.l=fe,de=0;de<Te;++de){O.l+=20;var he=O.read_shift(4),xe=O.read_shift(4),Me=O.read_shift(2),We=O.read_shift(2),qe=O.read_shift(2);O.l+=8;var Ue=O.read_shift(4),Pe=c(O.slice(O.l+Me,O.l+Me+We));O.l+=Me+We+qe;var xt=O.l;O.l=Ue+4,Pe&&Pe[1]&&((Pe[1]||{}).usz&&(xe=Pe[1].usz),(Pe[1]||{}).csz&&(he=Pe[1].csz)),Ur(O,he,xe,W,Pe),O.l=xt}return W}function Ur(A,H,O,L,V){A.l+=2;var W=A.read_shift(2),de=A.read_shift(2),Te=u(A);if(W&8257)throw new Error("Unsupported ZIP encryption");for(var fe=A.read_shift(4),he=A.read_shift(4),xe=A.read_shift(4),Me=A.read_shift(2),We=A.read_shift(2),qe="",Ue=0;Ue<Me;++Ue)qe+=String.fromCharCode(A[A.l++]);if(We){var Pe=c(A.slice(A.l,A.l+We));(Pe[21589]||{}).mt&&(Te=Pe[21589].mt),(Pe[1]||{}).usz&&(xe=Pe[1].usz),(Pe[1]||{}).csz&&(he=Pe[1].csz),V&&((V[21589]||{}).mt&&(Te=V[21589].mt),(V[1]||{}).usz&&(xe=V[1].usz),(V[1]||{}).csz&&(he=V[1].csz))}A.l+=We;var xt=A.slice(A.l,A.l+he);switch(de){case 8:xt=ve(A,xe);break;case 0:A.l+=he;break;default:throw new Error("Unsupported ZIP Compression method "+de)}var Rt=!1;W&8&&(fe=A.read_shift(4),fe==134695760&&(fe=A.read_shift(4),Rt=!0),he=A.read_shift(4),xe=A.read_shift(4)),he!=H&&Br(Rt,"Bad compressed size: "+H+" != "+he),xe!=O&&Br(Rt,"Bad uncompressed size: "+O+" != "+xe),mr(L,qe,xt,{unsafe:!0,mt:Te})}function cn(A,H){var O=H||{},L=[],V=[],W=Jt(1),de=O.compression?8:0,Te=0,fe=0,he=0,xe=0,Me=0,We=A.FullPaths[0],qe=We,Ue=A.FileIndex[0],Pe=[],xt=0;for(fe=1;fe<A.FullPaths.length;++fe)if(qe=A.FullPaths[fe].slice(We.length),Ue=A.FileIndex[fe],!(!Ue.size||!Ue.content||Array.isArray(Ue.content)&&Ue.content.length==0||qe=="Sh33tJ5")){var Rt=xe,Ot=Jt(qe.length);for(he=0;he<qe.length;++he)Ot.write_shift(1,qe.charCodeAt(he)&127);Ot=Ot.slice(0,Ot.l),Pe[Me]=typeof Ue.content=="string"?P1.bstr(Ue.content,0):P1.buf(Ue.content,0);var Wt=typeof Ue.content=="string"?tn(Ue.content):Ue.content;de==8&&(Wt=pe(Wt)),W=Jt(30),W.write_shift(4,67324752),W.write_shift(2,20),W.write_shift(2,Te),W.write_shift(2,de),Ue.mt?o(W,Ue.mt):W.write_shift(4,0),W.write_shift(-4,Pe[Me]),W.write_shift(4,Wt.length),W.write_shift(4,Ue.content.length),W.write_shift(2,Ot.length),W.write_shift(2,0),xe+=W.length,L.push(W),xe+=Ot.length,L.push(Ot),xe+=Wt.length,L.push(Wt),W=Jt(46),W.write_shift(4,33639248),W.write_shift(2,0),W.write_shift(2,20),W.write_shift(2,Te),W.write_shift(2,de),W.write_shift(4,0),W.write_shift(-4,Pe[Me]),W.write_shift(4,Wt.length),W.write_shift(4,Ue.content.length),W.write_shift(2,Ot.length),W.write_shift(2,0),W.write_shift(2,0),W.write_shift(2,0),W.write_shift(2,0),W.write_shift(4,0),W.write_shift(4,Rt),xt+=W.l,V.push(W),xt+=Ot.length,V.push(Ot),++Me}return W=Jt(22),W.write_shift(4,101010256),W.write_shift(2,0),W.write_shift(2,0),W.write_shift(2,Me),W.write_shift(2,Me),W.write_shift(4,xt),W.write_shift(4,xe),W.write_shift(2,0),ja([ja(L),ja(V),W])}var un={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function Ie(A,H){if(A.ctype)return A.ctype;var O=A.name||"",L=O.match(/\.([^\.]+)$/);return L&&un[L[1]]||H&&(L=(O=H).match(/[\.\\]([^\.\\])+$/),L&&un[L[1]])?un[L[1]]:"application/octet-stream"}function $e(A){for(var H=S1(A),O=[],L=0;L<H.length;L+=76)O.push(H.slice(L,L+76));return O.join(`\r
`)+`\r
`}function ut(A){var H=A.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(he){var xe=he.charCodeAt(0).toString(16).toUpperCase();return"="+(xe.length==1?"0"+xe:xe)});H=H.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),H.charAt(0)==`
`&&(H="=0D"+H.slice(1)),H=H.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var O=[],L=H.split(`\r
`),V=0;V<L.length;++V){var W=L[V];if(W.length==0){O.push("");continue}for(var de=0;de<W.length;){var Te=76,fe=W.slice(de,de+Te);fe.charAt(Te-1)=="="?Te--:fe.charAt(Te-2)=="="?Te-=2:fe.charAt(Te-3)=="="&&(Te-=3),fe=W.slice(de,de+Te),de+=Te,de<W.length&&(fe+="="),O.push(fe)}}return O.join(`\r
`)}function be(A){for(var H=[],O=0;O<A.length;++O){for(var L=A[O];O<=A.length&&L.charAt(L.length-1)=="=";)L=L.slice(0,L.length-1)+A[++O];H.push(L)}for(var V=0;V<H.length;++V)H[V]=H[V].replace(/[=][0-9A-Fa-f]{2}/g,function(W){return String.fromCharCode(parseInt(W.slice(1),16))});return tn(H.join(`\r
`))}function Ye(A,H,O){for(var L="",V="",W="",de,Te=0;Te<10;++Te){var fe=H[Te];if(!fe||fe.match(/^\s*$/))break;var he=fe.match(/^([^:]*?):\s*([^\s].*)$/);if(he)switch(he[1].toLowerCase()){case"content-location":L=he[2].trim();break;case"content-type":W=he[2].trim();break;case"content-transfer-encoding":V=he[2].trim();break}}switch(++Te,V.toLowerCase()){case"base64":de=tn(sn(H.slice(Te).join("")));break;case"quoted-printable":de=be(H.slice(Te));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+V)}var xe=mr(A,L.slice(O.length),de,{unsafe:!0});W&&(xe.ctype=W)}function Xe(A,H){if(ge(A.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var O=H&&H.root||"",L=(vt&&Buffer.isBuffer(A)?A.toString("binary"):ge(A)).split(`\r
`),V=0,W="";for(V=0;V<L.length;++V)if(W=L[V],!!/^Content-Location:/i.test(W)&&(W=W.slice(W.indexOf("file")),O||(O=W.slice(0,W.lastIndexOf("/")+1)),W.slice(0,O.length)!=O))for(;O.length>0&&(O=O.slice(0,O.length-1),O=O.slice(0,O.lastIndexOf("/")+1),W.slice(0,O.length)!=O););var de=(L[1]||"").match(/boundary="(.*?)"/);if(!de)throw new Error("MAD cannot find boundary");var Te="--"+(de[1]||""),fe=[],he=[],xe={FileIndex:fe,FullPaths:he};j(xe);var Me,We=0;for(V=0;V<L.length;++V){var qe=L[V];qe!==Te&&qe!==Te+"--"||(We++&&Ye(xe,L.slice(Me,V),O),Me=V)}return xe}function ct(A,H){var O=H||{},L=O.boundary||"SheetJS";L="------="+L;for(var V=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+L.slice(2)+'"',"","",""],W=A.FullPaths[0],de=W,Te=A.FileIndex[0],fe=1;fe<A.FullPaths.length;++fe)if(de=A.FullPaths[fe].slice(W.length),Te=A.FileIndex[fe],!(!Te.size||!Te.content||de=="Sh33tJ5")){de=de.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(xt){return"_x"+xt.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(xt){return"_u"+xt.charCodeAt(0).toString(16)+"_"});for(var he=Te.content,xe=vt&&Buffer.isBuffer(he)?he.toString("binary"):ge(he),Me=0,We=Math.min(1024,xe.length),qe=0,Ue=0;Ue<=We;++Ue)(qe=xe.charCodeAt(Ue))>=32&&qe<128&&++Me;var Pe=Me>=We*4/5;V.push(L),V.push("Content-Location: "+(O.root||"file:///C:/SheetJS/")+de),V.push("Content-Transfer-Encoding: "+(Pe?"quoted-printable":"base64")),V.push("Content-Type: "+Ie(Te,de)),V.push(""),V.push(Pe?ut(xe):$e(xe))}return V.push(L+`--\r
`),V.join(`\r
`)}function At(A){var H={};return j(H,A),H}function mr(A,H,O,L){var V=L&&L.unsafe;V||j(A);var W=!V&&Et.find(A,H);if(!W){var de=A.FullPaths[0];H.slice(0,de.length)==de?de=H:(de.slice(-1)!="/"&&(de+="/"),de=(de+H).replace("//","/")),W={name:i(H),type:2},A.FileIndex.push(W),A.FullPaths.push(de),V||Et.utils.cfb_gc(A)}return W.content=O,W.size=O?O.length:0,L&&(L.CLSID&&(W.clsid=L.CLSID),L.mt&&(W.mt=L.mt),L.ct&&(W.ct=L.ct)),W}function Kn(A,H){j(A);var O=Et.find(A,H);if(O){for(var L=0;L<A.FileIndex.length;++L)if(A.FileIndex[L]==O)return A.FileIndex.splice(L,1),A.FullPaths.splice(L,1),!0}return!1}function bn(A,H,O){j(A);var L=Et.find(A,H);if(L){for(var V=0;V<A.FileIndex.length;++V)if(A.FileIndex[V]==L)return A.FileIndex[V].name=i(O),A.FullPaths[V]=O,!0}return!1}function fa(A){M(A,!0)}return r.find=D,r.read=X,r.parse=m,r.write=q,r.writeFile=Z,r.utils={cfb_new:At,cfb_add:mr,cfb_del:Kn,cfb_mov:bn,cfb_gc:fa,ReadShift:Xi,CheckField:Pm,prep_blob:nr,bconcat:ja,use_zlib:ie,_deflateRaw:it,_inflateRaw:Un,consts:re},r})(),tw;function rw(e){if(typeof Deno<"u")return Deno.readFileSync(e);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var r=File(e);r.open("r"),r.encoding="binary";var t=r.read();return r.close(),t}catch(a){if(!a.message||a.message.indexOf("onstruct")==-1)throw a}throw new Error("Cannot access file "+e)}function _n(e){for(var r=Object.keys(e),t=[],a=0;a<r.length;++a)Object.prototype.hasOwnProperty.call(e,r[a])&&t.push(r[a]);return t}function nf(e){for(var r=[],t=_n(e),a=0;a!==t.length;++a)r[e[t[a]]]=t[a];return r}var fm=Date.UTC(1899,11,30,0,0,0),nw=Date.UTC(1899,11,31,0,0,0),aw=Date.UTC(1904,0,1,0,0,0);function ar(e,r){var t=e.getTime(),a=(t-fm)/(1440*60*1e3);return r?(a-=1462,a<-1402?a-1:a):a<60?a-1:a}function Ma(e){if(e>=60&&e<61)return e;var r=new Date;return r.setTime((e>60?e:e+1)*24*60*60*1e3+fm),r}function sw(e){var r=0,t=0,a=!1,i=e.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!i)throw new Error("|"+e+"| is not an ISO8601 Duration");for(var o=1;o!=i.length;++o)if(i[o]){switch(t=1,o>3&&(a=!0),i[o].slice(i[o].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+i[o].slice(i[o].length-1));case"D":t*=24;case"H":t*=60;case"M":if(a)t*=60;else throw new Error("Unsupported ISO Duration Field: M")}r+=t*parseInt(i[o],10)}return r}var iw=/^(\d+):(\d+)(:\d+)?(\.\d+)?$/,ow=/^(\d+)-(\d+)-(\d+)$/,dm=/^(\d+)-(\d+)-(\d+)[T ](\d+):(\d+)(:\d+)?(\.\d+)?$/;function yr(e,r){if(e instanceof Date)return e;var t=e.match(iw);if(t)return new Date((r?aw:nw)+((parseInt(t[1],10)*60+parseInt(t[2],10))*60+(t[3]?parseInt(t[3].slice(1),10):0))*1e3+(t[4]?parseInt((t[4]+"000").slice(1,4),10):0));if(t=e.match(ow),t)return new Date(Date.UTC(+t[1],+t[2]-1,+t[3],0,0,0,0));if(t=e.match(dm),t)return new Date(Date.UTC(+t[1],+t[2]-1,+t[3],+t[4],+t[5],t[6]&&parseInt(t[6].slice(1),10)||0,t[7]&&parseInt((t[7]+"0000").slice(1,4),10)||0));var a=new Date(e);return a}function hs(e,r){if(vt&&Buffer.isBuffer(e)){if(r&&no){if(e[0]==255&&e[1]==254)return Hi(e.slice(2).toString("utf16le"));if(e[1]==254&&e[2]==255)return Hi(tm(e.slice(2).toString("binary")))}return e.toString("binary")}if(typeof TextDecoder<"u")try{if(r){if(e[0]==255&&e[1]==254)return Hi(new TextDecoder("utf-16le").decode(e.slice(2)));if(e[0]==254&&e[1]==255)return Hi(new TextDecoder("utf-16be").decode(e.slice(2)))}var t={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(e)&&(e=new Uint8Array(e)),new TextDecoder("latin1").decode(e).replace(/[]/g,function(o){return t[o]||o})}catch{}var a=[],i=0;try{for(i=0;i<e.length-65536;i+=65536)a.push(String.fromCharCode.apply(0,e.slice(i,i+65536)));a.push(String.fromCharCode.apply(0,e.slice(i)))}catch{try{for(;i<e.length-16384;i+=16384)a.push(String.fromCharCode.apply(0,e.slice(i,i+16384)));a.push(String.fromCharCode.apply(0,e.slice(i)))}catch{for(;i!=e.length;++i)a.push(String.fromCharCode(e[i]))}}return a.join("")}function er(e){if(typeof JSON<"u"&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if(typeof e!="object"||e==null)return e;if(e instanceof Date)return new Date(e.getTime());var r={};for(var t in e)Object.prototype.hasOwnProperty.call(e,t)&&(r[t]=er(e[t]));return r}function kt(e,r){for(var t="";t.length<r;)t+=e;return t}function an(e){var r=Number(e);if(!isNaN(r))return isFinite(r)?r:NaN;if(!/\d/.test(e))return r;var t=1,a=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return t*=100,""});return!isNaN(r=Number(a))||(a=a.replace(/[(]([^()]*)[)]/,function(i,o){return t=-t,o}),!isNaN(r=Number(a)))?r/t:r}var lw=/^(0?\d|1[0-2])(?:|:([0-5]?\d)(?:|(\.\d+)(?:|:([0-5]?\d))|:([0-5]?\d)(|\.\d+)))\s+([ap])m?$/,cw=/^([01]?\d|2[0-3])(?:|:([0-5]?\d)(?:|(\.\d+)(?:|:([0-5]?\d))|:([0-5]?\d)(|\.\d+)))$/,uw=/^(\d+)-(\d+)-(\d+)[T ](\d+):(\d+)(:\d+)(\.\d+)?[Z]?$/,fw=new Date("6/9/69 00:00 UTC").valueOf()==-177984e5;function dw(e){return e[2]?e[3]?e[4]?new Date(Date.UTC(1899,11,31,+e[1]%12+(e[7]=="p"?12:0),+e[2],+e[4],parseFloat(e[3])*1e3)):new Date(Date.UTC(1899,11,31,e[7]=="p"?12:0,+e[1],+e[2],parseFloat(e[3])*1e3)):e[5]?new Date(Date.UTC(1899,11,31,+e[1]%12+(e[7]=="p"?12:0),+e[2],+e[5],e[6]?parseFloat(e[6])*1e3:0)):new Date(Date.UTC(1899,11,31,+e[1]%12+(e[7]=="p"?12:0),+e[2],0,0)):new Date(Date.UTC(1899,11,31,+e[1]%12+(e[7]=="p"?12:0),0,0,0))}function hw(e){return e[2]?e[3]?e[4]?new Date(Date.UTC(1899,11,31,+e[1],+e[2],+e[4],parseFloat(e[3])*1e3)):new Date(Date.UTC(1899,11,31,0,+e[1],+e[2],parseFloat(e[3])*1e3)):e[5]?new Date(Date.UTC(1899,11,31,+e[1],+e[2],+e[5],e[6]?parseFloat(e[6])*1e3:0)):new Date(Date.UTC(1899,11,31,+e[1],+e[2],0,0)):new Date(Date.UTC(1899,11,31,+e[1],0,0,0))}var xw=["january","february","march","april","may","june","july","august","september","october","november","december"];function so(e){if(uw.test(e))return e.indexOf("Z")==-1?ic(new Date(e)):new Date(e);var r=e.toLowerCase(),t=r.replace(/\s+/g," ").trim(),a=t.match(lw);if(a)return dw(a);if(a=t.match(cw),a)return hw(a);if(a=t.match(dm),a)return new Date(Date.UTC(+a[1],+a[2]-1,+a[3],+a[4],+a[5],a[6]&&parseInt(a[6].slice(1),10)||0,a[7]&&parseInt((a[7]+"0000").slice(1,4),10)||0));var i=new Date(fw&&e.indexOf("UTC")==-1?e+" UTC":e),o=new Date(NaN),u=i.getYear();i.getMonth();var c=i.getDate();if(isNaN(c))return o;if(r.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(r=r.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),r.length>3&&xw.indexOf(r)==-1)return o}else if(r.replace(/[ap]m?/,"").match(/[a-z]/))return o;return u<0||u>8099||e.match(/[^-0-9:,\/\\\ ]/)?o:i}var mw=(function(){var e="abacaba".split(/(:?b)/i).length==5;return function(t,a,i){if(e||typeof a=="string")return t.split(a);for(var o=t.split(a),u=[o[0]],c=1;c<o.length;++c)u.push(i),u.push(o[c]);return u}})();function xs(e){return new Date(e.getUTCFullYear(),e.getUTCMonth(),e.getUTCDate(),e.getUTCHours(),e.getUTCMinutes(),e.getUTCSeconds(),e.getUTCMilliseconds())}function ic(e){return new Date(Date.UTC(e.getFullYear(),e.getMonth(),e.getDate(),e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds()))}function af(e){var r=e.slice(0,1024),t=r.indexOf("<!DOCTYPE");if(t==-1)return e;var a=e.match(/<[\w]/);return a?e.slice(0,t)+e.slice(a.index):e}function sf(e,r,t){for(var a=[],i=e.indexOf(r);i>-1;){var o=e.indexOf(t,i+r.length);if(o==-1)break;a.push(e.slice(i,o+t.length)),i=e.indexOf(r,o+t.length)}return a.length>0?a:null}function xo(e,r,t){var a=[],i=0,o=e.indexOf(r);if(o==-1)return e;for(;o>-1;){a.push(e.slice(i,o));var u=e.indexOf(t,o+r.length);if(u==-1)break;(o=e.indexOf(r,i=u+t.length))==-1&&a.push(e.slice(i))}return a.join("")}var pw={" ":1,"	":1,"\r":1,"\n":1,">":1};function cs(e,r){for(var t=e.indexOf("<"+r),a=r.length+1,i=e.length;t>=0&&t<=i-a&&!pw[e.charAt(t+a)];)t=e.indexOf("<"+r,t+1);if(t===-1)return null;var o=e.indexOf(">",t+r.length);if(o===-1)return null;var u="</"+r+">",c=e.indexOf(u,o);return c==-1?null:[e.slice(t,c+u.length),e.slice(o+1,c)]}var dr=(function(){var e={};return function(t,a){var i=e[a];i||(e[a]=i=[new RegExp("<(?:\\w+:)?"+a+"\\b[^<>]*>","g"),new RegExp("</(?:\\w+:)?"+a+">","g")]),i[0].lastIndex=i[1].lastIndex=0;var o=i[0].exec(t);if(!o)return null;var u=o.index,c=i[0].lastIndex;if(i[1].lastIndex=i[0].lastIndex,o=i[1].exec(t),!o)return null;var h=o.index,x=i[1].lastIndex;return[t.slice(u,x),t.slice(c,h)]}})(),hm=(function(){var e={};return function(t,a){var i=[],o=e[a];o||(e[a]=o=[new RegExp("<(?:\\w+:)?"+a+"\\b[^<>]*>","g"),new RegExp("</(?:\\w+:)?"+a+">","g")]),o[0].lastIndex=o[1].lastIndex=0;for(var u;u=o[0].exec(t);){var c=u.index;if(o[1].lastIndex=o[0].lastIndex,u=o[1].exec(t),!u)return null;var h=o[1].lastIndex;i.push(t.slice(c,h)),o[0].lastIndex=o[1].lastIndex}return i.length==0?null:i}})(),gw=(function(){var e={};return function(t,a){var i=[],o=e[a];o||(e[a]=o=[new RegExp("<(?:\\w+:)?"+a+"\\b[^<>]*>","g"),new RegExp("</(?:\\w+:)?"+a+">","g")]),o[0].lastIndex=o[1].lastIndex=0;for(var u,c=0,h=0;u=o[0].exec(t);){if(c=u.index,i.push(t.slice(h,c)),h=c,o[1].lastIndex=o[0].lastIndex,u=o[1].exec(t),!u)return null;h=o[1].lastIndex,o[0].lastIndex=o[1].lastIndex}return i.push(t.slice(h)),i.length==0?"":i.join("")}})(),vw=(function(){var e={};return function(t,a){var i=[],o=e[a];o||(e[a]=o=[new RegExp("<"+a+"\\b[^<>]*>","ig"),new RegExp("</"+a+">","ig")]),o[0].lastIndex=o[1].lastIndex=0;for(var u;u=o[0].exec(t);){var c=u.index;if(o[1].lastIndex=o[0].lastIndex,u=o[1].exec(t),!u)return null;var h=o[1].lastIndex;i.push(t.slice(c,h)),o[0].lastIndex=o[1].lastIndex}return i.length==0?null:i}})();function xm(e){return e?e.content&&e.type?hs(e.content,!0):e.data?Ui(e.data):e.asNodeBuffer&&vt?Ui(e.asNodeBuffer().toString("binary")):e.asBinary?Ui(e.asBinary()):e._data&&e._data.getContent?Ui(hs(Array.prototype.slice.call(e._data.getContent(),0))):null:null}function mm(e){if(!e)return null;if(e.data)return _1(e.data);if(e.asNodeBuffer&&vt)return e.asNodeBuffer();if(e._data&&e._data.getContent){var r=e._data.getContent();return typeof r=="string"?_1(r):Array.prototype.slice.call(r)}return e.content&&e.type?e.content:null}function ww(e){return e&&e.name.slice(-4)===".bin"?mm(e):xm(e)}function yn(e,r){for(var t=e.FullPaths||_n(e.files),a=r.toLowerCase().replace(/[\/]/g,"\\"),i=a.replace(/\\/g,"/"),o=0;o<t.length;++o){var u=t[o].replace(/^Root Entry[\/]/,"").toLowerCase();if(a==u||i==u)return e.files?e.files[t[o]]:e.FileIndex[o]}return null}function of(e,r){var t=yn(e,r);if(t==null)throw new Error("Cannot find file "+r+" in zip");return t}function qt(e,r,t){if(!t)return ww(of(e,r));if(!r)return null;try{return qt(e,r)}catch{return null}}function Mr(e,r,t){if(!t)return xm(of(e,r));if(!r)return null;try{return Mr(e,r)}catch{return null}}function yw(e,r,t){return mm(of(e,r))}function O1(e){for(var r=e.FullPaths||_n(e.files),t=[],a=0;a<r.length;++a)r[a].slice(-1)!="/"&&t.push(r[a].replace(/^Root Entry[\/]/,""));return t.sort()}function kw(e,r,t){if(e.FullPaths){if(Array.isArray(t)&&typeof t[0]=="string"&&(t=t.join("")),typeof t=="string"){var a;return vt?a=Wa(t):a=N2(t),Et.utils.cfb_add(e,r,a)}Et.utils.cfb_add(e,r,t)}else e.file(r,t)}function pm(e,r){switch(r.type){case"base64":return Et.read(e,{type:"base64"});case"binary":return Et.read(e,{type:"binary"});case"buffer":case"array":return Et.read(e,{type:"buffer"})}throw new Error("Unrecognized type "+r.type)}function $s(e,r){if(e.charAt(0)=="/")return e.slice(1);var t=r.split("/");r.slice(-1)!="/"&&t.pop();for(var a=e.split("/");a.length!==0;){var i=a.shift();i===".."?t.pop():i!=="."&&t.push(i)}return t.join("/")}var gm=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,vm=/\s([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,j1=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?<>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'"<>\s=]+))*\s*[\/\?]?>/mg,Ew=/<[^<>]*>/g,kr=gm.match(j1)?j1:Ew,_w=/<\w*:/,Tw=/<(\/?)\w+:/;function Ze(e,r,t){for(var a={},i=0,o=0;i!==e.length&&!((o=e.charCodeAt(i))===32||o===10||o===13);++i);if(r||(a[0]=e.slice(0,i)),i===e.length)return a;var u=e.match(vm),c=0,h="",x=0,m="",w="",p=1;if(u)for(x=0;x!=u.length;++x){for(w=u[x].slice(1),o=0;o!=w.length&&w.charCodeAt(o)!==61;++o);for(m=w.slice(0,o).trim();w.charCodeAt(o+1)==32;)++o;for(p=(i=w.charCodeAt(o+1))==34||i==39?1:0,h=w.slice(o+1+p,w.length-p),c=0;c!=m.length&&m.charCodeAt(c)!==58;++c);if(c===m.length)m.indexOf("_")>0&&(m=m.slice(0,m.indexOf("_"))),a[m]=h,a[m.toLowerCase()]=h;else{var v=(c===5&&m.slice(0,5)==="xmlns"?"xmlns":"")+m.slice(c+1);if(a[v]&&m.slice(c-3,c)=="ext")continue;a[v]=h,a[v.toLowerCase()]=h}}return a}function Sw(e,r,t){for(var a={},i=0,o=0;i!==e.length&&!((o=e.charCodeAt(i))===32||o===10||o===13);++i);if(i===e.length)return a;var u=e.match(vm),c="",h=0,x="",m="",w=1;if(u)for(h=0;h!=u.length;++h){for(m=u[h].slice(1),o=0;o!=m.length&&m.charCodeAt(o)!==61;++o);for(x=m.slice(0,o).trim();m.charCodeAt(o+1)==32;)++o;w=(i=m.charCodeAt(o+1))==34||i==39?1:0,c=m.slice(o+1+w,m.length-w),x.indexOf("_")>0&&(x=x.slice(0,x.indexOf("_"))),a[x]=c,a[x.toLowerCase()]=c}return a}function Sn(e){return e.replace(Tw,"<$1")}var wm={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},Cw=nf(wm),wt=(function(){var e=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,r=/_x([\da-fA-F]{4})_/ig;function t(a){var i=a+"",o=i.indexOf("<![CDATA[");if(o==-1)return i.replace(e,function(c,h){return wm[c]||String.fromCharCode(parseInt(h,c.indexOf("x")>-1?16:10))||c}).replace(r,function(c,h){return String.fromCharCode(parseInt(h,16))});var u=i.indexOf("]]>");return t(i.slice(0,o))+i.slice(o+9,u)+t(i.slice(u+3))}return function(i,o){var u=t(i);return o?u.replace(/\r\n/g,`
`):u}})(),bw=/[&<>'"]/g,Nw=/[\u0000-\u001f]/g;function $i(e){var r=e+"";return r.replace(bw,function(t){return Cw[t]}).replace(/\n/g,"<br/>").replace(Nw,function(t){return"&#x"+("000"+t.charCodeAt(0).toString(16)).slice(-4)+";"})}var L1=(function(){var e=/&#(\d+);/g;function r(t,a){return String.fromCharCode(parseInt(a,10))}return function(a){return a.replace(e,r)}})();function Ft(e){switch(e){case 1:case!0:case"1":case"true":return!0;case 0:case!1:case"0":case"false":return!1}return!1}function lu(e){for(var r="",t=0,a=0,i=0,o=0,u=0,c=0;t<e.length;){if(a=e.charCodeAt(t++),a<128){r+=String.fromCharCode(a);continue}if(i=e.charCodeAt(t++),a>191&&a<224){u=(a&31)<<6,u|=i&63,r+=String.fromCharCode(u);continue}if(o=e.charCodeAt(t++),a<240){r+=String.fromCharCode((a&15)<<12|(i&63)<<6|o&63);continue}u=e.charCodeAt(t++),c=((a&7)<<18|(i&63)<<12|(o&63)<<6|u&63)-65536,r+=String.fromCharCode(55296+(c>>>10&1023)),r+=String.fromCharCode(56320+(c&1023))}return r}function M1(e){var r=Ua(2*e.length),t,a,i=1,o=0,u=0,c;for(a=0;a<e.length;a+=i)i=1,(c=e.charCodeAt(a))<128?t=c:c<224?(t=(c&31)*64+(e.charCodeAt(a+1)&63),i=2):c<240?(t=(c&15)*4096+(e.charCodeAt(a+1)&63)*64+(e.charCodeAt(a+2)&63),i=3):(i=4,t=(c&7)*262144+(e.charCodeAt(a+1)&63)*4096+(e.charCodeAt(a+2)&63)*64+(e.charCodeAt(a+3)&63),t-=65536,u=55296+(t>>>10&1023),t=56320+(t&1023)),u!==0&&(r[o++]=u&255,r[o++]=u>>>8,u=0),r[o++]=t%256,r[o++]=t>>>8;return r.slice(0,o).toString("ucs2")}function B1(e){return Wa(e,"binary").toString("utf8")}var Fl="foo bar baz",Pt=vt&&(B1(Fl)==lu(Fl)&&B1||M1(Fl)==lu(Fl)&&M1)||lu,Hi=vt?function(e){return Wa(e,"utf8").toString("binary")}:function(e){for(var r=[],t=0,a=0,i=0;t<e.length;)switch(a=e.charCodeAt(t++),!0){case a<128:r.push(String.fromCharCode(a));break;case a<2048:r.push(String.fromCharCode(192+(a>>6))),r.push(String.fromCharCode(128+(a&63)));break;case(a>=55296&&a<57344):a-=55296,i=e.charCodeAt(t++)-56320+(a<<10),r.push(String.fromCharCode(240+(i>>18&7))),r.push(String.fromCharCode(144+(i>>12&63))),r.push(String.fromCharCode(128+(i>>6&63))),r.push(String.fromCharCode(128+(i&63)));break;default:r.push(String.fromCharCode(224+(a>>12))),r.push(String.fromCharCode(128+(a>>6&63))),r.push(String.fromCharCode(128+(a&63)))}return r.join("")},ym=(function(){var e=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(r){return[new RegExp("&"+r[0]+";","ig"),r[1]]});return function(t){for(var a=t.replace(/^[\t\n\r ]+/,"").replace(/(^|[^\t\n\r ])[\t\n\r ]+$/,"$1").replace(/>\s+/g,">").replace(/\b\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^<>]*>/g,""),i=0;i<e.length;++i)a=a.replace(e[i][0],e[i][1]);return a}})(),Aw=/<\/?(?:vt:)?variant>/g,Fw=/<(?:vt:)([^<"'>]*)>([\s\S]*)</;function U1(e,r){var t=Ze(e),a=hm(e,t.baseType)||[],i=[];if(a.length!=t.size){if(r.WTF)throw new Error("unexpected vector length "+a.length+" != "+t.size);return i}return a.forEach(function(o){var u=o.replace(Aw,"").match(Fw);u&&i.push({v:Pt(u[2]),t:u[1]})}),i}var Iw=/(^\s|\s$|\n)/;function Dw(e){return _n(e).map(function(r){return" "+r+'="'+e[r]+'"'}).join("")}function Rw(e,r,t){return"<"+e+(t!=null?Dw(t):"")+(r!=null?(r.match(Iw)?' xml:space="preserve"':"")+">"+r+"</"+e:"/")+">"}function oc(e){if(vt&&Buffer.isBuffer(e))return e.toString("utf8");if(typeof e=="string")return e;if(typeof Uint8Array<"u"&&e instanceof Uint8Array)return Pt(ca(ef(e)));throw new Error("Bad input format: expected Buffer or string")}var Zt=/<([\/]?)([^\s?><!\/:"]*:|)([^\s?<>:\/"]+)(?:\s+[^<>=?"'\s]+="[^"]*?")*\s*[\/]?>/mg,Pw={CT:"http://schemas.openxmlformats.org/package/2006/content-types"},Ow=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"];function jw(e,r){for(var t=1-2*(e[r+7]>>>7),a=((e[r+7]&127)<<4)+(e[r+6]>>>4&15),i=e[r+6]&15,o=5;o>=0;--o)i=i*256+e[r+o];return a==2047?i==0?t*(1/0):NaN:(a==0?a=-1022:(a-=1023,i+=Math.pow(2,52)),t*Math.pow(2,a-52)*i)}function Lw(e,r,t){var a=(r<0||1/r==-1/0?1:0)<<7,i=0,o=0,u=a?-r:r;isFinite(u)?u==0?i=o=0:(i=Math.floor(Math.log(u)/Math.LN2),o=u*Math.pow(2,52-i),i<=-1023&&(!isFinite(o)||o<Math.pow(2,52))?i=-1022:(o-=Math.pow(2,52),i+=1023)):(i=2047,o=isNaN(r)?26985:0);for(var c=0;c<=5;++c,o/=256)e[t+c]=o&255;e[t+6]=(i&15)<<4|o&15,e[t+7]=i>>4|a}var z1=function(e){for(var r=[],t=10240,a=0;a<e[0].length;++a)if(e[0][a])for(var i=0,o=e[0][a].length;i<o;i+=t)r.push.apply(r,e[0][a].slice(i,i+t));return r},H1=vt?function(e){return e[0].length>0&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0].map(function(r){return Buffer.isBuffer(r)?r:Wa(r)})):z1(e)}:z1,V1=function(e,r,t){for(var a=[],i=r;i<t;i+=2)a.push(String.fromCharCode(ia(e,i)));return a.join("").replace(Yr,"")},lf=vt?function(e,r,t){return!Buffer.isBuffer(e)||!no?V1(e,r,t):e.toString("utf16le",r,t).replace(Yr,"")}:V1,W1=function(e,r,t){for(var a=[],i=r;i<r+t;++i)a.push(("0"+e[i].toString(16)).slice(-2));return a.join("")},km=vt?function(e,r,t){return Buffer.isBuffer(e)?e.toString("hex",r,r+t):W1(e,r,t)}:W1,$1=function(e,r,t){for(var a=[],i=r;i<t;i++)a.push(String.fromCharCode(Ws(e,i)));return a.join("")},mo=vt?function(r,t,a){return Buffer.isBuffer(r)?r.toString("utf8",t,a):$1(r,t,a)}:$1,Em=function(e,r){var t=rn(e,r);return t>0?mo(e,r+4,r+4+t-1):""},_m=Em,Tm=function(e,r){var t=rn(e,r);return t>0?mo(e,r+4,r+4+t-1):""},Sm=Tm,Cm=function(e,r){var t=2*rn(e,r);return t>0?mo(e,r+4,r+4+t-1):""},bm=Cm,Nm=function(r,t){var a=rn(r,t);return a>0?lf(r,t+4,t+4+a):""},Am=Nm,Fm=function(e,r){var t=rn(e,r);return t>0?mo(e,r+4,r+4+t):""},Im=Fm,Dm=function(e,r){return jw(e,r)},Yl=Dm,Rm=function(r){return Array.isArray(r)||typeof Uint8Array<"u"&&r instanceof Uint8Array};vt&&(_m=function(r,t){if(!Buffer.isBuffer(r))return Em(r,t);var a=r.readUInt32LE(t);return a>0?r.toString("utf8",t+4,t+4+a-1):""},Sm=function(r,t){if(!Buffer.isBuffer(r))return Tm(r,t);var a=r.readUInt32LE(t);return a>0?r.toString("utf8",t+4,t+4+a-1):""},bm=function(r,t){if(!Buffer.isBuffer(r)||!no)return Cm(r,t);var a=2*r.readUInt32LE(t);return r.toString("utf16le",t+4,t+4+a-1)},Am=function(r,t){if(!Buffer.isBuffer(r)||!no)return Nm(r,t);var a=r.readUInt32LE(t);return r.toString("utf16le",t+4,t+4+a)},Im=function(r,t){if(!Buffer.isBuffer(r))return Fm(r,t);var a=r.readUInt32LE(t);return r.toString("utf8",t+4,t+4+a)},Yl=function(r,t){return Buffer.isBuffer(r)?r.readDoubleLE(t):Dm(r,t)},Rm=function(r){return Buffer.isBuffer(r)||Array.isArray(r)||typeof Uint8Array<"u"&&r instanceof Uint8Array});var Ws=function(e,r){return e[r]},ia=function(e,r){return e[r+1]*256+e[r]},Mw=function(e,r){var t=e[r+1]*256+e[r];return t<32768?t:(65535-t+1)*-1},rn=function(e,r){return e[r+3]*(1<<24)+(e[r+2]<<16)+(e[r+1]<<8)+e[r]},is=function(e,r){return e[r+3]<<24|e[r+2]<<16|e[r+1]<<8|e[r]},Bw=function(e,r){return e[r]<<24|e[r+1]<<16|e[r+2]<<8|e[r+3]};function Xi(e,r){var t="",a,i,o=[],u,c,h,x;switch(r){case"dbcs":if(x=this.l,vt&&Buffer.isBuffer(this)&&no)t=this.slice(this.l,this.l+2*e).toString("utf16le");else for(h=0;h<e;++h)t+=String.fromCharCode(ia(this,x)),x+=2;e*=2;break;case"utf8":t=mo(this,this.l,this.l+e);break;case"utf16le":e*=2,t=lf(this,this.l,this.l+e);break;case"wstr":return Xi.call(this,e,"dbcs");case"lpstr-ansi":t=_m(this,this.l),e=4+rn(this,this.l);break;case"lpstr-cp":t=Sm(this,this.l),e=4+rn(this,this.l);break;case"lpwstr":t=bm(this,this.l),e=4+2*rn(this,this.l);break;case"lpp4":e=4+rn(this,this.l),t=Am(this,this.l),e&2&&(e+=2);break;case"8lpp4":e=4+rn(this,this.l),t=Im(this,this.l),e&3&&(e+=4-(e&3));break;case"cstr":for(e=0,t="";(u=Ws(this,this.l+e++))!==0;)o.push(Al(u));t=o.join("");break;case"_wstr":for(e=0,t="";(u=ia(this,this.l+e))!==0;)o.push(Al(u)),e+=2;e+=2,t=o.join("");break;case"dbcs-cont":for(t="",x=this.l,h=0;h<e;++h){if(this.lens&&this.lens.indexOf(x)!==-1)return u=Ws(this,x),this.l=x+1,c=Xi.call(this,e-h,u?"dbcs-cont":"sbcs-cont"),o.join("")+c;o.push(Al(ia(this,x))),x+=2}t=o.join(""),e*=2;break;case"cpstr":case"sbcs-cont":for(t="",x=this.l,h=0;h!=e;++h){if(this.lens&&this.lens.indexOf(x)!==-1)return u=Ws(this,x),this.l=x+1,c=Xi.call(this,e-h,u?"dbcs-cont":"sbcs-cont"),o.join("")+c;o.push(Al(Ws(this,x))),x+=1}t=o.join("");break;default:switch(e){case 1:return a=Ws(this,this.l),this.l++,a;case 2:return a=(r==="i"?Mw:ia)(this,this.l),this.l+=2,a;case 4:case-4:return r==="i"||(this[this.l+3]&128)===0?(a=(e>0?is:Bw)(this,this.l),this.l+=4,a):(i=rn(this,this.l),this.l+=4,i);case 8:case-8:if(r==="f")return e==8?i=Yl(this,this.l):i=Yl([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,i;e=8;case 16:t=km(this,this.l,e);break}}return this.l+=e,t}var Uw=function(e,r,t){e[t]=r&255,e[t+1]=r>>>8&255,e[t+2]=r>>>16&255,e[t+3]=r>>>24&255},zw=function(e,r,t){e[t]=r&255,e[t+1]=r>>8&255,e[t+2]=r>>16&255,e[t+3]=r>>24&255},Hw=function(e,r,t){e[t]=r&255,e[t+1]=r>>>8&255};function Vw(e,r,t){var a=0,i=0;if(t==="dbcs"){for(i=0;i!=r.length;++i)Hw(this,r.charCodeAt(i),this.l+2*i);a=2*r.length}else if(t==="sbcs"||t=="cpstr"){for(r=r.replace(/[^\x00-\x7F]/g,"_"),i=0;i!=r.length;++i)this[this.l+i]=r.charCodeAt(i)&255;a=r.length}else if(t==="hex"){for(;i<e;++i)this[this.l++]=parseInt(r.slice(2*i,2*i+2),16)||0;return this}else if(t==="utf16le"){var o=Math.min(this.l+e,this.length);for(i=0;i<Math.min(r.length,e);++i){var u=r.charCodeAt(i);this[this.l++]=u&255,this[this.l++]=u>>8}for(;this.l<o;)this[this.l++]=0;return this}else switch(e){case 1:a=1,this[this.l]=r&255;break;case 2:a=2,this[this.l]=r&255,r>>>=8,this[this.l+1]=r&255;break;case 3:a=3,this[this.l]=r&255,r>>>=8,this[this.l+1]=r&255,r>>>=8,this[this.l+2]=r&255;break;case 4:a=4,Uw(this,r,this.l);break;case 8:if(a=8,t==="f"){Lw(this,r,this.l);break}case 16:break;case-4:a=4,zw(this,r,this.l);break}return this.l+=a,this}function Pm(e,r){var t=km(this,this.l,e.length>>1);if(t!==e)throw new Error(r+"Expected "+e+" saw "+t);this.l+=e.length>>1}function nr(e,r){e.l=r,e.read_shift=Xi,e.chk=Pm,e.write_shift=Vw}function Rr(e,r){e.l+=r}function Jt(e){var r=Ua(e);return nr(r,0),r}function ua(e,r,t){if(e){var a,i,o;nr(e,e.l||0);for(var u=e.length,c=0,h=0;e.l<u;){c=e.read_shift(1),c&128&&(c=(c&127)+((e.read_shift(1)&127)<<7));var x=ec[c]||ec[65535];for(a=e.read_shift(1),o=a&127,i=1;i<4&&a&128;++i)o+=((a=e.read_shift(1))&127)<<7*i;h=e.l+o;var m=x.f&&x.f(e,o,t);if(e.l=h,r(m,x,c))return}}}function Mu(){var e=[],r=vt?16384:2048;vt&&Jt(r).copy;var t=function(m){var w=Jt(m);return nr(w,0),w},a=t(r),i=function(){a&&(a.l&&(a.length>a.l&&(a=a.slice(0,a.l),a.l=a.length),a.length>0&&e.push(a)),a=null)},o=function(m){return a&&m<a.length-a.l?a:(i(),a=t(Math.max(m+1,r)))},u=function(){return i(),ja(e)},c=function(){return i(),e},h=function(m){i(),a=m,a.l==null&&(a.l=a.length),o(r)};return{next:o,push:h,end:u,_bufs:e,end2:c}}function Gi(e,r,t){var a=er(e);if(r.s?(a.cRel&&(a.c+=r.s.c),a.rRel&&(a.r+=r.s.r)):(a.cRel&&(a.c+=r.c),a.rRel&&(a.r+=r.r)),!t||t.biff<12){for(;a.c>=256;)a.c-=256;for(;a.r>=65536;)a.r-=65536}return a}function X1(e,r,t){var a=er(e);return a.s=Gi(a.s,r.s,t),a.e=Gi(a.e,r.s,t),a}function Yi(e,r){if(e.cRel&&e.c<0)for(e=er(e);e.c<0;)e.c+=r>8?16384:256;if(e.rRel&&e.r<0)for(e=er(e);e.r<0;)e.r+=r>8?1048576:r>5?65536:16384;var t=Tt(e);return!e.cRel&&e.cRel!=null&&(t=Xw(t)),!e.rRel&&e.rRel!=null&&(t=Ww(t)),t}function cu(e,r){return e.s.r==0&&!e.s.rRel&&e.e.r==(r.biff>=12?1048575:r.biff>=8?65536:16384)&&!e.e.rRel?(e.s.cRel?"":"$")+Ct(e.s.c)+":"+(e.e.cRel?"":"$")+Ct(e.e.c):e.s.c==0&&!e.s.cRel&&e.e.c==(r.biff>=12?16383:255)&&!e.e.cRel?(e.s.rRel?"":"$")+It(e.s.r)+":"+(e.e.rRel?"":"$")+It(e.e.r):Yi(e.s,r.biff)+":"+Yi(e.e,r.biff)}function cf(e){return parseInt($w(e),10)-1}function It(e){return""+(e+1)}function Ww(e){return e.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function $w(e){return e.replace(/\$(\d+)$/,"$1")}function uf(e){for(var r=Gw(e),t=0,a=0;a!==r.length;++a)t=26*t+r.charCodeAt(a)-64;return t-1}function Ct(e){if(e<0)throw new Error("invalid column "+e);var r="";for(++e;e;e=Math.floor((e-1)/26))r=String.fromCharCode((e-1)%26+65)+r;return r}function Xw(e){return e.replace(/^([A-Z])/,"$$$1")}function Gw(e){return e.replace(/^\$([A-Z])/,"$1")}function Yw(e){return e.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function Ir(e){for(var r=0,t=0,a=0;a<e.length;++a){var i=e.charCodeAt(a);i>=48&&i<=57?r=10*r+(i-48):i>=65&&i<=90&&(t=26*t+(i-64))}return{c:t-1,r:r-1}}function Tt(e){for(var r=e.c+1,t="";r;r=(r-1)/26|0)t=String.fromCharCode((r-1)%26+65)+t;return t+(e.r+1)}function ps(e){var r=e.indexOf(":");return r==-1?{s:Ir(e),e:Ir(e)}:{s:Ir(e.slice(0,r)),e:Ir(e.slice(r+1))}}function yt(e,r){return typeof r>"u"||typeof r=="number"?yt(e.s,e.e):(typeof e!="string"&&(e=Tt(e)),typeof r!="string"&&(r=Tt(r)),e==r?e:e+":"+r)}function Kw(e,r){if(!e&&!(r&&r.biff<=5&&r.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(e)?"'"+e.replace(/'/g,"''")+"'":e}function Yt(e){var r={s:{c:0,r:0},e:{c:0,r:0}},t=0,a=0,i=0,o=e.length;for(t=0;a<o&&!((i=e.charCodeAt(a)-64)<1||i>26);++a)t=26*t+i;for(r.s.c=--t,t=0;a<o&&!((i=e.charCodeAt(a)-48)<0||i>9);++a)t=10*t+i;if(r.s.r=--t,a===o||i!=10)return r.e.c=r.s.c,r.e.r=r.s.r,r;for(++a,t=0;a!=o&&!((i=e.charCodeAt(a)-64)<1||i>26);++a)t=26*t+i;for(r.e.c=--t,t=0;a!=o&&!((i=e.charCodeAt(a)-48)<0||i>9);++a)t=10*t+i;return r.e.r=--t,r}function G1(e,r){var t=e.t=="d"&&r instanceof Date;if(e.z!=null)try{return e.w=on(e.z,t?ar(r):r)}catch{}try{return e.w=on((e.XF||{}).numFmtId||(t?14:0),t?ar(r):r)}catch{return""+r}}function za(e,r,t){return e==null||e.t==null||e.t=="z"?"":e.w!==void 0?e.w:(e.t=="d"&&!e.z&&t&&t.dateNF&&(e.z=t.dateNF),e.t=="e"?Kr[e.v]||e.v:r==null?G1(e,e.v):G1(e,r))}function $a(e,r){var t=r&&r.sheet?r.sheet:"Sheet1",a={};return a[t]=e,{SheetNames:[t],Sheets:a}}function Qw(e){var r={},t=e||{};return t.dense&&(r["!data"]=[]),r}function Om(e,r,t){var a=t||{},i=e?e["!data"]!=null:a.dense,o=e||(i?{"!data":[]}:{});i&&!o["!data"]&&(o["!data"]=[]);var u=0,c=0;if(o&&a.origin!=null)if(typeof a.origin=="number")u=a.origin;else{var h=typeof a.origin=="string"?Ir(a.origin):a.origin;u=h.r,c=h.c}var x={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(o["!ref"]){var m=Yt(o["!ref"]);x.s.c=m.s.c,x.s.r=m.s.r,x.e.c=Math.max(x.e.c,m.e.c),x.e.r=Math.max(x.e.r,m.e.r),u==-1&&(x.e.r=u=o["!ref"]?m.e.r+1:0)}else x.s.c=x.e.c=x.s.r=x.e.r=0;for(var w=[],p=!1,v=0;v!=r.length;++v)if(r[v]){if(!Array.isArray(r[v]))throw new Error("aoa_to_sheet expects an array of arrays");var y=u+v;i&&(o["!data"][y]||(o["!data"][y]=[]),w=o["!data"][y]);for(var T=r[v],E=0;E!=T.length;++E)if(!(typeof T[E]>"u")){var _={v:T[E],t:""},C=c+E;if(x.s.r>y&&(x.s.r=y),x.s.c>C&&(x.s.c=C),x.e.r<y&&(x.e.r=y),x.e.c<C&&(x.e.c=C),p=!0,T[E]&&typeof T[E]=="object"&&!Array.isArray(T[E])&&!(T[E]instanceof Date))_=T[E];else if(Array.isArray(_.v)&&(_.f=T[E][1],_.v=_.v[0]),_.v===null)if(_.f)_.t="n";else if(a.nullError)_.t="e",_.v=0;else if(a.sheetStubs)_.t="z";else continue;else typeof _.v=="number"?isFinite(_.v)?_.t="n":isNaN(_.v)?(_.t="e",_.v=15):(_.t="e",_.v=7):typeof _.v=="boolean"?_.t="b":_.v instanceof Date?(_.z=a.dateNF||ht[14],a.UTC||(_.v=ic(_.v)),a.cellDates?(_.t="d",_.w=on(_.z,ar(_.v,a.date1904))):(_.t="n",_.v=ar(_.v,a.date1904),_.w=on(_.z,_.v))):_.t="s";if(i)w[C]&&w[C].z&&(_.z=w[C].z),w[C]=_;else{var S=Ct(C)+(y+1);o[S]&&o[S].z&&(_.z=o[S].z),o[S]=_}}}return p&&x.s.c<104e5&&(o["!ref"]=yt(x)),o}function ri(e,r){return Om(null,e,r)}function qw(e){return e.read_shift(4,"i")}function Dr(e){var r=e.read_shift(4);return r===0?"":e.read_shift(r,"dbcs")}function Zw(e){return{ich:e.read_shift(2),ifnt:e.read_shift(2)}}function ff(e,r){var t=e.l,a=e.read_shift(1),i=Dr(e),o=[],u={t:i,h:i};if((a&1)!==0){for(var c=e.read_shift(4),h=0;h!=c;++h)o.push(Zw(e));u.r=o}else u.r=[{ich:0,ifnt:0}];return e.l=t+r,u}var Jw=ff;function Cn(e){var r=e.read_shift(4),t=e.read_shift(2);return t+=e.read_shift(1)<<16,e.l++,{c:r,iStyleRef:t}}function gs(e){var r=e.read_shift(2);return r+=e.read_shift(1)<<16,e.l++,{c:-1,iStyleRef:r}}var ey=Dr;function lc(e){var r=e.read_shift(4);return r===0||r===4294967295?"":e.read_shift(r,"dbcs")}var ty=Dr,Bu=lc;function cc(e){var r=e.slice(e.l,e.l+4),t=r[0]&1,a=r[0]&2;e.l+=4;var i=a===0?Yl([0,0,0,0,r[0]&252,r[1],r[2],r[3]],0):is(r,0)>>2;return t?i/100:i}function jm(e){var r={s:{},e:{}};return r.s.r=e.read_shift(4),r.e.r=e.read_shift(4),r.s.c=e.read_shift(4),r.e.c=e.read_shift(4),r}var vs=jm;function Fr(e){if(e.length-e.l<8)throw"XLS Xnum Buffer underflow";return e.read_shift(8,"f")}function ry(e){var r={},t=e.read_shift(1),a=t>>>1,i=e.read_shift(1),o=e.read_shift(2,"i"),u=e.read_shift(1),c=e.read_shift(1),h=e.read_shift(1);switch(e.l++,a){case 0:r.auto=1;break;case 1:r.index=i;var x=us[i];x&&(r.rgb=oo(x));break;case 2:r.rgb=oo([u,c,h]);break;case 3:r.theme=i;break}return o!=0&&(r.tint=o>0?o/32767:o/32768),r}function ny(e){var r=e.read_shift(1);e.l++;var t={fBold:r&1,fItalic:r&2,fUnderline:r&4,fStrikeout:r&8,fOutline:r&16,fShadow:r&32,fCondense:r&64,fExtend:r&128};return t}function Lm(e,r){var t={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},a=e.read_shift(4);switch(a){case 0:return"";case 4294967295:case 4294967294:return t[e.read_shift(4)]||""}if(a>400)throw new Error("Unsupported Clipboard: "+a.toString(16));return e.l-=4,e.read_shift(0,r==1?"lpstr":"lpwstr")}function ay(e){return Lm(e,1)}function sy(e){return Lm(e,2)}var df=2,Gr=3,Il=11,Y1=12,Kl=19,Dl=64,iy=65,oy=71,ly=4108,cy=4126,ur=80,Mm=81,uy=[ur,Mm],fy={1:{n:"CodePage",t:df},2:{n:"Category",t:ur},3:{n:"PresentationFormat",t:ur},4:{n:"ByteCount",t:Gr},5:{n:"LineCount",t:Gr},6:{n:"ParagraphCount",t:Gr},7:{n:"SlideCount",t:Gr},8:{n:"NoteCount",t:Gr},9:{n:"HiddenCount",t:Gr},10:{n:"MultimediaClipCount",t:Gr},11:{n:"ScaleCrop",t:Il},12:{n:"HeadingPairs",t:ly},13:{n:"TitlesOfParts",t:cy},14:{n:"Manager",t:ur},15:{n:"Company",t:ur},16:{n:"LinksUpToDate",t:Il},17:{n:"CharacterCount",t:Gr},19:{n:"SharedDoc",t:Il},22:{n:"HyperlinksChanged",t:Il},23:{n:"AppVersion",t:Gr,p:"version"},24:{n:"DigSig",t:iy},26:{n:"ContentType",t:ur},27:{n:"ContentStatus",t:ur},28:{n:"Language",t:ur},29:{n:"Version",t:ur},255:{},2147483648:{n:"Locale",t:Kl},2147483651:{n:"Behavior",t:Kl},1919054434:{}},dy={1:{n:"CodePage",t:df},2:{n:"Title",t:ur},3:{n:"Subject",t:ur},4:{n:"Author",t:ur},5:{n:"Keywords",t:ur},6:{n:"Comments",t:ur},7:{n:"Template",t:ur},8:{n:"LastAuthor",t:ur},9:{n:"RevNumber",t:ur},10:{n:"EditTime",t:Dl},11:{n:"LastPrinted",t:Dl},12:{n:"CreatedDate",t:Dl},13:{n:"ModifiedDate",t:Dl},14:{n:"PageCount",t:Gr},15:{n:"WordCount",t:Gr},16:{n:"CharCount",t:Gr},17:{n:"Thumbnail",t:oy},18:{n:"Application",t:ur},19:{n:"DocSecurity",t:Gr},255:{},2147483648:{n:"Locale",t:Kl},2147483651:{n:"Behavior",t:Kl},1919054434:{}},K1={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},hy=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function xy(e){return e.map(function(r){return[r>>16&255,r>>8&255,r&255]})}var my=xy([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,0,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),us=er(my),Kr={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},vr={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},Bm=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"],Q1={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"};function py(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function gy(e){var r=py();if(!e||!e.match)return r;var t={};if((e.match(kr)||[]).forEach(function(a){var i=Ze(a);switch(i[0].replace(_w,"<")){case"<?xml":break;case"<Types":r.xmlns=i["xmlns"+(i[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":t[i.Extension.toLowerCase()]=i.ContentType;break;case"<Override":r[Q1[i.ContentType]]!==void 0&&r[Q1[i.ContentType]].push(i.PartName);break}}),r.xmlns!==Pw.CT)throw new Error("Unknown Namespace: "+r.xmlns);return r.calcchain=r.calcchains.length>0?r.calcchains[0]:"",r.sst=r.strs.length>0?r.strs[0]:"",r.style=r.styles.length>0?r.styles[0]:"",r.defaults=t,delete r.calcchains,r}var Xs={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",CONN:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/connections",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function Uu(e){var r=e.lastIndexOf("/");return e.slice(0,r+1)+"_rels/"+e.slice(r+1)+".rels"}function Ki(e,r){var t={"!id":{}};if(!e)return t;r.charAt(0)!=="/"&&(r="/"+r);var a={};return(e.match(kr)||[]).forEach(function(i){var o=Ze(i);if(o[0]==="<Relationship"){var u={};u.Type=o.Type,u.Target=wt(o.Target),u.Id=o.Id,o.TargetMode&&(u.TargetMode=o.TargetMode);var c=o.TargetMode==="External"?o.Target:$s(o.Target,r);t[c]=u,a[o.Id]=u}}),t["!id"]=a,t}var vy="application/vnd.oasis.opendocument.spreadsheet";function wy(e,r){for(var t=oc(e),a,i;a=Zt.exec(t);)switch(a[3]){case"manifest":break;case"file-entry":if(i=Ze(a[0],!1),i.path=="/"&&i.type!==vy)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(r&&r.WTF)throw a}}var q1=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]];function Um(e){var r={};e=Pt(e);for(var t=0;t<q1.length;++t){var a=q1[t],i=cs(e,a[0]);i!=null&&i.length>0&&(r[a[1]]=wt(i[1])),a[2]==="date"&&r[a[1]]&&(r[a[1]]=yr(r[a[1]]))}return r}var yy=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]];function zm(e,r,t,a){var i=[];if(typeof e=="string")i=U1(e,a);else for(var o=0;o<e.length;++o)i=i.concat(e[o].map(function(m){return{v:m}}));var u=typeof r=="string"?U1(r,a).map(function(m){return m.v}):r,c=0,h=0;if(u.length>0)for(var x=0;x!==i.length;x+=2){switch(h=+i[x+1].v,i[x].v){case"Worksheets":case"":case"":case" ":case"":case" ":case"Arbeitsbltter":case"alma Sayfalar":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de clculo":case"Planilhas":case"Regneark":case"Hojas de clculo":case"Werkbladen":t.Worksheets=h,t.SheetNames=u.slice(c,c+h);break;case"Named Ranges":case"Rangos con nombre":case"":case"Benannte Bereiche":case"Navngivne omrder":t.NamedRanges=h,t.DefinedNames=u.slice(c,c+h);break;case"Charts":case"Diagramme":t.Chartsheets=h,t.ChartNames=u.slice(c,c+h);break}c+=h}}function ky(e,r,t){var a={};return r||(r={}),e=Pt(e),yy.forEach(function(i){var o=(dr(e,i[0])||[])[1];switch(i[2]){case"string":o&&(r[i[1]]=wt(o));break;case"bool":r[i[1]]=o==="true";break;case"raw":var u=cs(e,i[0]);u&&u.length>0&&(a[i[1]]=u[1]);break}}),a.HeadingPairs&&a.TitlesOfParts&&zm(a.HeadingPairs,a.TitlesOfParts,r,t),r}var Ey=/<[^<>]+>[^<]*/g;function _y(e,r){var t={},a="",i=e.match(Ey);if(i)for(var o=0;o!=i.length;++o){var u=i[o],c=Ze(u);switch(Sn(c[0])){case"<?xml":break;case"<Properties":break;case"<property":a=wt(c.name);break;case"</property>":a=null;break;default:if(u.indexOf("<vt:")===0){var h=u.split(">"),x=h[0].slice(4),m=h[1];switch(x){case"lpstr":case"bstr":case"lpwstr":t[a]=wt(m);break;case"bool":t[a]=Ft(m);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":t[a]=parseInt(m,10);break;case"r4":case"r8":case"decimal":t[a]=parseFloat(m);break;case"filetime":case"date":t[a]=yr(m);break;case"cy":case"error":t[a]=wt(m);break;default:if(x.slice(-1)=="/")break;r.WTF&&typeof console<"u"&&console.warn("Unexpected",u,x,h)}}else if(u.slice(0,2)!=="</"){if(r.WTF)throw new Error(u)}}}return t}var Ty={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},uu;function Sy(e,r,t){uu||(uu=nf(Ty)),r=uu[r]||r,e[r]=t}function hf(e){var r=e.read_shift(4),t=e.read_shift(4);return new Date((t/1e7*Math.pow(2,32)+r/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function Cy(e,r,t){var a=e.l,i=e.read_shift(0,"lpstr-cp");if(t)for(;e.l-a&3;)++e.l;return i}function by(e,r,t){var a=e.read_shift(0,"lpwstr");return a}function Hm(e,r,t){return r===31?by(e):Cy(e,r,t)}function Qi(e,r,t){return Hm(e,r,t===!1?0:4)}function Ny(e,r){if(!r)throw new Error("VtUnalignedString must have positive length");return Hm(e,r,0)}function Ay(e){for(var r=e.read_shift(4),t=[],a=0;a!=r;++a){var i=e.l;t[a]=e.read_shift(0,"lpwstr").replace(Yr,""),e.l-i&2&&(e.l+=2)}return t}function Fy(e){for(var r=e.read_shift(4),t=[],a=0;a!=r;++a)t[a]=e.read_shift(0,"lpstr-cp").replace(Yr,"");return t}function Iy(e){var r=e.l,t=Ql(e,Mm);e[e.l]==0&&e[e.l+1]==0&&e.l-r&2&&(e.l+=2);var a=Ql(e,Gr);return[t,a]}function Dy(e){for(var r=e.read_shift(4),t=[],a=0;a<r/2;++a)t.push(Iy(e));return t}function Z1(e,r){for(var t=e.read_shift(4),a={},i=0;i!=t;++i){var o=e.read_shift(4),u=e.read_shift(4);a[o]=e.read_shift(u,r===1200?"utf16le":"utf8").replace(Yr,"").replace(zi,"!"),r===1200&&u%2&&(e.l+=2)}return e.l&3&&(e.l=e.l>>3<<2),a}function Vm(e){var r=e.read_shift(4),t=e.slice(e.l,e.l+r);return e.l+=r,(r&3)>0&&(e.l+=4-(r&3)&3),t}function Ry(e){var r={};return r.Size=e.read_shift(4),e.l+=r.Size+3-(r.Size-1)%4,r}function Ql(e,r,t){var a=e.read_shift(2),i,o=t||{};if(e.l+=2,r!==Y1&&a!==r&&uy.indexOf(r)===-1&&!((r&65534)==4126&&(a&65534)==4126))throw new Error("Expected type "+r+" saw "+a);switch(r===Y1?a:r){case 2:return i=e.read_shift(2,"i"),o.raw||(e.l+=2),i;case 3:return i=e.read_shift(4,"i"),i;case 11:return e.read_shift(4)!==0;case 19:return i=e.read_shift(4),i;case 30:e.l+=4,val=Qi(e,e[e.l-4]).replace(/(^|[^\u0000])\u0000+$/,"$1");break;case 31:e.l+=4,val=Qi(e,e[e.l-4]).replace(/(^|[^\u0000])\u0000+$/,"$1");break;case 64:return hf(e);case 65:return Vm(e);case 71:return Ry(e);case 80:return Qi(e,a,!o.raw).replace(Yr,"");case 81:return Ny(e,a).replace(Yr,"");case 4108:return Dy(e);case 4126:case 4127:return a==4127?Ay(e):Fy(e);default:throw new Error("TypedPropertyValue unrecognized type "+r+" "+a)}}function J1(e,r){var t=e.l,a=e.read_shift(4),i=e.read_shift(4),o=[],u=0,c=0,h=-1,x={};for(u=0;u!=i;++u){var m=e.read_shift(4),w=e.read_shift(4);o[u]=[m,w+t]}o.sort(function(C,S){return C[1]-S[1]});var p={};for(u=0;u!=i;++u){if(e.l!==o[u][1]){var v=!0;if(u>0&&r)switch(r[o[u-1][0]].t){case 2:e.l+2===o[u][1]&&(e.l+=2,v=!1);break;case 80:e.l<=o[u][1]&&(e.l=o[u][1],v=!1);break;case 4108:e.l<=o[u][1]&&(e.l=o[u][1],v=!1);break}if((!r||u==0)&&e.l<=o[u][1]&&(v=!1,e.l=o[u][1]),v)throw new Error("Read Error: Expected address "+o[u][1]+" at "+e.l+" :"+u)}if(r){if(o[u][0]==0&&o.length>u+1&&o[u][1]==o[u+1][1])continue;var y=r[o[u][0]];if(p[y.n]=Ql(e,y.t,{raw:!0}),y.p==="version"&&(p[y.n]=String(p[y.n]>>16)+"."+("0000"+String(p[y.n]&65535)).slice(-4)),y.n=="CodePage")switch(p[y.n]){case 0:p[y.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:On(c=p[y.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+p[y.n])}}else if(o[u][0]===1){if(c=p.CodePage=Ql(e,df),On(c),h!==-1){var T=e.l;e.l=o[h][1],x=Z1(e,c),e.l=T}}else if(o[u][0]===0){if(c===0){h=u,e.l=o[u+1][1];continue}x=Z1(e,c)}else{var E=x[o[u][0]],_;switch(e[e.l]){case 65:e.l+=4,_=Vm(e);break;case 30:e.l+=4,_=Qi(e,e[e.l-4]).replace(/(^|[^\u0000])\u0000+$/,"$1");break;case 31:e.l+=4,_=Qi(e,e[e.l-4]).replace(/(^|[^\u0000])\u0000+$/,"$1");break;case 3:e.l+=4,_=e.read_shift(4,"i");break;case 19:e.l+=4,_=e.read_shift(4);break;case 5:e.l+=4,_=e.read_shift(8,"f");break;case 11:e.l+=4,_=Gt(e,4);break;case 64:e.l+=4,_=yr(hf(e));break;default:throw new Error("unparsed value: "+e[e.l])}p[E]=_}}return e.l=t+a,p}function ex(e,r,t){var a=e.content;if(!a)return{};nr(a,0);var i,o,u,c,h=0;a.chk("feff","Byte Order: "),a.read_shift(2);var x=a.read_shift(4),m=a.read_shift(16);if(m!==Et.utils.consts.HEADER_CLSID&&m!==t)throw new Error("Bad PropertySet CLSID "+m);if(i=a.read_shift(4),i!==1&&i!==2)throw new Error("Unrecognized #Sets: "+i);if(o=a.read_shift(16),c=a.read_shift(4),i===1&&c!==a.l)throw new Error("Length mismatch: "+c+" !== "+a.l);i===2&&(u=a.read_shift(16),h=a.read_shift(4));var w=J1(a,r),p={SystemIdentifier:x};for(var v in w)p[v]=w[v];if(p.FMTID=o,i===1)return p;if(h-a.l==2&&(a.l+=2),a.l!==h)throw new Error("Length mismatch 2: "+a.l+" !== "+h);var y;try{y=J1(a,null)}catch{}for(v in y)p[v]=y[v];return p.FMTID=[o,u],p}function Da(e,r){return e.read_shift(r),null}function Py(e,r,t){for(var a=[],i=e.l+r;e.l<i;)a.push(t(e,i-e.l));if(i!==e.l)throw new Error("Slurp error");return a}function Gt(e,r){return e.read_shift(r)===1}function Vt(e){return e.read_shift(2,"u")}function Wm(e,r){return Py(e,r,Vt)}function $m(e){var r=e.read_shift(1),t=e.read_shift(1);return t===1?r:r===1}function qs(e,r,t){var a=e.read_shift(t&&t.biff>=12?2:1),i="sbcs-cont",o=kn;if(t&&t.biff>=8&&(kn=1200),!t||t.biff==8){var u=e.read_shift(1);u&&(i="dbcs-cont")}else t.biff==12&&(i="wstr");t.biff>=2&&t.biff<=5&&(i="cpstr");var c=a?e.read_shift(a,i):"";return kn=o,c}function Oy(e){var r=kn;kn=1200;var t=e.read_shift(2),a=e.read_shift(1),i=a&4,o=a&8,u=1+(a&1),c=0,h,x={};o&&(c=e.read_shift(2)),i&&(h=e.read_shift(4));var m=u==2?"dbcs-cont":"sbcs-cont",w=t===0?"":e.read_shift(t,m);return o&&(e.l+=4*c),i&&(e.l+=h),x.t=w,o||(x.raw="<t>"+x.t+"</t>",x.r=x.t),kn=r,x}function ms(e,r,t){var a;if(t){if(t.biff>=2&&t.biff<=5)return e.read_shift(r,"cpstr");if(t.biff>=12)return e.read_shift(r,"dbcs-cont")}var i=e.read_shift(1);return i===0?a=e.read_shift(r,"sbcs-cont"):a=e.read_shift(r,"dbcs-cont"),a}function po(e,r,t){var a=e.read_shift(t&&t.biff==2?1:2);return a===0?(e.l++,""):ms(e,a,t)}function ws(e,r,t){if(t.biff>5)return po(e,r,t);var a=e.read_shift(1);return a===0?(e.l++,""):e.read_shift(a,t.biff<=4||!e.lens?"cpstr":"sbcs-cont")}function jy(e){var r=e.read_shift(1);e.l++;var t=e.read_shift(2);return e.l+=2,[r,t]}function Ly(e){var r=e.read_shift(4),t=e.l,a=!1;r>24&&(e.l+=r-24,e.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(a=!0),e.l=t);var i=e.read_shift((a?r-24:r)>>1,"utf16le").replace(Yr,"");return a&&(e.l+=24),i}function My(e){for(var r=e.read_shift(2),t="";r-- >0;)t+="../";var a=e.read_shift(0,"lpstr-ansi");if(e.l+=2,e.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var i=e.read_shift(4);if(i===0)return t+a.replace(/\\/g,"/");var o=e.read_shift(4);if(e.read_shift(2)!=3)throw new Error("Bad FileMoniker");var u=e.read_shift(o>>1,"utf16le").replace(Yr,"");return t+u}function By(e,r){var t=e.read_shift(16);switch(t){case"e0c9ea79f9bace118c8200aa004ba90b":return Ly(e);case"0303000000000000c000000000000046":return My(e);default:throw new Error("Unsupported Moniker "+t)}}function Rl(e){var r=e.read_shift(4),t=r>0?e.read_shift(r,"utf16le").replace(Yr,""):"";return t}function Uy(e,r){var t=e.l+r,a=e.read_shift(4);if(a!==2)throw new Error("Unrecognized streamVersion: "+a);var i=e.read_shift(2);e.l+=2;var o,u,c,h,x="",m,w;i&16&&(o=Rl(e,t-e.l)),i&128&&(u=Rl(e,t-e.l)),(i&257)===257&&(c=Rl(e,t-e.l)),(i&257)===1&&(h=By(e,t-e.l)),i&8&&(x=Rl(e,t-e.l)),i&32&&(m=e.read_shift(16)),i&64&&(w=hf(e)),e.l=t;var p=u||c||h||"";p&&x&&(p+="#"+x),p||(p="#"+x),i&2&&p.charAt(0)=="/"&&p.charAt(1)!="/"&&(p="file://"+p);var v={Target:p};return m&&(v.guid=m),w&&(v.time=w),o&&(v.Tooltip=o),v}function Xm(e){var r=e.read_shift(1),t=e.read_shift(1),a=e.read_shift(1),i=e.read_shift(1);return[r,t,a,i]}function Gm(e,r){var t=Xm(e);return t[3]=0,t}function Bn(e,r,t){var a=e.read_shift(2),i=e.read_shift(2),o={r:a,c:i,ixfe:0};if(t&&t.biff==2||r==7){var u=e.read_shift(1);o.ixfe=u&63,e.l+=2}else o.ixfe=e.read_shift(2);return o}function zy(e){var r=e.read_shift(2),t=e.read_shift(2);return e.l+=8,{type:r,flags:t}}function Hy(e,r,t){return r===0?"":ws(e,r,t)}function Vy(e,r,t){var a=t.biff>8?4:2,i=e.read_shift(a),o=e.read_shift(a,"i"),u=e.read_shift(a,"i");return[i,o,u]}function Ym(e){var r=e.read_shift(2),t=cc(e);return[r,t]}function Wy(e,r,t){e.l+=4,r-=4;var a=e.l+r,i=qs(e,r,t),o=e.read_shift(2);if(a-=e.l,o!==a)throw new Error("Malformed AddinUdf: padding = "+a+" != "+o);return e.l+=o,i}function uc(e){var r=e.read_shift(2),t=e.read_shift(2),a=e.read_shift(2),i=e.read_shift(2);return{s:{c:a,r},e:{c:i,r:t}}}function Km(e){var r=e.read_shift(2),t=e.read_shift(2),a=e.read_shift(1),i=e.read_shift(1);return{s:{c:a,r},e:{c:i,r:t}}}var $y=Km;function Qm(e){e.l+=4;var r=e.read_shift(2),t=e.read_shift(2),a=e.read_shift(2);return e.l+=12,[t,r,a]}function Xy(e){var r={};return e.l+=4,e.l+=16,r.fSharedNote=e.read_shift(2),e.l+=4,r}function Gy(e){var r={};return e.l+=4,e.cf=e.read_shift(2),r}function Nr(e){e.l+=2,e.l+=e.read_shift(2)}var Yy={0:Nr,4:Nr,5:Nr,6:Nr,7:Gy,8:Nr,9:Nr,10:Nr,11:Nr,12:Nr,13:Xy,14:Nr,15:Nr,16:Nr,17:Nr,18:Nr,19:Nr,20:Nr,21:Qm};function Ky(e,r){for(var t=e.l+r,a=[];e.l<t;){var i=e.read_shift(2);e.l-=2;try{a[i]=Yy[i](e,t-e.l)}catch{return e.l=t,a}}return e.l!=t&&(e.l=t),a}function Pl(e,r){var t={BIFFVer:0,dt:0};switch(t.BIFFVer=e.read_shift(2),r-=2,r>=2&&(t.dt=e.read_shift(2),e.l-=2),t.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(r>6)throw new Error("Unexpected BIFF Ver "+t.BIFFVer)}return e.read_shift(r),t}function Qy(e,r){return r===0||e.read_shift(2),1200}function qy(e,r,t){if(t.enc)return e.l+=r,"";var a=e.l,i=ws(e,0,t);return e.read_shift(r+a-e.l),i}function Zy(e,r,t){var a=t&&t.biff==8||r==2?e.read_shift(2):(e.l+=r,0);return{fDialog:a&16,fBelow:a&64,fRight:a&128}}function Jy(e,r,t){var a="";if(t.biff==4)return a=qs(e,0,t),a.length===0&&(a="Sheet1"),{name:a};var i=e.read_shift(4),o=e.read_shift(1)&3,u=e.read_shift(1);switch(u){case 0:u="Worksheet";break;case 1:u="Macrosheet";break;case 2:u="Chartsheet";break;case 6:u="VBAModule";break}return a=qs(e,0,t),a.length===0&&(a="Sheet1"),{pos:i,hs:o,dt:u,name:a}}function e4(e,r){for(var t=e.l+r,a=e.read_shift(4),i=e.read_shift(4),o=[],u=0;u!=i&&e.l<t;++u)o.push(Oy(e));return o.Count=a,o.Unique=i,o}function t4(e,r){var t={};return t.dsst=e.read_shift(2),e.l+=r-2,t}function r4(e){var r={};r.r=e.read_shift(2),r.c=e.read_shift(2),r.cnt=e.read_shift(2)-r.c;var t=e.read_shift(2);e.l+=4;var a=e.read_shift(1);return e.l+=3,a&7&&(r.level=a&7),a&32&&(r.hidden=!0),a&64&&(r.hpt=t/20),r}function n4(e){var r=zy(e);if(r.type!=2211)throw new Error("Invalid Future Record "+r.type);var t=e.read_shift(4);return t!==0}function a4(e){return e.read_shift(2),e.read_shift(4)}function tx(e,r,t){var a=0;t&&t.biff==2||(a=e.read_shift(2));var i=e.read_shift(2);t&&t.biff==2&&(a=1-(i>>15),i&=32767);var o={Unsynced:a&1,DyZero:(a&2)>>1,ExAsc:(a&4)>>2,ExDsc:(a&8)>>3};return[o,i]}function s4(e){var r=e.read_shift(2),t=e.read_shift(2),a=e.read_shift(2),i=e.read_shift(2),o=e.read_shift(2),u=e.read_shift(2),c=e.read_shift(2),h=e.read_shift(2),x=e.read_shift(2);return{Pos:[r,t],Dim:[a,i],Flags:o,CurTab:u,FirstTab:c,Selected:h,TabRatio:x}}function i4(e,r,t){if(t&&t.biff>=2&&t.biff<5)return{};var a=e.read_shift(2);return{RTL:a&64}}function o4(){}function l4(e,r,t){var a={dyHeight:e.read_shift(2),fl:e.read_shift(2)};switch(t&&t.biff||8){case 2:break;case 3:case 4:e.l+=2;break;default:e.l+=10;break}return a.name=qs(e,0,t),a}function c4(e,r,t){var a=Bn(e,r,t);return a.isst=e.read_shift(4),a}function u4(e,r,t){t.biffguess&&t.biff==2&&(t.biff=5);var a=e.l+r,i=Bn(e,r,t),o=po(e,a-e.l,t);return i.val=o,i}function f4(e,r,t){var a=e.read_shift(2),i=ws(e,0,t);return[a,i]}var d4=ws;function rx(e,r,t){var a=e.l+r,i=t.biff==8||!t.biff?4:2,o=e.read_shift(i),u=e.read_shift(i),c=e.read_shift(2),h=e.read_shift(2);return e.l=a,{s:{r:o,c},e:{r:u,c:h}}}function h4(e){var r=e.read_shift(2),t=e.read_shift(2),a=Ym(e);return{r,c:t,ixfe:a[0],rknum:a[1]}}function x4(e,r){for(var t=e.l+r-2,a=e.read_shift(2),i=e.read_shift(2),o=[];e.l<t;)o.push(Ym(e));if(e.l!==t)throw new Error("MulRK read error");var u=e.read_shift(2);if(o.length!=u-i+1)throw new Error("MulRK length mismatch");return{r:a,c:i,C:u,rkrec:o}}function m4(e,r){for(var t=e.l+r-2,a=e.read_shift(2),i=e.read_shift(2),o=[];e.l<t;)o.push(e.read_shift(2));if(e.l!==t)throw new Error("MulBlank read error");var u=e.read_shift(2);if(o.length!=u-i+1)throw new Error("MulBlank length mismatch");return{r:a,c:i,C:u,ixfe:o}}function p4(e,r,t,a){var i={},o=e.read_shift(4),u=e.read_shift(4),c=e.read_shift(4),h=e.read_shift(2);return i.patternType=hy[c>>26],a.cellStyles&&(i.alc=o&7,i.fWrap=o>>3&1,i.alcV=o>>4&7,i.fJustLast=o>>7&1,i.trot=o>>8&255,i.cIndent=o>>16&15,i.fShrinkToFit=o>>20&1,i.iReadOrder=o>>22&2,i.fAtrNum=o>>26&1,i.fAtrFnt=o>>27&1,i.fAtrAlc=o>>28&1,i.fAtrBdr=o>>29&1,i.fAtrPat=o>>30&1,i.fAtrProt=o>>31&1,i.dgLeft=u&15,i.dgRight=u>>4&15,i.dgTop=u>>8&15,i.dgBottom=u>>12&15,i.icvLeft=u>>16&127,i.icvRight=u>>23&127,i.grbitDiag=u>>30&3,i.icvTop=c&127,i.icvBottom=c>>7&127,i.icvDiag=c>>14&127,i.dgDiag=c>>21&15,i.icvFore=h&127,i.icvBack=h>>7&127,i.fsxButton=h>>14&1),i}function g4(e,r,t){var a={};return a.ifnt=e.read_shift(2),a.numFmtId=e.read_shift(2),a.flags=e.read_shift(2),a.fStyle=a.flags>>2&1,r-=6,a.data=p4(e,r,a.fStyle,t),a}function v4(e){var r={};return r.ifnt=e.read_shift(1),e.l++,r.flags=e.read_shift(1),r.numFmtId=r.flags&63,r.flags>>=6,r.fStyle=0,r.data={},r}function w4(e){var r={};return r.ifnt=e.read_shift(1),r.numFmtId=e.read_shift(1),r.flags=e.read_shift(2),r.fStyle=r.flags>>2&1,r.data={},r}function y4(e){var r={};return r.ifnt=e.read_shift(1),r.numFmtId=e.read_shift(1),r.flags=e.read_shift(2),r.fStyle=r.flags>>2&1,r.data={},r}function k4(e){e.l+=4;var r=[e.read_shift(2),e.read_shift(2)];if(r[0]!==0&&r[0]--,r[1]!==0&&r[1]--,r[0]>7||r[1]>7)throw new Error("Bad Gutters: "+r.join("|"));return r}function E4(e,r,t){var a=Bn(e,6,t),i=$m(e);return a.val=i,a.t=i===!0||i===!1?"b":"e",a}function _4(e,r,t){t.biffguess&&t.biff==2&&(t.biff=5);var a=Bn(e,6,t),i=Fr(e);return a.val=i,a}var nx=Hy;function T4(e,r,t){var a=e.l+r,i=e.read_shift(2),o=e.read_shift(2);if(t.sbcch=o,o==1025||o==14849)return[o,i];if(o<1||o>255)throw new Error("Unexpected SupBook type: "+o);for(var u=ms(e,o),c=[];a>e.l;)c.push(po(e));return[o,i,u,c]}function ax(e,r,t){var a=e.read_shift(2),i,o={fBuiltIn:a&1,fWantAdvise:a>>>1&1,fWantPict:a>>>2&1,fOle:a>>>3&1,fOleLink:a>>>4&1,cf:a>>>5&1023,fIcon:a>>>15&1};return t.sbcch===14849&&(i=Wy(e,r-2,t)),o.body=i||e.read_shift(r-2),typeof i=="string"&&(o.Name=i),o}function sx(e,r,t){var a=e.l+r,i=e.read_shift(2),o=e.read_shift(1),u=e.read_shift(1),c=e.read_shift(t&&t.biff==2?1:2),h=0;(!t||t.biff>=5)&&(t.biff!=5&&(e.l+=2),h=e.read_shift(2),t.biff==5&&(e.l+=2),e.l+=4);var x=ms(e,u,t);i&32&&(x=Bm[x.charCodeAt(0)]);var m=a-e.l;t&&t.biff==2&&--m;var w=a==e.l||c===0||!(m>0)?[]:J3(e,m,t,c);return{chKey:o,Name:x,itab:h,rgce:w}}function qm(e,r,t){if(t.biff<8||!(t.biff>8)&&r==e[e.l]+(e[e.l+1]==3?1:0)+1)return ix(e,r,t);for(var a=[],i=e.l+r,o=e.read_shift(t.biff>8?4:2);o--!==0;)a.push(Vy(e,t.biff>8?12:6,t));if(e.l!=i)throw new Error("Bad ExternSheet: "+e.l+" != "+i);return a}function ix(e,r,t){e[e.l+1]==3&&e[e.l]++;var a=qs(e,r,t);return a.charCodeAt(0)==3?a.slice(1):a}function S4(e,r,t){if(t.biff<8){e.l+=r;return}var a=e.read_shift(2),i=e.read_shift(2),o=ms(e,a,t),u=ms(e,i,t);return[o,u]}function C4(e,r,t){var a=Km(e);e.l++;var i=e.read_shift(1);return r-=8,[eE(e,r,t),i,a]}function ox(e,r,t){var a=$y(e);switch(t.biff){case 2:e.l++,r-=7;break;case 3:case 4:e.l+=2,r-=8;break;default:e.l+=6,r-=12}return[a,q3(e,r,t)]}function b4(e){var r=e.read_shift(4)!==0,t=e.read_shift(4)!==0,a=e.read_shift(4);return[r,t,a]}function N4(e,r,t){var a=e.read_shift(2),i=e.read_shift(2),o=e.read_shift(2),u=e.read_shift(2),c=ws(e,0,t);return[{r:a,c:i},c,u,o]}function A4(e,r,t){if(t&&t.biff<8){var a=e.read_shift(2),i=e.read_shift(2);if(a==65535||a==-1)return;var o=e.read_shift(2),u=e.read_shift(Math.min(o,2048),"cpstr");return[{r:a,c:i},u]}return N4(e,r,t)}function F4(e,r){for(var t=[],a=e.read_shift(2);a--;)t.push(uc(e));return t}function I4(e,r,t){if(t&&t.biff<8)return R4(e,r,t);var a=Qm(e),i=Ky(e,r-22,a[1]);return{cmo:a,ft:i}}var D4={8:function(e,r){var t=e.l+r;e.l+=10;var a=e.read_shift(2);e.l+=4,e.l+=2,e.l+=2,e.l+=2,e.l+=4;var i=e.read_shift(1);return e.l+=i,e.l=t,{fmt:a}}};function R4(e,r,t){e.l+=4;var a=e.read_shift(2),i=e.read_shift(2),o=e.read_shift(2);e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=6,r-=36;var u=[];return u.push((D4[a]||Rr)(e,r,t)),{cmo:[i,a,o],ft:u}}function P4(e,r,t){var a=e.l,i="";try{e.l+=4;var o=(t.lastobj||{cmo:[0,0]}).cmo[1],u;[0,5,7,11,12,14].indexOf(o)==-1?e.l+=6:u=jy(e,6,t);var c=e.read_shift(2);e.read_shift(2),Vt(e,2);var h=e.read_shift(2);e.l+=h;for(var x=1;x<e.lens.length-1;++x){if(e.l-a!=e.lens[x])throw new Error("TxO: bad continue record");var m=e[e.l],w=ms(e,e.lens[x+1]-e.lens[x]-1);if(i+=w,i.length>=(m?c:2*c))break}if(i.length!==c&&i.length!==c*2)throw new Error("cchText: "+c+" != "+i.length);return e.l=a+r,{t:i}}catch{return e.l=a+r,{t:i}}}function O4(e,r){var t=uc(e);e.l+=16;var a=Uy(e,r-24);return[t,a]}function j4(e,r){e.read_shift(2);var t=uc(e),a=e.read_shift((r-10)/2,"dbcs-cont");return a=a.replace(Yr,""),[t,a]}function L4(e){var r=[0,0],t;return t=e.read_shift(2),r[0]=K1[t]||t,t=e.read_shift(2),r[1]=K1[t]||t,r}function M4(e){for(var r=e.read_shift(2),t=[];r-- >0;)t.push(Gm(e));return t}function B4(e){for(var r=e.read_shift(2),t=[];r-- >0;)t.push(Gm(e));return t}function U4(e){e.l+=2;var r={cxfs:0,crc:0};return r.cxfs=e.read_shift(2),r.crc=e.read_shift(4),r}function Zm(e,r,t){if(!t.cellStyles)return Rr(e,r);var a=t&&t.biff>=12?4:2,i=e.read_shift(a),o=e.read_shift(a),u=e.read_shift(a),c=e.read_shift(a),h=e.read_shift(2);a==2&&(e.l+=2);var x={s:i,e:o,w:u,ixfe:c,flags:h};return(t.biff>=5||!t.biff)&&(x.level=h>>8&7),x}function z4(e,r){var t={};return r<32||(e.l+=16,t.header=Fr(e),t.footer=Fr(e),e.l+=2),t}function H4(e,r,t){var a={area:!1};if(t.biff!=5)return e.l+=r,a;var i=e.read_shift(1);return e.l+=3,i&16&&(a.area=!0),a}var V4=Bn,W4=Wm,$4=po;function X4(e){var r=e.read_shift(2),t=e.read_shift(2),a=e.read_shift(4),i={fmt:r,env:t,len:a,data:e.slice(e.l,e.l+a)};return e.l+=a,i}function G4(e,r,t){t.biffguess&&t.biff==5&&(t.biff=2);var a=Bn(e,7,t),i=ws(e,r-7,t);return a.t="str",a.val=i,a}function Y4(e,r,t){var a=Bn(e,7,t),i=Fr(e);return a.t="n",a.val=i,a}function K4(e,r,t){var a=Bn(e,7,t),i=e.read_shift(2);return a.t="n",a.val=i,a}function Q4(e){var r=e.read_shift(1);return r===0?(e.l++,""):e.read_shift(r,"sbcs-cont")}function q4(e,r,t){var a=e.l+7,i=Bn(e,6,t);e.l=a;var o=$m(e);return i.val=o,i.t=o===!0||o===!1?"b":"e",i}function Z4(e,r){e.l+=6,e.l+=2,e.l+=1,e.l+=3,e.l+=1,e.l+=r-13}function J4(e,r,t){var a=e.l+r,i=Bn(e,6,t),o=e.read_shift(2),u=ms(e,o,t);return e.l=a,i.t="str",i.val=u,i}function ek(e){var r=e.read_shift(4),t=e.read_shift(1),a=e.read_shift(t,"sbcs");return a.length===0&&(a="Sheet1"),{flags:r,name:a}}var tk=[2,3,48,49,131,139,140,245],lx=(function(){var e={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},r=nf({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function t(c,h){var x=[],m=Ua(1);switch(h.type){case"base64":m=tn(sn(c));break;case"binary":m=tn(c);break;case"buffer":case"array":m=c;break}nr(m,0);var w=m.read_shift(1),p=!!(w&136),v=!1,y=!1;switch(w){case 2:break;case 3:break;case 48:v=!0,p=!0;break;case 49:v=!0,p=!0;break;case 131:break;case 139:break;case 140:y=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+w.toString(16))}var T=0,E=521;w==2&&(T=m.read_shift(2)),m.l+=3,w!=2&&(T=m.read_shift(4)),T>1048576&&(T=1e6),w!=2&&(E=m.read_shift(2));var _=m.read_shift(2);h.codepage,w!=2&&(m.l+=16,m.read_shift(1),m[m.l]!==0&&e[m[m.l]],m.l+=1,m.l+=2),y&&(m.l+=36);for(var C=[],S={},N=Math.min(m.length,w==2?521:E-10-(v?264:0)),B=y?32:11;m.l<N&&m[m.l]!=13;)switch(S={},S.name=ca(m.slice(m.l,m.l+B)).replace(/[\u0000\r\n][\S\s]*$/g,""),m.l+=B,S.type=String.fromCharCode(m.read_shift(1)),w!=2&&!y&&(S.offset=m.read_shift(4)),S.len=m.read_shift(1),w==2&&(S.offset=m.read_shift(2)),S.dec=m.read_shift(1),S.name.length&&C.push(S),w!=2&&(m.l+=y?13:14),S.type){case"B":(!v||S.len!=8)&&h.WTF&&console.log("Skipping "+S.name+":"+S.type);break;case"G":case"P":h.WTF&&console.log("Skipping "+S.name+":"+S.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+S.type)}if(m[m.l]!==13&&(m.l=E-1),m.read_shift(1)!==13)throw new Error("DBF Terminator not found "+m.l+" "+m[m.l]);m.l=E;var X=0,j=0;for(x[0]=[],j=0;j!=C.length;++j)x[0][j]=C[j].name;for(;T-- >0;){if(m[m.l]===42){m.l+=_;continue}for(++m.l,x[++X]=[],j=0,j=0;j!=C.length;++j){var z=m.slice(m.l,m.l+C[j].len);m.l+=C[j].len,nr(z,0);var M=ca(z);switch(C[j].type){case"C":M.trim().length&&(x[X][j]=M.replace(/([^\s])\s+$/,"$1"));break;case"D":M.length===8?(x[X][j]=new Date(Date.UTC(+M.slice(0,4),+M.slice(4,6)-1,+M.slice(6,8),0,0,0,0)),h&&h.UTC||(x[X][j]=xs(x[X][j]))):x[X][j]=M;break;case"F":x[X][j]=parseFloat(M.trim());break;case"+":case"I":x[X][j]=y?z.read_shift(-4,"i")^2147483648:z.read_shift(4,"i");break;case"L":switch(M.trim().toUpperCase()){case"Y":case"T":x[X][j]=!0;break;case"N":case"F":x[X][j]=!1;break;case"":case"\0":case"?":break;default:throw new Error("DBF Unrecognized L:|"+M+"|")}break;case"M":if(!p)throw new Error("DBF Unexpected MEMO for type "+w.toString(16));x[X][j]="##MEMO##"+(y?parseInt(M.trim(),10):z.read_shift(4));break;case"N":M=M.replace(/\u0000/g,"").trim(),M&&M!="."&&(x[X][j]=+M||0);break;case"@":x[X][j]=new Date(z.read_shift(-8,"f")-621356832e5);break;case"T":{var U=z.read_shift(4),D=z.read_shift(4);if(U==0&&D==0)break;x[X][j]=new Date((U-2440588)*864e5+D),h&&h.UTC||(x[X][j]=xs(x[X][j]))}break;case"Y":x[X][j]=z.read_shift(4,"i")/1e4+z.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":x[X][j]=-z.read_shift(-8,"f");break;case"B":if(v&&C[j].len==8){x[X][j]=z.read_shift(8,"f");break}case"G":case"P":z.l+=C[j].len;break;case"0":if(C[j].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+C[j].type)}}}if(w!=2&&m.l<m.length&&m[m.l++]!=26)throw new Error("DBF EOF Marker missing "+(m.l-1)+" of "+m.length+" "+m[m.l-1].toString(16));return h&&h.sheetRows&&(x=x.slice(0,h.sheetRows)),h.DBF=C,x}function a(c,h){var x=h||{};x.dateNF||(x.dateNF="yyyymmdd");var m=ri(t(c,x),x);return m["!cols"]=x.DBF.map(function(w){return{wch:w.len,DBF:w}}),delete x.DBF,m}function i(c,h){try{var x=$a(a(c,h),h);return x.bookType="dbf",x}catch(m){if(h&&h.WTF)throw m}return{SheetNames:[],Sheets:{}}}var o={B:8,C:250,L:1,D:8,"?":0,"":0};function u(c,h){if(!c["!ref"])throw new Error("Cannot export empty sheet to DBF");var x=h||{},m=kn;if(+x.codepage>=0&&On(+x.codepage),x.type=="string")throw new Error("Cannot write DBF to JS string");var w=Mu(),p=Wu(c,{header:1,raw:!0,cellDates:!0}),v=p[0],y=p.slice(1),T=c["!cols"]||[],E=0,_=0,C=0,S=1;for(E=0;E<v.length;++E){if(((T[E]||{}).DBF||{}).name){v[E]=T[E].DBF.name,++C;continue}if(v[E]!=null){if(++C,typeof v[E]=="number"&&(v[E]=v[E].toString(10)),typeof v[E]!="string")throw new Error("DBF Invalid column name "+v[E]+" |"+typeof v[E]+"|");if(v.indexOf(v[E])!==E){for(_=0;_<1024;++_)if(v.indexOf(v[E]+"_"+_)==-1){v[E]+="_"+_;break}}}}var N=Yt(c["!ref"]),B=[],X=[],j=[];for(E=0;E<=N.e.c-N.s.c;++E){var z="",M="",U=0,D=[];for(_=0;_<y.length;++_)y[_][E]!=null&&D.push(y[_][E]);if(D.length==0||v[E]==null){B[E]="?";continue}for(_=0;_<D.length;++_){switch(typeof D[_]){case"number":M="B";break;case"string":M="C";break;case"boolean":M="L";break;case"object":M=D[_]instanceof Date?"D":"C";break;default:M="C"}U=Math.max(U,String(D[_]).length),z=z&&z!=M?"C":M}U>250&&(U=250),M=((T[E]||{}).DBF||{}).type,M=="C"&&T[E].DBF.len>U&&(U=T[E].DBF.len),z=="B"&&M=="N"&&(z="N",j[E]=T[E].DBF.dec,U=T[E].DBF.len),X[E]=z=="C"||M=="N"?U:o[z]||0,S+=X[E],B[E]=z}var R=w.next(32);for(R.write_shift(4,318902576),R.write_shift(4,y.length),R.write_shift(2,296+32*C),R.write_shift(2,S),E=0;E<4;++E)R.write_shift(4,0);var K=+r[kn]||3;for(R.write_shift(4,0|K<<8),e[K]!=+x.codepage&&(x.codepage&&console.error("DBF Unsupported codepage "+kn+", using 1252"),kn=1252),E=0,_=0;E<v.length;++E)if(v[E]!=null){var ae=w.next(32),te=(v[E].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);ae.write_shift(1,te,"sbcs"),ae.write_shift(1,B[E]=="?"?"C":B[E],"sbcs"),ae.write_shift(4,_),ae.write_shift(1,X[E]||o[B[E]]||0),ae.write_shift(1,j[E]||0),ae.write_shift(1,2),ae.write_shift(4,0),ae.write_shift(1,0),ae.write_shift(4,0),ae.write_shift(4,0),_+=X[E]||o[B[E]]||0}var oe=w.next(264);for(oe.write_shift(4,13),E=0;E<65;++E)oe.write_shift(4,0);for(E=0;E<y.length;++E){var re=w.next(S);for(re.write_shift(1,0),_=0;_<v.length;++_)if(v[_]!=null)switch(B[_]){case"L":re.write_shift(1,y[E][_]==null?63:y[E][_]?84:70);break;case"B":re.write_shift(8,y[E][_]||0,"f");break;case"N":var Z="0";for(typeof y[E][_]=="number"&&(Z=y[E][_].toFixed(j[_]||0)),Z.length>X[_]&&(Z=Z.slice(0,X[_])),C=0;C<X[_]-Z.length;++C)re.write_shift(1,32);re.write_shift(1,Z,"sbcs");break;case"D":y[E][_]?(re.write_shift(4,("0000"+y[E][_].getFullYear()).slice(-4),"sbcs"),re.write_shift(2,("00"+(y[E][_].getMonth()+1)).slice(-2),"sbcs"),re.write_shift(2,("00"+y[E][_].getDate()).slice(-2),"sbcs")):re.write_shift(8,"00000000","sbcs");break;case"C":var ge=re.l,q=String(y[E][_]!=null?y[E][_]:"").slice(0,X[_]);for(re.write_shift(1,q,"cpstr"),ge+=X[_]-re.l,C=0;C<ge;++C)re.write_shift(1,32);break}}return kn=m,w.next(1).write_shift(1,26),w.end()}return{to_workbook:i,to_sheet:a,from_sheet:u}})(),rk=(function(){var e={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},r=new RegExp("\x1BN("+_n(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1").replace("{","\\{")+"|\\|)","gm");try{r=new RegExp("\x1BN("+_n(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm")}catch{}var t=function(v,y){var T=e[y];return typeof T=="number"?T1(T):T},a=function(v,y,T){var E=y.charCodeAt(0)-32<<4|T.charCodeAt(0)-48;return E==59?v:T1(E)};e["|"]=254;var i=function(v){return v.replace(/\n/g,"\x1B :").replace(/\r/g,"\x1B =")};function o(v,y){switch(y.type){case"base64":return u(sn(v),y);case"binary":return u(v,y);case"buffer":return u(vt&&Buffer.isBuffer(v)?v.toString("binary"):ca(v),y);case"array":return u(hs(v),y)}throw new Error("Unrecognized type "+y.type)}function u(v,y){var T=v.split(/[\n\r]+/),E=-1,_=-1,C=0,S=0,N=[],B=[],X=null,j={},z=[],M=[],U=[],D=0,R,K={Workbook:{WBProps:{},Names:[]}};for(+y.codepage>=0&&On(+y.codepage);C!==T.length;++C){D=0;var ae=T[C].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,a).replace(r,t),te=ae.replace(/;;/g,"\0").split(";").map(function(G){return G.replace(/\u0000/g,";")}),oe=te[0],re;if(ae.length>0)switch(oe){case"ID":break;case"E":break;case"B":break;case"O":for(S=1;S<te.length;++S)switch(te[S].charAt(0)){case"V":{var Z=parseInt(te[S].slice(1),10);Z>=1&&Z<=4&&(K.Workbook.WBProps.date1904=!0)}break}break;case"W":break;case"P":switch(te[1].charAt(0)){case"P":B.push(ae.slice(3).replace(/;;/g,";"));break}break;case"NN":{var ge={Sheet:0};for(S=1;S<te.length;++S)switch(te[S].charAt(0)){case"N":ge.Name=te[S].slice(1);break;case"E":ge.Ref=(y&&y.sheet||"Sheet1")+"!"+fs(te[S].slice(1));break}K.Workbook.Names.push(ge)}break;case"C":var q=!1,Q=!1,ie=!1,ve=!1,pe=-1,Ae=-1,je="",ze="z",P="";for(S=1;S<te.length;++S)switch(te[S].charAt(0)){case"A":P=te[S].slice(1);break;case"X":_=parseInt(te[S].slice(1),10)-1,Q=!0;break;case"Y":for(E=parseInt(te[S].slice(1),10)-1,Q||(_=0),R=N.length;R<=E;++R)N[R]=[];break;case"K":re=te[S].slice(1),re.charAt(0)==='"'?(re=re.slice(1,re.length-1),ze="s"):re==="TRUE"||re==="FALSE"?(re=re==="TRUE",ze="b"):re.charAt(0)=="#"&&vr[re]!=null?(ze="e",re=vr[re]):isNaN(an(re))||(re=an(re),ze="n",X!==null&&Mn(X)&&y.cellDates&&(re=Ma(K.Workbook.WBProps.date1904?re+1462:re),ze=typeof re=="number"?"n":"d")),q=!0;break;case"E":ve=!0,je=fs(te[S].slice(1),{r:E,c:_});break;case"S":ie=!0;break;case"G":break;case"R":pe=parseInt(te[S].slice(1),10)-1;break;case"C":Ae=parseInt(te[S].slice(1),10)-1;break;default:if(y&&y.WTF)throw new Error("SYLK bad record "+ae)}if(q&&(N[E][_]?(N[E][_].t=ze,N[E][_].v=re):N[E][_]={t:ze,v:re},X&&(N[E][_].z=X),y.cellText!==!1&&X&&(N[E][_].w=on(N[E][_].z,N[E][_].v,{date1904:K.Workbook.WBProps.date1904})),X=null),ie){if(ve)throw new Error("SYLK shared formula cannot have own formula");var ee=pe>-1&&N[pe][Ae];if(!ee||!ee[1])throw new Error("SYLK shared formula cannot find base");je=op(ee[1],{r:E-pe,c:_-Ae})}je&&(N[E][_]?N[E][_].f=je:N[E][_]={t:"n",f:je}),P&&(N[E][_]||(N[E][_]={t:"z"}),N[E][_].c=[{a:"SheetJSYLK",t:P}]);break;case"F":var J=0;for(S=1;S<te.length;++S)switch(te[S].charAt(0)){case"X":_=parseInt(te[S].slice(1),10)-1,++J;break;case"Y":for(E=parseInt(te[S].slice(1),10)-1,R=N.length;R<=E;++R)N[R]=[];break;case"M":D=parseInt(te[S].slice(1),10)/20;break;case"F":break;case"G":break;case"P":X=B[parseInt(te[S].slice(1),10)];break;case"S":break;case"D":break;case"N":break;case"W":for(U=te[S].slice(1).split(" "),R=parseInt(U[0],10);R<=parseInt(U[1],10);++R)D=parseInt(U[2],10),M[R-1]=D===0?{hidden:!0}:{wch:D};break;case"C":_=parseInt(te[S].slice(1),10)-1,M[_]||(M[_]={});break;case"R":E=parseInt(te[S].slice(1),10)-1,z[E]||(z[E]={}),D>0?(z[E].hpt=D,z[E].hpx=lo(D)):D===0&&(z[E].hidden=!0);break;default:if(y&&y.WTF)throw new Error("SYLK bad record "+ae)}J<1&&(X=null);break;default:if(y&&y.WTF)throw new Error("SYLK bad record "+ae)}}return z.length>0&&(j["!rows"]=z),M.length>0&&(j["!cols"]=M),M.forEach(function(G){Zs(G)}),y&&y.sheetRows&&(N=N.slice(0,y.sheetRows)),[N,j,K]}function c(v,y){var T=o(v,y),E=T[0],_=T[1],C=T[2],S=er(y);S.date1904=(((C||{}).Workbook||{}).WBProps||{}).date1904;var N=ri(E,S);_n(_).forEach(function(X){N[X]=_[X]});var B=$a(N,y);return _n(C).forEach(function(X){B[X]=C[X]}),B.bookType="sylk",B}function h(v,y,T,E,_,C){var S="C;Y"+(T+1)+";X"+(E+1)+";K";switch(v.t){case"n":S+=isFinite(v.v)?v.v||0:Kr[isNaN(v.v)?36:7],v.f&&!v.F&&(S+=";E"+j5(v.f,{r:T,c:E}));break;case"b":S+=v.v?"TRUE":"FALSE";break;case"e":S+=v.w||Kr[v.v]||v.v;break;case"d":S+=ar(yr(v.v,C),C);break;case"s":S+='"'+(v.v==null?"":String(v.v)).replace(/"/g,"").replace(/;/g,";;")+'"';break}return S}function x(v,y,T){var E="C;Y"+(y+1)+";X"+(T+1)+";A";return E+=i(v.map(function(_){return _.t}).join("")),E}function m(v,y){y.forEach(function(T,E){var _="F;W"+(E+1)+" "+(E+1)+" ";T.hidden?_+="0":(typeof T.width=="number"&&!T.wpx&&(T.wpx=Zl(T.width)),typeof T.wpx=="number"&&!T.wch&&(T.wch=Jl(T.wpx)),typeof T.wch=="number"&&(_+=Math.round(T.wch))),_.charAt(_.length-1)!=" "&&v.push(_)})}function w(v,y){y.forEach(function(T,E){var _="F;";T.hidden?_+="M0;":T.hpt?_+="M"+20*T.hpt+";":T.hpx&&(_+="M"+20*sp(T.hpx)+";"),_.length>2&&v.push(_+"R"+(E+1))})}function p(v,y,T){y||(y={}),y._formats=["General"];var E=["ID;PSheetJS;N;E"],_=[],C=Yt(v["!ref"]||"A1"),S,N=v["!data"]!=null,B=`\r
`,X=(((T||{}).Workbook||{}).WBProps||{}).date1904,j="General";E.push("P;PGeneral");var z=C.s.r,M=C.s.c,U=[];if(v["!ref"]){for(z=C.s.r;z<=C.e.r;++z)if(!(N&&!v["!data"][z])){for(U=[],M=C.s.c;M<=C.e.c;++M)S=N?v["!data"][z][M]:v[Ct(M)+It(z)],!(!S||!S.c)&&U.push(x(S.c,z,M));U.length&&_.push(U.join(B))}}if(v["!ref"]){for(z=C.s.r;z<=C.e.r;++z)if(!(N&&!v["!data"][z])){for(U=[],M=C.s.c;M<=C.e.c;++M)if(S=N?v["!data"][z][M]:v[Ct(M)+It(z)],!(!S||S.v==null&&(!S.f||S.F))){if((S.z||(S.t=="d"?ht[14]:"General"))!=j){var D=y._formats.indexOf(S.z);D==-1&&(y._formats.push(S.z),D=y._formats.length-1,E.push("P;P"+S.z.replace(/;/g,";;"))),U.push("F;P"+D+";Y"+(z+1)+";X"+(M+1))}U.push(h(S,v,z,M,y,X))}_.push(U.join(B))}}return E.push("F;P0;DG0G8;M255"),v["!cols"]&&m(E,v["!cols"]),v["!rows"]&&w(E,v["!rows"]),v["!ref"]&&E.push("B;Y"+(C.e.r-C.s.r+1)+";X"+(C.e.c-C.s.c+1)+";D"+[C.s.c,C.s.r,C.e.c,C.e.r].join(" ")),E.push("O;L;D;B"+(X?";V4":"")+";K47;G100 0.001"),delete y._formats,E.join(B)+B+_.join(B)+B+"E"+B}return{to_workbook:c,from_sheet:p}})(),nk=(function(){function e(c,h){switch(h.type){case"base64":return r(sn(c),h);case"binary":return r(c,h);case"buffer":return r(vt&&Buffer.isBuffer(c)?c.toString("binary"):ca(c),h);case"array":return r(hs(c),h)}throw new Error("Unrecognized type "+h.type)}function r(c,h){for(var x=c.split(`
`),m=-1,w=-1,p=0,v=[];p!==x.length;++p){if(x[p].trim()==="BOT"){v[++m]=[],w=0;continue}if(!(m<0)){var y=x[p].trim().split(","),T=y[0],E=y[1];++p;for(var _=x[p]||"";(_.match(/["]/g)||[]).length&1&&p<x.length-1;)_+=`
`+x[++p];switch(_=_.trim(),+T){case-1:if(_==="BOT"){v[++m]=[],w=0;continue}else if(_!=="EOD")throw new Error("Unrecognized DIF special command "+_);break;case 0:_==="TRUE"?v[m][w]=!0:_==="FALSE"?v[m][w]=!1:isNaN(an(E))?isNaN(so(E).getDate())?v[m][w]=E:(v[m][w]=yr(E),h&&h.UTC||(v[m][w]=xs(v[m][w]))):v[m][w]=an(E),++w;break;case 1:_=_.slice(1,_.length-1),_=_.replace(/""/g,'"'),_&&_.match(/^=".*"$/)&&(_=_.slice(2,-1)),v[m][w++]=_!==""?_:null;break}if(_==="EOD")break}}return h&&h.sheetRows&&(v=v.slice(0,h.sheetRows)),v}function t(c,h){return ri(e(c,h),h)}function a(c,h){var x=$a(t(c,h),h);return x.bookType="dif",x}function i(c,h){return"0,"+String(c)+`\r
`+h}function o(c){return`1,0\r
"`+c.replace(/"/g,'""')+'"'}function u(c){if(!c["!ref"])throw new Error("Cannot export empty sheet to DIF");for(var h=Yt(c["!ref"]),x=c["!data"]!=null,m=[`TABLE\r
0,1\r
"sheetjs"\r
`,`VECTORS\r
0,`+(h.e.r-h.s.r+1)+`\r
""\r
`,`TUPLES\r
0,`+(h.e.c-h.s.c+1)+`\r
""\r
`,`DATA\r
0,0\r
""\r
`],w=h.s.r;w<=h.e.r;++w){for(var p=x?c["!data"][w]:[],v=`-1,0\r
BOT\r
`,y=h.s.c;y<=h.e.c;++y){var T=x?p&&p[y]:c[Tt({r:w,c:y})];if(T==null){v+=`1,0\r
""\r
`;continue}switch(T.t){case"n":T.w!=null?v+="0,"+T.w+`\r
V`:T.v!=null?v+=i(T.v,"V"):T.f!=null&&!T.F?v+=o("="+T.f):v+=`1,0\r
""`;break;case"b":v+=T.v?i(1,"TRUE"):i(0,"FALSE");break;case"s":v+=o(isNaN(+T.v)?T.v:'="'+T.v+'"');break;case"d":T.w||(T.w=on(T.z||ht[14],ar(yr(T.v)))),v+=i(T.w,"V");break;default:v+=`1,0\r
""`}v+=`\r
`}m.push(v)}return m.join("")+`-1,0\r
EOD`}return{to_workbook:a,to_sheet:t,from_sheet:u}})(),ak=(function(){function e(w){return w.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function r(w){return w.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function t(w,p){for(var v=w.split(`
`),y=-1,T=-1,E=0,_=[];E!==v.length;++E){var C=v[E].trim().split(":");if(C[0]==="cell"){var S=Ir(C[1]);if(_.length<=S.r)for(y=_.length;y<=S.r;++y)_[y]||(_[y]=[]);switch(y=S.r,T=S.c,C[2]){case"t":_[y][T]=e(C[3]);break;case"v":_[y][T]=+C[3];break;case"vtf":var N=C[C.length-1];case"vtc":switch(C[3]){case"nl":_[y][T]=!!+C[4];break;default:_[y][T]=C[C.length-1].charAt(0)=="#"?{t:"e",v:vr[C[C.length-1]]}:+C[4];break}C[2]=="vtf"&&(_[y][T]=[_[y][T],N])}}}return p&&p.sheetRows&&(_=_.slice(0,p.sheetRows)),_}function a(w,p){return ri(t(w,p),p)}function i(w,p){return $a(a(w,p),p)}var o=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),u=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,c=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),h="--SocialCalcSpreadsheetControlSave--";function x(w){if(!w||!w["!ref"])return"";for(var p=[],v=[],y,T="",E=ps(w["!ref"]),_=w["!data"]!=null,C=E.s.r;C<=E.e.r;++C)for(var S=E.s.c;S<=E.e.c;++S)if(T=Tt({r:C,c:S}),y=_?(w["!data"][C]||[])[S]:w[T],!(!y||y.v==null||y.t==="z")){switch(v=["cell",T,"t"],y.t){case"s":v.push(r(y.v));break;case"b":v[2]="vt"+(y.f?"f":"c"),v[3]="nl",v[4]=y.v?"1":"0",v[5]=r(y.f||(y.v?"TRUE":"FALSE"));break;case"d":var N=ar(yr(y.v));v[2]="vtc",v[3]="nd",v[4]=""+N,v[5]=y.w||on(y.z||ht[14],N);break;case"n":isFinite(y.v)?y.f?(v[2]="vtf",v[3]="n",v[4]=y.v,v[5]=r(y.f)):(v[2]="v",v[3]=y.v):(v[2]="vt"+(y.f?"f":"c"),v[3]="e"+Kr[isNaN(y.v)?36:7],v[4]="0",v[5]=y.f||v[3].slice(1),v[6]="e",v[7]=v[3].slice(1));break;case"e":continue}p.push(v.join(":"))}return p.push("sheet:c:"+(E.e.c-E.s.c+1)+":r:"+(E.e.r-E.s.r+1)+":tvf:1"),p.push("valueformat:1:text-wiki"),p.join(`
`)}function m(w){return[o,u,c,u,x(w),h].join(`
`)}return{to_workbook:i,to_sheet:a,from_sheet:m}})(),io=(function(){function e(m,w,p,v,y){y.raw?w[p][v]=m:m===""||(m==="TRUE"?w[p][v]=!0:m==="FALSE"?w[p][v]=!1:isNaN(an(m))?isNaN(so(m).getDate())?m.charCodeAt(0)==35&&vr[m]!=null?w[p][v]={t:"e",v:vr[m],w:m}:w[p][v]=m:w[p][v]=yr(m):w[p][v]=an(m))}function r(m,w){var p=w||{},v=[];if(!m||m.length===0)return v;for(var y=m.split(/[\r\n]/),T=y.length-1;T>=0&&y[T].length===0;)--T;for(var E=10,_=0,C=0;C<=T;++C)_=y[C].indexOf(" "),_==-1?_=y[C].length:_++,E=Math.max(E,_);for(C=0;C<=T;++C){v[C]=[];var S=0;for(e(y[C].slice(0,E).trim(),v,C,S,p),S=1;S<=(y[C].length-E)/10+1;++S)e(y[C].slice(E+(S-1)*10,E+S*10).trim(),v,C,S,p)}return p.sheetRows&&(v=v.slice(0,p.sheetRows)),v}var t={44:",",9:"	",59:";",124:"|"},a={44:3,9:2,59:1,124:0};function i(m){for(var w={},p=!1,v=0,y=0;v<m.length;++v)(y=m.charCodeAt(v))==34?p=!p:!p&&y in t&&(w[y]=(w[y]||0)+1);y=[];for(v in w)Object.prototype.hasOwnProperty.call(w,v)&&y.push([w[v],v]);if(!y.length){w=a;for(v in w)Object.prototype.hasOwnProperty.call(w,v)&&y.push([w[v],v])}return y.sort(function(T,E){return T[0]-E[0]||a[T[1]]-a[E[1]]}),t[y.pop()[1]]||44}function o(m,w){var p=w||{},v="",y={};p.dense&&(y["!data"]=[]);var T={s:{c:0,r:0},e:{c:0,r:0}};m.slice(0,4)=="sep="?m.charCodeAt(5)==13&&m.charCodeAt(6)==10?(v=m.charAt(4),m=m.slice(7)):m.charCodeAt(5)==13||m.charCodeAt(5)==10?(v=m.charAt(4),m=m.slice(6)):v=i(m.slice(0,1024)):p&&p.FS?v=p.FS:v=i(m.slice(0,1024));var E=0,_=0,C=0,S=0,N=0,B=v.charCodeAt(0),X=!1,j=0,z=m.charCodeAt(0),M=p.dateNF!=null?Z2(p.dateNF):null;function U(){var D=m.slice(S,N);D.slice(-1)=="\r"&&(D=D.slice(0,-1));var R={};if(D.charAt(0)=='"'&&D.charAt(D.length-1)=='"'&&(D=D.slice(1,-1).replace(/""/g,'"')),p.cellText!==!1&&(R.w=D),D.length===0)R.t="z";else if(p.raw)R.t="s",R.v=D;else if(D.trim().length===0)R.t="s",R.v=D;else if(D.charCodeAt(0)==61)D.charCodeAt(1)==34&&D.charCodeAt(D.length-1)==34?(R.t="s",R.v=D.slice(2,-1).replace(/""/g,'"')):L5(D)?(R.t="s",R.f=D.slice(1),R.v=D):(R.t="s",R.v=D);else if(D=="TRUE")R.t="b",R.v=!0;else if(D=="FALSE")R.t="b",R.v=!1;else if(!isNaN(C=an(D)))R.t="n",R.v=C;else if(!isNaN((C=so(D)).getDate())||M&&D.match(M)){if(R.z=p.dateNF||ht[14],M&&D.match(M)){var K=J2(D,p.dateNF,D.match(M)||[]);C=yr(K),p&&p.UTC===!1&&(C=xs(C))}else p&&p.UTC===!1?C=xs(C):p.cellText!==!1&&p.dateNF&&(R.w=on(R.z,C));p.cellDates?(R.t="d",R.v=C):(R.t="n",R.v=ar(C)),p.cellNF||delete R.z}else D.charCodeAt(0)==35&&vr[D]!=null?(R.t="e",R.w=D,R.v=vr[D]):(R.t="s",R.v=D);if(R.t=="z"||(p.dense?(y["!data"][E]||(y["!data"][E]=[]),y["!data"][E][_]=R):y[Tt({c:_,r:E})]=R),S=N+1,z=m.charCodeAt(S),T.e.c<_&&(T.e.c=_),T.e.r<E&&(T.e.r=E),j==B)++_;else if(_=0,++E,p.sheetRows&&p.sheetRows<=E)return!0}e:for(;N<m.length;++N)switch(j=m.charCodeAt(N)){case 34:z===34&&(X=!X);break;case 13:if(X)break;m.charCodeAt(N+1)==10&&++N;case B:case 10:if(!X&&U())break e;break}return N-S>0&&U(),y["!ref"]=yt(T),y}function u(m,w){return!(w&&w.PRN)||w.FS||m.slice(0,4)=="sep="||m.indexOf("	")>=0||m.indexOf(",")>=0||m.indexOf(";")>=0?o(m,w):ri(r(m,w),w)}function c(m,w){var p="",v=w.type=="string"?[0,0,0,0]:yf(m,w);switch(w.type){case"base64":p=sn(m);break;case"binary":p=m;break;case"buffer":w.codepage==65001?p=m.toString("utf8"):(w.codepage,p=vt&&Buffer.isBuffer(m)?m.toString("binary"):ca(m));break;case"array":p=hs(m);break;case"string":p=m;break;default:throw new Error("Unrecognized type "+w.type)}return v[0]==239&&v[1]==187&&v[2]==191?p=Pt(p.slice(3)):w.type!="string"&&w.type!="buffer"&&w.codepage==65001?p=Pt(p):w.type=="binary",p.slice(0,19)=="socialcalc:version:"?ak.to_sheet(w.type=="string"?p:Pt(p),w):u(p,w)}function h(m,w){return $a(c(m,w),w)}function x(m){var w=[];if(!m["!ref"])return"";for(var p=Yt(m["!ref"]),v,y=m["!data"]!=null,T=p.s.r;T<=p.e.r;++T){for(var E=[],_=p.s.c;_<=p.e.c;++_){var C=Tt({r:T,c:_});if(v=y?(m["!data"][T]||[])[_]:m[C],!v||v.v==null){E.push("          ");continue}for(var S=(v.w||(za(v),v.w)||"").slice(0,10);S.length<10;)S+=" ";E.push(S+(_===0?" ":""))}w.push(E.join(""))}return w.join(`
`)}return{to_workbook:h,to_sheet:c,from_sheet:x}})();function sk(e,r){var t=r||{},a=!!t.WTF;t.WTF=!0;try{var i=rk.to_workbook(e,t);return t.WTF=a,i}catch(o){if(t.WTF=a,o.message.indexOf("SYLK bad record ID")==-1&&a)throw o;return io.to_workbook(e,r)}}var qi=(function(){function e(P,ee,J){if(P){nr(P,P.l||0);for(var G=J.Enum||ve;P.l<P.length;){var _e=P.read_shift(2),F=G[_e]||G[65535],ke=P.read_shift(2),Fe=P.l+ke,De=F.f&&F.f(P,ke,J);if(P.l=Fe,ee(De,F,_e))return}}}function r(P,ee){switch(ee.type){case"base64":return a(tn(sn(P)),ee);case"binary":return a(tn(P),ee);case"buffer":case"array":return a(P,ee)}throw"Unsupported type "+ee.type}var t=["mmmm","dd-mmm-yyyy","dd-mmm","mmm-yyyy","@","mm/dd","hh:mm:ss AM/PM","hh:mm AM/PM","mm/dd/yyyy","mm/dd","hh:mm:ss","hh:mm"];function a(P,ee){if(!P)return P;var J=ee||{},G={},_e="Sheet1",F="",ke=0,Fe={},De=[],Ge=[],Ve=[];J.dense&&(Ve=G["!data"]=[]);var tt={s:{r:0,c:0},e:{r:0,c:0}},ft=J.sheetRows||0,st={};if(P[4]==81&&P[5]==80&&P[6]==87)return ze(P,ee);if(P[2]==0&&(P[3]==8||P[3]==9)&&P.length>=16&&P[14]==5&&P[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(P[2]==2)J.Enum=ve,e(P,function(ce,Ee,Se){switch(Se){case 0:J.vers=ce,ce>=4096&&(J.qpro=!0);break;case 255:J.vers=ce,J.works=!0;break;case 6:tt=ce;break;case 204:ce&&(F=ce);break;case 222:F=ce;break;case 15:case 51:(!J.qpro&&!J.works||Se==51)&&ce[1].v.charCodeAt(0)<48&&(ce[1].v=ce[1].v.slice(1)),(J.works||J.works2)&&(ce[1].v=ce[1].v.replace(/\r\n/g,`
`));case 13:case 14:case 16:(ce[2]&112)==112&&(ce[2]&15)>1&&(ce[2]&15)<15&&(ce[1].z=J.dateNF||t[(ce[2]&15)-1]||ht[14],J.cellDates&&(ce[1].v=Ma(ce[1].v),ce[1].t=typeof ce[1].v=="number"?"n":"d")),J.qpro&&ce[3]>ke&&(G["!ref"]=yt(tt),Fe[_e]=G,De.push(_e),G={},J.dense&&(Ve=G["!data"]=[]),tt={s:{r:0,c:0},e:{r:0,c:0}},ke=ce[3],_e=F||"Sheet"+(ke+1),F="");var Re=J.dense?(Ve[ce[0].r]||[])[ce[0].c]:G[Tt(ce[0])];if(Re){Re.t=ce[1].t,Re.v=ce[1].v,ce[1].z!=null&&(Re.z=ce[1].z),ce[1].f!=null&&(Re.f=ce[1].f),st=Re;break}J.dense?(Ve[ce[0].r]||(Ve[ce[0].r]=[]),Ve[ce[0].r][ce[0].c]=ce[1]):G[Tt(ce[0])]=ce[1],st=ce[1];break;case 21509:J.works2=!0;break;case 21506:ce==5281&&(st.z="hh:mm:ss",J.cellDates&&st.t=="n"&&(st.v=Ma(st.v),st.t=typeof st.v=="number"?"n":"d"));break}},J);else if(P[2]==26||P[2]==14)J.Enum=pe,P[2]==14&&(J.qpro=!0,P.l=0),e(P,function(ce,Ee,Se){switch(Se){case 204:_e=ce;break;case 22:ce[1].v.charCodeAt(0)<48&&(ce[1].v=ce[1].v.slice(1)),ce[1].v=ce[1].v.replace(/\x0F./g,function(Re){return String.fromCharCode(Re.charCodeAt(1)-32)}).replace(/\r\n/g,`
`);case 23:case 24:case 25:case 37:case 39:case 40:if(ce[3]>ke&&(G["!ref"]=yt(tt),Fe[_e]=G,De.push(_e),G={},J.dense&&(Ve=G["!data"]=[]),tt={s:{r:0,c:0},e:{r:0,c:0}},ke=ce[3],_e="Sheet"+(ke+1)),ft>0&&ce[0].r>=ft)break;J.dense?(Ve[ce[0].r]||(Ve[ce[0].r]=[]),Ve[ce[0].r][ce[0].c]=ce[1]):G[Tt(ce[0])]=ce[1],tt.e.c<ce[0].c&&(tt.e.c=ce[0].c),tt.e.r<ce[0].r&&(tt.e.r=ce[0].r);break;case 27:ce[14e3]&&(Ge[ce[14e3][0]]=ce[14e3][1]);break;case 1537:Ge[ce[0]]=ce[1],ce[0]==ke&&(_e=ce[1]);break}},J);else throw new Error("Unrecognized LOTUS BOF "+P[2]);if(G["!ref"]=yt(tt),Fe[F||_e]=G,De.push(F||_e),!Ge.length)return{SheetNames:De,Sheets:Fe};for(var ye={},Ce=[],le=0;le<Ge.length;++le)Fe[De[le]]?(Ce.push(Ge[le]||De[le]),ye[Ge[le]]=Fe[Ge[le]]||Fe[De[le]]):(Ce.push(Ge[le]),ye[Ge[le]]={"!ref":"A1"});return{SheetNames:Ce,Sheets:ye}}function i(P,ee){var J=ee||{};if(+J.codepage>=0&&On(+J.codepage),J.type=="string")throw new Error("Cannot write WK1 to JS string");var G=Mu();if(!P["!ref"])throw new Error("Cannot export empty sheet to WK1");var _e=Yt(P["!ref"]),F=P["!data"]!=null,ke=[];en(G,0,u(1030)),en(G,6,x(_e));for(var Fe=Math.min(_e.e.r,8191),De=_e.s.c;De<=_e.e.c;++De)ke[De]=Ct(De);for(var Ge=_e.s.r;Ge<=Fe;++Ge){var Ve=It(Ge);for(De=_e.s.c;De<=_e.e.c;++De){var tt=F?(P["!data"][Ge]||[])[De]:P[ke[De]+Ve];if(!(!tt||tt.t=="z"))switch(tt.t){case"n":(tt.v|0)==tt.v&&tt.v>=-32768&&tt.v<=32767?en(G,13,E(Ge,De,tt)):en(G,14,C(Ge,De,tt));break;case"d":var ft=ar(tt.v);(ft|0)==ft&&ft>=-32768&&ft<=32767?en(G,13,E(Ge,De,{v:ft,z:tt.z||ht[14]})):en(G,14,C(Ge,De,{v:ft,z:tt.z||ht[14]}));break;default:var st=za(tt);en(G,15,v(Ge,De,st.slice(0,239)))}}}return en(G,1),G.end()}function o(P,ee){var J=ee||{};if(+J.codepage>=0&&On(+J.codepage),J.type=="string")throw new Error("Cannot write WK3 to JS string");var G=Mu();en(G,0,c(P));for(var _e=0,F=0;_e<P.SheetNames.length;++_e)(P.Sheets[P.SheetNames[_e]]||{})["!ref"]&&en(G,27,ie(P.SheetNames[_e],F++));var ke=0;for(_e=0;_e<P.SheetNames.length;++_e){var Fe=P.Sheets[P.SheetNames[_e]];if(!(!Fe||!Fe["!ref"])){for(var De=Yt(Fe["!ref"]),Ge=Fe["!data"]!=null,Ve=[],tt=Math.min(De.e.r,8191),ft=De.s.r;ft<=tt;++ft)for(var st=It(ft),ye=De.s.c;ye<=De.e.c;++ye){ft===De.s.r&&(Ve[ye]=Ct(ye));var Ce=Ve[ye]+st,le=Ge?(Fe["!data"][ft]||[])[ye]:Fe[Ce];if(!(!le||le.t=="z"))if(le.t=="n")en(G,23,K(ft,ye,ke,le.v));else{var ce=za(le);en(G,22,U(ft,ye,ke,ce.slice(0,239)))}}++ke}}return en(G,1),G.end()}function u(P){var ee=Jt(2);return ee.write_shift(2,P),ee}function c(P){var ee=Jt(26);ee.write_shift(2,4096),ee.write_shift(2,4),ee.write_shift(4,0);for(var J=0,G=0,_e=0,F=0;F<P.SheetNames.length;++F){var ke=P.SheetNames[F],Fe=P.Sheets[ke];if(!(!Fe||!Fe["!ref"])){++_e;var De=ps(Fe["!ref"]);J<De.e.r&&(J=De.e.r),G<De.e.c&&(G=De.e.c)}}return J>8191&&(J=8191),ee.write_shift(2,J),ee.write_shift(1,_e),ee.write_shift(1,G),ee.write_shift(2,0),ee.write_shift(2,0),ee.write_shift(1,1),ee.write_shift(1,2),ee.write_shift(4,0),ee.write_shift(4,0),ee}function h(P,ee,J){var G={s:{c:0,r:0},e:{c:0,r:0}};return ee==8&&J.qpro?(G.s.c=P.read_shift(1),P.l++,G.s.r=P.read_shift(2),G.e.c=P.read_shift(1),P.l++,G.e.r=P.read_shift(2),G):(G.s.c=P.read_shift(2),G.s.r=P.read_shift(2),ee==12&&J.qpro&&(P.l+=2),G.e.c=P.read_shift(2),G.e.r=P.read_shift(2),ee==12&&J.qpro&&(P.l+=2),G.s.c==65535&&(G.s.c=G.e.c=G.s.r=G.e.r=0),G)}function x(P){var ee=Jt(8);return ee.write_shift(2,P.s.c),ee.write_shift(2,P.s.r),ee.write_shift(2,P.e.c),ee.write_shift(2,P.e.r),ee}function m(P,ee,J){var G=[{c:0,r:0},{t:"n",v:0},0,0];return J.qpro&&J.vers!=20768?(G[0].c=P.read_shift(1),G[3]=P.read_shift(1),G[0].r=P.read_shift(2),P.l+=2):J.works?(G[0].c=P.read_shift(2),G[0].r=P.read_shift(2),G[2]=P.read_shift(2)):(G[2]=P.read_shift(1),G[0].c=P.read_shift(2),G[0].r=P.read_shift(2)),G}function w(P){return P.z&&Mn(P.z)?240|(t.indexOf(P.z)+1||2):255}function p(P,ee,J){var G=P.l+ee,_e=m(P,ee,J);if(_e[1].t="s",(J.vers&65534)==20768){P.l++;var F=P.read_shift(1);return _e[1].v=P.read_shift(F,"utf8"),_e}return J.qpro&&P.l++,_e[1].v=P.read_shift(G-P.l,"cstr"),_e}function v(P,ee,J){var G=Jt(7+J.length);G.write_shift(1,255),G.write_shift(2,ee),G.write_shift(2,P),G.write_shift(1,39);for(var _e=0;_e<G.length;++_e){var F=J.charCodeAt(_e);G.write_shift(1,F>=128?95:F)}return G.write_shift(1,0),G}function y(P,ee,J){var G=P.l+ee,_e=m(P,ee,J);if(_e[1].t="s",J.vers==20768){var F=P.read_shift(1);return _e[1].v=P.read_shift(F,"utf8"),_e}return _e[1].v=P.read_shift(G-P.l,"cstr"),_e}function T(P,ee,J){var G=m(P,ee,J);return G[1].v=P.read_shift(2,"i"),G}function E(P,ee,J){var G=Jt(7);return G.write_shift(1,w(J)),G.write_shift(2,ee),G.write_shift(2,P),G.write_shift(2,J.v,"i"),G}function _(P,ee,J){var G=m(P,ee,J);return G[1].v=P.read_shift(8,"f"),G}function C(P,ee,J){var G=Jt(13);return G.write_shift(1,w(J)),G.write_shift(2,ee),G.write_shift(2,P),G.write_shift(8,J.v,"f"),G}function S(P,ee,J){var G=P.l+ee,_e=m(P,ee,J);if(_e[1].v=P.read_shift(8,"f"),J.qpro)P.l=G;else{var F=P.read_shift(2);j(P.slice(P.l,P.l+F),_e),P.l+=F}return _e}function N(P,ee,J){var G=ee&32768;return ee&=-32769,ee=(G?P:0)+(ee>=8192?ee-16384:ee),(G?"":"$")+(J?Ct(ee):It(ee))}var B={31:["NA",0],33:["ABS",1],34:["TRUNC",1],35:["SQRT",1],36:["LOG",1],37:["LN",1],38:["PI",0],39:["SIN",1],40:["COS",1],41:["TAN",1],42:["ATAN2",2],43:["ATAN",1],44:["ASIN",1],45:["ACOS",1],46:["EXP",1],47:["MOD",2],49:["ISNA",1],50:["ISERR",1],51:["FALSE",0],52:["TRUE",0],53:["RAND",0],54:["DATE",3],63:["ROUND",2],64:["TIME",3],68:["ISNUMBER",1],69:["ISTEXT",1],70:["LEN",1],71:["VALUE",1],73:["MID",3],74:["CHAR",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],102:["UPPER",1],103:["LOWER",1],107:["PROPER",1],109:["TRIM",1],111:["T",1]},X=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function j(P,ee){nr(P,0);for(var J=[],G=0,_e="",F="",ke="",Fe="";P.l<P.length;){var De=P[P.l++];switch(De){case 0:J.push(P.read_shift(8,"f"));break;case 1:F=N(ee[0].c,P.read_shift(2),!0),_e=N(ee[0].r,P.read_shift(2),!1),J.push(F+_e);break;case 2:{var Ge=N(ee[0].c,P.read_shift(2),!0),Ve=N(ee[0].r,P.read_shift(2),!1);F=N(ee[0].c,P.read_shift(2),!0),_e=N(ee[0].r,P.read_shift(2),!1),J.push(Ge+Ve+":"+F+_e)}break;case 3:if(P.l<P.length){console.error("WK1 premature formula end");return}break;case 4:J.push("("+J.pop()+")");break;case 5:J.push(P.read_shift(2));break;case 6:{for(var tt="";De=P[P.l++];)tt+=String.fromCharCode(De);J.push('"'+tt.replace(/"/g,'""')+'"')}break;case 8:J.push("-"+J.pop());break;case 23:J.push("+"+J.pop());break;case 22:J.push("NOT("+J.pop()+")");break;case 20:case 21:Fe=J.pop(),ke=J.pop(),J.push(["AND","OR"][De-20]+"("+ke+","+Fe+")");break;default:if(De<32&&X[De])Fe=J.pop(),ke=J.pop(),J.push(ke+X[De]+Fe);else if(B[De]){if(G=B[De][1],G==69&&(G=P[P.l++]),G>J.length){console.error("WK1 bad formula parse 0x"+De.toString(16)+":|"+J.join("|")+"|");return}var ft=J.slice(-G);J.length-=G,J.push(B[De][0]+"("+ft.join(",")+")")}else return De<=7?console.error("WK1 invalid opcode "+De.toString(16)):De<=24?console.error("WK1 unsupported op "+De.toString(16)):De<=30?console.error("WK1 invalid opcode "+De.toString(16)):De<=115?console.error("WK1 unsupported function opcode "+De.toString(16)):console.error("WK1 unrecognized opcode "+De.toString(16))}}J.length==1?ee[1].f=""+J[0]:console.error("WK1 bad formula parse |"+J.join("|")+"|")}function z(P){var ee=[{c:0,r:0},{t:"n",v:0},0];return ee[0].r=P.read_shift(2),ee[3]=P[P.l++],ee[0].c=P[P.l++],ee}function M(P,ee){var J=z(P);return J[1].t="s",J[1].v=P.read_shift(ee-4,"cstr"),J}function U(P,ee,J,G){var _e=Jt(6+G.length);_e.write_shift(2,P),_e.write_shift(1,J),_e.write_shift(1,ee),_e.write_shift(1,39);for(var F=0;F<G.length;++F){var ke=G.charCodeAt(F);_e.write_shift(1,ke>=128?95:ke)}return _e.write_shift(1,0),_e}function D(P,ee){var J=z(P);J[1].v=P.read_shift(2);var G=J[1].v>>1;if(J[1].v&1)switch(G&7){case 0:G=(G>>3)*5e3;break;case 1:G=(G>>3)*500;break;case 2:G=(G>>3)/20;break;case 3:G=(G>>3)/200;break;case 4:G=(G>>3)/2e3;break;case 5:G=(G>>3)/2e4;break;case 6:G=(G>>3)/16;break;case 7:G=(G>>3)/64;break}return J[1].v=G,J}function R(P,ee){var J=z(P),G=P.read_shift(4),_e=P.read_shift(4),F=P.read_shift(2);if(F==65535)return G===0&&_e===3221225472?(J[1].t="e",J[1].v=15):G===0&&_e===3489660928?(J[1].t="e",J[1].v=42):J[1].v=0,J;var ke=F&32768;return F=(F&32767)-16446,J[1].v=(1-ke*2)*(_e*Math.pow(2,F+32)+G*Math.pow(2,F)),J}function K(P,ee,J,G){var _e=Jt(14);if(_e.write_shift(2,P),_e.write_shift(1,J),_e.write_shift(1,ee),G==0)return _e.write_shift(4,0),_e.write_shift(4,0),_e.write_shift(2,65535),_e;var F=0,ke=0,Fe=0,De=0;return G<0&&(F=1,G=-G),ke=Math.log2(G)|0,G/=Math.pow(2,ke-31),De=G>>>0,(De&2147483648)==0&&(G/=2,++ke,De=G>>>0),G-=De,De|=2147483648,De>>>=0,G*=Math.pow(2,32),Fe=G>>>0,_e.write_shift(4,Fe),_e.write_shift(4,De),ke+=16383+(F?32768:0),_e.write_shift(2,ke),_e}function ae(P,ee){var J=R(P);return P.l+=ee-14,J}function te(P,ee){var J=z(P),G=P.read_shift(4);return J[1].v=G>>6,J}function oe(P,ee){var J=z(P),G=P.read_shift(8,"f");return J[1].v=G,J}function re(P,ee){var J=oe(P);return P.l+=ee-12,J}function Z(P,ee){return P[P.l+ee-1]==0?P.read_shift(ee,"cstr"):""}function ge(P,ee){var J=P[P.l++];J>ee-1&&(J=ee-1);for(var G="";G.length<J;)G+=String.fromCharCode(P[P.l++]);return G}function q(P,ee,J){if(!(!J.qpro||ee<21)){var G=P.read_shift(1);P.l+=17,P.l+=1,P.l+=2;var _e=P.read_shift(ee-21,"cstr");return[G,_e]}}function Q(P,ee){for(var J={},G=P.l+ee;P.l<G;){var _e=P.read_shift(2);if(_e==14e3){for(J[_e]=[0,""],J[_e][0]=P.read_shift(2);P[P.l];)J[_e][1]+=String.fromCharCode(P[P.l]),P.l++;P.l++}}return J}function ie(P,ee){var J=Jt(5+P.length);J.write_shift(2,14e3),J.write_shift(2,ee);for(var G=0;G<P.length;++G){var _e=P.charCodeAt(G);J[J.l++]=_e>127?95:_e}return J[J.l++]=0,J}var ve={0:{n:"BOF",f:Vt},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:h},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:T},14:{n:"NUMBER",f:_},15:{n:"LABEL",f:p},16:{n:"FORMULA",f:S},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:y},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:Z},222:{n:"SHEETNAMELP",f:ge},255:{n:"BOF",f:Vt},21506:{n:"WKSNF",f:Vt},65535:{n:""}},pe={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:M},23:{n:"NUMBER17",f:R},24:{n:"NUMBER18",f:D},25:{n:"FORMULA19",f:ae},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:Q},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:te},38:{n:"??"},39:{n:"NUMBER27",f:oe},40:{n:"FORMULA28",f:re},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:Z},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:q},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}},Ae={5:"dd-mmm-yy",6:"dd-mmm",7:"mmm-yy",8:"mm/dd/yy",10:"hh:mm:ss AM/PM",11:"hh:mm AM/PM",14:"dd-mmm-yyyy",15:"mmm-yyyy",34:"0.00",50:"0.00;[Red]0.00",66:"0.00;(0.00)",82:"0.00;[Red](0.00)",162:'"$"#,##0.00;\\("$"#,##0.00\\)',288:"0%",304:"0E+00",320:"# ?/?"};function je(P){var ee=P.read_shift(2),J=P.read_shift(1);if(J!=0)throw"unsupported QPW string type "+J.toString(16);return P.read_shift(ee,"sbcs-cont")}function ze(P,ee){nr(P,0);var J=ee||{},G={};J.dense&&(G["!data"]=[]);var _e=[],F="",ke={s:{r:-1,c:-1},e:{r:-1,c:-1}},Fe=0,De=0,Ge=0,Ve=0,tt={SheetNames:[],Sheets:{}},ft=[];e:for(;P.l<P.length;){var st=P.read_shift(2),ye=P.read_shift(2),Ce=P.slice(P.l,P.l+ye);switch(nr(Ce,0),st){case 1:if(Ce.read_shift(4)!=962023505)throw"Bad QPW9 BOF!";break;case 2:break e;case 8:break;case 10:for(var le=Ce.read_shift(4),ce=(Ce.length-Ce.l)/le|0,Ee=0;Ee<le;++Ee){var Se=Ce.l+ce,Re={};Ce.l+=2,Re.numFmtId=Ce.read_shift(2),Ae[Re.numFmtId]&&(Re.z=Ae[Re.numFmtId]),Ce.l=Se,ft.push(Re)}break;case 1025:break;case 1026:break;case 1031:for(Ce.l+=12;Ce.l<Ce.length;)Fe=Ce.read_shift(2),De=Ce.read_shift(1),_e.push(Ce.read_shift(Fe,"cstr"));break;case 1032:break;case 1537:{var at=Ce.read_shift(2);G={},J.dense&&(G["!data"]=[]),ke.s.c=Ce.read_shift(2),ke.e.c=Ce.read_shift(2),ke.s.r=Ce.read_shift(4),ke.e.r=Ce.read_shift(4),Ce.l+=4,Ce.l+2<Ce.length&&(Fe=Ce.read_shift(2),De=Ce.read_shift(1),F=Fe==0?"":Ce.read_shift(Fe,"cstr")),F||(F=Ct(at))}break;case 1538:{if(ke.s.c>255||ke.s.r>999999)break;ke.e.c<ke.s.c&&(ke.e.c=ke.s.c),ke.e.r<ke.s.r&&(ke.e.r=ke.s.r),G["!ref"]=yt(ke),yo(tt,G,F)}break;case 2561:Ge=Ce.read_shift(2),ke.e.c<Ge&&(ke.e.c=Ge),ke.s.c>Ge&&(ke.s.c=Ge),Ve=Ce.read_shift(4),ke.s.r>Ve&&(ke.s.r=Ve),Ve=Ce.read_shift(4),ke.e.r<Ve&&(ke.e.r=Ve);break;case 3073:{Ve=Ce.read_shift(4),Fe=Ce.read_shift(4),ke.s.r>Ve&&(ke.s.r=Ve),ke.e.r<Ve+Fe-1&&(ke.e.r=Ve+Fe-1);for(var it=Ct(Ge);Ce.l<Ce.length;){var Ne={t:"z"},Ke=Ce.read_shift(1),mt=-1;Ke&128&&(mt=Ce.read_shift(2));var Nt=Ke&64?Ce.read_shift(2)-1:0;switch(Ke&31){case 0:break;case 1:break;case 2:Ne={t:"n",v:Ce.read_shift(2)};break;case 3:Ne={t:"n",v:Ce.read_shift(2,"i")};break;case 4:Ne={t:"n",v:cc(Ce)};break;case 5:Ne={t:"n",v:Ce.read_shift(8,"f")};break;case 7:Ne={t:"s",v:_e[De=Ce.read_shift(4)-1]};break;case 8:Ne={t:"n",v:Ce.read_shift(8,"f")},Ce.l+=2,Ce.l+=4,isNaN(Ne.v)&&(Ne={t:"e",v:15});break;default:throw"Unrecognized QPW cell type "+(Ke&31)}mt!=-1&&(ft[mt-1]||{}).z&&(Ne.z=ft[mt-1].z);var Er=0;if(Ke&32)switch(Ke&31){case 2:Er=Ce.read_shift(2);break;case 3:Er=Ce.read_shift(2,"i");break;case 7:Er=Ce.read_shift(2);break;default:throw"Unsupported delta for QPW cell type "+(Ke&31)}if(!(!J.sheetStubs&&Ne.t=="z")){var _r=er(Ne);Ne.t=="n"&&Ne.z&&Mn(Ne.z)&&J.cellDates&&(_r.v=Ma(Ne.v),_r.t=typeof _r.v=="number"?"n":"d"),G["!data"]!=null?(G["!data"][Ve]||(G["!data"][Ve]=[]),G["!data"][Ve][Ge]=_r):G[it+It(Ve)]=_r}for(++Ve,--Fe;Nt-- >0&&Fe>=0;){if(Ke&32)switch(Ke&31){case 2:Ne={t:"n",v:Ne.v+Er&65535};break;case 3:Ne={t:"n",v:Ne.v+Er&65535},Ne.v>32767&&(Ne.v-=65536);break;case 7:Ne={t:"s",v:_e[De=De+Er>>>0]};break;default:throw"Cannot apply delta for QPW cell type "+(Ke&31)}else switch(Ke&31){case 1:Ne={t:"z"};break;case 2:Ne={t:"n",v:Ce.read_shift(2)};break;case 7:Ne={t:"s",v:_e[De=Ce.read_shift(4)-1]};break;default:throw"Cannot apply repeat for QPW cell type "+(Ke&31)}!J.sheetStubs&&Ne.t=="z"||(G["!data"]!=null?(G["!data"][Ve]||(G["!data"][Ve]=[]),G["!data"][Ve][Ge]=Ne):G[it+It(Ve)]=Ne),++Ve,--Fe}}}break;case 3074:{Ge=Ce.read_shift(2),Ve=Ce.read_shift(4);var ln=je(Ce);G["!data"]!=null?(G["!data"][Ve]||(G["!data"][Ve]=[]),G["!data"][Ve][Ge]={t:"s",v:ln}):G[Ct(Ge)+It(Ve)]={t:"s",v:ln}}break}P.l+=ye}return tt}return{sheet_to_wk1:i,book_to_wk3:o,to_workbook:r}})();function ik(e){var r={},t=e.match(kr),a=0,i=!1;if(t)for(;a!=t.length;++a){var o=Ze(t[a]);switch(o[0].replace(/<\w*:/g,"<")){case"<condense":break;case"<extend":break;case"<shadow":if(!o.val)break;case"<shadow>":case"<shadow/>":r.shadow=1;break;case"</shadow>":break;case"<charset":if(o.val=="1")break;r.cp=Zu[parseInt(o.val,10)];break;case"<outline":if(!o.val)break;case"<outline>":case"<outline/>":r.outline=1;break;case"</outline>":break;case"<rFont":r.name=o.val;break;case"<sz":r.sz=o.val;break;case"<strike":if(!o.val)break;case"<strike>":case"<strike/>":r.strike=1;break;case"</strike>":break;case"<u":if(!o.val)break;switch(o.val){case"double":r.uval="double";break;case"singleAccounting":r.uval="single-accounting";break;case"doubleAccounting":r.uval="double-accounting";break}case"<u>":case"<u/>":r.u=1;break;case"</u>":break;case"<b":if(o.val=="0")break;case"<b>":case"<b/>":r.b=1;break;case"</b>":break;case"<i":if(o.val=="0")break;case"<i>":case"<i/>":r.i=1;break;case"</i>":break;case"<color":o.rgb&&(r.color=o.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":r.family=o.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":r.valign=o.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(o[0].charCodeAt(1)!==47&&!i)throw new Error("Unrecognized rich format "+o[0])}}return r}var ok=(function(){function e(a){var i=dr(a,"t");if(!i)return{t:"s",v:""};var o={t:"s",v:wt(i[1])},u=dr(a,"rPr");return u&&(o.s=ik(u[1])),o}var r=/<(?:\w+:)?r>/g,t=/<\/(?:\w+:)?r>/;return function(i){return i.replace(r,"").split(t).map(e).filter(function(o){return o.v})}})(),lk=(function(){var r=/(\r\n|\n)/g;function t(i,o,u){var c=[];i.u&&c.push("text-decoration: underline;"),i.uval&&c.push("text-underline-style:"+i.uval+";"),i.sz&&c.push("font-size:"+i.sz+"pt;"),i.outline&&c.push("text-effect: outline;"),i.shadow&&c.push("text-shadow: auto;"),o.push('<span style="'+c.join("")+'">'),i.b&&(o.push("<b>"),u.push("</b>")),i.i&&(o.push("<i>"),u.push("</i>")),i.strike&&(o.push("<s>"),u.push("</s>"));var h=i.valign||"";return h=="superscript"||h=="super"?h="sup":h=="subscript"&&(h="sub"),h!=""&&(o.push("<"+h+">"),u.push("</"+h+">")),u.push("</span>"),i}function a(i){var o=[[],i.v,[]];return i.v?(i.s&&t(i.s,o[0],o[2]),o[0].join("")+o[1].replace(r,"<br/>")+o[2].join("")):""}return function(o){return o.map(a).join("")}})(),ck=/<(?:\w+:)?t\b[^<>]*>([^<]*)<\/(?:\w+:)?t>/g,uk=/<(?:\w+:)?r\b[^<>]*>/;function xf(e,r){var t=r?r.cellHTML:!0,a={};return e?(e.match(/^\s*<(?:\w+:)?t[^>]*>/)?(a.t=wt(Pt(e.slice(e.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||""),!0),a.r=Pt(e),t&&(a.h=$i(a.t))):e.match(uk)&&(a.r=Pt(e),a.t=wt(Pt((gw(e,"rPh").match(ck)||[]).join("").replace(kr,"")),!0),t&&(a.h=lk(ok(a.r)))),a):{t:""}}var fk=/<(?:\w+:)?(?:si|sstItem)>/g,dk=/<\/(?:\w+:)?(?:si|sstItem)>/;function hk(e,r){var t=[],a="";if(!e)return t;var i=dr(e,"sst");if(i){a=i[1].replace(fk,"").split(dk);for(var o=0;o!=a.length;++o){var u=xf(a[o].trim(),r);u!=null&&(t[t.length]=u)}i=Ze(i[0].slice(0,i[0].indexOf(">"))),t.Count=i.count,t.Unique=i.uniqueCount}return t}function xk(e){return[e.read_shift(4),e.read_shift(4)]}function mk(e,r){var t=[],a=!1;return ua(e,function(o,u,c){switch(c){case 159:t.Count=o[0],t.Unique=o[1];break;case 19:t.push(o);break;case 160:return!0;case 35:a=!0;break;case 36:a=!1;break;default:if(u.T,!a||r.WTF)throw new Error("Unexpected record 0x"+c.toString(16))}}),t}function Jm(e){for(var r=[],t=e.split(""),a=0;a<t.length;++a)r[a]=t[a].charCodeAt(0);return r}function la(e,r){var t={};return t.Major=e.read_shift(2),t.Minor=e.read_shift(2),r>=4&&(e.l+=r-4),t}function pk(e){var r={};return r.id=e.read_shift(0,"lpp4"),r.R=la(e,4),r.U=la(e,4),r.W=la(e,4),r}function gk(e){for(var r=e.read_shift(4),t=e.l+r-4,a={},i=e.read_shift(4),o=[];i-- >0;)o.push({t:e.read_shift(4),v:e.read_shift(0,"lpp4")});if(a.name=e.read_shift(0,"lpp4"),a.comps=o,e.l!=t)throw new Error("Bad DataSpaceMapEntry: "+e.l+" != "+t);return a}function vk(e){var r=[];e.l+=4;for(var t=e.read_shift(4);t-- >0;)r.push(gk(e));return r}function wk(e){var r=[];e.l+=4;for(var t=e.read_shift(4);t-- >0;)r.push(e.read_shift(0,"lpp4"));return r}function yk(e){var r={};return e.read_shift(4),e.l+=4,r.id=e.read_shift(0,"lpp4"),r.name=e.read_shift(0,"lpp4"),r.R=la(e,4),r.U=la(e,4),r.W=la(e,4),r}function kk(e){var r=yk(e);if(r.ename=e.read_shift(0,"8lpp4"),r.blksz=e.read_shift(4),r.cmode=e.read_shift(4),e.read_shift(4)!=4)throw new Error("Bad !Primary record");return r}function ep(e,r){var t=e.l+r,a={};a.Flags=e.read_shift(4)&63,e.l+=4,a.AlgID=e.read_shift(4);var i=!1;switch(a.AlgID){case 26126:case 26127:case 26128:i=a.Flags==36;break;case 26625:i=a.Flags==4;break;case 0:i=a.Flags==16||a.Flags==4||a.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+a.AlgID}if(!i)throw new Error("Encryption Flags/AlgID mismatch");return a.AlgIDHash=e.read_shift(4),a.KeySize=e.read_shift(4),a.ProviderType=e.read_shift(4),e.l+=8,a.CSPName=e.read_shift(t-e.l>>1,"utf16le"),e.l=t,a}function tp(e,r){var t={},a=e.l+r;return e.l+=4,t.Salt=e.slice(e.l,e.l+16),e.l+=16,t.Verifier=e.slice(e.l,e.l+16),e.l+=16,e.read_shift(4),t.VerifierHash=e.slice(e.l,a),e.l=a,t}function Ek(e){var r=la(e);switch(r.Minor){case 2:return[r.Minor,_k(e)];case 3:return[r.Minor,Tk()];case 4:return[r.Minor,Sk(e)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+r.Minor)}function _k(e){var r=e.read_shift(4);if((r&63)!=36)throw new Error("EncryptionInfo mismatch");var t=e.read_shift(4),a=ep(e,t),i=tp(e,e.length-e.l);return{t:"Std",h:a,v:i}}function Tk(){throw new Error("File is password-protected: ECMA-376 Extensible")}function Sk(e){var r=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];e.l+=4;var t=e.read_shift(e.length-e.l,"utf8"),a={};return t.replace(kr,function(o){var u=Ze(o);switch(Sn(u[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":r.forEach(function(c){a[c]=u[c]});break;case"<dataIntegrity":a.encryptedHmacKey=u.encryptedHmacKey,a.encryptedHmacValue=u.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":a.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":a.uri=u.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":a.encs.push(u);break;default:throw u[0]}}),a}function Ck(e,r){var t={},a=t.EncryptionVersionInfo=la(e,4);if(r-=4,a.Minor!=2)throw new Error("unrecognized minor version code: "+a.Minor);if(a.Major>4||a.Major<2)throw new Error("unrecognized major version code: "+a.Major);t.Flags=e.read_shift(4),r-=4;var i=e.read_shift(4);return r-=4,t.EncryptionHeader=ep(e,i),r-=i,t.EncryptionVerifier=tp(e,r),t}function bk(e){var r={},t=r.EncryptionVersionInfo=la(e,4);if(t.Major!=1||t.Minor!=1)throw"unrecognized version code "+t.Major+" : "+t.Minor;return r.Salt=e.read_shift(16),r.EncryptedVerifier=e.read_shift(16),r.EncryptedVerifierHash=e.read_shift(16),r}function Nk(e){var r=0,t,a=Jm(e),i=a.length+1,o,u,c,h,x;for(t=Ua(i),t[0]=a.length,o=1;o!=i;++o)t[o]=a[o-1];for(o=i-1;o>=0;--o)u=t[o],c=(r&16384)===0?0:1,h=r<<1&32767,x=c|h,r=x^u;return r^52811}var rp=(function(){var e=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],r=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],t=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],a=function(u){return(u/2|u*128)&255},i=function(u,c){return a(u^c)},o=function(u){for(var c=r[u.length-1],h=104,x=u.length-1;x>=0;--x)for(var m=u[x],w=0;w!=7;++w)m&64&&(c^=t[h]),m*=2,--h;return c};return function(u){for(var c=Jm(u),h=o(c),x=c.length,m=Ua(16),w=0;w!=16;++w)m[w]=0;var p,v,y;for((x&1)===1&&(p=h>>8,m[x]=i(e[0],p),--x,p=h&255,v=c[c.length-1],m[x]=i(v,p));x>0;)--x,p=h>>8,m[x]=i(c[x],p),--x,p=h&255,m[x]=i(c[x],p);for(x=15,y=15-c.length;y>0;)p=h>>8,m[x]=i(e[y],p),--x,--y,p=h&255,m[x]=i(c[x],p),--x,--y;return m}})(),Ak=function(e,r,t,a,i){i||(i=r),a||(a=rp(e));var o,u;for(o=0;o!=r.length;++o)u=r[o],u^=a[t],u=(u>>5|u<<3)&255,i[o]=u,++t;return[i,t,a]},Fk=function(e){var r=0,t=rp(e);return function(a){var i=Ak("",a,r,t);return r=i[1],i[0]}};function Ik(e,r,t,a){var i={key:Vt(e),verificationBytes:Vt(e)};return t.password&&(i.verifier=Nk(t.password)),a.valid=i.verificationBytes===i.verifier,a.valid&&(a.insitu=Fk(t.password)),i}function Dk(e,r,t){var a=t||{};return a.Info=e.read_shift(2),e.l-=2,a.Info===1?a.Data=bk(e):a.Data=Ck(e,r),a}function Rk(e,r,t){var a={Type:t.biff>=8?e.read_shift(2):0};return a.Type?Dk(e,r-2,a):Ik(e,t.biff>=8?r:r-2,t,a),a}function Pk(e,r){switch(r.type){case"base64":return Ol(sn(e),r);case"binary":return Ol(e,r);case"buffer":return Ol(vt&&Buffer.isBuffer(e)?e.toString("binary"):ca(e),r);case"array":return Ol(hs(e),r)}throw new Error("Unrecognized type "+r.type)}function Ol(e,r){var t=r||{},a={},i=t.dense;i&&(a["!data"]=[]);var o=sf(e,"\\trowd","\\row");if(!o)throw new Error("RTF missing table");var u={s:{c:0,r:0},e:{c:0,r:o.length-1}},c=[];return o.forEach(function(h,x){i&&(c=a["!data"][x]=[]);for(var m=/\\[\w\-]+\b/g,w=0,p,v=-1,y=[];(p=m.exec(h))!=null;){var T=h.slice(w,m.lastIndex-p[0].length);switch(T.charCodeAt(0)==32&&(T=T.slice(1)),T.length&&y.push(T),p[0]){case"\\cell":if(++v,y.length){var E={v:y.join(""),t:"s"};E.v=="TRUE"||E.v=="FALSE"?(E.v=E.v=="TRUE",E.t="b"):isNaN(an(E.v))?vr[E.v]!=null&&(E.t="e",E.w=E.v,E.v=vr[E.v]):(E.t="n",t.cellText!==!1&&(E.w=E.v),E.v=an(E.v)),i?c[v]=E:a[Tt({r:x,c:v})]=E}y=[];break;case"\\par":y.push(`
`);break}w=m.lastIndex}v>u.e.c&&(u.e.c=v)}),a["!ref"]=yt(u),a}function Ok(e,r){var t=$a(Pk(e,r),r);return t.bookType="rtf",t}function jk(e){var r=e.slice(e[0]==="#"?1:0).slice(0,6);return[parseInt(r.slice(0,2),16),parseInt(r.slice(2,4),16),parseInt(r.slice(4,6),16)]}function oo(e){for(var r=0,t=1;r!=3;++r)t=t*256+(e[r]>255?255:e[r]<0?0:e[r]);return t.toString(16).toUpperCase().slice(1)}function Lk(e){var r=e[0]/255,t=e[1]/255,a=e[2]/255,i=Math.max(r,t,a),o=Math.min(r,t,a),u=i-o;if(u===0)return[0,0,r];var c=0,h=0,x=i+o;switch(h=u/(x>1?2-x:x),i){case r:c=((t-a)/u+6)%6;break;case t:c=(a-r)/u+2;break;case a:c=(r-t)/u+4;break}return[c/6,h,x/2]}function Mk(e){var r=e[0],t=e[1],a=e[2],i=t*2*(a<.5?a:1-a),o=a-i/2,u=[o,o,o],c=6*r,h;if(t!==0)switch(c|0){case 0:case 6:h=i*c,u[0]+=i,u[1]+=h;break;case 1:h=i*(2-c),u[0]+=h,u[1]+=i;break;case 2:h=i*(c-2),u[1]+=i,u[2]+=h;break;case 3:h=i*(4-c),u[1]+=h,u[2]+=i;break;case 4:h=i*(c-4),u[2]+=i,u[0]+=h;break;case 5:h=i*(6-c),u[2]+=h,u[0]+=i;break}for(var x=0;x!=3;++x)u[x]=Math.round(u[x]*255);return u}function ql(e,r){if(r===0)return e;var t=Lk(jk(e));return r<0?t[2]=t[2]*(1+r):t[2]=1-(1-t[2])*(1-r),oo(Mk(t))}var np=6,Bk=15,Uk=1,Lr=np;function Zl(e){return Math.floor((e+Math.round(128/Lr)/256)*Lr)}function Jl(e){return Math.floor((e-5)/Lr*100+.5)/100}function zu(e){return Math.round((e*Lr+5)/Lr*256)/256}function fu(e){return zu(Jl(Zl(e)))}function mf(e){var r=Math.abs(e-fu(e)),t=Lr;if(r>.005)for(Lr=Uk;Lr<Bk;++Lr)Math.abs(e-fu(e))<=r&&(r=Math.abs(e-fu(e)),t=Lr);Lr=t}function Zs(e){e.width?(e.wpx=Zl(e.width),e.wch=Jl(e.wpx),e.MDW=Lr):e.wpx?(e.wch=Jl(e.wpx),e.width=zu(e.wch),e.MDW=Lr):typeof e.wch=="number"&&(e.width=zu(e.wch),e.wpx=Zl(e.width),e.MDW=Lr),e.customWidth&&delete e.customWidth}var zk=96,ap=zk;function sp(e){return e*96/ap}function lo(e){return e*ap/96}var Hk={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function Vk(e,r,t,a){r.Borders=[];var i={},o=!1;(e.match(kr)||[]).forEach(function(u){var c=Ze(u);switch(Sn(c[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":i={},c.diagonalUp&&(i.diagonalUp=Ft(c.diagonalUp)),c.diagonalDown&&(i.diagonalDown=Ft(c.diagonalDown)),r.Borders.push(i);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":o=!0;break;case"</ext>":o=!1;break;default:if(a&&a.WTF&&!o)throw new Error("unrecognized "+c[0]+" in borders")}})}function Wk(e,r,t,a){r.Fills=[];var i={},o=!1;(e.match(kr)||[]).forEach(function(u){var c=Ze(u);switch(Sn(c[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":i={},r.Fills.push(i);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":r.Fills.push(i),i={};break;case"<patternFill":case"<patternFill>":c.patternType&&(i.patternType=c.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":i.bgColor||(i.bgColor={}),c.indexed&&(i.bgColor.indexed=parseInt(c.indexed,10)),c.theme&&(i.bgColor.theme=parseInt(c.theme,10)),c.tint&&(i.bgColor.tint=parseFloat(c.tint)),c.rgb&&(i.bgColor.rgb=c.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":i.fgColor||(i.fgColor={}),c.theme&&(i.fgColor.theme=parseInt(c.theme,10)),c.tint&&(i.fgColor.tint=parseFloat(c.tint)),c.rgb!=null&&(i.fgColor.rgb=c.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":o=!0;break;case"</ext>":o=!1;break;default:if(a&&a.WTF&&!o)throw new Error("unrecognized "+c[0]+" in fills")}})}function $k(e,r,t,a){r.Fonts=[];var i={},o=!1;(e.match(kr)||[]).forEach(function(u){var c=Ze(u);switch(Sn(c[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":r.Fonts.push(i),i={};break;case"<name":c.val&&(i.name=Pt(c.val));break;case"<name/>":case"</name>":break;case"<b":i.bold=c.val?Ft(c.val):1;break;case"<b/>":i.bold=1;break;case"</b>":case"</b":break;case"<i":i.italic=c.val?Ft(c.val):1;break;case"<i/>":i.italic=1;break;case"</i>":case"</i":break;case"<u":switch(c.val){case"none":i.underline=0;break;case"single":i.underline=1;break;case"double":i.underline=2;break;case"singleAccounting":i.underline=33;break;case"doubleAccounting":i.underline=34;break}break;case"<u/>":i.underline=1;break;case"</u>":case"</u":break;case"<strike":i.strike=c.val?Ft(c.val):1;break;case"<strike/>":i.strike=1;break;case"</strike>":case"</strike":break;case"<outline":i.outline=c.val?Ft(c.val):1;break;case"<outline/>":i.outline=1;break;case"</outline>":case"</outline":break;case"<shadow":i.shadow=c.val?Ft(c.val):1;break;case"<shadow/>":i.shadow=1;break;case"</shadow>":case"</shadow":break;case"<condense":i.condense=c.val?Ft(c.val):1;break;case"<condense/>":i.condense=1;break;case"</condense>":case"</condense":break;case"<extend":i.extend=c.val?Ft(c.val):1;break;case"<extend/>":i.extend=1;break;case"</extend>":case"</extend":break;case"<sz":c.val&&(i.sz=+c.val);break;case"<sz/>":case"</sz>":case"</sz":break;case"<vertAlign":c.val&&(i.vertAlign=c.val);break;case"<vertAlign/>":case"</vertAlign>":case"</vertAlign":break;case"<family":c.val&&(i.family=parseInt(c.val,10));break;case"<family/>":case"</family>":case"</family":break;case"<scheme":c.val&&(i.scheme=c.val);break;case"<scheme/>":case"</scheme>":case"</scheme":break;case"<charset":if(c.val=="1")break;c.codepage=Zu[parseInt(c.val,10)];break;case"<charset/>":case"</charset>":case"</charset":break;case"<color":if(i.color||(i.color={}),c.auto&&(i.color.auto=Ft(c.auto)),c.rgb)i.color.rgb=c.rgb.slice(-6);else if(c.indexed){i.color.index=parseInt(c.indexed,10);var h=us[i.color.index];i.color.index==81&&(h=us[1]),h||(h=us[1]),i.color.rgb=h[0].toString(16)+h[1].toString(16)+h[2].toString(16)}else c.theme&&(i.color.theme=parseInt(c.theme,10),c.tint&&(i.color.tint=parseFloat(c.tint)),c.theme&&t.themeElements&&t.themeElements.clrScheme&&(i.color.rgb=ql(t.themeElements.clrScheme[i.color.theme].rgb,i.color.tint||0)));break;case"<color/>":case"</color>":case"</color":break;case"<AlternateContent":o=!0;break;case"</AlternateContent>":case"</AlternateContent":o=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":o=!0;break;case"</ext>":o=!1;break;default:if(a&&a.WTF&&!o)throw new Error("unrecognized "+c[0]+" in fonts")}})}function Xk(e,r,t){r.NumberFmt=[];for(var a=_n(ht),i=0;i<a.length;++i)r.NumberFmt[a[i]]=ht[a[i]];var o=e.match(kr);if(o)for(i=0;i<o.length;++i){var u=Ze(o[i]);switch(Sn(u[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var c=wt(Pt(u.formatCode)),h=parseInt(u.numFmtId,10);if(r.NumberFmt[h]=c,h>0){if(h>392){for(h=392;h>60&&r.NumberFmt[h]!=null;--h);r.NumberFmt[h]=c}ls(c,h)}}break;case"</numFmt>":break;default:if(t.WTF)throw new Error("unrecognized "+u[0]+" in numFmts")}}}var jl=["numFmtId","fillId","fontId","borderId","xfId"],Ll=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function Gk(e,r,t){r.CellXf=[];var a,i=!1;(e.match(kr)||[]).forEach(function(o){var u=Ze(o),c=0;switch(Sn(u[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":case"<xf>":for(a=u,delete a[0],c=0;c<jl.length;++c)a[jl[c]]&&(a[jl[c]]=parseInt(a[jl[c]],10));for(c=0;c<Ll.length;++c)a[Ll[c]]&&(a[Ll[c]]=Ft(a[Ll[c]]));if(r.NumberFmt&&a.numFmtId>392){for(c=392;c>60;--c)if(r.NumberFmt[a.numFmtId]==r.NumberFmt[c]){a.numFmtId=c;break}}r.CellXf.push(a);break;case"</xf>":break;case"<alignment":case"<alignment/>":case"<alignment>":var h={};u.vertical&&(h.vertical=u.vertical),u.horizontal&&(h.horizontal=u.horizontal),u.textRotation!=null&&(h.textRotation=u.textRotation),u.indent&&(h.indent=u.indent),u.wrapText&&(h.wrapText=Ft(u.wrapText)),a.alignment=h;break;case"</alignment>":break;case"<protection":case"<protection>":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":case"<AlternateContent>":i=!0;break;case"</AlternateContent>":i=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(t&&t.WTF&&!i)throw new Error("unrecognized "+u[0]+" in cellXfs")}})}var Yk=(function(){return function(t,a,i){var o={};if(!t)return o;t=af(xo(t,"<!--","-->"));var u;return(u=dr(t,"numFmts"))&&Xk(u[0],o,i),(u=dr(t,"fonts"))&&$k(u[0],o,a,i),(u=dr(t,"fills"))&&Wk(u[0],o,a,i),(u=dr(t,"borders"))&&Vk(u[0],o,a,i),(u=dr(t,"cellXfs"))&&Gk(u[0],o,i),o}})();function Kk(e,r){var t=e.read_shift(2),a=Dr(e);return[t,a]}function Qk(e,r,t){var a={};a.sz=e.read_shift(2)/20;var i=ny(e);i.fItalic&&(a.italic=1),i.fCondense&&(a.condense=1),i.fExtend&&(a.extend=1),i.fShadow&&(a.shadow=1),i.fOutline&&(a.outline=1),i.fStrikeout&&(a.strike=1);var o=e.read_shift(2);switch(o===700&&(a.bold=1),e.read_shift(2)){case 1:a.vertAlign="superscript";break;case 2:a.vertAlign="subscript";break}var u=e.read_shift(1);u!=0&&(a.underline=u);var c=e.read_shift(1);c>0&&(a.family=c);var h=e.read_shift(1);switch(h>0&&(a.charset=h),e.l++,a.color=ry(e),e.read_shift(1)){case 1:a.scheme="major";break;case 2:a.scheme="minor";break}return a.name=Dr(e),a}var qk=Rr;function Zk(e,r){var t=e.l+r,a=e.read_shift(2),i=e.read_shift(2);return e.l=t,{ixfe:a,numFmtId:i}}var Jk=Rr;function e5(e,r,t){var a={};a.NumberFmt=[];for(var i in ht)a.NumberFmt[i]=ht[i];a.CellXf=[],a.Fonts=[];var o=[],u=!1;return ua(e,function(h,x,m){switch(m){case 44:a.NumberFmt[h[0]]=h[1],ls(h[1],h[0]);break;case 43:a.Fonts.push(h),h.color.theme!=null&&r&&r.themeElements&&r.themeElements.clrScheme&&(h.color.rgb=ql(r.themeElements.clrScheme[h.color.theme].rgb,h.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:o[o.length-1]==617&&a.CellXf.push(h);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:u=!0;break;case 36:u=!1;break;case 37:o.push(m),u=!0;break;case 38:o.pop(),u=!1;break;default:if(x.T>0)o.push(m);else if(x.T<0)o.pop();else if(!u||t.WTF&&o[o.length-1]!=37)throw new Error("Unexpected record 0x"+m.toString(16))}}),a}var t5=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function r5(e,r,t){r.themeElements.clrScheme=[];var a={};(e[0].match(kr)||[]).forEach(function(i){var o=Ze(i);switch(o[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":a.rgb=o.val;break;case"</a:srgbClr>":break;case"<a:sysClr":a.rgb=o.lastClr;break;case"</a:sysClr>":break;case"</a:dk1>":case"</a:lt1>":case"<a:dk1>":case"<a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":o[0].charAt(1)==="/"?(r.themeElements.clrScheme[t5.indexOf(o[0])]=a,a={}):a.name=o[0].slice(3,o[0].length-1);break;default:if(t&&t.WTF)throw new Error("Unrecognized "+o[0]+" in clrScheme")}})}function n5(e,r,t){r.themeElements={};var a;if(!(a=cs(e,"a:clrScheme")))throw new Error("clrScheme not found in themeElements");if(r5(a,r,t),!(a=cs(e,"a:fontScheme")))throw new Error("fontScheme not found in themeElements");if(!(a=cs(e,"a:fmtScheme")))throw new Error("fmtScheme not found in themeElements")}function ip(e,r){(!e||e.length===0)&&(e=a5());var t,a={};if(!(t=cs(e,"a:themeElements")))throw new Error("themeElements not found in theme");return n5(t[0],a,r),a.raw=e,a}function a5(e,r){var t=[gm];return t[t.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',t[t.length]="<a:themeElements>",t[t.length]='<a:clrScheme name="Office">',t[t.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',t[t.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',t[t.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',t[t.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',t[t.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',t[t.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',t[t.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',t[t.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',t[t.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',t[t.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',t[t.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',t[t.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',t[t.length]="</a:clrScheme>",t[t.length]='<a:fontScheme name="Office">',t[t.length]="<a:majorFont>",t[t.length]='<a:latin typeface="Cambria"/>',t[t.length]='<a:ea typeface=""/>',t[t.length]='<a:cs typeface=""/>',t[t.length]='<a:font script="Jpan" typeface=" "/>',t[t.length]='<a:font script="Hang" typeface=" "/>',t[t.length]='<a:font script="Hans" typeface=""/>',t[t.length]='<a:font script="Hant" typeface=""/>',t[t.length]='<a:font script="Arab" typeface="Times New Roman"/>',t[t.length]='<a:font script="Hebr" typeface="Times New Roman"/>',t[t.length]='<a:font script="Thai" typeface="Tahoma"/>',t[t.length]='<a:font script="Ethi" typeface="Nyala"/>',t[t.length]='<a:font script="Beng" typeface="Vrinda"/>',t[t.length]='<a:font script="Gujr" typeface="Shruti"/>',t[t.length]='<a:font script="Khmr" typeface="MoolBoran"/>',t[t.length]='<a:font script="Knda" typeface="Tunga"/>',t[t.length]='<a:font script="Guru" typeface="Raavi"/>',t[t.length]='<a:font script="Cans" typeface="Euphemia"/>',t[t.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',t[t.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',t[t.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',t[t.length]='<a:font script="Thaa" typeface="MV Boli"/>',t[t.length]='<a:font script="Deva" typeface="Mangal"/>',t[t.length]='<a:font script="Telu" typeface="Gautami"/>',t[t.length]='<a:font script="Taml" typeface="Latha"/>',t[t.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',t[t.length]='<a:font script="Orya" typeface="Kalinga"/>',t[t.length]='<a:font script="Mlym" typeface="Kartika"/>',t[t.length]='<a:font script="Laoo" typeface="DokChampa"/>',t[t.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',t[t.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',t[t.length]='<a:font script="Viet" typeface="Times New Roman"/>',t[t.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',t[t.length]='<a:font script="Geor" typeface="Sylfaen"/>',t[t.length]="</a:majorFont>",t[t.length]="<a:minorFont>",t[t.length]='<a:latin typeface="Calibri"/>',t[t.length]='<a:ea typeface=""/>',t[t.length]='<a:cs typeface=""/>',t[t.length]='<a:font script="Jpan" typeface=" "/>',t[t.length]='<a:font script="Hang" typeface=" "/>',t[t.length]='<a:font script="Hans" typeface=""/>',t[t.length]='<a:font script="Hant" typeface=""/>',t[t.length]='<a:font script="Arab" typeface="Arial"/>',t[t.length]='<a:font script="Hebr" typeface="Arial"/>',t[t.length]='<a:font script="Thai" typeface="Tahoma"/>',t[t.length]='<a:font script="Ethi" typeface="Nyala"/>',t[t.length]='<a:font script="Beng" typeface="Vrinda"/>',t[t.length]='<a:font script="Gujr" typeface="Shruti"/>',t[t.length]='<a:font script="Khmr" typeface="DaunPenh"/>',t[t.length]='<a:font script="Knda" typeface="Tunga"/>',t[t.length]='<a:font script="Guru" typeface="Raavi"/>',t[t.length]='<a:font script="Cans" typeface="Euphemia"/>',t[t.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',t[t.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',t[t.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',t[t.length]='<a:font script="Thaa" typeface="MV Boli"/>',t[t.length]='<a:font script="Deva" typeface="Mangal"/>',t[t.length]='<a:font script="Telu" typeface="Gautami"/>',t[t.length]='<a:font script="Taml" typeface="Latha"/>',t[t.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',t[t.length]='<a:font script="Orya" typeface="Kalinga"/>',t[t.length]='<a:font script="Mlym" typeface="Kartika"/>',t[t.length]='<a:font script="Laoo" typeface="DokChampa"/>',t[t.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',t[t.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',t[t.length]='<a:font script="Viet" typeface="Arial"/>',t[t.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',t[t.length]='<a:font script="Geor" typeface="Sylfaen"/>',t[t.length]="</a:minorFont>",t[t.length]="</a:fontScheme>",t[t.length]='<a:fmtScheme name="Office">',t[t.length]="<a:fillStyleLst>",t[t.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:lin ang="16200000" scaled="1"/>',t[t.length]="</a:gradFill>",t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:lin ang="16200000" scaled="0"/>',t[t.length]="</a:gradFill>",t[t.length]="</a:fillStyleLst>",t[t.length]="<a:lnStyleLst>",t[t.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',t[t.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',t[t.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',t[t.length]="</a:lnStyleLst>",t[t.length]="<a:effectStyleLst>",t[t.length]="<a:effectStyle>",t[t.length]="<a:effectLst>",t[t.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',t[t.length]="</a:effectLst>",t[t.length]="</a:effectStyle>",t[t.length]="<a:effectStyle>",t[t.length]="<a:effectLst>",t[t.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',t[t.length]="</a:effectLst>",t[t.length]="</a:effectStyle>",t[t.length]="<a:effectStyle>",t[t.length]="<a:effectLst>",t[t.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',t[t.length]="</a:effectLst>",t[t.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',t[t.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',t[t.length]="</a:effectStyle>",t[t.length]="</a:effectStyleLst>",t[t.length]="<a:bgFillStyleLst>",t[t.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',t[t.length]="</a:gradFill>",t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',t[t.length]="</a:gradFill>",t[t.length]="</a:bgFillStyleLst>",t[t.length]="</a:fmtScheme>",t[t.length]="</a:themeElements>",t[t.length]="<a:objectDefaults>",t[t.length]="<a:spDef>",t[t.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',t[t.length]="</a:spDef>",t[t.length]="<a:lnDef>",t[t.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',t[t.length]="</a:lnDef>",t[t.length]="</a:objectDefaults>",t[t.length]="<a:extraClrSchemeLst/>",t[t.length]="</a:theme>",t.join("")}function s5(e,r,t){var a=e.l+r,i=e.read_shift(4);if(i!==124226){if(!t.cellStyles){e.l=a;return}var o=e.slice(e.l);e.l=a;var u;try{u=pm(o,{type:"array"})}catch{return}var c=Mr(u,"theme/theme/theme1.xml",!0);if(c)return ip(c,t)}}function i5(e){return e.read_shift(4)}function o5(e){var r={};switch(r.xclrType=e.read_shift(2),r.nTintShade=e.read_shift(2),r.xclrType){case 0:e.l+=4;break;case 1:r.xclrValue=l5(e,4);break;case 2:r.xclrValue=Xm(e);break;case 3:r.xclrValue=i5(e);break;case 4:e.l+=4;break}return e.l+=8,r}function l5(e,r){return Rr(e,r)}function c5(e,r){return Rr(e,r)}function u5(e){var r=e.read_shift(2),t=e.read_shift(2)-4,a=[r];switch(r){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:a[1]=o5(e);break;case 6:a[1]=c5(e,t);break;case 14:case 15:a[1]=e.read_shift(t===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+r+" "+t)}return a}function f5(e,r){var t=e.l+r;e.l+=2;var a=e.read_shift(2);e.l+=2;for(var i=e.read_shift(2),o=[];i-- >0;)o.push(u5(e,t-e.l));return{ixfe:a,ext:o}}function d5(e,r){r.forEach(function(t){t[0]})}function h5(e,r){return{flags:e.read_shift(4),version:e.read_shift(4),name:Dr(e)}}function x5(e){for(var r=[],t=e.read_shift(4);t-- >0;)r.push([e.read_shift(4),e.read_shift(4)]);return r}function m5(e){return e.l+=4,e.read_shift(4)!=0}function p5(e,r,t){var a={Types:[],Cell:[],Value:[]},i=t||{},o=[],u=!1,c=2;return ua(e,function(h,x,m){switch(m){case 335:a.Types.push({name:h.name});break;case 51:h.forEach(function(w){c==1?a.Cell.push({type:a.Types[w[0]-1].name,index:w[1]}):c==0&&a.Value.push({type:a.Types[w[0]-1].name,index:w[1]})});break;case 337:c=h?1:0;break;case 338:c=2;break;case 35:o.push(m),u=!0;break;case 36:o.pop(),u=!1;break;default:if(!x.T){if(!u||i.WTF&&o[o.length-1]!=35)throw new Error("Unexpected record 0x"+m.toString(16))}}}),a}function g5(e,r,t){var a={Types:[],Cell:[],Value:[]};if(!e)return a;var i=!1,o=2,u;return e.replace(kr,function(c){var h=Ze(c);switch(Sn(h[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":a.Types.push({name:h.name});break;case"</metadataType>":break;case"<futureMetadata":for(var x=0;x<a.Types.length;++x)a.Types[x].name==h.name&&(u=a.Types[x]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":o==1?a.Cell.push({type:a.Types[h.t-1].name,index:+h.v}):o==0&&a.Value.push({type:a.Types[h.t-1].name,index:+h.v});break;case"</rc>":break;case"<cellMetadata":o=1;break;case"</cellMetadata>":o=2;break;case"<valueMetadata":o=0;break;case"</valueMetadata>":o=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;case"<rvb":if(!u)break;u.offsets||(u.offsets=[]),u.offsets.push(+h.i);break;default:if(!i&&(t!=null&&t.WTF))throw new Error("unrecognized "+h[0]+" in metadata")}return c}),a}function v5(e){var r=[];if(!e)return r;var t=1;return(e.match(kr)||[]).forEach(function(a){var i=Ze(a);switch(i[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete i[0],i.i?t=i.i:i.i=t,r.push(i);break}}),r}function w5(e){var r={};r.i=e.read_shift(4);var t={};t.r=e.read_shift(4),t.c=e.read_shift(4),r.r=Tt(t);var a=e.read_shift(1);return a&2&&(r.l="1"),a&8&&(r.a="1"),r}function y5(e,r,t){var a=[];return ua(e,function(o,u,c){switch(c){case 63:a.push(o);break;default:if(!u.T)throw new Error("Unexpected record 0x"+c.toString(16))}}),a}function k5(e,r,t,a){if(!e)return e;var i=a||{},o=!1;ua(e,function(c,h,x){switch(x){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:o=!0;break;case 36:o=!1;break;default:if(!h.T){if(!o||i.WTF)throw new Error("Unexpected record 0x"+x.toString(16))}}},i)}function E5(e,r){if(!e)return"??";var t=(e.match(/<c:chart [^<>]*r:id="([^<>"]*)"/)||["",""])[1];return r["!id"][t].Target}function _5(e,r,t){var a=0;(hm(e,"shape")||[]).forEach(function(i){var o="",u=!0,c=-1,h=-1,x=-1;switch(i.replace(kr,function(w,p){var v=Ze(w);switch(Sn(v[0])){case"<ClientData":v.ObjectType&&(o=v.ObjectType);break;case"<Visible":case"<Visible/>":u=!1;break;case"<Row":case"<Row>":c=p+w.length;break;case"</Row>":h=+i.slice(c,p).trim();break;case"<Column":case"<Column>":c=p+w.length;break;case"</Column>":x=+i.slice(c,p).trim();break}return""}),o){case"Note":var m=uo(r,h>=0&&x>=0?Tt({r:h,c:x}):t[a].ref);m.c&&(m.c.hidden=u),++a;break}})}function cx(e,r,t,a){var i=e["!data"]!=null,o;r.forEach(function(u){var c=Ir(u.ref);if(!(c.r<0||c.c<0)){if(i?(e["!data"][c.r]||(e["!data"][c.r]=[]),o=e["!data"][c.r][c.c]):o=e[u.ref],!o){o={t:"z"},i?e["!data"][c.r][c.c]=o:e[u.ref]=o;var h=Yt(e["!ref"]||"BDWGO1000001:A1");h.s.r>c.r&&(h.s.r=c.r),h.e.r<c.r&&(h.e.r=c.r),h.s.c>c.c&&(h.s.c=c.c),h.e.c<c.c&&(h.e.c=c.c);var x=yt(h);e["!ref"]=x}o.c||(o.c=[]);var m={a:u.author,t:u.t,r:u.r,T:t};u.h&&(m.h=u.h);for(var w=o.c.length-1;w>=0;--w){if(!t&&o.c[w].T)return;t&&!o.c[w].T&&o.c.splice(w,1)}if(t&&a){for(w=0;w<a.length;++w)if(m.a==a[w].id){m.a=a[w].name||m.a;break}}o.c.push(m)}})}function T5(e,r){if(e.match(/<(?:\w+:)?comments *\/>/))return[];var t=[],a=[],i=dr(e,"authors");i&&i[1]&&i[1].split(/<\/\w*:?author>/).forEach(function(u){if(!(u===""||u.trim()==="")){var c=u.match(/<(?:\w+:)?author[^<>]*>(.*)/);c&&t.push(c[1])}});var o=dr(e,"commentList");return o&&o[1]&&o[1].split(/<\/\w*:?comment>/).forEach(function(u){if(!(u===""||u.trim()==="")){var c=u.match(/<(?:\w+:)?comment[^<>]*>/);if(c){var h=Ze(c[0]),x={author:h.authorId&&t[h.authorId]||"sheetjsghost",ref:h.ref,guid:h.guid},m=Ir(h.ref);if(!(r.sheetRows&&r.sheetRows<=m.r)){var w=dr(u,"text"),p=!!w&&!!w[1]&&xf(w[1])||{r:"",t:"",h:""};x.r=p.r,p.r=="<t></t>"&&(p.t=p.h=""),x.t=(p.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),r.cellHTML&&(x.h=p.h),a.push(x)}}}}),a}function S5(e,r){var t=[],a=!1,i={},o=0;return e.replace(kr,function(c,h){var x=Ze(c);switch(Sn(x[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":i={author:x.personId,guid:x.id,ref:x.ref,T:1};break;case"</threadedComment>":i.t!=null&&t.push(i);break;case"<text>":case"<text":o=h+c.length;break;case"</text>":i.t=e.slice(o,h).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":a=!0;break;case"</mentions>":a=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(!a&&r.WTF)throw new Error("unrecognized "+x[0]+" in threaded comments")}return c}),t}function C5(e,r){var t=[],a=!1;return e.replace(kr,function(o){var u=Ze(o);switch(Sn(u[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":t.push({name:u.displayname,id:u.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(!a&&r.WTF)throw new Error("unrecognized "+u[0]+" in threaded comments")}return o}),t}function b5(e){var r={};r.iauthor=e.read_shift(4);var t=vs(e);return r.rfx=t.s,r.ref=Tt(t.s),e.l+=16,r}var N5=Dr;function A5(e,r){var t=[],a=[],i={},o=!1;return ua(e,function(c,h,x){switch(x){case 632:a.push(c);break;case 635:i=c;break;case 637:i.t=c.t,i.h=c.h,i.r=c.r;break;case 636:if(i.author=a[i.iauthor],delete i.iauthor,r.sheetRows&&i.rfx&&r.sheetRows<=i.rfx.r)break;i.t||(i.t=""),delete i.rfx,t.push(i);break;case 3072:break;case 35:o=!0;break;case 36:o=!1;break;case 37:break;case 38:break;default:if(!h.T){if(!o||r.WTF)throw new Error("Unexpected record 0x"+x.toString(16))}}}),t}var F5="application/vnd.ms-office.vbaProject";function I5(e){var r=Et.utils.cfb_new({root:"R"});return e.FullPaths.forEach(function(t,a){if(!(t.slice(-1)==="/"||!t.match(/_VBA_PROJECT_CUR/))){var i=t.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");Et.utils.cfb_add(r,i,e.FileIndex[a].content)}}),Et.write(r)}function D5(){return{"!type":"dialog"}}function R5(){return{"!type":"dialog"}}function P5(){return{"!type":"macro"}}function O5(){return{"!type":"macro"}}var fs=(function(){var e=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,r={r:0,c:0};function t(a,i,o,u){var c=!1,h=!1;o.length==0?h=!0:o.charAt(0)=="["&&(h=!0,o=o.slice(1,-1)),u.length==0?c=!0:u.charAt(0)=="["&&(c=!0,u=u.slice(1,-1));var x=o.length>0?parseInt(o,10)|0:0,m=u.length>0?parseInt(u,10)|0:0;return c?m+=r.c:--m,h?x+=r.r:--x,i+(c?"":"$")+Ct(m)+(h?"":"$")+It(x)}return function(i,o){return r=o,i.replace(e,t)}})(),pf=/(^|[^._A-Z0-9])(\$?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])(\$?)(\d{1,7})(?![_.\(A-Za-z0-9])/g;try{pf=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g}catch{}var j5=(function(){return function(r,t){return r.replace(pf,function(a,i,o,u,c,h){var x=uf(u)-(o?0:t.c),m=cf(h)-(c?0:t.r),w=c=="$"?m+1:m==0?"":"["+m+"]",p=o=="$"?x+1:x==0?"":"["+x+"]";return i+"R"+w+"C"+p})}})();function op(e,r){return e.replace(pf,function(t,a,i,o,u,c){return a+(i=="$"?i+o:Ct(uf(o)+r.c))+(u=="$"?u+c:It(cf(c)+r.r))})}function ux(e,r,t){var a=ps(r),i=a.s,o=Ir(t),u={r:o.r-i.r,c:o.c-i.c};return op(e,u)}function L5(e){return e.length!=1}function fx(e){return e.replace(/_xlfn\./g,"")}function Qt(e){e.l+=1}function Ha(e,r){var t=e.read_shift(2);return[t&16383,t>>14&1,t>>15&1]}function lp(e,r,t){var a=2;if(t){if(t.biff>=2&&t.biff<=5)return cp(e);t.biff==12&&(a=4)}var i=e.read_shift(a),o=e.read_shift(a),u=Ha(e),c=Ha(e);return{s:{r:i,c:u[0],cRel:u[1],rRel:u[2]},e:{r:o,c:c[0],cRel:c[1],rRel:c[2]}}}function cp(e){var r=Ha(e),t=Ha(e),a=e.read_shift(1),i=e.read_shift(1);return{s:{r:r[0],c:a,cRel:r[1],rRel:r[2]},e:{r:t[0],c:i,cRel:t[1],rRel:t[2]}}}function M5(e,r,t){if(t.biff<8)return cp(e);var a=e.read_shift(t.biff==12?4:2),i=e.read_shift(t.biff==12?4:2),o=Ha(e),u=Ha(e);return{s:{r:a,c:o[0],cRel:o[1],rRel:o[2]},e:{r:i,c:u[0],cRel:u[1],rRel:u[2]}}}function up(e,r,t){if(t&&t.biff>=2&&t.biff<=5)return B5(e);var a=e.read_shift(t&&t.biff==12?4:2),i=Ha(e);return{r:a,c:i[0],cRel:i[1],rRel:i[2]}}function B5(e){var r=Ha(e),t=e.read_shift(1);return{r:r[0],c:t,cRel:r[1],rRel:r[2]}}function U5(e){var r=e.read_shift(2),t=e.read_shift(2);return{r,c:t&255,fQuoted:!!(t&16384),cRel:t>>15,rRel:t>>15}}function z5(e,r,t){var a=t&&t.biff?t.biff:8;if(a>=2&&a<=5)return H5(e);var i=e.read_shift(a>=12?4:2),o=e.read_shift(2),u=(o&16384)>>14,c=(o&32768)>>15;if(o&=16383,c==1)for(;i>524287;)i-=1048576;if(u==1)for(;o>8191;)o=o-16384;return{r:i,c:o,cRel:u,rRel:c}}function H5(e){var r=e.read_shift(2),t=e.read_shift(1),a=(r&32768)>>15,i=(r&16384)>>14;return r&=16383,a==1&&r>=8192&&(r=r-16384),i==1&&t>=128&&(t=t-256),{r,c:t,cRel:i,rRel:a}}function V5(e,r,t){var a=(e[e.l++]&96)>>5,i=lp(e,t.biff>=2&&t.biff<=5?6:8,t);return[a,i]}function W5(e,r,t){var a=(e[e.l++]&96)>>5,i=e.read_shift(2,"i"),o=8;if(t)switch(t.biff){case 5:e.l+=12,o=6;break;case 12:o=12;break}var u=lp(e,o,t);return[a,i,u]}function $5(e,r,t){var a=(e[e.l++]&96)>>5;return e.l+=t&&t.biff>8?12:t.biff<8?6:8,[a]}function X5(e,r,t){var a=(e[e.l++]&96)>>5,i=e.read_shift(2),o=8;if(t)switch(t.biff){case 5:e.l+=12,o=6;break;case 12:o=12;break}return e.l+=o,[a,i]}function G5(e,r,t){var a=(e[e.l++]&96)>>5,i=M5(e,r-1,t);return[a,i]}function Y5(e,r,t){var a=(e[e.l++]&96)>>5;return e.l+=t.biff==2?6:t.biff==12?14:7,[a]}function dx(e){var r=e[e.l+1]&1,t=1;return e.l+=4,[r,t]}function K5(e,r,t){e.l+=2;for(var a=e.read_shift(t&&t.biff==2?1:2),i=[],o=0;o<=a;++o)i.push(e.read_shift(t&&t.biff==2?1:2));return i}function Q5(e,r,t){var a=e[e.l+1]&255?1:0;return e.l+=2,[a,e.read_shift(t&&t.biff==2?1:2)]}function q5(e,r,t){var a=e[e.l+1]&255?1:0;return e.l+=2,[a,e.read_shift(t&&t.biff==2?1:2)]}function Z5(e){var r=e[e.l+1]&255?1:0;return e.l+=2,[r,e.read_shift(2)]}function J5(e,r,t){var a=e[e.l+1]&255?1:0;return e.l+=t&&t.biff==2?3:4,[a]}function fp(e){var r=e.read_shift(1),t=e.read_shift(1);return[r,t]}function e3(e){return e.read_shift(2),fp(e)}function t3(e){return e.read_shift(2),fp(e)}function r3(e,r,t){var a=(e[e.l]&96)>>5;e.l+=1;var i=up(e,0,t);return[a,i]}function n3(e,r,t){var a=(e[e.l]&96)>>5;e.l+=1;var i=z5(e,0,t);return[a,i]}function a3(e,r,t){var a=(e[e.l]&96)>>5;e.l+=1;var i=e.read_shift(2);t&&t.biff==5&&(e.l+=12);var o=up(e,0,t);return[a,i,o]}function s3(e,r,t){var a=(e[e.l]&96)>>5;e.l+=1;var i=e.read_shift(t&&t.biff<=3?1:2);return[iE[i],xp[i],a]}function i3(e,r,t){var a=e[e.l++],i=e.read_shift(1),o=t&&t.biff<=3?[a==88?-1:0,e.read_shift(1)]:o3(e);return[i,(o[0]===0?xp:sE)[o[1]]]}function o3(e){return[e[e.l+1]>>7,e.read_shift(2)&32767]}function l3(e,r,t){e.l+=t&&t.biff==2?3:4}function c3(e,r,t){if(e.l++,t&&t.biff==12)return[e.read_shift(4,"i"),0];var a=e.read_shift(2),i=e.read_shift(t&&t.biff==2?1:2);return[a,i]}function u3(e){return e.l++,Kr[e.read_shift(1)]}function f3(e){return e.l++,e.read_shift(2)}function d3(e){return e.l++,e.read_shift(1)!==0}function h3(e){return e.l++,Fr(e)}function x3(e,r,t){return e.l++,qs(e,r-1,t)}function m3(e,r){var t=[e.read_shift(1)];if(r==12)switch(t[0]){case 2:t[0]=4;break;case 4:t[0]=16;break;case 0:t[0]=1;break;case 1:t[0]=2;break}switch(t[0]){case 4:t[1]=Gt(e,1)?"TRUE":"FALSE",r!=12&&(e.l+=7);break;case 37:case 16:t[1]=Kr[e[e.l]],e.l+=r==12?4:8;break;case 0:e.l+=8;break;case 1:t[1]=Fr(e);break;case 2:t[1]=ws(e,0,{biff:r>0&&r<8?2:r});break;default:throw new Error("Bad SerAr: "+t[0])}return t}function p3(e,r,t){for(var a=e.read_shift(t.biff==12?4:2),i=[],o=0;o!=a;++o)i.push((t.biff==12?vs:uc)(e));return i}function g3(e,r,t){var a=0,i=0;t.biff==12?(a=e.read_shift(4),i=e.read_shift(4)):(i=1+e.read_shift(1),a=1+e.read_shift(2)),t.biff>=2&&t.biff<8&&(--a,--i==0&&(i=256));for(var o=0,u=[];o!=a&&(u[o]=[]);++o)for(var c=0;c!=i;++c)u[o][c]=m3(e,t.biff);return u}function v3(e,r,t){var a=e.read_shift(1)>>>5&3,i=!t||t.biff>=8?4:2,o=e.read_shift(i);switch(t.biff){case 2:e.l+=5;break;case 3:case 4:e.l+=8;break;case 5:e.l+=12;break}return[a,0,o]}function w3(e,r,t){if(t.biff==5)return y3(e);var a=e.read_shift(1)>>>5&3,i=e.read_shift(2),o=e.read_shift(4);return[a,i,o]}function y3(e){var r=e.read_shift(1)>>>5&3,t=e.read_shift(2,"i");e.l+=8;var a=e.read_shift(2);return e.l+=12,[r,t,a]}function k3(e,r,t){var a=e.read_shift(1)>>>5&3;e.l+=t&&t.biff==2?3:4;var i=e.read_shift(t&&t.biff==2?1:2);return[a,i]}function E3(e,r,t){var a=e.read_shift(1)>>>5&3,i=e.read_shift(t&&t.biff==2?1:2);return[a,i]}function _3(e,r,t){var a=e.read_shift(1)>>>5&3;return e.l+=4,t.biff<8&&e.l--,t.biff==12&&(e.l+=2),[a]}function T3(e,r,t){var a=(e[e.l++]&96)>>5,i=e.read_shift(2),o=4;if(t)switch(t.biff){case 5:o=15;break;case 12:o=6;break}return e.l+=o,[a,i]}var S3=Rr,C3=Rr,b3=Rr;function go(e,r,t){return e.l+=2,[U5(e)]}function gf(e){return e.l+=6,[]}var N3=go,A3=gf,F3=gf,I3=go;function dp(e){return e.l+=2,[Vt(e),e.read_shift(2)&1]}var D3=go,R3=dp,P3=gf,O3=go,j3=go,L3=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function M3(e){e.l+=2;var r=e.read_shift(2),t=e.read_shift(2),a=e.read_shift(4),i=e.read_shift(2),o=e.read_shift(2),u=L3[t>>2&31];return{ixti:r,coltype:t&3,rt:u,idx:a,c:i,C:o}}function B3(e){return e.l+=2,[e.read_shift(4)]}function U3(e,r,t){return e.l+=5,e.l+=2,e.l+=t.biff==2?1:4,["PTGSHEET"]}function z3(e,r,t){return e.l+=t.biff==2?4:5,["PTGENDSHEET"]}function H3(e){var r=e.read_shift(1)>>>5&3,t=e.read_shift(2);return[r,t]}function V3(e){var r=e.read_shift(1)>>>5&3,t=e.read_shift(2);return[r,t]}function W3(e){return e.l+=4,[0,0]}var hx={1:{n:"PtgExp",f:c3},2:{n:"PtgTbl",f:b3},3:{n:"PtgAdd",f:Qt},4:{n:"PtgSub",f:Qt},5:{n:"PtgMul",f:Qt},6:{n:"PtgDiv",f:Qt},7:{n:"PtgPower",f:Qt},8:{n:"PtgConcat",f:Qt},9:{n:"PtgLt",f:Qt},10:{n:"PtgLe",f:Qt},11:{n:"PtgEq",f:Qt},12:{n:"PtgGe",f:Qt},13:{n:"PtgGt",f:Qt},14:{n:"PtgNe",f:Qt},15:{n:"PtgIsect",f:Qt},16:{n:"PtgUnion",f:Qt},17:{n:"PtgRange",f:Qt},18:{n:"PtgUplus",f:Qt},19:{n:"PtgUminus",f:Qt},20:{n:"PtgPercent",f:Qt},21:{n:"PtgParen",f:Qt},22:{n:"PtgMissArg",f:Qt},23:{n:"PtgStr",f:x3},26:{n:"PtgSheet",f:U3},27:{n:"PtgEndSheet",f:z3},28:{n:"PtgErr",f:u3},29:{n:"PtgBool",f:d3},30:{n:"PtgInt",f:f3},31:{n:"PtgNum",f:h3},32:{n:"PtgArray",f:Y5},33:{n:"PtgFunc",f:s3},34:{n:"PtgFuncVar",f:i3},35:{n:"PtgName",f:v3},36:{n:"PtgRef",f:r3},37:{n:"PtgArea",f:V5},38:{n:"PtgMemArea",f:k3},39:{n:"PtgMemErr",f:S3},40:{n:"PtgMemNoMem",f:C3},41:{n:"PtgMemFunc",f:E3},42:{n:"PtgRefErr",f:_3},43:{n:"PtgAreaErr",f:$5},44:{n:"PtgRefN",f:n3},45:{n:"PtgAreaN",f:G5},46:{n:"PtgMemAreaN",f:H3},47:{n:"PtgMemNoMemN",f:V3},57:{n:"PtgNameX",f:w3},58:{n:"PtgRef3d",f:a3},59:{n:"PtgArea3d",f:W5},60:{n:"PtgRefErr3d",f:T3},61:{n:"PtgAreaErr3d",f:X5},255:{}},$3={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},X3={1:{n:"PtgElfLel",f:dp},2:{n:"PtgElfRw",f:O3},3:{n:"PtgElfCol",f:N3},6:{n:"PtgElfRwV",f:j3},7:{n:"PtgElfColV",f:I3},10:{n:"PtgElfRadical",f:D3},11:{n:"PtgElfRadicalS",f:P3},13:{n:"PtgElfColS",f:A3},15:{n:"PtgElfColSV",f:F3},16:{n:"PtgElfRadicalLel",f:R3},25:{n:"PtgList",f:M3},29:{n:"PtgSxName",f:B3},255:{}},G3={0:{n:"PtgAttrNoop",f:W3},1:{n:"PtgAttrSemi",f:J5},2:{n:"PtgAttrIf",f:q5},4:{n:"PtgAttrChoose",f:K5},8:{n:"PtgAttrGoto",f:Q5},16:{n:"PtgAttrSum",f:l3},32:{n:"PtgAttrBaxcel",f:dx},33:{n:"PtgAttrBaxcel",f:dx},64:{n:"PtgAttrSpace",f:e3},65:{n:"PtgAttrSpaceSemi",f:t3},128:{n:"PtgAttrIfError",f:Z5},255:{}};function vo(e,r,t,a){if(a.biff<8)return Rr(e,r);for(var i=e.l+r,o=[],u=0;u!==t.length;++u)switch(t[u][0]){case"PtgArray":t[u][1]=g3(e,0,a),o.push(t[u][1]);break;case"PtgMemArea":t[u][2]=p3(e,t[u][1],a),o.push(t[u][2]);break;case"PtgExp":a&&a.biff==12&&(t[u][1][1]=e.read_shift(4),o.push(t[u][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+t[u][0]}return r=i-e.l,r!==0&&o.push(Rr(e,r)),o}function wo(e,r,t){for(var a=e.l+r,i,o,u=[];a!=e.l;)r=a-e.l,o=e[e.l],i=hx[o]||hx[$3[o]],(o===24||o===25)&&(i=(o===24?X3:G3)[e[e.l+1]]),!i||!i.f?Rr(e,r):u.push([i.n,i.f(e,r,t)]);return u}function Y3(e){for(var r=[],t=0;t<e.length;++t){for(var a=e[t],i=[],o=0;o<a.length;++o){var u=a[o];if(u)switch(u[0]){case 2:i.push('"'+u[1].replace(/"/g,'""')+'"');break;default:i.push(u[1])}else i.push("")}r.push(i.join(","))}return r.join(";")}var K3={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function Q3(e,r){var t=e.lastIndexOf("!"),a=r.lastIndexOf("!");return t==-1&&a==-1?e+":"+r:t>0&&a>0&&e.slice(0,t).toLowerCase()==r.slice(0,a).toLowerCase()?e+":"+r.slice(a+1):(console.error("Cannot hydrate range",e,r),e+":"+r)}function hp(e,r,t){if(!e)return"SH33TJSERR0";if(t.biff>8&&(!e.XTI||!e.XTI[r]))return e.SheetNames[r];if(!e.XTI)return"SH33TJSERR6";var a=e.XTI[r];if(t.biff<8)return r>1e4&&(r-=65536),r<0&&(r=-r),r==0?"":e.XTI[r-1];if(!a)return"SH33TJSERR1";var i="";if(t.biff>8)switch(e[a[0]][0]){case 357:return i=a[1]==-1?"#REF":e.SheetNames[a[1]],a[1]==a[2]?i:i+":"+e.SheetNames[a[2]];case 358:return t.SID!=null?e.SheetNames[t.SID]:"SH33TJSSAME"+e[a[0]][0];case 355:default:return"SH33TJSSRC"+e[a[0]][0]}switch(e[a[0]][0][0]){case 1025:return i=a[1]==-1?"#REF":e.SheetNames[a[1]]||"SH33TJSERR3",a[1]==a[2]?i:i+":"+e.SheetNames[a[2]];case 14849:return e[a[0]].slice(1).map(function(o){return o.Name}).join(";;");default:return e[a[0]][0][3]?(i=a[1]==-1?"#REF":e[a[0]][0][3][a[1]]||"SH33TJSERR4",a[1]==a[2]?i:i+":"+e[a[0]][0][3][a[2]]):"SH33TJSERR2"}}function xx(e,r,t){var a=hp(e,r,t);return a=="#REF"?a:Kw(a,t)}function Ar(e,r,t,a,i){var o=i&&i.biff||8,u={s:{c:0,r:0}},c=[],h,x,m,w=0,p=0,v,y="";if(!e[0]||!e[0][0])return"";for(var T=-1,E="",_=0,C=e[0].length;_<C;++_){var S=e[0][_];switch(S[0]){case"PtgUminus":c.push("-"+c.pop());break;case"PtgUplus":c.push("+"+c.pop());break;case"PtgPercent":c.push(c.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(h=c.pop(),x=c.pop(),T>=0){switch(e[0][T][1][0]){case 0:E=kt(" ",e[0][T][1][1]);break;case 1:E=kt("\r",e[0][T][1][1]);break;default:if(E="",i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][T][1][0])}x=x+E,T=-1}c.push(x+K3[S[0]]+h);break;case"PtgIsect":h=c.pop(),x=c.pop(),c.push(x+" "+h);break;case"PtgUnion":h=c.pop(),x=c.pop(),c.push(x+","+h);break;case"PtgRange":h=c.pop(),x=c.pop(),c.push(Q3(x,h));break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":m=Gi(S[1][1],u,i),c.push(Yi(m,o));break;case"PtgRefN":m=t?Gi(S[1][1],t,i):S[1][1],c.push(Yi(m,o));break;case"PtgRef3d":w=S[1][1],m=Gi(S[1][2],u,i),y=xx(a,w,i),c.push(y+"!"+Yi(m,o));break;case"PtgFunc":case"PtgFuncVar":var N=S[1][0],B=S[1][1];N||(N=0),N&=127;var X=N==0?[]:c.slice(-N);c.length-=N,B==="User"&&(B=X.shift()),c.push(B+"("+X.join(",")+")");break;case"PtgBool":c.push(S[1]?"TRUE":"FALSE");break;case"PtgInt":c.push(S[1]);break;case"PtgNum":c.push(String(S[1]));break;case"PtgStr":c.push('"'+S[1].replace(/"/g,'""')+'"');break;case"PtgErr":c.push(S[1]);break;case"PtgAreaN":v=X1(S[1][1],t?{s:t}:u,i),c.push(cu(v,i));break;case"PtgArea":v=X1(S[1][1],u,i),c.push(cu(v,i));break;case"PtgArea3d":w=S[1][1],v=S[1][2],y=xx(a,w,i),c.push(y+"!"+cu(v,i));break;case"PtgAttrSum":c.push("SUM("+c.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":p=S[1][2];var j=(a.names||[])[p-1]||(a[0]||[])[p],z=j?j.Name:"SH33TJSNAME"+String(p);z&&z.slice(0,6)=="_xlfn."&&!i.xlfn&&(z=z.slice(6)),c.push(z);break;case"PtgNameX":var M=S[1][1];p=S[1][2];var U;if(i.biff<=5)M<0&&(M=-M),a[M]&&(U=a[M][p]);else{var D="";if(((a[M]||[])[0]||[])[0]==14849||(((a[M]||[])[0]||[])[0]==1025?a[M][p]&&a[M][p].itab>0&&(D=a.SheetNames[a[M][p].itab-1]+"!"):D=a.SheetNames[p-1]+"!"),a[M]&&a[M][p])D+=a[M][p].Name;else if(a[0]&&a[0][p])D+=a[0][p].Name;else{var R=(hp(a,M,i)||"").split(";;");R[p-1]?D=R[p-1]:D+="SH33TJSERRX"}c.push(D);break}U||(U={Name:"SH33TJSERRY"}),c.push(U.Name);break;case"PtgParen":var K="(",ae=")";if(T>=0){switch(E="",e[0][T][1][0]){case 2:K=kt(" ",e[0][T][1][1])+K;break;case 3:K=kt("\r",e[0][T][1][1])+K;break;case 4:ae=kt(" ",e[0][T][1][1])+ae;break;case 5:ae=kt("\r",e[0][T][1][1])+ae;break;default:if(i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][T][1][0])}T=-1}c.push(K+c.pop()+ae);break;case"PtgRefErr":c.push("#REF!");break;case"PtgRefErr3d":c.push("#REF!");break;case"PtgExp":m={c:S[1][1],r:S[1][0]};var te={c:t.c,r:t.r};if(a.sharedf[Tt(m)]){var oe=a.sharedf[Tt(m)];c.push(Ar(oe,u,te,a,i))}else{var re=!1;for(h=0;h!=a.arrayf.length;++h)if(x=a.arrayf[h],!(m.c<x[0].s.c||m.c>x[0].e.c)&&!(m.r<x[0].s.r||m.r>x[0].e.r)){c.push(Ar(x[1],u,te,a,i)),re=!0;break}re||c.push(S[1])}break;case"PtgArray":c.push("{"+Y3(S[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":T=_;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":c.push("");break;case"PtgAreaErr":c.push("#REF!");break;case"PtgAreaErr3d":c.push("#REF!");break;case"PtgList":c.push("Table"+S[1].idx+"[#"+S[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(S));default:throw new Error("Unrecognized Formula Token: "+String(S))}var Z=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(i.biff!=3&&T>=0&&Z.indexOf(e[0][_][0])==-1){S=e[0][T];var ge=!0;switch(S[1][0]){case 4:ge=!1;case 0:E=kt(" ",S[1][1]);break;case 5:ge=!1;case 1:E=kt("\r",S[1][1]);break;default:if(E="",i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+S[1][0])}c.push((ge?E:"")+c.pop()+(ge?"":E)),T=-1}}if(c.length>1&&i.WTF)throw new Error("bad formula stack");return c[0]=="TRUE"?!0:c[0]=="FALSE"?!1:c[0]}function q3(e,r,t){var a=e.l+r,i=t.biff==2?1:2,o,u=e.read_shift(i);if(u==65535)return[[],Rr(e,r-2)];var c=wo(e,u,t);return r!==u+i&&(o=vo(e,r-u-i,c,t)),e.l=a,[c,o]}function Z3(e,r,t){var a=e.l+r,i=t.biff==2?1:2,o,u=e.read_shift(i);if(u==65535)return[[],Rr(e,r-2)];var c=wo(e,u,t);return r!==u+i&&(o=vo(e,r-u-i,c,t)),e.l=a,[c,o]}function J3(e,r,t,a){var i=e.l+r,o=wo(e,a,t),u;return i!==e.l&&(u=vo(e,i-e.l,o,t)),[o,u]}function eE(e,r,t){var a=e.l+r,i,o=e.read_shift(2),u=wo(e,o,t);return o==65535?[[],Rr(e,r-2)]:(r!==o+2&&(i=vo(e,a-o-2,u,t)),[u,i])}function tE(e){var r;if(ia(e,e.l+6)!==65535)return[Fr(e),"n"];switch(e[e.l]){case 0:return e.l+=8,["String","s"];case 1:return r=e[e.l+2]===1,e.l+=8,[r,"b"];case 2:return r=e[e.l+2],e.l+=8,[r,"e"];case 3:return e.l+=8,["","s"]}return[]}function du(e,r,t){var a=e.l+r,i=Bn(e,6,t),o=tE(e),u=e.read_shift(1);t.biff!=2&&(e.read_shift(1),t.biff>=5&&e.read_shift(4));var c=Z3(e,a-e.l,t);return{cell:i,val:o[0],formula:c,shared:u>>3&1,tt:o[1]}}function fc(e,r,t){var a=e.read_shift(4),i=wo(e,a,t),o=e.read_shift(4),u=o>0?vo(e,o,i,t):null;return[i,u]}var rE=fc,dc=fc,nE=fc,aE=fc,sE={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},xp={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},iE={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function mx(e){return e.slice(0,3)=="of:"&&(e=e.slice(3)),e.charCodeAt(0)==61&&(e=e.slice(1),e.charCodeAt(0)==61&&(e=e.slice(1))),e=e.replace(/COM\.MICROSOFT\./g,""),e=e.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(r,t){return t.replace(/\./g,"")}),e=e.replace(/\$'([^']|'')+'/g,function(r){return r.slice(1)}),e=e.replace(/\$([^\]\. #$]+)/g,function(r,t){return t.match(/^([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])?(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})?$/)?r:t}),e=e.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),e.replace(/[;~]/g,",").replace(/\|/g,";")}function hu(e){e=e.replace(/\$'([^']|'')+'/g,function(a){return a.slice(1)}),e=e.replace(/\$([^\]\. #$]+)/g,function(a,i){return i.match(/^([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])?(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})?$/)?a:i});var r=e.split(":"),t=r[0].split(".")[0];return[t,r[0].split(".")[1]+(r.length>1?":"+(r[1].split(".")[1]||r[1].split(".")[0]):"")]}var Zi={},Ys={};function Ji(e,r){if(e){var t=[.7,.7,.75,.75,.3,.3];r=="xlml"&&(t=[1,1,1,1,.5,.5]),e.left==null&&(e.left=t[0]),e.right==null&&(e.right=t[1]),e.top==null&&(e.top=t[2]),e.bottom==null&&(e.bottom=t[3]),e.header==null&&(e.header=t[4]),e.footer==null&&(e.footer=t[5])}}function mp(e,r,t,a,i,o,u){try{a.cellNF&&(e.z=ht[r])}catch(h){if(a.WTF)throw h}if(!(e.t==="z"&&!a.cellStyles)){if(e.t==="d"&&typeof e.v=="string"&&(e.v=yr(e.v)),(!a||a.cellText!==!1)&&e.t!=="z")try{if(ht[r]==null&&ls(q2[r]||"General",r),e.t==="e")e.w=e.w||Kr[e.v];else if(r===0)if(e.t==="n")(e.v|0)===e.v?e.w=e.v.toString(10):e.w=ao(e.v);else if(e.t==="d"){var c=ar(e.v,!!u);(c|0)===c?e.w=c.toString(10):e.w=ao(c)}else{if(e.v===void 0)return"";e.w=ds(e.v,Ys)}else e.t==="d"?e.w=on(r,ar(e.v,!!u),Ys):e.w=on(r,e.v,Ys)}catch(h){if(a.WTF)throw h}if(a.cellStyles&&t!=null)try{e.s=o.Fills[t],e.s.fgColor&&e.s.fgColor.theme&&!e.s.fgColor.rgb&&(e.s.fgColor.rgb=ql(i.themeElements.clrScheme[e.s.fgColor.theme].rgb,e.s.fgColor.tint||0),a.WTF&&(e.s.fgColor.raw_rgb=i.themeElements.clrScheme[e.s.fgColor.theme].rgb)),e.s.bgColor&&e.s.bgColor.theme&&(e.s.bgColor.rgb=ql(i.themeElements.clrScheme[e.s.bgColor.theme].rgb,e.s.bgColor.tint||0),a.WTF&&(e.s.bgColor.raw_rgb=i.themeElements.clrScheme[e.s.bgColor.theme].rgb))}catch(h){if(a.WTF&&o.Fills)throw h}}}function oE(e,r){var t=Yt(r);t.s.r<=t.e.r&&t.s.c<=t.e.c&&t.s.r>=0&&t.s.c>=0&&(e["!ref"]=yt(t))}var lE=/<(?:\w+:)?mergeCell ref=["'][A-Z0-9:]+['"]\s*[\/]?>/g,cE=/<(?:\w+:)?hyperlink [^<>]*>/mg,uE=/"(\w*:\w*)"/,fE=/<(?:\w+:)?col\b[^<>]*[\/]?>/g,dE=/<(?:\w+:)?autoFilter[^>]*/g,hE=/<(?:\w+:)?pageMargins[^<>]*\/>/g,pp=/<(?:\w+:)?sheetPr\b[^<>]*?\/>/;function xE(e,r,t,a,i,o,u){if(!e)return e;a||(a={"!id":{}});var c={};r.dense&&(c["!data"]=[]);var h={s:{r:2e6,c:2e6},e:{r:0,c:0}},x="",m="",w=dr(e,"sheetData");w?(x=e.slice(0,w.index),m=e.slice(w.index+w[0].length)):x=m=e;var p=x.match(pp);p?vf(p[0],c,i,t):(p=dr(x,"sheetPr"))&&mE(p[0],p[1]||"",c,i,t);var v=(x.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(v>0){var y=x.slice(v,v+50).match(uE);y&&!(r&&r.nodim)&&oE(c,y[1])}var T=dr(x,"sheetViews");T&&T[1]&&kE(T[1],i);var E=[];if(r.cellStyles){var _=x.match(fE);_&&vE(E,_)}w&&EE(w[1],c,r,h,o,u,i);var C=m.match(dE);C&&(c["!autofilter"]=wE(C[0]));var S=[],N=m.match(lE);if(N)for(v=0;v!=N.length;++v)S[v]=Yt(N[v].slice(N[v].indexOf("=")+2));var B=m.match(cE);B&&pE(c,B,a);var X=m.match(hE);X&&(c["!margins"]=gE(Ze(X[0])));var j;if((j=m.match(/legacyDrawing r:id="(.*?)"/))&&(c["!legrel"]=j[1]),r&&r.nodim&&(h.s.c=h.s.r=0),!c["!ref"]&&h.e.c>=h.s.c&&h.e.r>=h.s.r&&(c["!ref"]=yt(h)),r.sheetRows>0&&c["!ref"]){var z=Yt(c["!ref"]);r.sheetRows<=+z.e.r&&(z.e.r=r.sheetRows-1,z.e.r>h.e.r&&(z.e.r=h.e.r),z.e.r<z.s.r&&(z.s.r=z.e.r),z.e.c>h.e.c&&(z.e.c=h.e.c),z.e.c<z.s.c&&(z.s.c=z.e.c),c["!fullref"]=c["!ref"],c["!ref"]=yt(z))}return E.length>0&&(c["!cols"]=E),S.length>0&&(c["!merges"]=S),a["!id"][c["!legrel"]]&&(c["!legdrawel"]=a["!id"][c["!legrel"]]),c}function vf(e,r,t,a){var i=Ze(e);t.Sheets[a]||(t.Sheets[a]={}),i.codeName&&(t.Sheets[a].CodeName=wt(Pt(i.codeName)))}function mE(e,r,t,a,i){vf(e.slice(0,e.indexOf(">")),t,a,i)}function pE(e,r,t){for(var a=e["!data"]!=null,i=0;i!=r.length;++i){var o=Ze(Pt(r[i]),!0);if(!o.ref)return;var u=((t||{})["!id"]||[])[o.id];u?(o.Target=u.Target,o.location&&(o.Target+="#"+wt(o.location))):(o.Target="#"+wt(o.location),u={Target:o.Target,TargetMode:"Internal"}),o.Rel=u,o.tooltip&&(o.Tooltip=o.tooltip,delete o.tooltip);for(var c=Yt(o.ref),h=c.s.r;h<=c.e.r;++h)for(var x=c.s.c;x<=c.e.c;++x){var m=Ct(x)+It(h);a?(e["!data"][h]||(e["!data"][h]=[]),e["!data"][h][x]||(e["!data"][h][x]={t:"z",v:void 0}),e["!data"][h][x].l=o):(e[m]||(e[m]={t:"z",v:void 0}),e[m].l=o)}}}function gE(e){var r={};return["left","right","top","bottom","header","footer"].forEach(function(t){e[t]&&(r[t]=parseFloat(e[t]))}),r}function vE(e,r){for(var t=!1,a=0;a!=r.length;++a){var i=Ze(r[a],!0);i.hidden&&(i.hidden=Ft(i.hidden));var o=parseInt(i.min,10)-1,u=parseInt(i.max,10)-1;for(i.outlineLevel&&(i.level=+i.outlineLevel||0),delete i.min,delete i.max,i.width=+i.width,!t&&i.width&&(t=!0,mf(i.width)),Zs(i);o<=u;)e[o++]=er(i)}}function wE(e){var r={ref:(e.match(/ref="([^"]*)"/)||[])[1]};return r}var yE=/<(?:\w:)?sheetView(?:[^<>a-z][^<>]*)?\/?>/g;function kE(e,r){r.Views||(r.Views=[{}]),(e.match(yE)||[]).forEach(function(t,a){var i=Ze(t);r.Views[a]||(r.Views[a]={}),+i.zoomScale&&(r.Views[a].zoom=+i.zoomScale),i.rightToLeft&&Ft(i.rightToLeft)&&(r.Views[a].RTL=!0)})}var EE=(function(){var e=/<(?:\w+:)?c[ \/>]/,r=/<\/(?:\w+:)?row>/,t=/r=["']([^"']*)["']/,a=/ref=["']([^"']*)["']/;return function(o,u,c,h,x,m,w){for(var p=0,v="",y=[],T=[],E=0,_=0,C=0,S="",N,B,X=0,j=0,z,M,U=0,D=0,R=Array.isArray(m.CellXf),K,ae=[],te=[],oe=u["!data"]!=null,re=[],Z={},ge=!1,q=!!c.sheetStubs,Q=!!((w||{}).WBProps||{}).date1904,ie=o.split(r),ve=0,pe=ie.length;ve!=pe;++ve){v=ie[ve].trim();var Ae=v.length;if(Ae!==0){var je=0;e:for(p=0;p<Ae;++p)switch(v[p]){case">":if(v[p-1]!="/"){++p;break e}if(c&&c.cellStyles){if(B=Ze(v.slice(je,p),!0),X=B.r!=null?parseInt(B.r,10):X+1,j=-1,c.sheetRows&&c.sheetRows<X)continue;Z={},ge=!1,B.ht&&(ge=!0,Z.hpt=parseFloat(B.ht),Z.hpx=lo(Z.hpt)),B.hidden&&Ft(B.hidden)&&(ge=!0,Z.hidden=!0),B.outlineLevel!=null&&(ge=!0,Z.level=+B.outlineLevel),ge&&(re[X-1]=Z)}break;case"<":je=p;break}if(je>=p)break;if(B=Ze(v.slice(je,p),!0),X=B.r!=null?parseInt(B.r,10):X+1,j=-1,!(c.sheetRows&&c.sheetRows<X)){c.nodim||(h.s.r>X-1&&(h.s.r=X-1),h.e.r<X-1&&(h.e.r=X-1)),c&&c.cellStyles&&(Z={},ge=!1,B.ht&&(ge=!0,Z.hpt=parseFloat(B.ht),Z.hpx=lo(Z.hpt)),B.hidden&&Ft(B.hidden)&&(ge=!0,Z.hidden=!0),B.outlineLevel!=null&&(ge=!0,Z.level=+B.outlineLevel),ge&&(re[X-1]=Z)),y=v.slice(p).split(e);for(var ze=0;ze!=y.length&&y[ze].trim().charAt(0)=="<";++ze);for(y=y.slice(ze),p=0;p!=y.length;++p)if(v=y[p].trim(),v.length!==0){if(T=v.match(t),E=p,_=0,C=0,v="<c "+(v.slice(0,1)=="<"?">":"")+v,T!=null&&T.length===2){for(E=0,S=T[1],_=0;_!=S.length&&!((C=S.charCodeAt(_)-64)<1||C>26);++_)E=26*E+C;--E,j=E}else++j;for(_=0;_!=v.length&&v.charCodeAt(_)!==62;++_);if(++_,B=Ze(v.slice(0,_),!0),B.r||(B.r=Tt({r:X-1,c:j})),S=v.slice(_),N={t:""},(T=dr(S,"v"))!=null&&T[1]!==""&&(N.v=wt(T[1])),c.cellFormula){if((T=dr(S,"f"))!=null){if(T[1]=="")T[0].indexOf('t="shared"')>-1&&(M=Ze(T[0]),te[M.si]&&(N.f=ux(te[M.si][1],te[M.si][2],B.r)));else if(N.f=wt(Pt(T[1]),!0),c.xlfn||(N.f=fx(N.f)),T[0].indexOf('t="array"')>-1)N.F=(S.match(a)||[])[1],N.F.indexOf(":")>-1&&ae.push([Yt(N.F),N.F]);else if(T[0].indexOf('t="shared"')>-1){M=Ze(T[0]);var P=wt(Pt(T[1]));c.xlfn||(P=fx(P)),te[parseInt(M.si,10)]=[M,P,B.r]}}else(T=S.match(/<f[^<>]*\/>/))&&(M=Ze(T[0]),te[M.si]&&(N.f=ux(te[M.si][1],te[M.si][2],B.r)));var ee=Ir(B.r);for(_=0;_<ae.length;++_)ee.r>=ae[_][0].s.r&&ee.r<=ae[_][0].e.r&&ee.c>=ae[_][0].s.c&&ee.c<=ae[_][0].e.c&&(N.F=ae[_][1])}if(B.t==null&&N.v===void 0)if(N.f||N.F)N.v=0,N.t="n";else if(q)N.t="z";else continue;else N.t=B.t||"n";switch(h.s.c>j&&(h.s.c=j),h.e.c<j&&(h.e.c=j),N.t){case"n":if(N.v==""||N.v==null){if(!q)continue;N.t="z"}else N.v=parseFloat(N.v);break;case"s":if(typeof N.v>"u"){if(!q)continue;N.t="z"}else z=Zi[parseInt(N.v,10)],N.v=z.t,N.r=z.r,c.cellHTML&&(N.h=z.h);break;case"str":N.t="s",N.v=N.v!=null?wt(Pt(N.v),!0):"",c.cellHTML&&(N.h=$i(N.v));break;case"inlineStr":T=dr(S,"is"),N.t="s",T!=null&&(z=xf(T[1]))?(N.v=z.t,c.cellHTML&&(N.h=z.h)):N.v="";break;case"b":N.v=Ft(N.v);break;case"d":c.cellDates?N.v=yr(N.v,Q):(N.v=ar(yr(N.v,Q),Q),N.t="n");break;case"e":(!c||c.cellText!==!1)&&(N.w=N.v),N.v=vr[N.v];break}if(U=D=0,K=null,R&&B.s!==void 0&&(K=m.CellXf[B.s],K!=null&&(K.numFmtId!=null&&(U=K.numFmtId),c.cellStyles&&K.fillId!=null&&(D=K.fillId))),mp(N,U,D,c,x,m,Q),c.cellDates&&R&&N.t=="n"&&Mn(ht[U])&&(N.v=Ma(N.v+(Q?1462:0)),N.t=typeof N.v=="number"?"n":"d"),B.cm&&c.xlmeta){var J=(c.xlmeta.Cell||[])[+B.cm-1];J&&J.type=="XLDAPR"&&(N.D=!0)}var G;c.nodim&&(G=Ir(B.r),h.s.r>G.r&&(h.s.r=G.r),h.e.r<G.r&&(h.e.r=G.r)),oe?(G=Ir(B.r),u["!data"][G.r]||(u["!data"][G.r]=[]),u["!data"][G.r][G.c]=N):u[B.r]=N}}}}re.length>0&&(u["!rows"]=re)}})();function _E(e,r){var t={},a=e.l+r;t.r=e.read_shift(4),e.l+=4;var i=e.read_shift(2);e.l+=1;var o=e.read_shift(1);return e.l=a,o&7&&(t.level=o&7),o&16&&(t.hidden=!0),o&32&&(t.hpt=i/20),t}var TE=vs;function SE(){}function CE(e,r){var t={},a=e[e.l];return++e.l,t.above=!(a&64),t.left=!(a&128),e.l+=18,t.name=ey(e),t}function bE(e){var r=Cn(e);return[r]}function NE(e){var r=gs(e);return[r]}function AE(e){var r=Cn(e),t=e.read_shift(1);return[r,t,"b"]}function FE(e){var r=gs(e),t=e.read_shift(1);return[r,t,"b"]}function IE(e){var r=Cn(e),t=e.read_shift(1);return[r,t,"e"]}function DE(e){var r=gs(e),t=e.read_shift(1);return[r,t,"e"]}function RE(e){var r=Cn(e),t=e.read_shift(4);return[r,t,"s"]}function PE(e){var r=gs(e),t=e.read_shift(4);return[r,t,"s"]}function OE(e){var r=Cn(e),t=Fr(e);return[r,t,"n"]}function gp(e){var r=gs(e),t=Fr(e);return[r,t,"n"]}function jE(e){var r=Cn(e),t=cc(e);return[r,t,"n"]}function LE(e){var r=gs(e),t=cc(e);return[r,t,"n"]}function ME(e){var r=Cn(e),t=ff(e);return[r,t,"is"]}function BE(e){var r=Cn(e),t=Dr(e);return[r,t,"str"]}function UE(e){var r=gs(e),t=Dr(e);return[r,t,"str"]}function zE(e,r,t){var a=e.l+r,i=Cn(e);i.r=t["!row"];var o=e.read_shift(1),u=[i,o,"b"];if(t.cellFormula){e.l+=2;var c=dc(e,a-e.l,t);u[3]=Ar(c,null,i,t.supbooks,t)}else e.l=a;return u}function HE(e,r,t){var a=e.l+r,i=Cn(e);i.r=t["!row"];var o=e.read_shift(1),u=[i,o,"e"];if(t.cellFormula){e.l+=2;var c=dc(e,a-e.l,t);u[3]=Ar(c,null,i,t.supbooks,t)}else e.l=a;return u}function VE(e,r,t){var a=e.l+r,i=Cn(e);i.r=t["!row"];var o=Fr(e),u=[i,o,"n"];if(t.cellFormula){e.l+=2;var c=dc(e,a-e.l,t);u[3]=Ar(c,null,i,t.supbooks,t)}else e.l=a;return u}function WE(e,r,t){var a=e.l+r,i=Cn(e);i.r=t["!row"];var o=Dr(e),u=[i,o,"str"];if(t.cellFormula){e.l+=2;var c=dc(e,a-e.l,t);u[3]=Ar(c,null,i,t.supbooks,t)}else e.l=a;return u}var $E=vs;function XE(e,r){var t=e.l+r,a=vs(e),i=lc(e),o=Dr(e),u=Dr(e),c=Dr(e);e.l=t;var h={rfx:a,relId:i,loc:o,display:c};return u&&(h.Tooltip=u),h}function GE(){}function YE(e,r,t){var a=e.l+r,i=jm(e),o=e.read_shift(1),u=[i];if(u[2]=o,t.cellFormula){var c=rE(e,a-e.l,t);u[1]=c}else e.l=a;return u}function KE(e,r,t){var a=e.l+r,i=vs(e),o=[i];if(t.cellFormula){var u=aE(e,a-e.l,t);o[1]=u,e.l=a}else e.l=a;return o}var QE=["left","right","top","bottom","header","footer"];function qE(e){var r={};return QE.forEach(function(t){r[t]=Fr(e)}),r}function ZE(e){var r=e.read_shift(2);return e.l+=28,{RTL:r&32}}function JE(){}function e_(){}function t_(e,r,t,a,i,o,u){if(!e)return e;var c=r||{};a||(a={"!id":{}});var h={};c.dense&&(h["!data"]=[]);var x,m={s:{r:2e6,c:2e6},e:{r:0,c:0}},w=!1,p=!1,v,y,T,E,_,C,S,N,B,X=[];c.biff=12,c["!row"]=0;var j=0,z=!1,M=[],U={},D=c.supbooks||i.supbooks||[[]];if(D.sharedf=U,D.arrayf=M,D.SheetNames=i.SheetNames||i.Sheets.map(function(ge){return ge.name}),!c.supbooks&&(c.supbooks=D,i.Names))for(var R=0;R<i.Names.length;++R)D[0][R+1]=i.Names[R];var K=[],ae=[],te=!1;ec[16]={n:"BrtShortReal",f:gp};var oe,re=1462*+!!((i||{}).WBProps||{}).date1904;if(ua(e,function(q,Q,ie){if(!p)switch(ie){case 148:x=q;break;case 0:v=q,c.sheetRows&&c.sheetRows<=v.r&&(p=!0),N=It(E=v.r),c["!row"]=v.r,(q.hidden||q.hpt||q.level!=null)&&(q.hpt&&(q.hpx=lo(q.hpt)),ae[q.r]=q);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(y={t:q[2]},q[2]){case"n":y.v=q[1];break;case"s":S=Zi[q[1]],y.v=S.t,y.r=S.r;break;case"b":y.v=!!q[1];break;case"e":y.v=q[1],c.cellText!==!1&&(y.w=Kr[y.v]);break;case"str":y.t="s",y.v=q[1];break;case"is":y.t="s",y.v=q[1].t;break}if((T=u.CellXf[q[0].iStyleRef])&&mp(y,T.numFmtId,null,c,o,u,re>0),_=q[0].c==-1?_+1:q[0].c,c.dense?(h["!data"][E]||(h["!data"][E]=[]),h["!data"][E][_]=y):h[Ct(_)+N]=y,c.cellFormula){for(z=!1,j=0;j<M.length;++j){var ve=M[j];v.r>=ve[0].s.r&&v.r<=ve[0].e.r&&_>=ve[0].s.c&&_<=ve[0].e.c&&(y.F=yt(ve[0]),z=!0)}!z&&q.length>3&&(y.f=q[3])}if(m.s.r>v.r&&(m.s.r=v.r),m.s.c>_&&(m.s.c=_),m.e.r<v.r&&(m.e.r=v.r),m.e.c<_&&(m.e.c=_),c.cellDates&&T&&y.t=="n"&&Mn(ht[T.numFmtId])){var pe=aa(y.v+re);pe&&(y.t="d",y.v=new Date(Date.UTC(pe.y,pe.m-1,pe.d,pe.H,pe.M,pe.S,pe.u)))}oe&&(oe.type=="XLDAPR"&&(y.D=!0),oe=void 0);break;case 1:case 12:if(!c.sheetStubs||w)break;y={t:"z",v:void 0},_=q[0].c==-1?_+1:q[0].c,c.dense?(h["!data"][E]||(h["!data"][E]=[]),h["!data"][E][_]=y):h[Ct(_)+N]=y,m.s.r>v.r&&(m.s.r=v.r),m.s.c>_&&(m.s.c=_),m.e.r<v.r&&(m.e.r=v.r),m.e.c<_&&(m.e.c=_),oe&&(oe.type=="XLDAPR"&&(y.D=!0),oe=void 0);break;case 176:X.push(q);break;case 49:oe=((c.xlmeta||{}).Cell||[])[q-1];break;case 494:var Ae=a["!id"][q.relId];for(Ae?(q.Target=Ae.Target,q.loc&&(q.Target+="#"+q.loc),q.Rel=Ae):q.relId==""&&(q.Target="#"+q.loc),E=q.rfx.s.r;E<=q.rfx.e.r;++E)for(_=q.rfx.s.c;_<=q.rfx.e.c;++_)c.dense?(h["!data"][E]||(h["!data"][E]=[]),h["!data"][E][_]||(h["!data"][E][_]={t:"z",v:void 0}),h["!data"][E][_].l=q):(C=Ct(_)+It(E),h[C]||(h[C]={t:"z",v:void 0}),h[C].l=q);break;case 426:if(!c.cellFormula)break;M.push(q),B=c.dense?h["!data"][E][_]:h[Ct(_)+N],B.f=Ar(q[1],m,{r:v.r,c:_},D,c),B.F=yt(q[0]);break;case 427:if(!c.cellFormula)break;U[Tt(q[0].s)]=q[1],B=c.dense?h["!data"][E][_]:h[Ct(_)+N],B.f=Ar(q[1],m,{r:v.r,c:_},D,c);break;case 60:if(!c.cellStyles)break;for(;q.e>=q.s;)K[q.e--]={width:q.w/256,hidden:!!(q.flags&1),level:q.level},te||(te=!0,mf(q.w/256)),Zs(K[q.e+1]);break;case 551:q&&(h["!legrel"]=q);break;case 161:h["!autofilter"]={ref:yt(q)};break;case 476:h["!margins"]=q;break;case 147:i.Sheets[t]||(i.Sheets[t]={}),q.name&&(i.Sheets[t].CodeName=q.name),(q.above||q.left)&&(h["!outline"]={above:q.above,left:q.left});break;case 137:i.Views||(i.Views=[{}]),i.Views[0]||(i.Views[0]={}),q.RTL&&(i.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:w=!0;break;case 36:w=!1;break;case 37:w=!0;break;case 38:w=!1;break;default:if(!Q.T){if(!w||c.WTF)throw new Error("Unexpected record 0x"+ie.toString(16))}}},c),delete c.supbooks,delete c["!row"],!h["!ref"]&&(m.s.r<2e6||x&&(x.e.r>0||x.e.c>0||x.s.r>0||x.s.c>0))&&(h["!ref"]=yt(x||m)),c.sheetRows&&h["!ref"]){var Z=Yt(h["!ref"]);c.sheetRows<=+Z.e.r&&(Z.e.r=c.sheetRows-1,Z.e.r>m.e.r&&(Z.e.r=m.e.r),Z.e.r<Z.s.r&&(Z.s.r=Z.e.r),Z.e.c>m.e.c&&(Z.e.c=m.e.c),Z.e.c<Z.s.c&&(Z.s.c=Z.e.c),h["!fullref"]=h["!ref"],h["!ref"]=yt(Z))}return X.length>0&&(h["!merges"]=X),K.length>0&&(h["!cols"]=K),ae.length>0&&(h["!rows"]=ae),a["!id"][h["!legrel"]]&&(h["!legdrawel"]=a["!id"][h["!legrel"]]),h}function r_(e){var r=[],t=e.match(/^<c:numCache>/),a;(e.match(/<c:pt idx="(\d*)"[^<>\/]*><c:v>([^<])<\/c:v><\/c:pt>/mg)||[]).forEach(function(o){var u=o.match(/<c:pt idx="(\d*)"[^<>\/]*><c:v>([^<]*)<\/c:v><\/c:pt>/);u&&(r[+u[1]]=t?+u[2]:u[2])});var i=wt((cs(e,"c:formatCode")||["","General"])[1]);return(sf(e,"<c:f>","</c:f>")||[]).forEach(function(o){a=o.replace(/<[^<>]*>/g,"")}),[r,i,a]}function n_(e,r,t,a,i,o){var u=o||{"!type":"chart"};if(!e)return o;var c=0,h=0,x="A",m={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(sf(e,"<c:numCache>","</c:numCache>")||[]).forEach(function(w){var p=r_(w);m.s.r=m.s.c=0,m.e.c=c,x=Ct(c),p[0].forEach(function(v,y){u["!data"]?(u["!data"][y]||(u["!data"][y]=[]),u["!data"][y][c]={t:"n",v,z:p[1]}):u[x+It(y)]={t:"n",v,z:p[1]},h=y}),m.e.r<h&&(m.e.r=h),++c}),c>0&&(u["!ref"]=yt(m)),u}function a_(e,r,t,a,i){if(!e)return e;a||(a={"!id":{}});var o={"!type":"chart","!drawel":null,"!rel":""},u,c=e.match(pp);return c&&vf(c[0],o,i,t),(u=e.match(/drawing r:id="(.*?)"/))&&(o["!rel"]=u[1]),a["!id"][o["!rel"]]&&(o["!drawel"]=a["!id"][o["!rel"]]),o}function s_(e,r){e.l+=10;var t=Dr(e);return{name:t}}function i_(e,r,t,a,i){if(!e)return e;a||(a={"!id":{}});var o={"!type":"chart","!drawel":null,"!rel":""},u=!1;return ua(e,function(h,x,m){switch(m){case 550:o["!rel"]=h;break;case 651:i.Sheets[t]||(i.Sheets[t]={}),h.name&&(i.Sheets[t].CodeName=h.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:u=!0;break;case 36:u=!1;break;case 37:break;case 38:break;default:if(!(x.T>0)){if(!(x.T<0)){if(!u||r.WTF)throw new Error("Unexpected record 0x"+m.toString(16))}}}},r),a["!id"][o["!rel"]]&&(o["!drawel"]=a["!id"][o["!rel"]]),o}var vp=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],o_=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],l_=[],c_=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function px(e,r){for(var t=0;t!=e.length;++t)for(var a=e[t],i=0;i!=r.length;++i){var o=r[i];if(a[o[0]]==null)a[o[0]]=o[1];else switch(o[2]){case"bool":typeof a[o[0]]=="string"&&(a[o[0]]=Ft(a[o[0]]));break;case"int":typeof a[o[0]]=="string"&&(a[o[0]]=parseInt(a[o[0]],10));break}}}function gx(e,r){for(var t=0;t!=r.length;++t){var a=r[t];if(e[a[0]]==null)e[a[0]]=a[1];else switch(a[2]){case"bool":typeof e[a[0]]=="string"&&(e[a[0]]=Ft(e[a[0]]));break;case"int":typeof e[a[0]]=="string"&&(e[a[0]]=parseInt(e[a[0]],10));break}}}function wp(e){gx(e.WBProps,vp),gx(e.CalcPr,c_),px(e.WBView,o_),px(e.Sheets,l_),Ys.date1904=Ft(e.WBProps.date1904)}var u_=":][*?/\\".split("");function f_(e,r){try{if(e=="")throw new Error("Sheet name cannot be blank");if(e.length>31)throw new Error("Sheet name cannot exceed 31 chars");if(e.charCodeAt(0)==39||e.charCodeAt(e.length-1)==39)throw new Error("Sheet name cannot start or end with apostrophe (')");if(e.toLowerCase()=="history")throw new Error("Sheet name cannot be 'History'");u_.forEach(function(t){if(e.indexOf(t)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")})}catch(t){throw t}return!0}var d_=/<\w+:workbook/;function h_(e,r){if(!e)throw new Error("Could not find file");var t={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},a=!1,i="xmlns",o={},u=0;if(e.replace(kr,function(h,x){var m=Ze(h);switch(Sn(m[0])){case"<?xml":break;case"<workbook":h.match(d_)&&(i="xmlns"+h.match(/<(\w+):/)[1]),t.xmlns=m[i];break;case"</workbook>":break;case"<fileVersion":delete m[0],t.AppVersion=m;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":vp.forEach(function(w){if(m[w[0]]!=null)switch(w[2]){case"bool":t.WBProps[w[0]]=Ft(m[w[0]]);break;case"int":t.WBProps[w[0]]=parseInt(m[w[0]],10);break;default:t.WBProps[w[0]]=m[w[0]]}}),m.codeName&&(t.WBProps.CodeName=Pt(m.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete m[0],t.WBView.push(m);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(m.state){case"hidden":m.Hidden=1;break;case"veryHidden":m.Hidden=2;break;default:m.Hidden=0}delete m.state,m.name=wt(Pt(m.name)),delete m[0],t.Sheets.push(m);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":a=!0;break;case"</definedNames>":a=!1;break;case"<definedName":o={},o.Name=Pt(m.name),m.comment&&(o.Comment=m.comment),m.localSheetId&&(o.Sheet=+m.localSheetId),Ft(m.hidden||"0")&&(o.Hidden=!0),u=x+h.length;break;case"</definedName>":o.Ref=wt(Pt(e.slice(u,x))),t.Names.push(o);break;case"<definedName/>":break;case"<calcPr":delete m[0],t.CalcPr=m;break;case"<calcPr/>":delete m[0],t.CalcPr=m;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":a=!0;break;case"</AlternateContent>":a=!1;break;case"<revisionPtr":break;default:if(!a&&r.WTF)throw new Error("unrecognized "+m[0]+" in workbook")}return h}),Ow.indexOf(t.xmlns)===-1)throw new Error("Unknown Namespace: "+t.xmlns);return wp(t),t}function x_(e,r){var t={};return t.Hidden=e.read_shift(4),t.iTabID=e.read_shift(4),t.strRelID=Bu(e),t.name=Dr(e),t}function m_(e,r){var t={},a=e.read_shift(4);t.defaultThemeVersion=e.read_shift(4);var i=r>8?Dr(e):"";return i.length>0&&(t.CodeName=i),t.autoCompressPictures=!!(a&65536),t.backupFile=!!(a&64),t.checkCompatibility=!!(a&4096),t.date1904=!!(a&1),t.filterPrivacy=!!(a&8),t.hidePivotFieldList=!!(a&1024),t.promptedSolutions=!!(a&16),t.publishItems=!!(a&2048),t.refreshAllConnections=!!(a&262144),t.saveExternalLinkValues=!!(a&128),t.showBorderUnselectedTables=!!(a&4),t.showInkAnnotation=!!(a&32),t.showObjects=["all","placeholders","none"][a>>13&3],t.showPivotChartFilter=!!(a&32768),t.updateLinks=["userSet","never","always"][a>>8&3],t}function p_(e,r){var t={};return e.read_shift(4),t.ArchID=e.read_shift(4),e.l+=r-8,t}function g_(e,r,t){var a=e.l+r,i=e.read_shift(4);e.l+=1;var o=e.read_shift(4),u=ty(e),c,h="";try{c=nE(e,0,t);try{h=lc(e)}catch{}}catch{console.error("Could not parse defined name "+u)}i&32&&(u="_xlnm."+u),e.l=a;var x={Name:u,Ptg:c,Flags:i};return o<268435455&&(x.Sheet=o),h&&(x.Comment=h),x}function v_(e,r){var t={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},a=[],i=!1;r||(r={}),r.biff=12;var o=[],u=[[]];return u.SheetNames=[],u.XTI=[],ec[16]={n:"BrtFRTArchID$",f:p_},ua(e,function(h,x,m){switch(m){case 156:u.SheetNames.push(h.name),t.Sheets.push(h);break;case 153:t.WBProps=h;break;case 39:h.Sheet!=null&&(r.SID=h.Sheet),h.Ref=h.Ptg?Ar(h.Ptg,null,null,u,r):"#REF!",delete r.SID,delete h.Ptg,o.push(h);break;case 1036:break;case 357:case 358:case 355:case 667:u[0].length?u.push([m,h]):u[0]=[m,h],u[u.length-1].XTI=[];break;case 362:u.length===0&&(u[0]=[],u[0].XTI=[]),u[u.length-1].XTI=u[u.length-1].XTI.concat(h),u.XTI=u.XTI.concat(h);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:a.push(m),i=!0;break;case 36:a.pop(),i=!1;break;case 37:a.push(m),i=!0;break;case 38:a.pop(),i=!1;break;case 16:break;default:if(!x.T){if(!i||r.WTF&&a[a.length-1]!=37&&a[a.length-1]!=35)throw new Error("Unexpected record 0x"+m.toString(16))}}},r),wp(t),t.Names=o,t.supbooks=u,t}function w_(e,r,t){return r.slice(-4)===".bin"?v_(e,t):h_(e,t)}function y_(e,r,t,a,i,o,u,c){return r.slice(-4)===".bin"?t_(e,a,t,i,o,u,c):xE(e,a,t,i,o,u,c)}function k_(e,r,t,a,i,o,u,c){return r.slice(-4)===".bin"?i_(e,a,t,i,o):a_(e,a,t,i,o)}function E_(e,r,t,a,i,o,u,c){return r.slice(-4)===".bin"?P5():O5()}function __(e,r,t,a,i,o,u,c){return r.slice(-4)===".bin"?D5():R5()}function T_(e,r,t,a){return r.slice(-4)===".bin"?e5(e,t,a):Yk(e,t,a)}function S_(e,r,t){return r.slice(-4)===".bin"?mk(e,t):hk(e,t)}function C_(e,r,t){return r.slice(-4)===".bin"?A5(e,t):T5(e,t)}function b_(e,r,t){return r.slice(-4)===".bin"?y5(e):v5(e)}function N_(e,r,t,a){return t.slice(-4)===".bin"?k5(e,r,t,a):void 0}function A_(e,r,t){return r.slice(-4)===".bin"?p5(e,r,t):g5(e,r,t)}var yp=/\b((?:\w+:)?[\w]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,kp=/\b((?:\w+:)?[\w]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function Pn(e,r){var t=e.split(/\s+/),a=[];if(a[0]=t[0],t.length===1)return a;var i=e.match(yp),o,u,c,h;if(i)for(h=0;h!=i.length;++h)o=i[h].match(kp),(u=o[1].indexOf(":"))===-1?a[o[1]]=o[2].slice(1,o[2].length-1):(o[1].slice(0,6)==="xmlns:"?c="xmlns"+o[1].slice(6):c=o[1].slice(u+1),a[c]=o[2].slice(1,o[2].length-1));return a}function F_(e){var r=e.split(/\s+/),t={};if(r.length===1)return t;var a=e.match(yp),i,o,u,c;if(a)for(c=0;c!=a.length;++c)i=a[c].match(kp),(o=i[1].indexOf(":"))===-1?t[i[1]]=i[2].slice(1,i[2].length-1):(i[1].slice(0,6)==="xmlns:"?u="xmlns"+i[1].slice(6):u=i[1].slice(o+1),t[u]=i[2].slice(1,i[2].length-1));return t}var eo;function I_(e,r,t){var a=eo[e]||wt(e);return a==="General"?ds(r):on(a,r,{date1904:!!t})}function D_(e,r,t,a){var i=a;switch((t[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":i=Ft(a);break;case"i2":case"int":i=parseInt(a,10);break;case"r4":case"float":i=parseFloat(a);break;case"date":case"dateTime.tz":i=yr(a);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+t[0])}e[wt(r)]=i}function R_(e,r,t,a){if(e.t!=="z"){if(!t||t.cellText!==!1)try{e.t==="e"?e.w=e.w||Kr[e.v]:r==="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=ao(e.v):e.w=ds(e.v):e.w=I_(r||"General",e.v,a)}catch(u){if(t.WTF)throw u}try{var i=eo[r]||r||"General";if(t.cellNF&&(e.z=i),t.cellDates&&e.t=="n"&&Mn(i)){var o=aa(e.v+(a?1462:0));o&&(e.t="d",e.v=new Date(Date.UTC(o.y,o.m-1,o.d,o.H,o.M,o.S,o.u)))}}catch(u){if(t.WTF)throw u}}}function P_(e,r,t){if(t.cellStyles&&r.Interior){var a=r.Interior;a.Pattern&&(a.patternType=Hk[a.Pattern]||a.Pattern)}e[r.ID]=r}function O_(e,r,t,a,i,o,u,c,h,x,m){var w="General",p=a.StyleID,v={};x=x||{};var y=[],T=0;for(p===void 0&&c&&(p=c.StyleID),p===void 0&&u&&(p=u.StyleID);o[p]!==void 0;){var E=o[p];if(E.nf&&(w=E.nf),E.Interior&&y.push(E.Interior),!E.Parent)break;p=E.Parent}switch(t.Type){case"Boolean":a.t="b",a.v=Ft(e);break;case"String":a.t="s",a.r=L1(wt(e)),a.v=e.indexOf("<")>-1?wt(r||e).replace(/<[^<>]*>/g,""):a.r;break;case"DateTime":e.slice(-1)!="Z"&&(e+="Z"),a.v=ar(yr(e,m),m),a.v!==a.v&&(a.v=wt(e)),(!w||w=="General")&&(w="yyyy-mm-dd");case"Number":a.v===void 0&&(a.v=+e),a.t||(a.t="n");break;case"Error":a.t="e",a.v=vr[e],x.cellText!==!1&&(a.w=e);break;default:e==""&&r==""?a.t="z":(a.t="s",a.v=L1(r||e));break}if(R_(a,w,x,m),x.cellFormula!==!1)if(a.Formula){var _=wt(a.Formula);_.charCodeAt(0)==61&&(_=_.slice(1)),a.f=fs(_,i),delete a.Formula,a.ArrayRange=="RC"?a.F=fs("RC:RC",i):a.ArrayRange&&(a.F=fs(a.ArrayRange,i),h.push([Yt(a.F),a.F]))}else for(T=0;T<h.length;++T)i.r>=h[T][0].s.r&&i.r<=h[T][0].e.r&&i.c>=h[T][0].s.c&&i.c<=h[T][0].e.c&&(a.F=h[T][1]);x.cellStyles&&(y.forEach(function(C){!v.patternType&&C.patternType&&(v.patternType=C.patternType)}),a.s=v),a.StyleID!==void 0&&(a.ixfe=a.StyleID)}function j_(e){return Bm.indexOf("_xlnm."+e)>-1?"_xlnm."+e:e}function L_(e){e.t=e.v||"",e.t=e.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),e.v=e.w=e.ixfe=void 0}function xu(e,r){var t=r||{};um();var a=Ui(oc(e));(t.type=="binary"||t.type=="array"||t.type=="base64")&&(a=Pt(a));var i=a.slice(0,1024).toLowerCase(),o=!1;if(i=i.replace(/".*?"/g,""),(i.indexOf(">")&1023)>Math.min(i.indexOf(",")&1023,i.indexOf(";")&1023)){var u=er(t);return u.type="string",io.to_workbook(a,u)}if(i.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(Ve){i.indexOf("<"+Ve)>=0&&(o=!0)}),o)return X_(a,t);eo={"General Number":"General","General Date":ht[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":ht[15],"Short Date":ht[14],"Long Time":ht[19],"Medium Time":ht[18],"Short Time":ht[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:ht[2],Standard:ht[4],Percent:ht[10],Scientific:ht[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var c,h=[],x,m={},w=[],p={},v="";t.dense&&(p["!data"]=[]);var y={},T={},E=Pn('<Data ss:Type="String">'),_=0,C=0,S=0,N={s:{r:2e6,c:2e6},e:{r:0,c:0}},B={},X={},j="",z=0,M=[],U={},D={},R=0,K=[],ae=[],te={},oe=[],re,Z=!1,ge=[],q=[],Q={},ie=0,ve=0,pe={Sheets:[],WBProps:{date1904:!1}},Ae={};Zt.lastIndex=0,a=xo(a,"<!--","-->");for(var je="";c=Zt.exec(a);)switch(c[3]=(je=c[3]).toLowerCase()){case"data":if(je=="data"){if(c[1]==="/"){if((x=h.pop())[0]!==c[3])throw new Error("Bad state: "+x.join("|"))}else c[0].charAt(c[0].length-2)!=="/"&&h.push([c[3],!0]);break}if(h[h.length-1][1])break;c[1]==="/"?O_(a.slice(_,c.index),j,E,h[h.length-1][0]=="comment"?te:y,{c:C,r:S},B,oe[C],T,ge,t,pe.WBProps.date1904):(j="",E=Pn(c[0]),_=c.index+c[0].length);break;case"cell":if(c[1]==="/")if(ae.length>0&&(y.c=ae),(!t.sheetRows||t.sheetRows>S)&&y.v!==void 0&&(t.dense?(p["!data"][S]||(p["!data"][S]=[]),p["!data"][S][C]=y):p[Ct(C)+It(S)]=y),y.HRef&&(y.l={Target:wt(y.HRef)},y.HRefScreenTip&&(y.l.Tooltip=y.HRefScreenTip),delete y.HRef,delete y.HRefScreenTip),(y.MergeAcross||y.MergeDown)&&(ie=C+(parseInt(y.MergeAcross,10)|0),ve=S+(parseInt(y.MergeDown,10)|0),(ie>C||ve>S)&&M.push({s:{c:C,r:S},e:{c:ie,r:ve}})),!t.sheetStubs)y.MergeAcross?C=ie+1:++C;else if(y.MergeAcross||y.MergeDown){for(var ze=C;ze<=ie;++ze)for(var P=S;P<=ve;++P)(ze>C||P>S)&&(t.dense?(p["!data"][P]||(p["!data"][P]=[]),p["!data"][P][ze]={t:"z"}):p[Ct(ze)+It(P)]={t:"z"});C=ie+1}else++C;else y=F_(c[0]),y.Index&&(C=+y.Index-1),C<N.s.c&&(N.s.c=C),C>N.e.c&&(N.e.c=C),c[0].slice(-2)==="/>"&&++C,ae=[];break;case"row":c[1]==="/"||c[0].slice(-2)==="/>"?(S<N.s.r&&(N.s.r=S),S>N.e.r&&(N.e.r=S),c[0].slice(-2)==="/>"&&(T=Pn(c[0]),T.Index&&(S=+T.Index-1)),C=0,++S):(T=Pn(c[0]),T.Index&&(S=+T.Index-1),Q={},(T.AutoFitHeight=="0"||T.Height)&&(Q.hpx=parseInt(T.Height,10),Q.hpt=sp(Q.hpx),q[S]=Q),T.Hidden=="1"&&(Q.hidden=!0,q[S]=Q));break;case"worksheet":if(c[1]==="/"){if((x=h.pop())[0]!==c[3])throw new Error("Bad state: "+x.join("|"));w.push(v),N.s.r<=N.e.r&&N.s.c<=N.e.c&&(p["!ref"]=yt(N),t.sheetRows&&t.sheetRows<=N.e.r&&(p["!fullref"]=p["!ref"],N.e.r=t.sheetRows-1,p["!ref"]=yt(N))),M.length&&(p["!merges"]=M),oe.length>0&&(p["!cols"]=oe),q.length>0&&(p["!rows"]=q),m[v]=p}else N={s:{r:2e6,c:2e6},e:{r:0,c:0}},S=C=0,h.push([c[3],!1]),x=Pn(c[0]),v=wt(x.Name),p={},t.dense&&(p["!data"]=[]),M=[],ge=[],q=[],Ae={name:v,Hidden:0},pe.Sheets.push(Ae);break;case"table":if(c[1]==="/"){if((x=h.pop())[0]!==c[3])throw new Error("Bad state: "+x.join("|"))}else{if(c[0].slice(-2)=="/>")break;h.push([c[3],!1]),oe=[],Z=!1}break;case"style":c[1]==="/"?P_(B,X,t):X=Pn(c[0]);break;case"numberformat":X.nf=wt(Pn(c[0]).Format||"General"),eo[X.nf]&&(X.nf=eo[X.nf]);for(var ee=0;ee!=392&&ht[ee]!=X.nf;++ee);if(ee==392){for(ee=57;ee!=392;++ee)if(ht[ee]==null){ls(X.nf,ee);break}}break;case"column":if(h[h.length-1][0]!=="table"||c[1]==="/")break;if(re=Pn(c[0]),re.Hidden&&(re.hidden=!0,delete re.Hidden),re.Width&&(re.wpx=parseInt(re.Width,10)),!Z&&re.wpx>10){Z=!0,Lr=np;for(var J=0;J<oe.length;++J)oe[J]&&Zs(oe[J])}Z&&Zs(re),oe[re.Index-1||oe.length]=re;for(var G=0;G<+re.Span;++G)oe[oe.length]=er(re);break;case"namedrange":if(c[1]==="/")break;pe.Names||(pe.Names=[]);var _e=Ze(c[0]),F={Name:j_(_e.Name),Ref:fs(_e.RefersTo.slice(1),{r:0,c:0})};pe.Sheets.length>0&&(F.Sheet=pe.Sheets.length-1),pe.Names.push(F);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(c[0].slice(-2)==="/>")break;c[1]==="/"?j+=a.slice(z,c.index):z=c.index+c[0].length;break;case"interior":if(!t.cellStyles)break;X.Interior=Pn(c[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(c[0].slice(-2)==="/>")break;c[1]==="/"?Sy(U,je,a.slice(R,c.index)):R=c.index+c[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(c[1]==="/"){if((x=h.pop())[0]!==c[3])throw new Error("Bad state: "+x.join("|"))}else h.push([c[3],!1]);break;case"comment":if(c[1]==="/"){if((x=h.pop())[0]!==c[3])throw new Error("Bad state: "+x.join("|"));L_(te),ae.push(te)}else h.push([c[3],!1]),x=Pn(c[0]),Ft(x.ShowAlways||"0")||(ae.hidden=!0),te={a:x.Author};break;case"autofilter":if(c[1]==="/"){if((x=h.pop())[0]!==c[3])throw new Error("Bad state: "+x.join("|"))}else if(c[0].charAt(c[0].length-2)!=="/"){var ke=Pn(c[0]);p["!autofilter"]={ref:fs(ke.Range).replace(/\$/g,"")},h.push([c[3],!0])}break;case"name":break;case"datavalidation":if(c[1]==="/"){if((x=h.pop())[0]!==c[3])throw new Error("Bad state: "+x.join("|"))}else c[0].charAt(c[0].length-2)!=="/"&&h.push([c[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(c[1]==="/"){if((x=h.pop())[0]!==c[3])throw new Error("Bad state: "+x.join("|"))}else c[0].charAt(c[0].length-2)!=="/"&&h.push([c[3],!0]);break;case"null":break;default:if(h.length==0&&c[3]=="document"||h.length==0&&c[3]=="uof")return Ex(a,t);var Fe=!0;switch(h[h.length-1][0]){case"officedocumentsettings":switch(c[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:Fe=!1}break;case"componentoptions":switch(c[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:Fe=!1}break;case"excelworkbook":switch(c[3]){case"date1904":pe.WBProps.date1904=!0;break;case"hidehorizontalscrollbar":break;case"hideverticalscrollbar":break;case"hideworkbooktabs":break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:Fe=!1}break;case"workbookoptions":switch(c[3]){case"owcversion":break;case"height":break;case"width":break;default:Fe=!1}break;case"worksheetoptions":switch(c[3]){case"visible":if(c[0].slice(-2)!=="/>")if(c[1]==="/")switch(a.slice(R,c.index)){case"SheetHidden":Ae.Hidden=1;break;case"SheetVeryHidden":Ae.Hidden=2;break}else R=c.index+c[0].length;break;case"header":p["!margins"]||Ji(p["!margins"]={},"xlml"),isNaN(+Ze(c[0]).Margin)||(p["!margins"].header=+Ze(c[0]).Margin);break;case"footer":p["!margins"]||Ji(p["!margins"]={},"xlml"),isNaN(+Ze(c[0]).Margin)||(p["!margins"].footer=+Ze(c[0]).Margin);break;case"pagemargins":var De=Ze(c[0]);p["!margins"]||Ji(p["!margins"]={},"xlml"),isNaN(+De.Top)||(p["!margins"].top=+De.Top),isNaN(+De.Left)||(p["!margins"].left=+De.Left),isNaN(+De.Right)||(p["!margins"].right=+De.Right),isNaN(+De.Bottom)||(p["!margins"].bottom=+De.Bottom);break;case"displayrighttoleft":pe.Views||(pe.Views=[]),pe.Views[0]||(pe.Views[0]={}),pe.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":p["!outline"]||(p["!outline"]={}),p["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":p["!outline"]||(p["!outline"]={}),p["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:Fe=!1}break;case"pivottable":case"pivotcache":switch(c[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:Fe=!1}break;case"pagebreaks":switch(c[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:Fe=!1}break;case"autofilter":switch(c[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:Fe=!1}break;case"querytable":switch(c[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:Fe=!1}break;case"datavalidation":switch(c[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:Fe=!1}break;case"sorting":case"conditionalformatting":switch(c[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:Fe=!1}break;case"mapinfo":case"schema":case"data":switch(c[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:Fe=!1}break;case"smarttags":break;default:Fe=!1;break}if(Fe||c[3].match(/!\[CDATA/))break;if(!h[h.length-1][1])throw"Unrecognized tag: "+c[3]+"|"+h.join("|");if(h[h.length-1][0]==="customdocumentproperties"){if(c[0].slice(-2)==="/>")break;c[1]==="/"?D_(D,je,K,a.slice(R,c.index)):(K=c,R=c.index+c[0].length);break}if(t.WTF)throw"Unrecognized tag: "+c[3]+"|"+h.join("|")}var Ge={};return!t.bookSheets&&!t.bookProps&&(Ge.Sheets=m),Ge.SheetNames=w,Ge.Workbook=pe,Ge.SSF=er(ht),Ge.Props=U,Ge.Custprops=D,Ge.bookType="xlml",Ge}function Hu(e,r){switch(wf(r=r||{}),r.type||"base64"){case"base64":return xu(sn(e),r);case"binary":case"buffer":case"file":return xu(e,r);case"array":return xu(ca(e),r)}}function M_(e){var r={},t=e.content;if(t.l=28,r.AnsiUserType=t.read_shift(0,"lpstr-ansi"),r.AnsiClipboardFormat=ay(t),t.length-t.l<=4)return r;var a=t.read_shift(4);if(a==0||a>40||(t.l-=4,r.Reserved1=t.read_shift(0,"lpstr-ansi"),t.length-t.l<=4)||(a=t.read_shift(4),a!==1907505652)||(r.UnicodeClipboardFormat=sy(t),a=t.read_shift(4),a==0||a>40))return r;t.l-=4,r.Reserved2=t.read_shift(0,"lpwstr")}var B_=[60,1084,2066,2165,2175];function U_(e,r,t,a,i){var o=a,u=[],c=t.slice(t.l,t.l+o);if(i&&i.enc&&i.enc.insitu&&c.length>0)switch(e){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:i.enc.insitu(c)}u.push(c),t.l+=o;for(var h=ia(t,t.l),x=Vu[h],m=0;x!=null&&B_.indexOf(h)>-1;)o=ia(t,t.l+2),m=t.l+4,h==2066?m+=4:(h==2165||h==2175)&&(m+=12),c=t.slice(m,t.l+4+o),u.push(c),t.l+=4+o,x=Vu[h=ia(t,t.l)];var w=ja(u);nr(w,0);var p=0;w.lens=[];for(var v=0;v<u.length;++v)w.lens.push(p),p+=u[v].length;if(w.length<a)throw"XLS Record 0x"+e.toString(16)+" Truncated: "+w.length+" < "+a;return r.f(w,w.length,i)}function Xn(e,r,t){if(e.t!=="z"&&e.XF){var a=0;try{a=e.z||e.XF.numFmtId||0,r.cellNF&&e.z==null&&(e.z=ht[a])}catch(o){if(r.WTF)throw o}if(!r||r.cellText!==!1)try{e.t==="e"?e.w=e.w||Kr[e.v]:a===0||a=="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=ao(e.v):e.w=ds(e.v):e.w=on(a,e.v,{date1904:!!t,dateNF:r&&r.dateNF})}catch(o){if(r.WTF)throw o}if(r.cellDates&&a&&e.t=="n"&&Mn(ht[a]||String(a))){var i=aa(e.v+(t?1462:0));i&&(e.t="d",e.v=new Date(Date.UTC(i.y,i.m-1,i.d,i.H,i.M,i.S,i.u)))}}}function Ml(e,r,t){return{v:e,ixfe:r,t}}function z_(e,r){var t={opts:{}},a={},i={};r.dense&&(i["!data"]=[]);var o={},u={},c=null,h=[],x="",m={},w,p="",v,y,T,E,_={},C=[],S,N,B=[],X=[],j={Sheets:[],WBProps:{date1904:!1},Views:[{}]},z={},M=!1,U=function(Ne){return Ne<8?us[Ne]:Ne<64&&X[Ne-8]||us[Ne]},D=function(Ne,Ke){var mt=Ne.XF.data;if(!(!mt||!mt.patternType||!Ke||!Ke.cellStyles)){Ne.s={},Ne.s.patternType=mt.patternType;var Nt;(Nt=oo(U(mt.icvFore)))&&(Ne.s.fgColor={rgb:Nt}),(Nt=oo(U(mt.icvBack)))&&(Ne.s.bgColor={rgb:Nt})}},R=function(Ne,Ke,mt){if(!(!M&&ie>1)&&!(mt.sheetRows&&Ne.r>=mt.sheetRows)){if(mt.cellStyles&&Ke.XF&&Ke.XF.data&&D(Ke,mt),delete Ke.ixfe,delete Ke.XF,w=Ne,p=Tt(Ne),(!u||!u.s||!u.e)&&(u={s:{r:0,c:0},e:{r:0,c:0}}),Ne.r<u.s.r&&(u.s.r=Ne.r),Ne.c<u.s.c&&(u.s.c=Ne.c),Ne.r+1>u.e.r&&(u.e.r=Ne.r+1),Ne.c+1>u.e.c&&(u.e.c=Ne.c+1),mt.cellFormula&&Ke.f){for(var Nt=0;Nt<C.length;++Nt)if(!(C[Nt][0].s.c>Ne.c||C[Nt][0].s.r>Ne.r)&&!(C[Nt][0].e.c<Ne.c||C[Nt][0].e.r<Ne.r)){Ke.F=yt(C[Nt][0]),(C[Nt][0].s.c!=Ne.c||C[Nt][0].s.r!=Ne.r)&&delete Ke.f,Ke.f&&(Ke.f=""+Ar(C[Nt][1],u,Ne,q,K));break}}mt.dense?(i["!data"][Ne.r]||(i["!data"][Ne.r]=[]),i["!data"][Ne.r][Ne.c]=Ke):i[p]=Ke}},K={enc:!1,sbcch:0,snames:[],sharedf:_,arrayf:C,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!r&&!!r.cellStyles,WTF:!!r&&!!r.wtf};r.password&&(K.password=r.password);var ae,te=[],oe=[],re=[],Z=[],ge=!1,q=[];q.SheetNames=K.snames,q.sharedf=K.sharedf,q.arrayf=K.arrayf,q.names=[],q.XTI=[];var Q=0,ie=0,ve=0,pe=[],Ae=[],je;K.codepage=1200,On(1200);for(var ze=!1;e.l<e.length-1;){var P=e.l,ee=e.read_shift(2);if(ee===0&&Q===10)break;var J=e.l===e.length?0:e.read_shift(2),G=Vu[ee];if(ie==0&&[9,521,1033,2057].indexOf(ee)==-1)break;if(G&&G.f){if(r.bookSheets&&Q===133&&ee!==133)break;if(Q=ee,G.r===2||G.r==12){var _e=e.read_shift(2);if(J-=2,!K.enc&&_e!==ee&&((_e&255)<<8|_e>>8)!==ee)throw new Error("rt mismatch: "+_e+"!="+ee);G.r==12&&(e.l+=10,J-=10)}var F={};if(ee===10?F=G.f(e,J,K):F=U_(ee,G,e,J,K),ie==0&&[9,521,1033,2057].indexOf(Q)===-1)continue;switch(ee){case 34:t.opts.Date1904=j.WBProps.date1904=F;break;case 134:t.opts.WriteProtect=!0;break;case 47:if(K.enc||(e.l=0),K.enc=F,!r.password)throw new Error("File is password-protected");if(F.valid==null)throw new Error("Encryption scheme unsupported");if(!F.valid)throw new Error("Password is incorrect");break;case 92:K.lastuser=F;break;case 66:var ke=Number(F);switch(ke){case 21010:ke=1200;break;case 32768:ke=1e4;break;case 32769:ke=1252;break}On(K.codepage=ke),ze=!0;break;case 317:K.rrtabid=F;break;case 25:K.winlocked=F;break;case 439:t.opts.RefreshAll=F;break;case 12:t.opts.CalcCount=F;break;case 16:t.opts.CalcDelta=F;break;case 17:t.opts.CalcIter=F;break;case 13:t.opts.CalcMode=F;break;case 14:t.opts.CalcPrecision=F;break;case 95:t.opts.CalcSaveRecalc=F;break;case 15:K.CalcRefMode=F;break;case 2211:t.opts.FullCalc=F;break;case 129:F.fDialog&&(i["!type"]="dialog"),F.fBelow||((i["!outline"]||(i["!outline"]={})).above=!0),F.fRight||((i["!outline"]||(i["!outline"]={})).left=!0);break;case 67:case 579:case 1091:case 224:B.push(F);break;case 430:q.push([F]),q[q.length-1].XTI=[];break;case 35:case 547:q[q.length-1].push(F);break;case 24:case 536:je={Name:F.Name,Ref:Ar(F.rgce,u,null,q,K)},F.itab>0&&(je.Sheet=F.itab-1),q.names.push(je),q[0]||(q[0]=[],q[0].XTI=[]),q[q.length-1].push(F),F.Name=="_xlnm._FilterDatabase"&&F.itab>0&&F.rgce&&F.rgce[0]&&F.rgce[0][0]&&F.rgce[0][0][0]=="PtgArea3d"&&(Ae[F.itab-1]={ref:yt(F.rgce[0][0][1][2])});break;case 22:K.ExternCount=F;break;case 23:q.length==0&&(q[0]=[],q[0].XTI=[]),q[q.length-1].XTI=q[q.length-1].XTI.concat(F),q.XTI=q.XTI.concat(F);break;case 2196:if(K.biff<8)break;je!=null&&(je.Comment=F[1]);break;case 18:i["!protect"]=F;break;case 19:F!==0&&K.WTF&&console.error("Password verifier: "+F);break;case 133:o[K.biff==4?K.snames.length:F.pos]=F,K.snames.push(F.name);break;case 10:{if(--ie?!M:M)break;if(u.e){if(u.e.r>0&&u.e.c>0){if(u.e.r--,u.e.c--,i["!ref"]=yt(u),r.sheetRows&&r.sheetRows<=u.e.r){var Fe=u.e.r;u.e.r=r.sheetRows-1,i["!fullref"]=i["!ref"],i["!ref"]=yt(u),u.e.r=Fe}u.e.r++,u.e.c++}te.length>0&&(i["!merges"]=te),oe.length>0&&(i["!objects"]=oe),re.length>0&&(i["!cols"]=re),Z.length>0&&(i["!rows"]=Z),j.Sheets.push(z)}x===""?m=i:a[x]=i,i={},r.dense&&(i["!data"]=[])}break;case 9:case 521:case 1033:case 2057:{if(K.biff===8&&(K.biff={9:2,521:3,1033:4}[ee]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[F.BIFFVer]||8),K.biffguess=F.BIFFVer==0,F.BIFFVer==0&&F.dt==4096&&(K.biff=5,ze=!0,On(K.codepage=28591)),K.biff==4&&F.dt&256&&(M=!0),K.biff==8&&F.BIFFVer==0&&F.dt==16&&(K.biff=2),ie++&&!M)break;if(i={},r.dense&&(i["!data"]=[]),K.biff<8&&!ze&&(ze=!0,On(K.codepage=r.codepage||1252)),K.biff==4&&M)x=(o[K.snames.indexOf(x)+1]||{name:""}).name;else if(K.biff<5||F.BIFFVer==0&&F.dt==4096){x===""&&(x="Sheet1"),u={s:{r:0,c:0},e:{r:0,c:0}};var De={pos:e.l-J,name:x};o[De.pos]=De,K.snames.push(x)}else x=(o[P]||{name:""}).name;F.dt==32&&(i["!type"]="chart"),F.dt==64&&(i["!type"]="macro"),te=[],oe=[],K.arrayf=C=[],re=[],Z=[],ge=!1,z={Hidden:(o[P]||{hs:0}).hs,name:x}}break;case 515:case 3:case 2:i["!type"]=="chart"&&(r.dense?(i["!data"][F.r]||[])[F.c]:i[Ct(F.c)+It(F.r)])&&++F.c,S={ixfe:F.ixfe,XF:B[F.ixfe]||{},v:F.val,t:"n"},ve>0&&(S.z=S.XF&&S.XF.numFmtId&&pe[S.XF.numFmtId]||pe[S.ixfe>>8&63]),Xn(S,r,t.opts.Date1904),R({c:F.c,r:F.r},S,r);break;case 5:case 517:S={ixfe:F.ixfe,XF:B[F.ixfe],v:F.val,t:F.t},ve>0&&(S.z=S.XF&&S.XF.numFmtId&&pe[S.XF.numFmtId]||pe[S.ixfe>>8&63]),Xn(S,r,t.opts.Date1904),R({c:F.c,r:F.r},S,r);break;case 638:S={ixfe:F.ixfe,XF:B[F.ixfe],v:F.rknum,t:"n"},ve>0&&(S.z=S.XF&&S.XF.numFmtId&&pe[S.XF.numFmtId]||pe[S.ixfe>>8&63]),Xn(S,r,t.opts.Date1904),R({c:F.c,r:F.r},S,r);break;case 189:for(var Ge=F.c;Ge<=F.C;++Ge){var Ve=F.rkrec[Ge-F.c][0];S={ixfe:Ve,XF:B[Ve],v:F.rkrec[Ge-F.c][1],t:"n"},ve>0&&(S.z=S.XF&&S.XF.numFmtId&&pe[S.XF.numFmtId]||pe[S.ixfe>>8&63]),Xn(S,r,t.opts.Date1904),R({c:Ge,r:F.r},S,r)}break;case 6:case 518:case 1030:{if(F.val=="String"){c=F;break}if(S=Ml(F.val,F.cell.ixfe,F.tt),S.XF=B[S.ixfe],r.cellFormula){var tt=F.formula;if(tt&&tt[0]&&tt[0][0]&&tt[0][0][0]=="PtgExp"){var ft=tt[0][0][1][0],st=tt[0][0][1][1],ye=Tt({r:ft,c:st});_[ye]?S.f=""+Ar(F.formula,u,F.cell,q,K):S.F=((r.dense?(i["!data"][ft]||[])[st]:i[ye])||{}).F}else S.f=""+Ar(F.formula,u,F.cell,q,K)}ve>0&&(S.z=S.XF&&S.XF.numFmtId&&pe[S.XF.numFmtId]||pe[S.ixfe>>8&63]),Xn(S,r,t.opts.Date1904),R(F.cell,S,r),c=F}break;case 7:case 519:if(c)c.val=F,S=Ml(F,c.cell.ixfe,"s"),S.XF=B[S.ixfe],r.cellFormula&&(S.f=""+Ar(c.formula,u,c.cell,q,K)),ve>0&&(S.z=S.XF&&S.XF.numFmtId&&pe[S.XF.numFmtId]||pe[S.ixfe>>8&63]),Xn(S,r,t.opts.Date1904),R(c.cell,S,r),c=null;else throw new Error("String record expects Formula");break;case 33:case 545:{C.push(F);var Ce=Tt(F[0].s);if(v=r.dense?(i["!data"][F[0].s.r]||[])[F[0].s.c]:i[Ce],r.cellFormula&&v){if(!c||!Ce||!v)break;v.f=""+Ar(F[1],u,F[0],q,K),v.F=yt(F[0])}}break;case 1212:{if(!r.cellFormula)break;if(p){if(!c)break;_[Tt(c.cell)]=F[0],v=r.dense?(i["!data"][c.cell.r]||[])[c.cell.c]:i[Tt(c.cell)],(v||{}).f=""+Ar(F[0],u,w,q,K)}}break;case 253:S=Ml(h[F.isst].t,F.ixfe,"s"),h[F.isst].h&&(S.h=h[F.isst].h),S.XF=B[S.ixfe],ve>0&&(S.z=S.XF&&S.XF.numFmtId&&pe[S.XF.numFmtId]||pe[S.ixfe>>8&63]),Xn(S,r,t.opts.Date1904),R({c:F.c,r:F.r},S,r);break;case 513:r.sheetStubs&&(S={ixfe:F.ixfe,XF:B[F.ixfe],t:"z"},ve>0&&(S.z=S.XF&&S.XF.numFmtId&&pe[S.XF.numFmtId]||pe[S.ixfe>>8&63]),Xn(S,r,t.opts.Date1904),R({c:F.c,r:F.r},S,r));break;case 190:if(r.sheetStubs)for(var le=F.c;le<=F.C;++le){var ce=F.ixfe[le-F.c];S={ixfe:ce,XF:B[ce],t:"z"},ve>0&&(S.z=S.XF&&S.XF.numFmtId&&pe[S.XF.numFmtId]||pe[S.ixfe>>8&63]),Xn(S,r,t.opts.Date1904),R({c:le,r:F.r},S,r)}break;case 214:case 516:case 4:S=Ml(F.val,F.ixfe,"s"),S.XF=B[S.ixfe],ve>0&&(S.z=S.XF&&S.XF.numFmtId&&pe[S.XF.numFmtId]||pe[S.ixfe>>8&63]),Xn(S,r,t.opts.Date1904),R({c:F.c,r:F.r},S,r);break;case 0:case 512:ie===1&&(u=F);break;case 252:h=F;break;case 1054:if(K.biff>=3&&K.biff<=4){pe[ve++]=F[1];for(var Ee=0;Ee<ve+163&&ht[Ee]!=F[1];++Ee);Ee>=163&&ls(F[1],ve+163)}else ls(F[1],F[0]);break;case 30:{pe[ve++]=F;for(var Se=0;Se<ve+163&&ht[Se]!=F;++Se);Se>=163&&ls(F,ve+163)}break;case 229:te=te.concat(F);break;case 93:oe[F.cmo[0]]=K.lastobj=F;break;case 438:K.lastobj.TxO=F;break;case 127:K.lastobj.ImData=F;break;case 440:for(E=F[0].s.r;E<=F[0].e.r;++E)for(T=F[0].s.c;T<=F[0].e.c;++T)v=r.dense?(i["!data"][E]||[])[T]:i[Tt({c:T,r:E})],v&&(v.l=F[1]);break;case 2048:for(E=F[0].s.r;E<=F[0].e.r;++E)for(T=F[0].s.c;T<=F[0].e.c;++T)v=r.dense?(i["!data"][E]||[])[T]:i[Tt({c:T,r:E})],v&&v.l&&(v.l.Tooltip=F[1]);break;case 28:{if(v=r.dense?(i["!data"][F[0].r]||[])[F[0].c]:i[Tt(F[0])],v||(r.dense?(i["!data"][F[0].r]||(i["!data"][F[0].r]=[]),v=i["!data"][F[0].r][F[0].c]={t:"z"}):v=i[Tt(F[0])]={t:"z"},u.e.r=Math.max(u.e.r,F[0].r),u.s.r=Math.min(u.s.r,F[0].r),u.e.c=Math.max(u.e.c,F[0].c),u.s.c=Math.min(u.s.c,F[0].c)),v.c||(v.c=[]),K.biff<=5&&K.biff>=2)y={a:"SheetJ5",t:F[1]};else{var Re=oe[F[2]];y={a:F[1],t:Re.TxO.t},F[3]!=null&&!(F[3]&2)&&(v.c.hidden=!0)}v.c.push(y)}break;case 2173:d5(B[F.ixfe],F.ext);break;case 125:{if(!K.cellStyles)break;for(;F.e>=F.s;)re[F.e--]={width:F.w/256,level:F.level||0,hidden:!!(F.flags&1)},ge||(ge=!0,mf(F.w/256)),Zs(re[F.e+1])}break;case 520:{var at={};F.level!=null&&(Z[F.r]=at,at.level=F.level),F.hidden&&(Z[F.r]=at,at.hidden=!0),F.hpt&&(Z[F.r]=at,at.hpt=F.hpt,at.hpx=lo(F.hpt))}break;case 38:case 39:case 40:case 41:i["!margins"]||Ji(i["!margins"]={}),i["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[ee]]=F;break;case 161:i["!margins"]||Ji(i["!margins"]={}),i["!margins"].header=F.header,i["!margins"].footer=F.footer;break;case 574:F.RTL&&(j.Views[0].RTL=!0);break;case 146:X=F;break;case 2198:ae=F;break;case 140:N=F;break;case 442:x?z.CodeName=F||z.name:j.WBProps.CodeName=F||"ThisWorkbook";break}}else G||console.error("Missing Info for XLS Record 0x"+ee.toString(16)),e.l+=J}return t.SheetNames=_n(o).sort(function(it,Ne){return Number(it)-Number(Ne)}).map(function(it){return o[it].name}),r.bookSheets||(t.Sheets=a),!t.SheetNames.length&&m["!ref"]?(t.SheetNames.push("Sheet1"),t.Sheets&&(t.Sheets.Sheet1=m)):t.Preamble=m,t.Sheets&&Ae.forEach(function(it,Ne){t.Sheets[t.SheetNames[Ne]]["!autofilter"]=it}),t.Strings=h,t.SSF=er(ht),K.enc&&(t.Encryption=K.enc),ae&&(t.Themes=ae),t.Metadata={},N!==void 0&&(t.Metadata.Country=N),q.names.length>0&&(j.Names=q.names),t.Workbook=j,t}var vx={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function H_(e,r,t){var a=Et.find(e,"/!DocumentSummaryInformation");if(a&&a.size>0)try{var i=ex(a,fy,vx.DSI);for(var o in i)r[o]=i[o]}catch(x){if(t.WTF)throw x}var u=Et.find(e,"/!SummaryInformation");if(u&&u.size>0)try{var c=ex(u,dy,vx.SI);for(var h in c)r[h]==null&&(r[h]=c[h])}catch(x){if(t.WTF)throw x}r.HeadingPairs&&r.TitlesOfParts&&(zm(r.HeadingPairs,r.TitlesOfParts,r,t),delete r.HeadingPairs,delete r.TitlesOfParts)}function Ep(e,r){r||(r={}),wf(r),Jx(),r.codepage&&Ju(r.codepage);var t,a;if(e.FullPaths){if(Et.find(e,"/encryption"))throw new Error("File is password-protected");t=Et.find(e,"!CompObj"),a=Et.find(e,"/Workbook")||Et.find(e,"/Book")}else{switch(r.type){case"base64":e=tn(sn(e));break;case"binary":e=tn(e);break;case"buffer":break;case"array":Array.isArray(e)||(e=Array.prototype.slice.call(e));break}nr(e,0),a={content:e}}var i,o;if(t&&M_(t),r.bookProps&&!r.bookSheets)i={};else{var u=vt?"buffer":"array";if(a&&a.content)i=z_(a.content,r);else if((o=Et.find(e,"PerfectOffice_MAIN"))&&o.content)i=qi.to_workbook(o.content,(r.type=u,r));else if((o=Et.find(e,"NativeContent_MAIN"))&&o.content)i=qi.to_workbook(o.content,(r.type=u,r));else throw(o=Et.find(e,"MN0"))&&o.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");r.bookVBA&&e.FullPaths&&Et.find(e,"/_VBA_PROJECT_CUR/VBA/dir")&&(i.vbaraw=I5(e))}var c={};return e.FullPaths&&H_(e,c,r),i.Props=i.Custprops=c,r.bookFiles&&(i.cfb=e),i}var ec={0:{f:_E},1:{f:bE},2:{f:jE},3:{f:IE},4:{f:AE},5:{f:OE},6:{f:BE},7:{f:RE},8:{f:WE},9:{f:VE},10:{f:zE},11:{f:HE},12:{f:NE},13:{f:LE},14:{f:DE},15:{f:FE},16:{f:gp},17:{f:UE},18:{f:PE},19:{f:ff},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:g_},40:{},42:{},43:{f:Qk},44:{f:Kk},45:{f:qk},46:{f:Jk},47:{f:Zk},48:{},49:{f:qw},50:{},51:{f:x5},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:Zm},62:{f:ME},63:{f:w5},64:{f:JE},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:Rr,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:ZE},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:CE},148:{f:TE,p:16},151:{f:GE},152:{},153:{f:m_},154:{},155:{},156:{f:x_},157:{},158:{},159:{T:1,f:xk},160:{T:-1},161:{T:1,f:vs},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:$E},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:h5},336:{T:-1},337:{f:m5,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:Bu},357:{},358:{},359:{},360:{T:1},361:{},362:{f:qm},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:YE},427:{f:KE},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:qE},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:SE},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:XE},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:Bu},551:{f:lc},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:N5},633:{T:1},634:{T:-1},635:{T:1,f:b5},636:{T:-1},637:{f:Jw},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:s_},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:e_},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},Vu={6:{f:du},10:{f:Da},12:{f:Vt},13:{f:Vt},14:{f:Gt},15:{f:Gt},16:{f:Fr},17:{f:Gt},18:{f:Gt},19:{f:Vt},20:{f:nx},21:{f:nx},23:{f:qm},24:{f:sx},25:{f:Gt},26:{},27:{},28:{f:A4},29:{},34:{f:Gt},35:{f:ax},38:{f:Fr},39:{f:Fr},40:{f:Fr},41:{f:Fr},42:{f:Gt},43:{f:Gt},47:{f:Rk},49:{f:l4},51:{f:Vt},60:{},61:{f:s4},64:{f:Gt},65:{f:o4},66:{f:Vt},77:{},80:{},81:{},82:{},85:{f:Vt},89:{},90:{},91:{},92:{f:qy},93:{f:I4},94:{},95:{f:Gt},96:{},97:{},99:{f:Gt},125:{f:Zm},128:{f:k4},129:{f:Zy},130:{f:Vt},131:{f:Gt},132:{f:Gt},133:{f:Jy},134:{},140:{f:L4},141:{f:Vt},144:{},146:{f:B4},151:{},152:{},153:{},154:{},155:{},156:{f:Vt},157:{},158:{},160:{f:W4},161:{f:z4},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:x4},190:{f:m4},193:{f:Da},197:{},198:{},199:{},200:{},201:{},202:{f:Gt},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:Vt},220:{},221:{f:Gt},222:{},224:{f:g4},225:{f:Qy},226:{f:Da},227:{},229:{f:F4},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:e4},253:{f:c4},255:{f:t4},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:Wm},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:Gt},353:{f:Da},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:T4},431:{f:Gt},432:{},433:{},434:{},437:{},438:{f:P4},439:{f:Gt},440:{f:O4},441:{},442:{f:po},443:{},444:{f:Vt},445:{},446:{},448:{f:Da},449:{f:a4,r:2},450:{f:Da},512:{f:rx},513:{f:V4},515:{f:_4},516:{f:u4},517:{f:E4},519:{f:$4},520:{f:r4},523:{},545:{f:ox},549:{f:tx},566:{},574:{f:i4},638:{f:h4},659:{},1048:{},1054:{f:f4},1084:{},1212:{f:C4},2048:{f:j4},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:Pl},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:Da},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:U4,r:12},2173:{f:f5,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:Gt,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:S4,r:12},2197:{},2198:{f:s5,r:12},2199:{},2200:{},2201:{},2202:{f:b4,r:12},2203:{f:Da},2204:{},2205:{},2206:{},2207:{},2211:{f:n4},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:Vt},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:H4},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:M4},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:rx},1:{},2:{f:K4},3:{f:Y4},4:{f:G4},5:{f:q4},7:{f:Q4},8:{},9:{f:Pl},11:{},22:{f:Vt},30:{f:d4},31:{},32:{},33:{f:ox},36:{},37:{f:tx},50:{f:Z4},62:{},52:{},67:{f:v4},68:{f:Vt},69:{},86:{},126:{},127:{f:X4},135:{},136:{},137:{},143:{f:ek},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:J4},223:{},234:{},354:{},421:{},518:{f:du},521:{f:Pl},536:{f:sx},547:{f:ax},561:{},579:{f:w4},1030:{f:du},1033:{f:Pl},1091:{f:y4},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},101:{},102:{},105:{},106:{},107:{},109:{},112:{},114:{},29282:{}};function en(e,r,t,a){var i=r;if(!isNaN(i)){var o=(t||[]).length||0,u=e.next(4);u.write_shift(2,i),u.write_shift(2,o),o>0&&Rm(t)&&e.push(t)}}function wx(e,r){var t=r||{},a=t.dense!=null?t.dense:b2,i={};a&&(i["!data"]=[]),e=xo(e,"<!--","-->");var o=e.match(/<table/i);if(!o)throw new Error("Invalid HTML: could not find <table>");var u=e.match(/<\/table/i),c=o.index,h=u&&u.index||e.length,x=mw(e.slice(c,h),/(:?<tr[^<>]*>)/i,"<tr>"),m=-1,w=0,p=0,v=0,y={s:{r:1e7,c:1e7},e:{r:0,c:0}},T=[];for(c=0;c<x.length;++c){var E=x[c].trim(),_=E.slice(0,3).toLowerCase();if(_=="<tr"){if(++m,t.sheetRows&&t.sheetRows<=m){--m;break}w=0;continue}if(!(_!="<td"&&_!="<th")){var C=E.split(/<\/t[dh]>/i);for(h=0;h<C.length;++h){var S=C[h].trim();if(S.match(/<t[dh]/i)){for(var N=S,B=0;N.charAt(0)=="<"&&(B=N.indexOf(">"))>-1;)N=N.slice(B+1);for(var X=0;X<T.length;++X){var j=T[X];j.s.c==w&&j.s.r<m&&m<=j.e.r&&(w=j.e.c+1,X=-1)}var z=Ze(S.slice(0,S.indexOf(">")));v=z.colspan?+z.colspan:1,((p=+z.rowspan)>1||v>1)&&T.push({s:{r:m,c:w},e:{r:m+(p||1)-1,c:w+v-1}});var M=z.t||z["data-t"]||"";if(!N.length){w+=v;continue}if(N=ym(N),y.s.r>m&&(y.s.r=m),y.e.r<m&&(y.e.r=m),y.s.c>w&&(y.s.c=w),y.e.c<w&&(y.e.c=w),!N.length){w+=v;continue}var U={t:"s",v:N};t.raw||!N.trim().length||M=="s"||(N==="TRUE"?U={t:"b",v:!0}:N==="FALSE"?U={t:"b",v:!1}:isNaN(an(N))?isNaN(so(N).getDate())?N.charCodeAt(0)==35&&vr[N]!=null&&(U.t="e",U.w=N,U.v=vr[N]):(U={t:"d",v:yr(N)},t.UTC===!1&&(U.v=xs(U.v)),t.cellDates||(U={t:"n",v:ar(U.v)}),U.z=t.dateNF||ht[14]):U={t:"n",v:an(N)}),U.cellText!==!1&&(U.w=N),a?(i["!data"][m]||(i["!data"][m]=[]),i["!data"][m][w]=U):i[Tt({r:m,c:w})]=U,w+=v}}}}return i["!ref"]=yt(y),T.length&&(i["!merges"]=T),i}function V_(e,r,t,a){for(var i=e["!merges"]||[],o=[],u={},c=e["!data"]!=null,h=r.s.c;h<=r.e.c;++h){for(var x=0,m=0,w=0;w<i.length;++w)if(!(i[w].s.r>t||i[w].s.c>h)&&!(i[w].e.r<t||i[w].e.c<h)){if(i[w].s.r<t||i[w].s.c<h){x=-1;break}x=i[w].e.r-i[w].s.r+1,m=i[w].e.c-i[w].s.c+1;break}if(!(x<0)){var p=Ct(h)+It(t),v=c?(e["!data"][t]||[])[h]:e[p];v&&v.t=="n"&&v.v!=null&&!isFinite(v.v)&&(isNaN(v.v)?v={t:"e",v:36,w:Kr[36]}:v={t:"e",v:7,w:Kr[7]});var y=v&&v.v!=null&&(v.h||$i(v.w||(za(v),v.w)||""))||"";u={},x>1&&(u.rowspan=x),m>1&&(u.colspan=m),a.editable?y='<span contenteditable="true">'+y+"</span>":v&&(u["data-t"]=v&&v.t||"z",v.v!=null&&(u["data-v"]=$i(v.v instanceof Date?v.v.toISOString():v.v)),v.z!=null&&(u["data-z"]=v.z),v.l&&(v.l.Target||"#").charAt(0)!="#"&&(y='<a href="'+$i(v.l.Target)+'">'+y+"</a>")),u.id=(a.id||"sjs")+"-"+p,o.push(Rw("td",y,u))}}var T="<tr>";return T+o.join("")+"</tr>"}var W_='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',$_="</body></html>";function X_(e,r){var t=vw(e,"table");if(!t||t.length==0)throw new Error("Invalid HTML: could not find <table>");if(t.length==1){var a=$a(wx(t[0],r),r);return a.bookType="html",a}var i=kf();return t.forEach(function(o,u){yo(i,wx(o,r),"Sheet"+(u+1))}),i.bookType="html",i}function G_(e,r,t){var a=[];return a.join("")+"<table"+(t&&t.id?' id="'+t.id+'"':"")+">"}function Y_(e,r){var t=r||{},a=t.header!=null?t.header:W_,i=t.footer!=null?t.footer:$_,o=[a],u=ps(e["!ref"]||"A1");if(o.push(G_(e,u,t)),e["!ref"])for(var c=u.s.r;c<=u.e.r;++c)o.push(V_(e,u,c,t));return o.push("</table>"+i),o.join("")}function _p(e,r,t){var a=r.rows;if(!a)throw"Unsupported origin when "+r.tagName+" is not a TABLE";var i=t||{},o=e["!data"]!=null,u=0,c=0;if(i.origin!=null)if(typeof i.origin=="number")u=i.origin;else{var h=typeof i.origin=="string"?Ir(i.origin):i.origin;u=h.r,c=h.c}var x=Math.min(i.sheetRows||1e7,a.length),m={s:{r:0,c:0},e:{r:u,c}};if(e["!ref"]){var w=ps(e["!ref"]);m.s.r=Math.min(m.s.r,w.s.r),m.s.c=Math.min(m.s.c,w.s.c),m.e.r=Math.max(m.e.r,w.e.r),m.e.c=Math.max(m.e.c,w.e.c),u==-1&&(m.e.r=u=w.e.r+1)}var p=[],v=0,y=e["!rows"]||(e["!rows"]=[]),T=0,E=0,_=0,C=0,S=0,N=0;for(e["!cols"]||(e["!cols"]=[]);T<a.length&&E<x;++T){var B=a[T];if(yx(B)){if(i.display)continue;y[E]={hidden:!0}}var X=B.cells;for(_=C=0;_<X.length;++_){var j=X[_];if(!(i.display&&yx(j))){var z=j.hasAttribute("data-v")?j.getAttribute("data-v"):j.hasAttribute("v")?j.getAttribute("v"):ym(j.innerHTML),M=j.getAttribute("data-z")||j.getAttribute("z");for(v=0;v<p.length;++v){var U=p[v];U.s.c==C+c&&U.s.r<E+u&&E+u<=U.e.r&&(C=U.e.c+1-c,v=-1)}N=+j.getAttribute("colspan")||1,((S=+j.getAttribute("rowspan")||1)>1||N>1)&&p.push({s:{r:E+u,c:C+c},e:{r:E+u+(S||1)-1,c:C+c+(N||1)-1}});var D={t:"s",v:z},R=j.getAttribute("data-t")||j.getAttribute("t")||"";z!=null&&(z.length==0?D.t=R||"z":i.raw||z.trim().length==0||R=="s"||(R=="e"&&Kr[+z]?D={t:"e",v:+z,w:Kr[+z]}:z==="TRUE"?D={t:"b",v:!0}:z==="FALSE"?D={t:"b",v:!1}:isNaN(an(z))?isNaN(so(z).getDate())?z.charCodeAt(0)==35&&vr[z]!=null&&(D={t:"e",v:vr[z],w:z}):(D={t:"d",v:yr(z)},i.UTC&&(D.v=ic(D.v)),i.cellDates||(D={t:"n",v:ar(D.v)}),D.z=i.dateNF||ht[14]):D={t:"n",v:an(z)})),D.z===void 0&&M!=null&&(D.z=M);var K="",ae=j.getElementsByTagName("A");if(ae&&ae.length)for(var te=0;te<ae.length&&!(ae[te].hasAttribute("href")&&(K=ae[te].getAttribute("href"),K.charAt(0)!="#"));++te);K&&K.charAt(0)!="#"&&K.slice(0,11).toLowerCase()!="javascript:"&&(D.l={Target:K}),o?(e["!data"][E+u]||(e["!data"][E+u]=[]),e["!data"][E+u][C+c]=D):e[Tt({c:C+c,r:E+u})]=D,m.e.c<C+c&&(m.e.c=C+c),C+=N}}++E}return p.length&&(e["!merges"]=(e["!merges"]||[]).concat(p)),m.e.r=Math.max(m.e.r,E-1+u),e["!ref"]=yt(m),E>=x&&(e["!fullref"]=yt((m.e.r=a.length-T+E-1+u,m))),e}function Tp(e,r){var t=r||{},a={};return t.dense&&(a["!data"]=[]),_p(a,e,r)}function K_(e,r){var t=$a(Tp(e,r),r);return t}function yx(e){var r="",t=Q_(e);return t&&(r=t(e).getPropertyValue("display")),r||(r=e.style&&e.style.display),r==="none"}function Q_(e){return e.ownerDocument.defaultView&&typeof e.ownerDocument.defaultView.getComputedStyle=="function"?e.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function q_(e){var r=e.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(a,i){return Array(parseInt(i,10)+1).join(" ")}).replace(/<text:tab[^<>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),t=wt(r.replace(/<[^<>]*>/g,""));return[t]}function Sp(e,r,t){var a=t||{},i=oc(e);Zt.lastIndex=0,i=af(xo(i,"<!--","-->"));for(var o,u,c="",h="",x,m=0,w=-1,p="";o=Zt.exec(i);)switch(o[3]=o[3].replace(/_[\s\S]*$/,"")){case"number-style":case"currency-style":case"percentage-style":case"date-style":case"time-style":case"text-style":o[1]==="/"?(u["truncate-on-overflow"]=="false"&&(c.match(/h/)?c=c.replace(/h+/,"[$&]"):c.match(/m/)?c=c.replace(/m+/,"[$&]"):c.match(/s/)&&(c=c.replace(/s+/,"[$&]"))),a[u.name]=c,c=""):o[0].charAt(o[0].length-2)!=="/"&&(c="",u=Ze(o[0],!1));break;case"boolean-style":o[1]==="/"?(a[u.name]="General",c=""):o[0].charAt(o[0].length-2)!=="/"&&(c="",u=Ze(o[0],!1));break;case"boolean":c+="General";break;case"text":o[1]==="/"?(p=i.slice(w,Zt.lastIndex-o[0].length),p=="%"&&u[0]=="<number:percentage-style"?c+="%":c+='"'+p.replace(/"/g,'""')+'"'):o[0].charAt(o[0].length-2)!=="/"&&(w=Zt.lastIndex);break;case"day":switch(x=Ze(o[0],!1),x.style){case"short":c+="d";break;case"long":c+="dd";break;default:c+="dd";break}break;case"day-of-week":switch(x=Ze(o[0],!1),x.style){case"short":c+="ddd";break;case"long":c+="dddd";break;default:c+="ddd";break}break;case"era":switch(x=Ze(o[0],!1),x.style){case"short":c+="ee";break;case"long":c+="eeee";break;default:c+="eeee";break}break;case"hours":switch(x=Ze(o[0],!1),x.style){case"short":c+="h";break;case"long":c+="hh";break;default:c+="hh";break}break;case"minutes":switch(x=Ze(o[0],!1),x.style){case"short":c+="m";break;case"long":c+="mm";break;default:c+="mm";break}break;case"month":switch(x=Ze(o[0],!1),x.textual&&(c+="mm"),x.style){case"short":c+="m";break;case"long":c+="mm";break;default:c+="m";break}break;case"seconds":{switch(x=Ze(o[0],!1),x.style){case"short":c+="s";break;case"long":c+="ss";break;default:c+="ss";break}x["decimal-places"]&&(c+="."+kt("0",+x["decimal-places"]))}break;case"year":switch(x=Ze(o[0],!1),x.style){case"short":c+="yy";break;case"long":c+="yyyy";break;default:c+="yy";break}break;case"am-pm":c+="AM/PM";break;case"week-of-year":case"quarter":console.error("Excel does not support ODS format token "+o[3]);break;case"fill-character":o[1]==="/"?(p=i.slice(w,Zt.lastIndex-o[0].length),c+='"'+p.replace(/"/g,'""')+'"*'):o[0].charAt(o[0].length-2)!=="/"&&(w=Zt.lastIndex);break;case"scientific-number":x=Ze(o[0],!1),c+="0."+kt("0",+x["min-decimal-places"]||+x["decimal-places"]||2)+kt("?",+x["decimal-places"]-+x["min-decimal-places"]||0)+"E"+(Ft(x["forced-exponent-sign"])?"+":"")+kt("0",+x["min-exponent-digits"]||2);break;case"fraction":x=Ze(o[0],!1),+x["min-integer-digits"]?c+=kt("0",+x["min-integer-digits"]):c+="#",c+=" ",c+=kt("?",+x["min-numerator-digits"]||1),c+="/",+x["denominator-value"]?c+=x["denominator-value"]:c+=kt("?",+x["min-denominator-digits"]||1);break;case"currency-symbol":o[1]==="/"?c+='"'+i.slice(w,Zt.lastIndex-o[0].length).replace(/"/g,'""')+'"':o[0].charAt(o[0].length-2)!=="/"?w=Zt.lastIndex:c+="$";break;case"text-properties":switch(x=Ze(o[0],!1),(x.color||"").toLowerCase().replace("#","")){case"ff0000":case"red":c="[Red]"+c;break}break;case"text-content":c+="@";break;case"map":x=Ze(o[0],!1),wt(x.condition)=="value()>=0"?c=a[x["apply-style-name"]]+";"+c:console.error("ODS number format may be incorrect: "+x.condition);break;case"number":if(o[1]==="/")break;x=Ze(o[0],!1),h="",h+=kt("0",+x["min-integer-digits"]||1),Ft(x.grouping)&&(h=sa(kt("#",Math.max(0,4-h.length))+h)),(+x["min-decimal-places"]||+x["decimal-places"])&&(h+="."),+x["min-decimal-places"]&&(h+=kt("0",+x["min-decimal-places"]||1)),+x["decimal-places"]-(+x["min-decimal-places"]||0)&&(h+=kt("0",+x["decimal-places"]-(+x["min-decimal-places"]||0))),c+=h;break;case"embedded-text":o[1]==="/"?m==0?c+='"'+i.slice(w,Zt.lastIndex-o[0].length).replace(/"/g,'""')+'"':c=c.slice(0,m)+'"'+i.slice(w,Zt.lastIndex-o[0].length).replace(/"/g,'""')+'"'+c.slice(m):o[0].charAt(o[0].length-2)!=="/"&&(w=Zt.lastIndex,m=-+Ze(o[0],!1).position||0);break}return a}function Cp(e,r,t){var a=r||{},i=oc(e),o=[],u,c,h,x="",m=0,w,p,v={},y=[],T={};a.dense&&(T["!data"]=[]);var E,_,C={value:""},S={},N="",B=0,X="",j=0,z=[],M=[],U=-1,D=-1,R={s:{r:1e6,c:1e7},e:{r:0,c:0}},K=0,ae=t||{},te={},oe=[],re={},Z=0,ge=0,q=[],Q=1,ie=1,ve=[],pe={Names:[],WBProps:{}},Ae={},je=["",""],ze=[],P={},ee="",J=0,G=!1,_e=!1,F=0;for(Zt.lastIndex=0,i=af(xo(i,"<!--","-->"));E=Zt.exec(i);)switch(E[3]=E[3].replace(/_[\s\S]*$/,"")){case"table":case"":E[1]==="/"?(R.e.c>=R.s.c&&R.e.r>=R.s.r?T["!ref"]=yt(R):T["!ref"]="A1:A1",a.sheetRows>0&&a.sheetRows<=R.e.r&&(T["!fullref"]=T["!ref"],R.e.r=a.sheetRows-1,T["!ref"]=yt(R)),oe.length&&(T["!merges"]=oe),q.length&&(T["!rows"]=q),w.name=w.||w.name,typeof JSON<"u"&&JSON.stringify(w),y.push(w.name),v[w.name]=T,_e=!1):E[0].charAt(E[0].length-2)!=="/"&&(w=Ze(E[0],!1),U=D=-1,R.s.r=R.s.c=1e7,R.e.r=R.e.c=0,T={},a.dense&&(T["!data"]=[]),oe=[],q=[],_e=!0);break;case"table-row-group":E[1]==="/"?--K:++K;break;case"table-row":case"":if(E[1]==="/"){U+=Q,Q=1;break}if(p=Ze(E[0],!1),p.?U=p.-1:U==-1&&(U=0),Q=+p["number-rows-repeated"]||1,Q<10)for(F=0;F<Q;++F)K>0&&(q[U+F]={level:K});D=-1;break;case"covered-table-cell":if(E[1]!=="/")if(++D,C=Ze(E[0],!1),ie=parseInt(C["number-columns-repeated"]||"1",10)||1,a.sheetStubs){for(;ie-- >0;)a.dense?(T["!data"][U]||(T["!data"][U]=[]),T["!data"][U][D]={t:"z"}):T[Tt({r:U,c:D})]={t:"z"},++D;--D}else D+=ie-1;N="",z=[];break;case"table-cell":case"":if(E[0].charAt(E[0].length-2)==="/")++D,C=Ze(E[0],!1),ie=parseInt(C["number-columns-repeated"]||"1",10)||1,_={t:"z",v:null},C.formula&&a.cellFormula!=!1&&(_.f=mx(wt(C.formula))),C["style-name"]&&te[C["style-name"]]&&(_.z=te[C["style-name"]]),(C.||C["value-type"])=="string"&&(_.t="s",_.v=wt(C["string-value"]||""),a.dense?(T["!data"][U]||(T["!data"][U]=[]),T["!data"][U][D]=_):T[Ct(D)+It(U)]=_),D+=ie-1;else if(E[1]!=="/"){++D,N=X="",B=j=0,z=[],M=[],ie=1;var ke=Q?U+Q-1:U;if(D>R.e.c&&(R.e.c=D),D<R.s.c&&(R.s.c=D),U<R.s.r&&(R.s.r=U),ke>R.e.r&&(R.e.r=ke),C=Ze(E[0],!1),S=Sw(E[0]),ze=[],P={},_={t:C.||C["value-type"],v:null},C["style-name"]&&te[C["style-name"]]&&(_.z=te[C["style-name"]]),a.cellFormula)if(C.formula&&(C.formula=wt(C.formula)),C["number-matrix-columns-spanned"]&&C["number-matrix-rows-spanned"]&&(Z=parseInt(C["number-matrix-rows-spanned"],10)||0,ge=parseInt(C["number-matrix-columns-spanned"],10)||0,re={s:{r:U,c:D},e:{r:U+Z-1,c:D+ge-1}},_.F=yt(re),ve.push([re,_.F])),C.formula)_.f=mx(C.formula);else for(F=0;F<ve.length;++F)U>=ve[F][0].s.r&&U<=ve[F][0].e.r&&D>=ve[F][0].s.c&&D<=ve[F][0].e.c&&(_.F=ve[F][1]);switch((C["number-columns-spanned"]||C["number-rows-spanned"])&&(Z=parseInt(C["number-rows-spanned"]||"1",10)||1,ge=parseInt(C["number-columns-spanned"]||"1",10)||1,Z*ge>1&&(re={s:{r:U,c:D},e:{r:U+Z-1,c:D+ge-1}},oe.push(re))),C["number-columns-repeated"]&&(ie=parseInt(C["number-columns-repeated"],10)),_.t){case"boolean":_.t="b",_.v=Ft(C["boolean-value"])||+C["boolean-value"]>=1;break;case"float":_.t="n",_.v=parseFloat(C.value),a.cellDates&&_.z&&Mn(_.z)&&(_.v=Ma(_.v+(pe.WBProps.date1904?1462:0)),_.t=typeof _.v=="number"?"n":"d");break;case"percentage":_.t="n",_.v=parseFloat(C.value);break;case"currency":_.t="n",_.v=parseFloat(C.value);break;case"date":_.t="d",_.v=yr(C["date-value"],pe.WBProps.date1904),a.cellDates||(_.t="n",_.v=ar(_.v,pe.WBProps.date1904)),_.z||(_.z="m/d/yy");break;case"time":_.t="n",_.v=sw(C["time-value"])/86400,a.cellDates&&(_.v=Ma(_.v),_.t=typeof _.v=="number"?"n":"d"),_.z||(_.z="HH:MM:SS");break;case"number":_.t="n",_.v=parseFloat(C.);break;default:if(_.t==="string"||_.t==="text"||!_.t)_.t="s",C["string-value"]!=null&&(N=wt(C["string-value"]),z=[]);else throw new Error("Unsupported value type "+_.t)}}else{if(G=!1,S["calcext:value-type"]=="error"&&vr[N]!=null&&(_.t="e",_.w=N,_.v=vr[N]),_.t==="s"&&(_.v=N||"",z.length&&(_.R=z),G=B==0),Ae.Target&&(_.l=Ae),ze.length>0&&(_.c=ze,ze=[]),N&&a.cellText!==!1&&(_.w=N),G&&(_.t="z",delete _.v),(!G||a.sheetStubs)&&!(a.sheetRows&&a.sheetRows<=U))for(var Fe=0;Fe<Q;++Fe){if(ie=parseInt(C["number-columns-repeated"]||"1",10),a.dense)for(T["!data"][U+Fe]||(T["!data"][U+Fe]=[]),T["!data"][U+Fe][D]=Fe==0?_:er(_);--ie>0;)T["!data"][U+Fe][D+ie]=er(_);else for(T[Tt({r:U+Fe,c:D})]=_;--ie>0;)T[Tt({r:U+Fe,c:D+ie})]=er(_);R.e.c<=D&&(R.e.c=D)}ie=parseInt(C["number-columns-repeated"]||"1",10),D+=ie-1,ie=0,_={},N="",z=[]}Ae={};break;case"document":case"document-content":case"":case"spreadsheet":case"":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(E[1]==="/"){if((u=o.pop())[0]!==E[3])throw"Bad state: "+u}else E[0].charAt(E[0].length-2)!=="/"&&o.push([E[3],!0]);break;case"annotation":if(E[1]==="/"){if((u=o.pop())[0]!==E[3])throw"Bad state: "+u;P.t=N,z.length&&(P.R=z),P.a=ee,ze.push(P),N=X,B=j,z=M}else if(E[0].charAt(E[0].length-2)!=="/"){o.push([E[3],!1]);var De=Ze(E[0],!0);De.display&&Ft(De.display)||(ze.hidden=!0),X=N,j=B,M=z,N="",B=0,z=[]}ee="",J=0;break;case"creator":E[1]==="/"?ee=i.slice(J,E.index):J=E.index+E[0].length;break;case"meta":case"":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(E[1]==="/"){if((u=o.pop())[0]!==E[3])throw"Bad state: "+u}else E[0].charAt(E[0].length-2)!=="/"&&o.push([E[3],!1]);N="",B=0,z=[];break;case"scientific-number":case"currency-symbol":case"fill-character":break;case"text-style":case"boolean-style":case"number-style":case"currency-style":case"percentage-style":case"date-style":case"time-style":if(E[1]==="/"){var Ge=Zt.lastIndex;Sp(i.slice(h,Zt.lastIndex),r,ae),Zt.lastIndex=Ge}else E[0].charAt(E[0].length-2)!=="/"&&(h=Zt.lastIndex-E[0].length);break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":{var Ve=Ze(E[0],!1);Ve.family=="table-cell"&&ae[Ve["data-style-name"]]&&(te[Ve.name]=ae[Ve["data-style-name"]])}break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":break;case"boolean":break;case"text":if(E[0].slice(-2)==="/>")break;if(E[1]==="/")switch(o[o.length-1][0]){case"number-style":case"date-style":case"time-style":x+=i.slice(m,E.index);break}else m=E.index+E[0].length;break;case"named-range":c=Ze(E[0],!1),je=hu(c["cell-range-address"]);var tt={Name:c.name,Ref:je[0]+"!"+je[1]};_e&&(tt.Sheet=y.length),pe.Names.push(tt);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":switch(c=Ze(E[0],!1),c["date-value"]){case"1904-01-01":pe.WBProps.date1904=!0;break}break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"":if(["master-styles"].indexOf(o[o.length-1][0])>-1)break;if(E[1]==="/"&&(!C||!C["string-value"])){var ft=q_(i.slice(B,E.index));N=(N.length>0?N+`
`:"")+ft[0]}else E[0].slice(-2)=="/>"?N+=`
`:(Ze(E[0],!1),B=E.index+E[0].length);break;case"s":break;case"database-range":if(E[1]==="/")break;try{je=hu(Ze(E[0])["target-range-address"]),v[je[0]]["!autofilter"]={ref:je[1]}}catch{}break;case"date":break;case"object":break;case"title":case"":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"filter-set-item":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(E[1]!=="/"){if(Ae=Ze(E[0],!1),!Ae.href)break;Ae.Target=wt(Ae.href),delete Ae.href,Ae.Target.charAt(0)=="#"&&Ae.Target.indexOf(".")>-1?(je=hu(Ae.Target.slice(1)),Ae.Target="#"+je[0]+"!"+je[1]):Ae.Target.match(/^\.\.[\\\/]/)&&(Ae.Target=Ae.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(E[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case":":case":":break;default:if(a.WTF)throw new Error(E)}}var st={Sheets:v,SheetNames:y,Workbook:pe};return a.bookSheets&&delete st.Sheets,st}function kx(e,r){r=r||{},yn(e,"META-INF/manifest.xml")&&wy(qt(e,"META-INF/manifest.xml"),r);var t=Mr(e,"styles.xml"),a=t&&Sp(Pt(t)),i=Mr(e,"content.xml");if(!i)throw new Error("Missing content.xml in ODS / UOF file");var o=Cp(Pt(i),r,a);return yn(e,"meta.xml")&&(o.Props=Um(qt(e,"meta.xml"))),o.bookType="ods",o}function Ex(e,r){var t=Cp(e,r);return t.bookType="fods",t}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */var wr=(function(){try{return typeof Uint8Array>"u"||typeof Uint8Array.prototype.subarray>"u"?"slice":typeof Buffer<"u"?typeof Buffer.prototype.subarray>"u"?"slice":(typeof Buffer.from=="function"?Buffer.from([72,62]):new Buffer([72,62]))instanceof Uint8Array?"subarray":"slice":"subarray"}catch{return"slice"}})();function co(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function Ks(e){return typeof TextDecoder<"u"?new TextDecoder().decode(e):Pt(ca(e))}function bp(e){for(var r=0,t=0;t<e.length;++t)r+=e[t].length;var a=new Uint8Array(r),i=0;for(t=0;t<e.length;++t){var o=e[t],u=o.length;if(u<250)for(var c=0;c<u;++c)a[i++]=o[c];else a.set(o,i),i+=u}return a}function to(e){return e-=e>>1&1431655765,e=(e&858993459)+(e>>2&858993459),(e+(e>>4)&252645135)*16843009>>>24}function Z_(e,r){for(var t=(e[r+15]&127)<<7|e[r+14]>>1,a=e[r+14]&1,i=r+13;i>=r;--i)a=a*256+e[i];return(e[r+15]&128?-a:a)*Math.pow(10,t-6176)}function tc(e,r){var t=r.l,a=e[t]&127;e:if(e[t++]>=128&&(a|=(e[t]&127)<<7,e[t++]<128||(a|=(e[t]&127)<<14,e[t++]<128)||(a|=(e[t]&127)<<21,e[t++]<128)||(a+=(e[t]&127)*Math.pow(2,28),++t,e[t++]<128)||(a+=(e[t]&127)*Math.pow(2,35),++t,e[t++]<128)||(a+=(e[t]&127)*Math.pow(2,42),++t,e[t++]<128)))break e;return r.l=t,a}function _t(e){var r=0,t=e[r]&127;return e[r++]<128||(t|=(e[r]&127)<<7,e[r++]<128)||(t|=(e[r]&127)<<14,e[r++]<128)||(t|=(e[r]&127)<<21,e[r++]<128)||(t|=(e[r]&15)<<28),t}function gt(e){for(var r=[],t={l:0};t.l<e.length;){var a=t.l,i=tc(e,t),o=i&7;i=i/8|0;var u,c=t.l;switch(o){case 0:{for(;e[c++]>=128;);u=e[wr](t.l,c),t.l=c}break;case 1:u=e[wr](c,c+8),t.l=c+8;break;case 2:{var h=tc(e,t);u=e[wr](t.l,t.l+h),t.l+=h}break;case 5:u=e[wr](c,c+4),t.l=c+4;break;default:throw new Error("PB Type ".concat(o," for Field ").concat(i," at offset ").concat(a))}var x={data:u,type:o};r[i]==null&&(r[i]=[]),r[i].push(x)}return r}function hc(e,r){return(e==null?void 0:e.map(function(t){return r(t.data)}))||[]}function J_(e){for(var r,t=[],a={l:0};a.l<e.length;){var i=tc(e,a),o=gt(e[wr](a.l,a.l+i));a.l+=i;var u={id:_t(o[1][0].data),messages:[]};o[2].forEach(function(c){var h=gt(c.data),x=_t(h[3][0].data);u.messages.push({meta:h,data:e[wr](a.l,a.l+x)}),a.l+=x}),(r=o[3])!=null&&r[0]&&(u.merge=_t(o[3][0].data)>>>0>0),t.push(u)}return t}function eT(e,r){if(e!=0)throw new Error("Unexpected Snappy chunk type ".concat(e));for(var t={l:0},a=tc(r,t),i=[],o=t.l;o<r.length;){var u=r[o]&3;if(u==0){var c=r[o++]>>2;if(c<60)++c;else{var h=c-59;c=r[o],h>1&&(c|=r[o+1]<<8),h>2&&(c|=r[o+2]<<16),h>3&&(c|=r[o+3]<<24),c>>>=0,c++,o+=h}i.push(r[wr](o,o+c)),o+=c;continue}else{var x=0,m=0;if(u==1?(m=(r[o]>>2&7)+4,x=(r[o++]&224)<<3,x|=r[o++]):(m=(r[o++]>>2)+1,u==2?(x=r[o]|r[o+1]<<8,o+=2):(x=(r[o]|r[o+1]<<8|r[o+2]<<16|r[o+3]<<24)>>>0,o+=4)),x==0)throw new Error("Invalid offset 0");for(var w=i.length-1,p=x;w>=0&&p>=i[w].length;)p-=i[w].length,--w;if(w<0)if(p==0)p=i[w=0].length;else throw new Error("Invalid offset beyond length");if(m<p)i.push(i[w][wr](i[w].length-p,i[w].length-p+m));else{for(p>0&&(i.push(i[w][wr](i[w].length-p)),m-=p),++w;m>=i[w].length;)i.push(i[w]),m-=i[w].length,++w;m&&i.push(i[w][wr](0,m))}i.length>25&&(i=[bp(i)])}}for(var v=0,y=0;y<i.length;++y)v+=i[y].length;if(v!=a)throw new Error("Unexpected length: ".concat(v," != ").concat(a));return i}function tT(e){Array.isArray(e)&&(e=new Uint8Array(e));for(var r=[],t=0;t<e.length;){var a=e[t++],i=e[t]|e[t+1]<<8|e[t+2]<<16;t+=3,r.push.apply(r,eT(a,e[wr](t,t+i))),t+=i}if(t!==e.length)throw new Error("data is not a valid framed stream!");return r.length==1?r[0]:bp(r)}var rT=function(){return{sst:[],rsst:[],ofmt:[],nfmt:[],fmla:[],ferr:[],cmnt:[]}};function Np(e,r,t,a,i){var o,u,c,h,x=r&255,m=r>>8,w=m>=5?i:a;e:if(t&(m>4?8:4)&&e.t=="n"&&x==7){var p=(o=w[7])!=null&&o[0]?_t(w[7][0].data):-1;if(p==-1)break e;var v=(u=w[15])!=null&&u[0]?_t(w[15][0].data):-1,y=(c=w[16])!=null&&c[0]?_t(w[16][0].data):-1,T=(h=w[40])!=null&&h[0]?_t(w[40][0].data):-1,E=e.v,_=E;t:if(T){if(E==0){v=y=2;break t}E>=604800?v=1:E>=86400?v=2:E>=3600?v=4:E>=60?v=8:E>=1?v=16:v=32,Math.floor(E)!=E?y=32:E%60?y=16:E%3600?y=8:E%86400?y=4:E%604800&&(y=2),y<v&&(y=v)}if(v==-1||y==-1)break e;var C=[],S=[];v==1&&(_=E/604800,y==1?S.push('d"d"'):(_|=0,E-=604800*_),C.push(_+(p==2?" week"+(_==1?"":"s"):p==1?"w":""))),v<=2&&y>=2&&(_=E/86400,y>2&&(_|=0,E-=86400*_),S.push('d"d"'),C.push(_+(p==2?" day"+(_==1?"":"s"):p==1?"d":""))),v<=4&&y>=4&&(_=E/3600,y>4&&(_|=0,E-=3600*_),S.push((v>=4?"[h]":"h")+'"h"'),C.push(_+(p==2?" hour"+(_==1?"":"s"):p==1?"h":""))),v<=8&&y>=8&&(_=E/60,y>8&&(_|=0,E-=60*_),S.push((v>=8?"[m]":"m")+'"m"'),p==0?C.push((v==8&&y==8||_>=10?"":"0")+_):C.push(_+(p==2?" minute"+(_==1?"":"s"):p==1?"m":""))),v<=16&&y>=16&&(_=E,y>16&&(_|=0,E-=_),S.push((v>=16?"[s]":"s")+'"s"'),p==0?C.push((y==16&&v==16||_>=10?"":"0")+_):C.push(_+(p==2?" second"+(_==1?"":"s"):p==1?"s":""))),y>=32&&(_=Math.round(1e3*E),v<32&&S.push('.000"ms"'),p==0?C.push((_>=100?"":_>=10?"0":"00")+_):C.push(_+(p==2?" millisecond"+(_==1?"":"s"):p==1?"ms":""))),e.w=C.join(p==0?":":" "),e.z=S.join(p==0?'":"':" "),p==0&&(e.w=e.w.replace(/:(\d\d\d)$/,".$1"))}}function nT(e,r,t,a){var i=co(e),o=i.getUint32(4,!0),u=-1,c=-1,h=-1,x=NaN,m=0,w=new Date(Date.UTC(2001,0,1)),p=t>1?12:8;o&2&&(h=i.getUint32(p,!0),p+=4),p+=to(o&(t>1?3468:396))*4,o&512&&(u=i.getUint32(p,!0),p+=4),p+=to(o&(t>1?12288:4096))*4,o&16&&(c=i.getUint32(p,!0),p+=4),o&32&&(x=i.getFloat64(p,!0),p+=8),o&64&&(w.setTime(w.getTime()+(m=i.getFloat64(p,!0))*1e3),p+=8),t>1&&(o=i.getUint32(8,!0)>>>16,o&255&&(h==-1&&(h=i.getUint32(p,!0)),p+=4));var v,y=e[t>=4?1:2];switch(y){case 0:return;case 2:v={t:"n",v:x};break;case 3:v={t:"s",v:r.sst[c]};break;case 5:a!=null&&a.cellDates?v={t:"d",v:w}:v={t:"n",v:m/86400+35430,z:ht[14]};break;case 6:v={t:"b",v:x>0};break;case 7:v={t:"n",v:x};break;case 8:v={t:"e",v:0};break;case 9:if(u>-1){var T=r.rsst[u];v={t:"s",v:T.v},T.l&&(v.l={Target:T.l})}else throw new Error("Unsupported cell type ".concat(e[wr](0,4)));break;default:throw new Error("Unsupported cell type ".concat(e[wr](0,4)))}return h>-1&&Np(v,y|t<<8,o,r.ofmt[h],r.nfmt[h]),y==7&&(v.v/=86400),v}function aT(e,r,t){var a=co(e);a.getUint32(4,!0);var i=a.getUint32(8,!0),o=12,u=-1,c=-1,h=-1,x=NaN,m=NaN,w=0,p=new Date(Date.UTC(2001,0,1));i&1&&(x=Z_(e,o),o+=16),i&2&&(m=a.getFloat64(o,!0),o+=8),i&4&&(p.setTime(p.getTime()+(w=a.getFloat64(o,!0))*1e3),o+=8),i&8&&(c=a.getUint32(o,!0),o+=4),i&16&&(u=a.getUint32(o,!0),o+=4),o+=to(i&480)*4,i&512&&(a.getUint32(o,!0),o+=4),o+=to(i&1024)*4,i&2048&&(a.getUint32(o,!0),o+=4);var v,y=e[1];switch(y){case 0:v={t:"z"};break;case 2:v={t:"n",v:x};break;case 3:v={t:"s",v:r.sst[c]};break;case 5:t!=null&&t.cellDates?v={t:"d",v:p}:v={t:"n",v:w/86400+35430,z:ht[14]};break;case 6:v={t:"b",v:m>0};break;case 7:v={t:"n",v:m};break;case 8:v={t:"e",v:0};break;case 9:if(u>-1){var T=r.rsst[u];v={t:"s",v:T.v},T.l&&(v.l={Target:T.l})}else throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(i&31," : ").concat(e[wr](0,4)));break;case 10:v={t:"n",v:x};break;default:throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(i&31," : ").concat(e[wr](0,4)))}if(o+=to(i&4096)*4,i&516096&&(h==-1&&(h=a.getUint32(o,!0)),o+=4),i&524288){var E=a.getUint32(o,!0);o+=4,r.cmnt[E]&&(v.c=lT(r.cmnt[E]))}return h>-1&&Np(v,y|1280,i>>13,r.ofmt[h],r.nfmt[h]),y==7&&(v.v/=86400),v}function sT(e,r,t){switch(e[0]){case 0:case 1:case 2:case 3:case 4:return nT(e,r,e[0],t);case 5:return aT(e,r,t);default:throw new Error("Unsupported payload version ".concat(e[0]))}}function fr(e){var r=gt(e);return _t(r[1][0].data)}function ss(e,r){var t=gt(r.data),a=_t(t[1][0].data),i=t[3],o=[];return(i||[]).forEach(function(u){var c,h,x=gt(u.data);if(x[1]){var m=_t(x[1][0].data)>>>0;switch(a){case 1:o[m]=Ks(x[3][0].data);break;case 8:{var w=e[fr(x[9][0].data)][0],p=gt(w.data),v=e[fr(p[1][0].data)][0],y=_t(v.meta[1][0].data);if(y!=2001)throw new Error("2000 unexpected reference to ".concat(y));var T=gt(v.data),E={v:T[3].map(function(S){return Ks(S.data)}).join("")};o[m]=E;e:if((c=T==null?void 0:T[11])!=null&&c[0]){var _=(h=gt(T[11][0].data))==null?void 0:h[1];if(!_)break e;_.forEach(function(S){var N,B,X,j=gt(S.data);if((N=j[2])!=null&&N[0]){var z=e[fr((B=j[2])==null?void 0:B[0].data)][0],M=_t(z.meta[1][0].data);switch(M){case 2032:var U=gt(z.data);(X=U==null?void 0:U[2])!=null&&X[0]&&!E.l&&(E.l=Ks(U[2][0].data));break;case 2039:break;default:console.log("unrecognized ObjectAttribute type ".concat(M))}}})}}break;case 2:o[m]=gt(x[6][0].data);break;case 3:o[m]=gt(x[5][0].data);break;case 10:{var C=e[fr(x[10][0].data)][0];o[m]=Ap(e,C.data)}break;default:throw a}}}),o}function iT(e,r){var t,a,i,o,u,c,h,x,m,w,p,v,y,T,E=gt(e),_=_t(E[1][0].data)>>>0,C=_t(E[2][0].data)>>>0,S=((a=(t=E[8])==null?void 0:t[0])==null?void 0:a.data)&&_t(E[8][0].data)>0||!1,N,B;if((o=(i=E[7])==null?void 0:i[0])!=null&&o.data&&r!=0)N=(c=(u=E[7])==null?void 0:u[0])==null?void 0:c.data,B=(x=(h=E[6])==null?void 0:h[0])==null?void 0:x.data;else if((w=(m=E[4])==null?void 0:m[0])!=null&&w.data&&r!=1)N=(v=(p=E[4])==null?void 0:p[0])==null?void 0:v.data,B=(T=(y=E[3])==null?void 0:y[0])==null?void 0:T.data;else throw"NUMBERS Tile missing ".concat(r," cell storage");for(var X=S?4:1,j=co(N),z=[],M=0;M<N.length/2;++M){var U=j.getUint16(M*2,!0);U<65535&&z.push([M,U])}if(z.length!=C)throw"Expected ".concat(C," cells, found ").concat(z.length);var D=[];for(M=0;M<z.length-1;++M)D[z[M][0]]=B[wr](z[M][1]*X,z[M+1][1]*X);return z.length>=1&&(D[z[z.length-1][0]]=B[wr](z[z.length-1][1]*X)),{R:_,cells:D}}function oT(e,r){var t,a=gt(r.data),i=-1;(t=a==null?void 0:a[7])!=null&&t[0]&&(_t(a[7][0].data)>>>0?i=1:i=0);var o=hc(a[5],function(u){return iT(u,i)});return{nrows:_t(a[4][0].data)>>>0,data:o.reduce(function(u,c){return u[c.R]||(u[c.R]=[]),c.cells.forEach(function(h,x){if(u[c.R][x])throw new Error("Duplicate cell r=".concat(c.R," c=").concat(x));u[c.R][x]=h}),u},[])}}function Ap(e,r){var t,a,i,o,u,c,h,x,m,w,p={t:"",a:""},v=gt(r);if((a=(t=v==null?void 0:v[1])==null?void 0:t[0])!=null&&a.data&&(p.t=Ks((o=(i=v==null?void 0:v[1])==null?void 0:i[0])==null?void 0:o.data)||""),(c=(u=v==null?void 0:v[3])==null?void 0:u[0])!=null&&c.data){var y=e[fr((x=(h=v==null?void 0:v[3])==null?void 0:h[0])==null?void 0:x.data)][0],T=gt(y.data);(w=(m=T[1])==null?void 0:m[0])!=null&&w.data&&(p.a=Ks(T[1][0].data))}return v!=null&&v[4]&&(p.replies=[],v[4].forEach(function(E){var _=e[fr(E.data)][0];p.replies.push(Ap(e,_.data))})),p}function lT(e){var r=[];return r.push({t:e.t||"",a:e.a,T:e.replies&&e.replies.length>0}),e.replies&&e.replies.forEach(function(t){r.push({t:t.t||"",a:t.a,T:!0})}),r}function cT(e,r,t,a){var i,o,u,c,h,x,m,w,p,v,y,T,E,_,C=gt(r.data),S={s:{r:0,c:0},e:{r:0,c:0}};if(S.e.r=(_t(C[6][0].data)>>>0)-1,S.e.r<0)throw new Error("Invalid row varint ".concat(C[6][0].data));if(S.e.c=(_t(C[7][0].data)>>>0)-1,S.e.c<0)throw new Error("Invalid col varint ".concat(C[7][0].data));t["!ref"]=yt(S);var N=t["!data"]!=null,B=t,X=gt(C[4][0].data),j=rT();(i=X[4])!=null&&i[0]&&(j.sst=ss(e,e[fr(X[4][0].data)][0])),(o=X[6])!=null&&o[0]&&(j.fmla=ss(e,e[fr(X[6][0].data)][0])),(u=X[11])!=null&&u[0]&&(j.ofmt=ss(e,e[fr(X[11][0].data)][0])),(c=X[12])!=null&&c[0]&&(j.ferr=ss(e,e[fr(X[12][0].data)][0])),(h=X[17])!=null&&h[0]&&(j.rsst=ss(e,e[fr(X[17][0].data)][0])),(x=X[19])!=null&&x[0]&&(j.cmnt=ss(e,e[fr(X[19][0].data)][0])),(m=X[22])!=null&&m[0]&&(j.nfmt=ss(e,e[fr(X[22][0].data)][0]));var z=gt(X[3][0].data),M=0;if(!((w=X[9])!=null&&w[0]))throw"NUMBERS file missing row tree";var U=gt(X[9][0].data)[1].map(function(te){return gt(te.data)});if(U.forEach(function(te){M=_t(te[1][0].data);var oe=_t(te[2][0].data),re=z[1][oe];if(!re)throw"NUMBERS missing tile "+oe;var Z=gt(re.data),ge=e[fr(Z[2][0].data)][0],q=_t(ge.meta[1][0].data);if(q!=6002)throw new Error("6001 unexpected reference to ".concat(q));var Q=oT(e,ge);Q.data.forEach(function(ie,ve){ie.forEach(function(pe,Ae){var je=sT(pe,j,a);je&&(N?(B["!data"][M+ve]||(B["!data"][M+ve]=[]),B["!data"][M+ve][Ae]=je):t[Ct(Ae)+It(M+ve)]=je)})}),M+=Q.nrows}),(p=X[13])!=null&&p[0]){var D=e[fr(X[13][0].data)][0],R=_t(D.meta[1][0].data);if(R!=6144)throw new Error("Expected merge type 6144, found ".concat(R));t["!merges"]=(v=gt(D.data))==null?void 0:v[1].map(function(te){var oe=gt(te.data),re=co(gt(oe[1][0].data)[1][0].data),Z=co(gt(oe[2][0].data)[1][0].data);return{s:{r:re.getUint16(0,!0),c:re.getUint16(2,!0)},e:{r:re.getUint16(0,!0)+Z.getUint16(0,!0)-1,c:re.getUint16(2,!0)+Z.getUint16(2,!0)-1}}})}if(!((y=t["!merges"])!=null&&y.length)&&((T=C[47])!=null&&T[0])){var K=gt(C[47][0].data);if((E=K[2])!=null&&E[0]){var ae=gt(K[2][0].data);(_=ae[3])!=null&&_[0]&&(t["!merges"]=hc(ae[3],function(te){var oe,re,Z,ge,q,Q=gt(te),ie=gt(Q[2][0].data),ve=gt(ie[1][0].data);if((oe=ve[1])!=null&&oe[0]){var pe=gt(ve[1][0].data),Ae=_t(pe[1][0].data);if(Ae==67){var je=gt(pe[40][0].data);if(!(!((re=je[3])!=null&&re[0])||!((Z=je[4])!=null&&Z[0]))){var ze=gt(je[3][0].data),P=gt(je[4][0].data),ee=_t(ze[1][0].data),J=(ge=ze[2])!=null&&ge[0]?_t(ze[2][0].data):ee,G=_t(P[1][0].data),_e=(q=P[2])!=null&&q[0]?_t(P[2][0].data):G;return{s:{r:G,c:ee},e:{r:_e,c:J}}}}}}).filter(function(te){return te!=null}))}}}function uT(e,r,t){var a=gt(r.data),i={"!ref":"A1"};t!=null&&t.dense&&(i["!data"]=[]);var o=e[fr(a[2][0].data)],u=_t(o[0].meta[1][0].data);if(u!=6001)throw new Error("6000 unexpected reference to ".concat(u));return cT(e,o[0],i,t),i}function fT(e,r,t){var a,i=gt(r.data),o={name:(a=i[1])!=null&&a[0]?Ks(i[1][0].data):"",sheets:[]},u=hc(i[2],fr);return u.forEach(function(c){e[c].forEach(function(h){var x=_t(h.meta[1][0].data);x==6e3&&o.sheets.push(uT(e,h,t))})}),o}function dT(e,r,t){var a,i=kf();i.Workbook={WBProps:{date1904:!0}};var o=gt(r.data);if((a=o[2])!=null&&a[0])throw new Error("Keynote presentations are not supported");var u=hc(o[1],fr);if(u.forEach(function(c){e[c].forEach(function(h){var x=_t(h.meta[1][0].data);if(x==2){var m=fT(e,h,t);m.sheets.forEach(function(w,p){yo(i,w,p==0?m.name:m.name+"_"+p,!0)})}})}),i.SheetNames.length==0)throw new Error("Empty NUMBERS file");return i.bookType="numbers",i}function mu(e,r){var t,a,i,o,u,c,h,x={},m=[];if(e.FullPaths.forEach(function(p){if(p.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),e.FileIndex.forEach(function(p){if(p.name.match(/\.iwa$/)&&p.content[0]==0){var v;try{v=tT(p.content)}catch(T){return console.log("?? "+p.content.length+" "+(T.message||T))}var y;try{y=J_(v)}catch(T){return console.log("## "+(T.message||T))}y.forEach(function(T){x[T.id]=T.messages,m.push(T.id)})}}),!m.length)throw new Error("File has no messages");if((i=(a=(t=x==null?void 0:x[1])==null?void 0:t[0].meta)==null?void 0:a[1])!=null&&i[0].data&&_t(x[1][0].meta[1][0].data)==1e4)throw new Error("Pages documents are not supported");var w=((h=(c=(u=(o=x==null?void 0:x[1])==null?void 0:o[0])==null?void 0:u.meta)==null?void 0:c[1])==null?void 0:h[0].data)&&_t(x[1][0].meta[1][0].data)==1&&x[1][0];if(w||m.forEach(function(p){x[p].forEach(function(v){var y=_t(v.meta[1][0].data)>>>0;if(y==1)if(!w)w=v;else throw new Error("Document has multiple roots")})}),!w)throw new Error("Cannot find Document root");return dT(x,w,r)}function hT(e){return function(t){for(var a=0;a!=e.length;++a){var i=e[a];t[i[0]]===void 0&&(t[i[0]]=i[1]),i[2]==="n"&&(t[i[0]]=Number(t[i[0]]))}}}function wf(e){hT([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(e)}function xT(e){return Xs.WS.indexOf(e)>-1?"sheet":e==Xs.CS?"chart":e==Xs.DS?"dialog":e==Xs.MS?"macro":e&&e.length?e:"sheet"}function mT(e,r){if(!e)return 0;try{e=r.map(function(a){return a.id||(a.id=a.strRelID),[a.name,e["!id"][a.id].Target,xT(e["!id"][a.id].Type)]})}catch{return null}return!e||e.length===0?null:e}function pT(e,r,t,a,i,o,u,c){if(!(!e||!e["!legdrawel"])){var h=$s(e["!legdrawel"].Target,a),x=Mr(t,h,!0);x&&_5(Pt(x),e,c||[])}}function gT(e,r,t,a,i,o,u,c,h,x,m,w){try{o[a]=Ki(Mr(e,t,!0),r);var p=qt(e,r),v;switch(c){case"sheet":v=y_(p,r,i,h,o[a],x,m,w);break;case"chart":if(v=k_(p,r,i,h,o[a],x,m,w),!v||!v["!drawel"])break;var y=$s(v["!drawel"].Target,r),T=Uu(y),E=E5(Mr(e,y,!0),Ki(Mr(e,T,!0),y)),_=$s(E,y),C=Uu(_);v=n_(Mr(e,_,!0),_,h,Ki(Mr(e,C,!0),_),x,v);break;case"macro":v=E_(p,r,i,h,o[a],x,m,w);break;case"dialog":v=__(p,r,i,h,o[a],x,m,w);break;default:throw new Error("Unrecognized sheet type "+c)}u[a]=v;var S=[],N=[];o&&o[a]&&_n(o[a]).forEach(function(B){var X="";if(o[a][B].Type==Xs.CMNT){if(X=$s(o[a][B].Target,r),S=C_(qt(e,X,!0),X,h),!S||!S.length)return;cx(v,S,!1)}o[a][B].Type==Xs.TCMNT&&(X=$s(o[a][B].Target,r),N=N.concat(S5(qt(e,X,!0),h)))}),N&&N.length&&cx(v,N,!0,h.people||[]),pT(v,c,e,r,i,h,x,S)}catch(B){if(h.WTF)throw B}}function gn(e){return e.charAt(0)=="/"?e.slice(1):e}function vT(e,r){if(um(),r=r||{},wf(r),yn(e,"META-INF/manifest.xml")||yn(e,"objectdata.xml"))return kx(e,r);if(yn(e,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof mu<"u"){if(e.FileIndex)return mu(e,r);var t=Et.utils.cfb_new();return O1(e).forEach(function(te){kw(t,te,yw(e,te))}),mu(t,r)}throw new Error("Unsupported NUMBERS file")}if(!yn(e,"[Content_Types].xml")){if(yn(e,"index.xml.gz"))throw new Error("Unsupported NUMBERS 08 file");if(yn(e,"index.xml"))throw new Error("Unsupported NUMBERS 09 file");var a=Et.find(e,"Index.zip");if(a)return r=er(r),delete r.type,typeof a.content=="string"&&(r.type="binary"),typeof Bun<"u"&&Buffer.isBuffer(a.content)?Qs(new Uint8Array(a.content),r):Qs(a.content,r);throw new Error("Unsupported ZIP file")}var i=O1(e),o=gy(Mr(e,"[Content_Types].xml")),u=!1,c,h;if(o.workbooks.length===0&&(h="xl/workbook.xml",qt(e,h,!0)&&o.workbooks.push(h)),o.workbooks.length===0){if(h="xl/workbook.bin",!qt(e,h,!0))throw new Error("Could not find workbook");o.workbooks.push(h),u=!0}o.workbooks[0].slice(-3)=="bin"&&(u=!0);var x={},m={};if(!r.bookSheets&&!r.bookProps){if(Zi=[],o.sst)try{Zi=S_(qt(e,gn(o.sst)),o.sst,r)}catch(te){if(r.WTF)throw te}r.cellStyles&&o.themes.length&&(x=ip(Mr(e,o.themes[0].replace(/^\//,""),!0)||"",r)),o.style&&(m=T_(qt(e,gn(o.style)),o.style,x,r))}o.links.map(function(te){try{var oe=Ki(Mr(e,Uu(gn(te))),te);return N_(qt(e,gn(te)),oe,te,r)}catch{}});var w=w_(qt(e,gn(o.workbooks[0])),o.workbooks[0],r),p={},v="";o.coreprops.length&&(v=qt(e,gn(o.coreprops[0]),!0),v&&(p=Um(v)),o.extprops.length!==0&&(v=qt(e,gn(o.extprops[0]),!0),v&&ky(v,p,r)));var y={};(!r.bookSheets||r.bookProps)&&o.custprops.length!==0&&(v=Mr(e,gn(o.custprops[0]),!0),v&&(y=_y(v,r)));var T={};if((r.bookSheets||r.bookProps)&&(w.Sheets?c=w.Sheets.map(function(oe){return oe.name}):p.Worksheets&&p.SheetNames.length>0&&(c=p.SheetNames),r.bookProps&&(T.Props=p,T.Custprops=y),r.bookSheets&&typeof c<"u"&&(T.SheetNames=c),r.bookSheets?T.SheetNames:r.bookProps))return T;c={};var E={};r.bookDeps&&o.calcchain&&(E=b_(qt(e,gn(o.calcchain)),o.calcchain));var _=0,C={},S,N;{var B=w.Sheets;p.Worksheets=B.length,p.SheetNames=[];for(var X=0;X!=B.length;++X)p.SheetNames[X]=B[X].name}var j=u?"bin":"xml",z=o.workbooks[0].lastIndexOf("/"),M=(o.workbooks[0].slice(0,z+1)+"_rels/"+o.workbooks[0].slice(z+1)+".rels").replace(/^\//,"");yn(e,M)||(M="xl/_rels/workbook."+j+".rels");var U=Ki(Mr(e,M,!0),M.replace(/_rels.*/,"s5s"));(o.metadata||[]).length>=1&&(r.xlmeta=A_(qt(e,gn(o.metadata[0])),o.metadata[0],r)),(o.people||[]).length>=1&&(r.people=C5(qt(e,gn(o.people[0])),r)),U&&(U=mT(U,w.Sheets));var D=qt(e,"xl/worksheets/sheet.xml",!0)?1:0;e:for(_=0;_!=p.Worksheets;++_){var R="sheet";if(U&&U[_]?(S="xl/"+U[_][1].replace(/[\/]?xl\//,""),yn(e,S)||(S=U[_][1]),yn(e,S)||(S=M.replace(/_rels\/[\S\s]*$/,"")+U[_][1]),R=U[_][2]):(S="xl/worksheets/sheet"+(_+1-D)+"."+j,S=S.replace(/sheet0\./,"sheet.")),N=S.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),r&&r.sheets!=null)switch(typeof r.sheets){case"number":if(_!=r.sheets)continue e;break;case"string":if(p.SheetNames[_].toLowerCase()!=r.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(r.sheets)){for(var K=!1,ae=0;ae!=r.sheets.length;++ae)typeof r.sheets[ae]=="number"&&r.sheets[ae]==_&&(K=1),typeof r.sheets[ae]=="string"&&r.sheets[ae].toLowerCase()==p.SheetNames[_].toLowerCase()&&(K=1);if(!K)continue e}}gT(e,S,N,p.SheetNames[_],_,C,c,R,r,w,x,m)}return T={Directory:o,Workbook:w,Props:p,Custprops:y,Deps:E,Sheets:c,SheetNames:p.SheetNames,Strings:Zi,Styles:m,Themes:x,SSF:er(ht)},r&&r.bookFiles&&(e.files?(T.keys=i,T.files=e.files):(T.keys=[],T.files={},e.FullPaths.forEach(function(te,oe){te=te.replace(/^Root Entry[\/]/,""),T.keys.push(te),T.files[te]=e.FileIndex[oe]}))),r&&r.bookVBA&&(o.vba.length>0?T.vbaraw=qt(e,gn(o.vba[0]),!0):o.defaults&&o.defaults.bin===F5&&(T.vbaraw=qt(e,"xl/vbaProject.bin",!0))),T.bookType=u?"xlsb":"xlsx",T}function wT(e,r){var t=r||{},a="Workbook",i=Et.find(e,a);try{if(a="/!DataSpaces/Version",i=Et.find(e,a),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+a);if(pk(i.content),a="/!DataSpaces/DataSpaceMap",i=Et.find(e,a),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+a);var o=vk(i.content);if(o.length!==1||o[0].comps.length!==1||o[0].comps[0].t!==0||o[0].name!=="StrongEncryptionDataSpace"||o[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+a);if(a="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",i=Et.find(e,a),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+a);var u=wk(i.content);if(u.length!=1||u[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+a);if(a="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",i=Et.find(e,a),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+a);kk(i.content)}catch{}if(a="/EncryptionInfo",i=Et.find(e,a),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+a);var c=Ek(i.content);if(a="/EncryptedPackage",i=Et.find(e,a),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+a);if(c[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(c[1],i.content,t.password||"",t);if(c[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(c[1],i.content,t.password||"",t);throw new Error("File is password-protected")}function yf(e,r){var t="";switch((r||{}).type||"base64"){case"buffer":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];case"base64":t=sn(e.slice(0,12));break;case"binary":t=e;break;case"array":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];default:throw new Error("Unrecognized type "+(r&&r.type||"undefined"))}return[t.charCodeAt(0),t.charCodeAt(1),t.charCodeAt(2),t.charCodeAt(3),t.charCodeAt(4),t.charCodeAt(5),t.charCodeAt(6),t.charCodeAt(7)]}function yT(e,r){return Et.find(e,"EncryptedPackage")?wT(e,r):Ep(e,r)}function kT(e,r){var t,a=e,i=r||{};return i.type||(i.type=vt&&Buffer.isBuffer(e)?"buffer":"base64"),t=pm(a,i),vT(t,i)}function Fp(e,r){var t=0;e:for(;t<e.length;)switch(e.charCodeAt(t)){case 10:case 13:case 32:++t;break;case 60:return Hu(e.slice(t),r);default:break e}return io.to_workbook(e,r)}function ET(e,r){var t="",a=yf(e,r);switch(r.type){case"base64":t=sn(e);break;case"binary":t=e;break;case"buffer":t=e.toString("binary");break;case"array":t=hs(e);break;default:throw new Error("Unrecognized type "+r.type)}return a[0]==239&&a[1]==187&&a[2]==191&&(t=Pt(t)),r.type="binary",Fp(t,r)}function _T(e,r){var t=e;return r.type=="base64"&&(t=sn(t)),typeof ArrayBuffer<"u"&&e instanceof ArrayBuffer&&(t=new Uint8Array(e)),t=vt&&Buffer.isBuffer(e)?e.slice(2).toString("utf16le"):typeof Uint8Array<"u"&&t instanceof Uint8Array?typeof TextDecoder<"u"?new TextDecoder("utf-16le").decode(t.slice(2)):C2(t.slice(2)):em(t.slice(2)),r.type="binary",Fp(t,r)}function TT(e){return e.match(/[^\x00-\x7F]/)?Hi(e):e}function pu(e,r,t,a){return a?(t.type="string",io.to_workbook(e,t)):io.to_workbook(r,t)}function Qs(e,r){Jx();var t=r||{};if(t.codepage&&console.error("Codepage tables are not loaded.  Non-ASCII characters may not give expected results"),typeof ArrayBuffer<"u"&&e instanceof ArrayBuffer)return Qs(new Uint8Array(e),(t=er(t),t.type="array",t));if(typeof Int8Array<"u"&&e instanceof Int8Array)return Qs(new Uint8Array(e.buffer,e.byteOffset,e.length),t);typeof Uint8Array<"u"&&e instanceof Uint8Array&&!t.type&&(t.type=typeof Deno<"u"?"buffer":"array");var a=e,i=[0,0,0,0],o=!1;if(t.cellStyles&&(t.cellNF=!0,t.sheetStubs=!0),Ys={},t.dateNF&&(Ys.dateNF=t.dateNF),t.type||(t.type=vt&&Buffer.isBuffer(e)?"buffer":"base64"),t.type=="file"&&(t.type=vt?"buffer":"binary",a=rw(e),typeof Uint8Array<"u"&&!vt&&(t.type="array")),t.type=="string"&&(o=!0,t.type="binary",t.codepage=65001,a=TT(e)),t.type=="array"&&typeof Uint8Array<"u"&&e instanceof Uint8Array&&typeof ArrayBuffer<"u"){var u=new ArrayBuffer(3),c=new Uint8Array(u);if(c.foo="bar",!c.foo)return t=er(t),t.type="array",Qs(ef(a),t)}switch((i=yf(a,t))[0]){case 208:if(i[1]===207&&i[2]===17&&i[3]===224&&i[4]===161&&i[5]===177&&i[6]===26&&i[7]===225)return yT(Et.read(a,t),t);break;case 9:if(i[1]<=8)return Ep(a,t);break;case 60:return Hu(a,t);case 73:if(i[1]===73&&i[2]===42&&i[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(i[1]===68)return sk(a,t);break;case 84:if(i[1]===65&&i[2]===66&&i[3]===76)return nk.to_workbook(a,t);break;case 80:return i[1]===75&&i[2]<9&&i[3]<9?kT(a,t):pu(e,a,t,o);case 239:return i[3]===60?Hu(a,t):pu(e,a,t,o);case 255:if(i[1]===254)return _T(a,t);if(i[1]===0&&i[2]===2&&i[3]===0)return qi.to_workbook(a,t);break;case 0:if(i[1]===0&&(i[2]>=2&&i[3]===0||i[2]===0&&(i[3]===8||i[3]===9)))return qi.to_workbook(a,t);break;case 3:case 131:case 139:case 140:return lx.to_workbook(a,t);case 123:if(i[1]===92&&i[2]===114&&i[3]===116)return Ok(a,t);break;case 10:case 13:case 32:return ET(a,t);case 137:if(i[1]===80&&i[2]===78&&i[3]===71)throw new Error("PNG Image File is not a spreadsheet");break;case 8:if(i[1]===231)throw new Error("Unsupported Multiplan 1.x file!");break;case 12:if(i[1]===236)throw new Error("Unsupported Multiplan 2.x file!");if(i[1]===237)throw new Error("Unsupported Multiplan 3.x file!");break}return tk.indexOf(i[0])>-1&&i[2]<=12&&i[3]<=31?lx.to_workbook(a,t):pu(e,a,t,o)}function ST(e,r,t,a,i,o,u){var c=It(t),h=u.defval,x=u.raw||!Object.prototype.hasOwnProperty.call(u,"raw"),m=!0,w=e["!data"]!=null,p=i===1?[]:{};if(i!==1)if(Object.defineProperty)try{Object.defineProperty(p,"__rowNum__",{value:t,enumerable:!1})}catch{p.__rowNum__=t}else p.__rowNum__=t;if(!w||e["!data"][t])for(var v=r.s.c;v<=r.e.c;++v){var y=w?(e["!data"][t]||[])[v]:e[a[v]+c];if(y==null||y.t===void 0){if(h===void 0)continue;o[v]!=null&&(p[o[v]]=h);continue}var T=y.v;switch(y.t){case"z":if(T==null)break;continue;case"e":T=T==0?null:void 0;break;case"s":case"b":case"n":if(!y.z||!Mn(y.z)||(T=Ma(T),typeof T=="number"))break;case"d":u&&(u.UTC||u.raw===!1)||(T=xs(new Date(T)));break;default:throw new Error("unrecognized type "+y.t)}if(o[v]!=null){if(T==null)if(y.t=="e"&&T===null)p[o[v]]=null;else if(h!==void 0)p[o[v]]=h;else if(x&&T===null)p[o[v]]=null;else continue;else p[o[v]]=(y.t==="n"&&typeof u.rawNumbers=="boolean"?u.rawNumbers:x)?T:za(y,T,u);T!=null&&(m=!1)}}return{row:p,isempty:m}}function Wu(e,r){if(e==null||e["!ref"]==null)return[];var t={t:"n",v:0},a=0,i=1,o=[],u=0,c="",h={s:{r:0,c:0},e:{r:0,c:0}},x=r||{},m=x.range!=null?x.range:e["!ref"];switch(x.header===1?a=1:x.header==="A"?a=2:Array.isArray(x.header)?a=3:x.header==null&&(a=0),typeof m){case"string":h=Yt(m);break;case"number":h=Yt(e["!ref"]),h.s.r=m;break;default:h=m}a>0&&(i=0);var w=It(h.s.r),p=[],v=[],y=0,T=0,E=e["!data"]!=null,_=h.s.r,C=0,S={};E&&!e["!data"][_]&&(e["!data"][_]=[]);var N=x.skipHidden&&e["!cols"]||[],B=x.skipHidden&&e["!rows"]||[];for(C=h.s.c;C<=h.e.c;++C)if(!(N[C]||{}).hidden)switch(p[C]=Ct(C),t=E?e["!data"][_][C]:e[p[C]+w],a){case 1:o[C]=C-h.s.c;break;case 2:o[C]=p[C];break;case 3:o[C]=x.header[C-h.s.c];break;default:if(t==null&&(t={w:"__EMPTY",t:"s"}),c=u=za(t,null,x),T=S[u]||0,!T)S[u]=1;else{do c=u+"_"+T++;while(S[c]);S[u]=T,S[c]=1}o[C]=c}for(_=h.s.r+i;_<=h.e.r;++_)if(!(B[_]||{}).hidden){var X=ST(e,h,_,p,a,o,x);(X.isempty===!1||(a===1?x.blankrows!==!1:x.blankrows))&&(v[y++]=X.row)}return v.length=y,v}var _x=/"/g;function CT(e,r,t,a,i,o,u,c,h){for(var x=!0,m=[],w="",p=It(t),v=e["!data"]!=null,y=v&&e["!data"][t]||[],T=r.s.c;T<=r.e.c;++T)if(a[T]){var E=v?y[T]:e[a[T]+p];if(E==null)w="";else if(E.v!=null){x=!1,w=""+(h.rawNumbers&&E.t=="n"?E.v:za(E,null,h));for(var _=0,C=0;_!==w.length;++_)if((C=w.charCodeAt(_))===i||C===o||C===34||h.forceQuotes){w='"'+w.replace(_x,'""')+'"';break}w=="ID"&&c==0&&m.length==0&&(w='"ID"')}else E.f!=null&&!E.F?(x=!1,w="="+E.f,w.indexOf(",")>=0&&(w='"'+w.replace(_x,'""')+'"')):w="";m.push(w)}if(h.strip)for(;m[m.length-1]==="";)--m.length;return h.blankrows===!1&&x?null:m.join(u)}function Ip(e,r){var t=[],a=r??{};if(e==null||e["!ref"]==null)return"";for(var i=Yt(e["!ref"]),o=a.FS!==void 0?a.FS:",",u=o.charCodeAt(0),c=a.RS!==void 0?a.RS:`
`,h=c.charCodeAt(0),x="",m=[],w=a.skipHidden&&e["!cols"]||[],p=a.skipHidden&&e["!rows"]||[],v=i.s.c;v<=i.e.c;++v)(w[v]||{}).hidden||(m[v]=Ct(v));for(var y=0,T=i.s.r;T<=i.e.r;++T)(p[T]||{}).hidden||(x=CT(e,i,T,m,u,h,o,y,a),x!=null&&(x||a.blankrows!==!1)&&t.push((y++?c:"")+x));return t.join("")}function bT(e,r){r||(r={}),r.FS="	",r.RS=`
`;var t=Ip(e,r);return t}function NT(e,r){var t="",a,i="";if(e==null||e["!ref"]==null)return[];var o=Yt(e["!ref"]),u="",c=[],h,x=[],m=e["!data"]!=null;for(h=o.s.c;h<=o.e.c;++h)c[h]=Ct(h);for(var w=o.s.r;w<=o.e.r;++w)for(u=It(w),h=o.s.c;h<=o.e.c;++h)if(t=c[h]+u,a=m?(e["!data"][w]||[])[h]:e[t],i="",a!==void 0){if(a.F!=null){if(t=a.F,!a.f)continue;i=a.f,t.indexOf(":")==-1&&(t=t+":"+t)}if(a.f!=null)i=a.f;else{if(r&&r.values===!1)continue;if(a.t=="z")continue;if(a.t=="n"&&a.v!=null)i=""+a.v;else if(a.t=="b")i=a.v?"TRUE":"FALSE";else if(a.w!==void 0)i="'"+a.w;else{if(a.v===void 0)continue;a.t=="s"?i="'"+a.v:i=""+a.v}}x[x.length]=t+"="+i}return x}function Dp(e,r,t){var a=t||{},i=e?e["!data"]!=null:a.dense,o=+!a.skipHeader,u=e||{};!e&&i&&(u["!data"]=[]);var c=0,h=0;if(u&&a.origin!=null)if(typeof a.origin=="number")c=a.origin;else{var x=typeof a.origin=="string"?Ir(a.origin):a.origin;c=x.r,h=x.c}var m={s:{c:0,r:0},e:{c:h,r:c+r.length-1+o}};if(u["!ref"]){var w=Yt(u["!ref"]);m.e.c=Math.max(m.e.c,w.e.c),m.e.r=Math.max(m.e.r,w.e.r),c==-1&&(c=w.e.r+1,m.e.r=c+r.length-1+o)}else c==-1&&(c=0,m.e.r=r.length-1+o);var p=a.header||[],v=0,y=[];r.forEach(function(E,_){i&&!u["!data"][c+_+o]&&(u["!data"][c+_+o]=[]),i&&(y=u["!data"][c+_+o]),_n(E).forEach(function(C){(v=p.indexOf(C))==-1&&(p[v=p.length]=C);var S=E[C],N="z",B="",X=i?"":Ct(h+v)+It(c+_+o),j=i?y[h+v]:u[X];S&&typeof S=="object"&&!(S instanceof Date)?i?y[h+v]=S:u[X]=S:(typeof S=="number"?N="n":typeof S=="boolean"?N="b":typeof S=="string"?N="s":S instanceof Date?(N="d",a.UTC||(S=ic(S)),a.cellDates||(N="n",S=ar(S)),B=j!=null&&j.z&&Mn(j.z)?j.z:a.dateNF||ht[14]):S===null&&a.nullError&&(N="e",S=0),j?(j.t=N,j.v=S,delete j.w,delete j.R,B&&(j.z=B)):i?y[h+v]=j={t:N,v:S}:u[X]=j={t:N,v:S},B&&(j.z=B))})}),m.e.c=Math.max(m.e.c,h+p.length-1);var T=It(c);if(i&&!u["!data"][c]&&(u["!data"][c]=[]),o)for(v=0;v<p.length;++v)i?u["!data"][c][v+h]={t:"s",v:p[v]}:u[Ct(v+h)+T]={t:"s",v:p[v]};return u["!ref"]=yt(m),u}function AT(e,r){return Dp(null,e,r)}function uo(e,r,t){if(typeof r=="string"){if(e["!data"]!=null){var a=Ir(r);return e["!data"][a.r]||(e["!data"][a.r]=[]),e["!data"][a.r][a.c]||(e["!data"][a.r][a.c]={t:"z"})}return e[r]||(e[r]={t:"z"})}return typeof r!="number"?uo(e,Tt(r)):uo(e,Ct(t||0)+It(r))}function FT(e,r){if(typeof r=="number"){if(r>=0&&e.SheetNames.length>r)return r;throw new Error("Cannot find sheet # "+r)}else if(typeof r=="string"){var t=e.SheetNames.indexOf(r);if(t>-1)return t;throw new Error("Cannot find sheet name |"+r+"|")}else throw new Error("Cannot find sheet |"+r+"|")}function kf(e,r){var t={SheetNames:[],Sheets:{}};return e&&yo(t,e,r||"Sheet1"),t}function yo(e,r,t,a){var i=1;if(!t)for(;i<=65535&&e.SheetNames.indexOf(t="Sheet"+i)!=-1;++i,t=void 0);if(!t||e.SheetNames.length>=65535)throw new Error("Too many worksheets");if(a&&e.SheetNames.indexOf(t)>=0&&t.length<32){var o=t.match(/\d+$/);i=o&&+o[0]||0;var u=o&&t.slice(0,o.index)||t;for(++i;i<=65535&&e.SheetNames.indexOf(t=u+i)!=-1;++i);}if(f_(t),e.SheetNames.indexOf(t)>=0)throw new Error("Worksheet with name |"+t+"| already exists!");return e.SheetNames.push(t),e.Sheets[t]=r,t}function IT(e,r,t){e.Workbook||(e.Workbook={}),e.Workbook.Sheets||(e.Workbook.Sheets=[]);var a=FT(e,r);switch(e.Workbook.Sheets[a]||(e.Workbook.Sheets[a]={}),t){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+t)}e.Workbook.Sheets[a].Hidden=t}function DT(e,r){return e.z=r,e}function Rp(e,r,t){return r?(e.l={Target:r},t&&(e.l.Tooltip=t)):delete e.l,e}function RT(e,r,t){return Rp(e,"#"+r,t)}function PT(e,r,t){e.c||(e.c=[]),e.c.push({t:r,a:t||"SheetJS"})}function OT(e,r,t,a){for(var i=typeof r!="string"?r:Yt(r),o=typeof r=="string"?r:yt(r),u=i.s.r;u<=i.e.r;++u)for(var c=i.s.c;c<=i.e.c;++c){var h=uo(e,u,c);h.t="n",h.F=o,delete h.v,u==i.s.r&&c==i.s.c&&(h.f=t,a&&(h.D=!0))}var x=ps(e["!ref"]);return x.s.r>i.s.r&&(x.s.r=i.s.r),x.s.c>i.s.c&&(x.s.c=i.s.c),x.e.r<i.e.r&&(x.e.r=i.e.r),x.e.c<i.e.c&&(x.e.c=i.e.c),e["!ref"]=yt(x),e}var jT={encode_col:Ct,encode_row:It,encode_cell:Tt,encode_range:yt,decode_col:uf,decode_row:cf,split_cell:Yw,decode_cell:Ir,decode_range:ps,format_cell:za,sheet_new:Qw,sheet_add_aoa:Om,sheet_add_json:Dp,sheet_add_dom:_p,aoa_to_sheet:ri,json_to_sheet:AT,table_to_sheet:Tp,table_to_book:K_,sheet_to_csv:Ip,sheet_to_txt:bT,sheet_to_json:Wu,sheet_to_html:Y_,sheet_to_formulae:NT,sheet_to_row_object_array:Wu,sheet_get_cell:uo,book_new:kf,book_append_sheet:yo,book_set_sheet_visibility:IT,cell_set_number_format:DT,cell_set_hyperlink:Rp,cell_set_internal_link:RT,cell_add_comment:PT,sheet_set_array_formula:OT,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};const LT=e=>new Promise((r,t)=>{try{const a=document.createElement("canvas"),i=a.getContext("2d");if(!i)throw new Error("Canvas context not available");const o=e.split(`
`),u=14,c=18,h=20,x="Courier New, monospace";i.font=`${u}px ${x}`;let m=0;o.forEach(E=>{const _=i.measureText(E).width;_>m&&(m=_)});const w=Math.min(Math.max(m+h*2,600),2e3),p=300,v=o.slice(0,p),y=v.length*c+h*2;a.width=w,a.height=y,i.fillStyle="#ffffff",i.fillRect(0,0,a.width,a.height),i.fillStyle="#000000",i.font=`${u}px ${x}`,i.textBaseline="top",v.forEach((E,_)=>{i.fillText(E,h,h+_*c)}),o.length>p&&(i.fillStyle="#666666",i.fillText(`... e altre ${o.length-p} righe ...`,h,h+p*c));const T=a.toDataURL("image/png");r(T.split(",")[1])}catch(a){t(a)}}),MT=async e=>{let r="";if(e.name.endsWith(".csv"))r=await e.text();else if(e.name.match(/\.(xlsx|xls)$/i)){const a=await e.arrayBuffer(),i=Qs(a,{type:"array"}),o=i.SheetNames[0],u=i.Sheets[o];r=jT.sheet_to_csv(u)}else{if(e.type.startsWith("image/"))return Js(e);throw new Error("Formato file non supportato. Usa CSV, Excel o Immagini.")}if(!r.trim())throw new Error("Il file sembra vuoto.");return{base64:await LT(r),mimeType:"image/png"}},Js=e=>new Promise((r,t)=>{const a=new Image,i=URL.createObjectURL(e);a.onload=()=>{const o=document.createElement("canvas");let{width:u,height:c}=a;const h=1024;u>c&&u>h?(c=Math.round(c*h/u),u=h):c>=u&&c>h&&(u=Math.round(u*h/c),c=h),o.width=u,o.height=c;const x=o.getContext("2d");if(x){x.drawImage(a,0,0,u,c);const m=e.type==="image/png"?"image/png":"image/jpeg";r({base64:o.toDataURL(m,.8).split(",")[1],mimeType:m})}else t(new Error("Canvas error"))},a.onerror=()=>t(new Error("Image load error")),a.src=i}),xc=e=>new Promise((r,t)=>{const a=document.createElement("input");a.type="file",a.accept="image/*",e==="camera"&&(a.capture="environment"),a.onchange=i=>{i.target.files&&i.target.files[0]?r(i.target.files[0]):t(new Error("Nessun file"))},a.click()}),BT=Object.freeze(Object.defineProperty({__proto__:null,pickImage:xc,processFileToImage:MT,processImageFile:Js},Symbol.toStringTag,{value:"Module"})),Ef="https://script.google.com/macros/s/AKfycbzuAtweyuib21-BX4dQszoxEL5BW-nzVN2Vyum4UZvWH-TzP3GLZB5He1jFkrO6242JPA/exec",UT=async e=>{try{const r=await fetch(Ef,{method:"POST",redirect:"follow",headers:{"Content-Type":"text/plain;charset=utf-8"},body:JSON.stringify({action:"checkUser",email:e})});return r.ok?!!(await r.json()).exists:!1}catch(r){return console.error("Errore check user:",r),!1}},zT=async(e,r,t,a)=>{try{return await fetch(Ef,{method:"POST",mode:"no-cors",headers:{"Content-Type":"text/plain"},body:JSON.stringify({action:"save",email:e,data:r,pinHash:t,pinSalt:a})}),!0}catch(i){return console.error("Errore save cloud:",i),!1}},HT=async e=>{try{const r=await fetch(Ef,{method:"POST",redirect:"follow",headers:{"Content-Type":"text/plain;charset=utf-8"},body:JSON.stringify({action:"load",email:e})});if(!r.ok)throw new Error("Errore rete");const t=await r.json();return t.success&&t.data?{data:t.data,pinHash:t.pinHash,pinSalt:t.pinSalt}:null}catch(r){return console.error("Errore load cloud:",r),null}},VT=e=>{const r=atob(e),t=new Uint8Array(r.length);for(let a=0;a<r.length;a++)t[a]=r.charCodeAt(a);return t.buffer},Tx=e=>{let r="";const t=new Uint8Array(e),a=t.byteLength;for(let i=0;i<a;i++)r+=String.fromCharCode(t[i]);return window.btoa(r)};async function _f(e,r){const t=r||crypto.getRandomValues(new Uint8Array(16)),a=new TextEncoder,i=await crypto.subtle.importKey("raw",a.encode(e),{name:"PBKDF2"},!1,["deriveBits"]),o=await crypto.subtle.deriveBits({name:"PBKDF2",salt:t,iterations:1e5,hash:"SHA-256"},i,256);return{hash:Tx(o),salt:Tx(t)}}async function WT(e,r,t){if(!e||!r||!t)return!1;try{const a=VT(t),{hash:i}=await _f(e,a);return i===r}catch(a){return console.error("PIN verification failed",a),!1}}const Pp="users_db",ko=()=>{try{const e=localStorage.getItem(Pp);if(!e)return{};const r=JSON.parse(e);return r&&typeof r=="object"?r:{}}catch{return{}}},Tf=e=>{localStorage.setItem(Pp,JSON.stringify(e))},mc=e=>e.trim().toLowerCase(),$T=async(e,r)=>{const t=mc(e);if(!t||!t.includes("@"))return{success:!1,message:"Inserisci un indirizzo email valido."};if(!/^\d{4}$/.test(r))return{success:!1,message:"Il PIN deve essere di 4 cifre numeriche."};const a=ko();if(a[t])return{success:!1,message:"Esiste gi un utente registrato con questa email."};const{hash:i,salt:o}=await _f(r),u={email:t,pinHash:i,pinSalt:o,createdAt:new Date().toISOString()};return a[t]=u,Tf(a),{success:!0,message:"Registrazione completata."}},Op=async(e,r)=>{const t=mc(e),i=ko()[t];return i?await WT(r,i.pinHash,i.pinSalt)?{success:!0,token:`${t}:${Date.now()}`}:{success:!1,message:"Credenziali non valide."}:{success:!1,message:"Credenziali non valide."}},XT="https://script.google.com/macros/s/AKfycbzmq-PTrMcMdrYqCRX29_S034zCaj5ttyc3tZhdhjV77wF6n99LKricFgzy7taGqKOo/exec",jp=async e=>{const r=mc(e);if(!r||!r.includes("@"))return{success:!1,message:"Inserisci un indirizzo email valido."};try{const a=`${XT}?action=request&email=${encodeURIComponent(r)}&redirect=${encodeURIComponent("https://jerbamichol-del.github.io/gestore/reset/")}`;await fetch(a,{method:"GET",mode:"no-cors",cache:"no-store"})}catch(t){console.warn("forgotPassword (fire-and-forget) warning:",t)}return{success:!0,message:"Se l'email  registrata, riceverai un link per il reset."}},GT=async(e,r,t)=>{const a=mc(e),i=ko(),o=i[a];if(!o)return{success:!1,message:"Utente non trovato nel database locale."};if(!/^\d{4}$/.test(t))return{success:!1,message:"Il nuovo PIN deve essere di 4 cifre."};try{const{hash:u,salt:c}=await _f(t);return o.pinHash=u,o.pinSalt=c,i[a]=o,Tf(i),{success:!0,message:"PIN aggiornato con successo."}}catch(u){return console.error("Errore aggiornando il PIN locale:",u),{success:!1,message:"Errore durante laggiornamento del PIN."}}},pc=e=>f.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...e,children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m2.25 15.75 5.159-5.159a2.25 2.25 0 0 1 3.182 0l5.159 5.159m-1.5-1.5 1.409-1.409a2.25 2.25 0 0 1 3.182 0l2.909 2.909m-18 3.75h16.5a1.5 1.5 0 0 0 1.5-1.5V6a1.5 1.5 0 0 0-1.5-1.5H3.75A1.5 1.5 0 0 0 2.25 6v12a1.5 1.5 0 0 0 1.5 1.5Zm16.5-16.5h.008v.008h-.008V4.5Z"})}),YT=e=>f.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...e,children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 3.75H6.75a2.25 2.25 0 0 0-2.25 2.25v11.25c0 1.24 1.01 2.25 2.25 2.25h10.5a2.25 2.25 0 0 0 2.25-2.25V6.75a2.25 2.25 0 0 0-2.25-2.25H15M12 15V3.75m0 0L9.75 6m2.25-2.25L14.25 6"})}),KT=e=>f.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...e,children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M16.5 10.5V6.75a4.5 4.5 0 0 0-9 0v3.75m-.75 11.25h10.5a2.25 2.25 0 0 0 2.25-2.25v-6.75a2.25 2.25 0 0 0-2.25-2.25H6.75a2.25 2.25 0 0 0-2.25 2.25v6.75a2.25 2.25 0 0 0 2.25 2.25Z"})}),QT=e=>f.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...e,children:[f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3.75 4.875c0-.621.504-1.125 1.125-1.125h4.5c.621 0 1.125.504 1.125 1.125v4.5c0 .621-.504 1.125-1.125 1.125h-4.5A1.125 1.125 0 0 1 3.75 9.375v-4.5ZM3.75 14.625c0-.621.504-1.125 1.125-1.125h4.5c.621 0 1.125.504 1.125 1.125v4.5c0 .621-.504 1.125-1.125 1.125h-4.5a1.125 1.125 0 0 1-1.125-1.125v-4.5ZM13.5 4.875c0-.621.504-1.125 1.125-1.125h4.5c.621 0 1.125.504 1.125 1.125v4.5c0 .621-.504 1.125-1.125 1.125h-4.5A1.125 1.125 0 0 1 13.5 9.375v-4.5Z"}),f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6.75 6.75h.75v.75h-.75v-.75ZM6.75 16.5h.75v.75h-.75v-.75ZM16.5 6.75h.75v.75h-.75v-.75ZM13.5 13.5h.75v.75h-.75v-.75ZM13.5 19.5h.75v.75h-.75v-.75ZM19.5 13.5h.75v.75h-.75v-.75ZM19.5 19.5h.75v.75h-.75v-.75ZM16.5 16.5h.75v.75h-.75v-.75Z"})]}),qT=({pendingSyncs:e,isOnline:r,onInstallClick:t,installPromptEvent:a,onLogout:i,onShowQr:o})=>f.jsx("header",{className:"bg-white shadow-md sticky top-0 z-20",children:f.jsx("div",{className:"mx-auto",children:f.jsxs("div",{className:"py-2 flex items-center justify-between gap-3 px-4 md:px-8 h-[58px]",children:[f.jsx("h1",{className:"text-xl font-bold text-slate-800",children:"Gestore Spese"}),f.jsxs("div",{className:"flex items-center gap-2 sm:gap-4",children:[!r&&f.jsxs("div",{className:"flex items-center gap-2 text-sm font-semibold text-amber-600 bg-amber-100 px-3 py-1.5 rounded-full",children:[f.jsxs("span",{className:"relative flex h-2 w-2",children:[f.jsx("span",{className:"animate-ping absolute inline-flex h-full w-full rounded-full bg-amber-500 opacity-75"}),f.jsx("span",{className:"relative inline-flex rounded-full h-2 w-2 bg-amber-500"})]}),f.jsx("span",{className:"hidden sm:inline",children:"Offline"})]}),e>0&&r&&f.jsxs("div",{className:"flex items-center gap-2 text-sm font-semibold text-indigo-600 bg-indigo-100 px-3 py-1.5 rounded-full",children:[f.jsx(pc,{className:"w-5 h-5"}),f.jsx("span",{children:e}),f.jsx("span",{className:"hidden sm:inline md:inline",children:"in sync"})]}),a&&f.jsxs("button",{onClick:t,className:"flex items-center gap-2 text-sm font-semibold text-indigo-600 bg-indigo-100 px-3 py-1.5 rounded-full hover:bg-indigo-200 transition-colors","aria-label":"Installa App",title:"Installa App",children:[f.jsx(YT,{className:"w-5 h-5"}),f.jsx("span",{className:"hidden sm:inline",children:"Installa"})]}),f.jsx("button",{onClick:o,className:"p-2 text-slate-500 hover:text-indigo-600 hover:bg-indigo-100 rounded-full transition-colors","aria-label":"Mostra QR Code",title:"Condividi via QR",children:f.jsx(QT,{className:"w-6 h-6"})}),f.jsx("button",{onClick:i,className:"p-2 text-slate-500 hover:text-indigo-600 hover:bg-indigo-100 rounded-full transition-colors","aria-label":"Logout",title:"Logout",children:f.jsx(KT,{className:"w-6 h-6"})})]})]})})}),ZT=e=>f.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...e,children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3.75 6.75h16.5M3.75 12h16.5m-16.5 5.25h16.5"})}),JT=e=>f.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...e,children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M2.25 3h1.386c.51 0 .955.343 1.087.835l.383 1.437M7.5 14.25a3 3 0 0 0-3 3h15.75m-12.75-3h11.218c.51 0 .962-.343 1.087-.835l.383-1.437M7.5 14.25V5.106c0-.612.501-1.106 1.106-1.106H15.894c.612 0 1.106.501 1.106 1.106v9.144M7.5 14.25h6.75"})}),eS=e=>f.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...e,children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M8.25 18.75a1.5 1.5 0 0 1-3 0m3 0a1.5 1.5 0 0 0-3 0m3 0h6m-9 0H3.375a1.125 1.125 0 0 1-1.125-1.125V14.25m17.25 4.5a1.5 1.5 0 0 1-3 0m3 0a1.5 1.5 0 0 0-3 0m3 0h1.125c.621 0 1.125-.504 1.125-1.125V14.25m-17.25 4.5v-1.875a3.375 3.375 0 0 1 3.375-3.375h9.75a3.375 3.375 0 0 1 3.375 3.375v1.875M3.375 14.25v-2.625A3.375 3.375 0 0 1 6.75 8.25h9.75a3.375 3.375 0 0 1 3.375 3.375v2.625m-16.5 0h16.5"})}),tS=e=>f.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...e,children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m2.25 12 8.954-8.955c.44-.439 1.152-.439 1.591 0L21.75 12M4.5 9.75v10.125c0 .621.504 1.125 1.125 1.125H9.75v-4.875c0-.621.504-1.125 1.125-1.125h2.25c.621 0 1.125.504 1.125 1.125V21h4.125c.621 0 1.125-.504 1.125-1.125V9.75M8.25 21h8.25"})}),rS=e=>f.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...e,children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15.75 10.5V6a3.75 3.75 0 1 0-7.5 0v4.5m11.356-1.993 1.263 12c.07.658-.463 1.243-1.119 1.243H4.25a1.125 1.125 0 0 1-1.12-1.243l1.264-12A1.125 1.125 0 0 1 5.513 7.5h12.974c.576 0 1.059.435 1.119 1.007ZM8.625 10.5a.375.375 0 1 1-.75 0 .375.375 0 0 1 .75 0Zm7.5 0a.375.375 0 1 1-.75 0 .375.375 0 0 1 .75 0Z"})}),nS=e=>f.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...e,children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 12.75 11.25 15 15 9.75M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"})}),aS=e=>f.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...e,children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M21 8.25c0-2.485-2.099-4.5-4.688-4.5-1.935 0-3.597 1.126-4.312 2.733-.715-1.607-2.377-2.733-4.313-2.733C5.1 3.75 3 5.765 3 8.25c0 7.22 9 12 9 12s9-4.78 9-12Z"})}),sS=e=>f.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...e,children:[f.jsx("path",{d:"M12 14l9-5-9-5-9 5 9 5z"}),f.jsx("path",{d:"M12 14l6.16-3.422a12.083 12.083 0 01.665 6.479A11.952 11.952 0 0012 20.055a11.952 11.952 0 00-6.824-2.998 12.078 12.078 0 01.665-6.479L12 14z"}),f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 14v6m-6-3.837V11.163m12 0v2.674"})]}),iS=e=>f.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...e,children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M20.25 14.15v4.05a2.25 2.25 0 0 1-2.25 2.25h-15a2.25 2.25 0 0 1-2.25-2.25V8.25a2.25 2.25 0 0 1 2.25-2.25h15.5a2.25 2.25 0 0 1 2.25 2.25v2.15m-15.75-6.04 4.03-3.11a2.25 2.25 0 0 1 2.86 0l4.03 3.11M18 9a3 3 0 1 0-6 0 3 3 0 0 0 6 0Z"})}),oS=e=>f.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...e,children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3.75 6A2.25 2.25 0 0 1 6 3.75h2.25A2.25 2.25 0 0 1 10.5 6v2.25a2.25 2.25 0 0 1-2.25 2.25H6A2.25 2.25 0 0 1 3.75 8.25V6ZM3.75 15.75A2.25 2.25 0 0 1 6 13.5h2.25a2.25 2.25 0 0 1 2.25 2.25v2.25A2.25 2.25 0 0 1 8.25 20.25H6A2.25 2.25 0 0 1 3.75 18v-2.25ZM13.5 6A2.25 2.25 0 0 1 15.75 3.75h2.25A2.25 2.25 0 0 1 20.25 6v2.25a2.25 2.25 0 0 1-2.25 2.25H15.75A2.25 2.25 0 0 1 13.5 8.25V6ZM13.5 15.75A2.25 2.25 0 0 1 15.75 13.5h2.25a2.25 2.25 0 0 1 2.25 2.25v2.25A2.25 2.25 0 0 1 18 20.25h-2.25A2.25 2.25 0 0 1 13.5 18v-2.25Z"})}),Sx={all:{label:"Tutte",Icon:ZT,color:"text-slate-600",bgColor:"bg-slate-200"},Alimentari:{label:"Alimentari",Icon:JT,color:"text-green-600",bgColor:"bg-green-100"},Trasporti:{label:"Trasporti",Icon:eS,color:"text-blue-600",bgColor:"bg-blue-100"},Casa:{label:"Casa",Icon:tS,color:"text-orange-600",bgColor:"bg-orange-100"},Shopping:{label:"Shopping",Icon:rS,color:"text-pink-600",bgColor:"bg-pink-100"},"Tempo Libero":{label:"Tempo Libero",Icon:nS,color:"text-purple-600",bgColor:"bg-purple-100"},Salute:{label:"Salute",Icon:aS,color:"text-red-600",bgColor:"bg-red-100"},Istruzione:{label:"Istruzione",Icon:sS,color:"text-yellow-600",bgColor:"bg-yellow-100"},Lavoro:{label:"Lavoro",Icon:iS,color:"text-indigo-600",bgColor:"bg-indigo-100"},Altro:{label:"Altro",Icon:oS,color:"text-gray-600",bgColor:"bg-gray-200"}},hr=e=>Sx[e]||Sx.Altro,Ba=e=>{const r=typeof e=="number"&&!isNaN(e)?e:0,t=r%1===0,a={style:"decimal"};return t?(a.minimumFractionDigits=0,a.maximumFractionDigits=0):(a.minimumFractionDigits=2,a.maximumFractionDigits=2),` ${new Intl.NumberFormat("it-IT",a).format(r)}`},Lp=e=>{const r={year:"2-digit",month:"short",day:"numeric"};return new Intl.DateTimeFormat("it-IT",r).formatToParts(e).map(({type:a,value:i})=>a==="month"?`${i}.`:i).join("")},lS=e=>f.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...e,children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3 16.5v2.25A2.25 2.25 0 0 0 5.25 21h13.5A2.25 2.25 0 0 0 21 18.75V16.5M16.5 12 12 16.5m0 0L7.5 12m4.5 4.5V3"})}),cS=e=>f.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...e,children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3 16.5v2.25A2.25 2.25 0 0 0 5.25 21h13.5A2.25 2.25 0 0 0 21 18.75V16.5m-13.5-9L12 3m0 0 4.5 4.5M12 3v13.5"})}),rc=e=>f.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...e,children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m8.25 4.5 7.5 7.5-7.5 7.5"})}),Sf=e=>f.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...e,children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15.75 19.5 8.25 12l7.5-7.5"})}),xr=e=>f.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...e,children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6 18 18 6M6 6l12 12"})}),uS=e=>f.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...e,children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M7.5 21 3 16.5m0 0L7.5 12M3 16.5h13.5m0-13.5L21 7.5m0 0L16.5 12M21 7.5H7.5"})}),fS=({expenses:e,recurringExpenses:r,onNavigateToRecurring:t,onNavigateToHistory:a,onReceiveSharedFile:i,onImportFile:o,onExportJSON:u,onImportJSON:c})=>{const[h,x]=I.useState(new Date),[m,w]=I.useState(!1),p=h.toISOString().slice(0,7),v=e.filter(U=>U.date.startsWith(p)),y=v.reduce((U,D)=>U+D.amount,0),T=new Date().toISOString().slice(0,10),_=e.filter(U=>U.date===T).reduce((U,D)=>U+D.amount,0),C=v.reduce((U,D)=>{const R=D.category||"Altro";return U[R]=(U[R]||0)+D.amount,U},{}),S=Object.entries(C).sort(([,U],[,D])=>D-U),N=()=>{x(new Date(h.getFullYear(),h.getMonth()-1,1))},B=()=>{x(new Date(h.getFullYear(),h.getMonth()+1,1))},X=()=>x(new Date),j=h.toLocaleString("it-IT",{month:"long",year:"numeric"}),z=p===new Date().toISOString().slice(0,7),M=U=>{var R;const D=(R=U.target.files)==null?void 0:R[0];D&&(D.name.endsWith(".json")&&c?c(D):o(D),U.target.value="")};return f.jsxs("div",{className:"p-4 space-y-6 pb-24",children:[f.jsxs("div",{className:"bg-white rounded-2xl shadow-sm p-6 text-center border border-slate-100",children:[f.jsx("h2",{className:"text-sm font-bold text-slate-400 uppercase tracking-wider mb-1",children:"SPESA MENSILE"}),f.jsx("p",{className:"text-sm text-slate-400 mb-2 capitalize",children:j}),f.jsxs("div",{className:"text-5xl font-bold text-indigo-600 mb-6 tracking-tight",children:[Ba(y).replace("","")," ",f.jsx("span",{className:"text-3xl text-indigo-400",children:""})]}),f.jsxs("div",{className:"flex items-center justify-center gap-4 mb-4",children:[f.jsx("button",{onClick:N,className:"p-2 text-slate-400 hover:text-indigo-600 transition-colors",children:f.jsx(Sf,{className:"w-6 h-6"})}),f.jsx("button",{onClick:X,disabled:z,className:`px-4 py-1.5 rounded-full text-sm font-medium transition-colors ${z?"bg-indigo-50 text-indigo-600":"bg-slate-100 text-slate-600 hover:bg-slate-200"}`,children:z?"Questo Mese":"Torna a Oggi"}),f.jsx("button",{onClick:B,className:"p-2 text-slate-400 hover:text-indigo-600 transition-colors",children:f.jsx(rc,{className:"w-6 h-6"})})]}),f.jsxs("div",{className:"pt-4 border-t border-slate-100 flex justify-between items-center",children:[f.jsxs("div",{className:"text-left",children:[f.jsx("p",{className:"text-xs text-slate-400 font-semibold uppercase",children:"Spesa Oggi"}),f.jsx("p",{className:"text-xl font-bold text-slate-700",children:Ba(_)})]}),f.jsxs("div",{className:"flex gap-2",children:[f.jsx("button",{onClick:t,className:"px-3 py-2 bg-amber-100 text-amber-700 rounded-lg text-sm font-semibold hover:bg-amber-200 transition-colors",children:"S. Programmate"}),f.jsx("button",{onClick:a,className:"px-3 py-2 bg-indigo-100 text-indigo-700 rounded-lg text-sm font-semibold hover:bg-indigo-200 transition-colors",children:"Storico Spese"})]})]})]}),f.jsxs("button",{onClick:()=>w(!0),className:"w-full bg-indigo-50 hover:bg-indigo-100 text-indigo-700 p-4 rounded-xl flex items-center justify-center gap-3 transition-colors border border-indigo-100 shadow-sm",children:[f.jsx(uS,{className:"w-5 h-5"}),f.jsx("span",{className:"font-semibold",children:"Imp/Exp (CSV/Excel/JSON)"})]}),f.jsxs("div",{className:"space-y-4",children:[f.jsxs("h3",{className:"text-lg font-bold text-slate-800 px-1",children:["Riepilogo Categorie ",f.jsx("span",{className:"text-sm font-normal text-slate-400 block",children:j})]}),f.jsx("div",{className:"space-y-3",children:S.length>0?S.map(([U,D])=>{const R=hr(U),K=Math.round(D/y*100);return f.jsxs("div",{className:"bg-white p-4 rounded-xl border border-slate-100 shadow-sm flex items-center justify-between",children:[f.jsxs("div",{className:"flex items-center gap-3",children:[f.jsx("div",{className:`w-10 h-10 rounded-full flex items-center justify-center ${R.bgColor} ${R.color}`,children:f.jsx(R.Icon,{className:"w-5 h-5"})}),f.jsxs("div",{children:[f.jsx("p",{className:"font-semibold text-slate-700",children:U}),f.jsx("div",{className:"w-24 h-1.5 bg-slate-100 rounded-full mt-1 overflow-hidden",children:f.jsx("div",{className:`h-full ${R.bgColor.replace("bg-","bg-")}`,style:{width:`${K}%`,backgroundColor:"currentColor",color:"inherit"}})})]})]}),f.jsxs("div",{className:"text-right",children:[f.jsx("p",{className:"font-bold text-slate-700",children:Ba(D)}),f.jsxs("p",{className:"text-xs text-slate-400",children:[K,"%"]})]})]},U)}):f.jsx("div",{className:"text-center py-8 text-slate-400 bg-white rounded-xl border border-dashed border-slate-300",children:"Nessuna spesa in questo periodo"})})]}),m&&f.jsx("div",{className:"fixed inset-0 z-[60] flex items-center justify-center p-4 bg-slate-900/60 backdrop-blur-sm",onClick:()=>w(!1),children:f.jsxs("div",{className:"bg-white w-full max-w-sm rounded-2xl shadow-xl p-6 space-y-4 animate-fade-in-up",onClick:U=>U.stopPropagation(),children:[f.jsxs("div",{className:"flex justify-between items-center mb-2",children:[f.jsx("h3",{className:"text-xl font-bold text-slate-800",children:"Gestione Dati"}),f.jsx("button",{onClick:()=>w(!1),className:"p-1 hover:bg-slate-100 rounded-full",children:f.jsx(xr,{className:"w-6 h-6 text-slate-500"})})]}),f.jsxs("label",{className:"flex items-center gap-4 p-4 rounded-xl border border-slate-200 hover:border-emerald-500 hover:bg-emerald-50 cursor-pointer transition-all group",children:[f.jsx("div",{className:"w-12 h-12 rounded-full bg-emerald-100 text-emerald-600 flex items-center justify-center group-hover:scale-110 transition-transform",children:f.jsx(lS,{className:"w-6 h-6"})}),f.jsxs("div",{className:"flex-1",children:[f.jsx("h4",{className:"font-bold text-slate-700 group-hover:text-emerald-700",children:"Importa (CSV/Excel/JSON)"}),f.jsx("p",{className:"text-xs text-slate-500",children:"Ripristina backup o carica dati"})]}),f.jsx("input",{type:"file",accept:".csv, .xlsx, .xls, .json",className:"hidden",onChange:M})]}),f.jsxs("button",{onClick:u,className:"w-full flex items-center gap-4 p-4 rounded-xl border border-slate-200 hover:border-blue-500 hover:bg-blue-50 cursor-pointer transition-all group text-left",children:[f.jsx("div",{className:"w-12 h-12 rounded-full bg-blue-100 text-blue-600 flex items-center justify-center group-hover:scale-110 transition-transform",children:f.jsx(cS,{className:"w-6 h-6"})}),f.jsxs("div",{className:"flex-1",children:[f.jsx("h4",{className:"font-bold text-slate-700 group-hover:text-blue-700",children:"Esporta (JSON)"}),f.jsx("p",{className:"text-xs text-slate-500",children:"Salva un backup completo con foto"})]})]})]})})]})};var gc=Qx();const dS=ac(gc),Cf=e=>f.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...e,children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M19.5 14.25v-2.625a3.375 3.375 0 0 0-3.375-3.375h-1.5A1.125 1.125 0 0 1 13.5 7.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H8.25m0 12.75h7.5m-7.5 3H12M10.5 2.25H5.625c-.621 0-1.125.504-1.125 1.125v17.25c0 .621.504 1.125 1.125 1.125h12.75c.621 0 1.125-.504 1.125-1.125V11.25a9 9 0 0 0-9-9Z"})}),$u=e=>f.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...e,children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M14.25 7.756a4.5 4.5 0 1 0 0 8.488M7.5 10.5h5.25m-5.25 3h5.25M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"})}),Xu=e=>f.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...e,children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6.75 3v2.25M17.25 3v2.25M3 18.75V7.5a2.25 2.25 0 0 1 2.25-2.25h13.5A2.25 2.25 0 0 1 21 7.5v11.25m-18 0A2.25 2.25 0 0 0 5.25 21h13.5A2.25 2.25 0 0 0 21 18.75m-18 0h18"})}),fo=e=>f.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...e,children:[f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9.568 3H5.25A2.25 2.25 0 0 0 3 5.25v4.318c0 .597.237 1.17.659 1.591l9.581 9.581c.699.699 1.78.872 2.607.33a18.095 18.095 0 0 0 5.223-5.223c.542-.827.369-1.908-.33-2.607L11.16 3.66A2.25 2.25 0 0 0 9.568 3Z"}),f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6 6h.008v.008H6V6Z"})]}),vc=e=>f.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...e,children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M2.25 8.25h19.5M2.25 9h19.5m-16.5 5.25h6m-6 2.25h3m-3.75 3h15a2.25 2.25 0 0 0 2.25-2.25V6.75A2.25 2.25 0 0 0 19.5 4.5h-15A2.25 2.25 0 0 0 2.25 6.75v10.5A2.25 2.25 0 0 0 4.5 19.5Z"})}),Mp=e=>f.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...e,children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 12.75 11.25 15 15 9.75M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"})});function hS(e,r){if(!e)return null;if(r){const a=e.querySelector(r);if(a)return a}const t=[e];for(;t.length;){const a=t.shift();if(a!==e){const i=getComputedStyle(a);if((i.overflowY==="auto"||i.overflowY==="scroll")&&a.scrollHeight>a.clientHeight)return a}t.push(...Array.from(a.children))}return null}function xS(e,{onClose:r},t={}){const{triggerPercent:a=.25,elastic:i=.92,closeSpeedPxMs:o=2.2,openSpeedPxMs:u=2.8,topGuardPx:c=2,scrollableSelector:h}=t,[x,m]=I.useState(0),[w,p]=I.useState(0),v="cubic-bezier(0.22, 0.61, 0.36, 1)",y=I.useRef({active:!1,tookOver:!1,startX:0,startY:0,lastY:0,lastT:0,vy:0,scroller:null,closing:!1,isLocked:!1}).current,T=()=>{var C;return((C=e.current)==null?void 0:C.clientHeight)||1},E=(C,S,N,B)=>{const X=Math.max(1,Math.abs(S-C)),j=Math.max(100,Math.min(420,Math.round(X/N)));y.closing=B,p(0),m(C),requestAnimationFrame(()=>{p(j),m(S)})},_=C=>{C&&C.propertyName&&C.propertyName!=="transform"||(y.closing?(y.closing=!1,p(0),m(0),r()):p(0))};return I.useEffect(()=>{const C=e.current;if(!C)return;const S=(ae,te)=>{y.active=!0,y.tookOver=!1,y.isLocked=!1,y.startX=ae,y.startY=te,y.lastY=te,y.lastT=performance.now(),y.vy=0,y.scroller=hS(C,h)},N=(ae,te,oe)=>{if(!y.active)return;const re=performance.now(),Z=re-y.lastT,ge=te-y.lastY;if(Z>1){const pe=ge/Z;y.vy=y.vy*.8+pe*.2}y.lastY=te,y.lastT=re;const q=ae-y.startX,Q=te-y.startY;if(!y.isLocked){if(Math.abs(q)<=10&&Math.abs(Q)<=10)return;if(!(Math.abs(Q)>Math.abs(q))){y.active=!1;return}y.isLocked=!0}const ie=!y.scroller||y.scroller.scrollTop<=c,ve=Q>0;if(!y.tookOver&&ve&&ie&&(y.tookOver=!0),y.tookOver){"preventDefault"in oe&&oe.cancelable&&oe.preventDefault(),p(0);const pe=Math.max(0,Q)*i;m(Math.min(pe,T()*.98))}},B=()=>{if(y.active&&(y.active=!1,y.tookOver)){const ae=T(),te=x,re=y.vy>.3;if(te>=ae*a||re){const q=re?o*1.5:o;E(te,ae,q,!0)}else E(te,0,u,!1)}},X=ae=>{ae.touches.length===1&&S(ae.touches[0].clientX,ae.touches[0].clientY)},j=ae=>{!y.active||ae.touches.length!==1||N(ae.touches[0].clientX,ae.touches[0].clientY,ae)},z=()=>B(),M=()=>B(),U=ae=>S(ae.clientX,ae.clientY),D=ae=>N(ae.clientX,ae.clientY,ae),R=()=>B(),K=()=>B();return C.addEventListener("touchstart",X,{passive:!0}),C.addEventListener("touchmove",j,{passive:!1}),C.addEventListener("touchend",z,{passive:!0}),C.addEventListener("touchcancel",M,{passive:!0}),C.addEventListener("pointerdown",U,{passive:!0}),C.addEventListener("pointermove",D,{passive:!1}),C.addEventListener("pointerup",R,{passive:!0}),C.addEventListener("pointercancel",K,{passive:!0}),()=>{C.removeEventListener("touchstart",X),C.removeEventListener("touchmove",j),C.removeEventListener("touchend",z),C.removeEventListener("touchcancel",M),C.removeEventListener("pointerdown",U),C.removeEventListener("pointermove",D),C.removeEventListener("pointerup",R),C.removeEventListener("pointercancel",K)}},[e,r,a,i,c,h,x,o,u]),{dragY:x,transitionMs:w,easing:v,handleTransitionEnd:_}}function ni(e={}){const r=e.slopPx??10,t=e.tapMs??350,a=I.useRef({id:null,t0:0,x0:0,y0:0,target:null}),i=I.useCallback(()=>{const m=w=>{w.isTrusted&&(w.stopPropagation(),w.preventDefault(),window.removeEventListener("click",m,!0))};window.addEventListener("click",m,{capture:!0,once:!1}),setTimeout(()=>{window.removeEventListener("click",m,!0)},600)},[]),o=I.useCallback(m=>{const w=a.current;w.id!==null&&m.pointerId!==w.id||(w.id=m.pointerId,w.t0=performance.now(),w.x0=m.clientX,w.y0=m.clientY,w.target=m.target)},[]),u=I.useCallback(m=>{a.current.id,m.pointerId},[]),c=I.useCallback(m=>{var _;const w=a.current;if(w.id!==m.pointerId)return;const p=performance.now()-w.t0,v=Math.abs(m.clientX-w.x0),y=Math.abs(m.clientY-w.y0),T=w.target;if(w.id=null,p<t&&v<=r&&y<=r&&T&&!((_=T.closest)!=null&&_.call(T,"[data-no-synthetic-click]"))){m.cancelable&&m.preventDefault(),i(),(T instanceof HTMLInputElement||T instanceof HTMLTextAreaElement||T.isContentEditable)&&document.activeElement!==T&&T.focus();const C=new MouseEvent("click",{bubbles:!0,cancelable:!0,view:window});T.dispatchEvent(C)}w.target=null},[r,t,i]),h=I.useCallback(m=>{const w=a.current;w.id===m.pointerId&&(w.id=null,w.target=null)},[]),x=I.useCallback(m=>{},[]);return{onPointerDown:o,onPointerMove:u,onPointerUp:c,onPointerCancel:h,onClickCapture:x}}const Ln=({isOpen:e,onClose:r,title:t,options:a,selectedValue:i,onSelect:o})=>{var N;const[u,c]=I.useState(!1),h=I.useRef(null),x=ni(),{dragY:m,transitionMs:w,easing:p,handleTransitionEnd:v}=xS(h,{onClose:r},{triggerPercent:.25,elastic:1,topGuardPx:2,scrollableSelector:"[data-scrollable]"});I.useEffect(()=>{e?requestAnimationFrame(()=>c(!0)):c(!1)},[e]);const y=()=>c(!1),T=B=>{B.target===B.currentTarget&&B.propertyName==="transform"&&(v(B.nativeEvent),u||r())};if(!e)return null;const E=m>0||w>0;let _,C;const S="cubic-bezier(0.22, 0.61, 0.36, 1)";if(E)_=`translate3d(0, ${m}px, 0)`,C=`transform ${w}ms ${p}`;else{const B=((N=h.current)==null?void 0:N.clientHeight)??window.innerHeight;_=`translate3d(0, ${u?0:B}px, 0)`,C=`transform 250ms ${S}`}return f.jsxs("div",{className:"absolute inset-0 z-[60]","aria-modal":"true",role:"dialog",children:[f.jsx("div",{className:`absolute inset-0 bg-slate-900/60 transition-opacity duration-300 ease-in-out ${u?"opacity-100":"opacity-0"}`,onClick:y}),f.jsxs("div",{ref:h,onTransitionEnd:T,onClick:B=>B.stopPropagation(),className:"absolute bottom-0 left-0 right-0 z-10 bg-slate-50 rounded-t-2xl shadow-xl max-h-[80vh] flex flex-col",style:{transform:_,transition:C,touchAction:"pan-y",willChange:"transform",overscrollBehaviorY:"contain"},...x,children:[f.jsxs("header",{className:"flex justify-between items-center p-4 border-b border-slate-200 flex-shrink-0",children:[f.jsxs("div",{className:"flex-1 text-center",children:[f.jsx("div",{className:"inline-block h-1.5 w-10 rounded-full bg-slate-300 absolute top-2 left-1/2 -translate-x-1/2"}),f.jsx("h2",{className:"text-lg font-bold text-slate-800 pointer-events-none mt-2",children:t})]}),f.jsx("button",{type:"button",onClick:y,className:"text-slate-500 hover:text-slate-800 transition-colors p-2 rounded-full hover:bg-slate-200 focus:outline-none focus:ring-2 focus:ring-indigo-500 absolute top-2 right-2","aria-label":"Chiudi",children:f.jsx(xr,{className:"w-6 h-6"})})]}),f.jsx("div",{"data-scrollable":!0,className:"overflow-y-auto p-2",style:{overscrollBehavior:"contain"},children:f.jsx("ul",{children:a.map(B=>{const X=i===B.value;return f.jsx("li",{children:f.jsxs("button",{onClick:()=>o(B.value),style:{touchAction:"manipulation"},className:`w-full text-left p-4 flex items-center justify-between gap-4 transition-colors rounded-lg ${X?"bg-indigo-100":"hover:bg-slate-200"}`,children:[f.jsxs("span",{className:"flex items-center gap-4 min-w-0",children:[B.Icon&&B.bgColor&&f.jsx("span",{className:`w-12 h-12 rounded-xl flex items-center justify-center flex-shrink-0 ${B.bgColor}`,children:f.jsx(B.Icon,{className:`w-7 h-7 ${B.color}`})}),f.jsx("span",{className:`font-medium text-lg truncate ${X?"text-indigo-700":"text-slate-800"}`,children:B.label})]}),X&&f.jsx(Mp,{className:"w-7 h-7 text-indigo-600 flex-shrink-0"})]})},B.value)})})})]})]})},Bp=e=>f.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...e,children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 6v6h4.5m4.5 0a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"})}),En=e=>f.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...e,children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m19.5 8.25-7.5 7.5-7.5-7.5"})}),bf=e=>f.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...e,children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 9v3.75m-9.303 3.376c-.866 1.5.217 3.374 1.948 3.374h14.71c1.73 0 2.813-1.874 1.948-3.374L13.949 3.378c-.866-1.5-3.032-1.5-3.898 0L2.697 16.126zM12 15.75h.007v.008H12v-.008z"})}),Nf=e=>f.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...e,children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m11.25 11.25.041-.02a.75.75 0 0 1 1.063.852l-.708 2.836a.75.75 0 0 0 1.063.853l.041-.021M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Zm-9-3.75h.008v.008H12V8.25Z"})}),ei=({isOpen:e,onClose:r,onConfirm:t,title:a,message:i,variant:o="danger",confirmButtonText:u="Conferma",cancelButtonText:c="Annulla"})=>{const[h,x]=I.useState(!1);if(I.useEffect(()=>{if(e){const T=setTimeout(()=>x(!0),10);return()=>clearTimeout(T)}else x(!1)},[e]),!e)return null;const m={danger:{icon:bf,iconColor:"text-red-600",bgColor:"bg-red-100",confirmButtonClasses:"bg-red-600 hover:bg-red-700 focus:ring-red-500"},info:{icon:Nf,iconColor:"text-indigo-600",bgColor:"bg-indigo-100",confirmButtonClasses:"bg-indigo-600 hover:bg-indigo-700 focus:ring-indigo-500"}},{icon:w,iconColor:p,bgColor:v,confirmButtonClasses:y}=m[o];return f.jsx("div",{className:`fixed inset-0 z-[5100] flex justify-center items-center p-4 transition-opacity duration-75 ease-in-out ${h?"opacity-100":"opacity-0"} bg-slate-900/60 backdrop-blur-sm`,onClick:r,"aria-modal":"true",role:"dialog","aria-labelledby":"modal-title",children:f.jsxs("div",{className:`bg-white rounded-lg shadow-xl w-full max-w-md transform transition-all duration-75 ease-in-out ${h?"scale-100 opacity-100":"scale-95 opacity-0"}`,onClick:T=>T.stopPropagation(),children:[f.jsx("div",{className:"p-6",children:f.jsxs("div",{className:"sm:flex sm:items-start",children:[f.jsx("div",{className:`mx-auto flex h-12 w-12 flex-shrink-0 items-center justify-center rounded-full ${v} sm:mx-0 sm:h-10 sm:w-10`,children:f.jsx(w,{className:`h-6 w-6 ${p}`,"aria-hidden":"true"})}),f.jsxs("div",{className:"mt-3 text-center sm:ml-4 sm:mt-0 sm:text-left",children:[f.jsx("h3",{className:"text-lg font-semibold leading-6 text-slate-900",id:"modal-title",children:a}),f.jsx("div",{className:"mt-2",children:f.jsx("p",{className:"text-sm text-slate-500",children:i})})]})]})}),f.jsxs("div",{className:"px-6 py-4 bg-slate-50 flex flex-col-reverse sm:flex-row sm:justify-end gap-3",children:[f.jsx("button",{type:"button",onClick:r,className:"w-full sm:w-auto px-4 py-2 text-sm font-semibold text-slate-700 bg-white border border-slate-300 rounded-lg shadow-sm hover:bg-slate-100 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2 transition-colors",children:c}),f.jsx("button",{type:"button",onClick:t,className:`w-full sm:w-auto px-4 py-2 text-sm font-semibold text-white rounded-lg shadow-sm focus:outline-none focus:ring-2 focus:ring-offset-2 transition-colors ${y}`,children:u})]})]})})},Up=e=>f.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...e,children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m18.375 12.739-7.693 7.693a4.5 4.5 0 0 1-6.364-6.364l10.94-10.94A3 3 0 1 1 19.5 7.372L8.552 18.32m.009-.01-.01.01m5.699-9.941-7.81 7.81a1.5 1.5 0 0 0 2.112 2.13"})}),Af=e=>f.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...e,children:[f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6.827 6.175A2.31 2.31 0 0 1 5.186 7.23c-.38.054-.757.112-1.134.175C2.999 7.58 2.25 8.507 2.25 9.574V18a2.25 2.25 0 0 0 2.25 2.25h15A2.25 2.25 0 0 0 21.75 18V9.574c0-1.067-.75-1.994-1.802-2.169a47.865 47.865 0 0 0-1.134-.175 2.31 2.31 0 0 1-1.64-1.055l-.822-1.316a2.192 2.192 0 0 0-1.736-1.039 48.776 48.776 0 0 0-5.232 0 2.192 2.192 0 0 0-1.736 1.039l-.821 1.316Z"}),f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M16.5 12.75a4.5 4.5 0 1 1-9 0 4.5 4.5 0 0 1 9 0ZM18.75 10.5h.008v.008h-.008V10.5Z"})]}),zp=e=>{const r=e.getFullYear(),t=String(e.getMonth()+1).padStart(2,"0"),a=String(e.getDate()).padStart(2,"0");return`${r}-${t}-${a}`},gu=()=>new Date().toLocaleTimeString("it-IT",{hour:"2-digit",minute:"2-digit"}),vu=()=>zp(new Date),Gu=Tn.memo(Tn.forwardRef(({id:e,name:r,label:t,value:a,onChange:i,icon:o,...u},c)=>f.jsxs("div",{children:[f.jsx("label",{htmlFor:e,className:"block text-base font-medium text-slate-700 mb-1",children:t}),f.jsxs("div",{className:"relative",children:[f.jsx("div",{className:"pointer-events-none absolute inset-y-0 left-0 flex items-center pl-3",children:o}),f.jsx("input",{ref:c,id:e,name:r,value:a||"",onChange:i,className:"block w-full rounded-md border border-slate-300 bg-white py-2.5 pl-10 pr-3 text-slate-900 placeholder:text-slate-400 focus:outline-none focus:border-indigo-500 focus:ring-1 focus:ring-indigo-500 text-base",...u})]})]})));Gu.displayName="FormInput";const nc=e=>{if(!e)return null;const r=e.split("-").map(Number);return new Date(r[0],r[1]-1,r[2])},zl={daily:"Giornaliera",weekly:"Settimanale",monthly:"Mensile",yearly:"Annuale"},mS={0:"Dom",1:"Lun",2:"Mar",3:"Mer",4:"Gio",5:"Ven",6:"Sab"},Hp=["domenica","luned","marted","mercoled","gioved","venerd","sabato"],Vp=["primo","secondo","terzo","quarto","ultimo"],pS=e=>{if(!e)return"";const r=nc(e);return r?new Intl.DateTimeFormat("it-IT",{day:"numeric",month:"short"}).format(r):""},gS=e=>{if(e.frequency!=="recurring"||!e.recurrence)return"Imposta ricorrenza";const{recurrence:r,recurrenceInterval:t=1,recurrenceDays:a,monthlyRecurrenceType:i,date:o,recurrenceEndType:u="forever",recurrenceEndDate:c,recurrenceCount:h}=e;let x="";if(t===1)x=zl[r];else switch(r){case"daily":x=`Ogni ${t} giorni`;break;case"weekly":x=`Ogni ${t} sett.`;break;case"monthly":x=`Ogni ${t} mesi`;break;case"yearly":x=`Ogni ${t} anni`;break}if(r==="weekly"&&a&&a.length>0){const w=[...a].sort((p,v)=>(p===0?7:p)-(v===0?7:v)).map(p=>mS[p]);x+=`: ${w.join(", ")}`}if(r==="monthly"&&i==="dayOfWeek"&&o){const m=nc(o);if(m){const w=m.getDate(),p=m.getDay(),v=Math.floor((w-1)/7),y=Hp[p].substring(0,3),T=Vp[v];x+=` (${T} ${y}.)`}}return u==="date"&&c?x+=`, fino al ${pS(c)}`:u==="count"&&h&&h>0&&(x+=`, ${h} volte`),x},vS=(e,r)=>{const t=r||1;switch(e){case"daily":return t===1?"giorno":"giorni";case"weekly":return t===1?"settimana":"settimane";case"monthly":return t===1?"mese":"mesi";case"yearly":return t===1?"anno":"anni";default:return"mese"}},wS=[{label:"Lun",value:1},{label:"Mar",value:2},{label:"Mer",value:3},{label:"Gio",value:4},{label:"Ven",value:5},{label:"Sab",value:6},{label:"Dom",value:0}],yS=({isOpen:e,onClose:r,onSubmit:t,initialData:a,prefilledData:i,accounts:o,isForRecurringTemplate:u=!1})=>{var un;const c=o||[],[h,x]=I.useState(!1),[m,w]=I.useState(!1),[p,v]=I.useState({}),[y,T]=I.useState(null),[E,_]=I.useState(null),[C,S]=I.useState(null),[N,B]=I.useState(!1),[X,j]=I.useState(!1),[z,M]=I.useState(!1),[U,D]=I.useState(!1),[R,K]=I.useState(!1),[ae,te]=I.useState(!1),[oe,re]=I.useState(p.recurrence),[Z,ge]=I.useState(p.recurrenceInterval),[q,Q]=I.useState(p.recurrenceDays),[ie,ve]=I.useState(p.monthlyRecurrenceType),[pe,Ae]=I.useState(!1),[je,ze]=I.useState(!1),P=I.useRef(0),[ee,J]=I.useState(null),G=I.useRef(null),_e=I.useRef(null),F=I.useRef(null),ke=!!a,Fe=p.frequency==="recurring"&&p.recurrenceEndType==="count"&&p.recurrenceCount===1,De=I.useMemo(()=>{const Ie=p.date;if(!Ie)return"Seleziona una data di inizio valida";const $e=nc(Ie);if(!$e)return"Data non valida";const ut=$e.getDate(),be=$e.getDay(),Ye=Math.floor((ut-1)/7);return`Ogni ${Vp[Ye]} ${Hp[be]} del mese`},[p.date]),Ge=I.useCallback(()=>{const Ie=c.length>0?c[0].id:"";v({description:"",amount:"",date:vu(),time:gu(),category:"",subcategory:"",accountId:Ie,frequency:"single",tags:[],receipts:[]}),T(null),S(null)},[c]),Ve=()=>{x(!1),setTimeout(r,300)},tt=()=>{ke&&N?j(!0):Ve()},ft=()=>{m&&tt()};I.useEffect(()=>{if(e){if(a){const ut={...a,time:a.time||gu(),frequency:u?"recurring":a.frequency||"single"};v(ut),S(ut)}else if(i){const ut=c.length>0?c[0].id:"";v({description:i.description||"",amount:i.amount||"",date:i.date||vu(),time:i.time||gu(),category:i.category||"",subcategory:i.subcategory||"",accountId:i.accountId||ut,frequency:"single",tags:i.tags||[],receipts:i.receipts||[]}),S(null)}else Ge();B(!1);const Ie=setTimeout(()=>{var ut;x(!0),(ut=F.current)==null||ut.focus()},50),$e=setTimeout(()=>{w(!0)},300);return()=>{clearTimeout(Ie),clearTimeout($e),w(!1)}}else x(!1),w(!1)},[e,a,i,Ge,c,u]),I.useEffect(()=>{if(z){re(p.recurrence||"monthly"),ge(p.recurrenceInterval||1),Q(p.recurrenceDays||[]),ve(p.monthlyRecurrenceType||"dayOfMonth"),K(!1);const Ie=setTimeout(()=>D(!0),10);return()=>clearTimeout(Ie)}else D(!1)},[z,p.recurrence,p.recurrenceInterval,p.recurrenceDays,p.monthlyRecurrenceType]),I.useEffect(()=>{if(pe){const Ie=setTimeout(()=>ze(!0),10);return()=>clearTimeout(Ie)}else ze(!1)},[pe]),I.useEffect(()=>{if(!ke||!C){B(!1);return}const Ie=parseFloat(String(p.amount||"0").replace(",",".")),$e=C.amount||0,ut=Math.abs(Ie-$e)>.001,be=(p.description||"")!==(C.description||""),Ye=p.date!==C.date,Xe=!u&&(p.time||"")!==(C.time||""),ct=(p.category||"")!==(C.category||""),At=(p.subcategory||"")!==(C.subcategory||""),mr=p.accountId!==C.accountId,Kn=p.frequency!==C.frequency,bn=p.recurrence!==C.recurrence||p.recurrenceInterval!==C.recurrenceInterval||JSON.stringify(p.recurrenceDays)!==JSON.stringify(C.recurrenceDays)||p.monthlyRecurrenceType!==C.monthlyRecurrenceType||p.recurrenceEndType!==C.recurrenceEndType||p.recurrenceEndDate!==C.recurrenceEndDate||p.recurrenceCount!==C.recurrenceCount,fa=JSON.stringify(p.receipts)!==JSON.stringify(C.receipts);B(ut||be||Ye||Xe||ct||At||mr||Kn||bn||fa)},[p,C,ke,u]);const st=I.useCallback(Ie=>{const{name:$e,value:ut}=Ie.target;if($e==="recurrenceEndDate"&&ut===""){v(be=>({...be,recurrenceEndType:"forever",recurrenceEndDate:void 0}));return}if($e==="recurrenceCount"){const be=parseInt(ut,10);v(Ye=>({...Ye,[$e]:isNaN(be)||be<=0?void 0:be}))}else v(be=>({...be,[$e]:ut}))},[]),ye=(Ie,$e)=>{v(ut=>{const be={...ut,[Ie]:$e};return Ie==="category"&&(be.subcategory=""),be}),_(null)},Ce=Ie=>{const $e={};Ie==="none"?($e.frequency="single",$e.recurrence=void 0,$e.recurrenceInterval=void 0,$e.recurrenceDays=void 0,$e.recurrenceEndType=void 0,$e.recurrenceEndDate=void 0,$e.recurrenceCount=void 0,$e.monthlyRecurrenceType=void 0):Ie==="single"?($e.frequency="recurring",$e.recurrence=void 0,$e.recurrenceInterval=void 0,$e.recurrenceDays=void 0,$e.monthlyRecurrenceType=void 0,$e.recurrenceEndType="count",$e.recurrenceCount=1,$e.recurrenceEndDate=void 0):($e.frequency="recurring",$e.recurrence=p.recurrence||"monthly",$e.recurrenceEndType="forever",$e.recurrenceCount=void 0,$e.recurrenceEndDate=void 0),v(ut=>({...ut,...$e})),_(null)},le=()=>{D(!1),M(!1)},ce=()=>{v(Ie=>({...Ie,recurrence:oe,recurrenceInterval:Z||1,recurrenceDays:oe==="weekly"?q:void 0,monthlyRecurrenceType:oe==="monthly"?ie:void 0})),le()},Ee=Ie=>{const $e={recurrenceEndType:Ie};Ie==="forever"?($e.recurrenceEndDate=void 0,$e.recurrenceCount=void 0):Ie==="date"?($e.recurrenceEndDate=p.recurrenceEndDate||zp(new Date),$e.recurrenceCount=void 0):Ie==="count"&&($e.recurrenceEndDate=void 0,$e.recurrenceCount=p.recurrenceCount||1),v(ut=>({...ut,...$e})),te(!1)},Se=Ie=>{Q($e=>{const ut=$e||[];return(ut.includes(Ie)?ut.filter(Ye=>Ye!==Ie):[...ut,Ie]).sort((Ye,Xe)=>(Ye===0?7:Ye)-(Xe===0?7:Xe))})},Re=()=>{Ae(!1),ze(!1),P.current=Date.now()},at=async Ie=>{try{const $e=await xc(Ie),{base64:ut}=await Js($e);v(be=>({...be,receipts:[...be.receipts||[],ut]})),setTimeout(Re,500)}catch($e){console.error($e)}},it=Ie=>{v($e=>{const be=($e.receipts||[]).filter((Ye,Xe)=>Xe!==Ie);return{...$e,receipts:be}})},Ne=Ie=>{Ie.preventDefault();const $e=String(p.amount).replace(",",".").trim(),ut=parseFloat($e);if($e===""||isNaN(ut)||ut<=0){T("Inserisci un importo valido.");return}const be=p.date||vu();if(!p.accountId){T("Seleziona un conto.");return}T(null);const Ye={...p,amount:ut,date:be,time:p.time||void 0,description:p.description||"",category:p.category||"",subcategory:p.subcategory||void 0,tags:p.tags||[],receipts:p.receipts||[]};Ye.frequency==="recurring"&&delete Ye.time,t(ke?{...a,...Ye}:Ye)},Ke=I.useCallback(Ie=>{if(Ie.key!=="Enter")return;Ie.preventDefault(),Ie.currentTarget.blur()},[]),mt=()=>ee?gc.createPortal(f.jsxs("div",{className:"fixed inset-0 z-[6000] bg-black/95 flex items-center justify-center p-4 animate-fade-in-up",onClick:()=>J(null),children:[f.jsx("button",{className:"absolute top-4 right-4 text-white/80 hover:text-white p-2 transition-colors z-50",onClick:Ie=>{Ie.stopPropagation(),J(null)},onPointerDown:Ie=>Ie.stopPropagation(),children:f.jsx(xr,{className:"w-8 h-8"})}),f.jsx("img",{src:`data:image/png;base64,${ee}`,className:"max-w-full max-h-full object-contain rounded-sm shadow-2xl",alt:"Ricevuta Full Screen",onClick:Ie=>Ie.stopPropagation()})]}),document.body):null;if(!e)return null;const Nt=Object.keys(nn).map(Ie=>{const $e=hr(Ie);return{value:Ie,label:$e.label,Icon:$e.Icon,color:$e.color,bgColor:$e.bgColor}}),Er=p.category&&nn[p.category]?nn[p.category].map(Ie=>({value:Ie,label:Ie})):[],_r=c.map(Ie=>({value:Ie.id,label:Ie.name})),ln=[{value:"none",label:"Nessuna"},{value:"single",label:"Singolo"},{value:"recurring",label:"Ricorrente"}],Un=!p.category||p.category==="Altro"||Er.length===0,Br=({label:Ie,value:$e,onClick:ut,placeholder:be,ariaLabel:Ye,disabled:Xe,icon:ct})=>{const At=$e&&$e!==be&&$e!=="";return f.jsxs("div",{children:[f.jsx("label",{className:`block text-base font-medium mb-1 transition-colors ${Xe?"text-slate-400":"text-slate-700"}`,children:Ie}),f.jsxs("button",{type:"button",onClick:mr=>{mr.stopPropagation(),ut()},"aria-label":Ye,disabled:Xe,className:`w-full flex items-center justify-center text-center gap-2 px-3 py-2.5 text-base font-semibold rounded-lg border shadow-sm focus:outline-none focus:ring-0 transition-colors ${Xe?"bg-slate-100 border-slate-200 text-slate-400 cursor-not-allowed":At?"bg-indigo-50 border-indigo-200 text-indigo-700 hover:bg-indigo-100":"bg-white border-slate-300 text-slate-500 hover:bg-slate-50"}`,children:[ct,f.jsx("span",{className:"truncate",children:$e||be})]})]})},sr=()=>{const{recurrenceEndType:Ie}=p;return!Ie||Ie==="forever"?"Per sempre":Ie==="date"?"Fino a":Ie==="count"?"Numero di volte":"Per sempre"},Ur=(un=c.find(Ie=>Ie.id===p.accountId))==null?void 0:un.name,cn=p.category?hr(p.category).label:void 0;return f.jsx(f.Fragment,{children:f.jsxs("div",{className:`fixed inset-0 z-[5000] transition-opacity duration-300 ease-in-out ${h?"opacity-100":"opacity-0"} bg-slate-900/60 backdrop-blur-sm`,onClick:ft,"aria-modal":"true",role:"dialog",children:[f.jsxs("div",{className:`bg-slate-50 w-full h-full flex flex-col absolute bottom-0 transform transition-transform duration-300 ease-in-out ${h?"translate-y-0":"translate-y-full"}`,onClick:Ie=>Ie.stopPropagation(),style:{touchAction:"pan-y"},children:[f.jsxs("header",{className:"flex justify-between items-center p-6 border-b border-slate-200 flex-shrink-0",children:[f.jsx("h2",{ref:F,tabIndex:-1,className:"text-2xl font-bold text-slate-800 focus:outline-none",children:ke?"Modifica Spesa":"Aggiungi Spesa"}),f.jsx("button",{type:"button",onClick:tt,className:"text-slate-500 hover:text-slate-800 transition-colors p-1 rounded-full hover:bg-slate-200 focus:outline-none focus:ring-2 focus:ring-indigo-500","aria-label":"Chiudi",children:f.jsx(xr,{className:"w-6 h-6"})})]}),f.jsxs("form",{onSubmit:Ne,noValidate:!0,className:"flex-1 flex flex-col overflow-hidden",children:[f.jsxs("div",{className:"p-6 space-y-4 flex-1 overflow-y-auto",children:[f.jsx(Gu,{ref:_e,id:"description",name:"description",label:"Descrizione (opzionale)",value:p.description||"",onChange:st,icon:f.jsx(Cf,{className:"h-5 w-5 text-slate-400"}),type:"text",placeholder:"Es. Caff al bar"}),f.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[f.jsx(Gu,{ref:G,id:"amount",name:"amount",label:"Importo",value:p.amount||"",onChange:st,onKeyDown:Ke,icon:f.jsx($u,{className:"h-5 w-5 text-slate-400"}),type:"text",inputMode:"decimal",pattern:"[0-9]*[.,]?[0-9]*",placeholder:"0.00",required:!0,autoComplete:"off"}),f.jsxs("div",{className:`grid ${p.frequency==="recurring"?"grid-cols-1":"grid-cols-2"} gap-2`,children:[f.jsxs("div",{children:[f.jsx("label",{htmlFor:"date",className:"block text-base font-medium text-slate-700 mb-1",children:Fe?"Data del Pagamento":p.frequency==="recurring"?"Data di Inizio":"Data"}),f.jsxs("div",{className:"relative",children:[f.jsx("div",{className:"pointer-events-none absolute inset-y-0 left-0 flex items-center pl-3",children:f.jsx(Xu,{className:"h-5 w-5 text-slate-400"})}),f.jsx("input",{id:"date",name:"date",value:p.date||"",onChange:st,className:"block w-full rounded-md border border-slate-300 bg-white py-2.5 pl-10 pr-3 text-slate-900 placeholder:text-slate-400 focus:outline-none focus:border-indigo-500 focus:ring-1 focus:ring-indigo-500 text-base",type:"date"})]})]}),p.frequency!=="recurring"&&f.jsxs("div",{children:[f.jsx("label",{htmlFor:"time",className:"block text-base font-medium text-slate-700 mb-1",children:"Ora (opz.)"}),f.jsxs("div",{className:"relative",children:[f.jsx("div",{className:"pointer-events-none absolute inset-y-0 left-0 flex items-center pl-3",children:f.jsx(Bp,{className:"h-5 w-5 text-slate-400"})}),f.jsx("input",{id:"time",name:"time",value:p.time||"",onChange:st,className:"block w-full rounded-md border border-slate-300 bg-white py-2.5 pl-10 pr-3 text-slate-900 placeholder:text-slate-400 focus:outline-none focus:border-indigo-500 focus:ring-1 focus:ring-indigo-500 text-base",type:"time"})]})]})]})]}),f.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-4",children:[f.jsx(Br,{label:"Conto",value:Ur,onClick:()=>_("account"),placeholder:"Seleziona",ariaLabel:"Seleziona conto di pagamento",icon:f.jsx(vc,{className:"h-5 w-5"})}),f.jsx(Br,{label:"Categoria (opzionale)",value:cn,onClick:()=>_("category"),placeholder:"Seleziona",ariaLabel:"Seleziona categoria",icon:f.jsx(fo,{className:"h-5 w-5"})}),f.jsx(Br,{label:"Sottocategoria (opzionale)",value:p.subcategory,onClick:()=>_("subcategory"),placeholder:"Seleziona",ariaLabel:"Seleziona sottocategoria",disabled:Un,icon:f.jsx(fo,{className:"h-5 w-5"})})]}),f.jsxs("div",{className:"animate-fade-in-up",children:[f.jsx("label",{className:"block text-base font-medium text-slate-700 mb-1",children:"Ricevute"}),p.receipts&&p.receipts.length>0&&f.jsx("div",{className:"grid grid-cols-2 gap-3 mb-3",children:p.receipts.map((Ie,$e)=>f.jsxs("div",{className:"relative rounded-lg overflow-hidden border border-slate-200 shadow-sm aspect-video bg-slate-50 cursor-pointer hover:border-indigo-300 transition-colors",onClick:()=>J(Ie),children:[f.jsx("img",{src:`data:image/png;base64,${Ie}`,alt:"Ricevuta",className:"w-full h-full object-cover"}),f.jsx("button",{type:"button",onClick:ut=>{ut.stopPropagation(),it($e)},onPointerDown:ut=>ut.stopPropagation(),className:"absolute top-1 right-1 p-1 bg-white/90 text-red-600 rounded-full shadow-md hover:bg-red-50 hover:text-red-700 transition-colors z-10 flex items-center justify-center","aria-label":"Rimuovi ricevuta",children:f.jsx(xr,{className:"w-5 h-5"})})]},$e))}),f.jsxs("button",{type:"button",onClick:()=>{Date.now()-P.current<500||Ae(!0)},className:"w-full flex items-center justify-center gap-2 px-3 py-2.5 text-base rounded-lg border border-dashed border-indigo-300 bg-indigo-50 text-indigo-600 hover:bg-indigo-100 hover:border-indigo-400 transition-colors focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500",children:[f.jsx(Up,{className:"w-5 h-5"}),f.jsx("span",{children:p.receipts&&p.receipts.length>0?"Aggiungi un'altra ricevuta":"Allega Ricevuta"})]})]}),u&&f.jsxs("div",{className:"bg-white p-4 rounded-lg border border-slate-200 space-y-4",children:[f.jsxs("div",{children:[f.jsx("label",{className:"block text-base font-medium text-slate-700 mb-1",children:"Frequenza"}),f.jsxs("button",{type:"button",onClick:()=>_("frequency"),className:"w-full flex items-center justify-between text-left gap-2 px-3 py-2.5 text-base rounded-lg border shadow-sm focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 transition-colors bg-white border-slate-300 text-slate-800 hover:bg-slate-50",children:[f.jsx("span",{className:"truncate flex-1 capitalize",children:Fe?"Singolo":p.frequency!=="recurring"?"Nessuna":"Ricorrente"}),f.jsx(En,{className:"w-5 h-5 text-slate-500"})]})]}),p.frequency==="recurring"&&!Fe&&f.jsxs("div",{className:"animate-fade-in-up",children:[f.jsx("label",{className:"block text-base font-medium text-slate-700 mb-1",children:"Ricorrenza"}),f.jsxs("button",{type:"button",onClick:()=>M(!0),className:"w-full flex items-center justify-between text-left gap-2 px-3 py-2.5 text-base rounded-lg border shadow-sm focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 transition-colors bg-white border-slate-300 text-slate-800 hover:bg-slate-50",children:[f.jsx("span",{className:"truncate flex-1",children:gS(p)}),f.jsx(En,{className:"w-5 h-5 text-slate-500"})]})]})]}),y&&f.jsx("p",{className:"text-base text-red-600 bg-red-100 p-3 rounded-md",children:y})]}),f.jsx("footer",{className:`px-6 py-4 bg-slate-100 border-t border-slate-200 flex flex-shrink-0 ${ke&&!N?"justify-stretch":"justify-end gap-3"}`,children:ke&&!N?f.jsx("button",{type:"button",onClick:tt,className:"w-full px-4 py-2 text-base font-semibold text-slate-700 bg-white border border-slate-300 rounded-lg shadow-sm hover:bg-slate-100 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2 transition-colors",children:"Chiudi"}):f.jsxs(f.Fragment,{children:[f.jsx("button",{type:"button",onClick:tt,className:"px-4 py-2 text-base font-semibold text-slate-700 bg-white border border-slate-300 rounded-lg shadow-sm hover:bg-slate-100 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2 transition-colors",children:"Annulla"}),f.jsx("button",{type:"submit",className:"px-4 py-2 text-base font-semibold text-white bg-indigo-600 rounded-lg shadow-sm hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2 transition-colors",children:ke?"Salva Modifiche":"Aggiungi Spesa"})]})})]})]}),f.jsx(Ln,{isOpen:E==="account",onClose:()=>_(null),title:"Seleziona un Conto",options:_r,selectedValue:p.accountId||"",onSelect:Ie=>ye("accountId",Ie)}),f.jsx(Ln,{isOpen:E==="category",onClose:()=>_(null),title:"Seleziona una Categoria",options:Nt,selectedValue:p.category||"",onSelect:Ie=>ye("category",Ie)}),f.jsx(Ln,{isOpen:E==="subcategory",onClose:()=>_(null),title:"Seleziona Sottocategoria",options:Er,selectedValue:p.subcategory||"",onSelect:Ie=>ye("subcategory",Ie)}),f.jsx(Ln,{isOpen:E==="frequency",onClose:()=>_(null),title:"Imposta Frequenza",options:ln,selectedValue:Fe?"single":p.frequency!=="recurring"?"none":"recurring",onSelect:Ce}),z&&f.jsx("div",{className:`fixed inset-0 z-[60] flex justify-center items-center p-4 transition-opacity duration-300 ease-in-out ${U?"opacity-100":"opacity-0"} bg-slate-900/60 backdrop-blur-sm`,onClick:le,"aria-modal":"true",role:"dialog",children:f.jsxs("div",{className:`bg-white rounded-lg shadow-xl w-full max-w-sm transform transition-all duration-300 ease-in-out ${U?"scale-100 opacity-100":"scale-95 opacity-0"}`,onClick:Ie=>Ie.stopPropagation(),children:[f.jsxs("header",{className:"flex justify-between items-center p-4 border-b border-slate-200",children:[f.jsx("h2",{className:"text-lg font-bold text-slate-800",children:"Imposta Ricorrenza"}),f.jsx("button",{type:"button",onClick:le,className:"text-slate-500 hover:text-slate-800 transition-colors p-1 rounded-full hover:bg-slate-200 focus:outline-none focus:ring-2 focus:ring-indigo-500","aria-label":"Chiudi",children:f.jsx(xr,{className:"w-6 h-6"})})]}),f.jsxs("main",{className:"p-4 space-y-4",children:[f.jsxs("div",{className:"relative",children:[f.jsxs("button",{onClick:()=>{K(Ie=>!Ie),te(!1)},className:"w-full flex items-center justify-between text-left gap-2 px-3 py-2.5 text-base rounded-lg border shadow-sm focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 transition-colors bg-white border-slate-300 text-slate-800 hover:bg-slate-50",children:[f.jsx("span",{className:"truncate flex-1 capitalize",children:zl[oe]||"Seleziona"}),f.jsx(En,{className:`w-5 h-5 text-slate-500 transition-transform ${R?"rotate-180":""}`})]}),R&&f.jsx("div",{className:"absolute top-full mt-1 w-full bg-white border border-slate-200 shadow-lg rounded-lg z-20 p-2 space-y-1 animate-fade-in-down",children:Object.keys(zl).map(Ie=>f.jsx("button",{onClick:()=>{re(Ie),K(!1)},className:"w-full text-left px-4 py-3 text-base font-semibold rounded-lg transition-colors bg-slate-50 text-slate-800 hover:bg-indigo-100 hover:text-indigo-800",children:zl[Ie]},Ie))})]}),f.jsx("div",{className:"animate-fade-in-up pt-2",children:f.jsxs("div",{className:"flex items-center justify-center gap-2 bg-slate-100 p-3 rounded-lg",children:[f.jsx("span",{className:"text-base text-slate-700",children:"Ogni"}),f.jsx("input",{type:"number",value:Z||"",onChange:Ie=>{const $e=Ie.target.value;if($e==="")ge(void 0);else{const ut=parseInt($e,10);!isNaN(ut)&&ut>0&&ge(ut)}},onFocus:Ie=>Ie.currentTarget.select(),className:"w-12 text-center text-lg font-bold text-slate-800 bg-transparent border-0 border-b-2 border-slate-400 focus:ring-0 focus:outline-none focus:border-indigo-600 p-0",min:"1"}),f.jsx("span",{className:"text-base text-slate-700",children:vS(oe,Z)})]})}),oe==="weekly"&&f.jsx("div",{className:"animate-fade-in-up pt-2",children:f.jsx("div",{className:"flex flex-wrap justify-center gap-2",children:wS.map(Ie=>f.jsx("button",{onClick:()=>Se(Ie.value),className:`w-14 h-14 rounded-full text-sm font-semibold transition-colors focus:outline-none border-2 ${(q||[]).includes(Ie.value)?"bg-indigo-600 text-white border-indigo-600":"bg-white text-slate-800 border-indigo-400 hover:bg-indigo-50"}`,children:Ie.label},Ie.value))})}),oe==="monthly"&&f.jsxs("div",{className:"animate-fade-in-up pt-4 space-y-2 border-t border-slate-200",children:[f.jsxs("div",{role:"radio","aria-checked":ie==="dayOfMonth",onClick:()=>ve("dayOfMonth"),className:"flex items-center gap-3 p-2 cursor-pointer rounded-lg hover:bg-slate-100",children:[f.jsx("div",{className:"w-5 h-5 rounded-full border-2 border-slate-400 flex items-center justify-center flex-shrink-0",children:ie==="dayOfMonth"&&f.jsx("div",{className:"w-2.5 h-2.5 bg-indigo-600 rounded-full"})}),f.jsx("label",{className:"text-sm font-medium text-slate-700 cursor-pointer",children:"Lo stesso giorno di ogni mese"})]}),f.jsxs("div",{role:"radio","aria-checked":ie==="dayOfWeek",onClick:()=>ve("dayOfWeek"),className:"flex items-center gap-3 p-2 cursor-pointer rounded-lg hover:bg-slate-100",children:[f.jsx("div",{className:"w-5 h-5 rounded-full border-2 border-slate-400 flex items-center justify-center flex-shrink-0",children:ie==="dayOfWeek"&&f.jsx("div",{className:"w-2.5 h-2.5 bg-indigo-600 rounded-full"})}),f.jsx("label",{className:"text-sm font-medium text-slate-700 cursor-pointer",children:De})]})]}),f.jsx("div",{className:"pt-4 border-t border-slate-200",children:f.jsxs("div",{className:"grid grid-cols-2 gap-4 items-end",children:[f.jsxs("div",{className:`relative ${!p.recurrenceEndType||p.recurrenceEndType==="forever"?"col-span-2":""}`,children:[f.jsxs("button",{type:"button",onClick:()=>{te(Ie=>!Ie),K(!1)},className:"w-full flex items-center justify-between text-left gap-2 px-3 py-2.5 text-base rounded-lg border shadow-sm focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 transition-colors bg-white border-slate-300 text-slate-800 hover:bg-slate-50",children:[f.jsx("span",{className:"truncate flex-1 capitalize",children:sr()}),f.jsx(En,{className:`w-5 h-5 text-slate-500 transition-transform ${ae?"rotate-180":""}`})]}),ae&&f.jsx("div",{className:"absolute top-full mt-1 w-full bg-white border border-slate-200 shadow-lg rounded-lg z-10 p-2 space-y-1 animate-fade-in-down",children:["forever","date","count"].map(Ie=>f.jsx("button",{onClick:()=>Ee(Ie),className:"w-full text-left px-4 py-3 text-base font-semibold rounded-lg transition-colors bg-slate-50 text-slate-800 hover:bg-indigo-100 hover:text-indigo-800",children:Ie==="forever"?"Per sempre":Ie==="date"?"Fino a":"Numero di volte"},Ie))})]}),p.recurrenceEndType==="date"&&f.jsx("div",{className:"animate-fade-in-up",children:f.jsxs("label",{htmlFor:"recurrence-end-date",className:"relative w-full flex items-center justify-center gap-2 px-3 py-2.5 text-base rounded-lg focus-within:ring-2 focus-within:ring-offset-2 focus-within:ring-indigo-500 text-indigo-600 hover:bg-indigo-100 font-semibold cursor-pointer h-[46.5px]",children:[f.jsx(Xu,{className:"w-5 h-5"}),f.jsx("span",{children:p.recurrenceEndDate?Lp(nc(p.recurrenceEndDate)):"Seleziona"}),f.jsx("input",{type:"date",id:"recurrence-end-date",name:"recurrenceEndDate",value:p.recurrenceEndDate||"",onChange:Ie=>v($e=>({...$e,recurrenceEndDate:Ie.target.value,recurrenceEndType:"date"})),className:"absolute inset-0 opacity-0 w-full h-full cursor-pointer"})]})}),p.recurrenceEndType==="count"&&f.jsx("div",{className:"animate-fade-in-up",children:f.jsx("div",{className:"relative",children:f.jsx("input",{type:"number",id:"recurrence-count",name:"recurrenceCount",value:p.recurrenceCount||"",onChange:st,className:"block w-full text-center rounded-md border border-slate-300 bg-white py-2.5 text-slate-900 placeholder:text-slate-400 focus:outline-none focus:border-indigo-500 focus:ring-1 focus:ring-indigo-500 text-base",placeholder:"N.",min:"1"})})})]})})]}),f.jsx("footer",{className:"p-4 bg-slate-100 border-t border-slate-200 flex justify-end",children:f.jsx("button",{type:"button",onClick:ce,className:"px-4 py-2 text-sm font-semibold text-white bg-indigo-600 rounded-lg shadow-sm hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2 transition-colors",children:"Applica"})})]})}),pe&&f.jsx("div",{className:`fixed inset-0 z-[5200] flex justify-center items-center p-4 bg-slate-900/60 backdrop-blur-sm transition-opacity duration-300 ease-in-out ${je?"opacity-100":"opacity-0"}`,onClick:Re,children:f.jsxs("div",{className:"bg-slate-50 rounded-lg shadow-xl w-full max-w-sm",onClick:Ie=>Ie.stopPropagation(),children:[f.jsxs("header",{className:"flex justify-between items-center p-4 border-b border-slate-200",children:[f.jsx("h2",{className:"text-lg font-bold text-slate-800",children:"Allega Ricevuta"}),f.jsx("button",{onClick:Re,className:"p-1 rounded-full hover:bg-slate-200",children:f.jsx(xr,{className:"w-6 h-6"})})]}),f.jsxs("div",{className:"p-4 grid grid-cols-2 gap-4",children:[f.jsxs("button",{onClick:()=>at("camera"),className:"flex flex-col items-center justify-center gap-2 p-4 rounded-xl bg-white border border-slate-200 hover:bg-indigo-50 hover:border-indigo-200 transition-colors",children:[f.jsx("div",{className:"w-10 h-10 rounded-full bg-indigo-100 flex items-center justify-center text-indigo-600",children:f.jsx(Af,{className:"w-6 h-6"})}),f.jsx("span",{className:"font-semibold text-slate-700 text-sm",children:"Fotocamera"})]}),f.jsxs("button",{onClick:()=>at("gallery"),className:"flex flex-col items-center justify-center gap-2 p-4 rounded-xl bg-white border border-slate-200 hover:bg-indigo-50 hover:border-indigo-200 transition-colors",children:[f.jsx("div",{className:"w-10 h-10 rounded-full bg-purple-100 flex items-center justify-center text-purple-600",children:f.jsx(pc,{className:"w-6 h-6"})}),f.jsx("span",{className:"font-semibold text-slate-700 text-sm",children:"Galleria"})]})]})]})}),mt(),f.jsx(ei,{isOpen:X,onClose:()=>j(!1),onConfirm:()=>{j(!1),Ve()},title:"Annullare le modifiche?",message:"Sei sicuro di voler chiudere senza salvare? Le modifiche andranno perse.",variant:"danger",confirmButtonText:"S, annulla",cancelButtonText:"No, continua"})]})})},kS=e=>f.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:2,stroke:"currentColor",...e,children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 4.5v15m7.5-7.5h-15"})}),Wp=e=>f.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...e,children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 18.75a6 6 0 0 0 6-6v-1.5m-6 7.5a6 6 0 0 1-6-6v-1.5m6 7.5v3.75m-3.75 0h7.5M12 15.75a3 3 0 0 1-3-3V4.5a3 3 0 0 1 6 0v8.25a3 3 0 0 1-3 3Z"})}),ES=e=>f.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...e,children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m16.862 4.487 1.687-1.688a1.875 1.875 0 1 1 2.652 2.652L6.832 19.82a4.5 4.5 0 0 1-1.897 1.13l-2.685.8.8-2.685a4.5 4.5 0 0 1 1.13-1.897L16.863 4.487Zm0 0L19.5 7.125"})}),_S=({onAddManually:e,onAddFromImage:r,onAddFromVoice:t,style:a})=>{const[i,o]=I.useState(!1),[u,c]=I.useState(!1),[h,x]=I.useState(!1),m=I.useRef(null),w=I.useRef(null);I.useEffect(()=>{const E=setTimeout(()=>c(!0),100);return()=>clearTimeout(E)},[]),I.useEffect(()=>(i?x(!0):(w.current&&clearTimeout(w.current),w.current=window.setTimeout(()=>{x(!1)},300)),()=>{w.current&&clearTimeout(w.current)}),[i]),I.useEffect(()=>(m.current&&clearTimeout(m.current),i&&(m.current=window.setTimeout(()=>{o(!1)},5e3)),()=>{m.current&&clearTimeout(m.current)}),[i]);const p=E=>{E(),o(!1)},v=[{label:"Aggiungi Manualmente",icon:f.jsx(ES,{className:"w-7 h-7"}),onClick:()=>p(e),bgColor:"bg-indigo-500",hoverBgColor:"hover:bg-indigo-600"},{label:"Aggiungi da Immagine",icon:f.jsx(pc,{className:"w-7 h-7"}),onClick:()=>p(r),bgColor:"bg-sky-600",hoverBgColor:"hover:bg-sky-700"},{label:"Aggiungi con Voce",icon:f.jsx(Wp,{className:"w-7 h-7"}),onClick:()=>p(t),bgColor:"bg-purple-600",hoverBgColor:"hover:bg-purple-700"}],T={...{bottom:"calc(1.5rem + env(safe-area-inset-bottom, 0px))",right:"calc(1.5rem + env(safe-area-inset-right, 0px))",transition:"bottom 300ms cubic-bezier(0.22, 0.61, 0.36, 1)"},...a};return f.jsxs("div",{className:"fixed z-[1050] flex flex-col items-center",style:T,children:[f.jsx("div",{className:"flex flex-col-reverse items-center gap-4 mb-4",children:h&&v.map((E,_)=>f.jsx("div",{className:`transition-all duration-300 ease-in-out ${i?"opacity-100 translate-y-0":"opacity-0 translate-y-4"}`,style:{transitionDelay:i?`${(v.length-1-_)*50}ms`:"0ms"},children:f.jsx("button",{onClick:E.onClick,tabIndex:i?0:-1,className:`flex justify-center items-center w-14 h-14 ${E.bgColor} text-white rounded-full shadow-lg ${E.hoverBgColor} focus:outline-none`,"aria-label":E.label,children:E.icon})},E.label))}),f.jsx("button",{onClick:()=>o(!i),className:`pointer-events-auto flex justify-center items-center w-16 h-16 bg-indigo-600 text-white rounded-full shadow-lg hover:bg-indigo-700 transition-all transform duration-500 ease-in-out focus:outline-none ${u?"opacity-100 translate-y-0 scale-100":"opacity-0 translate-y-16 scale-90"}`,"aria-expanded":i,"aria-label":i?"Chiudi menu azioni":"Apri menu azioni",children:f.jsx("div",{className:`transition-transform duration-300 ease-in-out ${i?"rotate-45":""}`,children:f.jsx(kS,{className:"w-8 h-8"})})})]})},TS="https://script.google.com/macros/s/AKfycbyZpH2rET4JNs35Ye_tewdpszsHLLRfLr6C-7qFKH_Xe1zg_vhHB8kaRyWQjAqG7-frVg/exec",SS=3e4;async function $p(e){const r=new AbortController,t=setTimeout(()=>r.abort(),SS);try{console.log(`[AI] Invio richiesta... Payload size: ${JSON.stringify(e).length}`);const a=await fetch(TS,{method:"POST",mode:"cors",cache:"no-cache",credentials:"omit",headers:{"Content-Type":"text/plain;charset=utf-8"},body:JSON.stringify(e),signal:r.signal});if(clearTimeout(t),!a.ok){const o=await a.text();throw console.error(`[AI] Errore HTTP ${a.status}:`,o),new Error(`Errore server: ${a.status}`)}const i=await a.text();try{return JSON.parse(i)}catch{throw console.error("[AI] Errore parsing JSON. Risposta grezza:",i),new Error("Il server ha restituito una risposta non valida.")}}catch(a){throw clearTimeout(t),console.error("AI Call Error:",a),a.name==="AbortError"?new Error("Tempo scaduto. Il server ci sta mettendo troppo tempo."):a}}async function CS(e){return new Promise((r,t)=>{const a=new FileReader;a.onloadend=()=>{const i=a.result,o=i.indexOf(",");r(o===-1?i:i.slice(o+1))},a.onerror=t,a.readAsDataURL(e)})}async function bS(e,r){const t=await $p({action:"parseImage",imageBase64:e,mimeType:r});if(!t.ok)throw new Error(t.error||"Errore analisi immagine.");return t.expenses||[]}async function Xp(e){if(!e||e.size===0)throw new Error("Registrazione vuota o non valida.");const r=e.type||"audio/webm",t=await CS(e),a=await $p({action:"parseVoice",audioBase64:t,mimeType:r});if(!a.ok)throw new Error(a.error||"Errore analisi vocale.");return a.expense||null}const NS=Object.freeze(Object.defineProperty({__proto__:null,parseExpenseFromAudio:Xp,parseExpensesFromImage:bS},Symbol.toStringTag,{value:"Module"})),AS=({isOpen:e,onClose:r,onParsed:t})=>{const[a,i]=I.useState(!1),[o,u]=I.useState("idle"),[c,h]=I.useState(""),[x,m]=I.useState(null),w=I.useRef(null),p=I.useRef(null),v=I.useRef([]),y=I.useRef(!1),T=I.useRef(null),E=I.useRef(null),_=I.useRef(null),C=I.useRef(null),S=I.useRef(null),N=()=>{if(C.current!==null&&(cancelAnimationFrame(C.current),C.current=null),E.current=null,_.current=null,T.current){try{T.current.close()}catch{}T.current=null}},B=()=>{try{w.current&&w.current.state!=="inactive"&&w.current.stop()}catch(ae){console.warn("Errore nello stop del MediaRecorder:",ae)}p.current&&p.current.getTracks().forEach(ae=>ae.stop()),w.current=null,p.current=null,v.current=[],N()},X=async ae=>{try{const te=window.AudioContext||window.webkitAudioContext;if(!te){console.warn("AudioContext non supportato: niente visualizzazione onda.");return}const oe=new te;if(T.current=oe,oe.state==="suspended")try{await oe.resume()}catch{}const re=oe.createMediaStreamSource(ae),Z=oe.createAnalyser();Z.fftSize=256,re.connect(Z),E.current=Z;const ge=Z.frequencyBinCount;_.current=new Uint8Array(ge);const q=()=>{if(!E.current||!_.current||!S.current)return;E.current.getByteTimeDomainData(_.current);let Q=0;for(let pe=0;pe<ge;pe++){const Ae=_.current[pe];Q+=Math.abs(Ae-128)}const ve=.2+Q/ge/128*1.8;S.current.style.transform=`scaleY(${ve})`,C.current=requestAnimationFrame(q)};q()}catch(te){console.warn("Errore inizializzando la visualizzazione audio:",te)}},j=async()=>{m(null),h(""),y.current=!1;try{const ae=await navigator.mediaDevices.getUserMedia({audio:!0});p.current=ae;const te=MediaRecorder.isTypeSupported("audio/webm;codecs=opus")?"audio/webm;codecs=opus":"audio/webm",oe=new MediaRecorder(ae,{mimeType:te});w.current=oe,v.current=[],oe.ondataavailable=re=>{re.data&&re.data.size>0&&v.current.push(re.data)},oe.onstop=async()=>{if(y.current)return;const re=new Blob(v.current,{type:te});u("processing");try{const Z=await Xp(re);if(y.current)return;if(Z&&typeof Z.amount=="number"&&!Number.isNaN(Z.amount))h(Z.description??""),t({description:Z.description??"",amount:Z.amount,category:Z.category||void 0});else if(Z&&Z.description)h(Z.description),t({description:Z.description,amount:Z.amount,category:Z.category||void 0});else{m('Non sono riuscito a capire la spesa. Prova a dire, ad esempio: "25 euro per spesa al supermercato, categoria Spesa".'),u("error");return}}catch(Z){if(y.current)return;console.error("[Voice] Errore durante analisi audio:",Z),m("Si  verificato un errore durante l'analisi vocale."),u("error");return}finally{B()}},oe.start(),u("listening"),await X(ae)}catch(ae){console.error("[Voice] Accesso microfono fallito:",ae),m("Accesso al microfono negato. Controlla le autorizzazioni del browser / PWA."),u("error")}},z=()=>{o==="listening"&&(w.current&&w.current.state==="recording"&&w.current.stop(),p.current&&p.current.getTracks().forEach(ae=>ae.stop()))},M=()=>{y.current=!0,B(),u("idle"),m(null),h(""),r()};if(I.useEffect(()=>{if(e){const ae=setTimeout(()=>i(!0),10);return j(),()=>{clearTimeout(ae),y.current=!0,B()}}else i(!1),u("idle"),m(null),h(""),y.current=!0,B()},[e]),!e)return null;const U=()=>{switch(o){case"listening":return{icon:f.jsxs("button",{type:"button",onClick:z,className:"relative w-28 h-28 flex items-center justify-center focus:outline-none","aria-label":"Termina registrazione e analizza",children:[f.jsx("div",{className:"absolute inset-0 rounded-full bg-red-500/30 animate-ping"}),f.jsx("div",{className:"relative w-24 h-24 rounded-full bg-red-500 flex items-center justify-center shadow-lg",children:f.jsx(Wp,{className:"w-12 h-12 text-white"})}),f.jsx("div",{className:"absolute -right-6 h-20 w-3 rounded-full bg-red-200 overflow-hidden flex items-end",children:f.jsx("div",{ref:S,className:"w-full bg-red-600 origin-bottom",style:{transform:"scaleY(0.2)"}})})]}),text:"In ascolto...",subtext:"Parla vicino al microfono. Quando hai finito, tocca il cerchio rosso per analizzare la spesa."};case"processing":return{icon:f.jsx("div",{className:"w-24 h-24 rounded-full bg-indigo-500 flex items-center justify-center",children:f.jsx("div",{className:"w-12 h-12 animate-spin rounded-full border-4 border-t-transparent border-white"})}),text:"Elaborazione...",subtext:"Sto analizzando la tua registrazione."};case"error":return{icon:f.jsx("div",{className:"w-24 h-24 rounded-full bg-red-100 flex items-center justify-center",children:f.jsx(xr,{className:"w-12 h-12 text-red-500"})}),text:"Errore",subtext:x||"Qualcosa  andato storto."};default:return{icon:null,text:"",subtext:""}}},{icon:D,text:R,subtext:K}=U();return f.jsx("div",{className:`fixed inset-0 z-50 flex justify-center items-center p-4 transition-opacity duration-300 ease-in-out ${a?"opacity-100":"opacity-0"} bg-slate-900/50 backdrop-blur-sm`,onClick:M,"aria-modal":"true",role:"dialog",children:f.jsxs("div",{className:`bg-slate-50 rounded-lg shadow-xl w-full max-w-lg transform transition-all duration-300 ease-in-out ${a?"scale-100 opacity-100":"scale-95 opacity-0"}`,onClick:ae=>ae.stopPropagation(),children:[f.jsxs("div",{className:"flex justify-between items-center p-6 border-b border-slate-200",children:[f.jsx("h2",{className:"text-xl font-bold text-slate-800",children:"Aggiungi con Voce"}),f.jsx("button",{type:"button",onClick:M,className:"text-slate-500 hover:text-slate-800 transition-colors p-1 rounded-full hover:bg-slate-200 focus:outline-none focus:ring-2 focus:ring-indigo-500","aria-label":"Chiudi",children:f.jsx(xr,{className:"w-6 h-6"})})]}),f.jsxs("div",{className:"p-6 flex flex-col items-center justify-center min-h-[300px] text-center",children:[D,f.jsx("p",{className:"text-xl font-semibold text-slate-800 mt-6",children:R}),f.jsx("p",{className:"text-slate-500 mt-2",children:K}),c&&f.jsxs("div",{className:"mt-6 p-3 bg-slate-100 rounded-md w-full text-left",children:[f.jsx("p",{className:"text-sm text-slate-600 font-medium",children:"Descrizione rilevata:"}),f.jsx("p",{className:"text-slate-800 break-words",children:c})]}),o==="error"&&f.jsx("button",{type:"button",onClick:j,className:"mt-6 px-4 py-2 rounded-lg bg-indigo-600 text-white font-semibold hover:bg-indigo-700 transition-colors",children:"Riprova registrazione"})]})]})})},FS=e=>f.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...e,children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m16.862 4.487 1.687-1.688a1.875 1.875 0 1 1 2.652 2.652L10.582 16.07a4.5 4.5 0 0 1-1.897 1.13L6 18l.8-2.685a4.5 4.5 0 0 1 1.13-1.897l8.932-8.931Zm0 0L19.5 7.125M18 14v4.75A2.25 2.25 0 0 1 15.75 21H5.25A2.25 2.25 0 0 1 3 18.75V8.25A2.25 2.25 0 0 1 5.25 6H10"})}),Cx=e=>{const r=e.getFullYear(),t=String(e.getMonth()+1).padStart(2,"0"),a=String(e.getDate()).padStart(2,"0");return`${r}-${t}-${a}`},IS=()=>new Date().toLocaleTimeString("it-IT",{hour:"2-digit",minute:"2-digit"}),bx=({checked:e,onChange:r,id:t,label:a})=>f.jsxs("div",{className:"flex items-center",children:[f.jsx("input",{id:t,type:"checkbox",checked:e,onChange:r,className:"h-5 w-5 rounded border-slate-300 text-indigo-600 focus:ring-indigo-500 cursor-pointer"}),f.jsx("label",{htmlFor:t,className:"ml-2 text-sm font-medium text-slate-700 sr-only",children:a})]}),wu=({label:e,value:r,onClick:t,placeholder:a,ariaLabel:i,disabled:o,icon:u})=>{const c=r&&r!==a&&r!=="";return f.jsxs("div",{children:[f.jsx("label",{className:`block text-sm font-medium text-slate-700 mb-1 transition-colors ${o?"text-slate-400":"text-slate-700"}`,children:e}),f.jsx("button",{type:"button",onClick:t,"aria-label":i,disabled:o,className:`w-full flex items-center justify-between text-left gap-2 px-3 py-2.5 text-sm rounded-lg border shadow-sm focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 transition-colors ${o?"bg-slate-100 border-slate-200 text-slate-400 cursor-not-allowed":c?"bg-indigo-50 border-indigo-200 text-indigo-700 hover:bg-indigo-100":"bg-white border-slate-300 text-slate-500 hover:bg-slate-50"}`,children:f.jsxs("div",{className:"flex items-center gap-2 min-w-0",children:[u,f.jsx("span",{className:"truncate",children:r||a})]})})]})},DS=({isOpen:e,onClose:r,expenses:t,accounts:a,onConfirm:i})=>{var D;const[o,u]=I.useState(!1),[c,h]=I.useState([]),[x,m]=I.useState(new Set),[w,p]=I.useState(null),[v,y]=I.useState(null);I.useEffect(()=>{if(e){const R=a.length>0?a[0].id:"",K=t.map(te=>({...te,accountId:te.accountId||R}));h(K),m(new Set(t.map((te,oe)=>oe))),p(null),y(null);const ae=setTimeout(()=>u(!0),10);return()=>clearTimeout(ae)}else u(!1)},[e,t,a]);const T=R=>{const K=new Set(x);K.has(R)?K.delete(R):K.add(R),m(K)},E=()=>{x.size===c.length?m(new Set):m(new Set(c.map((R,K)=>K)))},_=(R,K,ae)=>{h(te=>te.map((oe,re)=>{if(re!==R)return oe;const Z={...oe,[K]:ae};return K==="category"&&(Z.subcategory=""),Z}))},C=(R,K)=>{v&&(_(v.index,R,K),y(null))},S=R=>{p(K=>K===R?null:R)},N=()=>{const R=c.filter((K,ae)=>x.has(ae)).map(K=>({description:K.description||"Senza descrizione",amount:K.amount,date:K.date||Cx(new Date),time:K.time||IS(),category:K.category||"Altro",subcategory:K.subcategory||void 0,accountId:K.accountId,tags:K.tags||[],receipts:[]})).filter(K=>K.amount>0);R.length>0&&i(R),r()};if(!e)return null;const B=x.size===c.length&&c.length>0,X=Cx(new Date),j=Object.keys(nn).map(R=>({value:R,label:hr(R).label,Icon:hr(R).Icon,color:hr(R).color,bgColor:hr(R).bgColor})),z=a.map(R=>({value:R.id,label:R.name})),M=v?c[v.index]:null,U=M!=null&&M.category?((D=nn[M.category])==null?void 0:D.map(R=>({value:R,label:R})))||[]:[];return f.jsxs("div",{className:`fixed inset-0 z-[5200] flex justify-center items-center p-4 transition-opacity duration-75 ease-in-out ${o?"opacity-100":"opacity-0"} bg-slate-900/60 backdrop-blur-sm overflow-y-auto`,onClick:r,"aria-modal":"true",role:"dialog",children:[f.jsxs("div",{className:`bg-slate-50 rounded-lg shadow-xl w-full max-w-3xl transform transition-all duration-75 ease-in-out ${o?"scale-100 opacity-100":"scale-95 opacity-0"}`,onClick:R=>R.stopPropagation(),style:{maxHeight:"90vh",display:"flex",flexDirection:"column"},children:[f.jsxs("div",{className:"flex justify-between items-center p-6 border-b border-slate-200 sticky top-0 bg-slate-50/80 backdrop-blur-sm rounded-t-lg z-20 flex-shrink-0",children:[f.jsxs("div",{children:[f.jsx("h2",{className:"text-xl font-bold text-slate-800",children:"Spese Rilevate"}),f.jsxs("p",{className:"text-sm text-slate-500",children:["Abbiamo trovato ",t.length," spese. Seleziona e modifica i dettagli prima di aggiungerle."]})]}),f.jsx("button",{type:"button",onClick:r,className:"text-slate-500 hover:text-slate-800 transition-colors p-1 rounded-full hover:bg-slate-200 focus:outline-none focus:ring-2 focus:ring-indigo-500","aria-label":"Chiudi",children:f.jsx(xr,{className:"w-6 h-6"})})]}),f.jsxs("div",{className:"p-6 overflow-y-auto flex-1",children:[f.jsxs("div",{className:"flex items-center bg-slate-100 p-2 rounded-md mb-4 border border-slate-200",children:[f.jsx(bx,{id:"select-all",checked:B,onChange:E,label:"Seleziona tutto"}),f.jsx("label",{htmlFor:"select-all",className:"ml-3 text-sm font-medium text-slate-700 cursor-pointer",children:"Seleziona / Deseleziona tutto"})]}),f.jsx("div",{className:"space-y-3",children:c.map((R,K)=>{var ge;const ae=x.has(K),te=w===K,oe=R.category&&nn[R.category]||[],re=(ge=a.find(q=>q.id===R.accountId))==null?void 0:ge.name,Z=R.category?hr(R.category).label:void 0;return f.jsxs("div",{className:`bg-white rounded-lg shadow-sm border ${ae?"border-indigo-400":"border-slate-200"} transition-all duration-300 animate-fade-in-up`,style:{animationDelay:`${K*50}ms`,zIndex:te?10:1},children:[f.jsxs("div",{className:"p-3 flex items-center gap-3",children:[f.jsx(bx,{id:`expense-${K}`,checked:ae,onChange:()=>T(K),label:`Seleziona spesa ${R.description}`}),f.jsx("input",{type:"date",value:R.date||"",onChange:q=>_(K,"date",q.target.value),max:X,className:"text-sm rounded-md border border-slate-300 bg-white py-1.5 px-2 text-slate-900 placeholder:text-slate-400 focus:outline-none focus:border-indigo-500 focus:ring-1 focus:ring-indigo-500"}),f.jsx("div",{className:"flex-grow"}),f.jsx("p",{className:"text-lg font-bold text-indigo-600 shrink-0",children:Ba(R.amount||0)}),f.jsx("button",{onClick:()=>S(K),className:"p-2 text-slate-500 hover:text-indigo-600 hover:bg-indigo-100 rounded-full transition-colors flex-shrink-0","aria-label":"Modifica dettagli spesa",children:f.jsx(FS,{className:"w-5 h-5"})})]}),te&&f.jsxs("div",{className:"p-4 border-t border-slate-200 bg-slate-50/70 space-y-4",children:[f.jsxs("div",{children:[f.jsx("label",{htmlFor:`description-${K}`,className:"block text-sm font-medium text-slate-700 mb-1",children:"Descrizione"}),f.jsxs("div",{className:"relative",children:[f.jsx("div",{className:"pointer-events-none absolute inset-y-0 left-0 flex items-center pl-3",children:f.jsx(Cf,{className:"h-5 w-5 text-slate-400","aria-hidden":"true"})}),f.jsx("input",{type:"text",id:`description-${K}`,value:R.description||"",onChange:q=>_(K,"description",q.target.value),className:"block w-full rounded-md border border-slate-300 bg-white py-2 pl-10 pr-3 text-slate-900 placeholder:text-slate-400 focus:outline-none focus:border-indigo-500 focus:ring-1 focus:ring-indigo-500 sm:text-sm",placeholder:"Es. Spesa al supermercato"})]})]}),f.jsxs("div",{className:"grid grid-cols-1 gap-4 sm:grid-cols-3",children:[f.jsx(wu,{label:"Conto",value:re,onClick:()=>y({index:K,type:"account"}),placeholder:"Seleziona",ariaLabel:"Seleziona conto di pagamento",icon:f.jsx(vc,{className:"h-5 w-5 text-slate-400"})}),f.jsx(wu,{label:"Categoria",value:Z,onClick:()=>y({index:K,type:"category"}),placeholder:"Seleziona",ariaLabel:"Seleziona categoria",icon:f.jsx(fo,{className:"h-5 w-5 text-slate-400"})}),f.jsx(wu,{label:"Sottocategoria",value:R.subcategory,onClick:()=>y({index:K,type:"subcategory"}),placeholder:"Nessuna",ariaLabel:"Seleziona sottocategoria",icon:f.jsx(fo,{className:"h-5 w-5 text-slate-400"}),disabled:!R.category||oe.length===0})]})]})]},K)})})]}),f.jsxs("div",{className:"px-6 py-4 bg-slate-100 border-t border-slate-200 flex justify-end gap-3 sticky bottom-0 rounded-b-lg flex-shrink-0",children:[f.jsx("button",{type:"button",onClick:r,className:"px-4 py-2 text-sm font-semibold text-slate-700 bg-white border border-slate-300 rounded-lg shadow-sm hover:bg-slate-100 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2 transition-colors",children:"Annulla"}),f.jsxs("button",{type:"button",onClick:N,disabled:x.size===0,className:"px-4 py-2 text-sm font-semibold text-white bg-indigo-600 rounded-lg shadow-sm hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2 transition-colors disabled:bg-indigo-300 disabled:cursor-not-allowed",children:["Aggiungi ",x.size," Spes",x.size!==1?"e":"a"]})]})]}),f.jsx(Ln,{isOpen:(v==null?void 0:v.type)==="account",onClose:()=>y(null),title:"Seleziona un Conto",options:z,selectedValue:(M==null?void 0:M.accountId)||"",onSelect:R=>C("accountId",R)}),f.jsx(Ln,{isOpen:(v==null?void 0:v.type)==="category",onClose:()=>y(null),title:"Seleziona una Categoria",options:j,selectedValue:(M==null?void 0:M.category)||"",onSelect:R=>C("category",R)}),f.jsx(Ln,{isOpen:(v==null?void 0:v.type)==="subcategory",onClose:()=>y(null),title:"Seleziona Sottocategoria",options:U,selectedValue:(M==null?void 0:M.subcategory)||"",onSelect:R=>C("subcategory",R)})]})},ti=e=>f.jsxs("svg",{className:"animate-spin",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",...e,children:[f.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),f.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),Eo=e=>f.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...e,children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m14.74 9-.346 9m-4.788 0L9.26 9m9.968-3.21c.342.052.682.107 1.022.166m-1.022-.165L18.16 19.673a2.25 2.25 0 0 1-2.244 2.077H8.084a2.25 2.25 0 0 1-2.244-2.077L4.772 5.79m14.456 0a48.108 48.108 0 0 0-3.478-.397m-12 .562c.34-.059.68-.114 1.022-.165m0 0a48.11 48.11 0 0 1 3.478-.397m7.5 0v-.916c0-1.18-.91-2.164-2.09-2.201a51.964 51.964 0 0 0-3.32 0c-1.18.037-2.09 1.022-2.09 2.201v.916m7.5 0a48.667 48.667 0 0 0-7.5 0"})}),RS=({images:e,onAnalyze:r,onDelete:t,isOnline:a,syncingImageId:i})=>{const[o,u]=I.useState(!1),c=ni();if(!e||e.length===0)return null;const h=!!i;return f.jsxs("div",{className:"bg-white rounded-2xl shadow-lg",children:[f.jsxs("button",{className:"w-full flex items-center justify-between p-6 focus:outline-none focus:ring-2 focus:ring-indigo-500/50 rounded-2xl",onClick:()=>u(!o),"aria-expanded":o,...c,children:[f.jsxs("div",{className:"flex items-center gap-3",children:[f.jsx("h2",{className:"text-xl font-bold text-slate-700",children:"Immagini in Attesa"}),f.jsx("span",{className:"flex items-center justify-center min-w-[24px] h-6 px-2 text-sm font-semibold text-white bg-indigo-500 rounded-full",children:e.length})]}),f.jsx(En,{className:`w-6 h-6 text-slate-500 transition-transform duration-300 ${o?"rotate-180":""}`})]}),o&&f.jsxs("div",{className:"px-6 pb-6 animate-fade-in-up",style:{animationDuration:"300ms"},children:[f.jsx("p",{className:"text-sm text-slate-500 mb-6 border-t border-slate-200 pt-6",children:'Queste immagini sono state salvate mentre eri offline. Clicca su "Analizza" per processarle ora che sei online.'}),f.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 gap-4",children:e.map(x=>f.jsxs("div",{className:"border border-slate-200 shadow-sm flex flex-col group rounded-lg",children:[f.jsxs("div",{className:"relative",children:[f.jsx("img",{src:`data:${x.mimeType};base64,${x.base64Image}`,alt:"Anteprima spesa offline",className:"w-full h-24 object-cover bg-slate-100 rounded-t-lg"}),i===x.id&&f.jsxs("div",{className:"absolute inset-0 bg-white/80 backdrop-blur-sm flex items-center justify-center rounded-t-lg",children:[f.jsx(ti,{className:"w-8 h-8 text-indigo-600"}),f.jsx("span",{className:"sr-only",children:"Analisi in corso..."})]})]}),f.jsxs("div",{className:"p-2 mt-auto flex items-center justify-center gap-2 bg-slate-50 rounded-b-lg",children:[f.jsx("button",{onClick:()=>r(x),disabled:!a||h,className:"flex-1 px-2 py-1.5 text-xs font-semibold text-white bg-indigo-600 rounded-md shadow-sm hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2 transition-colors disabled:bg-indigo-400 disabled:cursor-not-allowed",title:a?"Analizza immagine":"Connettiti a internet per analizzare",...c,children:"Analizza"}),f.jsx("button",{onClick:()=>t(x.id),disabled:h,className:"p-1.5 text-slate-500 hover:text-red-600 hover:bg-red-100 rounded-md transition-colors disabled:opacity-50 disabled:cursor-not-allowed","aria-label":"Elimina immagine in attesa",...c,children:f.jsx(Eo,{className:"w-5 h-5"})})]})]},x.id))})]})]})},PS={success:{icon:Mp,bgColor:"bg-green-600",textColor:"text-white",iconColor:"text-white",ringColor:"focus:ring-green-400"},info:{icon:Nf,bgColor:"bg-sky-600",textColor:"text-white",iconColor:"text-white",ringColor:"focus:ring-sky-400"},error:{icon:bf,bgColor:"bg-red-600",textColor:"text-white",iconColor:"text-white",ringColor:"focus:ring-red-400"}},OS=({message:e,type:r,onClose:t})=>{const[a,i]=I.useState(!1),[o,u]=I.useState(null);I.useEffect(()=>{u(document.getElementById("toast-portal"))},[]);const{icon:c,bgColor:h,textColor:x,iconColor:m,ringColor:w}=PS[r],p=I.useCallback(()=>{i(!0),setTimeout(t,300)},[t]);I.useEffect(()=>{const y=setTimeout(p,3e3);return()=>clearTimeout(y)},[p]);const v=f.jsx("div",{role:"alert","aria-live":"assertive",className:`fixed transition-all duration-300 ease-in-out transform ${a?"translate-y-full opacity-0":"translate-y-0 opacity-100"} animate-fade-in-up`,style:{zIndex:9999,bottom:"calc(1.5rem + env(safe-area-inset-bottom, 0px))",left:"calc(1.5rem + env(safe-area-inset-left, 0px))",right:"calc(1.5rem + env(safe-area-inset-right, 0px))",pointerEvents:"auto",maxWidth:"400px",marginLeft:"auto",marginRight:"auto"},children:f.jsxs("div",{className:`rounded-lg shadow-lg p-2 grid grid-cols-[auto_1fr_auto] items-center gap-2 ${h}`,children:[f.jsx("div",{className:"flex-shrink-0",children:f.jsx(c,{className:`h-5 w-5 ${m}`,"aria-hidden":"true"})}),f.jsx("div",{className:"min-w-0",children:f.jsx("p",{className:`text-sm font-medium break-words ${x}`,children:e})}),f.jsx("div",{className:"flex-shrink-0 flex",children:f.jsxs("button",{type:"button",onClick:p,className:`inline-flex rounded-md p-1 transition-colors active:bg-black/20 focus:outline-none focus:ring-2 focus:ring-offset-2 ${w} ${h.replace("bg-","focus:ring-offset-")}`,children:[f.jsx("span",{className:"sr-only",children:"Chiudi"}),f.jsx(xr,{className:`h-5 w-5 ${x}`,"aria-hidden":"true"})]})})]})});return o?dS.createPortal(v,o):null},jS=e=>f.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...e,children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m21 21-5.197-5.197m0 0A7.5 7.5 0 1 0 5.196 5.196a7.5 7.5 0 0 0 10.607 10.607Z"})});function Gp({width:e=192,height:r=64,fill:t="currentColor",stroke:a="none",strokeWidth:i=0}){const o=Number(e),u=Number(r),c="smooth-pull-tab-shadow-filter",h=o*.35,x=o*.25,m=(o-h)/2,w=m+h,p=[`M 0 ${u}`,`C ${x} ${u}, ${m-x} 0, ${m} 0`,`L ${w} 0`,`C ${w+x} 0, ${o-x} ${u}, ${o} ${u}`,"Z"].join(" ");return f.jsxs("svg",{width:e,height:r,viewBox:`0 0 ${o} ${u}`,xmlns:"http://www.w3.org/2000/svg",role:"img","aria-label":"Linguetta morbida con effetto rilievo",style:{overflow:"visible"},children:[f.jsx("defs",{children:f.jsx("filter",{id:c,x:"-50%",y:"-50%",width:"200%",height:"200%",children:f.jsx("feDropShadow",{dx:"0",dy:"-3",stdDeviation:"2",floodColor:"#475569",floodOpacity:"0.6"})})}),f.jsx("g",{filter:`url(#${c})`,children:f.jsx("path",{d:p,fill:t,stroke:a,strokeWidth:i,vectorEffect:"non-scaling-stroke"})})]})}const Va=e=>f.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...e,children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M10.5 19.5 3 12m0 0 7.5-7.5M3 12h18"})}),Yn=e=>f.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:3,stroke:"currentColor",...e,children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m4.5 12.75 6 6 9-13.5"})}),Nx=({checked:e,onChange:r})=>f.jsx("div",{className:`w-6 h-6 rounded border flex items-center justify-center transition-colors cursor-pointer ${e?"bg-indigo-600 border-black":"bg-white border-black"}`,onClick:t=>{t.stopPropagation(),r()},onPointerDown:t=>t.stopPropagation(),children:e&&f.jsx(Yn,{className:"w-4 h-4 text-white",strokeWidth:3})}),LS=({onSelect:e,currentValue:r,isActive:t,compact:a,tapBridge:i})=>{const o=[{value:"7d",label:"7G"},{value:"30d",label:"30G"},{value:"6m",label:"6M"},{value:"1y",label:"1A"}];return f.jsx("div",{className:`w-full ${a?"h-8":"h-10"} flex border rounded-lg overflow-hidden transition-colors border-indigo-600`,children:o.map((u,c)=>{const h=t&&r===u.value;return f.jsx("button",{onClick:()=>e(u.value),type:"button","data-no-drag":!0,className:`flex-1 flex items-center justify-center px-2 text-center font-semibold ${a?"text-xs":"text-sm"} transition-colors duration-200 focus:outline-none `+(c>0?"border-l ":"")+(h?"bg-indigo-600 text-white border-indigo-600":`bg-slate-100 text-slate-700 hover:bg-slate-200 ${t?"border-indigo-600":"border-indigo-200"}`),...i,children:u.label},u.value)})})},MS=({range:e,onChange:r,isActive:t,compact:a,tapBridge:i})=>{const o="text-indigo-700",u="text-sm font-semibold",c=m=>{if(!m)return"";const[w,p,v]=m.split("-").map(Number);return new Date(w,p-1,v).toLocaleDateString("it-IT",{day:"numeric",month:"short",year:"2-digit"})},h=(m,w)=>{r({...e,[m]:w||null})},x=m=>{try{typeof m.currentTarget.showPicker=="function"&&m.currentTarget.showPicker()}catch{}};return f.jsxs("div",{className:`w-full ${a?"h-8":"h-10"} flex border rounded-lg overflow-hidden transition-colors relative border-indigo-600 bg-indigo-50`,children:[f.jsxs("label",{className:"relative flex-1 h-full group cursor-pointer block","data-no-drag":!0,children:[f.jsx("div",{className:`absolute inset-0 flex items-center justify-center z-0 pointer-events-none ${u} ${o}`,children:e.start?c(e.start):"Dal"}),f.jsx("input",{type:"date",value:e.start||"",onChange:m=>h("start",m.target.value),onClick:x,onBlur:m=>m.target.blur(),className:"absolute inset-0 w-full h-full opacity-0 z-20 cursor-pointer",style:{touchAction:"none"},...i})]}),f.jsx("div",{className:"w-px my-1 bg-indigo-200"}),f.jsxs("label",{className:"relative flex-1 h-full group cursor-pointer block","data-no-drag":!0,children:[f.jsx("div",{className:`absolute inset-0 flex items-center justify-center z-0 pointer-events-none ${u} ${o}`,children:e.end?c(e.end):"Al"}),f.jsx("input",{type:"date",value:e.end||"",onChange:m=>h("end",m.target.value),onClick:x,onBlur:m=>m.target.blur(),className:"absolute inset-0 w-full h-full opacity-0 z-20 cursor-pointer",style:{touchAction:"none"},...i})]})]})},BS=({periodType:e,periodDate:r,onTypeChange:t,onDateChange:a,isActive:i,onActivate:o,isMenuOpen:u,onMenuToggle:c,isPanelOpen:h,compact:x,tapBridge:m})=>{const w=I.useRef(null);I.useEffect(()=>{const y=T=>{w.current&&!w.current.contains(T.target)&&c(!1)};return u&&document.addEventListener("pointerdown",y,{capture:!0}),()=>{document.removeEventListener("pointerdown",y,{capture:!0})}},[u,c]);const p=y=>{o();const T=new Date(r);e==="day"?T.setDate(T.getDate()+y):e==="week"?T.setDate(T.getDate()+7*y):e==="month"?T.setMonth(T.getMonth()+y):T.setFullYear(T.getFullYear()+y),a(T)},v=(()=>{const y=new Date;y.setHours(0,0,0,0);const T=new Date(r);if(T.setHours(0,0,0,0),e==="day"){if(+T==+y)return"Oggi";const z=new Date(y);return z.setDate(y.getDate()-1),+T==+z?"Ieri":r.toLocaleDateString("it-IT",{day:"numeric",month:"short",year:"numeric"}).replace(".","")}if(e==="month"){const z=y.getMonth(),M=y.getFullYear();if(r.getMonth()===z&&r.getFullYear()===M)return"Questo Mese";const U=z===0?11:z-1,D=z===0?M-1:M;return r.getMonth()===U&&r.getFullYear()===D?"Mese Scorso":r.toLocaleDateString("it-IT",{month:"long",year:"numeric"})}if(e==="year")return r.getFullYear()===y.getFullYear()?"Quest'Anno":r.getFullYear()===y.getFullYear()-1?"Anno Scorso":String(r.getFullYear());const E=new Date(r),_=E.getDay(),C=E.getDate()-_+(_===0?-6:1);E.setDate(C),E.setHours(0,0,0,0);const S=new Date(E);S.setDate(E.getDate()+6);const N=new Date(y),B=N.getDay(),X=N.getDate()-B+(B===0?-6:1);if(N.setDate(X),N.setHours(0,0,0,0),+E==+N)return"Questa Settimana";const j=new Date(N);return j.setDate(N.getDate()-7),+E==+j?"Settimana Scorsa":`${E.toLocaleDateString("it-IT",{day:"numeric",month:"short"})} - ${S.toLocaleDateString("it-IT",{day:"numeric",month:"short",year:"numeric"})}`})();return f.jsxs("div",{ref:w,className:`relative w-full ${x?"h-8":"h-10"} flex items-center justify-between border rounded-lg bg-white border-indigo-600`,children:[f.jsx("button",{onClick:()=>p(-1),type:"button",className:`h-full px-4 rounded-l-lg ${x?"":"hover:bg-slate-100"}`,"aria-label":"Periodo precedente","data-no-drag":!0,...m,children:f.jsx(Sf,{className:"w-5 h-5 text-slate-700"})}),f.jsx("button",{onClick:()=>c(!u),type:"button",className:"flex-1 h-full text-sm font-semibold bg-indigo-100 text-indigo-700 "+(x?"":" hover:bg-indigo-200"),"data-no-drag":!0,...m,children:v}),f.jsx("button",{onClick:()=>p(1),type:"button",className:`h-full px-4 rounded-r-lg ${x?"":"hover:bg-slate-100"}`,"aria-label":"Periodo successivo","data-no-drag":!0,...m,children:f.jsx(rc,{className:"w-5 h-5 text-slate-700"})}),u&&f.jsx("div",{className:`absolute left-0 right-0 mx-auto w-40 bg-white border border-slate-200 shadow-lg rounded-lg z-[1000] p-2 space-y-1 ${h?"top-full mt-1":"bottom-full mb-10"}`,children:["day","week","month","year"].map(y=>f.jsx("button",{onClick:T=>{T.stopPropagation(),o(),t(y),c(!1)},type:"button","data-no-drag":!0,className:"w-full text-left px-4 py-2 text-sm font-semibold rounded-lg "+(i&&e===y?"bg-indigo-100 text-indigo-800":"bg-slate-50 text-slate-800 hover:bg-slate-200"),...m,children:y==="day"?"Giorno":y==="week"?"Settimana":y==="month"?"Mese":"Anno"},y))})]})},Ax=78,US=16,zS=e=>{var Ce;const[r,t]=I.useState(!1),[a,i]=I.useState(0),[o,u]=I.useState("main"),[c,h]=I.useState(null),[x,m]=I.useState(!1),w=ni(),[p,v]=I.useState(0),[y,T]=I.useState(0),[E,_]=I.useState(0),[C,S]=I.useState(!1),[N,B]=I.useState(!1),X=I.useRef(!1),[j,z]=I.useState(0),[M,U]=I.useState(!1),D=C&&E<(y||0)/2;I.useEffect(()=>{X.current=D},[D]),I.useEffect(()=>{t(!1)},[a]),I.useEffect(()=>{if(o==="category_selection"&&e.selectedCategoryFilters.size===1&&c===null){const le=Array.from(e.selectedCategoryFilters)[0],[ce]=le.split(":");nn[ce]&&nn[ce].length>0&&h(ce)}},[o,e.selectedCategoryFilters,c]);const R=le=>{const ce=le.target;ce.tagName==="INPUT"&&["text","number","password","email","search"].includes(ce.type)&&m(!0)},K=le=>{le.currentTarget.contains(le.relatedTarget)||m(!1)},ae=I.useRef({active:!1,direction:"none",startX:0,startY:0,startTranslateY:0,lastY:0,lastT:0,canSwipeHorizontal:!1});I.useLayoutEffect(()=>{var ce;if(!e.isActive){S(!1);return}const le=()=>{const Ee=window.visualViewport,Se=Ee?Ee.height:window.innerHeight,Re=window.innerHeight,it=Se<Re*.8;let Ne;o==="category_selection"?Ne=92:it?Ne=96:Ne=40;let Ke=Ne/100*Se;o==="main"&&!it&&(Ke=Math.max(Ke,320),Ke=Math.min(Ke,Se*.85)),Ke=Math.max(Ke-US,Ax+10);const mt=Math.max(Ke-Ax,0);v(Ke),T(mt),_(Nt=>C&&(x||X.current)?0:mt),S(!0)};return le(),window.addEventListener("resize",le),(ce=window.visualViewport)==null||ce.addEventListener("resize",le),()=>{var Ee;window.removeEventListener("resize",le),(Ee=window.visualViewport)==null||Ee.removeEventListener("resize",le)}},[e.isActive,o,x]);const te=.05,oe=10,re=I.useCallback(le=>Math.max(0,Math.min(y||0,le)),[y]),Z=I.useCallback((le,ce)=>{if(!C)return;const Ee=y||0,Se=re(typeof ce=="number"?ce:E),Re=Ee>0?Se/Ee:1;let at;le<=-te?at=0:le>=te?at=Ee:at=Re<.5?0:Ee,B(!0),_(at)},[y,E,C,te,re]),{onOpenStateChange:ge}=e;I.useEffect(()=>{ge(D)},[D,ge]);const q=le=>{if(!e.isActive)return;w.onPointerDown(le);const Ee=!!le.target.closest("[data-swipe-area]");ae.current={active:!0,direction:"none",startX:le.clientX,startY:le.clientY,startTranslateY:E,lastY:le.clientY,lastT:performance.now(),canSwipeHorizontal:Ee},N&&B(!1),M&&U(!1)},Q=le=>{if(w.onPointerMove(le),!e.isActive)return;const ce=ae.current;if(!ce.active)return;const Ee=le.clientX-ce.startX,Se=le.clientY-ce.startY;if(ce.direction==="none"){if(Ee*Ee+Se*Se<100)return;if(Math.abs(Se)>Math.abs(Ee))ce.direction="vertical";else{if(r||o!=="main"||!ce.canSwipeHorizontal){ce.active=!1;return}ce.direction="horizontal"}}if(ce.direction==="vertical"){le.cancelable&&le.preventDefault();const Re=performance.now(),at=re(ce.startTranslateY+Se);_(at),ce.lastY=le.clientY,ce.lastT=Re}else ce.direction==="horizontal"&&(le.cancelable&&le.preventDefault(),z(Ee))},ie=le=>{w.onPointerUp(le);const ce=ae.current;if(!ce.active){ce.direction="none";return}if(ce.active=!1,ce.direction==="vertical"){const Ee=le.clientY-ce.startY,Se=ce.startTranslateY,Re=y||0,at=re(Se+Ee);if(Math.abs(Ee)>=oe){if(Ee<0&&Se>=Re*.7){ce.direction="none",B(!0),_(0);return}if(Ee>0&&Se<=Re*.3){ce.direction="none",B(!0),_(Re);return}}const it=performance.now(),Ne=Math.max(1,it-ce.lastT),Ke=(le.clientY-ce.lastY)/Ne;Z(Ke,at)}else if(ce.direction==="horizontal"){const Ee=le.clientX-ce.startX,Se=40;Ee<-Se&&a<2?i(Re=>Re+1):Ee>Se&&a>0&&i(Re=>Re-1),U(!0),z(0)}ce.direction="none"},ve=le=>{var Ee;(Ee=w.onPointerCancel)==null||Ee.call(w,le);const ce=ae.current;ce.active=!1,ce.direction="none",Z(0),U(!0),z(0)},pe=le=>{w.onClickCapture(le)},Ae=I.useCallback(le=>e.onSelectQuickFilter(le),[e]),je=I.useCallback(le=>e.onSetPeriodDate(le),[e]),ze=I.useCallback(le=>e.onSelectPeriodType(le),[e]),P=I.useCallback(le=>e.onCustomRangeChange(le),[e]),ee=le=>{setTimeout(()=>{le.target.scrollIntoView({behavior:"smooth",block:"center"})},300)},J=C?re(E):p||(typeof window<"u"?window.innerHeight*40/100:0),_e=`translateX(calc(${-a*(100/3)}% + ${j}px))`,F=!e.isPeriodFilterActive&&!e.isCustomRangeActive,ke=e.selectedAccountId?(Ce=e.accounts.find(le=>le.id===e.selectedAccountId))==null?void 0:Ce.name:"Conto",Fe=I.useMemo(()=>{const le=e.selectedCategoryFilters.size;if(le===0)return"Categoria";if(le===1){const ce=Array.from(e.selectedCategoryFilters)[0],[Ee,Se]=ce.split(":"),Re=hr(Ee);return Se?`${Re.label}, ${Se}`:Re.label}return`${le} Categorie`},[e.selectedCategoryFilters]),De=I.useMemo(()=>{if(e.selectedCategoryFilters.size===1){const le=Array.from(e.selectedCategoryFilters)[0],[ce]=le.split(":");return hr(ce).Icon}return fo},[e.selectedCategoryFilters]),Ge=le=>{h(ce=>ce===le?null:le)},Ve=()=>f.jsxs("div",{className:"px-4 pb-2 space-y-3",children:[f.jsxs("div",{className:"relative",children:[f.jsx("div",{className:"pointer-events-none absolute inset-y-0 left-0 flex items-center pl-3",children:f.jsx(jS,{className:"h-5 w-5 text-slate-400"})}),f.jsx("input",{id:"filter-desc",type:"text",value:e.descriptionQuery,onChange:le=>e.onDescriptionChange(le.target.value),onFocus:ee,placeholder:"Descrizione...",className:"w-full rounded-lg border border-slate-300 bg-white py-2 pl-10 pr-3 text-sm text-slate-900 placeholder:text-slate-400 focus:outline-none focus:border-indigo-500 focus:ring-1 focus:ring-indigo-500",onPointerDown:le=>le.stopPropagation(),...w})]}),f.jsxs("div",{className:"flex gap-3",children:[f.jsxs("div",{className:"relative flex-1",children:[f.jsx("div",{className:"pointer-events-none absolute inset-y-0 left-0 flex items-center pl-3",children:f.jsx($u,{className:`h-5 w-5 ${e.amountRange.min?"text-indigo-600":"text-slate-400"}`})}),f.jsx("input",{id:"filter-amount-min",type:"number",value:e.amountRange.min,onChange:le=>e.onAmountRangeChange({...e.amountRange,min:le.target.value}),onFocus:ee,placeholder:"Da",className:`w-full rounded-lg border py-2 pl-10 pr-3 text-sm text-slate-900 placeholder:text-slate-400 focus:outline-none focus:border-indigo-500 focus:ring-1 focus:ring-indigo-500 ${e.amountRange.min?"bg-indigo-50 border-indigo-200 text-indigo-700 font-medium":"bg-white border-slate-300"}`,onPointerDown:le=>le.stopPropagation(),...w})]}),f.jsxs("div",{className:"relative flex-1",children:[f.jsx("div",{className:"pointer-events-none absolute inset-y-0 left-0 flex items-center pl-3",children:f.jsx($u,{className:`h-5 w-5 ${e.amountRange.max?"text-indigo-600":"text-slate-400"}`})}),f.jsx("input",{id:"filter-amount-max",type:"number",value:e.amountRange.max,onChange:le=>e.onAmountRangeChange({...e.amountRange,max:le.target.value}),onFocus:ee,placeholder:"A",className:`w-full rounded-lg border py-2 pl-10 pr-3 text-sm text-slate-900 placeholder:text-slate-400 focus:outline-none focus:border-indigo-500 focus:ring-1 focus:ring-indigo-500 ${e.amountRange.max?"bg-indigo-50 border-indigo-200 text-indigo-700 font-medium":"bg-white border-slate-300"}`,onPointerDown:le=>le.stopPropagation(),...w})]})]})]}),tt=()=>f.jsxs("div",{className:"space-y-3 pt-2 px-4 pb-4",children:[f.jsxs("button",{type:"button",onClick:()=>u("account_selection"),className:`w-full flex items-center justify-between gap-2 px-3 py-2 text-sm rounded-lg border shadow-sm focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 transition-colors text-left ${e.selectedAccountId?"bg-indigo-50 border-indigo-200 text-indigo-700":"bg-white border-slate-300 text-slate-700 hover:bg-slate-50"}`,...w,children:[f.jsxs("div",{className:"flex items-center gap-2 overflow-hidden",children:[f.jsx(vc,{className:`h-5 w-5 flex-shrink-0 ${e.selectedAccountId?"text-indigo-600":"text-slate-400"}`}),f.jsx("span",{className:"truncate font-medium",children:ke})]}),f.jsx(rc,{className:`w-5 h-5 flex-shrink-0 ${e.selectedAccountId?"text-indigo-400":"text-slate-400"}`})]}),f.jsxs("button",{type:"button",onClick:()=>u("category_selection"),className:`w-full flex items-center justify-between gap-2 px-3 py-2 text-sm rounded-lg border shadow-sm focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 transition-colors text-left ${e.selectedCategoryFilters.size>0?"bg-indigo-50 border-indigo-200 text-indigo-700":"bg-white border-slate-300 text-slate-700 hover:bg-slate-50"}`,...w,children:[f.jsxs("div",{className:"flex items-center gap-2 overflow-hidden",children:[f.jsx(De,{className:`h-5 w-5 flex-shrink-0 ${e.selectedCategoryFilters.size>0?"text-indigo-600":"text-slate-400"}`}),f.jsx("span",{className:"truncate font-medium text-base font-bold",children:Fe})]}),f.jsx(rc,{className:`w-5 h-5 flex-shrink-0 ${e.selectedCategoryFilters.size>0?"text-indigo-400":"text-slate-400"}`})]})]}),ft=()=>f.jsxs("div",{className:"space-y-2",children:[f.jsxs("div",{className:"flex items-center gap-2 mb-3 pb-2 border-b border-slate-100",children:[f.jsx("button",{onClick:()=>u("main"),className:"p-1 -ml-1 rounded-full hover:bg-slate-100 text-slate-500",onPointerDown:le=>le.stopPropagation(),children:f.jsx(Va,{className:"w-5 h-5"})}),f.jsx("h3",{className:"text-base font-bold text-slate-800",children:"Seleziona Conto"})]}),f.jsxs("div",{className:"space-y-1",children:[f.jsxs("button",{onClick:()=>{e.onSelectAccount(null),u("main")},className:`w-full flex items-center justify-between px-3 py-3 rounded-lg text-left text-sm transition-colors ${e.selectedAccountId===null?"bg-indigo-50 text-indigo-700 font-semibold":"text-slate-700 hover:bg-slate-50"}`,onPointerDown:le=>le.stopPropagation(),children:[f.jsx("span",{children:"Tutti"}),e.selectedAccountId===null&&f.jsx(Yn,{className:"w-5 h-5"})]}),e.accounts.map(le=>f.jsxs("button",{onClick:()=>{e.onSelectAccount(le.id),u("main")},className:`w-full flex items-center justify-between px-3 py-3 rounded-lg text-left text-sm transition-colors ${e.selectedAccountId===le.id?"bg-indigo-50 text-indigo-700 font-semibold":"text-slate-700 hover:bg-slate-50"}`,onPointerDown:ce=>ce.stopPropagation(),children:[f.jsx("span",{children:le.name}),e.selectedAccountId===le.id&&f.jsx(Yn,{className:"w-5 h-5"})]},le.id))]})]}),st=()=>f.jsxs("div",{className:"space-y-2",children:[f.jsxs("div",{className:"flex items-center gap-2 mb-3 pb-2 border-b border-slate-100 sticky top-0 bg-white z-10",children:[f.jsx("button",{onClick:()=>u("main"),className:"p-1 -ml-1 rounded-full hover:bg-slate-100 text-slate-500",onPointerDown:le=>le.stopPropagation(),children:f.jsx(Va,{className:"w-5 h-5"})}),f.jsxs("div",{className:"flex-1",children:[f.jsx("h3",{className:"text-base font-bold text-slate-800",children:"Seleziona Categorie"}),e.selectedCategoryFilters.size>0&&f.jsxs("p",{className:"text-xs text-indigo-600 font-semibold",children:[e.selectedCategoryFilters.size," selezionate"]})]}),e.selectedCategoryFilters.size>0&&f.jsx("button",{onClick:e.onClearCategoryFilters,className:"text-xs font-semibold text-slate-500 hover:text-red-600 px-2 py-1 rounded bg-slate-100 hover:bg-red-50",onPointerDown:le=>le.stopPropagation(),children:"Reset"})]}),f.jsx("div",{className:"space-y-1 pb-4",children:Object.keys(nn).map(le=>{const ce=hr(le),Ee=c===le,Se=e.selectedCategoryFilters.has(le),Re=Array.from(e.selectedCategoryFilters).some(Ne=>Ne.startsWith(le+":")),at=Se||Re,it=nn[le]||[];return f.jsxs("div",{className:"rounded-lg overflow-hidden border border-transparent hover:border-slate-100",children:[f.jsxs("div",{className:`w-full flex items-center px-3 py-2 gap-3 transition-colors ${at?"bg-indigo-50":"hover:bg-slate-50"}`,children:[f.jsxs("button",{onClick:()=>Ge(le),className:"flex items-center gap-3 flex-1 text-left min-w-0",onPointerDown:Ne=>Ne.stopPropagation(),children:[f.jsx("div",{className:`w-10 h-10 rounded-full flex items-center justify-center flex-shrink-0 ${ce.bgColor}`,children:f.jsx(ce.Icon,{className:`w-5 h-5 ${ce.color}`})}),f.jsx("span",{className:`text-base font-bold truncate ${at?"text-indigo-800":"text-slate-700"}`,children:ce.label}),it.length>0&&f.jsx(En,{className:`w-5 h-5 text-slate-400 transition-transform ${Ee?"rotate-180":""}`})]}),f.jsx(Nx,{checked:at,onChange:()=>e.onToggleCategoryFilter(le)})]}),Ee&&it.length>0&&f.jsx("div",{className:"bg-slate-50 pl-16 pr-4 py-3 space-y-3 border-t border-slate-100 animate-fade-in-down",children:it.map(Ne=>{const Ke=`${le}:${Ne}`,mt=Se||e.selectedCategoryFilters.has(Ke);return f.jsxs("div",{className:"flex items-center justify-between",children:[f.jsx("span",{className:`text-base font-bold ${mt?"text-indigo-700":"text-slate-600"}`,children:Ne}),f.jsx(Nx,{checked:mt,onChange:()=>{Se&&e.onToggleCategoryFilter(le),e.onToggleCategoryFilter(Ke)}})]},Ne)})})]},le)})})]}),ye=f.jsxs("div",{onPointerDown:q,onPointerMove:Q,onPointerUp:ie,onPointerCancel:ve,onClickCapture:pe,onFocus:R,onBlur:K,"data-no-page-swipe":"true",className:"fixed bottom-0 left-0 right-0 bg-white rounded-t-2xl shadow-[0_-3px_4px_rgba(71,85,105,0.6)] z-[1000] flex flex-col",style:{height:`${p}px`,transform:`translate3d(0, ${J}px, 0)`,transition:N?"transform 0.08s cubic-bezier(0.22, 0.61, 0.36, 1)":"transform 0.3s cubic-bezier(0.22, 0.61, 0.36, 1), height 0.3s cubic-bezier(0.22, 0.61, 0.36, 1)",touchAction:"none",backfaceVisibility:"hidden",willChange:"transform, height",opacity:C?1:0,pointerEvents:C?"auto":"none",display:"flex",flexDirection:"column"},onTransitionEnd:()=>B(!1),children:[f.jsxs("div",{className:"absolute top-0 left-1/2 -translate-x-1/2 w-[88px] h-auto flex justify-center cursor-grab z-50",style:{transform:"translateX(-50%) translateY(-19px)"},"aria-hidden":"true",children:[f.jsx(Gp,{width:"88",height:"19",fill:"white"}),f.jsx(En,{className:"absolute w-5 h-5 text-slate-400 transition-transform duration-300 "+(D?"rotate-0":"rotate-180"),style:{top:"2px"}})]}),f.jsxs("div",{className:"flex-shrink-0 z-20 relative bg-white rounded-t-2xl",children:[f.jsxs("div",{className:"pt-2 pb-1 relative z-30","data-swipe-area":!0,children:[f.jsx("div",{className:"relative "+(r?"overflow-visible":"overflow-hidden"),children:f.jsxs("div",{className:"w-[300%] flex",style:{transform:_e,transition:M?"transform 0.2s cubic-bezier(0.22, 0.61, 0.36, 1)":"none"},onTransitionEnd:()=>U(!1),children:[f.jsx("div",{className:"w-1/3 px-4 py-1",children:f.jsx(LS,{onSelect:Ae,currentValue:e.currentQuickFilter,isActive:F})}),f.jsx("div",{className:"w-1/3 px-4 py-1",children:f.jsx(BS,{periodType:e.periodType,periodDate:e.periodDate,onTypeChange:ze,onDateChange:je,isActive:e.isPeriodFilterActive,onActivate:e.onActivatePeriodFilter,isMenuOpen:r,onMenuToggle:t,isPanelOpen:D,compact:!1})}),f.jsx("div",{className:"w-1/3 px-4 py-1",children:f.jsx(MS,{range:e.currentCustomRange,onChange:P,isActive:e.isCustomRangeActive})})]})}),f.jsx("div",{className:"flex justify-center items-center pt-1 pb-1 gap-2",children:[0,1,2].map(le=>f.jsx("button",{onClick:()=>i(le),type:"button",className:"w-2.5 h-2.5 rounded-full transition-colors "+(a===le?"bg-indigo-600":"bg-slate-300 hover:bg-slate-400"),"aria-label":"Vai al filtro "+(le+1)},le))})]}),o==="main"&&f.jsxs("div",{className:"pt-1.5 relative z-20",children:[Ve(),tt()]})]}),f.jsx("div",{className:"w-full h-px bg-slate-200 mb-2 flex-shrink-0 relative z-10"}),f.jsxs("div",{className:"flex-1 overflow-y-auto px-4 pb-4 relative z-10",onPointerDown:le=>le.stopPropagation(),style:{overscrollBehaviorY:"contain",touchAction:"pan-y"},children:[o==="account_selection"&&ft(),o==="category_selection"&&st(),f.jsx("div",{style:{height:"env(safe-area-inset-bottom, 20px)"}})]})]});return typeof window>"u"?null:gc.createPortal(ye,document.body)},HS=e=>f.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...e,children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3 7.5L7.5 3m0 0L12 7.5M7.5 3v13.5m13.5 0L16.5 21m0 0L12 16.5m4.5 4.5V7.5"})}),VS=({expense:e,accounts:r,onEdit:t,onDelete:a,isOpen:i,onOpen:o,isSelectionMode:u,isSelected:c,onToggleSelection:h,onLongPress:x})=>{var U;const m=hr(e.category),w=((U=r.find(D=>D.id===e.accountId))==null?void 0:U.name)||"Sconosciuto",p=I.useRef(null),v=ni(),y=!!e.recurringExpenseId,T=c?"bg-indigo-50 ring-1 ring-inset ring-indigo-200":y?"bg-amber-50":"bg-white",E=I.useRef(null),_=D=>{u||(E.current=window.setTimeout(()=>{x(e.id),navigator.vibrate&&navigator.vibrate(50)},500))},C=()=>{E.current&&(clearTimeout(E.current),E.current=null)},S=I.useRef({isDragging:!1,isLocked:!1,startX:0,startY:0,startTime:0,initialTranslateX:0,pointerId:null,wasHorizontal:!1}),N=I.useCallback((D,R)=>{p.current&&(p.current.style.transition=R?"transform 0.2s cubic-bezier(0.22,0.61,0.36,1)":"none",p.current.style.transform=`translateX(${D}px)`)},[]);I.useEffect(()=>{S.current.isDragging||N(i&&!u?-72:0,!0)},[i,u,N]);const B=D=>{if(_(),D.target.closest("button")||!p.current||u)return;p.current.style.transition="none";const K=new DOMMatrixReadOnly(window.getComputedStyle(p.current).transform).m41;S.current={isDragging:!1,isLocked:!1,startX:D.clientX,startY:D.clientY,startTime:performance.now(),initialTranslateX:K,pointerId:D.pointerId,wasHorizontal:!1};try{p.current.setPointerCapture(D.pointerId)}catch(ae){console.warn("Could not capture pointer: ",ae)}},X=D=>{var te;const R=S.current;if(E.current&&Math.hypot(D.clientX-R.startX,D.clientY-R.startY)>10&&C(),R.pointerId!==D.pointerId||u)return;const K=D.clientX-R.startX,ae=D.clientY-R.startY;if(!R.isDragging)if(Math.hypot(K,ae)>8)if(R.isDragging=!0,R.isLocked=Math.abs(K)>Math.abs(ae)*2,R.isLocked)D.stopPropagation();else{R.pointerId!==null&&((te=p.current)==null||te.releasePointerCapture(R.pointerId)),R.pointerId=null,R.isDragging=!1;return}else return;if(R.isDragging&&R.isLocked){R.wasHorizontal=!0,D.cancelable&&D.preventDefault(),D.stopPropagation();let oe=R.initialTranslateX+K;oe>0&&(oe=0),oe<-72&&(oe=-72),N(oe,!1)}},j=D=>{var te;C();const R=S.current;if(R.pointerId!==D.pointerId)return;R.pointerId!==null&&((te=p.current)==null||te.releasePointerCapture(R.pointerId));const K=R.isDragging,ae=R.wasHorizontal;if(R.isDragging=!1,R.pointerId=null,K&&ae){const oe=performance.now()-R.startTime,re=D.clientX-R.startX,Z=new DOMMatrixReadOnly(window.getComputedStyle(p.current).transform).m41,ge=re/(oe||1),q=Z<-72/2||ge<-.3&&re<-20;o(q?e.id:""),N(q?-72:0,!0)}setTimeout(()=>{S.current.wasHorizontal=!1},0)},z=D=>{var K;C();const R=S.current;R.pointerId===D.pointerId&&(R.pointerId!==null&&((K=p.current)==null||K.releasePointerCapture(R.pointerId)),R.isDragging=!1,R.isLocked=!1,R.pointerId=null,R.wasHorizontal=!1,N(i?-72:0,!0))},M=()=>{S.current.isDragging||S.current.wasHorizontal||(u?h(e.id):i?o(""):t(e))};return f.jsxs("div",{className:`relative ${T} overflow-hidden transition-colors duration-200 select-none`,children:[f.jsx("div",{className:"absolute top-0 right-0 h-full flex items-center z-0",children:f.jsxs("button",{onClick:()=>a(e.id),className:"w-[72px] h-full flex flex-col items-center justify-center bg-red-600 text-white text-xs font-semibold focus:outline-none focus:visible:ring-2 focus:visible:ring-inset focus:visible:ring-white","aria-label":"Elimina spesa",...v,children:[f.jsx(Eo,{className:"w-6 h-6"}),f.jsx("span",{className:"text-xs mt-1",children:"Elimina"})]})}),f.jsxs("div",{ref:p,"data-expense-swipe":"1",onPointerDown:B,onPointerMove:X,onPointerUp:j,onPointerCancel:z,onClick:M,className:`relative flex items-center gap-4 py-3 px-4 ${T} z-10 cursor-pointer transition-colors duration-200 select-none`,style:{touchAction:"pan-y"},children:[y&&!u&&f.jsx("span",{className:"absolute top-1.5 right-1.5 w-5 h-5 text-slate-900 bg-amber-100 border border-amber-400 text-[10px] font-bold rounded-full flex items-center justify-center z-20",title:"Spesa Programmata",children:"P"}),c?f.jsx("span",{className:"w-10 h-10 rounded-xl flex-shrink-0 flex items-center justify-center bg-indigo-600 text-white transition-transform duration-200 transform scale-100",children:f.jsx(Yn,{className:"w-6 h-6",strokeWidth:3})}):f.jsx("span",{className:`w-10 h-10 rounded-xl flex-shrink-0 flex items-center justify-center ${m.bgColor} transition-transform duration-200`,children:f.jsx(m.Icon,{className:`w-6 h-6 ${m.color}`})}),f.jsxs("div",{className:"flex-grow min-w-0",children:[f.jsxs("p",{className:`font-semibold truncate ${c?"text-indigo-900":"text-slate-800"}`,children:[e.subcategory||m.label,"  ",w]}),f.jsx("p",{className:`text-sm truncate ${c?"text-indigo-700":"text-slate-500"}`,title:e.description,children:e.description||"Senza descrizione"})]}),f.jsx("p",{className:`font-bold text-lg text-right shrink-0 whitespace-nowrap min-w-[90px] ${c?"text-indigo-900":"text-slate-900"}`,children:Ba(Number(e.amount)||0)})]})]})},Yp=e=>{const r=new Date(Date.UTC(e.getFullYear(),e.getMonth(),e.getDate())),t=r.getUTCDay()||7;r.setUTCDate(r.getUTCDate()+4-t);const a=new Date(Date.UTC(r.getUTCFullYear(),0,1));return[r.getUTCFullYear(),Math.ceil(((r.getTime()-a.getTime())/864e5+1)/7)]},WS=(e,r)=>{const t=new Date(Date.UTC(e,0,4)),a=t.getUTCDay()||7,i=new Date(t);i.setUTCDate(t.getUTCDate()-(a-1)+(r-1)*7);const o=new Date(i);o.setUTCDate(i.getUTCDate()+6);const u=c=>{const h=String(c.getUTCDate()).padStart(2,"0"),x=c.toLocaleString("it-IT",{month:"short",timeZone:"UTC"}).replace(".","");return`${h}${x}`};return`(${u(i)}-${u(o)} ${e})`},$S=(e,r)=>{const t=new Date,[a,i]=Yp(t);if(e===a){if(r===i)return"Questa Settimana";if(r===i-1)return"Settimana Scorsa"}return`Settimana ${r}`},Ra=e=>{const r=e.split("-").map(Number);return new Date(r[0],r[1]-1,r[2])},XS=({expenses:e,accounts:r,onEditExpense:t,onDeleteExpense:a,onDeleteExpenses:i,isEditingOrDeleting:o,onDateModalStateChange:u,onClose:c,onCloseStart:h,onFilterPanelOpenStateChange:x,isOverlayed:m})=>{const[w,p]=I.useState(!1),[v,y]=I.useState("quick"),[T,E]=I.useState("all"),[_,C]=I.useState({start:null,end:null}),[S,N]=I.useState("week"),[B,X]=I.useState(()=>{const Ee=new Date;return Ee.setHours(0,0,0,0),Ee}),[j,z]=I.useState(null),[M,U]=I.useState(new Set),[D,R]=I.useState(""),[K,ae]=I.useState({min:"",max:""}),[te,oe]=I.useState("date"),[re,Z]=I.useState(!1),ge=I.useRef(null),q=I.useRef(null),[Q,ie]=I.useState(null),[ve,pe]=I.useState(!1),[Ae,je]=I.useState(new Set),[ze,P]=I.useState(!1),ee=I.useRef(null),J=I.useRef(o),G=Ae.size>0;I.useEffect(()=>{const Ee=setTimeout(()=>p(!0),10);return()=>clearTimeout(Ee)},[]);const _e=()=>{ie(null),h&&h(),p(!1),setTimeout(c,300)},F=I.useCallback(Ee=>{pe(Ee),u(Ee)},[u]);I.useEffect(()=>{J.current&&!o&&ie(null),J.current=o},[o]),I.useEffect(()=>{w||ie(null)},[w]),I.useEffect(()=>(ee.current&&clearTimeout(ee.current),Q&&!o&&(ee.current=window.setTimeout(()=>ie(null),5e3)),()=>{ee.current&&clearTimeout(ee.current)}),[Q,o]),I.useEffect(()=>{const Ee=Se=>{re&&q.current&&!q.current.contains(Se.target)&&ge.current&&!ge.current.contains(Se.target)&&Z(!1)};return document.addEventListener("mousedown",Ee),()=>document.removeEventListener("mousedown",Ee)},[re]);const ke=I.useMemo(()=>{let Ee=e||[];if(v==="period"){const Se=new Date(B);Se.setHours(0,0,0,0);const Re=new Date(B);switch(Re.setHours(23,59,59,999),S){case"day":break;case"week":{const Ne=Se.getDay(),Ke=Se.getDate()-Ne+(Ne===0?-6:1);Se.setDate(Ke),Re.setDate(Se.getDate()+6);break}case"month":Se.setDate(1),Re.setMonth(Re.getMonth()+1),Re.setDate(0);break;case"year":Se.setMonth(0,1),Re.setFullYear(Re.getFullYear()+1),Re.setMonth(0,0);break}const at=Se.getTime(),it=Re.getTime();Ee=Ee.filter(Ne=>{const Ke=Ra(Ne.date);if(isNaN(Ke.getTime()))return!1;const mt=Ke.getTime();return mt>=at&&mt<=it})}else if(v==="custom"&&_.start&&_.end){const Se=Ra(_.start).getTime(),Re=Ra(_.end);Re.setDate(Re.getDate()+1);const at=Re.getTime();Ee=Ee.filter(it=>{const Ne=Ra(it.date);if(isNaN(Ne.getTime()))return!1;const Ke=Ne.getTime();return Ke>=Se&&Ke<at})}else if(T!=="all"){const Se=new Date;switch(Se.setHours(0,0,0,0),T){case"7d":Se.setDate(Se.getDate()-6);break;case"30d":Se.setDate(Se.getDate()-29);break;case"6m":Se.setMonth(Se.getMonth()-6);break;case"1y":Se.setFullYear(Se.getFullYear()-1);break}const Re=Se.getTime();Ee=Ee.filter(at=>{const it=Ra(at.date);return!isNaN(it.getTime())&&it.getTime()>=Re})}if(j&&(Ee=Ee.filter(Se=>Se.accountId===j)),M.size>0&&(Ee=Ee.filter(Se=>{const Re=Se.category,at=`${Se.category}:${Se.subcategory||""}`;return!!(M.has(Re)||Se.subcategory&&M.has(at))})),D.trim()){const Se=D.toLowerCase();Ee=Ee.filter(Re=>(Re.description||"").toLowerCase().includes(Se))}if(K.min){const Se=parseFloat(K.min);isNaN(Se)||(Ee=Ee.filter(Re=>Re.amount>=Se))}if(K.max){const Se=parseFloat(K.max);isNaN(Se)||(Ee=Ee.filter(Re=>Re.amount<=Se))}return Ee},[e,v,T,_,S,B,j,M,D,K]),Fe=I.useMemo(()=>{const Ee=[...ke||[]].sort((Se,Re)=>{if(te==="amount-desc")return Re.amount-Se.amount;if(te==="amount-asc")return Se.amount-Re.amount;if(te==="category")return Se.category.localeCompare(Re.category);{const at=Ra(Re.date),it=Ra(Se.date);if(Re.time){const[Ne,Ke]=Re.time.split(":").map(Number);!isNaN(Ne)&&!isNaN(Ke)&&at.setHours(Ne,Ke)}if(Se.time){const[Ne,Ke]=Se.time.split(":").map(Number);!isNaN(Ne)&&!isNaN(Ke)&&it.setHours(Ne,Ke)}return at.getTime()-it.getTime()}});if(te!=="date"){const Se=Ee.reduce((at,it)=>at+(Number(it.amount)||0),0);let Re="Tutte le spese";return te==="amount-desc"&&(Re="Per Importo (Decrescente)"),te==="amount-asc"&&(Re="Per Importo (Crescente)"),te==="category"&&(Re="Per Categoria"),{global:{year:0,week:0,label:Re,dateRange:`${Ee.length} risultati`,expenses:Ee,total:Se}}}return Ee.reduce((Se,Re)=>{const at=Ra(Re.date);if(isNaN(at.getTime()))return Se;const[it,Ne]=Yp(at),Ke=`${it}-${Ne}`;return Se[Ke]||(Se[Ke]={year:it,week:Ne,label:$S(it,Ne),dateRange:WS(it,Ne),expenses:[],total:0}),Se[Ke].expenses.push(Re),Se[Ke].total+=Number(Re.amount)||0,Se},{})},[ke,te]),De=Object.values(Fe).sort((Ee,Se)=>Ee.year!==Se.year?Se.year-Ee.year:Se.week-Ee.week),Ge=Ee=>ie(Ee||null),Ve=Ee=>{U(Se=>{const Re=new Set(Se);return Re.has(Ee)?Re.delete(Ee):Re.add(Ee),Re})},tt=()=>U(new Set),ft=Ee=>{je(new Set([Ee])),navigator.vibrate&&navigator.vibrate(50)},st=Ee=>{je(Se=>{const Re=new Set(Se);return Re.has(Ee)?Re.delete(Ee):Re.add(Ee),Re})},ye=()=>{je(new Set)},Ce=()=>{Ae.size>0&&P(!0)},le=()=>{i(Array.from(Ae)),P(!1),je(new Set)},ce=Ee=>{oe(Ee==="amount"?Se=>Se==="amount-desc"?"amount-asc":"amount-desc":Ee),Z(!1)};return f.jsxs("div",{className:`fixed inset-0 z-20 bg-slate-100 transform transition-transform duration-300 ease-in-out ${w?"translate-y-0 pointer-events-auto":"translate-y-full pointer-events-none"}`,style:{touchAction:"pan-y",willChange:"transform",visibility:w?"visible":"hidden",transitionProperty:"transform, visibility",transitionDuration:"300ms, 0s",transitionDelay:w?"0s, 0s":"0s, 300ms"},children:[f.jsx("header",{className:"sticky top-0 z-20 flex items-center gap-4 p-4 bg-white/80 backdrop-blur-sm shadow-sm h-[60px]",children:G?f.jsxs(f.Fragment,{children:[f.jsx("button",{onClick:ye,className:"p-2 -ml-2 rounded-full hover:bg-slate-200 transition-colors text-slate-600","aria-label":"Annulla selezione",children:f.jsx(Va,{className:"w-6 h-6"})}),f.jsxs("h1",{className:"text-xl font-bold text-indigo-800 flex-1",children:[Ae.size," Selezionati"]}),f.jsx("button",{onClick:Ce,className:"p-2 rounded-full hover:bg-red-100 text-red-600 transition-colors","aria-label":"Elimina selezionati",children:f.jsx(Eo,{className:"w-6 h-6"})})]}):f.jsxs(f.Fragment,{children:[f.jsx("button",{onClick:_e,className:"p-2 -ml-2 rounded-full hover:bg-slate-200 transition-colors","aria-label":"Indietro",children:f.jsx(Va,{className:"w-6 h-6 text-slate-700"})}),f.jsx("h1",{className:"text-xl font-bold text-slate-800 flex-1",children:"Storico Spese"}),f.jsxs("div",{className:"relative",children:[f.jsx("button",{ref:ge,onClick:()=>Z(!re),className:`p-2 rounded-full transition-colors ${te!=="date"?"bg-indigo-100 text-indigo-700":"hover:bg-slate-200 text-slate-600"}`,"aria-label":"Ordina spese",children:f.jsx(HS,{className:"w-6 h-6"})}),re&&f.jsx("div",{ref:q,className:"absolute top-full right-0 mt-2 w-48 bg-white rounded-lg shadow-xl border border-slate-100 z-50 overflow-hidden animate-fade-in-up",style:{animationDuration:"150ms"},children:f.jsxs("div",{className:"py-1",children:[f.jsxs("button",{onClick:()=>ce("amount"),className:`w-full text-left px-4 py-2.5 text-sm font-semibold flex items-center justify-between hover:bg-slate-50 ${te==="amount-desc"||te==="amount-asc"?"text-indigo-600 bg-indigo-50":"text-slate-700"}`,children:[f.jsxs("span",{children:["Per Importo ",te==="amount-asc"?"(Crescente)":"(Decrescente)"]}),(te==="amount-desc"||te==="amount-asc")&&f.jsx(Yn,{className:"w-4 h-4"})]}),f.jsxs("button",{onClick:()=>ce("category"),className:`w-full text-left px-4 py-2.5 text-sm font-semibold flex items-center justify-between hover:bg-slate-50 ${te==="category"?"text-indigo-600 bg-indigo-50":"text-slate-700"}`,children:[f.jsx("span",{children:"Per Categoria"}),te==="category"&&f.jsx(Yn,{className:"w-4 h-4"})]}),f.jsx("div",{className:"border-t border-slate-100 my-1"}),f.jsxs("button",{onClick:()=>ce("date"),className:`w-full text-left px-4 py-2.5 text-sm font-semibold flex items-center justify-between hover:bg-slate-50 ${te==="date"?"text-indigo-600 bg-indigo-50":"text-slate-500"}`,children:[f.jsx("span",{children:"Per Data (Default)"}),te==="date"&&f.jsx(Yn,{className:"w-4 h-4"})]})]})})]})]})}),f.jsx("main",{className:"overflow-y-auto h-[calc(100%-60px)]",style:{touchAction:"pan-y"},children:f.jsx("div",{className:"flex-1 overflow-y-auto pb-36",style:{touchAction:"pan-y"},children:De.length>0?De.map(Ee=>f.jsxs("div",{className:"mb-6 last:mb-0",children:[f.jsxs("div",{className:"flex items-center justify-between font-bold text-slate-800 text-lg px-4 py-2 sticky top-0 bg-slate-100/80 backdrop-blur-sm z-10",children:[f.jsxs("h2",{className:"flex items-baseline flex-wrap gap-x-2",children:[f.jsxs("span",{children:[Ee.label,Ee.label.startsWith("Settimana")&&/\d/.test(Ee.label)?",":""]}),f.jsx("span",{className:"text-sm font-normal text-slate-500",children:Ee.dateRange})]}),f.jsx("p",{className:"font-bold text-indigo-600 text-xl",children:Ba(Ee.total)})]}),f.jsx("div",{className:"bg-white rounded-xl shadow-md mx-2 overflow-hidden",children:Ee.expenses.map((Se,Re)=>f.jsxs(Tn.Fragment,{children:[Re>0&&f.jsx("hr",{className:"border-t border-slate-200 ml-16"}),f.jsx(VS,{expense:Se,accounts:r,onEdit:t,onDelete:a,isOpen:Q===Se.id,onOpen:Ge,isSelectionMode:G,isSelected:Ae.has(Se.id),onToggleSelection:st,onLongPress:ft})]},Se.id))})]},Ee.label)):f.jsxs("div",{className:"text-center text-slate-500 pt-20 px-6",children:[f.jsx("p",{className:"text-lg font-semibold",children:"Nessuna spesa trovata"}),f.jsx("p",{className:"mt-2",children:"Prova a modificare i filtri o aggiungi una nuova spesa dalla schermata Home."})]})})}),f.jsx(zS,{isActive:w&&!ve&&!m&&!G,onSelectQuickFilter:Ee=>{E(Ee),y("quick")},currentQuickFilter:T,onCustomRangeChange:Ee=>{C(Ee),y("custom")},currentCustomRange:_,isCustomRangeActive:v==="custom",onDateModalStateChange:F,periodType:S,periodDate:B,onSelectPeriodType:Ee=>{N(Ee),X(()=>{const Se=new Date;return Se.setHours(0,0,0,0),Se}),y("period")},onSetPeriodDate:X,isPeriodFilterActive:v==="period",onActivatePeriodFilter:()=>y("period"),onOpenStateChange:x,accounts:r,selectedAccountId:j,selectedCategoryFilters:M,onToggleCategoryFilter:Ve,onClearCategoryFilters:tt,descriptionQuery:D,onDescriptionChange:R,amountRange:K,onAmountRangeChange:ae,onSelectAccount:z}),f.jsx(ei,{isOpen:ze,onClose:()=>P(!1),onConfirm:le,title:"Elimina Selezionati",message:`Sei sicuro di voler eliminare ${Ae.size} elementi? L'azione  irreversibile.`,variant:"danger",confirmButtonText:"Elimina",cancelButtonText:"Annulla"})]})},GS=e=>f.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...e,children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6.75 3v2.25M17.25 3v2.25M3 18.75V7.5a2.25 2.25 0 0 1 2.25-2.25h13.5A2.25 2.25 0 0 1 21 7.5v11.25m-18 0A2.25 2.25 0 0 0 5.25 21h13.5A2.25 2.25 0 0 0 21 18.75m-18 0h18M7.5 12h.008v.008H7.5V12Zm3 0h.008v.008H10.5V12Zm3 0h.008v.008H13.5V12Z"})}),Pa=72,Yu=e=>{if(!e)return null;const r=e.split("-").map(Number);return new Date(r[0],r[1]-1,r[2])},Kp=(e,r)=>{if(e.frequency!=="recurring"||!e.recurrence)return null;const t=e.recurrenceInterval||1,a=new Date(r);switch(e.recurrence){case"daily":a.setDate(a.getDate()+t);break;case"weekly":a.setDate(a.getDate()+7*t);break;case"monthly":a.setMonth(a.getMonth()+t);break;case"yearly":a.setFullYear(a.getFullYear()+t);break;default:return null}return a},YS={daily:"Ogni Giorno",weekly:"Ogni Settimana",monthly:"Ogni Mese",yearly:"Ogni Anno"},KS=e=>{if(e.frequency!=="recurring"||!e.recurrence)return"Non programmata";const{recurrence:r,recurrenceInterval:t=1}=e;return t>1?`Ogni ${t} ${r==="daily"?"giorni":r==="weekly"?"settimane":r==="monthly"?"mesi":"anni"}`:YS[r]||"Ricorrente"},QS=({expense:e,accounts:r,onEdit:t,onDeleteRequest:a,isOpen:i,onOpen:o,isSelectionMode:u,isSelected:c,onToggleSelection:h,onLongPress:x,isFinished:m})=>{var M;const w=hr(e.category),p=((M=r.find(U=>U.id===e.accountId))==null?void 0:M.name)||"Sconosciuto",v=I.useRef(null),y=I.useMemo(()=>{if(m)return null;const U=Yu(e.lastGeneratedDate||e.date);return U?e.lastGeneratedDate?Kp(e,U):U:null},[e,m]),T=I.useRef(null),E=U=>{u||(T.current=window.setTimeout(()=>{x(e.id),navigator.vibrate&&navigator.vibrate(50)},500))},_=()=>{T.current&&(clearTimeout(T.current),T.current=null)},C=I.useRef({isDragging:!1,isLocked:!1,startX:0,startY:0,startTime:0,initialTranslateX:0,pointerId:null,wasHorizontal:!1}),S=I.useCallback((U,D)=>{v.current&&(v.current.style.transition=D?"transform 0.2s cubic-bezier(0.22,0.61,0.36,1)":"none",v.current.style.transform=`translateX(${U}px)`)},[]);I.useEffect(()=>{C.current.isDragging||S(i&&!u?-Pa:0,!0)},[i,u,S]);const N=U=>{if(E(),U.target.closest("button")||!v.current||u)return;v.current.style.transition="none";const R=new DOMMatrixReadOnly(window.getComputedStyle(v.current).transform).m41;C.current={isDragging:!1,isLocked:!1,startX:U.clientX,startY:U.clientY,startTime:performance.now(),initialTranslateX:R,pointerId:U.pointerId,wasHorizontal:!1};try{v.current.setPointerCapture(U.pointerId)}catch(K){console.warn("Could not capture pointer: ",K)}},B=U=>{var ae;const D=C.current;if(T.current&&Math.hypot(U.clientX-D.startX,U.clientY-D.startY)>10&&_(),D.pointerId!==U.pointerId||u)return;const R=U.clientX-D.startX,K=U.clientY-D.startY;if(!D.isDragging)if(Math.hypot(R,K)>8){if(D.isDragging=!0,D.isLocked=Math.abs(R)>Math.abs(K)*2,!D.isLocked){D.pointerId!==null&&((ae=v.current)==null||ae.releasePointerCapture(D.pointerId)),D.pointerId=null,D.isDragging=!1;return}}else return;if(D.isDragging&&D.isLocked){D.wasHorizontal=!0,U.cancelable&&U.preventDefault();let te=D.initialTranslateX+R;te>0&&(te=Math.tanh(te/50)*25),te<-Pa&&(te=-Pa-Math.tanh((Math.abs(te)-Pa)/50)*25),S(te,!1)}},X=U=>{var K;_();const D=C.current;if(D.pointerId!==U.pointerId)return;D.pointerId!==null&&((K=v.current)==null||K.releasePointerCapture(D.pointerId));const R=D.isDragging;if(D.isDragging=!1,D.pointerId=null,!!R)if(D.wasHorizontal){const ae=performance.now()-D.startTime,te=U.clientX-D.startX,oe=new DOMMatrixReadOnly(window.getComputedStyle(v.current).transform).m41,re=te/(ae||1),Z=oe<-Pa/2||re<-.3&&te<-20;o(Z?e.id:""),S(Z?-Pa:0,!0)}else S(i?-Pa:0,!0)},j=U=>{var R;_();const D=C.current;D.pointerId===U.pointerId&&(D.pointerId!==null&&((R=v.current)==null||R.releasePointerCapture(D.pointerId)),D.isDragging=!1,D.isLocked=!1,D.pointerId=null,S(i?-Pa:0,!0))},z=()=>{C.current.isDragging||C.current.wasHorizontal||(u?h(e.id):i?o(""):t(e))};return f.jsxs("div",{className:`relative overflow-hidden transition-colors duration-200 select-none ${c?"bg-indigo-50 ring-1 ring-inset ring-indigo-200":m?"bg-slate-50 opacity-75":"bg-amber-50"}`,children:[f.jsx("div",{className:"absolute top-0 right-0 h-full flex items-center z-0",children:f.jsxs("button",{onClick:()=>a(e.id),className:"w-[72px] h-full flex flex-col items-center justify-center bg-red-500 text-white hover:bg-red-600 transition-colors focus:outline-none focus:visible:ring-2 focus-visible:ring-inset focus-visible:ring-white","aria-label":"Elimina spesa programmata",children:[f.jsx(Eo,{className:"w-6 h-6"}),f.jsx("span",{className:"text-xs mt-1",children:"Elimina"})]})}),f.jsxs("div",{ref:v,onPointerDown:N,onPointerMove:B,onPointerUp:X,onPointerCancel:j,onClick:z,className:`relative flex items-center gap-4 py-3 px-4 ${c?"bg-indigo-50":m?"bg-slate-50":"bg-amber-50"} z-10 cursor-pointer transition-colors duration-200 select-none`,style:{touchAction:"pan-y"},children:[c?f.jsx("span",{className:"w-10 h-10 rounded-xl flex-shrink-0 flex items-center justify-center bg-indigo-600 text-white transition-transform duration-200 transform scale-100",children:f.jsx(Yn,{className:"w-6 h-6",strokeWidth:3})}):f.jsx("span",{className:`w-10 h-10 rounded-xl flex-shrink-0 flex items-center justify-center ${w.bgColor} transition-transform duration-200 ${m?"grayscale":""}`,children:f.jsx(w.Icon,{className:`w-6 h-6 ${w.color}`})}),f.jsxs("div",{className:"flex-grow min-w-0",children:[f.jsx("p",{className:`font-semibold truncate ${c?"text-indigo-900":m?"text-slate-500 line-through":"text-slate-800"}`,children:e.description||"Senza descrizione"}),f.jsxs("p",{className:`text-sm truncate ${c?"text-indigo-700":"text-slate-500"}`,children:[KS(e),"  ",p]})]}),f.jsxs("div",{className:"flex flex-col items-end shrink-0 min-w-[90px]",children:[f.jsx("p",{className:`font-bold text-lg text-right whitespace-nowrap ${c?"text-indigo-900":m?"text-slate-400":"text-slate-900"}`,children:Ba(Number(e.amount)||0)}),m?f.jsx("div",{className:"text-xs font-bold text-slate-400 mt-1 uppercase tracking-wider bg-slate-200 px-2 py-0.5 rounded-full",children:"Completata"}):y&&f.jsx("div",{className:`text-sm font-medium mt-1 whitespace-nowrap ${c?"text-indigo-600":"text-slate-500"}`,children:Lp(y)})]})]})]})},qS=({recurringExpenses:e,expenses:r,accounts:t,onClose:a,onEdit:i,onDelete:o,onDeleteRecurringExpenses:u})=>{const[c,h]=I.useState(!1),[x,m]=I.useState(null),[w,p]=I.useState(null),[v,y]=I.useState(!1),T=I.useRef(null),[E,_]=I.useState(new Set),[C,S]=I.useState(!1),N=E.size>0,B=I.useMemo(()=>{const oe=r||[];return e.map(re=>{if(re.frequency!=="recurring")return null;let Z=!1;if(re.recurrenceEndType==="count")re.recurrenceCount&&re.recurrenceCount>0&&oe.filter(q=>q.recurringExpenseId===re.id).length>=re.recurrenceCount&&(Z=!0);else if(re.recurrenceEndType==="date"){const ge=Yu(re.recurrenceEndDate);if(ge){const q=Yu(re.lastGeneratedDate||re.date);if(q)if(q.getTime()>ge.getTime())Z=!0;else{const Q=Kp(re,q);(!Q||Q.getTime()>ge.getTime())&&(Z=!0)}}}return{...re,isFinished:Z}}).filter(re=>re!==null&&!re.isFinished)},[e,r]);I.useEffect(()=>{const oe=setTimeout(()=>h(!0),10);return()=>clearTimeout(oe)},[]),I.useEffect(()=>{!c&&x&&m(null)},[c,x]),I.useEffect(()=>(T.current&&clearTimeout(T.current),x&&!v&&(T.current=window.setTimeout(()=>m(null),5e3)),()=>{T.current&&clearTimeout(T.current)}),[x,v]);const X=()=>{m(null),h(!1),setTimeout(a,300)},j=oe=>{p(oe),y(!0)},z=()=>{w&&(o(w),p(null),y(!1),m(null))},M=()=>{y(!1),p(null)},U=oe=>{_(new Set([oe])),navigator.vibrate&&navigator.vibrate(50)},D=oe=>{_(re=>{const Z=new Set(re);return Z.has(oe)?Z.delete(oe):Z.add(oe),Z})},R=()=>{_(new Set)},K=()=>{E.size>0&&S(!0)},ae=()=>{u(Array.from(E)),S(!1),_(new Set)},te=[...B].sort((oe,re)=>new Date(re.date).getTime()-new Date(oe.date).getTime());return f.jsxs("div",{className:`fixed inset-0 z-50 bg-slate-100 transform transition-transform duration-300 ease-in-out ${c?"translate-y-0":"translate-y-full"}`,style:{touchAction:"pan-y"},children:[f.jsx("header",{className:"sticky top-0 z-20 flex items-center gap-4 p-4 bg-white/80 backdrop-blur-sm shadow-sm h-[60px]",children:N?f.jsxs(f.Fragment,{children:[f.jsx("button",{onClick:R,className:"p-2 -ml-2 rounded-full hover:bg-slate-200 transition-colors text-slate-600","aria-label":"Annulla selezione",children:f.jsx(Va,{className:"w-6 h-6"})}),f.jsxs("h1",{className:"text-xl font-bold text-indigo-800 flex-1",children:[E.size," Selezionati"]}),f.jsx("button",{onClick:K,className:"p-2 rounded-full hover:bg-red-100 text-red-600 transition-colors","aria-label":"Elimina selezionati",children:f.jsx(Eo,{className:"w-6 h-6"})})]}):f.jsxs(f.Fragment,{children:[f.jsx("button",{onClick:X,className:"p-2 rounded-full hover:bg-slate-200 transition-colors","aria-label":"Indietro",children:f.jsx(Va,{className:"w-6 h-6 text-slate-700"})}),f.jsx("h1",{className:"text-xl font-bold text-slate-800 flex-1",children:"Spese Programmate"})]})}),f.jsx("main",{className:"overflow-y-auto h-[calc(100%-60px)] p-2",style:{touchAction:"pan-y"},children:te.length>0?f.jsx("div",{className:"bg-white rounded-xl shadow-md overflow-hidden my-4",children:te.map((oe,re)=>f.jsxs(Tn.Fragment,{children:[re>0&&f.jsx("hr",{className:"border-t border-slate-200 ml-16"}),f.jsx(QS,{expense:oe,accounts:t,onEdit:i,onDeleteRequest:j,isOpen:x===oe.id,onOpen:m,isSelectionMode:N,isSelected:E.has(oe.id),onToggleSelection:D,onLongPress:U,isFinished:oe.isFinished})]},oe.id))}):f.jsxs("div",{className:"text-center text-slate-500 pt-20 px-6",children:[f.jsx(GS,{className:"w-16 h-16 mx-auto text-slate-400"}),f.jsx("p",{className:"text-lg font-semibold mt-4",children:"Nessuna spesa programmata attiva"}),f.jsx("p",{className:"mt-2",children:"Puoi creare una spesa ricorrente quando aggiungi una nuova spesa."})]})}),f.jsx(ei,{isOpen:v,onClose:M,onConfirm:z,title:"Conferma Eliminazione",message:f.jsxs(f.Fragment,{children:["Sei sicuro di voler eliminare questa spesa programmata? ",f.jsx("br",{}),"Le spese gi generate non verranno cancellate."]}),variant:"danger"}),f.jsx(ei,{isOpen:C,onClose:()=>S(!1),onConfirm:ae,title:"Elimina Selezionati",message:`Sei sicuro di voler eliminare ${E.size} elementi?`,variant:"danger",confirmButtonText:"Elimina",cancelButtonText:"Annulla"})]})},Fx=({icon:e,title:r,description:t,onClick:a})=>f.jsxs("button",{onClick:a,className:"bg-white p-6 rounded-lg shadow-md hover:shadow-lg hover:ring-2 hover:ring-indigo-500 transition-all duration-200 text-left w-full flex flex-col items-center text-center",children:[f.jsx("div",{className:"text-indigo-600 bg-indigo-100 p-4 rounded-full mb-4",children:e}),f.jsx("h3",{className:"text-lg font-bold text-slate-800",children:r}),f.jsx("p",{className:"text-sm text-slate-500 mt-1",children:t})]});var Vs={},yu={exports:{}},ku,Ix;function ZS(){if(Ix)return ku;Ix=1;var e="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED";return ku=e,ku}var Eu,Dx;function JS(){if(Dx)return Eu;Dx=1;var e=ZS();function r(){}function t(){}return t.resetWarningCache=r,Eu=function(){function a(u,c,h,x,m,w){if(w!==e){var p=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw p.name="Invariant Violation",p}}a.isRequired=a;function i(){return a}var o={array:a,bigint:a,bool:a,func:a,number:a,object:a,string:a,symbol:a,any:a,arrayOf:i,element:a,elementType:a,instanceOf:i,node:a,objectOf:i,oneOf:i,oneOfType:i,shape:i,exact:i,checkPropTypes:t,resetWarningCache:r};return o.PropTypes=o,o},Eu}var Rx;function Qp(){return Rx||(Rx=1,yu.exports=JS()()),yu.exports}var _u,Px;function qp(){return Px||(Px=1,_u={L:1,M:0,Q:3,H:2}),_u}var Tu,Ox;function Zp(){return Ox||(Ox=1,Tu={MODE_NUMBER:1,MODE_ALPHA_NUM:2,MODE_8BIT_BYTE:4,MODE_KANJI:8}),Tu}var Su,jx;function eC(){if(jx)return Su;jx=1;var e=Zp();function r(t){this.mode=e.MODE_8BIT_BYTE,this.data=t}return r.prototype={getLength:function(t){return this.data.length},write:function(t){for(var a=0;a<this.data.length;a++)t.put(this.data.charCodeAt(a),8)}},Su=r,Su}var Cu,Lx;function tC(){if(Lx)return Cu;Lx=1;var e=qp();function r(t,a){this.totalCount=t,this.dataCount=a}return r.RS_BLOCK_TABLE=[[1,26,19],[1,26,16],[1,26,13],[1,26,9],[1,44,34],[1,44,28],[1,44,22],[1,44,16],[1,70,55],[1,70,44],[2,35,17],[2,35,13],[1,100,80],[2,50,32],[2,50,24],[4,25,9],[1,134,108],[2,67,43],[2,33,15,2,34,16],[2,33,11,2,34,12],[2,86,68],[4,43,27],[4,43,19],[4,43,15],[2,98,78],[4,49,31],[2,32,14,4,33,15],[4,39,13,1,40,14],[2,121,97],[2,60,38,2,61,39],[4,40,18,2,41,19],[4,40,14,2,41,15],[2,146,116],[3,58,36,2,59,37],[4,36,16,4,37,17],[4,36,12,4,37,13],[2,86,68,2,87,69],[4,69,43,1,70,44],[6,43,19,2,44,20],[6,43,15,2,44,16],[4,101,81],[1,80,50,4,81,51],[4,50,22,4,51,23],[3,36,12,8,37,13],[2,116,92,2,117,93],[6,58,36,2,59,37],[4,46,20,6,47,21],[7,42,14,4,43,15],[4,133,107],[8,59,37,1,60,38],[8,44,20,4,45,21],[12,33,11,4,34,12],[3,145,115,1,146,116],[4,64,40,5,65,41],[11,36,16,5,37,17],[11,36,12,5,37,13],[5,109,87,1,110,88],[5,65,41,5,66,42],[5,54,24,7,55,25],[11,36,12],[5,122,98,1,123,99],[7,73,45,3,74,46],[15,43,19,2,44,20],[3,45,15,13,46,16],[1,135,107,5,136,108],[10,74,46,1,75,47],[1,50,22,15,51,23],[2,42,14,17,43,15],[5,150,120,1,151,121],[9,69,43,4,70,44],[17,50,22,1,51,23],[2,42,14,19,43,15],[3,141,113,4,142,114],[3,70,44,11,71,45],[17,47,21,4,48,22],[9,39,13,16,40,14],[3,135,107,5,136,108],[3,67,41,13,68,42],[15,54,24,5,55,25],[15,43,15,10,44,16],[4,144,116,4,145,117],[17,68,42],[17,50,22,6,51,23],[19,46,16,6,47,17],[2,139,111,7,140,112],[17,74,46],[7,54,24,16,55,25],[34,37,13],[4,151,121,5,152,122],[4,75,47,14,76,48],[11,54,24,14,55,25],[16,45,15,14,46,16],[6,147,117,4,148,118],[6,73,45,14,74,46],[11,54,24,16,55,25],[30,46,16,2,47,17],[8,132,106,4,133,107],[8,75,47,13,76,48],[7,54,24,22,55,25],[22,45,15,13,46,16],[10,142,114,2,143,115],[19,74,46,4,75,47],[28,50,22,6,51,23],[33,46,16,4,47,17],[8,152,122,4,153,123],[22,73,45,3,74,46],[8,53,23,26,54,24],[12,45,15,28,46,16],[3,147,117,10,148,118],[3,73,45,23,74,46],[4,54,24,31,55,25],[11,45,15,31,46,16],[7,146,116,7,147,117],[21,73,45,7,74,46],[1,53,23,37,54,24],[19,45,15,26,46,16],[5,145,115,10,146,116],[19,75,47,10,76,48],[15,54,24,25,55,25],[23,45,15,25,46,16],[13,145,115,3,146,116],[2,74,46,29,75,47],[42,54,24,1,55,25],[23,45,15,28,46,16],[17,145,115],[10,74,46,23,75,47],[10,54,24,35,55,25],[19,45,15,35,46,16],[17,145,115,1,146,116],[14,74,46,21,75,47],[29,54,24,19,55,25],[11,45,15,46,46,16],[13,145,115,6,146,116],[14,74,46,23,75,47],[44,54,24,7,55,25],[59,46,16,1,47,17],[12,151,121,7,152,122],[12,75,47,26,76,48],[39,54,24,14,55,25],[22,45,15,41,46,16],[6,151,121,14,152,122],[6,75,47,34,76,48],[46,54,24,10,55,25],[2,45,15,64,46,16],[17,152,122,4,153,123],[29,74,46,14,75,47],[49,54,24,10,55,25],[24,45,15,46,46,16],[4,152,122,18,153,123],[13,74,46,32,75,47],[48,54,24,14,55,25],[42,45,15,32,46,16],[20,147,117,4,148,118],[40,75,47,7,76,48],[43,54,24,22,55,25],[10,45,15,67,46,16],[19,148,118,6,149,119],[18,75,47,31,76,48],[34,54,24,34,55,25],[20,45,15,61,46,16]],r.getRSBlocks=function(t,a){var i=r.getRsBlockTable(t,a);if(i==null)throw new Error("bad rs block @ typeNumber:"+t+"/errorCorrectLevel:"+a);for(var o=i.length/3,u=new Array,c=0;c<o;c++)for(var h=i[c*3+0],x=i[c*3+1],m=i[c*3+2],w=0;w<h;w++)u.push(new r(x,m));return u},r.getRsBlockTable=function(t,a){switch(a){case e.L:return r.RS_BLOCK_TABLE[(t-1)*4+0];case e.M:return r.RS_BLOCK_TABLE[(t-1)*4+1];case e.Q:return r.RS_BLOCK_TABLE[(t-1)*4+2];case e.H:return r.RS_BLOCK_TABLE[(t-1)*4+3];default:return}},Cu=r,Cu}var bu,Mx;function rC(){if(Mx)return bu;Mx=1;function e(){this.buffer=new Array,this.length=0}return e.prototype={get:function(r){var t=Math.floor(r/8);return(this.buffer[t]>>>7-r%8&1)==1},put:function(r,t){for(var a=0;a<t;a++)this.putBit((r>>>t-a-1&1)==1)},getLengthInBits:function(){return this.length},putBit:function(r){var t=Math.floor(this.length/8);this.buffer.length<=t&&this.buffer.push(0),r&&(this.buffer[t]|=128>>>this.length%8),this.length++}},bu=e,bu}var Nu,Bx;function Jp(){if(Bx)return Nu;Bx=1;for(var e={glog:function(t){if(t<1)throw new Error("glog("+t+")");return e.LOG_TABLE[t]},gexp:function(t){for(;t<0;)t+=255;for(;t>=256;)t-=255;return e.EXP_TABLE[t]},EXP_TABLE:new Array(256),LOG_TABLE:new Array(256)},r=0;r<8;r++)e.EXP_TABLE[r]=1<<r;for(var r=8;r<256;r++)e.EXP_TABLE[r]=e.EXP_TABLE[r-4]^e.EXP_TABLE[r-5]^e.EXP_TABLE[r-6]^e.EXP_TABLE[r-8];for(var r=0;r<255;r++)e.LOG_TABLE[e.EXP_TABLE[r]]=r;return Nu=e,Nu}var Au,Ux;function eg(){if(Ux)return Au;Ux=1;var e=Jp();function r(t,a){if(t.length==null)throw new Error(t.length+"/"+a);for(var i=0;i<t.length&&t[i]==0;)i++;this.num=new Array(t.length-i+a);for(var o=0;o<t.length-i;o++)this.num[o]=t[o+i]}return r.prototype={get:function(t){return this.num[t]},getLength:function(){return this.num.length},multiply:function(t){for(var a=new Array(this.getLength()+t.getLength()-1),i=0;i<this.getLength();i++)for(var o=0;o<t.getLength();o++)a[i+o]^=e.gexp(e.glog(this.get(i))+e.glog(t.get(o)));return new r(a,0)},mod:function(t){if(this.getLength()-t.getLength()<0)return this;for(var a=e.glog(this.get(0))-e.glog(t.get(0)),i=new Array(this.getLength()),o=0;o<this.getLength();o++)i[o]=this.get(o);for(var o=0;o<t.getLength();o++)i[o]^=e.gexp(e.glog(t.get(o))+a);return new r(i,0).mod(t)}},Au=r,Au}var Fu,zx;function nC(){if(zx)return Fu;zx=1;var e=Zp(),r=eg(),t=Jp(),a={PATTERN000:0,PATTERN001:1,PATTERN010:2,PATTERN011:3,PATTERN100:4,PATTERN101:5,PATTERN110:6,PATTERN111:7},i={PATTERN_POSITION_TABLE:[[],[6,18],[6,22],[6,26],[6,30],[6,34],[6,22,38],[6,24,42],[6,26,46],[6,28,50],[6,30,54],[6,32,58],[6,34,62],[6,26,46,66],[6,26,48,70],[6,26,50,74],[6,30,54,78],[6,30,56,82],[6,30,58,86],[6,34,62,90],[6,28,50,72,94],[6,26,50,74,98],[6,30,54,78,102],[6,28,54,80,106],[6,32,58,84,110],[6,30,58,86,114],[6,34,62,90,118],[6,26,50,74,98,122],[6,30,54,78,102,126],[6,26,52,78,104,130],[6,30,56,82,108,134],[6,34,60,86,112,138],[6,30,58,86,114,142],[6,34,62,90,118,146],[6,30,54,78,102,126,150],[6,24,50,76,102,128,154],[6,28,54,80,106,132,158],[6,32,58,84,110,136,162],[6,26,54,82,110,138,166],[6,30,58,86,114,142,170]],G15:1335,G18:7973,G15_MASK:21522,getBCHTypeInfo:function(o){for(var u=o<<10;i.getBCHDigit(u)-i.getBCHDigit(i.G15)>=0;)u^=i.G15<<i.getBCHDigit(u)-i.getBCHDigit(i.G15);return(o<<10|u)^i.G15_MASK},getBCHTypeNumber:function(o){for(var u=o<<12;i.getBCHDigit(u)-i.getBCHDigit(i.G18)>=0;)u^=i.G18<<i.getBCHDigit(u)-i.getBCHDigit(i.G18);return o<<12|u},getBCHDigit:function(o){for(var u=0;o!=0;)u++,o>>>=1;return u},getPatternPosition:function(o){return i.PATTERN_POSITION_TABLE[o-1]},getMask:function(o,u,c){switch(o){case a.PATTERN000:return(u+c)%2==0;case a.PATTERN001:return u%2==0;case a.PATTERN010:return c%3==0;case a.PATTERN011:return(u+c)%3==0;case a.PATTERN100:return(Math.floor(u/2)+Math.floor(c/3))%2==0;case a.PATTERN101:return u*c%2+u*c%3==0;case a.PATTERN110:return(u*c%2+u*c%3)%2==0;case a.PATTERN111:return(u*c%3+(u+c)%2)%2==0;default:throw new Error("bad maskPattern:"+o)}},getErrorCorrectPolynomial:function(o){for(var u=new r([1],0),c=0;c<o;c++)u=u.multiply(new r([1,t.gexp(c)],0));return u},getLengthInBits:function(o,u){if(1<=u&&u<10)switch(o){case e.MODE_NUMBER:return 10;case e.MODE_ALPHA_NUM:return 9;case e.MODE_8BIT_BYTE:return 8;case e.MODE_KANJI:return 8;default:throw new Error("mode:"+o)}else if(u<27)switch(o){case e.MODE_NUMBER:return 12;case e.MODE_ALPHA_NUM:return 11;case e.MODE_8BIT_BYTE:return 16;case e.MODE_KANJI:return 10;default:throw new Error("mode:"+o)}else if(u<41)switch(o){case e.MODE_NUMBER:return 14;case e.MODE_ALPHA_NUM:return 13;case e.MODE_8BIT_BYTE:return 16;case e.MODE_KANJI:return 12;default:throw new Error("mode:"+o)}else throw new Error("type:"+u)},getLostPoint:function(o){for(var u=o.getModuleCount(),c=0,h=0;h<u;h++)for(var x=0;x<u;x++){for(var m=0,w=o.isDark(h,x),p=-1;p<=1;p++)if(!(h+p<0||u<=h+p))for(var v=-1;v<=1;v++)x+v<0||u<=x+v||p==0&&v==0||w==o.isDark(h+p,x+v)&&m++;m>5&&(c+=3+m-5)}for(var h=0;h<u-1;h++)for(var x=0;x<u-1;x++){var y=0;o.isDark(h,x)&&y++,o.isDark(h+1,x)&&y++,o.isDark(h,x+1)&&y++,o.isDark(h+1,x+1)&&y++,(y==0||y==4)&&(c+=3)}for(var h=0;h<u;h++)for(var x=0;x<u-6;x++)o.isDark(h,x)&&!o.isDark(h,x+1)&&o.isDark(h,x+2)&&o.isDark(h,x+3)&&o.isDark(h,x+4)&&!o.isDark(h,x+5)&&o.isDark(h,x+6)&&(c+=40);for(var x=0;x<u;x++)for(var h=0;h<u-6;h++)o.isDark(h,x)&&!o.isDark(h+1,x)&&o.isDark(h+2,x)&&o.isDark(h+3,x)&&o.isDark(h+4,x)&&!o.isDark(h+5,x)&&o.isDark(h+6,x)&&(c+=40);for(var T=0,x=0;x<u;x++)for(var h=0;h<u;h++)o.isDark(h,x)&&T++;var E=Math.abs(100*T/u/u-50)/5;return c+=E*10,c}};return Fu=i,Fu}var Iu,Hx;function aC(){if(Hx)return Iu;Hx=1;var e=eC(),r=tC(),t=rC(),a=nC(),i=eg();function o(c,h){this.typeNumber=c,this.errorCorrectLevel=h,this.modules=null,this.moduleCount=0,this.dataCache=null,this.dataList=[]}var u=o.prototype;return u.addData=function(c){var h=new e(c);this.dataList.push(h),this.dataCache=null},u.isDark=function(c,h){if(c<0||this.moduleCount<=c||h<0||this.moduleCount<=h)throw new Error(c+","+h);return this.modules[c][h]},u.getModuleCount=function(){return this.moduleCount},u.make=function(){if(this.typeNumber<1){var c=1;for(c=1;c<40;c++){for(var h=r.getRSBlocks(c,this.errorCorrectLevel),x=new t,m=0,w=0;w<h.length;w++)m+=h[w].dataCount;for(var w=0;w<this.dataList.length;w++){var p=this.dataList[w];x.put(p.mode,4),x.put(p.getLength(),a.getLengthInBits(p.mode,c)),p.write(x)}if(x.getLengthInBits()<=m*8)break}this.typeNumber=c}this.makeImpl(!1,this.getBestMaskPattern())},u.makeImpl=function(c,h){this.moduleCount=this.typeNumber*4+17,this.modules=new Array(this.moduleCount);for(var x=0;x<this.moduleCount;x++){this.modules[x]=new Array(this.moduleCount);for(var m=0;m<this.moduleCount;m++)this.modules[x][m]=null}this.setupPositionProbePattern(0,0),this.setupPositionProbePattern(this.moduleCount-7,0),this.setupPositionProbePattern(0,this.moduleCount-7),this.setupPositionAdjustPattern(),this.setupTimingPattern(),this.setupTypeInfo(c,h),this.typeNumber>=7&&this.setupTypeNumber(c),this.dataCache==null&&(this.dataCache=o.createData(this.typeNumber,this.errorCorrectLevel,this.dataList)),this.mapData(this.dataCache,h)},u.setupPositionProbePattern=function(c,h){for(var x=-1;x<=7;x++)if(!(c+x<=-1||this.moduleCount<=c+x))for(var m=-1;m<=7;m++)h+m<=-1||this.moduleCount<=h+m||(0<=x&&x<=6&&(m==0||m==6)||0<=m&&m<=6&&(x==0||x==6)||2<=x&&x<=4&&2<=m&&m<=4?this.modules[c+x][h+m]=!0:this.modules[c+x][h+m]=!1)},u.getBestMaskPattern=function(){for(var c=0,h=0,x=0;x<8;x++){this.makeImpl(!0,x);var m=a.getLostPoint(this);(x==0||c>m)&&(c=m,h=x)}return h},u.createMovieClip=function(c,h,x){var m=c.createEmptyMovieClip(h,x),w=1;this.make();for(var p=0;p<this.modules.length;p++)for(var v=p*w,y=0;y<this.modules[p].length;y++){var T=y*w,E=this.modules[p][y];E&&(m.beginFill(0,100),m.moveTo(T,v),m.lineTo(T+w,v),m.lineTo(T+w,v+w),m.lineTo(T,v+w),m.endFill())}return m},u.setupTimingPattern=function(){for(var c=8;c<this.moduleCount-8;c++)this.modules[c][6]==null&&(this.modules[c][6]=c%2==0);for(var h=8;h<this.moduleCount-8;h++)this.modules[6][h]==null&&(this.modules[6][h]=h%2==0)},u.setupPositionAdjustPattern=function(){for(var c=a.getPatternPosition(this.typeNumber),h=0;h<c.length;h++)for(var x=0;x<c.length;x++){var m=c[h],w=c[x];if(this.modules[m][w]==null)for(var p=-2;p<=2;p++)for(var v=-2;v<=2;v++)p==-2||p==2||v==-2||v==2||p==0&&v==0?this.modules[m+p][w+v]=!0:this.modules[m+p][w+v]=!1}},u.setupTypeNumber=function(c){for(var h=a.getBCHTypeNumber(this.typeNumber),x=0;x<18;x++){var m=!c&&(h>>x&1)==1;this.modules[Math.floor(x/3)][x%3+this.moduleCount-8-3]=m}for(var x=0;x<18;x++){var m=!c&&(h>>x&1)==1;this.modules[x%3+this.moduleCount-8-3][Math.floor(x/3)]=m}},u.setupTypeInfo=function(c,h){for(var x=this.errorCorrectLevel<<3|h,m=a.getBCHTypeInfo(x),w=0;w<15;w++){var p=!c&&(m>>w&1)==1;w<6?this.modules[w][8]=p:w<8?this.modules[w+1][8]=p:this.modules[this.moduleCount-15+w][8]=p}for(var w=0;w<15;w++){var p=!c&&(m>>w&1)==1;w<8?this.modules[8][this.moduleCount-w-1]=p:w<9?this.modules[8][15-w-1+1]=p:this.modules[8][15-w-1]=p}this.modules[this.moduleCount-8][8]=!c},u.mapData=function(c,h){for(var x=-1,m=this.moduleCount-1,w=7,p=0,v=this.moduleCount-1;v>0;v-=2)for(v==6&&v--;;){for(var y=0;y<2;y++)if(this.modules[m][v-y]==null){var T=!1;p<c.length&&(T=(c[p]>>>w&1)==1);var E=a.getMask(h,m,v-y);E&&(T=!T),this.modules[m][v-y]=T,w--,w==-1&&(p++,w=7)}if(m+=x,m<0||this.moduleCount<=m){m-=x,x=-x;break}}},o.PAD0=236,o.PAD1=17,o.createData=function(c,h,x){for(var m=r.getRSBlocks(c,h),w=new t,p=0;p<x.length;p++){var v=x[p];w.put(v.mode,4),w.put(v.getLength(),a.getLengthInBits(v.mode,c)),v.write(w)}for(var y=0,p=0;p<m.length;p++)y+=m[p].dataCount;if(w.getLengthInBits()>y*8)throw new Error("code length overflow. ("+w.getLengthInBits()+">"+y*8+")");for(w.getLengthInBits()+4<=y*8&&w.put(0,4);w.getLengthInBits()%8!=0;)w.putBit(!1);for(;!(w.getLengthInBits()>=y*8||(w.put(o.PAD0,8),w.getLengthInBits()>=y*8));)w.put(o.PAD1,8);return o.createBytes(w,m)},o.createBytes=function(c,h){for(var x=0,m=0,w=0,p=new Array(h.length),v=new Array(h.length),y=0;y<h.length;y++){var T=h[y].dataCount,E=h[y].totalCount-T;m=Math.max(m,T),w=Math.max(w,E),p[y]=new Array(T);for(var _=0;_<p[y].length;_++)p[y][_]=255&c.buffer[_+x];x+=T;var C=a.getErrorCorrectPolynomial(E),S=new i(p[y],C.getLength()-1),N=S.mod(C);v[y]=new Array(C.getLength()-1);for(var _=0;_<v[y].length;_++){var B=_+N.getLength()-v[y].length;v[y][_]=B>=0?N.get(B):0}}for(var X=0,_=0;_<h.length;_++)X+=h[_].totalCount;for(var j=new Array(X),z=0,_=0;_<m;_++)for(var y=0;y<h.length;y++)_<p[y].length&&(j[z++]=p[y][_]);for(var _=0;_<w;_++)for(var y=0;y<h.length;y++)_<v[y].length&&(j[z++]=v[y][_]);return j},Iu=o,Iu}var Bl={},Vx;function sC(){if(Vx)return Bl;Vx=1,Object.defineProperty(Bl,"__esModule",{value:!0});var e=Object.assign||function(x){for(var m=1;m<arguments.length;m++){var w=arguments[m];for(var p in w)Object.prototype.hasOwnProperty.call(w,p)&&(x[p]=w[p])}return x},r=Qp(),t=o(r),a=ho(),i=o(a);function o(x){return x&&x.__esModule?x:{default:x}}function u(x,m){var w={};for(var p in x)m.indexOf(p)>=0||Object.prototype.hasOwnProperty.call(x,p)&&(w[p]=x[p]);return w}var c={bgColor:t.default.oneOfType([t.default.object,t.default.string]).isRequired,bgD:t.default.string.isRequired,fgColor:t.default.oneOfType([t.default.object,t.default.string]).isRequired,fgD:t.default.string.isRequired,size:t.default.number.isRequired,title:t.default.string,viewBoxSize:t.default.number.isRequired,xmlns:t.default.string},h=(0,a.forwardRef)(function(x,m){var w=x.bgColor,p=x.bgD,v=x.fgD,y=x.fgColor,T=x.size,E=x.title,_=x.viewBoxSize,C=x.xmlns,S=C===void 0?"http://www.w3.org/2000/svg":C,N=u(x,["bgColor","bgD","fgD","fgColor","size","title","viewBoxSize","xmlns"]);return i.default.createElement("svg",e({},N,{height:T,ref:m,viewBox:"0 0 "+_+" "+_,width:T,xmlns:S}),E?i.default.createElement("title",null,E):null,i.default.createElement("path",{d:p,fill:w}),i.default.createElement("path",{d:v,fill:y}))});return h.displayName="QRCodeSvg",h.propTypes=c,Bl.default=h,Bl}var Wx;function iC(){if(Wx)return Vs;Wx=1,Object.defineProperty(Vs,"__esModule",{value:!0}),Vs.QRCode=void 0;var e=Object.assign||function(T){for(var E=1;E<arguments.length;E++){var _=arguments[E];for(var C in _)Object.prototype.hasOwnProperty.call(_,C)&&(T[C]=_[C])}return T},r=Qp(),t=w(r),a=qp(),i=w(a),o=aC(),u=w(o),c=ho(),h=w(c),x=sC(),m=w(x);function w(T){return T&&T.__esModule?T:{default:T}}function p(T,E){var _={};for(var C in T)E.indexOf(C)>=0||Object.prototype.hasOwnProperty.call(T,C)&&(_[C]=T[C]);return _}var v={bgColor:t.default.oneOfType([t.default.object,t.default.string]),fgColor:t.default.oneOfType([t.default.object,t.default.string]),level:t.default.string,size:t.default.number,value:t.default.string.isRequired},y=(0,c.forwardRef)(function(T,E){var _=T.bgColor,C=_===void 0?"#FFFFFF":_,S=T.fgColor,N=S===void 0?"#000000":S,B=T.level,X=B===void 0?"L":B,j=T.size,z=j===void 0?256:j,M=T.value,U=p(T,["bgColor","fgColor","level","size","value"]),D=new u.default(-1,i.default[X]);D.addData(M),D.make();var R=D.modules;return h.default.createElement(m.default,e({},U,{bgColor:C,bgD:R.map(function(K,ae){return K.map(function(te,oe){return te?"":"M "+oe+" "+ae+" l 1 0 0 1 -1 0 Z"}).join(" ")}).join(" "),fgColor:N,fgD:R.map(function(K,ae){return K.map(function(te,oe){return te?"M "+oe+" "+ae+" l 1 0 0 1 -1 0 Z":""}).join(" ")}).join(" "),ref:E,size:z,viewBoxSize:R.length}))});return Vs.QRCode=y,y.displayName="QRCode",y.propTypes=v,Vs.default=y,Vs}var oC=iC();const lC=ac(oC),cC=({isOpen:e,onClose:r})=>{const[t,a]=I.useState(!1),i=typeof window<"u"?window.location.href:"";return I.useEffect(()=>{if(e){const o=setTimeout(()=>a(!0),10);return()=>clearTimeout(o)}else a(!1)},[e]),e?f.jsx("div",{className:`fixed inset-0 z-[6000] flex justify-center items-center p-4 transition-opacity duration-300 ease-in-out ${t?"opacity-100":"opacity-0"} bg-slate-900/60 backdrop-blur-sm`,onClick:r,"aria-modal":"true",role:"dialog",children:f.jsxs("div",{className:`bg-white rounded-lg shadow-xl w-full max-w-sm transform transition-all duration-300 ease-in-out ${t?"scale-100 opacity-100":"scale-95 opacity-0"}`,onClick:o=>o.stopPropagation(),children:[f.jsxs("div",{className:"flex justify-between items-center p-6 border-b border-slate-200",children:[f.jsx("h2",{className:"text-xl font-bold text-slate-800",children:"Condividi App"}),f.jsx("button",{onClick:r,className:"text-slate-400 hover:text-slate-700 p-1 rounded-full hover:bg-slate-200",children:f.jsx(xr,{className:"w-6 h-6"})})]}),f.jsxs("div",{className:"p-8 flex flex-col items-center justify-center space-y-6",children:[f.jsx("div",{className:"p-4 bg-white border-2 border-slate-100 rounded-xl shadow-sm",children:f.jsx(lC,{value:i,size:200,style:{height:"auto",maxWidth:"100%",width:"100%"},viewBox:"0 0 256 256"})}),f.jsx("p",{className:"text-center text-slate-600 text-sm",children:"Scansiona questo codice per aprire e installare l'app su un altro dispositivo."})]})]})}):null},uC=e=>f.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...e,children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15.666 3.888A2.25 2.25 0 0 0 13.5 2.25h-3c-1.03 0-1.9.693-2.166 1.638m7.332 0c.055.194.084.4.084.612v0a2.25 2.25 0 0 1-2.25 2.25h-1.5a2.25 2.25 0 0 1-2.25-2.25v0c0-.212.03-.418.084-.612m7.332 0c.646.049 1.288.11 1.927.184 1.1.128 1.907 1.077 1.907 2.185V19.5a2.25 2.25 0 0 1-2.25 2.25H6.75A2.25 2.25 0 0 1 4.5 19.5V6.257c0-1.108.806-2.057 1.907-2.185a48.208 48.208 0 0 1 1.927-.184"})}),fC=e=>f.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...e,children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M10.125 2.25h-4.5c-.621 0-1.125.504-1.125 1.125v17.25c0 .621.504 1.125 1.125 1.125h12.75c.621 0 1.125-.504 1.125-1.125v-9M10.125 2.25h.375a9 9 0 0 1 9 9v.375M10.125 2.25A3.375 3.375 0 0 1 13.5 5.625v1.5c0 .621.504 1.125 1.125 1.125h1.5a3.375 3.375 0 0 1 3.375 3.375M9 15l2.25 2.25L15 12"})}),dC=({isOpen:e,onClose:r})=>{const[t,a]=I.useState(!1),[i,o]=I.useState(!1);I.useEffect(()=>{if(e){o(!1);const m=setTimeout(()=>a(!0),10);return()=>clearTimeout(m)}else a(!1)},[e]);const u=()=>{navigator.clipboard.writeText(window.location.href).then(()=>{o(!0),setTimeout(()=>o(!1),2e3)})};if(!e)return null;const c=/iPad|iPhone|iPod/.test(navigator.userAgent)&&!window.MSStream,h=/Android/.test(navigator.userAgent),x=()=>c?f.jsxs(f.Fragment,{children:["Tocca l'icona ",f.jsx("strong",{children:"Condividi"})," ",f.jsx("img",{src:"https://img.icons8.com/ios-glyphs/30/000000/share--v1.png",alt:"Share Icon",className:"inline w-5 h-5 mx-1 align-text-bottom"})," e poi seleziona ",f.jsx("strong",{children:'"Aggiungi alla schermata Home"'}),"."]}):h?f.jsxs(f.Fragment,{children:["Tocca i tre puntini ",f.jsx("strong",{className:"text-xl align-middle mx-1",children:""})," nel menu del browser e seleziona ",f.jsx("strong",{children:'"Installa app"'})," o ",f.jsx("strong",{children:'"Aggiungi a schermata Home"'}),"."]}):"Usa il menu del tuo browser per aggiungere questo sito alla tua schermata principale o per installare l'app.";return f.jsx("div",{className:`fixed inset-0 z-50 flex justify-center items-center p-4 transition-opacity duration-300 ease-in-out ${t?"opacity-100":"opacity-0"} bg-slate-900/60 backdrop-blur-sm`,onClick:r,"aria-modal":"true",role:"dialog",children:f.jsxs("div",{className:`bg-white rounded-lg shadow-xl w-full max-w-lg transform transition-all duration-300 ease-in-out ${t?"scale-100 opacity-100":"scale-95 opacity-0"}`,onClick:m=>m.stopPropagation(),children:[f.jsxs("div",{className:"flex justify-between items-center p-6 border-b border-slate-200",children:[f.jsx("h2",{className:"text-xl font-bold text-slate-800",children:"Installa l'App"}),f.jsx("button",{onClick:r,className:"text-slate-400 hover:text-slate-700 p-1 rounded-full hover:bg-slate-200",children:f.jsx(xr,{className:"w-6 h-6"})})]}),f.jsxs("div",{className:"p-6 space-y-4",children:[f.jsxs("div",{className:"text-sm text-slate-600 bg-slate-100 p-3 rounded-md flex items-start gap-2",children:[f.jsx(Nf,{className:"w-5 h-5 text-slate-500 flex-shrink-0 mt-0.5"}),f.jsx("span",{children:"L'ambiente di anteprima pu limitare l'installazione diretta. Per un'esperienza ottimale, apri l'app nel tuo browser principale seguendo questi passaggi."})]}),f.jsxs("div",{className:"bg-white p-4 rounded-lg border border-slate-200",children:[f.jsx("p",{className:"font-bold text-slate-800 mb-2",children:"1. Copia l'URL dell'App"}),f.jsxs("div",{className:"flex gap-2",children:[f.jsx("input",{type:"text",value:window.location.href,readOnly:!0,className:"flex-grow bg-slate-100 text-slate-700 rounded-md border border-slate-300 px-3 py-2 text-sm focus:outline-none focus:ring-1 focus:ring-indigo-500"}),f.jsxs("button",{onClick:u,className:`w-[110px] flex-shrink-0 flex items-center justify-center gap-2 px-4 py-2 text-sm font-semibold rounded-md transition-all duration-200 ${i?"bg-green-600 text-white":"bg-indigo-600 text-white hover:bg-indigo-700"}`,children:[i?f.jsx(fC,{className:"w-5 h-5"}):f.jsx(uC,{className:"w-5 h-5"}),f.jsx("span",{children:i?"Copiato!":"Copia"})]})]})]}),f.jsxs("div",{className:"bg-white p-4 rounded-lg border border-slate-200",children:[f.jsx("p",{className:"font-bold text-slate-800 mb-2",children:"2. Apri in una nuova scheda"}),f.jsxs("p",{className:"text-sm text-slate-600",children:["Apri una nuova scheda nel tuo browser e ",f.jsx("strong",{children:"incolla l'URL"}),"."]})]}),f.jsxs("div",{className:"bg-indigo-100 p-4 rounded-lg border border-indigo-200",children:[f.jsx("p",{className:"font-bold text-indigo-800 mb-2",children:"3. Aggiungi alla Home"}),f.jsx("p",{className:"text-sm text-indigo-700",children:x()})]})]}),f.jsx("div",{className:"px-6 py-4 bg-slate-50 flex justify-end",children:f.jsx("button",{type:"button",onClick:r,className:"px-4 py-2 text-base font-semibold text-slate-700 bg-white border border-slate-300 rounded-lg shadow-sm hover:bg-slate-100 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2 transition-colors",children:"Ho Capito"})})]})})},hC=e=>f.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...e,children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 17.25v1.007a3 3 0 0 1-.879 2.122L7.5 21h9l-.621-.621A3 3 0 0 1 15 18.257V17.25m6-12V15a2.25 2.25 0 0 1-2.25 2.25H5.25A2.25 2.25 0 0 1 3 15V5.25A2.25 2.25 0 0 1 5.25 3h13.5A2.25 2.25 0 0 1 21 5.25Z"})}),tg=e=>f.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...e,children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 9.75 14.25 12m0 0 2.25 2.25M14.25 12l2.25-2.25M14.25 12 12 14.25m-2.58 4.92-6.374-6.375a1.125 1.125 0 0 1 0-1.59L9.42 4.83c.21-.211.497-.33.795-.33H19.5a2.25 2.25 0 0 1 2.25 2.25v10.5a2.25 2.25 0 0 1-2.25 2.25h-9.284c-.298 0-.585-.119-.795-.33Z"})}),$x=e=>{const r=String(e||"0").replace(".",","),[t,a]=r.split(","),i=(t||"0").replace(/\B(?=(\d{3})+(?!\d))/g,".");return a!==void 0?`${i},${a}`:i},xC=e=>{const r=e.length;return r<=4?"text-9xl":r<=6?"text-8xl":r<=8?"text-7xl":r<=11?"text-6xl":"text-5xl"},vn=({children:e,onClick:r,className:t="",...a})=>{const i=o=>{o&&o.blur&&o.blur()};return f.jsx("div",{role:"button",tabIndex:0,"aria-label":typeof e=="string"?`Tasto ${e}`:"Tasto","aria-pressed":"false",onClick:o=>{r==null||r(),i(o.currentTarget)},onKeyDown:o=>{(o.key==="Enter"||o.key===" ")&&r&&(o.preventDefault(),r(),i(o.currentTarget))},onPointerUp:o=>i(o.currentTarget),onMouseDown:o=>o.preventDefault(),className:`flex items-center justify-center text-5xl font-light focus:outline-none focus-visible:ring-2 focus-visible:ring-inset focus-visible:ring-indigo-400 transition-colors duration-150 select-none cursor-pointer active:scale-95 ${t}`,style:{WebkitTapHighlightColor:"transparent",touchAction:"manipulation",WebkitTouchCallout:"none",userSelect:"none"},...a,children:f.jsx("span",{className:"pointer-events-none",children:e})})},Bi=({children:e,onClick:r})=>{const t=a=>{a&&a.blur&&a.blur()};return f.jsx("div",{role:"button",tabIndex:0,"aria-label":`Operatore ${e}`,"aria-pressed":"false",onClick:a=>{r(),t(a.currentTarget)},onKeyDown:a=>{(a.key==="Enter"||a.key===" ")&&(a.preventDefault(),r(),t(a.currentTarget))},onPointerUp:a=>t(a.currentTarget),onMouseDown:a=>a.preventDefault(),className:"flex-1 w-full text-5xl text-indigo-600 font-light active:bg-slate-300/80 transition-colors duration-150 flex items-center justify-center focus:outline-none focus-visible:ring-2 focus-visible:ring-inset focus-visible:ring-indigo-400 select-none cursor-pointer active:scale-95",style:{WebkitTapHighlightColor:"transparent",touchAction:"manipulation"},children:f.jsx("span",{className:"pointer-events-none",children:e})})},rg=Tn.forwardRef(({onClose:e,onSubmit:r,accounts:t,formData:a,onFormChange:i,onMenuStateChange:o,isDesktop:u,onNavigateToDetails:c},h)=>{var _e;const[x,m]=I.useState("0"),[w,p]=I.useState(null),[v,y]=I.useState(null),[T,E]=I.useState(!1),[_,C]=I.useState(!1),[S,N]=I.useState(null),B=I.useRef(!1),X=I.useRef(!1);I.useEffect(()=>{o(S!==null)},[S,o]),I.useEffect(()=>{const F=ke=>{ke.detail==="calculator"&&(X.current=!1,E(!1),C(!1))};return window.addEventListener("page-activated",F),()=>window.removeEventListener("page-activated",F)},[]);const j=I.useRef(null);I.useEffect(()=>{const F=a.amount??0,ke=parseFloat(x.replace(/\./g,"").replace(",","."))||0;Math.abs(F-ke)>.01&&!X.current&&(B.current=!0,m(String(F).replace(".",",")),p(null),y(null),E(!1),C(!1))},[a.amount,x]),I.useEffect(()=>{if(B.current){B.current=!1;return}return j.current&&clearTimeout(j.current),j.current=window.setTimeout(()=>{const F=parseFloat(x.replace(/\./g,"").replace(",","."))||0;Math.abs(F-(a.amount??0))>.01&&i({amount:F})},300),()=>{j.current&&clearTimeout(j.current)}},[x,a.amount,i]);const z=I.useCallback(()=>{X.current=!0,m("0"),C(!1)},[]),M=I.useCallback(()=>{if(X.current=!0,_){z();return}if(T){m("0"),p(null),y(null),E(!1);return}m(F=>{const ke=F.replace(/\./g,"");return ke.length>1?ke.slice(0,-1):"0"})},[_,T,z]),U=I.useRef(null),D=I.useRef(!1),R=I.useRef(0),K=I.useRef(0),ae=450,te=8,oe=I.useCallback(()=>{U.current!==null&&(window.clearTimeout(U.current),U.current=null)},[]),re=I.useCallback(F=>{var ke,Fe;D.current=!1,R.current=F.clientX??0,K.current=F.clientY??0;try{(Fe=(ke=F.currentTarget).setPointerCapture)==null||Fe.call(ke,F.pointerId??1)}catch{}oe(),U.current=window.setTimeout(()=>{D.current=!0,oe(),z(),navigator.vibrate&&navigator.vibrate(10)},ae)},[oe,z]),Z=I.useCallback(F=>{if(!U.current)return;const ke=Math.abs((F.clientX??0)-R.current),Fe=Math.abs((F.clientY??0)-K.current);(ke>te||Fe>te)&&oe()},[oe]),ge=I.useCallback(()=>{const F=D.current;if(oe(),F){D.current=!1;return}M()},[oe,M]),q=I.useCallback(()=>{oe()},[oe]);I.useEffect(()=>{const F=()=>oe();return window.addEventListener("numPad:cancelLongPress",F),()=>window.removeEventListener("numPad:cancelLongPress",F)},[oe]);const Q=I.useCallback(()=>{const F=parseFloat((w||"0").replace(/\./g,"").replace(",",".")),ke=parseFloat(x.replace(/\./g,"").replace(",","."));let Fe=0;switch(v){case"+":Fe=F+ke;break;case"-":Fe=F-ke;break;case"":Fe=F*ke;break;case"":if(ke===0)return"Error";Fe=F/ke;break;default:return x.replace(".",",")}return C(!0),String(parseFloat(Fe.toPrecision(12))).replace(".",",")},[x,w,v]),ie=I.useCallback(F=>{if(X.current=!0,["","","-","+"].includes(F)){if(v&&w&&!T){const ke=Q();p(ke),m(ke)}else p(x);y(F),E(!0),C(!1)}else if(F==="="){if(v&&w){const ke=Q();m(ke),p(null),y(null),E(!0)}}else{if(C(!1),T){m(F===","?"0,":F),E(!1);return}m(ke=>{var Ge;const Fe=ke.replace(/\./g,"");return F===","&&Fe.includes(",")||Fe.replace(",","").length>=12?ke:Fe==="0"&&F!==","?F:Fe.includes(",")&&((Ge=Fe.split(",")[1])==null?void 0:Ge.length)>=2?ke:Fe+F})}},[x,v,w,T,Q]),ve=I.useMemo(()=>(parseFloat(x.replace(/\./g,"").replace(",","."))||0)>0,[x]),pe=I.useCallback(()=>{const F=parseFloat(x.replace(/\./g,"").replace(",","."))||0;F>0&&r({...a,amount:F,category:a.category||"Altro"})},[x,a,r]),Ae=I.useCallback((F,ke)=>{const Fe={[F]:ke};F==="category"&&(Fe.subcategory=""),i(Fe),N(null)},[i]),je=I.useMemo(()=>Object.keys(nn).map(F=>({value:F,label:hr(F).label,Icon:hr(F).Icon,color:hr(F).color,bgColor:hr(F).bgColor})),[]),ze=I.useMemo(()=>{var F;return a.category?((F=nn[a.category])==null?void 0:F.map(ke=>({value:ke,label:ke})))||[]:[]},[a.category]),P=I.useMemo(()=>t.map(F=>({value:F.id,label:F.name})),[t]),ee=I.useMemo(()=>$x(x),[x]),J=I.useMemo(()=>w&&v?`${$x(w)} ${v}`:" ",[w,v]),G=I.useMemo(()=>xC(ee),[ee]);return f.jsxs("div",{ref:h,tabIndex:-1,className:"bg-slate-100 w-full h-full flex flex-col focus:outline-none",style:{touchAction:"pan-y"},children:[f.jsxs("div",{className:"flex-1 flex flex-col",children:[f.jsxs("header",{className:"flex items-center justify-between p-4 flex-shrink-0",children:[f.jsx("button",{onClick:()=>e(),onPointerDown:F=>F.stopPropagation(),"data-no-synthetic-click":!0,"aria-label":"Chiudi calcolatrice",className:"w-11 h-11 flex items-center justify-center border border-red-300 text-red-600 bg-red-50 hover:bg-red-100 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500 rounded-full transition-colors cursor-pointer",children:f.jsx(xr,{className:"w-6 h-6"})}),f.jsx("h2",{className:"text-xl font-bold text-slate-800",children:"Nuova Spesa"}),f.jsx("button",{onClick:F=>{F.stopPropagation(),F.preventDefault();const ke=Fe=>{Fe.stopPropagation(),Fe.preventDefault()};window.addEventListener("click",ke,{capture:!0,once:!0}),setTimeout(()=>window.removeEventListener("click",ke,{capture:!0}),600),pe()},onPointerDown:F=>F.stopPropagation(),"data-no-synthetic-click":!0,disabled:!ve,"aria-label":"Conferma spesa",className:`w-11 h-11 flex items-center justify-center border rounded-full transition-colors
              border-green-500 bg-green-200 text-green-800 hover:bg-green-300 
              focus:outline-none focus:ring-2 focus:ring-green-500 
              disabled:bg-slate-100 disabled:border-slate-200 disabled:text-slate-400 disabled:cursor-not-allowed
              ${u?"hidden":""}`,children:f.jsx(Yn,{className:"w-7 h-7"})}),u&&f.jsx("div",{className:"w-11 h-11"})]}),f.jsxs("main",{className:"flex-1 flex flex-col overflow-hidden relative",style:{touchAction:"pan-y"},children:[f.jsx("div",{className:"flex-1 flex flex-col justify-center items-center p-4 pt-0",children:f.jsxs("div",{className:"w-full px-4 text-center",children:[f.jsx("span",{className:"text-slate-500 text-2xl font-light h-8 block",children:J}),f.jsxs("div",{className:`relative inline-block text-slate-800 font-light tracking-tighter whitespace-nowrap transition-all leading-none ${G}`,children:[ee,f.jsx("span",{className:"absolute right-full top-1/2 -translate-y-1/2 opacity-75",style:{fontSize:"0.6em",marginRight:"0.2em"},children:""})]})]})}),f.jsxs("div",{role:"button",tabIndex:0,"aria-label":"Aggiungi dettagli alla spesa","aria-hidden":u,onClick:c,onKeyDown:F=>{(F.key==="Enter"||F.key===" ")&&c()},className:`absolute top-1/2 -right-px w-8 h-[148px] flex items-center justify-center cursor-pointer ${u?"hidden":""}`,style:{transform:"translateY(calc(-50% + 2px))"},children:[f.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:f.jsx("div",{className:"transform -rotate-90",children:f.jsx(Gp,{width:"148",height:"32",fill:"rgba(199, 210, 254, 0.8)"})})}),f.jsx(Sf,{className:"relative z-10 w-6 h-6 text-indigo-600 transition-colors"})]})]})]}),f.jsxs("div",{className:"flex-shrink-0 flex flex-col",style:{height:"52vh"},children:[f.jsxs("div",{className:"flex justify-between items-center my-2 w-full px-4",style:{touchAction:"pan-y"},children:[f.jsx("button",{onClick:()=>N("account"),className:"font-semibold text-indigo-600 hover:text-indigo-800 text-lg w-1/3 truncate p-2 rounded-lg focus:outline-none focus:ring-0 text-left","aria-label":"Seleziona conto",children:((_e=t.find(F=>F.id===a.accountId))==null?void 0:_e.name)||"Conto"}),f.jsx("button",{onClick:()=>N("category"),className:"font-semibold text-indigo-600 hover:text-indigo-800 text-lg w-1/3 truncate p-2 rounded-lg focus:outline-none focus:ring-0 text-center","aria-label":"Seleziona categoria",children:a.category?hr(a.category).label:"Categoria"}),f.jsx("button",{onClick:()=>N("subcategory"),disabled:!a.category||ze.length===0,className:"font-semibold text-lg w-1/3 truncate p-2 rounded-lg focus:outline-none focus:ring-0 disabled:cursor-not-allowed disabled:text-slate-400 text-indigo-600 hover:text-indigo-800 transition-colors text-right","aria-label":"Seleziona sottocategoria","aria-disabled":!a.category||ze.length===0,children:a.subcategory||"Sottocateg."})]}),f.jsxs("div",{className:"flex-1 p-2 flex flex-row gap-2 px-4 pb-4",children:[f.jsxs("div",{className:"h-full w-4/5 grid grid-cols-3 grid-rows-4 gap-2 num-pad",children:[f.jsx(vn,{className:"text-slate-800",onClick:()=>ie("7"),children:"7"}),f.jsx(vn,{className:"text-slate-800",onClick:()=>ie("8"),children:"8"}),f.jsx(vn,{className:"text-slate-800",onClick:()=>ie("9"),children:"9"}),f.jsx(vn,{className:"text-slate-800",onClick:()=>ie("4"),children:"4"}),f.jsx(vn,{className:"text-slate-800",onClick:()=>ie("5"),children:"5"}),f.jsx(vn,{className:"text-slate-800",onClick:()=>ie("6"),children:"6"}),f.jsx(vn,{className:"text-slate-800",onClick:()=>ie("1"),children:"1"}),f.jsx(vn,{className:"text-slate-800",onClick:()=>ie("2"),children:"2"}),f.jsx(vn,{className:"text-slate-800",onClick:()=>ie("3"),children:"3"}),f.jsx(vn,{className:"text-slate-800",onClick:()=>ie(","),children:","}),f.jsx(vn,{className:"text-slate-800",onClick:()=>ie("0"),children:"0"}),f.jsx(vn,{title:"Tocca: cancella una cifra  Tieni premuto: cancella tutto","aria-label":"Cancella",onPointerDownCapture:re,onPointerMoveCapture:Z,onPointerUpCapture:ge,onPointerCancelCapture:q,onContextMenu:F=>F.preventDefault(),children:f.jsx(tg,{className:"w-8 h-8 text-slate-800"})})]}),f.jsxs("div",{className:"h-full w-1/5 flex flex-col gap-2 bg-slate-200 rounded-2xl p-1",style:{touchAction:"pan-y"},children:[f.jsx(Bi,{onClick:()=>ie(""),children:""}),f.jsx(Bi,{onClick:()=>ie(""),children:""}),f.jsx(Bi,{onClick:()=>ie("-"),children:"-"}),f.jsx(Bi,{onClick:()=>ie("+"),children:"+"}),f.jsx(Bi,{onClick:()=>ie("="),children:"="})]})]})]}),f.jsx(Ln,{isOpen:S==="account",onClose:()=>N(null),title:"Seleziona un Conto",options:P,selectedValue:a.accountId||"",onSelect:F=>Ae("accountId",F)}),f.jsx(Ln,{isOpen:S==="category",onClose:()=>N(null),title:"Seleziona una Categoria",options:je,selectedValue:a.category||"",onSelect:F=>Ae("category",F)}),f.jsx(Ln,{isOpen:S==="subcategory",onClose:()=>N(null),title:"Seleziona Sottocategoria",options:ze,selectedValue:a.subcategory||"",onSelect:F=>Ae("subcategory",F)})]})});rg.displayName="CalculatorInputScreen";const Xx=e=>{const r=e.getFullYear(),t=String(e.getMonth()+1).padStart(2,"0"),a=String(e.getDate()).padStart(2,"0");return`${r}-${t}-${a}`},Ff=e=>{if(!e)return null;const[r,t,a]=e.split("-").map(Number);return new Date(Date.UTC(r,t-1,a))},Hl={daily:"Giornaliera",weekly:"Settimanale",monthly:"Mensile",yearly:"Annuale"},mC={0:"Dom",1:"Lun",2:"Mar",3:"Mer",4:"Gio",5:"Ven",6:"Sab"},ng=["domenica","luned","marted","mercoled","gioved","venerd","sabato"],ag=["primo","secondo","terzo","quarto","ultimo"],pC=e=>{const r=Ff(e);return r?new Intl.DateTimeFormat("it-IT",{day:"numeric",month:"short",timeZone:"UTC"}).format(r).replace(".",""):""},Vl=I.memo(({isOpen:e,isAnimating:r,onClose:t,title:a,children:i,className:o})=>!e&&!r?null:f.jsx("div",{className:`absolute inset-0 z-[60] flex justify-center items-center p-4 transition-opacity duration-300 ${r?"opacity-100":"opacity-0"} bg-slate-900/60 backdrop-blur-sm`,onClick:u=>{u.stopPropagation(),t()},onPointerDown:u=>u.stopPropagation(),onPointerUp:u=>u.stopPropagation(),onPointerMove:u=>u.stopPropagation(),"aria-modal":"true",role:"dialog",children:f.jsxs("div",{className:`bg-white rounded-lg shadow-xl w-full max-w-sm transform transition-all duration-300 ${r?"scale-100 opacity-100":"scale-95 opacity-0"} ${o||""}`,onClick:u=>u.stopPropagation(),children:[f.jsxs("div",{className:"flex justify-between items-center p-4 border-b border-slate-200",children:[f.jsx("h2",{className:"text-lg font-bold text-slate-800",children:a}),f.jsx("button",{type:"button",onClick:t,className:"text-slate-500 hover:text-slate-800 p-1 rounded-full hover:bg-slate-200 focus:outline-none focus:ring-2 focus:ring-indigo-500","aria-label":"Chiudi",children:f.jsx(xr,{className:"w-6 h-6"})})]}),i]})}));Vl.displayName="Modal";const gC=[{label:"Lun",value:1},{label:"Mar",value:2},{label:"Mer",value:3},{label:"Gio",value:4},{label:"Ven",value:5},{label:"Sab",value:6},{label:"Dom",value:0}],vC=e=>{if(e.frequency!=="recurring"||!e.recurrence)return"Imposta ricorrenza";const{recurrence:r,recurrenceInterval:t=1,recurrenceDays:a,monthlyRecurrenceType:i,date:o,recurrenceEndType:u="forever",recurrenceEndDate:c,recurrenceCount:h}=e;let x="";if(t===1?x=Hl[r]:x=r==="daily"?`Ogni ${t} giorni`:r==="weekly"?`Ogni ${t} sett.`:r==="monthly"?`Ogni ${t} mesi`:`Ogni ${t} anni`,r==="weekly"&&(a!=null&&a.length)){const w=[...a].sort((p,v)=>(p===0?7:p)-(v===0?7:v)).map(p=>mC[p]);x+=`: ${w.join(", ")}`}if(r==="monthly"&&i==="dayOfWeek"&&o){const m=Ff(o);if(m){const w=m.getUTCDate(),p=m.getUTCDay(),v=Math.floor((w-1)/7);x+=` (${ag[v]} ${ng[p].slice(0,3)}.)`}}return u==="date"&&c?x+=`, fino al ${pC(c)}`:u==="count"&&h&&h>0&&(x+=`, ${h} volte`),x},wC=(e,r)=>{const t=r||1;switch(e){case"daily":return t===1?"giorno":"giorni";case"weekly":return t===1?"settimana":"settimane";case"monthly":return t===1?"mese":"mesi";case"yearly":return t===1?"anno":"anni";default:return"mese"}},yC=({formData:e,onFormChange:r,accounts:t,onClose:a,onSubmit:i,isDesktop:o,onMenuStateChange:u,dateError:c})=>{var st;const h=I.useRef(null),x=I.useRef(null),m=ni(),[w,p]=I.useState(null),[v,y]=I.useState(!1),[T,E]=I.useState(!1),[_,C]=I.useState(!1),[S,N]=I.useState(!1),[B,X]=I.useState(!1),[j,z]=I.useState(!1),[M,U]=I.useState(!1),[D,R]=I.useState(!1),K=I.useRef(0),[ae,te]=I.useState(null),[oe,re]=I.useState(e.recurrence),[Z,ge]=I.useState(e.recurrenceInterval),[q,Q]=I.useState(e.recurrenceDays),[ie,ve]=I.useState(e.monthlyRecurrenceType),pe=I.useRef(e);I.useEffect(()=>{pe.current=e},[e]);const Ae=e.frequency==="recurring"&&e.recurrenceEndType==="count"&&e.recurrenceCount===1;I.useEffect(()=>{if(!e.time&&!e.frequency){const ye=new Date().toLocaleTimeString("it-IT",{hour:"2-digit",minute:"2-digit"});r({time:ye})}},[]);const je=I.useRef(null);I.useEffect(()=>{je.current=()=>{const ye=document.activeElement;ye===x.current&&ye.blur()}},[]),I.useEffect(()=>{const ye=window.visualViewport;if(!ye)return;let Ce=ye.height;const le=()=>{ye.height-Ce>100&&je.current&&je.current(),Ce=ye.height};return ye.addEventListener("resize",le),()=>ye.removeEventListener("resize",le)},[]),I.useEffect(()=>{u(!!(w||v||_||M))},[w,v,_,M,u]),I.useEffect(()=>{if(v){const ye=setTimeout(()=>E(!0),10);return()=>clearTimeout(ye)}else E(!1)},[v]),I.useEffect(()=>{if(M){const ye=setTimeout(()=>R(!0),10);return()=>clearTimeout(ye)}else R(!1)},[M]),I.useEffect(()=>{if(_){re(e.recurrence||"monthly"),ge(e.recurrenceInterval||1),Q(e.recurrenceDays||[]),ve(e.monthlyRecurrenceType||"dayOfMonth"),X(!1);const ye=setTimeout(()=>N(!0),10);return()=>clearTimeout(ye)}else N(!1)},[_,e.recurrence,e.recurrenceInterval,e.recurrenceDays,e.monthlyRecurrenceType]);const ze=ye=>{const{name:Ce,value:le}=ye.target;if(Ce==="recurrenceEndDate"){r(le===""?{recurrenceEndType:"forever",recurrenceEndDate:void 0}:{recurrenceEndDate:le});return}if(Ce==="recurrenceCount"){const ce=parseInt(le,10);r({[Ce]:isNaN(ce)||ce<=0?void 0:ce});return}r({[Ce]:le})},P=ye=>{r({accountId:ye}),p(null)},ee=ye=>{const Ce={};ye==="none"?Object.assign(Ce,{frequency:void 0,date:Xx(new Date),time:void 0,recurrence:void 0,monthlyRecurrenceType:void 0,recurrenceInterval:void 0,recurrenceDays:void 0,recurrenceEndType:"forever",recurrenceEndDate:void 0,recurrenceCount:void 0}):ye==="single"?(Ce.frequency="recurring",Ce.recurrence=void 0,Ce.recurrenceInterval=void 0,Ce.recurrenceDays=void 0,Ce.monthlyRecurrenceType=void 0,Ce.recurrenceEndType="count",Ce.recurrenceCount=1,Ce.recurrenceEndDate=void 0):(Ce.frequency="recurring",Ce.time=void 0,e.recurrence||(Ce.recurrence="monthly"),Ce.recurrenceEndType="forever",Ce.recurrenceCount=void 0,Ce.recurrenceEndDate=void 0),r(Ce),y(!1),E(!1)},J=()=>{r({recurrence:oe,recurrenceInterval:Z||1,recurrenceDays:oe==="weekly"?q:void 0,monthlyRecurrenceType:oe==="monthly"?ie:void 0}),C(!1),N(!1)},G=I.useCallback(()=>{U(!1),R(!1),K.current=Date.now()},[]),_e=(ye,Ce)=>{ye.stopPropagation(),ye.preventDefault();const le=xc(Ce);setTimeout(()=>{G()},500),le.then(async ce=>{const{base64:Ee}=await Js(ce),Se=pe.current.receipts||[];r({receipts:[...Se,Ee]})}).catch(ce=>{})},F=ye=>{const le=(e.receipts||[]).filter((ce,Ee)=>Ee!==ye);r({receipts:le})},ke=I.useMemo(()=>{const ye=e.date;if(!ye)return"Seleziona una data di inizio valida";const Ce=Ff(ye);if(!Ce)return"Data non valida";const le=Ce.getUTCDate(),ce=Ce.getUTCDay(),Ee=Math.floor((le-1)/7);return`Ogni ${ag[Ee]} ${ng[ce]} del mese`},[e.date]),Fe=()=>{const ye=e.recurrenceEndType;return!ye||ye==="forever"?"Per sempre":ye==="date"?"Fino a...":ye==="count"?"Numero di volte":"Per sempre"},De=()=>ae?gc.createPortal(f.jsxs("div",{className:"fixed inset-0 z-[6000] bg-black/95 flex items-center justify-center p-4 animate-fade-in-up",onClick:()=>te(null),children:[f.jsx("button",{className:"absolute top-4 right-4 text-white/80 hover:text-white p-2 transition-colors z-50",onClick:()=>te(null),children:f.jsx(xr,{className:"w-8 h-8"})}),f.jsx("img",{src:`data:image/png;base64,${ae}`,className:"max-w-full max-h-full object-contain rounded-sm shadow-2xl",alt:"Ricevuta Full Screen",onClick:ye=>ye.stopPropagation()})]}),document.body):null;if(typeof e.amount!="number")return f.jsxs("div",{ref:h,tabIndex:-1,className:"flex flex-col h-full bg-slate-100 items-center justify-center p-4",...m,children:[f.jsxs("header",{className:"p-4 flex items-center gap-4 text-slate-800 bg-white shadow-sm absolute top-0 left-0 right-0 z-10",children:[!o&&f.jsx("button",{onClick:a,className:"p-2 rounded-full hover:bg-slate-200","aria-label":"Torna alla calcolatrice",children:f.jsx(Va,{className:"w-6 h-6"})}),f.jsx("h2",{className:"text-xl font-bold",children:"Aggiungi Dettagli"})]}),f.jsx("p",{className:"text-slate-500 text-center",children:"Nessun dato dall'importo. Torna indietro e inserisci una spesa."})]});const Ge=!!e.frequency,Ve=(st=t.find(ye=>ye.id===e.accountId))==null?void 0:st.name,tt=I.useMemo(()=>t.map(ye=>({value:ye.id,label:ye.name})),[t]),ft=I.useMemo(()=>f.jsxs("div",{className:`grid ${e.frequency?"grid-cols-1":"grid-cols-2"} gap-4`,children:[f.jsxs("div",{children:[f.jsx("label",{htmlFor:"date",className:`block text-base font-medium mb-1 ${c?"text-red-600":"text-slate-700"}`,children:Ae?"Data del Pagamento":e.frequency==="recurring"?"Data di inizio":"Data"}),f.jsxs("div",{className:"relative",children:[f.jsx("div",{className:"pointer-events-none absolute inset-y-0 left-0 flex items-center pl-3",children:f.jsx(Xu,{className:"h-5 w-5 text-slate-400"})}),f.jsx("input",{id:"date",name:"date",type:"date",value:e.date||"",onChange:ze,className:`block w-full rounded-md bg-white py-2.5 pl-10 pr-3 text-base text-slate-900 placeholder:text-slate-400 focus:outline-none ${c?"border-red-500 ring-1 ring-red-500":"border border-slate-300 focus:border-indigo-500 focus:ring-1 focus:ring-indigo-500"}`,enterKeyHint:"done",onKeyDown:ye=>{ye.key==="Enter"&&(ye.currentTarget.blur(),ye.preventDefault())},onFocus:ye=>ye.currentTarget.scrollIntoView({behavior:"smooth",block:"center"})})]}),c&&f.jsx("p",{className:"mt-1 text-sm text-red-600",children:"Per favore, imposta una data."})]}),!e.frequency&&f.jsxs("div",{children:[f.jsx("label",{htmlFor:"time",className:"block text-base font-medium text-slate-700 mb-1",children:"Ora"}),f.jsxs("div",{className:"relative",children:[f.jsx("div",{className:"pointer-events-none absolute inset-y-0 left-0 flex items-center pl-3",children:f.jsx(Bp,{className:"h-5 w-5 text-slate-400"})}),f.jsx("input",{id:"time",name:"time",type:"time",value:e.time||"",onChange:ze,className:"block w-full rounded-md border border-slate-300 bg-white py-2.5 pl-10 pr-3 text-base text-slate-900 placeholder:text-slate-400 focus:outline-none focus:border-indigo-500 focus:ring-1 focus:ring-indigo-500",enterKeyHint:"done",onKeyDown:ye=>{ye.key==="Enter"&&(ye.currentTarget.blur(),ye.preventDefault())},onFocus:ye=>ye.currentTarget.scrollIntoView({behavior:"smooth",block:"center"})})]})]})]}),[e.frequency,e.date,c,e.time,Ae]);return f.jsxs("div",{ref:h,tabIndex:-1,className:"flex flex-col h-full bg-slate-100 focus:outline-none",style:{touchAction:"pan-y"},...m,children:[f.jsxs("header",{className:"p-4 flex items-center justify-between gap-4 text-slate-800 bg-white shadow-sm sticky top-0 z-10",children:[f.jsxs("div",{className:"flex items-center gap-4",children:[!o&&f.jsx("button",{onClick:a,className:"p-2 rounded-full hover:bg-slate-200","aria-label":"Torna alla calcolatrice",children:f.jsx(Va,{className:"w-6 h-6"})}),f.jsx("h2",{className:"text-xl font-bold",children:"Aggiungi Dettagli"})]}),f.jsx("div",{className:"w-11 h-11"})]}),f.jsxs("main",{className:"flex-1 p-4 flex flex-col overflow-y-auto",style:{touchAction:"pan-y"},children:[f.jsxs("div",{className:"space-y-2",children:[f.jsx("div",{className:"flex justify-center items-center py-0",children:f.jsxs("div",{className:"relative flex items-baseline justify-center text-indigo-600",children:[f.jsx("span",{className:"text-[2.6rem] leading-none font-bold tracking-tighter relative z-10",children:Ba(e.amount||0).replace(/[^0-9,.]/g,"")}),f.jsx("span",{className:"text-3xl font-medium text-indigo-400 opacity-70 absolute",style:{right:"100%",marginRight:"8px",top:"4px"},children:""})]})}),f.jsxs("div",{children:[f.jsx("label",{htmlFor:"description",className:"block text-base font-medium text-slate-700 mb-1",children:"Descrizione"}),f.jsxs("div",{className:"relative",children:[f.jsx("div",{className:"pointer-events-none absolute inset-y-0 left-0 flex items-center pl-3",children:f.jsx(Cf,{className:"h-5 w-5 text-slate-400"})}),f.jsx("input",{ref:x,id:"description",name:"description",type:"text",value:e.description||"",onChange:ze,className:"block w-full rounded-md border border-slate-300 bg-white py-2.5 pl-10 pr-3 text-base text-slate-900 placeholder:text-slate-400 focus:outline-none focus:border-indigo-500 focus:ring-1 focus:ring-indigo-500",placeholder:"Es. Caff al bar",enterKeyHint:"done",onKeyDown:ye=>{ye.key==="Enter"&&(ye.currentTarget.blur(),ye.preventDefault())}})]})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block text-base font-medium text-slate-700 mb-1",children:"Conto"}),f.jsxs("button",{type:"button",onClick:()=>p("account"),className:"w-full flex items-center text-left gap-2 px-3 py-2.5 text-base rounded-lg border shadow-sm focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 transition-colors bg-white border-slate-300 text-slate-800 hover:bg-slate-50",children:[f.jsx(vc,{className:"h-5 w-5 text-slate-400"}),f.jsx("span",{className:"truncate flex-1",children:Ve||"Seleziona"}),f.jsx(En,{className:"w-5 h-5 text-slate-500"})]})]}),!Ge&&ft,f.jsxs("div",{children:[f.jsx("label",{className:"block text-base font-medium text-slate-700 mb-1",children:"Ricevuta"}),e.receipts&&e.receipts.length>0&&f.jsx("div",{className:"grid grid-cols-2 gap-2 mb-2",children:e.receipts.map((ye,Ce)=>f.jsxs("div",{className:"relative rounded-lg overflow-hidden border border-slate-200 shadow-sm aspect-video bg-slate-50 cursor-pointer hover:border-indigo-300 transition-colors",onClick:()=>te(ye),children:[f.jsx("img",{src:`data:image/png;base64,${ye}`,alt:"Ricevuta",className:"w-full h-full object-cover"}),f.jsx("button",{type:"button",onClick:le=>{le.stopPropagation(),F(Ce)},onPointerDown:le=>le.stopPropagation(),className:"absolute top-1 right-1 p-1.5 bg-white/90 text-red-600 rounded-full shadow-md hover:bg-red-50 hover:text-red-700 transition-colors z-10 flex items-center justify-center","aria-label":"Rimuovi ricevuta",children:f.jsx(xr,{className:"w-5 h-5"})})]},Ce))}),f.jsxs("button",{type:"button",onClick:()=>{Date.now()-K.current<500||U(!0)},className:"w-full flex items-center justify-center gap-2 px-3 py-2.5 text-base rounded-lg border border-dashed border-indigo-300 bg-indigo-50 text-indigo-600 hover:bg-indigo-100 hover:border-indigo-400 transition-colors focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500",children:[f.jsx(Up,{className:"w-5 h-5"}),f.jsx("span",{children:e.receipts&&e.receipts.length>0?"Aggiungi un'altra ricevuta":"Allega Ricevuta"})]})]}),f.jsxs("div",{className:"bg-white p-4 rounded-lg border border-slate-200 space-y-4",children:[f.jsxs("div",{children:[f.jsx("label",{className:"block text-base font-medium text-slate-700 mb-1",children:"Frequenza"}),f.jsxs("button",{type:"button",onClick:()=>y(!0),className:`w-full flex items-center justify-between text-left gap-2 px-3 py-2.5 text-base rounded-lg border shadow-sm focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 transition-colors ${Ge?"bg-white border-slate-300 text-slate-800 hover:bg-slate-50":"bg-slate-100 border-slate-200 text-slate-500 hover:bg-slate-200"}`,children:[f.jsx("span",{className:"truncate flex-1 capitalize",children:Ae?"Singolo":e.frequency==="recurring"?"Ricorrente":"Nessuna"}),f.jsx(En,{className:"w-5 h-5 text-slate-500"})]})]}),Ge&&ft,e.frequency==="recurring"&&!Ae&&f.jsxs("div",{children:[f.jsx("label",{className:"block text-base font-medium text-slate-700 mb-1",children:"Ricorrenza"}),f.jsxs("button",{type:"button",onClick:()=>C(!0),className:"w-full flex items-center justify-between text-left gap-2 px-3 py-2.5 text-base rounded-lg border shadow-sm focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 transition-colors bg-white border-slate-300 text-slate-800 hover:bg-slate-50",children:[f.jsx("span",{className:"truncate flex-1",children:vC(e)}),f.jsx(En,{className:"w-5 h-5 text-slate-500"})]})]})]})]}),f.jsx("div",{className:"mt-auto pt-6",children:f.jsx("button",{type:"button",onClick:()=>i(e),disabled:(e.amount??0)<=0,className:"w-full px-4 py-3 text-base font-semibold text-white bg-indigo-600 rounded-lg shadow-sm hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2 transition-colors disabled:bg-indigo-300 disabled:cursor-not-allowed disabled:active:scale-100",children:"Aggiungi Spesa"})})]}),f.jsx(Ln,{isOpen:w==="account",onClose:()=>p(null),title:"Seleziona un Conto",options:tt,selectedValue:e.accountId||"",onSelect:P}),f.jsx(Vl,{isOpen:v,isAnimating:T,onClose:()=>{y(!1),E(!1)},title:"Seleziona Frequenza",children:f.jsxs("div",{className:"p-4 space-y-2",children:[f.jsx("button",{onClick:()=>ee("none"),className:"w-full px-4 py-3 text-base font-semibold rounded-lg bg-slate-100 text-slate-800 hover:bg-indigo-100 hover:text-indigo-800",children:"Nessuna"}),f.jsx("button",{onClick:()=>ee("single"),className:"w-full px-4 py-3 text-base font-semibold rounded-lg bg-slate-100 text-slate-800 hover:bg-indigo-100 hover:text-indigo-800",children:"Singolo"}),f.jsx("button",{onClick:()=>ee("recurring"),className:"w-full px-4 py-3 text-base font-semibold rounded-lg bg-slate-100 text-slate-800 hover:bg-indigo-100 hover:text-indigo-800",children:"Ricorrente"})]})}),f.jsx(Vl,{isOpen:M,isAnimating:D,onClose:G,title:"Allega Ricevuta",children:f.jsxs("div",{className:"p-4 grid grid-cols-2 gap-4",children:[f.jsxs("button",{onClick:ye=>_e(ye,"camera"),className:"flex flex-col items-center justify-center gap-3 p-4 rounded-xl bg-slate-50 border border-slate-200 hover:bg-indigo-50 hover:border-indigo-200 transition-colors",children:[f.jsx("div",{className:"w-12 h-12 rounded-full bg-white flex items-center justify-center shadow-sm text-indigo-600",children:f.jsx(Af,{className:"w-7 h-7"})}),f.jsx("span",{className:"font-semibold text-slate-700",children:"Fotocamera"})]}),f.jsxs("button",{onClick:ye=>_e(ye,"gallery"),className:"flex flex-col items-center justify-center gap-3 p-4 rounded-xl bg-slate-50 border border-slate-200 hover:bg-indigo-50 hover:border-indigo-200 transition-colors",children:[f.jsx("div",{className:"w-12 h-12 rounded-full bg-white flex items-center justify-center shadow-sm text-purple-600",children:f.jsx(pc,{className:"w-7 h-7"})}),f.jsx("span",{className:"font-semibold text-slate-700",children:"Galleria"})]})]})}),f.jsxs(Vl,{isOpen:_,isAnimating:S,onClose:()=>{C(!1),N(!1)},title:"Imposta Ricorrenza",children:[f.jsxs("main",{className:"p-4 space-y-4",children:[f.jsxs("div",{className:"relative",children:[f.jsxs("button",{onClick:()=>{X(ye=>!ye),z(!1)},className:"w-full flex items-center justify-between text-left gap-2 px-3 py-2.5 text-base rounded-lg border shadow-sm focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 bg-white border-slate-300 text-slate-800 hover:bg-slate-50",children:[f.jsx("span",{className:"truncate flex-1 capitalize",children:Hl[oe||"monthly"]}),f.jsx(En,{className:`w-5 h-5 text-slate-500 transition-transform ${B?"rotate-180":""}`})]}),B&&f.jsx("div",{className:"absolute top-full mt-1 w-full bg-white border border-slate-200 shadow-lg rounded-lg z-20 p-2 space-y-1 animate-fade-in-down",children:Object.keys(Hl).map(ye=>f.jsx("button",{onClick:()=>{re(ye),X(!1)},className:"w-full text-left px-4 py-3 text-base font-semibold rounded-lg bg-slate-50 text-slate-800 hover:bg-indigo-100 hover:text-indigo-800",children:Hl[ye]},ye))})]}),f.jsx("div",{className:"pt-2",children:f.jsxs("div",{className:"flex items-center justify-center gap-2 bg-slate-100 p-3 rounded-lg",children:[f.jsx("span",{className:"text-base text-slate-700",children:"Ogni"}),f.jsx("input",{type:"number",value:Z||"",onChange:ye=>{const Ce=ye.target.value;if(Ce==="")ge(void 0);else{const le=parseInt(Ce,10);!isNaN(le)&&le>0&&ge(le)}},onFocus:ye=>ye.currentTarget.select(),className:"w-12 text-center text-lg font-bold text-slate-800 bg-transparent border-0 border-b-2 border-slate-400 focus:ring-0 focus:outline-none focus:border-indigo-600 p-0",min:1}),f.jsx("span",{className:"text-base text-slate-700",children:wC(oe,Z)})]})}),oe==="weekly"&&f.jsx("div",{className:"pt-2",children:f.jsx("div",{className:"flex flex-wrap justify-center gap-2",children:gC.map(ye=>f.jsx("button",{onClick:()=>{Q(Ce=>{const le=Ce||[];return(le.includes(ye.value)?le.filter(Ee=>Ee!==ye.value):[...le,ye.value]).sort((Ee,Se)=>(Ee===0?7:Ee)-(Se===0?7:Se))})},className:`w-14 h-14 rounded-full text-sm font-semibold border-2 transition-colors ${(q||[]).includes(ye.value)?"bg-indigo-600 text-white border-indigo-600":"bg-white text-slate-800 border-indigo-400 hover:bg-indigo-50"}`,children:ye.label},ye.value))})}),oe==="monthly"&&f.jsxs("div",{className:"pt-4 space-y-2 border-t border-slate-200",children:[f.jsxs("div",{role:"radio","aria-checked":ie==="dayOfMonth",onClick:()=>ve("dayOfMonth"),className:"flex items-center gap-3 p-2 cursor-pointer rounded-lg hover:bg-slate-100",children:[f.jsx("div",{className:"w-5 h-5 rounded-full border-2 border-slate-400 flex items-center justify-center flex-shrink-0",children:ie==="dayOfMonth"&&f.jsx("div",{className:"w-2.5 h-2.5 bg-indigo-600 rounded-full"})}),f.jsx("span",{className:"text-sm font-medium text-slate-700",children:"Lo stesso giorno di ogni mese"})]}),f.jsxs("div",{role:"radio","aria-checked":ie==="dayOfWeek",onClick:()=>ve("dayOfWeek"),className:"flex items-center gap-3 p-2 cursor-pointer rounded-lg hover:bg-slate-100",children:[f.jsx("div",{className:"w-5 h-5 rounded-full border-2 border-slate-400 flex items-center justify-center flex-shrink-0",children:ie==="dayOfWeek"&&f.jsx("div",{className:"w-2.5 h-2.5 bg-indigo-600 rounded-full"})}),f.jsx("span",{className:"text-sm font-medium text-slate-700",children:ke})]})]}),f.jsx("div",{className:"pt-4 border-t border-slate-200",children:f.jsxs("div",{className:"grid grid-cols-2 gap-4 items-end",children:[f.jsxs("div",{className:`relative ${!e.recurrenceEndType||e.recurrenceEndType==="forever"?"col-span-2":""}`,children:[f.jsxs("button",{type:"button",onClick:()=>{z(ye=>!ye),X(!1)},className:"w-full flex items-center justify-between text-left gap-2 px-3 py-2.5 text-base rounded-lg border shadow-sm focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 bg-white border-slate-300 text-slate-800 hover:bg-slate-50",children:[f.jsx("span",{className:"truncate flex-1 capitalize",children:Fe()}),f.jsx(En,{className:`w-5 h-5 text-slate-500 transition-transform ${j?"rotate-180":""}`})]}),j&&f.jsx("div",{className:"absolute top-full mt-1 w-full bg-white border border-slate-200 shadow-lg rounded-lg z-20 p-2 space-y-1 animate-fade-in-down",children:["forever","date","count"].map(ye=>f.jsx("button",{onClick:()=>{ye==="forever"&&r({recurrenceEndType:"forever",recurrenceEndDate:void 0,recurrenceCount:void 0}),ye==="date"&&r({recurrenceEndType:"date",recurrenceEndDate:e.recurrenceEndDate||Xx(new Date),recurrenceCount:void 0}),ye==="count"&&r({recurrenceEndType:"count",recurrenceCount:e.recurrenceCount||1,recurrenceEndDate:void 0}),z(!1)},className:"w-full text-left px-4 py-3 text-base font-semibold rounded-lg bg-slate-50 text-slate-800 hover:bg-indigo-100 hover:text-indigo-800",children:ye==="forever"?"Per sempre":ye==="date"?"Fino a...":"Numero di volte"},ye))})]}),e.recurrenceEndType==="date"&&f.jsxs("div",{children:[f.jsx("label",{htmlFor:"recurrence-end-date",className:"block text-sm font-medium text-slate-700 mb-1",children:"Data fine"}),f.jsx("input",{id:"recurrence-end-date",name:"recurrenceEndDate",type:"date",value:e.recurrenceEndDate||"",onChange:ze,className:"block w-full rounded-md border border-slate-300 bg-white py-2.5 px-3 text-base text-slate-900 placeholder:text-slate-400 focus:outline-none focus:border-indigo-500 focus:ring-1 focus:ring-indigo-500",enterKeyHint:"done",onKeyDown:ye=>{ye.key==="Enter"&&(ye.currentTarget.blur(),ye.preventDefault())}})]}),e.recurrenceEndType==="count"&&f.jsxs("div",{children:[f.jsx("label",{htmlFor:"recurrence-count",className:"block text-sm font-medium text-slate-700 mb-1",children:"N. volte"}),f.jsx("input",{id:"recurrence-count",name:"recurrenceCount",type:"number",value:e.recurrenceCount||"",onChange:ze,className:"block w-full rounded-md border border-slate-300 bg-white py-2.5 px-3 text-base text-slate-900 placeholder:text-slate-400 focus:outline-none focus:border-indigo-500 focus:ring-1 focus:ring-indigo-500",min:1,enterKeyHint:"done",onKeyDown:ye=>{ye.key==="Enter"&&(ye.currentTarget.blur(),ye.preventDefault())}})]})]})})]}),f.jsx("footer",{className:"p-4 bg-slate-100 border-t border-slate-200 flex justify-end",children:f.jsx("button",{type:"button",onClick:J,className:"px-4 py-2 text-sm font-semibold text-white bg-indigo-600 rounded-lg shadow-sm hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2",children:"Applica"})})]}),De()]})};function kC(e,r,t={}){const{enabled:a=!0,slop:i=10,threshold:o=80,ignoreSelector:u,disableDrag:c}=t,[h,x]=I.useState(0),[m,w]=I.useState(!1),p=I.useRef({pointerId:null,startX:0,startY:0,isSwiping:!1,dir:null,blockedByIgnore:!1,blockedByDisable:!1}),v=I.useCallback(()=>{const y=p.current;y.pointerId=null,y.startX=0,y.startY=0,y.isSwiping=!1,y.dir=null,y.blockedByIgnore=!1,y.blockedByDisable=!1,x(0),w(!1)},[]);return I.useEffect(()=>{const y=e.current;if(!y)return;if(!a){v();return}const T=S=>{if(!a)return;const N=p.current;if(N.pointerId!==null)return;const B=S.target;if(u&&B&&B.closest(u)){N.pointerId=S.pointerId,N.blockedByIgnore=!0,N.blockedByDisable=!1,N.isSwiping=!1,N.dir=null;return}N.pointerId=S.pointerId,N.startX=S.clientX,N.startY=S.clientY,N.isSwiping=!1,N.dir=null,N.blockedByIgnore=!1,N.blockedByDisable=!1},E=S=>{var z;const N=p.current;if(N.pointerId!==S.pointerId||N.blockedByIgnore||N.blockedByDisable||!a)return;const B=S.clientX-N.startX,X=S.clientY-N.startY;if(!N.isSwiping){if(Math.hypot(B,X)<i)return;if(Math.abs(X)>Math.abs(B)*2){v();return}const U=B<0?"left":"right";if(c&&c(U)){N.blockedByDisable=!0,v();return}N.isSwiping=!0,N.dir=U,w(!0)}if(!N.isSwiping)return;const j=((z=e.current)==null?void 0:z.offsetWidth)||window.innerWidth;if(j>0){const U=(S.clientX-N.startX)/j;x(U)}},_=S=>{const N=p.current;if(N.pointerId!==S.pointerId)return;if(N.isSwiping&&!N.blockedByIgnore&&!N.blockedByDisable){const X=S.clientX-N.startX;Math.abs(X)>=o&&(X<0&&r.onSwipeLeft?r.onSwipeLeft():X>0&&r.onSwipeRight&&r.onSwipeRight())}v()},C=S=>{p.current.pointerId===S.pointerId&&v()};return y.addEventListener("pointerdown",T,{passive:!0}),y.addEventListener("pointermove",E,{passive:!0}),y.addEventListener("pointerup",_,{passive:!0}),y.addEventListener("pointercancel",C,{passive:!0}),()=>{y.removeEventListener("pointerdown",T),y.removeEventListener("pointermove",E),y.removeEventListener("pointerup",_),y.removeEventListener("pointercancel",C)}},[e,a,i,o,u,c,r.onSwipeLeft,r.onSwipeRight,v]),{progress:h,isSwiping:m}}const EC=e=>{const[r,t]=I.useState(()=>typeof window<"u"?window.matchMedia(e).matches:!1);return I.useEffect(()=>{const a=window.matchMedia(e),i=()=>t(a.matches);return a.addEventListener("change",i),()=>a.removeEventListener("change",i)},[e]),r},_C=e=>{const r=e.getUTCFullYear(),t=String(e.getUTCMonth()+1).padStart(2,"0"),a=String(e.getUTCDate()).padStart(2,"0");return`${r}-${t}-${a}`},TC=()=>new Date().toLocaleTimeString("it-IT",{hour:"2-digit",minute:"2-digit",timeZone:"UTC"}),SC=({isOpen:e,onClose:r,onSubmit:t,accounts:a,onMenuStateChange:i=o=>{}})=>{const[o,u]=I.useState(!1),[c,h]=I.useState("calculator"),[x,m]=I.useState(!1),[w,p]=I.useState(!1),[v,y]=I.useState(!1),[T,E]=I.useState(!1),_=I.useRef(!1),[C,S]=I.useState(!1),[N,B]=I.useState(!1),X=I.useRef([]),j=ni(),z=I.useCallback(ve=>(X.current.push(ve),ve),[]),M=I.useCallback(()=>{var ve;return{amount:0,description:"",date:_C(new Date),time:TC(),accountId:((ve=a[0])==null?void 0:ve.id)||"",category:"",subcategory:void 0,frequency:void 0,recurrence:void 0,monthlyRecurrenceType:"dayOfMonth",recurrenceInterval:void 0,recurrenceDays:void 0,recurrenceEndType:"forever",recurrenceEndDate:void 0,recurrenceCount:void 0}},[a]),[U,D]=I.useState(M),R=EC("(min-width: 768px)");I.useEffect(()=>{const ve=window.visualViewport;if(!ve||!e)return;m(!1);const pe=()=>{const Ae=window.innerHeight-ve.height>120;m(Ae)};return ve.addEventListener("resize",pe),()=>ve.removeEventListener("resize",pe)},[e]),I.useEffect(()=>{if(e){D(M()),y(!1),E(!1),_.current=!1,h("calculator"),S(!1),B(!1);const ve=z(window.setTimeout(()=>u(!0),10)),pe=z(window.setTimeout(()=>S(!0),50)),Ae=z(window.setTimeout(()=>B(!0),300));return()=>{clearTimeout(ve),clearTimeout(pe),clearTimeout(Ae)}}else{u(!1),S(!1),B(!1);const ve=z(window.setTimeout(()=>{D(M()),y(!1),E(!1),_.current=!1},300));return()=>clearTimeout(ve)}},[e,M,z]),I.useEffect(()=>{if(!e)return;const ve=pe=>{if(c==="details"){const Ae=pe.state;(!Ae||Ae.modal!=="calculator_details")&&h("calculator")}};return window.addEventListener("popstate",ve),()=>window.removeEventListener("popstate",ve)},[e,c]),I.useEffect(()=>()=>X.current.forEach(clearTimeout),[]);const K=I.useRef(null),ae=I.useCallback(ve=>{var pe,Ae;if(c!==ve){if((Ae=(pe=document.activeElement)==null?void 0:pe.blur)==null||Ae.call(pe),ve==="details")window.history.pushState({modal:"calculator_details"},"");else if(ve==="calculator"&&c==="details"){window.history.back();return}h(ve),window.dispatchEvent(new CustomEvent("page-activated",{detail:ve})),setTimeout(()=>{const je=window.visualViewport,ze=Date.now(),P=()=>{!je||Date.now()-ze>200||requestAnimationFrame(P)};P()},0)}},[c]),{progress:te,isSwiping:oe}=kC(K,{onSwipeLeft:c==="calculator"?()=>ae("details"):void 0,onSwipeRight:c==="details"?()=>ae("calculator"):void 0},{enabled:C&&!R&&e&&!w&&!x,threshold:36,slop:10});I.useEffect(()=>{i(w||x)},[w,x,i]);const re=I.useCallback(ve=>{"date"in ve&&ve.date&&y(!1),D(pe=>({...pe,...ve}))},[]),Z=I.useCallback(ve=>{if(!_.current){if(!ve.date){ae("details"),y(!0),z(window.setTimeout(()=>{var pe;return(pe=document.getElementById("date"))==null?void 0:pe.focus()},150));return}_.current=!0,E(!0),y(!1),c==="details"&&window.history.back(),t(ve)}},[c,ae,t,z]);if(!e)return null;const ge=c==="calculator"?0:-50,q=te*50,Q=ge+q,ie=R?{}:{transform:`translateX(${Q}%)`,transition:oe||!N?"none":"transform 0.25s ease-out",willChange:"transform"};return f.jsx("div",{className:`fixed inset-0 z-[5000] bg-slate-100 transform transition-transform duration-300 ease-in-out ${o?"translate-y-0":"translate-y-full"}`,"aria-modal":"true",role:"dialog",style:{touchAction:"pan-y"},...j,children:f.jsx("div",{ref:K,className:"relative h-full w-full overflow-hidden",style:{touchAction:"pan-y"},children:f.jsxs("div",{className:"absolute inset-0 flex w-[200%] md:w-full md:grid md:grid-cols-2",style:ie,children:[f.jsx("div",{className:`w-1/2 md:w-auto h-full relative overflow-hidden ${c==="calculator"?"z-10":"z-0"}`,"aria-hidden":!R&&c!=="calculator",children:f.jsx(rg,{formData:U,onFormChange:re,onClose:r,onSubmit:Z,accounts:a,onNavigateToDetails:()=>ae("details"),onMenuStateChange:p,isDesktop:R})}),f.jsx("div",{className:`w-1/2 md:w-auto h-full relative overflow-hidden ${c==="details"?"z-10":"z-0"}`,"aria-hidden":!R&&c!=="details",children:f.jsx(yC,{formData:U,onFormChange:re,accounts:a,onClose:()=>ae("calculator"),onSubmit:Z,isDesktop:R,onMenuStateChange:p,dateError:v})})]})})})},CC=({show:e})=>f.jsx("div",{role:"status","aria-live":"polite",className:`fixed flex items-center justify-center w-12 h-12 bg-green-400 text-white rounded-full shadow-lg z-30
        ${e?"opacity-100 scale-100":"opacity-0 scale-90 pointer-events-none"}`,style:{bottom:"calc(2rem + env(safe-area-inset-bottom, 0px))",right:"calc(6.5rem + env(safe-area-inset-right, 0px))",transition:"transform 0.25s cubic-bezier(0.22, 0.61, 0.36, 1), opacity 0.25s ease-in-out, transform 0.25s ease-in-out"},children:f.jsx(Yn,{className:"w-10 h-10"})}),bC=({onLogout:e,currentEmail:r})=>{const[t,a]=Wi("expenses_v2",[]),[i,o]=Wi("recurring_expenses_v1",[]),[u,c]=Wi("accounts_v1",_2),h=u||[],[x,m]=I.useState(!1),[w,p]=I.useState(!1),[v,y]=I.useState(!1),[T,E]=I.useState(!1),[_,C]=I.useState(!1),[S,N]=I.useState(!1),[B,X]=I.useState(!1),[j,z]=I.useState(!1),[M,U]=I.useState(!1),[D,R]=I.useState(!1),[K,ae]=I.useState(!1),[te,oe]=I.useState(!1),[re,Z]=I.useState(!1),[ge,q]=I.useState(void 0),[Q,ie]=I.useState(void 0),[ve,pe]=I.useState(void 0),[Ae,je]=I.useState(null),[ze,P]=I.useState([]),[ee,J]=I.useState(null),G=l2(),[_e,F]=I.useState([]),[ke,Fe]=I.useState(null),[De,Ge]=I.useState(null),Ve=I.useCallback(be=>Ge(be),[]),[tt,ft]=I.useState(!1),[st,ye]=I.useState(null),Ce=I.useRef(0),le=I.useRef(null),ce=I.useRef(new URLSearchParams(window.location.search).get("shared")==="true"),Ee=I.useRef(0),Se=()=>{const be={expenses:t,recurringExpenses:i,accounts:u,exportDate:new Date().toISOString(),version:"1.0"},Ye=new Blob([JSON.stringify(be,null,2)],{type:"application/json"}),Xe=URL.createObjectURL(Ye),ct=document.createElement("a");ct.href=Xe,ct.download=`backup_spese_${new Date().toISOString().slice(0,10)}.json`,document.body.appendChild(ct),ct.click(),document.body.removeChild(ct),URL.revokeObjectURL(Xe),Ve({message:"Backup JSON scaricato!",type:"success"})},Re=be=>{const Ye=new FileReader;Ye.onload=Xe=>{var ct;try{const At=JSON.parse((ct=Xe.target)==null?void 0:ct.result);At.expenses&&a(At.expenses),At.recurringExpenses&&o(At.recurringExpenses),At.accounts&&c(At.accounts),Ve({message:"Backup JSON ripristinato!",type:"success"}),setTimeout(()=>window.location.reload(),1500)}catch{Ve({message:"Errore file JSON",type:"error"})}},Ye.readAsText(be)},at=I.useCallback(async()=>{try{const be=await iu();F(be||[]),Ce.current=(be||[]).length}catch{F([])}},[]),it=(be,Ye)=>{if(!be)return{};let Xe=be.category||"Altro";nn[Xe]||(Xe="Altro");let ct=be.amount;return typeof ct=="string"&&(ct=parseFloat(ct.replace(",","."))),(typeof ct!="number"||isNaN(ct))&&(ct=0),{description:be.description||"",amount:ct,category:Xe,date:be.date||new Date().toISOString().split("T")[0],tags:Array.isArray(be.tags)?be.tags:[],receipts:Array.isArray(be.receipts)?be.receipts:Ye?[Ye]:[],accountId:be.accountId||(h.length>0?h[0].id:"")}},Ne=async be=>{try{Ve({message:"Elaborazione immagine...",type:"info"});const{base64:Ye,mimeType:Xe}=await Js(be),ct={id:crypto.randomUUID(),base64Image:Ye,mimeType:Xe,timestamp:Date.now()};G?J(ct):(await Nl(ct),at(),Ve({message:"Salvata in coda.",type:"info"}))}catch{Ve({message:"Errore file.",type:"error"})}},Ke=async be=>{try{Ve({message:"Elaborazione file...",type:"info"});const{processFileToImage:Ye}=await Vi(async()=>{const{processFileToImage:mr}=await Promise.resolve().then(()=>BT);return{processFileToImage:mr}},void 0),{base64:Xe,mimeType:ct}=await Ye(be),At={id:crypto.randomUUID(),base64Image:Xe,mimeType:ct,timestamp:Date.now()};G?J(At):(await Nl(At),at(),Ve({message:"File salvato.",type:"info"}))}catch{Ve({message:"Errore importazione.",type:"error"})}},mt=async be=>{try{window.history.replaceState({modal:"home"},"")}catch{}y(!1),sessionStorage.setItem("preventAutoLock","true");try{const Ye=await xc(be),{base64:Xe,mimeType:ct}=await Js(Ye),At={id:crypto.randomUUID(),base64Image:Xe,mimeType:ct,timestamp:Date.now()};G?J(At):(await Nl(At),at())}catch{}finally{setTimeout(()=>sessionStorage.removeItem("preventAutoLock"),2e3)}},Nt=async be=>{if(!G){Ve({message:"Serve internet.",type:"error"});return}Fe(be.id),X(!0);try{const{parseExpensesFromImage:Ye}=await Vi(async()=>{const{parseExpensesFromImage:ct}=await Promise.resolve().then(()=>NS);return{parseExpensesFromImage:ct}},void 0),Xe=await Ye(be.base64Image,be.mimeType);(Xe==null?void 0:Xe.length)===1?(pe(it(Xe[0],be.base64Image)),window.history.replaceState({modal:"form"},""),m(!0)):(Xe==null?void 0:Xe.length)>1?(P(Xe.map(ct=>it(ct,void 0))),window.history.replaceState({modal:"multiple"},""),N(!0)):Ve({message:"Nessuna spesa trovata.",type:"info"}),await E1(be.id),at()}catch{Ve({message:"Errore analisi.",type:"error"})}finally{X(!1),Fe(null)}},Er=be=>{try{window.history.replaceState({modal:"form"},"")}catch{}E(!1);const Ye=it(be);pe(Ye),m(!0)};I.useEffect(()=>{if(!r||!G)return;const be=setTimeout(()=>{const Xe=ko()[r.toLowerCase()];Xe&&zT(r,{expenses:t,recurringExpenses:i,accounts:u},Xe.pinHash,Xe.pinSalt).then(ct=>{ct&&console.log("Backup OK")}).catch(ct=>console.warn("Cloud error",ct))},5e3);return()=>clearTimeout(be)},[t,i,u,r,G]),I.useEffect(()=>{ce.current||at()},[at]),I.useEffect(()=>{(async()=>{if(new URLSearchParams(window.location.search).get("shared")==="true"||ce.current){try{window.history.replaceState({modal:"home"},"",window.location.pathname)}catch{}try{const Xe=await iu(),ct=Array.isArray(Xe)?Xe:[];if(ct.length>0){ct.sort((Kn,bn)=>(bn.timestamp||0)-(Kn.timestamp||0));const At=ct[0];le.current=At.id;const mr={...At,_isShared:!0};J(mr),F(ct.filter(Kn=>Kn.id!==At.id))}}catch{}}})()},[]);const _r=I.useRef(!1);I.useEffect(()=>{_r.current||(_r.current=!0)},[]),I.useEffect(()=>{var Ye;(Ye=window.history.state)!=null&&Ye.modal||(window.history.replaceState({modal:"exit_guard"},""),window.history.pushState({modal:"home"},"")),new URLSearchParams(window.location.search).get("install")==="true"&&setTimeout(()=>oe(!0),500)},[]),I.useEffect(()=>{const be=Ye=>{Ye.preventDefault(),ye(Ye)};return window.addEventListener("beforeinstallprompt",be),()=>window.removeEventListener("beforeinstallprompt",be)},[]);const ln=()=>{st?(st.prompt(),st.userChoice.then(be=>ye(null))):oe(!0)},Un=()=>{m(!1),p(!1),y(!1),E(!1),N(!1),ae(!1),U(!1),Z(!1),z(!1),J(null)},Br=()=>{try{window.history.replaceState({modal:"home"},"",window.location.pathname)}catch{}window.dispatchEvent(new PopStateEvent("popstate",{state:{modal:"home"}}))},sr=()=>{var be,Ye;((be=window.history.state)==null?void 0:be.modal)==="history"&&(U(!1),R(!1)),(Ye=window.history.state)!=null&&Ye.modal&&window.history.state.modal!=="home"&&window.history.state.modal!=="exit_guard"?window.history.back():Br()};I.useEffect(()=>{const be=Ye=>{var ct;const Xe=(ct=Ye.state)==null?void 0:ct.modal;if(Xe==="exit_guard"){const At=Date.now();if(At-Ee.current<2e3){window.history.back();return}else Ee.current=At,Ve({message:"Premi di nuovo indietro per uscire",type:"info"}),window.history.pushState({modal:"home"},""),Un();return}Xe!=="form"&&m(!1),Xe!=="voice"&&E(!1),Xe!=="source"&&y(!1),Xe!=="multiple"&&N(!1),Xe!=="qr"&&ae(!1),Xe!=="calculator"&&Xe!=="calculator_details"&&p(!1),!Xe||Xe==="home"?(U(!1),R(!1),Z(!1),z(!1),J(null)):Xe==="history"?(U(!0),D&&R(!1),z(!1)):Xe==="recurring"&&(z(!0),U(!1))};return window.addEventListener("popstate",be),()=>window.removeEventListener("popstate",be)},[Ve,D]);const Ur=be=>{if("id"in be)a(Ye=>Ye.map(Xe=>Xe.id===be.id?be:Xe)),o(Ye=>Ye.map(Xe=>Xe.id===be.id?be:Xe));else{const Ye={...be,id:crypto.randomUUID()};be.frequency==="recurring"?o(Xe=>[Ye,...Xe]):a(Xe=>[Ye,...Xe])}ft(!0),setTimeout(()=>ft(!1),2e3),x&&(M||j)?sr():Br()},cn=be=>{je(be),C(!0)},un=()=>{a(be=>be.filter(Ye=>Ye.id!==Ae)),je(null),C(!1),Ve({message:"Spesa eliminata.",type:"info"})},Ie=async()=>{ee&&(ee.id===le.current&&(le.current=null),Nt(ee),J(null))},$e=async()=>{if(!ee)return;let be=!!ee._isShared||le.current===ee.id;be||(be=(await iu()).some(Xe=>Xe.id===ee.id)),be||await Nl(ee),ee.id===le.current&&(le.current=null),at(),J(null)},ut=M&&!D?{bottom:"calc(90px + env(safe-area-inset-bottom, 0px))"}:void 0;return f.jsxs("div",{className:"h-full w-full bg-slate-100 flex flex-col font-sans",style:{touchAction:"pan-y"},children:[f.jsx("div",{className:"flex-shrink-0 z-20",children:f.jsx(qT,{pendingSyncs:_e.length,isOnline:G,onInstallClick:ln,installPromptEvent:st,onLogout:e,onShowQr:()=>{window.history.pushState({modal:"qr"},""),ae(!0)}})}),f.jsx("main",{className:"flex-grow bg-slate-100",children:f.jsxs("div",{className:"w-full h-full overflow-y-auto space-y-6",style:{touchAction:"pan-y"},children:[f.jsx(fS,{expenses:t||[],recurringExpenses:i||[],onNavigateToRecurring:()=>{window.history.pushState({modal:"recurring"},""),z(!0)},onNavigateToHistory:()=>{window.history.pushState({modal:"history"},""),R(!1),U(!0)},onReceiveSharedFile:Ne,onImportFile:Ke,onExportJSON:Se,onImportJSON:Re}),f.jsx(RS,{images:_e,onAnalyze:Nt,onDelete:async be=>{await E1(be),at()},isOnline:G,syncingImageId:ke})]})}),!w&&!re&&f.jsx(_S,{onAddManually:()=>{window.history.pushState({modal:"calculator"},""),p(!0)},onAddFromImage:()=>{window.history.pushState({modal:"source"},""),y(!0)},onAddFromVoice:()=>{window.history.pushState({modal:"voice"},""),E(!0)},style:ut}),f.jsx(CC,{show:tt}),f.jsx(SC,{isOpen:w,onClose:sr,onSubmit:Ur,accounts:h,expenses:t,onEditExpense:be=>{q(be),window.history.pushState({modal:"form"},""),m(!0)},onDeleteExpense:be=>{je(be),C(!0)},onMenuStateChange:()=>{}}),f.jsx(yS,{isOpen:x,onClose:sr,onSubmit:Ur,initialData:ge||Q,prefilledData:ve,accounts:h,isForRecurringTemplate:!!Q}),v&&f.jsx("div",{className:"fixed inset-0 z-[5200] flex justify-center items-center p-4 bg-slate-900/60 backdrop-blur-sm",onClick:sr,children:f.jsx("div",{className:"bg-slate-50 rounded-lg shadow-xl w-full max-w-lg",onClick:be=>be.stopPropagation(),children:f.jsxs("div",{className:"p-6 grid grid-cols-1 md:grid-cols-2 gap-4",children:[f.jsx(Fx,{icon:f.jsx(Af,{className:"w-8 h-8"}),title:"Scatta Foto",description:"Usa la fotocamera.",onClick:()=>mt("camera")}),f.jsx(Fx,{icon:f.jsx(hC,{className:"w-8 h-8"}),title:"Galleria",description:"Carica da file.",onClick:()=>mt("gallery")})]})})}),f.jsx(AS,{isOpen:T,onClose:sr,onParsed:Er}),f.jsx(ei,{isOpen:_,onClose:()=>C(!1),onConfirm:un,title:"Conferma Eliminazione",message:"Azione irreversibile.",variant:"danger"}),f.jsx(ei,{isOpen:!!ee,onClose:$e,onConfirm:Ie,title:"Analizza Immagine",message:"Vuoi analizzare subito questa immagine?",confirmButtonText:"S, analizza",cancelButtonText:"No, in coda"}),f.jsx(DS,{isOpen:S,onClose:sr,expenses:ze,accounts:h,onConfirm:be=>{be.forEach(Ur),Br()}}),M&&f.jsx(XS,{expenses:t,accounts:h,onClose:sr,onCloseStart:()=>R(!0),onEditExpense:be=>{q(be),window.history.pushState({modal:"form"},""),m(!0)},onDeleteExpense:cn,onDeleteExpenses:be=>a(Ye=>Ye.filter(Xe=>!be.includes(Xe.id))),isEditingOrDeleting:x||_,isOverlayed:!1,onDateModalStateChange:()=>{},onFilterPanelOpenStateChange:Z}),j&&f.jsx(qS,{recurringExpenses:i,expenses:t,accounts:h,onClose:sr,onEdit:be=>{ie(be),window.history.pushState({modal:"form"},""),m(!0)},onDelete:be=>o(Ye=>Ye.filter(Xe=>Xe.id!==be)),onDeleteRecurringExpenses:be=>o(Ye=>Ye.filter(Xe=>!be.includes(Xe.id)))}),f.jsx(cC,{isOpen:K,onClose:sr}),f.jsx(dC,{isOpen:te,onClose:()=>oe(!1)}),De&&f.jsx(OS,{message:De.message,type:De.type,onClose:()=>Ge(null)}),B&&f.jsx("div",{className:"fixed inset-0 bg-white/80 z-[100] flex items-center justify-center",children:f.jsx(ti,{className:"w-12 h-12 text-indigo-600"})})]})},NC=e=>f.jsx("img",{src:"/gestore/logo.png",alt:"Gestore Spese Logo",...e}),AC=()=>{Tn.useEffect(()=>{var r;const e=()=>{var a;const t=(((a=window.visualViewport)==null?void 0:a.height)??window.innerHeight)*.01;document.documentElement.style.setProperty("--vh",`${t}px`)};return e(),addEventListener("resize",e),addEventListener("orientationchange",e),(r=window.visualViewport)==null||r.addEventListener("resize",e),()=>{var t;removeEventListener("resize",e),removeEventListener("orientationchange",e),(t=window.visualViewport)==null||t.removeEventListener("resize",e)}},[])},FC=()=>{const[e,r]=Tn.useState(!1);return Tn.useEffect(()=>{let t=typeof window.__FORCE_STUDIO__=="boolean"&&window.__FORCE_STUDIO__||new URLSearchParams(location.search).has("studio"),a=!1;try{a=window.self!==window.top}catch{a=!0}r(t||a)},[]),e},IC=({children:e})=>f.jsx("div",{style:{background:"#fff",padding:24,borderRadius:16,boxShadow:"0 12px 28px rgba(0,0,0,0.12)",position:"relative",overflow:"visible",opacity:1},children:e}),DC=()=>f.jsxs("div",{style:{textAlign:"center"},children:[f.jsx("div",{style:{margin:"0 auto 12px",width:120,height:120},children:f.jsx(NC,{style:{width:"100%",height:"100%"},"aria-label":"Logo Gestore Spese"})}),f.jsx("h1",{style:{fontSize:28,fontWeight:800,color:"#0f172a",margin:0},children:"Gestore Spese"})]}),wc=({children:e})=>{AC();const r=FC(),t={minHeight:"calc(var(--vh, 1vh) * 100)",height:"100dvh",background:"#f1f5f9",fontFamily:"system-ui, -apple-system, Segoe UI, Roboto, Ubuntu, Cantarell, Noto Sans, sans-serif",WebkitTapHighlightColor:"transparent",display:"flex",flexDirection:"column",padding:16,overflow:"auto"};return r&&(t.position="fixed",t.inset=0),f.jsx("div",{style:t,children:f.jsx("div",{style:{display:"flex",flex:1,alignItems:"center",justifyContent:"center",overflow:"visible",position:"relative"},children:f.jsxs("div",{style:{width:"100%",maxWidth:480},children:[f.jsx("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",marginBottom:32},children:f.jsx(DC,{})}),f.jsx(IC,{children:e})]})})})},sg=e=>f.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",...e,children:[f.jsx("path",{d:"M8.10008 21.221C6.71021 19.2375 5.89258 16.8243 5.89258 14.2187C5.89258 10.8443 8.6265 8.10938 11.9989 8.10938C15.3712 8.10938 18.1051 10.8443 18.1051 14.2187",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}),f.jsx("path",{d:"M18.4359 20.3118C18.3259 20.3179 18.218 20.3281 18.107 20.3281C14.7347 20.3281 12.0007 17.5931 12.0007 14.2188",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}),f.jsx("path",{d:"M13.2694 21.9999C10.675 20.382 8.94705 17.5024 8.94705 14.2187C8.94705 12.5315 10.3145 11.164 12.0007 11.164C13.6869 11.164 15.0543 12.5315 15.0543 14.2187C15.0543 15.9059 16.4218 17.2733 18.108 17.2733C19.7942 17.2733 21.1616 15.9059 21.1616 14.2187C21.1616 9.1571 17.0602 5.05469 12.0017 5.05469C6.94319 5.05469 2.8418 9.1571 2.8418 14.2187C2.8418 15.3469 2.96806 16.4455 3.20021 17.5045",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}),f.jsx("path",{d:"M20.5257 5.86313C18.4435 3.4978 15.399 2 12.0002 2C8.60136 2 5.55687 3.4978 3.47461 5.86313",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})]}),ig=({pin:e,onPinChange:r,pinLength:t=4,onBiometric:a,showBiometric:i})=>{const o=x=>{e.length<t&&r(e+x)},u=()=>{e.length>0&&r(e.slice(0,-1))},c=()=>f.jsx("div",{className:"flex justify-center space-x-4 mb-6",children:Array.from({length:t}).map((x,m)=>f.jsx("div",{className:`w-4 h-4 rounded-full border-2 transition-colors duration-200 ${m<e.length?"bg-indigo-600 border-indigo-600":"bg-white border-slate-300"}`},m))}),h=()=>{const x=["1","2","3","4","5","6","7","8","9","biometric","0","backspace"];return f.jsx("div",{className:"grid grid-cols-3 gap-4",children:x.map((m,w)=>m==="biometric"?i&&a?f.jsx("button",{type:"button",onClick:a,className:"w-16 h-16 mx-auto rounded-full text-white bg-indigo-600 active:bg-indigo-700 transition-colors flex justify-center items-center shadow-md focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2","aria-label":"Usa impronta digitale",children:f.jsx(sg,{className:"w-8 h-8"})},w):f.jsx("div",{},w):m==="backspace"?f.jsx("button",{type:"button",onClick:u,className:"w-16 h-16 mx-auto rounded-full text-slate-700 active:bg-slate-200 transition-colors flex justify-center items-center text-2xl font-semibold focus:outline-none focus:ring-2 focus:ring-indigo-500 border-2 border-slate-200","aria-label":"Cancella",children:f.jsx(tg,{className:"w-7 h-7"})},w):f.jsx("button",{type:"button",onClick:()=>o(m),className:"w-16 h-16 mx-auto rounded-full text-slate-700 active:bg-slate-200 transition-colors text-2xl font-semibold focus:outline-none focus:ring-2 focus:ring-indigo-500 border-2 border-slate-200",children:m},w))})};return f.jsxs("div",{children:[f.jsx(c,{}),f.jsx(h,{})]})},RC=e=>/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(e);function PC({onSubmit:e}){const r=Tn.useRef(null),t=Tn.useRef(null),[a,i]=Tn.useState(""),o=c=>{var x;c.preventDefault();const h=(((x=r.current)==null?void 0:x.textContent)||"").trim();if(!RC(h)){i("Inserisci unemail valida");return}t.current&&(t.current.value=h),i(""),e==null||e(h),console.log("LOGIN email:",h)},u=c=>{var x;c.preventDefault();const h=((x=c.clipboardData)==null?void 0:x.getData("text"))||"";document.execCommand("insertText",!1,h)};return f.jsxs("form",{onSubmit:o,autoComplete:"off","data-lpignore":"true","data-form-type":"other",style:{overflow:"visible"},children:[f.jsx("input",{type:"text",autoComplete:"off",tabIndex:-1,readOnly:!0,"aria-hidden":"true",style:{position:"absolute",left:-9999,top:-9999,height:0,width:0,opacity:0}}),f.jsx("input",{ref:t,type:"hidden",name:"email"}),f.jsx("label",{htmlFor:"ed-email",className:"block text-sm font-medium text-slate-700 mb-2",children:"Email"}),f.jsx("div",{id:"ed-email",ref:r,role:"textbox",contentEditable:!0,suppressContentEditableWarning:!0,inputMode:"email","aria-label":"Email",spellCheck:!1,autoCapitalize:"off",autoCorrect:"off",onPaste:u,onKeyDown:c=>{var h;c.key==="Enter"&&(c.preventDefault(),(h=c.currentTarget.closest("form"))==null||h.requestSubmit())},style:{display:"block",width:"100%",minHeight:44,fontSize:16,padding:"10px 12px",border:"1px solid #cbd5e1",borderRadius:10,outline:"none",background:"#fff",color:"#0f172a",WebkitUserModify:"read-write-plaintext-only"},"data-placeholder":"nome@dominio.it",onFocus:c=>{c.currentTarget.scrollIntoView({block:"center",behavior:"smooth"})}}),f.jsx("style",{children:`
        #ed-email:empty:before {
          content: attr(data-placeholder);
          color: #94a3b8; /* slate-400 */
        }
      `}),a&&f.jsx("p",{style:{color:"#dc2626",fontSize:13,marginTop:8},children:a}),f.jsx("button",{type:"submit",style:{marginTop:16,width:"100%",minHeight:44,borderRadius:10,border:"1px solid #4f46e5",background:"#4f46e5",color:"#fff",fontWeight:600},children:"Continua"})]})}const og="bio.enabled",If="bio.credId",Gx="bio.userId",Yx="bio.optOut",Df="bio.snooze",lg=location.hostname,Kx=e=>{const r=String.fromCharCode(...new Uint8Array(e));return btoa(r).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/g,"")},cg=e=>{const r=atob(e.replace(/-/g,"+").replace(/_/g,"/")),t=new Uint8Array(r.length);for(let a=0;a<r.length;a++)t[a]=r.charCodeAt(a);return t.buffer};function OC(){try{return sessionStorage.getItem(Df)==="1"}catch{return!1}}function Ku(){try{sessionStorage.setItem(Df,"1")}catch{}}function Rf(){try{sessionStorage.removeItem(Df)}catch{}}async function _o(){var e,r;if(!("PublicKeyCredential"in window))return!1;try{return!!await((r=(e=window.PublicKeyCredential).isUserVerifyingPlatformAuthenticatorAvailable)==null?void 0:r.call(e))}catch{return!1}}function ug(){return localStorage.getItem(og)==="1"&&!!localStorage.getItem(If)}function Pf(e){e?localStorage.setItem(Yx,"1"):localStorage.removeItem(Yx)}async function Of(e="Utente"){if(!await _o())throw new Error("Biometria non disponibile su questo dispositivo");let r=localStorage.getItem(Gx);if(!r){const c=crypto.getRandomValues(new Uint8Array(32));r=Kx(c.buffer),localStorage.setItem(Gx,r)}const t=cg(r),i={challenge:crypto.getRandomValues(new Uint8Array(32)),rp:{name:"Gestore Spese",id:lg},user:{id:new Uint8Array(t),name:"local@gestore",displayName:e},pubKeyCredParams:[{type:"public-key",alg:-7},{type:"public-key",alg:-257}],timeout:6e4,attestation:"none",authenticatorSelection:{authenticatorAttachment:"platform",residentKey:"preferred",userVerification:"required"}},o=await navigator.credentials.create({publicKey:i});if(!o)throw new Error("Creazione passkey annullata");const u=Kx(o.rawId);return localStorage.setItem(If,u),localStorage.setItem(og,"1"),Rf(),Pf(!1),!0}async function Qu(e="Sblocca Gestore Spese"){var o,u;if(!await _o())throw new Error("Biometria non disponibile");const r=localStorage.getItem(If);if(!r)throw new Error("Biometria non configurata");try{(u=(o=document.activeElement)==null?void 0:o.blur)==null||u.call(o)}catch{}const t=cg(r),i={challenge:crypto.getRandomValues(new Uint8Array(32)),rpId:lg,timeout:6e4,userVerification:"required",allowCredentials:[{id:new Uint8Array(t),type:"public-key"}]};try{if(!await navigator.credentials.get({publicKey:i}))throw Ku(),new DOMException("User cancelled","NotAllowedError");return Rf(),!0}catch(c){const h=String((c==null?void 0:c.name)||""),x=String((c==null?void 0:c.message)||"");throw(h==="NotAllowedError"||h==="AbortError"||/timeout/i.test(x))&&Ku(),c}}const Du=Object.freeze(Object.defineProperty({__proto__:null,clearBiometricSnooze:Rf,isBiometricSnoozed:OC,isBiometricsAvailable:_o,isBiometricsEnabled:ug,registerBiometric:Of,setBiometricSnooze:Ku,setBiometricsOptOut:Pf,unlockWithBiometric:Qu},Symbol.toStringTag,{value:"Module"})),fg="bio.autoprompt.lock",jC=()=>{try{return sessionStorage.getItem(fg)==="1"}catch{return!1}},LC=()=>{try{sessionStorage.setItem(fg,"1")}catch{}},Ul="bio.last_email",MC=({onLoginSuccess:e,onGoToRegister:r,onGoToForgotPassword:t,onGoToForgotEmail:a})=>{const[i,o]=Wi("last_active_user_email",null),[u,c]=I.useState(""),[h,x]=I.useState(null),[m,w]=I.useState(!1),[p,v]=I.useState(!1),[y,T]=I.useState(!1),[E,_]=I.useState(!1),[C,S]=I.useState(!1),N=I.useRef(!1),[B,X]=I.useState(null);I.useEffect(()=>{if(i){X(i);return}try{if(typeof window>"u")return;const ae=window.localStorage.getItem(Ul);X(!ae||ae==="null"||ae==="undefined"?null:ae)}catch{X(null)}},[i]),I.useEffect(()=>{let ae=!0;return(async()=>{const te=await _o(),oe=ug();let re=!1;te&&(oe||i)&&(re=!0),ae&&(v(te),T(oe),_(re))})(),()=>{ae=!1}},[i]);const j=i??B??null;I.useEffect(()=>{j&&(!p||!y||N.current||jC()||(N.current=!0,LC(),(async()=>{const{isBiometricSnoozed:ae,setBiometricSnooze:te,clearBiometricSnooze:oe}=await Vi(async()=>{const{isBiometricSnoozed:re,setBiometricSnooze:Z,clearBiometricSnooze:ge}=await Promise.resolve().then(()=>Du);return{isBiometricSnoozed:re,setBiometricSnooze:Z,clearBiometricSnooze:ge}},void 0);if(!ae())try{S(!0);const re=await Qu("Sblocca con impronta / FaceID");if(S(!1),re){oe();const Z=j.toLowerCase();try{typeof window<"u"&&window.localStorage.setItem(Ul,Z)}catch{}i||o(Z),e("biometric-local",Z)}}catch(re){S(!1);const Z=(re==null?void 0:re.name)||"",ge=String((re==null?void 0:re.message)||"");(Z==="NotAllowedError"||Z==="AbortError"||/timeout/i.test(ge))&&te()}})()))},[j,i,p,y,e,o]),I.useEffect(()=>{u.length===4&&i&&M()},[u,i]);const z=async ae=>{if(ae){const te=ae.toLowerCase(),oe=ko();if(oe[te]){o(te),x(null),X(te);return}w(!0);try{const re=await HT(te);if(re){localStorage.setItem("expenses_v2",JSON.stringify(re.data.expenses)),localStorage.setItem("recurring_expenses_v1",JSON.stringify(re.data.recurringExpenses)),localStorage.setItem("accounts_v1",JSON.stringify(re.data.accounts));const Z={email:te,pinHash:re.pinHash,pinSalt:re.pinSalt,createdAt:new Date().toISOString()};oe[te]=Z,Tf(oe),o(te),x(null),X(te)}else x("Nessun account trovato (locale o cloud).")}catch{x("Errore di connessione cloud.")}finally{w(!1)}}},M=async()=>{if(m||!i)return;w(!0),x(null);const ae=await Op(i,u);ae.success&&ae.token?e(ae.token,i):(x(ae.message),setTimeout(()=>{c(""),x(null),w(!1)},1500))},U=async()=>{const ae=i??B;if(ae)try{S(!0);const{clearBiometricSnooze:te,setBiometricSnooze:oe}=await Vi(async()=>{const{clearBiometricSnooze:Z,setBiometricSnooze:ge}=await Promise.resolve().then(()=>Du);return{clearBiometricSnooze:Z,setBiometricSnooze:ge}},void 0);te();const re=await Qu("Sblocca con impronta / FaceID");if(S(!1),re){const Z=ae.toLowerCase();try{typeof window<"u"&&window.localStorage.setItem(Ul,Z)}catch{}i||o(Z),X(Z),e("biometric-local",Z)}}catch(te){S(!1),console.error("Login biometrico fallito",te);const oe=(te==null?void 0:te.name)||"",re=String((te==null?void 0:te.message)||"");if(oe==="NotAllowedError"||oe==="AbortError"||/timeout/i.test(re)){const{setBiometricSnooze:Z}=await Vi(async()=>{const{setBiometricSnooze:ge}=await Promise.resolve().then(()=>Du);return{setBiometricSnooze:ge}},void 0);Z()}}},D=async()=>{const ae=i??B;if(ae)try{S(!0),await Of("Profilo locale"),T(!0),S(!1);const te=ae.toLowerCase();try{typeof window<"u"&&window.localStorage.setItem(Ul,te)}catch{}i||o(te),X(te),await U()}catch{S(!1)}},R=()=>{o(null),c(""),x(null),N.current=!1},K=()=>i?f.jsxs("div",{className:"text-center",children:[f.jsx("p",{className:"text-sm text-slate-600 mb-2 truncate",title:i,children:i}),f.jsx("h2",{className:"text-xl font-bold text-slate-800 mb-2",children:"Inserisci il PIN di 4 cifre"}),f.jsx("div",{className:`flex items-center justify-center transition-all duration-200 overflow-hidden ${h||m?"h-6 mb-2":"h-0"}`,children:m?f.jsx(ti,{className:"w-4 h-4 text-indigo-600"}):h?f.jsx("p",{className:"text-sm text-red-500",children:h}):null}),f.jsx(ig,{pin:u,onPinChange:c,showBiometric:E,onBiometric:y?U:D}),f.jsx("div",{className:"mt-6 flex flex-col items-center justify-center gap-y-3",children:f.jsxs("div",{className:"flex w-full items-center justify-between px-1",children:[f.jsx("button",{onClick:R,className:"text-sm font-semibold text-indigo-600 hover:text-indigo-500 transition-colors",children:"Cambia Utente"}),f.jsx("button",{onClick:t,className:"text-sm font-semibold text-indigo-600 hover:text-indigo-500 transition-colors",children:"PIN Dimenticato?"})]})})]}):f.jsxs("div",{className:"text-center",children:[f.jsx("h2",{className:"text-xl font-bold text-slate-800 mb-2",children:"Bentornato!"}),f.jsx("p",{className:"text-slate-500 mb-6",children:"Inserisci la tua email per continuare."}),f.jsx(PC,{onSubmit:z}),m&&f.jsx("div",{className:"mt-4 flex justify-center",children:f.jsx(ti,{className:"w-6 h-6 text-indigo-600"})}),h&&f.jsx("p",{className:"mt-4 text-sm text-red-500 bg-red-50 p-2 rounded",children:h}),p&&y&&B&&!m&&f.jsx("div",{className:"mt-6",children:f.jsxs("button",{type:"button",onClick:U,disabled:C,className:"flex items-center justify-center w-full gap-2 px-4 py-3 text-sm font-semibold text-indigo-700 bg-indigo-50 hover:bg-indigo-100 rounded-lg transition-colors disabled:opacity-50 shadow-sm border border-indigo-100",children:[f.jsx(sg,{className:"w-5 h-5"}),C?"Accesso in corso...":"Accedi con impronta"]})}),f.jsxs("div",{className:"mt-4 space-y-3",children:[f.jsx("a",{href:"https://t.me/mailsendreset_bot?start=recover",target:"_blank",rel:"noopener noreferrer",className:"inline-block text-sm font-semibold text-indigo-600 hover:text-indigo-500",children:"Email dimenticata?"}),f.jsxs("p",{className:"text-sm text-slate-500",children:["Non hai un account?"," ",f.jsx("button",{onClick:r,className:"font-semibold text-indigo-600 hover:text-indigo-500",children:"Registrati"})]})]})]});return f.jsx(wc,{children:K()})},jf=e=>f.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...e,children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M21.75 6.75v10.5a2.25 2.25 0 0 1-2.25 2.25h-15a2.25 2.25 0 0 1-2.25-2.25V6.75m19.5 0A2.25 2.25 0 0 0 19.5 4.5h-15a2.25 2.25 0 0 0-2.25 2.25m19.5 0v.243a2.25 2.25 0 0 1-1.07 1.916l-7.5 4.615a2.25 2.25 0 0 1-2.36 0L3.32 8.91a2.25 2.25 0 0 1-1.07-1.916V6.75"})}),BC="bio.snooze",UC=()=>{try{sessionStorage.removeItem(BC)}catch{}},zC=e=>f.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",...e,children:f.jsx("path",{d:"M11.944 0A12 12 0 0 0 0 12a12 12 0 0 0 12 12 12 12 0 0 0 12-12A12 12 0 0 0 11.944 0zm4.963 8.219-1.57 7.407c-.117.537-.442.67-.896.417l-2.48-1.828-1.197 1.152c-.132.133-.243.244-.496.244l.176-2.525 4.6-4.157c.2-.178-.043-.277-.31-.098l-5.685 3.58-2.45-.765c-.533-.166-.543-.533.112-.789l9.573-3.689c.444-.166.833.1.574.812z"})}),HC=({onSetupSuccess:e,onGoToLogin:r})=>{const[t,a]=I.useState("email"),[i,o]=I.useState(""),[u,c]=I.useState(""),[h,x]=I.useState(""),[m,w]=I.useState(null),[p,v]=I.useState(!1),[y,T]=I.useState(null),[E,_]=I.useState(!1),[C,S]=I.useState(!1),[N,B]=I.useState(!1),X=()=>{if(!i)return"#";try{return`https://t.me/mailsendreset_bot?start=reg_${btoa(i).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}`}catch{return"#"}},j=async D=>{if(D.preventDefault(),w(null),!i.trim()||!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(i)){w("Inserisci un indirizzo email valido.");return}v(!0);try{if(await UT(i.toLowerCase())){w("Email gi registrata. Vai su 'Accedi' per recuperare i dati."),v(!1);return}}catch(R){console.error(R)}v(!1),!C&&!N?B(!0):a("pin_setup")},z=async()=>{a("processing"),v(!0),w(null);const D=i.toLowerCase(),R=await $T(D,u);if(!R.success){w(R.message),v(!1),setTimeout(()=>{c(""),x(""),w(null),a("email")},2e3);return}const K=await Op(D,u);K.success&&K.token?e(K.token,D):(v(!1),w("Login automatico fallito. Vai alla pagina di login."),setTimeout(()=>r(),2e3))};I.useEffect(()=>{t==="pin_setup"&&u.length===4&&a("pin_confirm")},[u,t]),I.useEffect(()=>{(async()=>{if(t==="pin_confirm"&&h.length===4)if(u===h){w(null);const D=await _o();T(D),D?a("bio_offer"):await z()}else w("I PIN non corrispondono. Riprova."),setTimeout(()=>{c(""),x(""),w(null),a("pin_setup")},1500)})()},[h,u,t]);const M="block w-full rounded-md border border-slate-300 bg-white py-2.5 pl-10 pr-3 text-slate-900 placeholder:text-slate-400 focus:outline-none focus:border-indigo-500 focus:ring-1 focus:ring-indigo-500 sm:text-sm",U=()=>{if(t==="processing"||p)return f.jsxs("div",{className:"text-center min-h-[300px] flex flex-col justify-center items-center",children:[f.jsx(ti,{className:"w-12 h-12 text-indigo-600 mx-auto"}),f.jsx("p",{className:"mt-4 text-slate-500",children:t==="processing"?"Creazione account...":"Verifica email..."})]});switch(t){case"email":return f.jsxs("div",{className:"text-center",children:[f.jsx("h2",{className:"text-xl font-bold text-slate-800 mb-2",children:"Crea un Account"}),f.jsx("p",{className:`text-slate-500 mb-6 h-10 flex items-center justify-center ${m?"text-red-500 text-sm":""}`,children:m||"Inizia inserendo i tuoi dati."}),N&&f.jsx("div",{className:"mb-6 bg-amber-50 border border-amber-200 rounded-lg p-3 text-left animate-fade-in-up relative",children:f.jsxs("div",{className:"flex gap-3",children:[f.jsx("div",{className:"flex-shrink-0",children:f.jsx(bf,{className:"h-5 w-5 text-amber-500"})}),f.jsxs("div",{className:"flex-1",children:[f.jsx("p",{className:"text-sm font-medium text-amber-800",children:"Attenzione"}),f.jsx("p",{className:"text-sm text-amber-700 mt-1",children:"Senza registrare la mail su Telegram non sar possibile recuperarla."})]}),f.jsx("button",{onClick:()=>a("pin_setup"),className:"flex-shrink-0 text-amber-400 hover:text-amber-600 transition-colors",title:"Ignora e procedi",children:f.jsx(xr,{className:"h-5 w-5"})})]})}),f.jsxs("form",{onSubmit:j,className:"space-y-4",children:[f.jsxs("div",{children:[f.jsx("label",{htmlFor:"email-register",className:"sr-only",children:"Email"}),f.jsxs("div",{className:"relative",children:[f.jsx("div",{className:"pointer-events-none absolute inset-y-0 left-0 flex items-center pl-3",children:f.jsx(jf,{className:"h-5 w-5 text-slate-400","aria-hidden":"true"})}),f.jsx("input",{type:"email",id:"email-register",value:i,onChange:D=>o(D.target.value),className:M,placeholder:"La tua email",required:!0})]})]}),f.jsx("button",{type:"submit",disabled:!i,className:"w-full px-4 py-3 text-sm font-semibold text-white bg-indigo-600 rounded-lg shadow-sm hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2 transition-colors disabled:bg-indigo-300",children:"Continua"})]}),f.jsxs("p",{className:"text-sm text-slate-500 mt-6",children:["Hai gi un account?"," ",f.jsx("button",{onClick:r,className:"font-semibold text-indigo-600 hover:text-indigo-500",children:"Accedi"})]}),f.jsx("div",{className:"mt-8 pt-6 border-t border-slate-200",children:f.jsxs("a",{href:X(),target:"_blank",rel:"noopener noreferrer",onClick:D=>{i?S(!0):(D.preventDefault(),w("Inserisci prima la tua email."))},className:`inline-flex items-center gap-2 text-sm font-medium transition-colors bg-sky-50 px-4 py-2 rounded-full hover:bg-sky-100 ${i?"text-sky-600 hover:text-sky-700":"text-slate-400 cursor-not-allowed"}`,children:[f.jsx(zC,{className:"w-5 h-5"}),"Registra mail su telegram"]})})]});case"pin_setup":case"pin_confirm":{const D=t==="pin_confirm";return f.jsxs("div",{className:"text-center",children:[f.jsx("h2",{className:"text-xl font-bold text-slate-800 mb-2",children:D?"Conferma il tuo PIN":"Crea un PIN di 4 cifre"}),f.jsx("p",{className:`text-slate-500 h-10 flex items-center justify-center transition-colors ${m?"text-red-500":""}`,children:m||(D?"Inseriscilo di nuovo per conferma.":"Servir per accedere al tuo account.")}),f.jsx(ig,{pin:D?h:u,onPinChange:D?x:c})]})}case"bio_offer":return f.jsxs("div",{className:"text-center",children:[f.jsx("h2",{className:"text-xl font-bold text-slate-800 mb-2",children:"Vuoi abilitare limpronta / FaceID?"}),f.jsx("p",{className:"text-slate-500 h-10 flex items-center justify-center",children:"Potrai sbloccare lapp senza inserire il PIN."}),f.jsxs("div",{className:"mt-4 p-3 rounded-lg border border-slate-200 bg-slate-50 text-left inline-block",children:[f.jsx("p",{className:"text-sm text-slate-700",children:"Abilita ora lo sblocco biometrico?"}),f.jsxs("div",{className:"flex gap-3 mt-2",children:[f.jsx("button",{onClick:async()=>{if(!y){await z();return}try{_(!0),await Of("Profilo locale"),UC(),_(!1)}catch{_(!1)}finally{await z()}},disabled:E,className:"px-4 py-2 text-sm font-semibold text-white bg-indigo-600 rounded-lg shadow-sm hover:bg-indigo-700 disabled:bg-indigo-300",children:E?"Attivo":"Abilita e continua"}),f.jsx("button",{onClick:async()=>{Pf(!0),await z()},disabled:E,className:"px-4 py-2 text-sm font-semibold text-slate-600 bg-white border border-slate-300 rounded-lg hover:bg-slate-100",children:"Non ora"})]})]})]})}};return f.jsx(wc,{children:U()})},VC=({onBackToLogin:e,onRequestSent:r})=>{const[t,a]=I.useState(""),[i,o]=I.useState(!1),[u,c]=I.useState(null),h=async m=>{if(m.preventDefault(),!t)return;o(!0),c(null);const w=await jp(t);o(!1),w.success?r(t):c(w.message)};return f.jsx(wc,{children:f.jsxs("div",{className:"text-center",children:[f.jsx("h2",{className:"text-xl font-bold text-slate-800 mb-2",children:"Reimposta PIN"}),f.jsxs(f.Fragment,{children:[f.jsx("p",{className:"text-slate-500 mb-6",children:"Inserisci la tua email e ti invieremo un link per reimpostare il tuo PIN."}),u&&f.jsx("p",{className:"text-red-600 text-sm mb-4 bg-red-100 p-3 rounded-md",children:u}),f.jsxs("form",{onSubmit:h,children:[f.jsxs("div",{className:"mb-4",children:[f.jsx("label",{htmlFor:"email-forgot",className:"sr-only",children:"Email"}),f.jsxs("div",{className:"relative",children:[f.jsx("div",{className:"pointer-events-none absolute inset-y-0 left-0 flex items-center pl-3",children:f.jsx(jf,{className:"h-5 w-5 text-slate-400","aria-hidden":"true"})}),f.jsx("input",{type:"email",id:"email-forgot",autoComplete:"email",value:t,onChange:m=>a(m.target.value),className:"block w-full rounded-md border border-slate-300 bg-white py-2.5 pl-10 pr-3 text-slate-900 placeholder:text-slate-400 focus:outline-none focus:border-indigo-500 focus:ring-1 focus:ring-indigo-500 sm:text-sm",placeholder:"La tua email",required:!0,disabled:i})]})]}),f.jsx("button",{type:"submit",disabled:i||!t,className:"w-full px-4 py-3 text-sm font-semibold text-white bg-indigo-600 rounded-lg shadow-sm hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2 transition-colors disabled:bg-indigo-300 flex justify-center items-center",children:i?f.jsx(ti,{className:"w-5 h-5"}):"Invia Link di Reset"})]}),f.jsx("button",{onClick:e,className:"mt-6 w-full text-center text-sm font-semibold text-indigo-600 hover:text-indigo-500",children:"Annulla"})]})]})})},WC=60,$C=({email:e,onBackToLogin:r})=>{const[t,a]=I.useState(0),[i,o]=I.useState(!1),u=I.useRef(null);I.useEffect(()=>()=>{u.current&&(window.clearInterval(u.current),u.current=null)},[]);const c=()=>{a(WC),u.current&&window.clearInterval(u.current),u.current=window.setInterval(()=>{a(x=>x<=1?(u.current&&(window.clearInterval(u.current),u.current=null),0):x-1)},1e3)},h=async()=>{if(!(i||t>0))try{o(!0),await jp(e),c()}finally{o(!1)}};return f.jsx(wc,{children:f.jsxs("div",{className:"text-center",children:[f.jsx("div",{className:"mx-auto flex h-12 w-12 items-center justify-center rounded-full bg-green-100 mb-4",children:f.jsx(jf,{className:"h-6 w-6 text-green-600","aria-hidden":"true"})}),f.jsx("h2",{className:"text-xl font-bold text-slate-800 mb-2",children:"Controlla la tua Email"}),f.jsxs("p",{className:"text-slate-500 mb-6",children:["Abbiamo inviato un link per il reset del PIN a ",f.jsx("br",{}),f.jsx("strong",{className:"text-slate-700",children:e}),".",f.jsx("br",{}),f.jsx("br",{}),"Apri il link per continuare. Se non lo trovi, controlla la cartella spam."]}),f.jsxs("div",{className:"space-y-3",children:[f.jsx("button",{onClick:r,className:"w-full px-4 py-3 text-sm font-semibold text-white bg-indigo-600 rounded-lg shadow-sm hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2 transition-colors",children:"Torna al Login"}),f.jsxs("div",{className:"text-sm text-slate-600",children:["Non hai ricevuto lemail?"," ",f.jsx("button",{onClick:h,disabled:i||t>0,className:"font-semibold text-indigo-600 hover:text-indigo-700 disabled:opacity-50 disabled:cursor-not-allowed",children:i?"Invio":t>0?`Reinvia tra ${t}s`:"Reinvia link"})]})]})]})})},XC=({email:e,token:r,onResetSuccess:t})=>{const[a,i]=I.useState("new_pin"),[o,u]=I.useState(""),[c,h]=I.useState(""),[x,m]=I.useState(null),[w,p]=I.useState(!1),[v,y]=I.useState(null),T=(e||"").trim().toLowerCase(),E=async S=>{S.preventDefault(),m(null);const N=o.trim(),B=c.trim();if(!/^\d{4}$/.test(N)){m("Inserisci un PIN di 4 cifre.");return}if(a==="new_pin"){i("confirm_pin");return}if(N!==B){m("I PIN non coincidono. Riprova.");return}if(!T){m("Email non valida nel link. Richiedi di nuovo il reset.");return}try{p(!0);const X=await GT(T,r||"",N);if(p(!1),!X.success){m(X.message||"Errore durante il reset del PIN.");return}y("PIN aggiornato con successo."),setTimeout(()=>{t()},800)}catch(X){console.error("[ResetPin] Errore inatteso:",X),p(!1),m("Errore imprevisto durante il reset del PIN.")}},_=a==="new_pin"?"Imposta un nuovo PIN":"Conferma il nuovo PIN",C=a==="new_pin"?`Stai reimpostando il PIN per laccount ${T||e}. Scegli un nuovo PIN a 4 cifre.`:"Reinserisci il nuovo PIN per conferma.";return f.jsx("div",{className:"min-h-screen bg-slate-100 flex items-center justify-center px-4",children:f.jsxs("div",{className:"w-full max-w-md bg-white rounded-2xl shadow-lg p-6",children:[f.jsx("h1",{className:"text-2xl font-bold text-slate-900 mb-2",children:_}),f.jsx("p",{className:"text-sm text-slate-500 mb-4",children:C}),f.jsxs("p",{className:"text-xs text-slate-400 mb-6 break-all",children:["Email: ",f.jsx("span",{className:"font-mono text-slate-700",children:T||"(sconosciuta)"})]}),f.jsxs("form",{onSubmit:E,className:"space-y-5",children:[a==="new_pin"&&f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Nuovo PIN (4 cifre)"}),f.jsx("input",{type:"password",inputMode:"numeric",maxLength:4,value:o,onChange:S=>u(S.target.value.replace(/\D/g,"").slice(0,4)),className:"w-full px-3 py-2 rounded-lg border border-slate-300 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 text-center tracking-[0.5em] text-lg",autoFocus:!0})]}),a==="confirm_pin"&&f.jsxs(f.Fragment,{children:[f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Nuovo PIN (4 cifre)"}),f.jsx("input",{type:"password",inputMode:"numeric",maxLength:4,value:o,onChange:S=>u(S.target.value.replace(/\D/g,"").slice(0,4)),className:"w-full px-3 py-2 rounded-lg border border-slate-300 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 text-center tracking-[0.5em] text-lg"})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Conferma PIN"}),f.jsx("input",{type:"password",inputMode:"numeric",maxLength:4,value:c,onChange:S=>h(S.target.value.replace(/\D/g,"").slice(0,4)),className:"w-full px-3 py-2 rounded-lg border border-slate-300 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 text-center tracking-[0.5em] text-lg",autoFocus:!0})]})]}),x&&f.jsx("div",{className:"text-sm text-red-600 bg-red-50 border border-red-100 rounded-md px-3 py-2",children:x}),v&&f.jsx("div",{className:"text-sm text-green-700 bg-green-50 border border-green-100 rounded-md px-3 py-2",children:v}),f.jsx("button",{type:"submit",disabled:w,className:"w-full inline-flex items-center justify-center px-4 py-2.5 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-indigo-600 hover:bg-indigo-700 disabled:opacity-60 disabled:cursor-not-allowed",children:w?"Salvataggio...":a==="new_pin"?"Continua":"Salva PIN"}),f.jsx("button",{type:"button",onClick:t,disabled:w,className:"w-full text-sm text-slate-500 hover:text-slate-700 mt-2",children:"Annulla e torna al login"})]})]})})},GC=3e4,YC=()=>{const[e,r]=I.useState(null),[t,a]=Wi("last_active_user_email",null),[i,o]=I.useState(null),u=I.useRef(null),[c,h]=I.useState(""),x=()=>{try{const T=localStorage.getItem("users_db");return T!==null&&T!=="{}"}catch{return!1}},[m,w]=I.useState(x()?"login":"register");I.useEffect(()=>{const T=new URLSearchParams(window.location.search),E=T.get("resetToken"),_=T.get("email");if(E&&_){o({token:E,email:_});try{window.history.replaceState({},document.title,window.location.pathname)}catch{}}},[]);const p=(T,E)=>{r(T),a(E.toLowerCase())},v=()=>{o(null),w("login")},y=I.useCallback(()=>{r(null),a(null),w(x()?"login":"register")},[a]);if(I.useEffect(()=>{const T=()=>{if(document.visibilityState==="hidden")e&&(u.current=Date.now());else if(document.visibilityState==="visible"){if(sessionStorage.getItem("preventAutoLock")==="true"){sessionStorage.removeItem("preventAutoLock"),u.current=null;return}e&&u.current&&Date.now()-u.current>GC&&y(),u.current=null}};return document.addEventListener("visibilitychange",T),()=>{document.removeEventListener("visibilitychange",T)}},[e,y]),i)return f.jsx(XC,{email:i.email,token:i.token,onResetSuccess:v});if(e)return f.jsx(bC,{onLogout:y,currentEmail:t||""});switch(m){case"register":return f.jsx(HC,{onSetupSuccess:p,onGoToLogin:()=>w("login")});case"forgotPassword":return f.jsx(VC,{onBackToLogin:()=>w("login"),onRequestSent:T=>{h(T),w("forgotPasswordSuccess")}});case"forgotPasswordSuccess":return f.jsx($C,{email:c,onBackToLogin:()=>w("login")});case"login":default:return f.jsx(MC,{onLoginSuccess:p,onGoToRegister:()=>w("register"),onGoToForgotPassword:()=>w("forgotPassword"),onGoToForgotEmail:()=>w("forgotPassword")})}},dg=document.getElementById("root");if(!dg)throw new Error("Could not find root element to mount to");const KC=s2.createRoot(dg);KC.render(f.jsx(Tn.StrictMode,{children:f.jsx(YC,{})}));"serviceWorker"in navigator&&window.addEventListener("load",()=>{navigator.serviceWorker.register("./service-worker.js").then(e=>{console.log(" SW Registrato con successo:",e.scope),e.waiting&&e.waiting.postMessage({type:"SKIP_WAITING"})}).catch(e=>{console.error(" Registrazione SW fallita:",e)}),navigator.serviceWorker.addEventListener("controllerchange",()=>{window.location.reload()})});
